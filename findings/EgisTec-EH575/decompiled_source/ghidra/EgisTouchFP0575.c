typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef unsigned int    ImageBaseOffset32;
typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined5;
typedef unsigned long long    undefined6;
typedef unsigned long long    undefined7;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef short    wchar_t;
typedef unsigned short    word;
typedef struct _s_HandlerType _s_HandlerType, *P_s_HandlerType;

struct _s_HandlerType {
    uint adjectives;
    ImageBaseOffset32 dispType;
    int dispCatchObj;
    ImageBaseOffset32 dispOfHandler;
    dword dispFrame;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _s_TryBlockMapEntry _s_TryBlockMapEntry, *P_s_TryBlockMapEntry;

typedef int __ehstate_t;

struct _s_TryBlockMapEntry {
    __ehstate_t tryLow;
    __ehstate_t tryHigh;
    __ehstate_t catchHigh;
    int nCatches;
    ImageBaseOffset32 dispHandlerArray;
};

typedef struct _s__RTTIClassHierarchyDescriptor _s__RTTIClassHierarchyDescriptor, *P_s__RTTIClassHierarchyDescriptor;

struct _s__RTTIClassHierarchyDescriptor {
    dword signature;
    dword attributes; // bit flags
    dword numBaseClasses; // number of base classes (i.e. rtti1Count)
    ImageBaseOffset32 pBaseClassArray; // ref to BaseClassArray (RTTI 2)
};

typedef struct type_info type_info, *Ptype_info;

struct type_info { // PlaceHolder Class Structure
};

typedef struct _s_FuncInfo _s_FuncInfo, *P_s_FuncInfo;

struct _s_FuncInfo {
    uint magicNumber_and_bbtFlags;
    __ehstate_t maxState;
    ImageBaseOffset32 dispUnwindMap;
    uint nTryBlocks;
    ImageBaseOffset32 dispTryBlockMap;
    uint nIPMapEntries;
    ImageBaseOffset32 dispIPToStateMap;
    int dispUnwindHelp;
    ImageBaseOffset32 dispESTypeList;
    int EHFlags;
};

typedef struct _s_TryBlockMapEntry TryBlockMapEntry;

typedef struct _s__RTTIBaseClassDescriptor _s__RTTIBaseClassDescriptor, *P_s__RTTIBaseClassDescriptor;

typedef struct PMD PMD, *PPMD;

struct PMD {
    int mdisp;
    int pdisp;
    int vdisp;
};

struct _s__RTTIBaseClassDescriptor {
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    dword numContainedBases; // count of extended classes in BaseClassArray (RTTI 2)
    struct PMD where; // member displacement structure
    dword attributes; // bit flags
    ImageBaseOffset32 pClassHierarchyDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3) for class
};

typedef struct _s_UnwindMapEntry _s_UnwindMapEntry, *P_s_UnwindMapEntry;

struct _s_UnwindMapEntry {
    __ehstate_t toState;
    ImageBaseOffset32 action;
};

typedef struct _s__RTTICompleteObjectLocator _s__RTTICompleteObjectLocator, *P_s__RTTICompleteObjectLocator;

struct _s__RTTICompleteObjectLocator {
    dword signature;
    dword offset; // offset of vbtable within class
    dword cdOffset; // constructor displacement offset
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    ImageBaseOffset32 pClassDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3)
};

typedef unsigned short    wchar16;
typedef struct _s_IPToStateMapEntry _s_IPToStateMapEntry, *P_s_IPToStateMapEntry;

typedef struct _s_IPToStateMapEntry IPToStateMapEntry;

struct _s_IPToStateMapEntry {
    ImageBaseOffset32 Ip;
    __ehstate_t state;
};

typedef struct _IMAGE_RUNTIME_FUNCTION_ENTRY _IMAGE_RUNTIME_FUNCTION_ENTRY, *P_IMAGE_RUNTIME_FUNCTION_ENTRY;

struct _IMAGE_RUNTIME_FUNCTION_ENTRY {
    ImageBaseOffset32 BeginAddress;
    ImageBaseOffset32 EndAddress;
    ImageBaseOffset32 UnwindInfoAddressOrData;
};

typedef struct _s_UnwindMapEntry UnwindMapEntry;

typedef struct _s__RTTIClassHierarchyDescriptor RTTIClassHierarchyDescriptor;

typedef struct _s_FuncInfo FuncInfo;

typedef struct _s__RTTIBaseClassDescriptor RTTIBaseClassDescriptor;

typedef struct TypeDescriptor TypeDescriptor, *PTypeDescriptor;

struct TypeDescriptor {
    void * pVFTable;
    void * spare;
    char[0] name;
};

typedef struct _s__RTTICompleteObjectLocator RTTICompleteObjectLocator;

typedef struct _s_HandlerType HandlerType;

typedef struct _cpinfo _cpinfo, *P_cpinfo;

typedef uint UINT;

typedef uchar BYTE;

struct _cpinfo {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
};

typedef struct _cpinfo * LPCPINFO;

typedef struct _SYSTEM_INFO _SYSTEM_INFO, *P_SYSTEM_INFO;

typedef struct _SYSTEM_INFO * LPSYSTEM_INFO;

typedef union _union_550 _union_550, *P_union_550;

typedef ulong DWORD;

typedef void * LPVOID;

typedef ulonglong ULONG_PTR;

typedef ULONG_PTR DWORD_PTR;

typedef ushort WORD;

typedef struct _struct_551 _struct_551, *P_struct_551;

struct _struct_551 {
    WORD wProcessorArchitecture;
    WORD wReserved;
};

union _union_550 {
    DWORD dwOemId;
    struct _struct_551 s;
};

struct _SYSTEM_INFO {
    union _union_550 u;
    DWORD dwPageSize;
    LPVOID lpMinimumApplicationAddress;
    LPVOID lpMaximumApplicationAddress;
    DWORD_PTR dwActiveProcessorMask;
    DWORD dwNumberOfProcessors;
    DWORD dwProcessorType;
    DWORD dwAllocationGranularity;
    WORD wProcessorLevel;
    WORD wProcessorRevision;
};

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef union _union_538 _union_538, *P_union_538;

typedef void * HANDLE;

typedef struct _struct_539 _struct_539, *P_struct_539;

typedef void * PVOID;

struct _struct_539 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_538 {
    struct _struct_539 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_538 u;
    HANDLE hEvent;
};

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef int BOOL;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

typedef struct _SYSTEMTIME SYSTEMTIME;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef wchar_t WCHAR;

typedef WCHAR * LPWSTR;

typedef BYTE * LPBYTE;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION * PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG * PRTL_CRITICAL_SECTION_DEBUG;

typedef long LONG;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * Flink;
    struct _LIST_ENTRY * Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION * CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef DWORD (* PTHREAD_START_ROUTINE)(LPVOID);

typedef PTHREAD_START_ROUTINE LPTHREAD_START_ROUTINE;

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT * PCONTEXT;

typedef ulonglong DWORD64;

typedef union _union_52 _union_52, *P_union_52;

typedef struct _M128A _M128A, *P_M128A;

typedef struct _M128A M128A;

typedef struct _XSAVE_FORMAT _XSAVE_FORMAT, *P_XSAVE_FORMAT;

typedef struct _XSAVE_FORMAT XSAVE_FORMAT;

typedef XSAVE_FORMAT XMM_SAVE_AREA32;

typedef struct _struct_53 _struct_53, *P_struct_53;

typedef ulonglong ULONGLONG;

typedef longlong LONGLONG;

struct _M128A {
    ULONGLONG Low;
    LONGLONG High;
};

struct _XSAVE_FORMAT {
    WORD ControlWord;
    WORD StatusWord;
    BYTE TagWord;
    BYTE Reserved1;
    WORD ErrorOpcode;
    DWORD ErrorOffset;
    WORD ErrorSelector;
    WORD Reserved2;
    DWORD DataOffset;
    WORD DataSelector;
    WORD Reserved3;
    DWORD MxCsr;
    DWORD MxCsr_Mask;
    M128A FloatRegisters[8];
    M128A XmmRegisters[16];
    BYTE Reserved4[96];
};

struct _struct_53 {
    M128A Header[2];
    M128A Legacy[8];
    M128A Xmm0;
    M128A Xmm1;
    M128A Xmm2;
    M128A Xmm3;
    M128A Xmm4;
    M128A Xmm5;
    M128A Xmm6;
    M128A Xmm7;
    M128A Xmm8;
    M128A Xmm9;
    M128A Xmm10;
    M128A Xmm11;
    M128A Xmm12;
    M128A Xmm13;
    M128A Xmm14;
    M128A Xmm15;
};

union _union_52 {
    XMM_SAVE_AREA32 FltSave;
    struct _struct_53 s;
};

struct _CONTEXT {
    DWORD64 P1Home;
    DWORD64 P2Home;
    DWORD64 P3Home;
    DWORD64 P4Home;
    DWORD64 P5Home;
    DWORD64 P6Home;
    DWORD ContextFlags;
    DWORD MxCsr;
    WORD SegCs;
    WORD SegDs;
    WORD SegEs;
    WORD SegFs;
    WORD SegGs;
    WORD SegSs;
    DWORD EFlags;
    DWORD64 Dr0;
    DWORD64 Dr1;
    DWORD64 Dr2;
    DWORD64 Dr3;
    DWORD64 Dr6;
    DWORD64 Dr7;
    DWORD64 Rax;
    DWORD64 Rcx;
    DWORD64 Rdx;
    DWORD64 Rbx;
    DWORD64 Rsp;
    DWORD64 Rbp;
    DWORD64 Rsi;
    DWORD64 Rdi;
    DWORD64 R8;
    DWORD64 R9;
    DWORD64 R10;
    DWORD64 R11;
    DWORD64 R12;
    DWORD64 R13;
    DWORD64 R14;
    DWORD64 R15;
    DWORD64 Rip;
    union _union_52 u;
    M128A VectorRegister[26];
    DWORD64 VectorControl;
    DWORD64 DebugControl;
    DWORD64 LastBranchToRip;
    DWORD64 LastBranchFromRip;
    DWORD64 LastExceptionToRip;
    DWORD64 LastExceptionFromRip;
};

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _SYSTEMTIME * LPSYSTEMTIME;

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef enum _EXCEPTION_DISPOSITION {
    ExceptionCollidedUnwind=3,
    ExceptionContinueExecution=0,
    ExceptionContinueSearch=1,
    ExceptionNestedException=2
} _EXCEPTION_DISPOSITION;

typedef enum _EXCEPTION_DISPOSITION EXCEPTION_DISPOSITION;

typedef DWORD ULONG;

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbname[19];
};

typedef struct _strflt _strflt, *P_strflt;

struct _strflt {
    int sign;
    int decpt;
    int flag;
    char * mantissa;
};

typedef struct _strflt * STRFLT;

typedef struct _iobuf _iobuf, *P_iobuf;

struct _iobuf {
    char * _ptr;
    int _cnt;
    char * _base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char * _tmpfname;
};

typedef struct _iobuf FILE;

typedef char * va_list;

typedef ulonglong uintptr_t;

typedef struct lconv lconv, *Plconv;

struct lconv {
    char * decimal_point;
    char * thousands_sep;
    char * grouping;
    char * int_curr_symbol;
    char * currency_symbol;
    char * mon_decimal_point;
    char * mon_thousands_sep;
    char * mon_grouping;
    char * positive_sign;
    char * negative_sign;
    char int_frac_digits;
    char frac_digits;
    char p_cs_precedes;
    char p_sep_by_space;
    char n_cs_precedes;
    char n_sep_by_space;
    char p_sign_posn;
    char n_sign_posn;
    wchar_t * _W_decimal_point;
    wchar_t * _W_thousands_sep;
    wchar_t * _W_int_curr_symbol;
    wchar_t * _W_currency_symbol;
    wchar_t * _W_mon_decimal_point;
    wchar_t * _W_mon_thousands_sep;
    wchar_t * _W_positive_sign;
    wchar_t * _W_negative_sign;
};

typedef ushort wint_t;

typedef struct threadlocaleinfostruct threadlocaleinfostruct, *Pthreadlocaleinfostruct;

typedef struct threadlocaleinfostruct * pthreadlocinfo;

typedef struct localerefcount localerefcount, *Plocalerefcount;

typedef struct localerefcount locrefcount;

typedef struct __lc_time_data __lc_time_data, *P__lc_time_data;

struct localerefcount {
    char * locale;
    wchar_t * wlocale;
    int * refcount;
    int * wrefcount;
};

struct threadlocaleinfostruct {
    int refcount;
    uint lc_codepage;
    uint lc_collate_cp;
    uint lc_time_cp;
    locrefcount lc_category[6];
    int lc_clike;
    int mb_cur_max;
    int * lconv_intl_refcount;
    int * lconv_num_refcount;
    int * lconv_mon_refcount;
    struct lconv * lconv;
    int * ctype1_refcount;
    ushort * ctype1;
    ushort * pctype;
    uchar * pclmap;
    uchar * pcumap;
    struct __lc_time_data * lc_time_curr;
    wchar_t * locale_name[6];
};

struct __lc_time_data {
    char * wday_abbr[7];
    char * wday[7];
    char * month_abbr[12];
    char * month[12];
    char * ampm[2];
    char * ww_sdatefmt;
    char * ww_ldatefmt;
    char * ww_timefmt;
    int ww_caltype;
    int refcount;
    wchar_t * _W_wday_abbr[7];
    wchar_t * _W_wday[7];
    wchar_t * _W_month_abbr[12];
    wchar_t * _W_month[12];
    wchar_t * _W_ampm[2];
    wchar_t * _W_ww_sdatefmt;
    wchar_t * _W_ww_ldatefmt;
    wchar_t * _W_ww_timefmt;
    wchar_t * _W_ww_locale_name;
};

typedef ulonglong size_t;

typedef int errno_t;

typedef struct localeinfo_struct localeinfo_struct, *Plocaleinfo_struct;

typedef struct threadmbcinfostruct threadmbcinfostruct, *Pthreadmbcinfostruct;

typedef struct threadmbcinfostruct * pthreadmbcinfo;

struct threadmbcinfostruct {
    int refcount;
    int mbcodepage;
    int ismbcodepage;
    ushort mbulinfo[6];
    uchar mbctype[257];
    uchar mbcasemap[256];
    wchar_t * mblocalename;
};

struct localeinfo_struct {
    pthreadlocinfo locinfo;
    pthreadmbcinfo mbcinfo;
};

typedef size_t rsize_t;

typedef struct localeinfo_struct * _locale_t;

typedef struct exception exception, *Pexception;

struct exception { // PlaceHolder Class Structure
};

typedef struct tagRGBQUAD tagRGBQUAD, *PtagRGBQUAD;

typedef struct tagRGBQUAD RGBQUAD;

struct tagRGBQUAD {
    BYTE rgbBlue;
    BYTE rgbGreen;
    BYTE rgbRed;
    BYTE rgbReserved;
};

typedef struct tagBITMAPINFOHEADER tagBITMAPINFOHEADER, *PtagBITMAPINFOHEADER;

typedef struct tagBITMAPINFOHEADER BITMAPINFOHEADER;

struct tagBITMAPINFOHEADER {
    DWORD biSize;
    LONG biWidth;
    LONG biHeight;
    WORD biPlanes;
    WORD biBitCount;
    DWORD biCompression;
    DWORD biSizeImage;
    LONG biXPelsPerMeter;
    LONG biYPelsPerMeter;
    DWORD biClrUsed;
    DWORD biClrImportant;
};

typedef struct tagBITMAPINFO tagBITMAPINFO, *PtagBITMAPINFO;

typedef struct tagBITMAPINFO BITMAPINFO;

struct tagBITMAPINFO {
    BITMAPINFOHEADER bmiHeader;
    RGBQUAD bmiColors[1];
};


// WARNING! conflicting data type names: /guiddef.h/GUID - /GUID

typedef GUID IID;

typedef struct _GUID _GUID, *P_GUID;

struct _GUID {
    ulong Data1;
    ushort Data2;
    ushort Data3;
    uchar Data4[8];
};

typedef struct _BCryptBufferDesc _BCryptBufferDesc, *P_BCryptBufferDesc;

typedef struct _BCryptBufferDesc BCryptBufferDesc;


// WARNING! conflicting data type names: /WinDef.h/ULONG - /wtypes.h/ULONG

typedef struct _BCryptBuffer _BCryptBuffer, *P_BCryptBuffer;

typedef struct _BCryptBuffer * PBCryptBuffer;

struct _BCryptBuffer {
    ULONG cbBuffer;
    ULONG BufferType;
    PVOID pvBuffer;
};

struct _BCryptBufferDesc {
    ULONG ulVersion;
    ULONG cBuffers;
    PBCryptBuffer pBuffers;
};

typedef PVOID BCRYPT_SECRET_HANDLE;

typedef PVOID BCRYPT_KEY_HANDLE;

typedef PVOID BCRYPT_HANDLE;

typedef PVOID BCRYPT_HASH_HANDLE;

typedef PVOID BCRYPT_ALG_HANDLE;

typedef LONG NTSTATUS;

typedef struct _MEMORY_BASIC_INFORMATION _MEMORY_BASIC_INFORMATION, *P_MEMORY_BASIC_INFORMATION;

typedef ULONG_PTR SIZE_T;

struct _MEMORY_BASIC_INFORMATION {
    PVOID BaseAddress;
    PVOID AllocationBase;
    DWORD AllocationProtect;
    SIZE_T RegionSize;
    DWORD State;
    DWORD Protect;
    DWORD Type;
};

typedef struct _CONTEXT CONTEXT;

typedef struct _OSVERSIONINFOEXW _OSVERSIONINFOEXW, *P_OSVERSIONINFOEXW;

struct _OSVERSIONINFOEXW {
    DWORD dwOSVersionInfoSize;
    DWORD dwMajorVersion;
    DWORD dwMinorVersion;
    DWORD dwBuildNumber;
    DWORD dwPlatformId;
    WCHAR szCSDVersion[128];
    WORD wServicePackMajor;
    WORD wServicePackMinor;
    WORD wSuiteMask;
    BYTE wProductType;
    BYTE wReserved;
};

typedef char CHAR;

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef struct _OSVERSIONINFOEXW * LPOSVERSIONINFOEXW;

typedef struct _RUNTIME_FUNCTION _RUNTIME_FUNCTION, *P_RUNTIME_FUNCTION;

struct _RUNTIME_FUNCTION {
    DWORD BeginAddress;
    DWORD EndAddress;
    DWORD UnwindData;
};

typedef struct _IMAGE_SECTION_HEADER _IMAGE_SECTION_HEADER, *P_IMAGE_SECTION_HEADER;

typedef union _union_236 _union_236, *P_union_236;

union _union_236 {
    DWORD PhysicalAddress;
    DWORD VirtualSize;
};

struct _IMAGE_SECTION_HEADER {
    BYTE Name[8];
    union _union_236 Misc;
    DWORD VirtualAddress;
    DWORD SizeOfRawData;
    DWORD PointerToRawData;
    DWORD PointerToRelocations;
    DWORD PointerToLinenumbers;
    WORD NumberOfRelocations;
    WORD NumberOfLinenumbers;
    DWORD Characteristics;
};

typedef struct _RUNTIME_FUNCTION * PRUNTIME_FUNCTION;

typedef EXCEPTION_DISPOSITION (EXCEPTION_ROUTINE)(struct _EXCEPTION_RECORD *, PVOID, struct _CONTEXT *, PVOID);

typedef struct _IMAGE_SECTION_HEADER * PIMAGE_SECTION_HEADER;

typedef struct _EXCEPTION_POINTERS EXCEPTION_POINTERS;

typedef WCHAR * LPWCH;

typedef WCHAR * LPCWSTR;

typedef struct _M128A * PM128A;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY _UNWIND_HISTORY_TABLE_ENTRY, *P_UNWIND_HISTORY_TABLE_ENTRY;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY UNWIND_HISTORY_TABLE_ENTRY;

struct _UNWIND_HISTORY_TABLE_ENTRY {
    DWORD64 ImageBase;
    PRUNTIME_FUNCTION FunctionEntry;
};

typedef union _union_61 _union_61, *P_union_61;

typedef ulonglong * PDWORD64;

typedef struct _struct_62 _struct_62, *P_struct_62;

struct _struct_62 {
    PDWORD64 Rax;
    PDWORD64 Rcx;
    PDWORD64 Rdx;
    PDWORD64 Rbx;
    PDWORD64 Rsp;
    PDWORD64 Rbp;
    PDWORD64 Rsi;
    PDWORD64 Rdi;
    PDWORD64 R8;
    PDWORD64 R9;
    PDWORD64 R10;
    PDWORD64 R11;
    PDWORD64 R12;
    PDWORD64 R13;
    PDWORD64 R14;
    PDWORD64 R15;
};

union _union_61 {
    PDWORD64 IntegerContext[16];
    struct _struct_62 s;
};

typedef struct _UNWIND_HISTORY_TABLE _UNWIND_HISTORY_TABLE, *P_UNWIND_HISTORY_TABLE;

typedef struct _UNWIND_HISTORY_TABLE * PUNWIND_HISTORY_TABLE;

struct _UNWIND_HISTORY_TABLE {
    DWORD Count;
    BYTE LocalHint;
    BYTE GlobalHint;
    BYTE Search;
    BYTE Once;
    DWORD64 LowAddress;
    DWORD64 HighAddress;
    UNWIND_HISTORY_TABLE_ENTRY Entry[12];
};

typedef struct _struct_60 _struct_60, *P_struct_60;

struct _struct_60 {
    PM128A Xmm0;
    PM128A Xmm1;
    PM128A Xmm2;
    PM128A Xmm3;
    PM128A Xmm4;
    PM128A Xmm5;
    PM128A Xmm6;
    PM128A Xmm7;
    PM128A Xmm8;
    PM128A Xmm9;
    PM128A Xmm10;
    PM128A Xmm11;
    PM128A Xmm12;
    PM128A Xmm13;
    PM128A Xmm14;
    PM128A Xmm15;
};

typedef long HRESULT;

typedef CHAR * LPCSTR;

typedef struct _MEMORY_BASIC_INFORMATION * PMEMORY_BASIC_INFORMATION;

typedef ULONGLONG DWORDLONG;

typedef union _union_59 _union_59, *P_union_59;

union _union_59 {
    PM128A FloatingContext[16];
    struct _struct_60 s;
};

typedef LARGE_INTEGER * PLARGE_INTEGER;

typedef CHAR * LPSTR;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS _KNONVOLATILE_CONTEXT_POINTERS, *P_KNONVOLATILE_CONTEXT_POINTERS;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS * PKNONVOLATILE_CONTEXT_POINTERS;

struct _KNONVOLATILE_CONTEXT_POINTERS {
    union _union_59 u;
    union _union_61 u2;
};

typedef EXCEPTION_ROUTINE * PEXCEPTION_ROUTINE;

typedef DWORD ACCESS_MASK;

typedef DWORD LCID;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef longlong INT_PTR;

typedef struct HBITMAP__ HBITMAP__, *PHBITMAP__;

struct HBITMAP__ {
    int unused;
};

typedef struct HKEY__ HKEY__, *PHKEY__;

struct HKEY__ {
    int unused;
};

typedef uchar UCHAR;

typedef UCHAR * PUCHAR;

typedef DWORD * LPDWORD;

typedef DWORD * PDWORD;

typedef struct HDC__ HDC__, *PHDC__;

struct HDC__ {
    int unused;
};

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

typedef struct HINSTANCE__ * HINSTANCE;

struct HINSTANCE__ {
    int unused;
};

typedef struct HRSRC__ HRSRC__, *PHRSRC__;

struct HRSRC__ {
    int unused;
};

typedef HINSTANCE HMODULE;

typedef HANDLE HLOCAL;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME * LPFILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

typedef INT_PTR (* FARPROC)(void);

typedef struct HDC__ * HDC;

typedef WORD * LPWORD;

typedef struct HKEY__ * HKEY;

typedef HKEY * PHKEY;

typedef HANDLE HGLOBAL;

typedef BOOL * LPBOOL;

typedef void * HGDIOBJ;

typedef BYTE * PBYTE;

typedef void * LPCVOID;

typedef struct HRSRC__ * HRSRC;

typedef DWORD COLORREF;

typedef struct HBITMAP__ * HBITMAP;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

struct IMAGE_FILE_HEADER {
    word Machine; // 34404
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY64 IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;

struct IMAGE_LOAD_CONFIG_DIRECTORY64 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    qword DeCommitFreeBlockThreshold;
    qword DeCommitTotalFreeThreshold;
    pointer64 LockPrefixTable;
    qword MaximumAllocationSize;
    qword VirtualMemoryThreshold;
    qword ProcessAffinityMask;
    dword ProcessHeapFlags;
    word CsdVersion;
    word DependentLoadFlags;
    pointer64 EditList;
    pointer64 SecurityCookie;
    pointer64 SEHandlerTable;
    qword SEHandlerCount;
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct IMAGE_OPTIONAL_HEADER64 IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

struct IMAGE_OPTIONAL_HEADER64 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    pointer64 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    qword SizeOfStackReserve;
    qword SizeOfStackCommit;
    qword SizeOfHeapReserve;
    qword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_WRITE=2147483648,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_TYPE_NO_PAD=8
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_NT_HEADERS64 IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;

struct IMAGE_NT_HEADERS64 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER64 OptionalHeader;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct IMAGE_DIRECTORY_ENTRY_EXPORT IMAGE_DIRECTORY_ENTRY_EXPORT, *PIMAGE_DIRECTORY_ENTRY_EXPORT;

struct IMAGE_DIRECTORY_ENTRY_EXPORT {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Name;
    dword Base;
    dword NumberOfFunctions;
    dword NumberOfNames;
    dword AddressOfFunctions;
    dword AddressOfNames;
    dword AddressOfNameOrdinals;
};

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef LONG LSTATUS;

typedef ACCESS_MASK REGSAM;

typedef struct tagPROPVARIANT tagPROPVARIANT, *PtagPROPVARIANT;

typedef struct tagPROPVARIANT PROPVARIANT;

struct tagPROPVARIANT {
};

typedef struct _tiddata _tiddata, *P_tiddata;

typedef struct _tiddata * _ptiddata;

typedef struct setloc_struct setloc_struct, *Psetloc_struct;

typedef struct setloc_struct _setloc_struct;

typedef struct _is_ctype_compatible _is_ctype_compatible, *P_is_ctype_compatible;

struct _is_ctype_compatible {
    ulong id;
    int is_clike;
};

struct setloc_struct {
    wchar_t * pchLanguage;
    wchar_t * pchCountry;
    int iLocState;
    int iPrimaryLen;
    BOOL bAbbrevLanguage;
    BOOL bAbbrevCountry;
    UINT _cachecp;
    wchar_t _cachein[131];
    wchar_t _cacheout[131];
    struct _is_ctype_compatible _Loc_c[5];
    wchar_t _cacheLocaleName[85];
};

struct _tiddata {
    ulong _tid;
    uintptr_t _thandle;
    int _terrno;
    ulong _tdoserrno;
    uint _fpds;
    ulong _holdrand;
    char * _token;
    wchar_t * _wtoken;
    uchar * _mtoken;
    char * _errmsg;
    wchar_t * _werrmsg;
    char * _namebuf0;
    wchar_t * _wnamebuf0;
    char * _namebuf1;
    wchar_t * _wnamebuf1;
    char * _asctimebuf;
    wchar_t * _wasctimebuf;
    void * _gmtimebuf;
    char * _cvtbuf;
    uchar _con_ch_buf[5];
    ushort _ch_buf_used;
    void * _initaddr;
    void * _initarg;
    void * _pxcptacttab;
    void * _tpxcptinfoptrs;
    int _tfpecode;
    pthreadmbcinfo ptmbcinfo;
    pthreadlocinfo ptlocinfo;
    int _ownlocale;
    ulong _NLG_dwCode;
    void * _terminate;
    void * _unexpected;
    void * _translator;
    void * _purecall;
    void * _curexception;
    void * _curcontext;
    int _ProcessingThrow;
    void * _curexcspec;
    void * _pExitContext;
    void * _pUnwindContext;
    void * _pFrameInfoChain;
    ulonglong _ImageBase;
    ulonglong _ThrowImageBase;
    void * _pForeignException;
    _setloc_struct _setloc_data;
    void * _reserved1;
    void * _reserved2;
    void * _reserved3;
    void * _reserved4;
    void * _reserved5;
    int _cxxReThrow;
    ulong __initDomain;
    int _initapartment;
};

typedef dword unsigned_long;

typedef struct _s_CatchableType _s_CatchableType, *P_s_CatchableType;

struct _s_CatchableType { // PlaceHolder Structure
};

typedef struct _xDISPATCHER_CONTEXT _xDISPATCHER_CONTEXT, *P_xDISPATCHER_CONTEXT;

struct _xDISPATCHER_CONTEXT { // PlaceHolder Structure
};

typedef struct EHExceptionRecord EHExceptionRecord, *PEHExceptionRecord;

struct EHExceptionRecord { // PlaceHolder Structure
};

typedef dword unsigned___int64;

typedef struct _LocaleUpdate _LocaleUpdate, *P_LocaleUpdate;

struct _LocaleUpdate { // PlaceHolder Structure
};

typedef struct _s_ESTypeList _s_ESTypeList, *P_s_ESTypeList;

struct _s_ESTypeList { // PlaceHolder Structure
};

typedef dword unsigned_int;

typedef dword unsigned_char;

typedef struct CAtlBaseModule CAtlBaseModule, *PCAtlBaseModule;

struct CAtlBaseModule { // PlaceHolder Structure
};

typedef int (* _onexit_t)(void);

typedef struct _CRT_FLOAT _CRT_FLOAT, *P_CRT_FLOAT;

struct _CRT_FLOAT {
    float f;
};

typedef struct IUnknownVtbl IUnknownVtbl, *PIUnknownVtbl;

typedef struct IUnknown IUnknown, *PIUnknown;

struct IUnknownVtbl {
    HRESULT (* QueryInterface)(struct IUnknown *, IID *, void * *);
    ULONG (* AddRef)(struct IUnknown *);
    ULONG (* Release)(struct IUnknown *);
};

struct IUnknown {
    struct IUnknownVtbl * lpVtbl;
};

typedef struct IUnknown * LPUNKNOWN;




void FUN_1800010c0(void)

{
  DAT_180055088 = TlsAlloc();
  atexit(&LAB_180033e30);
  return;
}



bool FUN_180001200(PUCHAR param_1,ULONG param_2)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_res18 [2];
  
  NVar1 = BCryptOpenAlgorithmProvider(local_res18,L"RNG",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenRandom(local_res18[0],param_1,param_2,0);
    BCryptCloseAlgorithmProvider(local_res18[0],0);
  }
  return -1 < NVar1;
}



bool FUN_180001270(PUCHAR *param_1,ULONG *param_2,uint param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28;
  BCRYPT_ALG_HANDLE local_20;
  
  uVar2 = 0;
  local_20 = (BCRYPT_ALG_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_20,L"SHA256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_20,&local_28,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
    if (-1 < NVar1) {
      if (param_3 != 0) {
        do {
          if ((*param_1 != (PUCHAR)0x0) && (*param_2 != 0)) {
            NVar1 = BCryptHashData(local_28,*param_1,*param_2,0);
            if (NVar1 < 0) goto LAB_180001345;
          }
          uVar2 = uVar2 + 1;
          param_1 = param_1 + 1;
          param_2 = param_2 + 1;
        } while (uVar2 < param_3);
      }
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_28,param_4,0x20,0);
      }
LAB_180001345:
      BCryptDestroyHash(local_28);
    }
    BCryptCloseAlgorithmProvider(local_20,0);
  }
  return -1 < NVar1;
}



void FUN_180001390(PUCHAR param_1,ULONG param_2,PUCHAR param_3)

{
  PUCHAR local_res8;
  ULONG local_res10 [6];
  
  local_res8 = param_1;
  local_res10[0] = param_2;
  FUN_180001270(&local_res8,local_res10,1,param_3);
  return;
}



bool FUN_1800013c0(PUCHAR param_1,ULONG param_2,PUCHAR *param_3,ULONG *param_4,uint param_5,
                  PUCHAR param_6,BCRYPT_ALG_HANDLE *param_7)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28 [2];
  
  NVar1 = BCryptCreateHash(*param_7,local_28,(PUCHAR)0x0,0,param_1,param_2,0);
  if (-1 < NVar1) {
    uVar2 = 0;
    if (param_5 != 0) {
      do {
        if (((*param_3 != (PUCHAR)0x0) && (*param_4 != 0)) &&
           (NVar1 = BCryptHashData(local_28[0],*param_3,*param_4,0), NVar1 < 0)) goto LAB_180001483;
        uVar2 = uVar2 + 1;
        param_3 = param_3 + 1;
        param_4 = param_4 + 1;
      } while (uVar2 < param_5);
    }
    if (-1 < NVar1) {
      NVar1 = BCryptFinishHash(local_28[0],param_6,0x20,0);
    }
LAB_180001483:
    BCryptDestroyHash(local_28[0]);
  }
  BCryptCloseAlgorithmProvider(*param_7,0);
  return -1 < NVar1;
}



undefined FUN_1800014d0(PUCHAR param_1,ULONG param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  PUCHAR local_res18;
  ULONG local_res20 [2];
  BCRYPT_ALG_HANDLE local_18 [2];
  
  local_res18 = param_3;
  local_res20[0] = param_4;
  NVar2 = BCryptOpenAlgorithmProvider(local_18,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar2) {
    bVar1 = FUN_1800013c0(param_1,param_2,&local_res18,local_res20,1,param_5,local_18);
    return bVar1;
  }
  return 0;
}



NTSTATUS FUN_180001560(PUCHAR *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pszAlgId;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38;
  UCHAR local_30 [40];
  
  local_48[0] = 0x40;
  local_38 = (BCRYPT_ALG_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_180001270(param_1,param_2,1,local_30);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pszAlgId = L"ECDSA_P256";
    if (*param_4 == 0x324b4345) {
      pszAlgId = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_38,pszAlgId,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      NVar2 = BCryptImportKeyPair(local_38,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_40,
                                  (PUCHAR)param_4,0x68,0);
      if (-1 < NVar2) {
        NVar2 = BCryptSignHash(local_40,(void *)0x0,local_30,0x20,param_6,local_48[0],local_48,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return NVar2;
}



NTSTATUS FUN_180001690(PUCHAR *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pwVar3;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_ALG_HANDLE local_30;
  UCHAR local_28 [32];
  
  local_30 = (BCRYPT_ALG_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_180001270(param_1,param_2,1,local_28);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pwVar3 = L"ECDSA_P256";
    if (*param_4 == 0x314b4345) {
      pwVar3 = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_30,pwVar3,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      pwVar3 = L"ECCPUBLICBLOB";
      if (*param_4 == 0x32534345) {
        pwVar3 = L"ECCPRIVATEBLOB";
      }
      NVar2 = BCryptImportKeyPair(local_30,(BCRYPT_KEY_HANDLE)0x0,pwVar3,&local_38,(PUCHAR)param_4,
                                  0x48,0);
      if (-1 < NVar2) {
        NVar2 = BCryptVerifySignature(local_38,(void *)0x0,local_28,0x20,param_6,0x40,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return NVar2;
}



NTSTATUS FUN_1800017b0(PUCHAR param_1,PUCHAR param_2,PVOID param_3,ULONG param_4,PUCHAR param_5,
                      ULONG param_6)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_68;
  BCRYPT_SECRET_HANDLE local_60;
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_KEY_HANDLE local_50;
  BCryptBufferDesc local_48;
  _BCryptBuffer local_38;
  undefined8 local_28;
  wchar_t *local_20;
  
  local_68 = (BCRYPT_ALG_HANDLE)0x0;
  local_50 = (BCRYPT_KEY_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_60 = (BCRYPT_SECRET_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"ECDH_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_50,param_1,
                                0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPUBLICBLOB",&local_58,param_2
                                  ,0x48,0);
      if (-1 < NVar1) {
        NVar1 = BCryptSecretAgreement(local_50,local_58,&local_60,0);
        if (-1 < NVar1) {
          local_20 = L"SHA256";
          local_48.pBuffers = (PBCryptBuffer)&local_38;
          local_38.BufferType = 3;
          local_28 = 0xe;
          local_48.cBuffers = 2;
          local_48.ulVersion = 0;
          local_38.cbBuffer = param_4;
          local_38.pvBuffer = param_3;
          NVar1 = BCryptDeriveKey(local_60,L"HMAC",&local_48,param_5,param_6,&param_6,0);
          if (-1 < NVar1) {
            NVar1 = 0;
          }
        }
      }
    }
  }
  if (local_60 != (BCRYPT_SECRET_HANDLE)0x0) {
    BCryptDestroySecret(local_60);
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
  }
  if (local_50 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_50);
  }
  if (local_68 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_68,0);
  }
  return NVar1;
}



bool FUN_180001970(undefined4 *param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  undefined8 uVar2;
  PUCHAR local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff68;
  int local_78;
  undefined4 local_74;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;
  
  uVar2 = 0x68;
  local_res10 = param_2;
  local_res18[0] = param_3;
  FUN_1800244a0((undefined (*) [16])&local_78,0,0x68);
  local_30 = *param_1;
  uStack44 = param_1[1];
  uStack40 = param_1[2];
  uStack36 = param_1[3];
  local_20 = param_1[4];
  uStack28 = param_1[5];
  uStack24 = param_1[6];
  uStack20 = param_1[7];
  local_78 = 0x32534345;
  local_74 = 0x20;
  NVar1 = FUN_180001560(&local_res10,local_res18,uVar2,&local_78,in_stack_ffffffffffffff68,param_4);
  return -1 < NVar1;
}



bool FUN_180001a00(undefined8 *param_1,PUCHAR param_2,undefined8 param_3,PUCHAR param_4,
                  undefined4 *param_5)

{
  NTSTATUS NVar1;
  PUCHAR local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff88;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 uStack72;
  undefined8 local_40;
  undefined8 uStack56;
  undefined8 local_30;
  undefined8 uStack40;
  undefined8 local_20;
  undefined8 uStack24;
  
  local_res18[0] = (ULONG)param_3;
  local_50 = *param_1;
  uStack72 = param_1[1];
  local_40 = param_1[2];
  uStack56 = param_1[3];
  local_30 = param_1[4];
  uStack40 = param_1[5];
  local_20 = param_1[6];
  uStack24 = param_1[7];
  local_58 = 0x2031534345;
  local_res10 = param_2;
  NVar1 = FUN_180001690(&local_res10,local_res18,param_3,(int *)&local_58,in_stack_ffffffffffffff88,
                        param_4);
  if (-1 < NVar1) {
    *param_5 = 1;
    return true;
  }
  *param_5 = 0;
  return NVar1 == -0x3fff6000;
}



bool FUN_180001ac0(PUCHAR param_1)

{
  NTSTATUS NVar1;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"ECDSA_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_res20,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_res18,
                                param_1,0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                              local_res10,0);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



bool FUN_180001ba0(PUCHAR param_1,int param_2)

{
  NTSTATUS NVar1;
  wchar_t *pszAlgId;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  pszAlgId = L"ECDSA_P256";
  if (param_2 != 0) {
    pszAlgId = L"ECDH_P256";
  }
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,pszAlgId,(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenerateKeyPair(local_res20,&local_res18,0x100,0);
    if (-1 < NVar1) {
      NVar1 = BCryptFinalizeKeyPair(local_res18,0);
      if (-1 < NVar1) {
        NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                                local_res10,0);
        if (-1 < NVar1) {
          NVar1 = 0;
        }
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



undefined4 *
FUN_180001c90(uint param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,undefined8 *param_5,
             uint *param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  
  uVar2 = param_2 + 0x18 + param_1;
  puVar1 = (undefined4 *)LocalAlloc(0,(ulonglong)uVar2);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0x31415352;
    puVar1[1] = param_1 * 8;
    *(undefined8 *)(puVar1 + 4) = 0;
    puVar1[2] = param_2;
    puVar1[3] = param_1;
    FUN_180023f20((undefined8 *)(puVar1 + 6),param_3,(ulonglong)param_2);
    FUN_180023f20((undefined8 *)((ulonglong)param_2 + (longlong)(puVar1 + 6)),param_4,
                  (ulonglong)param_1);
    *param_5 = puVar1;
    *param_6 = uVar2;
    puVar1 = (undefined4 *)0x1;
  }
  return puVar1;
}



undefined4 FUN_180001d50(longlong param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



void FUN_180001d60(HLOCAL param_1)

{
  if (param_1 != (HLOCAL)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180001d65. Too many branches
                    // WARNING: Treating indirect jump as call
    LocalFree(param_1);
    return;
  }
  return;
}



bool FUN_180001d70(int *param_1,ULONG param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5,
                  ULONG param_6,ULONG *param_7)

{
  NTSTATUS NVar1;
  wchar_t *pszBlobType;
  ULONG *pcbResult;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_ALG_HANDLE local_50;
  wchar_t *local_48;
  undefined8 local_40;
  undefined4 local_38;
  
  local_48 = L"SHA256";
  local_40 = 0;
  pcbResult = local_res10;
  if (param_7 != (ULONG *)0x0) {
    pcbResult = param_7;
  }
  local_50 = (BCRYPT_ALG_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_38 = 0;
  local_res10[0] = 0;
  if (param_2 == 0) {
    if (*param_1 == 0x31415352) {
      param_2 = param_1[2] + 0x18 + param_1[3];
    }
    else {
      if (*param_1 == 0x33415352) {
        param_2 = (param_1[4] + 8) * 3 + (param_1[5] + param_1[3]) * 2 + param_1[2];
      }
    }
  }
  NVar1 = BCryptOpenAlgorithmProvider(&local_50,L"RSA",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    pszBlobType = L"RSAFULLPRIVATEBLOB";
    if (*param_1 == 0x31415352) {
      pszBlobType = L"RSAPUBLICBLOB";
    }
    NVar1 = BCryptImportKeyPair(local_50,(BCRYPT_KEY_HANDLE)0x0,pszBlobType,&local_58,
                                (PUCHAR)param_1,param_2,0);
    if (-1 < NVar1) {
      NVar1 = BCryptEncrypt(local_58,param_3,param_4,&local_48,(PUCHAR)0x0,0,param_5,param_6,
                            pcbResult,4);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
    local_58 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_50 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_50,0);
  }
  return -1 < NVar1;
}



undefined8
FUN_180001f00(undefined4 *param_1,undefined8 param_2,undefined4 *param_3,ulonglong param_4)

{
  NTSTATUS NVar1;
  undefined8 uVar2;
  BCRYPT_KEY_HANDLE local_res10 [2];
  ulonglong local_res20;
  BCRYPT_ALG_HANDLE local_98 [2];
  UCHAR local_88 [8];
  undefined4 local_80;
  undefined4 uStack124;
  undefined4 uStack120;
  undefined4 uStack116;
  undefined4 local_70;
  undefined4 uStack108;
  undefined4 uStack104;
  undefined4 uStack100;
  undefined4 local_60;
  undefined4 uStack92;
  undefined4 uStack88;
  undefined4 uStack84;
  undefined4 local_50;
  undefined4 uStack76;
  undefined4 uStack72;
  undefined4 uStack68;
  undefined4 local_40;
  undefined4 uStack60;
  undefined4 uStack56;
  undefined4 uStack52;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  
  local_98[0] = (BCRYPT_ALG_HANDLE)0x0;
  local_res10[0] = (BCRYPT_KEY_HANDLE)0x0;
  local_res20 = param_4 & 0xffffffff00000000;
  NVar1 = BCryptOpenAlgorithmProvider(local_98,L"ECDH_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenerateKeyPair(local_98[0],local_res10,0x100,0);
    if (-1 < NVar1) {
      NVar1 = BCryptFinalizeKeyPair(local_res10[0],0);
      if (-1 < NVar1) {
        NVar1 = BCryptExportKey(local_res10[0],(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",local_88,
                                0x68,(ULONG *)&local_res20,0);
        if (-1 < NVar1) {
          NVar1 = 0;
        }
      }
    }
  }
  if (local_res10[0] != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res10[0]);
    local_res10[0] = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_98[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_98[0],0);
  }
  if (NVar1 < 0) {
    uVar2 = 0;
  }
  else {
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = local_40;
      param_1[1] = uStack60;
      param_1[2] = uStack56;
      param_1[3] = uStack52;
      param_1[4] = local_30;
      param_1[5] = uStack44;
      param_1[6] = uStack40;
      param_1[7] = uStack36;
    }
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = local_80;
      param_3[1] = uStack124;
      param_3[2] = uStack120;
      param_3[3] = uStack116;
      param_3[4] = local_70;
      param_3[5] = uStack108;
      param_3[6] = uStack104;
      param_3[7] = uStack100;
      param_3[8] = local_60;
      param_3[9] = uStack92;
      param_3[10] = uStack88;
      param_3[0xb] = uStack84;
      param_3[0xc] = local_50;
      param_3[0xd] = uStack76;
      param_3[0xe] = uStack72;
      param_3[0xf] = uStack68;
    }
    uVar2 = 1;
  }
  return uVar2;
}



bool FUN_180002060(undefined4 *param_1,int param_2,undefined4 *param_3,int param_4,PVOID param_5,
                  ULONG param_6,PUCHAR param_7,ULONG param_8)

{
  NTSTATUS NVar1;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 uStack188;
  undefined4 uStack184;
  undefined4 uStack180;
  undefined4 local_b0;
  undefined4 uStack172;
  undefined4 uStack168;
  undefined4 uStack164;
  undefined4 local_a0;
  undefined4 uStack156;
  undefined4 uStack152;
  undefined4 uStack148;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;
  
  if ((param_2 == 0x20) && (param_4 == 0x40)) {
    FUN_1800244a0((undefined (*) [16])&local_78,0,0x68);
    local_30 = *param_1;
    uStack44 = param_1[1];
    uStack40 = param_1[2];
    uStack36 = param_1[3];
    local_20 = param_1[4];
    uStack28 = param_1[5];
    uStack24 = param_1[6];
    uStack20 = param_1[7];
    local_c0 = *param_3;
    uStack188 = param_3[1];
    uStack184 = param_3[2];
    uStack180 = param_3[3];
    local_78 = 0x324b4345;
    local_b0 = param_3[4];
    uStack172 = param_3[5];
    uStack168 = param_3[6];
    uStack164 = param_3[7];
    local_a0 = param_3[8];
    uStack156 = param_3[9];
    uStack152 = param_3[10];
    uStack148 = param_3[0xb];
    local_74 = 0x20;
    local_c8 = 0x314b4345;
    local_c4 = 0x20;
    local_90 = param_3[0xc];
    uStack140 = param_3[0xd];
    uStack136 = param_3[0xe];
    uStack132 = param_3[0xf];
    NVar1 = FUN_1800017b0((PUCHAR)&local_78,(PUCHAR)&local_c8,param_5,param_6,param_7,param_8);
    return -1 < NVar1;
  }
  return false;
}



bool FUN_180002160(PUCHAR param_1,uint param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7,ULONG *param_8)

{
  uint uVar1;
  PUCHAR pUVar2;
  NTSTATUS NVar3;
  uint cbInput;
  uint *pcbResult;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_HANDLE local_30;
  
  uVar1 = param_5;
  cbInput = (param_5 / param_2) * param_2;
  pcbResult = &param_5;
  if (param_8 != (ULONG *)0x0) {
    pcbResult = param_8;
  }
  local_30 = (BCRYPT_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  param_5 = 0;
  NVar3 = BCryptOpenAlgorithmProvider(&local_30,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar3) &&
     (NVar3 = BCryptSetProperty(local_30,L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar3)) {
    NVar3 = BCryptGenerateSymmetricKey(local_30,&local_38,(PUCHAR)0x0,0,param_1,param_2,0);
    pUVar2 = param_6;
    if (-1 < NVar3) {
      if (cbInput != 0) {
        NVar3 = BCryptEncrypt(local_38,param_4,cbInput,(void *)0x0,param_3,0x10,param_6,param_7,
                              pcbResult,0);
        if (NVar3 < 0) goto LAB_1800022b9;
        if (cbInput != *pcbResult) {
          NVar3 = -0x3fffffff;
          goto LAB_1800022b9;
        }
      }
      NVar3 = 0;
      if (cbInput < uVar1) {
        if (param_4 != pUVar2) {
          FUN_180023f20((undefined8 *)(pUVar2 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(uVar1 - cbInput));
        }
        *pcbResult = uVar1;
      }
    }
  }
LAB_1800022b9:
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return -1 < NVar3;
}



bool FUN_180002310(PUCHAR param_1,undefined8 param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7)

{
  uint uVar1;
  PUCHAR pUVar2;
  NTSTATUS NVar3;
  uint cbInput;
  uint local_res10 [2];
  BCRYPT_KEY_HANDLE pvStack0000000000000040;
  BCRYPT_HANDLE local_38 [2];
  
  uVar1 = param_5;
  local_38[0] = (BCRYPT_HANDLE)0x0;
  pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  cbInput = param_5 & 0xffffffe0;
  local_res10[0] = 0;
  NVar3 = BCryptOpenAlgorithmProvider(local_38,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar3) &&
     (NVar3 = BCryptSetProperty(local_38[0],L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar3)) {
    NVar3 = BCryptGenerateSymmetricKey
                      (local_38[0],(BCRYPT_KEY_HANDLE *)&stack0x00000040,(PUCHAR)0x0,0,param_1,0x20,
                       0);
    pUVar2 = param_6;
    if (-1 < NVar3) {
      if (cbInput != 0) {
        NVar3 = BCryptDecrypt(pvStack0000000000000040,param_4,cbInput,(void *)0x0,param_3,0x10,
                              param_6,param_7,local_res10,0);
        if (NVar3 < 0) goto LAB_18000245d;
        if (cbInput != local_res10[0]) {
          NVar3 = -0x3fffffff;
          goto LAB_18000245d;
        }
      }
      NVar3 = 0;
      if (cbInput < uVar1) {
        if (param_4 != pUVar2) {
          FUN_180023f20((undefined8 *)(pUVar2 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(uVar1 - cbInput));
        }
        local_res10[0] = uVar1;
      }
    }
  }
LAB_18000245d:
  if (pvStack0000000000000040 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack0000000000000040);
    pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38[0],0);
  }
  return -1 < NVar3;
}



bool FUN_1800024b0(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  NTSTATUS NVar4;
  PUCHAR pUVar5;
  ulonglong uVar6;
  uint uVar7;
  uint *puVar8;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_HANDLE local_38;
  uint local_30 [6];
  
  uVar7 = 0;
  local_38 = (BCRYPT_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  local_48[0] = 0;
  NVar4 = BCryptOpenAlgorithmProvider(&local_38,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar4) &&
       (NVar4 = BCryptSetProperty(local_38,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar4)) &&
      (NVar4 = BCryptGenerateSymmetricKey(local_38,&local_40,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar4)) && (NVar4 = 0, param_5 != 0)) {
    do {
      if (uVar7 == 0) {
        NVar4 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)local_30,0x10,
                              local_48,0);
        if (NVar4 < 0) break;
        pUVar5 = param_2 + 0xf;
        do {
          *pUVar5 = *pUVar5 + '\x01';
          if (*pUVar5 != '\0') break;
          pUVar5 = pUVar5 + -1;
        } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar6 = SEXT48((int)uVar7), 0xb < uVar6)) {
        if ((param_5 < 2) || (uVar6 = SEXT48((int)uVar7), 0xd < uVar6)) {
          bVar1 = *(byte *)param_3;
          puVar8 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)local_30 + (longlong)(int)uVar7) ^ bVar1;
          uVar7 = uVar7 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar8 = (uint *)((longlong)param_4 + 2);
          uVar2 = *(ushort *)param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar7 = uVar7 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)local_30 + uVar6) ^ uVar2;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar8 = param_4 + 1;
        uVar3 = *param_3;
        param_3 = param_3 + 1;
        uVar7 = uVar7 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)local_30 + uVar6) ^ uVar3;
        param_5 = param_5 - 4;
      }
      param_4 = puVar8;
      NVar4 = 0;
    } while (param_5 != 0);
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return -1 < NVar4;
}



bool thunk_FUN_1800024b0(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  NTSTATUS NVar4;
  PUCHAR pUVar5;
  ulonglong uVar6;
  uint uVar7;
  uint *puVar8;
  ULONG aUStack72 [2];
  BCRYPT_KEY_HANDLE pvStack64;
  BCRYPT_HANDLE pvStack56;
  uint auStack48 [6];
  
  uVar7 = 0;
  pvStack56 = (BCRYPT_HANDLE)0x0;
  pvStack64 = (BCRYPT_KEY_HANDLE)0x0;
  aUStack72[0] = 0;
  NVar4 = BCryptOpenAlgorithmProvider(&pvStack56,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar4) &&
       (NVar4 = BCryptSetProperty(pvStack56,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar4)) &&
      (NVar4 = BCryptGenerateSymmetricKey(pvStack56,&pvStack64,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar4)) && (NVar4 = 0, param_5 != 0)) {
    do {
      if (uVar7 == 0) {
        NVar4 = BCryptEncrypt(pvStack64,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)auStack48,
                              0x10,aUStack72,0);
        if (NVar4 < 0) break;
        pUVar5 = param_2 + 0xf;
        do {
          *pUVar5 = *pUVar5 + '\x01';
          if (*pUVar5 != '\0') break;
          pUVar5 = pUVar5 + -1;
        } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar6 = SEXT48((int)uVar7), 0xb < uVar6)) {
        if ((param_5 < 2) || (uVar6 = SEXT48((int)uVar7), 0xd < uVar6)) {
          bVar1 = *(byte *)param_3;
          puVar8 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)auStack48 + (longlong)(int)uVar7) ^ bVar1;
          uVar7 = uVar7 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar8 = (uint *)((longlong)param_4 + 2);
          uVar2 = *(ushort *)param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar7 = uVar7 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)auStack48 + uVar6) ^ uVar2;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar8 = param_4 + 1;
        uVar3 = *param_3;
        param_3 = param_3 + 1;
        uVar7 = uVar7 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)auStack48 + uVar6) ^ uVar3;
        param_5 = param_5 - 4;
      }
      param_4 = puVar8;
      NVar4 = 0;
    } while (param_5 != 0);
  }
  if (pvStack64 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack64);
    pvStack64 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (pvStack56 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(pvStack56,0);
  }
  return -1 < NVar4;
}



undefined8
FUN_1800026f0(PUCHAR param_1,undefined8 param_2,ulonglong param_3,undefined *param_4,
             undefined8 param_5,undefined8 *param_6)

{
  NTSTATUS NVar1;
  ulonglong **ppuVar2;
  ULONG *pUVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  undefined8 *puVar7;
  ulonglong local_res18;
  BCRYPT_HASH_HANDLE local_res20;
  uint uStack0000000000000038;
  BCRYPT_ALG_HANDLE local_a8;
  ULONG local_a0 [2];
  uint local_98;
  undefined4 local_94;
  ulonglong *local_90 [4];
  undefined8 local_70 [6];
  
  local_90[0] = &local_res18;
  local_90[1] = (ulonglong *)0x18004d508;
  local_90[2] = &param_5;
  if (param_4 != (undefined *)0x0) {
    local_90[2] = (ulonglong *)param_4;
  }
  uVar6 = 0x20;
  local_90[3] = &param_5;
  local_a0[0] = 4;
  local_98 = 4;
  if (param_4 != (undefined *)0x0) {
    local_98 = uVar6;
  }
  local_a0[1] = 7;
  local_94 = 4;
  param_5._0_4_ = 0x10000;
  uStack0000000000000038 = 1;
  puVar7 = param_6;
  local_res18 = param_3;
  do {
    uVar4 = uStack0000000000000038;
    local_res18 = local_res18 & 0xffffffff00000000 |
                  (ulonglong)
                  (((uint)(ushort)((short)uStack0000000000000038 << 8) |
                   uStack0000000000000038 >> 8 & 0xff) << 0x10 |
                   (uint)(ushort)((short)((ulonglong)(longlong)(int)uStack0000000000000038 >> 0x10)
                                 << 8) |
                  (uint)((ulonglong)(longlong)(int)uStack0000000000000038 >> 0x18) & 0xff);
    NVar1 = BCryptOpenAlgorithmProvider(&local_a8,L"SHA256",(LPCWSTR)0x0,8);
    if (NVar1 < 0) {
      return 0;
    }
    NVar1 = BCryptCreateHash(local_a8,&local_res20,(PUCHAR)0x0,0,param_1,0x20,0);
    if (-1 < NVar1) {
      uVar4 = 0;
      if ((param_4 != (undefined *)0x0) != 0xfffffffd) {
        pUVar3 = local_a0;
        ppuVar2 = local_90;
        do {
          if (((*ppuVar2 != (ulonglong *)0x0) && (*pUVar3 != 0)) &&
             (NVar1 = BCryptHashData(local_res20,(PUCHAR)*ppuVar2,*pUVar3,0), NVar1 < 0))
          goto LAB_18000288b;
          uVar4 = uVar4 + 1;
          ppuVar2 = ppuVar2 + 1;
          pUVar3 = pUVar3 + 1;
        } while (uVar4 < (param_4 != (undefined *)0x0) + 3);
      }
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res20,(PUCHAR)local_70,0x20,0);
      }
LAB_18000288b:
      BCryptDestroyHash(local_res20);
      uVar4 = uStack0000000000000038;
    }
    BCryptCloseAlgorithmProvider(local_a8,0);
    if (NVar1 < 0) {
      return 0;
    }
    uVar5 = 0x20;
    if (uVar6 < 0x20) {
      uVar5 = uVar6;
    }
    FUN_180023f20(puVar7,local_70,(ulonglong)uVar5);
    uStack0000000000000038 = uVar4 + 1;
    puVar7 = (undefined8 *)((longlong)puVar7 + (ulonglong)uVar5);
    uVar6 = uVar6 - uVar5;
    if (uVar6 == 0) {
      return 1;
    }
  } while( true );
}



// WARNING: Could not reconcile some variable overlaps

UINT FUN_180002900(void)

{
  char cVar1;
  short sVar2;
  bool bVar3;
  UINT BufferSize;
  UINT UVar4;
  NTSTATUS NVar5;
  HANDLE pvVar6;
  LPVOID pFirmwareTableBuffer;
  short *psVar7;
  short *psVar8;
  LPVOID pvVar9;
  int iVar10;
  short *psVar11;
  uint uVar12;
  undefined8 *puVar14;
  PUCHAR *ppUVar15;
  undefined8 local_res8;
  BCRYPT_HASH_HANDLE local_res10;
  BCRYPT_ALG_HANDLE local_res18;
  undefined local_38 [16];
  LPVOID pvVar13;
  
  pvVar13 = (LPVOID)0x0;
  bVar3 = false;
  local_res8 = 0;
  uVar12 = 0;
  local_38 = ZEXT816(0);
  BufferSize = GetSystemFirmwareTable(0x52534d42,0,(PVOID)0x0,0);
  if (BufferSize == 0) {
    return BufferSize;
  }
  pvVar6 = GetProcessHeap();
  pFirmwareTableBuffer = HeapAlloc(pvVar6,0,(ulonglong)BufferSize);
  pvVar9 = pFirmwareTableBuffer;
  if (pFirmwareTableBuffer == (LPVOID)0x0) goto LAB_180002b93;
  UVar4 = GetSystemFirmwareTable(0x52534d42,0,pFirmwareTableBuffer,BufferSize);
  if (BufferSize == UVar4) {
    psVar7 = (short *)((longlong)pFirmwareTableBuffer + 8);
    psVar11 = (short *)((ulonglong)*(uint *)((longlong)pFirmwareTableBuffer + 4) +
                       (longlong)pFirmwareTableBuffer);
    if (psVar7 < psVar11) {
      while (*(char *)psVar7 != '\x01') {
        psVar7 = (short *)((longlong)psVar7 + (ulonglong)*(byte *)((longlong)psVar7 + 1));
        if (psVar11 <= psVar7) goto LAB_180002a80;
        sVar2 = *psVar7;
        while (sVar2 != 0) {
          if (psVar11 <= psVar7) goto LAB_180002a80;
          psVar7 = (short *)((longlong)psVar7 + 1);
          sVar2 = *psVar7;
        }
        if ((psVar11 <= psVar7) || (psVar7 = psVar7 + 1, psVar11 <= psVar7)) goto LAB_180002a80;
      }
      if ((*(longlong *)(psVar7 + 4) != *(longlong *)(psVar7 + 8)) ||
         (*(longlong *)(psVar7 + 4) - 1U < 0xfffffffffffffffe)) {
        bVar3 = true;
        local_38 = CONCAT88(local_38._8_8_,psVar7 + 4);
        local_res8 = CONCAT44(local_res8._4_4_,0x10);
      }
      if ((*(char *)((longlong)psVar7 + 7) != '\0') &&
         (psVar8 = (short *)((longlong)psVar7 + (ulonglong)*(byte *)((longlong)psVar7 + 1)),
         psVar8 < psVar11)) {
        iVar10 = *(byte *)((longlong)psVar7 + 7) - 1;
        if (iVar10 != 0) goto LAB_180002a30;
        goto LAB_180002a54;
      }
    }
  }
  goto LAB_180002a80;
  while( true ) {
    psVar8 = (short *)((longlong)psVar8 + 1);
    iVar10 = iVar10 + -1;
    if (iVar10 == 0) break;
LAB_180002a30:
    cVar1 = *(char *)psVar8;
    while (cVar1 != '\0') {
      if (psVar11 <= psVar8) goto LAB_180002a50;
      psVar8 = (short *)((longlong)psVar8 + 1);
      cVar1 = *(char *)psVar8;
    }
    if (psVar11 <= psVar8) {
LAB_180002a50:
      if (iVar10 != 0) goto LAB_180002a80;
      break;
    }
  }
LAB_180002a54:
  local_38 = CONCAT88(psVar8,local_38._0_8_);
  cVar1 = *(char *)psVar8;
  psVar7 = psVar8;
  while (cVar1 != '\0') {
    if (psVar11 <= psVar7) goto LAB_180002a80;
    psVar7 = (short *)((longlong)psVar7 + 1);
    cVar1 = *(char *)psVar7;
  }
  if (psVar7 < psVar11) {
    uVar12 = ((int)psVar7 - (int)psVar8) + 1;
    local_res8 = local_res8 & 0xffffffff | (ulonglong)uVar12 << 0x20;
  }
LAB_180002a80:
  if ((bVar3) || (pvVar9 = pvVar13, uVar12 != 0)) {
    local_res18 = (BCRYPT_ALG_HANDLE)0x0;
    NVar5 = BCryptOpenAlgorithmProvider(&local_res18,L"SHA256",(LPCWSTR)0x0,0);
    if (-1 < NVar5) {
      NVar5 = BCryptCreateHash(local_res18,&local_res10,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
      if (-1 < NVar5) {
        puVar14 = &local_res8;
        ppUVar15 = (PUCHAR *)local_38;
        do {
          if (((*ppUVar15 != (PUCHAR)0x0) && (*(ULONG *)puVar14 != 0)) &&
             (NVar5 = BCryptHashData(local_res10,*ppUVar15,*(ULONG *)puVar14,0), NVar5 < 0))
          goto LAB_180002b58;
          uVar12 = (int)pvVar13 + 1;
          pvVar13 = (LPVOID)(ulonglong)uVar12;
          ppUVar15 = ppUVar15 + 1;
          puVar14 = (undefined8 *)((longlong)puVar14 + 4);
        } while (uVar12 < 2);
        if (-1 < NVar5) {
          NVar5 = BCryptFinishHash(local_res10,&DAT_1800569d8,0x20,0);
        }
LAB_180002b58:
        BCryptDestroyHash(local_res10);
      }
      BCryptCloseAlgorithmProvider(local_res18,0);
    }
    pvVar9 = (LPVOID)(ulonglong)(-1 < NVar5);
  }
  pvVar6 = GetProcessHeap();
  HeapFree(pvVar6,0,pFirmwareTableBuffer);
LAB_180002b93:
  return (UINT)pvVar9;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_180002bb0(void)

{
  UINT UVar1;
  
  if (DAT_1800569f8 == '\0') {
    UVar1 = FUN_180002900();
    if (UVar1 == 0) {
      _DAT_1800569d8 = 0;
      _DAT_1800569e0 = 0;
      _DAT_1800569e8 = 0;
      _DAT_1800569f0 = 0;
    }
    DAT_1800569f8 = '\x01';
  }
  return &DAT_1800569d8;
}



longlong FUN_180002c00(uint param_1,longlong param_2)

{
  return param_2 + 0x40 + (ulonglong)param_1;
}



int FUN_180002c10(int *param_1,int *param_2)

{
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  if (param_2 != (int *)0x0) {
    *param_2 = param_1[2];
  }
  return param_1[3];
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_180002c30(undefined8 *param_1,uint param_2,undefined8 *param_3,ulonglong param_4,
             undefined4 *param_5,undefined4 *param_6,BCRYPT_HASH_HANDLE param_7)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  bool bVar4;
  NTSTATUS NVar5;
  UINT UVar6;
  undefined7 extraout_var;
  PUCHAR *ppUVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  undefined4 **ppuVar11;
  BCRYPT_ALG_HANDLE local_68;
  BCRYPT_HASH_HANDLE local_60 [2];
  undefined4 local_50;
  undefined4 uStack76;
  undefined4 uStack72;
  undefined4 uStack68;
  UCHAR local_40 [24];
  
  puVar3 = param_5;
  iVar2 = (int)(param_4 & 0xffffffff);
  iVar10 = param_2 + iVar2;
  *param_5 = 0x5366616b;
  param_5[1] = iVar10 + 0x40;
  param_5[2] = param_2;
  param_5[3] = iVar2;
  NVar5 = BCryptOpenAlgorithmProvider(&param_5,L"RNG",(LPCWSTR)0x0,0);
  if (-1 < NVar5) {
    BCryptGenRandom(param_5,(PUCHAR)(puVar3 + 4),0x10,0);
    BCryptCloseAlgorithmProvider(param_5,0);
  }
  NVar5 = BCryptOpenAlgorithmProvider(&param_5,L"RNG",(LPCWSTR)0x0,0);
  if (-1 < NVar5) {
    BCryptGenRandom(param_5,(PUCHAR)(puVar3 + 8),0x10,0);
    BCryptCloseAlgorithmProvider(param_5,0);
  }
  if (param_2 != 0) {
    FUN_180023f20((undefined8 *)(puVar3 + 0xc),param_1,(ulonglong)param_2);
  }
  FUN_180023f20((undefined8 *)((longlong)puVar3 + (ulonglong)param_2 + 0x30),param_3,
                param_4 & 0xffffffff);
  local_60[0] = puVar3 + 4;
  param_5._0_4_ = 0x10;
  local_60[1] = param_7;
  param_5._4_4_ = -(uint)(param_7 != (BCRYPT_HASH_HANDLE)0x0) & 0x20;
  if (DAT_1800569f8 == '\0') {
    UVar6 = FUN_180002900();
    if (UVar6 == 0) {
      _DAT_1800569d8 = 0;
      _DAT_1800569e0 = 0;
      _DAT_1800569e8 = 0;
      _DAT_1800569f0 = 0;
    }
    DAT_1800569f8 = '\x01';
  }
  NVar5 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar5) {
    uVar8 = 0;
    NVar5 = BCryptCreateHash(local_68,&param_7,(PUCHAR)0x0,0,&DAT_1800569d8,0x20,0);
    if (-1 < NVar5) {
      uVar9 = 0;
      ppuVar11 = &param_5;
      ppUVar7 = (PUCHAR *)local_60;
      do {
        if (((*ppUVar7 != (PUCHAR)0x0) && (*(ULONG *)ppuVar11 != 0)) &&
           (NVar5 = BCryptHashData(param_7,*ppUVar7,*(ULONG *)ppuVar11,0), NVar5 < 0))
        goto LAB_180002e25;
        uVar9 = uVar9 + 1;
        ppUVar7 = ppUVar7 + 1;
        ppuVar11 = (undefined4 **)((longlong)ppuVar11 + 4);
      } while (uVar9 < 2);
      if (-1 < NVar5) {
        NVar5 = BCryptFinishHash(param_7,(PUCHAR)&local_50,0x20,0);
      }
LAB_180002e25:
      BCryptDestroyHash(param_7);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if ((-1 < NVar5) &&
       (bVar4 = FUN_1800024b0((PUCHAR)&local_50,local_40,puVar3 + 8,puVar3 + 8,iVar10 + 0x10),
       (int)CONCAT71(extraout_var,bVar4) != 0)) {
      param_5._0_4_ = puVar3[1] + -0x10;
      local_60[0] = puVar3;
      if (DAT_1800569f8 == '\0') {
        UVar6 = FUN_180002900();
        if (UVar6 == 0) {
          _DAT_1800569d8 = 0;
          _DAT_1800569e0 = 0;
          _DAT_1800569e8 = 0;
          _DAT_1800569f0 = 0;
        }
        DAT_1800569f8 = '\x01';
      }
      NVar5 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
      if (-1 < NVar5) {
        NVar5 = BCryptCreateHash(local_68,&param_7,(PUCHAR)0x0,0,&DAT_1800569d8,0x20,0);
        if (-1 < NVar5) {
          ppuVar11 = &param_5;
          ppUVar7 = (PUCHAR *)local_60;
          do {
            if (((*ppUVar7 != (PUCHAR)0x0) && (*(ULONG *)ppuVar11 != 0)) &&
               (NVar5 = BCryptHashData(param_7,*ppUVar7,*(ULONG *)ppuVar11,0), NVar5 < 0))
            goto LAB_180002f62;
            uVar8 = uVar8 + 1;
            ppUVar7 = ppUVar7 + 1;
            ppuVar11 = (undefined4 **)((longlong)ppuVar11 + 4);
          } while (uVar8 < 2);
          if (-1 < NVar5) {
            NVar5 = BCryptFinishHash(param_7,(PUCHAR)&local_50,0x20,0);
          }
LAB_180002f62:
          BCryptDestroyHash(param_7);
        }
        BCryptCloseAlgorithmProvider(local_68,0);
        if (-1 < NVar5) {
          puVar1 = (undefined4 *)((ulonglong)(puVar3[1] - 0x10) + (longlong)puVar3);
          *puVar1 = local_50;
          puVar1[1] = uStack76;
          puVar1[2] = uStack72;
          puVar1[3] = uStack68;
          *param_6 = puVar3[1];
          return 1;
        }
      }
    }
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_180002fc0(int *param_1,uint *param_2,uint *param_3,uint *param_4,uint *param_5,longlong param_6)

{
  uint *puVar1;
  bool bVar2;
  UINT UVar3;
  NTSTATUS NVar4;
  int iVar5;
  PUCHAR pbSecret;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  int **ppiVar6;
  uint uVar7;
  ULONG *pUVar8;
  uint *puVar9;
  uint uVar10;
  ULONG local_res8;
  uint local_resc;
  uint *local_res10;
  uint *local_res20;
  BCRYPT_HASH_HANDLE local_b8;
  BCRYPT_ALG_HANDLE local_b0;
  longlong local_a8;
  longlong local_a0;
  UCHAR local_98 [16];
  int *local_88;
  longlong local_80;
  uint local_78 [16];
  
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  local_res8 = param_1[1] - 0x10;
  local_80 = param_6;
  local_resc = -(uint)(param_6 != 0) & 0x20;
  local_res10 = param_2;
  local_res20 = param_4;
  local_88 = param_1;
  if (DAT_1800569f8 == '\0') {
    UVar3 = FUN_180002900();
    if (UVar3 == 0) {
      _DAT_1800569d8 = 0;
      _DAT_1800569e0 = 0;
      _DAT_1800569e8 = 0;
      _DAT_1800569f0 = 0;
    }
    DAT_1800569f8 = '\x01';
  }
  NVar4 = BCryptOpenAlgorithmProvider(&local_b0,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar4) {
    uVar10 = 0;
    NVar4 = BCryptCreateHash(local_b0,&local_b8,(PUCHAR)0x0,0,&DAT_1800569d8,0x20,0);
    if (-1 < NVar4) {
      uVar7 = 0;
      pUVar8 = &local_res8;
      ppiVar6 = &local_88;
      do {
        if (((*ppiVar6 != (int *)0x0) && (*pUVar8 != 0)) &&
           (NVar4 = BCryptHashData(local_b8,(PUCHAR)*ppiVar6,*pUVar8,0), NVar4 < 0))
        goto LAB_180003123;
        uVar7 = uVar7 + 1;
        ppiVar6 = ppiVar6 + 1;
        pUVar8 = pUVar8 + 1;
      } while (uVar7 < 2);
      if (-1 < NVar4) {
        NVar4 = BCryptFinishHash(local_b8,(PUCHAR)&local_a8,0x20,0);
      }
LAB_180003123:
      BCryptDestroyHash(local_b8);
      param_2 = local_res10;
      param_4 = local_res20;
    }
    BCryptCloseAlgorithmProvider(local_b0,0);
    puVar1 = param_5;
    if (((((-1 < NVar4) &&
          (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + (longlong)param_1) == local_a8)) &&
         (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + 8 + (longlong)param_1) == local_a0)) &&
        ((param_3 == (uint *)0x0 || ((param_2 != (uint *)0x0 && ((uint)param_1[2] <= *param_3))))))
       && ((param_5 == (uint *)0x0 || ((param_4 != (uint *)0x0 && ((uint)param_1[3] <= *param_5)))))
       ) {
      local_88 = param_1 + 4;
      local_res8 = 0x10;
      pbSecret = FUN_180002bb0();
      NVar4 = BCryptOpenAlgorithmProvider(&local_b0,L"SHA256",(LPCWSTR)0x0,8);
      if (-1 < NVar4) {
        NVar4 = BCryptCreateHash(local_b0,&local_b8,(PUCHAR)0x0,0,pbSecret,0x20,0);
        if (-1 < NVar4) {
          pUVar8 = &local_res8;
          ppiVar6 = &local_88;
          do {
            if (((*ppiVar6 != (int *)0x0) && (*pUVar8 != 0)) &&
               (NVar4 = BCryptHashData(local_b8,(PUCHAR)*ppiVar6,*pUVar8,0), NVar4 < 0))
            goto LAB_180003269;
            uVar10 = uVar10 + 1;
            ppiVar6 = ppiVar6 + 1;
            pUVar8 = pUVar8 + 1;
          } while (uVar10 < 2);
          if (-1 < NVar4) {
            NVar4 = BCryptFinishHash(local_b8,(PUCHAR)&local_a8,0x20,0);
          }
LAB_180003269:
          BCryptDestroyHash(local_b8);
        }
        BCryptCloseAlgorithmProvider(local_b0,0);
        if ((-1 < NVar4) &&
           (bVar2 = FUN_1800024b0((PUCHAR)&local_a8,local_98,(uint *)(param_1 + 8),local_78,0x10),
           (int)CONCAT71(extraout_var,bVar2) != 0)) {
          uVar10 = param_1[2];
          if (uVar10 != 0) {
            if (local_res10 == (uint *)0x0) {
              do {
                puVar9 = (uint *)((longlong)param_1 +
                                 ((ulonglong)(uint)param_1[2] - (ulonglong)uVar10) + 0x30);
                if (uVar10 < 0x40) {
                  bVar2 = FUN_1800024b0((PUCHAR)&local_a8,local_98,puVar9,local_78,uVar10);
                  iVar5 = (int)CONCAT71(extraout_var_02,bVar2);
                  goto joined_r0x000180003343;
                }
                bVar2 = FUN_1800024b0((PUCHAR)&local_a8,local_98,puVar9,local_78,0x40);
                if ((int)CONCAT71(extraout_var_01,bVar2) == 0) {
                  return 0;
                }
                uVar10 = uVar10 - 0x40;
              } while (uVar10 != 0);
            }
            else {
              bVar2 = FUN_1800024b0((PUCHAR)&local_a8,local_98,(uint *)(param_1 + 0xc),local_res10,
                                    uVar10);
              iVar5 = (int)CONCAT71(extraout_var_00,bVar2);
joined_r0x000180003343:
              if (iVar5 == 0) {
                return 0;
              }
            }
          }
          if (param_3 != (uint *)0x0) {
            *param_3 = param_1[2];
          }
          if (((param_1[3] == 0) || (local_res20 == (uint *)0x0)) ||
             (bVar2 = FUN_1800024b0((PUCHAR)&local_a8,local_98,
                                    (uint *)((longlong)param_1 + (ulonglong)(uint)param_1[2] + 0x30)
                                    ,local_res20,param_1[3]),
             (int)CONCAT71(extraout_var_03,bVar2) != 0)) {
            if (puVar1 != (uint *)0x0) {
              *puVar1 = param_1[3];
            }
            return 1;
          }
        }
      }
    }
  }
  return 0;
}



undefined8 FUN_1800033a0(PUCHAR param_1,PUCHAR param_2)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  PUCHAR *ppUVar4;
  ULONG local_res8 [4];
  BCRYPT_HASH_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  PUCHAR local_38 [2];
  
  local_res8[0] = 0x20;
  local_38[0] = param_1;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    iVar2 = 0;
    NVar1 = BCryptCreateHash(local_res20,&local_res18,(PUCHAR)0x0,0,"NzY4",0x17,0);
    if (-1 < NVar1) {
      ppUVar4 = local_38;
      pUVar3 = local_res8;
      do {
        if ((*ppUVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) {
          NVar1 = BCryptHashData(local_res18,*ppUVar4,*pUVar3,0);
          if (NVar1 < 0) goto LAB_180003494;
        }
        iVar2 = iVar2 + 1;
        ppUVar4 = ppUVar4 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar2 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res18,param_2,0x20,0);
      }
LAB_180003494:
      BCryptDestroyHash(local_res18);
    }
    BCryptCloseAlgorithmProvider(local_res20,0);
    if (-1 < NVar1) {
      return 0;
    }
  }
  return 1;
}



undefined8 FUN_1800034e0(PUCHAR param_1,PUCHAR param_2)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  PUCHAR *ppUVar4;
  ULONG local_res8 [4];
  BCRYPT_HASH_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  PUCHAR local_38 [2];
  
  local_res8[0] = 0x20;
  local_38[0] = param_1;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    iVar2 = 0;
    NVar1 = BCryptCreateHash(local_res20,&local_res18,(PUCHAR)0x0,0,"Mzg0",0x13,0);
    if (-1 < NVar1) {
      ppUVar4 = local_38;
      pUVar3 = local_res8;
      do {
        if ((*ppUVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) {
          NVar1 = BCryptHashData(local_res18,*ppUVar4,*pUVar3,0);
          if (NVar1 < 0) goto LAB_1800035d4;
        }
        iVar2 = iVar2 + 1;
        ppUVar4 = ppUVar4 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar2 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res18,param_2,0x20,0);
      }
LAB_1800035d4:
      BCryptDestroyHash(local_res18);
    }
    BCryptCloseAlgorithmProvider(local_res20,0);
    if (-1 < NVar1) {
      return 0;
    }
  }
  return 1;
}



void FUN_180003620(PUCHAR param_1,undefined4 *param_2,uint *param_3,uint *param_4,
                  BCRYPT_HASH_HANDLE param_5)

{
  uint uVar1;
  bool bVar2;
  NTSTATUS NVar3;
  undefined8 uVar4;
  undefined7 extraout_var;
  PUCHAR *ppUVar5;
  int iVar6;
  ULONG *pUVar7;
  BCRYPT_ALG_HANDLE local_108;
  uint local_100 [2];
  ULONG local_f8 [2];
  BCRYPT_ALG_HANDLE local_f0;
  PUCHAR local_e8;
  UCHAR local_e0 [16];
  UCHAR local_d0 [24];
  undefined8 local_b8 [4];
  UCHAR local_98 [32];
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  ulonglong local_58;
  
  local_58 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffeb8;
  local_100[0] = 0xa0;
  if (param_3 == (uint *)0x0) {
    *param_4 = 0xa0;
  }
  else {
    if ((0x9f < *param_4) &&
       (NVar3 = BCryptOpenAlgorithmProvider(&local_108,L"RNG",(LPCWSTR)0x0,0), -1 < NVar3)) {
      NVar3 = BCryptGenRandom(local_108,(PUCHAR)local_b8,0x20,0);
      BCryptCloseAlgorithmProvider(local_108,0);
      if ((-1 < NVar3) && (uVar4 = FUN_1800034e0(param_1,local_98), (int)uVar4 == 0)) {
        local_78 = *param_2;
        uStack116 = param_2[1];
        uStack112 = param_2[2];
        uStack108 = param_2[3];
        local_68 = param_2[4];
        uStack100 = param_2[5];
        uStack96 = param_2[6];
        uStack92 = param_2[7];
        uVar4 = FUN_180002c30((undefined8 *)0x0,0,local_b8,0x60,param_3,local_100,param_5);
        if ((int)uVar4 != 0) {
          local_f8[0] = 0x20;
          local_e8 = param_1;
          NVar3 = BCryptOpenAlgorithmProvider(&local_f0,L"SHA256",(LPCWSTR)0x0,8);
          if (-1 < NVar3) {
            iVar6 = 0;
            NVar3 = BCryptCreateHash(local_f0,&local_108,(PUCHAR)0x0,0,"MTI4",0x1a,0);
            if (-1 < NVar3) {
              pUVar7 = local_f8;
              ppUVar5 = &local_e8;
              do {
                if (((*ppUVar5 != (PUCHAR)0x0) && (*pUVar7 != 0)) &&
                   (NVar3 = BCryptHashData(local_108,*ppUVar5,*pUVar7,0), NVar3 < 0))
                goto LAB_1800037f3;
                iVar6 = iVar6 + 1;
                ppUVar5 = ppUVar5 + 1;
                pUVar7 = pUVar7 + 1;
              } while (iVar6 == 0);
              if (-1 < NVar3) {
                NVar3 = BCryptFinishHash(local_108,local_e0,0x20,0);
              }
LAB_1800037f3:
              BCryptDestroyHash(local_108);
            }
            BCryptCloseAlgorithmProvider(local_f0,0);
            uVar1 = local_100[0];
            if ((-1 < NVar3) &&
               (bVar2 = FUN_1800024b0(local_d0,local_e0,param_3,param_3,local_100[0]),
               (int)CONCAT71(extraout_var,bVar2) != 0)) {
              *param_4 = uVar1;
            }
          }
        }
      }
    }
  }
  FUN_180023ef0(local_58 ^ (ulonglong)&stack0xfffffffffffffeb8);
  return;
}



void FUN_180003880(PUCHAR param_1,uint *param_2,int param_3,undefined4 *param_4,longlong param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  uint *_Memory;
  undefined7 extraout_var;
  undefined8 uVar3;
  int iVar4;
  ULONG *pUVar5;
  PUCHAR *ppUVar6;
  ULONG local_f8 [2];
  BCRYPT_HASH_HANDLE local_f0;
  BCRYPT_ALG_HANDLE local_e8;
  PUCHAR local_e0;
  longlong local_d8;
  uint *local_d0;
  UCHAR local_c8 [16];
  UCHAR local_b8 [16];
  uint local_a8 [8];
  undefined local_88 [32];
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffec8;
  local_d8 = param_5;
  local_d0 = param_2;
  if ((param_3 == 0xa0) && (_Memory = (uint *)malloc(0xa0), _Memory != (uint *)0x0)) {
    local_f8[0] = 0x20;
    local_e0 = param_1;
    NVar2 = BCryptOpenAlgorithmProvider(&local_e8,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar2) {
      iVar4 = 0;
      NVar2 = BCryptCreateHash(local_e8,&local_f0,(PUCHAR)0x0,0,"MTI4",0x1a,0);
      if (-1 < NVar2) {
        pUVar5 = local_f8;
        ppUVar6 = &local_e0;
        do {
          if (((*ppUVar6 != (PUCHAR)0x0) && (*pUVar5 != 0)) &&
             (NVar2 = BCryptHashData(local_f0,*ppUVar6,*pUVar5,0), NVar2 < 0)) goto LAB_1800039bb;
          iVar4 = iVar4 + 1;
          ppUVar6 = ppUVar6 + 1;
          pUVar5 = pUVar5 + 1;
        } while (iVar4 == 0);
        if (-1 < NVar2) {
          NVar2 = BCryptFinishHash(local_f0,local_c8,0x20,0);
        }
LAB_1800039bb:
        BCryptDestroyHash(local_f0);
        param_5 = local_d8;
        param_2 = local_d0;
      }
      BCryptCloseAlgorithmProvider(local_e8,0);
      if ((-1 < NVar2) &&
         (bVar1 = FUN_1800024b0(local_b8,local_c8,param_2,_Memory,0xa0),
         (int)CONCAT71(extraout_var,bVar1) != 0)) {
        local_f8[0] = 0x60;
        uVar3 = FUN_180002fc0((int *)_Memory,(uint *)0x0,(uint *)0x0,local_a8,local_f8,param_5);
        if ((((int)uVar3 != 0) &&
            ((local_f8[0] == 0x60 &&
             (uVar3 = FUN_1800034e0(param_1,(PUCHAR)local_a8), (int)uVar3 == 0)))) &&
           (iVar4 = memcmp(local_a8,local_88,0x20), iVar4 == 0)) {
          *param_4 = local_68;
          param_4[1] = uStack100;
          param_4[2] = uStack96;
          param_4[3] = uStack92;
          param_4[4] = local_58;
          param_4[5] = uStack84;
          param_4[6] = uStack80;
          param_4[7] = uStack76;
        }
      }
    }
    free(_Memory);
  }
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xfffffffffffffec8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180003ac0(PUCHAR *param_1,uint *param_2,uint *param_3,PUCHAR param_4)

{
  undefined4 *puVar1;
  UINT UVar2;
  undefined8 uVar3;
  uint *puVar4;
  PUCHAR pUVar5;
  uint *puVar6;
  undefined *puVar7;
  undefined8 in_stack_ffffffffffffff28;
  undefined8 local_b8 [4];
  undefined4 local_98;
  undefined4 uStack148;
  undefined4 uStack144;
  undefined4 uStack140;
  undefined4 local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined4 local_58 [8];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff08;
  if (*param_3 < 3) {
    *param_3 = 3;
  }
  else {
    if (param_1 == (PUCHAR *)0x0) {
      *param_3 = 3;
      *param_2 = 0x20;
      param_2[2] = 0x40;
      FUN_180003620((PUCHAR)0x0,(undefined4 *)0x0,(uint *)0x0,param_2 + 1,param_4);
    }
    else {
      *param_3 = 0;
      if (0x1f < *param_2) {
        puVar4 = param_2;
        puVar6 = param_3;
        if (DAT_1800569f8 == '\0') {
          UVar2 = FUN_180002900();
          if (UVar2 == 0) {
            _DAT_1800569d8 = 0;
            _DAT_1800569e0 = 0;
            _DAT_1800569e8 = 0;
            _DAT_1800569f0 = 0;
          }
          DAT_1800569f8 = '\x01';
        }
        puVar7 = &DAT_1800569d8;
        uVar3 = FUN_1800026f0(param_4,puVar4,(ulonglong)puVar6,&DAT_1800569d8,
                              in_stack_ffffffffffffff28,local_b8);
        if ((int)uVar3 != 0) {
          pUVar5 = *param_1;
          uVar3 = FUN_1800033a0((PUCHAR)local_b8,pUVar5);
          if ((int)uVar3 == 0) {
            *param_2 = 0x20;
            uVar3 = FUN_180001f00(local_58,pUVar5,&local_98,(ulonglong)puVar7);
            if (((int)uVar3 != 0) &&
               (FUN_180003620((PUCHAR)local_b8,local_58,(uint *)param_1[1],param_2 + 1,param_4),
               0x3f < param_2[2])) {
              puVar1 = (undefined4 *)param_1[2];
              *puVar1 = local_98;
              puVar1[1] = uStack148;
              puVar1[2] = uStack144;
              puVar1[3] = uStack140;
              puVar1[4] = local_88;
              puVar1[5] = uStack132;
              puVar1[6] = uStack128;
              puVar1[7] = uStack124;
              puVar1[8] = local_78;
              puVar1[9] = uStack116;
              puVar1[10] = uStack112;
              puVar1[0xb] = uStack108;
              puVar1[0xc] = local_68;
              puVar1[0xd] = uStack100;
              puVar1[0xe] = uStack96;
              puVar1[0xf] = uStack92;
              param_2[2] = 0x40;
              *param_3 = 3;
            }
          }
        }
      }
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff08);
  return;
}



void FUN_180003c70(undefined8 param_1,uint *param_2)

{
  undefined8 in_R8;
  undefined in_R9B;
  undefined in_stack_ffffffffffffffd8;
  undefined in_stack_ffffffffffffffe0;
  
  FUN_180004b50(param_1,(undefined (**) [16])param_1,param_2,in_R9B,in_stack_ffffffffffffffd8,
                in_stack_ffffffffffffffe0,in_R8);
  return;
}



void FUN_180003c90(PUCHAR param_1,ULONG param_2,undefined4 *param_3,undefined4 *param_4)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  PUCHAR *ppUVar4;
  undefined8 uVar5;
  undefined *puVar6;
  ULONG local_108 [2];
  BCRYPT_HASH_HANDLE local_100;
  PUCHAR local_f8;
  BCRYPT_ALG_HANDLE local_f0;
  int local_e8;
  undefined4 local_e4;
  undefined4 local_a0;
  undefined4 uStack156;
  undefined4 uStack152;
  undefined4 uStack148;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  ulonglong local_58;
  
  local_58 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffeb8;
  *param_4 = 0x60;
  if (param_3 != (undefined4 *)0x0) {
    local_108[0] = 0x20;
    local_f8 = &DAT_18004d5e8;
    NVar1 = BCryptOpenAlgorithmProvider(&local_f0,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar1) {
      iVar2 = 0;
      puVar6 = &DAT_18004d510;
      NVar1 = BCryptCreateHash(local_f0,&local_100,(PUCHAR)0x0,0,"UmVx",0x15,0);
      if (-1 < NVar1) {
        ppUVar4 = &local_f8;
        pUVar3 = local_108;
        do {
          if (((*ppUVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
             (NVar1 = BCryptHashData(local_100,*ppUVar4,*pUVar3,0), NVar1 < 0)) goto LAB_180003db9;
          iVar2 = iVar2 + 1;
          ppUVar4 = ppUVar4 + 1;
          pUVar3 = pUVar3 + 1;
        } while (iVar2 == 0);
        if (-1 < NVar1) {
          NVar1 = BCryptFinishHash(local_100,(PUCHAR)&local_78,0x20,0);
        }
LAB_180003db9:
        BCryptDestroyHash(local_100);
      }
      BCryptCloseAlgorithmProvider(local_f0,0);
      if (-1 < NVar1) {
        uVar5 = 0x68;
        local_108[0] = param_2;
        local_f8 = param_1;
        FUN_1800244a0((undefined (*) [16])&local_e8,0,0x68);
        local_e8 = 0x32534345;
        local_a0 = local_78;
        uStack156 = uStack116;
        uStack152 = uStack112;
        uStack148 = uStack108;
        local_90 = local_68;
        uStack140 = uStack100;
        uStack136 = uStack96;
        uStack132 = uStack92;
        local_e4 = 0x20;
        NVar1 = FUN_180001560(&local_f8,local_108,uVar5,&local_e8,puVar6,(PUCHAR)(param_3 + 8));
        if (-1 < NVar1) {
          *param_3 = 0xf2b7e4ec;
          param_3[1] = 0xc12e898d;
          param_3[2] = 0x57658dee;
          param_3[3] = 0xc3d0233a;
          param_3[4] = 0x364ab8c0;
          param_3[5] = 0xba7ff53a;
          param_3[6] = 0x4642b312;
          param_3[7] = 0x3ab21184;
        }
      }
    }
  }
  FUN_180023ef0(local_58 ^ (ulonglong)&stack0xfffffffffffffeb8);
  return;
}



void FUN_180003e90(uint *param_1,uint param_2)

{
  NTSTATUS NVar1;
  PUCHAR *ppUVar2;
  ULONG *pUVar3;
  int iVar4;
  ULONG local_78 [2];
  BCRYPT_HASH_HANDLE local_70;
  BCRYPT_ALG_HANDLE local_68;
  PUCHAR local_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff48;
  local_60 = &DAT_18004d6b0;
  local_78[0] = 0x20;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_68,&local_70,(PUCHAR)0x0,0,"UmVx",0x17,0);
    if (-1 < NVar1) {
      iVar4 = 0;
      pUVar3 = local_78;
      ppUVar2 = &local_60;
      do {
        if (((*ppUVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
           (NVar1 = BCryptHashData(local_70,*ppUVar2,*pUVar3,0), NVar1 < 0)) goto LAB_180003fa5;
        iVar4 = iVar4 + 1;
        ppUVar2 = ppUVar2 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar4 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_70,local_58,0x20,0);
      }
LAB_180003fa5:
      BCryptDestroyHash(local_70);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if (-1 < NVar1) {
      FUN_1800024b0(local_48,local_58,param_1,param_1,param_2);
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff48);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180004142)

void FUN_180004030(PUCHAR param_1,uint param_2,undefined4 *param_3,undefined4 *param_4,
                  undefined4 *param_5)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  bool bVar4;
  NTSTATUS NVar5;
  undefined7 extraout_var;
  undefined4 *puVar6;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 uStack284;
  undefined4 uStack280;
  undefined4 uStack276;
  undefined4 local_110;
  undefined4 uStack268;
  undefined4 uStack264;
  undefined4 uStack260;
  undefined4 local_100;
  undefined4 uStack252;
  undefined4 uStack248;
  undefined4 uStack244;
  undefined4 local_f0;
  undefined4 uStack236;
  undefined4 uStack232;
  undefined4 uStack228;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_80;
  undefined4 uStack124;
  undefined4 uStack120;
  undefined4 uStack116;
  uint local_68;
  uint uStack100;
  uint uStack96;
  uint uStack92;
  uint local_58;
  uint uStack84;
  uint uStack80;
  uint uStack76;
  uint local_48;
  uint uStack68;
  uint uStack64;
  uint uStack60;
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffe98;
  FUN_1800244a0((undefined (*) [16])&local_d8,0,0x68);
  local_90 = *param_3;
  uStack140 = param_3[1];
  uStack136 = param_3[2];
  uStack132 = param_3[3];
  local_80 = param_3[4];
  uStack124 = param_3[5];
  uStack120 = param_3[6];
  uStack116 = param_3[7];
  puVar6 = &local_128;
  local_120 = *param_4;
  uStack284 = param_4[1];
  uStack280 = param_4[2];
  uStack276 = param_4[3];
  local_d8 = 0x324b4345;
  local_d4 = 0x20;
  local_128 = 0x314b4345;
  local_124 = 0x20;
  local_110 = param_4[4];
  uStack268 = param_4[5];
  uStack264 = param_4[6];
  uStack260 = param_4[7];
  local_100 = param_4[8];
  uStack252 = param_4[9];
  uStack248 = param_4[10];
  uStack244 = param_4[0xb];
  local_f0 = param_4[0xc];
  uStack236 = param_4[0xd];
  uStack232 = param_4[0xe];
  uStack228 = param_4[0xf];
  NVar5 = FUN_1800017b0((PUCHAR)&local_d8,(PUCHAR)puVar6,"SecureShare",0xb,(PUCHAR)&local_68,0x20);
  if (-1 < NVar5) {
    local_48 = local_58 ^ local_68;
    uStack68 = uStack84 ^ uStack100;
    uStack64 = uStack80 ^ uStack96;
    uStack60 = uStack76 ^ uStack92;
    bVar4 = FUN_180002310((PUCHAR)&local_68,puVar6,(PUCHAR)&local_48,param_1,param_2,param_1,param_2
                         );
    if ((int)CONCAT71(extraout_var,bVar4) != 0) {
      uVar1 = *(undefined4 *)(param_1 + 0x24);
      uVar2 = *(undefined4 *)(param_1 + 0x28);
      uVar3 = *(undefined4 *)(param_1 + 0x2c);
      *param_5 = *(undefined4 *)(param_1 + 0x20);
      param_5[1] = uVar1;
      param_5[2] = uVar2;
      param_5[3] = uVar3;
      if (((((*(int *)(param_1 + 0x30) + 0xcebeacaeU & 0xfdffffff) == 0) &&
           (*(char *)param_5 == 'R')) && (*(char *)((longlong)param_5 + 2) == 'P')) &&
         (((*(uint *)(param_1 + 0x34) ==
            (uint)(*(byte *)((longlong)param_5 + 1) >> 4) <<
            (*(byte *)((longlong)param_5 + 1) & 0xf) && (*(char *)((longlong)param_5 + 3) == 'B'))
          && (0x50f < (*(uint *)(param_1 + 0x34) & 0xfffffff8))))) {
        FUN_180001c90(*(uint *)(param_1 + 0x3c),*(uint *)(param_1 + 0x38),
                      (undefined8 *)(param_1 + 0x48),
                      (undefined8 *)
                      ((longlong)(param_1 + 0x48) + (ulonglong)*(uint *)(param_1 + 0x38)),
                      (undefined8 *)(param_5 + 6),param_5 + 4);
      }
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xfffffffffffffe98);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180004240(uint **param_1,int *param_2,ulonglong param_3,undefined4 *param_4)

{
  PUCHAR pUVar1;
  uint *puVar2;
  UINT UVar3;
  int iVar4;
  undefined8 uVar5;
  int *piVar6;
  undefined8 in_stack_ffffffffffffff38;
  uint local_a8;
  uint uStack164;
  uint uStack160;
  uint uStack156;
  uint local_98;
  uint uStack148;
  uint uStack144;
  uint uStack140;
  uint local_88;
  uint uStack132;
  uint uStack128;
  uint uStack124;
  uint local_78;
  uint uStack116;
  uint uStack112;
  uint uStack108;
  undefined4 local_68 [8];
  undefined8 local_48 [4];
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff18;
  if (2 < (uint)param_3) {
    pUVar1 = *(PUCHAR *)(param_4 + 8);
    piVar6 = param_2;
    if (DAT_1800569f8 == '\0') {
      UVar3 = FUN_180002900();
      if (UVar3 == 0) {
        _DAT_1800569d8 = 0;
        _DAT_1800569e0 = 0;
        _DAT_1800569e8 = 0;
        _DAT_1800569f0 = 0;
      }
      DAT_1800569f8 = '\x01';
    }
    uVar5 = FUN_1800026f0(pUVar1,piVar6,param_3,&DAT_1800569d8,in_stack_ffffffffffffff38,local_48);
    if ((((int)uVar5 != 0) &&
        (iVar4 = FUN_180003880((PUCHAR)local_48,*param_1,*param_2,local_68,
                               *(longlong *)(param_4 + 8)), iVar4 == 0)) && (param_2[1] == 0x40)) {
      puVar2 = param_1[1];
      local_a8 = *puVar2;
      uStack164 = puVar2[1];
      uStack160 = puVar2[2];
      uStack156 = puVar2[3];
      local_98 = puVar2[4];
      uStack148 = puVar2[5];
      uStack144 = puVar2[6];
      uStack140 = puVar2[7];
      local_88 = puVar2[8];
      uStack132 = puVar2[9];
      uStack128 = puVar2[10];
      uStack124 = puVar2[0xb];
      local_78 = puVar2[0xc];
      uStack116 = puVar2[0xd];
      uStack112 = puVar2[0xe];
      uStack108 = puVar2[0xf];
      FUN_180004030((PUCHAR)param_1[2],param_2[2],local_68,&local_a8,param_4);
    }
  }
  FUN_180023ef0(local_28 ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



void FUN_180004390(undefined8 param_1,uint param_2)

{
  undefined8 in_R8;
  undefined in_R9B;
  undefined in_stack_ffffffffffffffd8;
  undefined in_stack_ffffffffffffffe0;
  
  FUN_180004e40(param_1,(uint *)param_1,param_2,in_R9B,in_stack_ffffffffffffffd8,
                in_stack_ffffffffffffffe0,in_R8);
  return;
}



void FUN_1800043b0(uint *param_1,uint param_2)

{
  NTSTATUS NVar1;
  PUCHAR *ppUVar2;
  ULONG *pUVar3;
  int iVar4;
  ULONG local_78 [2];
  BCRYPT_HASH_HANDLE local_70;
  BCRYPT_ALG_HANDLE local_68;
  PUCHAR local_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff48;
  local_60 = &DAT_18004d608;
  local_78[0] = 0x20;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_68,&local_70,(PUCHAR)0x0,0,"QWNj",0x15,0);
    if (-1 < NVar1) {
      iVar4 = 0;
      pUVar3 = local_78;
      ppUVar2 = &local_60;
      do {
        if (((*ppUVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
           (NVar1 = BCryptHashData(local_70,*ppUVar2,*pUVar3,0), NVar1 < 0)) goto LAB_1800044c5;
        iVar4 = iVar4 + 1;
        ppUVar2 = ppUVar2 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar4 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_70,local_58,0x20,0);
      }
LAB_1800044c5:
      BCryptDestroyHash(local_70);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if (-1 < NVar1) {
      FUN_1800024b0(local_48,local_58,param_1,param_1,param_2);
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff48);
  return;
}



void FUN_180004550(PUCHAR param_1,uint param_2,void *param_3,int param_4,longlong param_5)

{
  NTSTATUS NVar1;
  PUCHAR *ppUVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined8 uVar5;
  undefined8 in_stack_fffffffffffffef8;
  uint local_e8 [2];
  int local_e0 [2];
  BCRYPT_HASH_HANDLE local_d8;
  PUCHAR local_d0;
  ULONG local_c8 [2];
  BCRYPT_ALG_HANDLE local_c0;
  undefined8 local_b8;
  undefined8 local_b0;
  undefined8 uStack168;
  undefined8 local_a0;
  undefined8 uStack152;
  undefined8 local_90;
  undefined8 uStack136;
  undefined8 local_80;
  undefined8 uStack120;
  UCHAR local_68 [32];
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffed8;
  iVar4 = 0;
  local_e0[0] = 0;
  local_e8[0] = param_2;
  if (param_4 == 0x60) {
    if (*(PUCHAR *)(param_5 + 0x28) == (PUCHAR)0x0) {
      uVar5 = 0x20;
      iVar4 = memcmp(param_3,&DAT_18004d690,0x20);
      if (iVar4 == 0) {
        local_b0 = 0x6450e3f7e5af32e;
        uStack168 = 0xab12166ef3d1097d;
        local_a0 = 0xef5f7480a5682828;
        uStack152 = 0xc861b7094b1d13af;
        local_90 = 0xe203d1e68295d926;
        uStack136 = 0x207022928f017fe6;
        local_80 = 0x13c294b29e9829e7;
        uStack120 = 0x127d49e52ad9c944;
        local_b8 = 0x2031534345;
        local_e8[0] = param_2;
        local_d0 = param_1;
        FUN_180001690(&local_d0,local_e8,uVar5,(int *)&local_b8,in_stack_fffffffffffffef8,
                      (PUCHAR)((longlong)param_3 + 0x20));
      }
    }
    else {
      local_c8[0] = 0x40;
      local_c0 = (BCRYPT_ALG_HANDLE)0x0;
      local_d0 = *(PUCHAR *)(param_5 + 0x28);
      NVar1 = BCryptOpenAlgorithmProvider(&local_c0,L"SHA256",(LPCWSTR)0x0,0);
      if (-1 < NVar1) {
        NVar1 = BCryptCreateHash(local_c0,&local_d8,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
        if (-1 < NVar1) {
          ppUVar2 = &local_d0;
          pUVar3 = local_c8;
          do {
            if (((*ppUVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
               (NVar1 = BCryptHashData(local_d8,*ppUVar2,*pUVar3,0), NVar1 < 0)) goto LAB_180004672;
            iVar4 = iVar4 + 1;
            ppUVar2 = ppUVar2 + 1;
            pUVar3 = pUVar3 + 1;
          } while (iVar4 == 0);
          if (-1 < NVar1) {
            NVar1 = BCryptFinishHash(local_d8,local_68,0x20,0);
          }
LAB_180004672:
          BCryptDestroyHash(local_d8);
          param_2 = local_e8[0];
        }
        BCryptCloseAlgorithmProvider(local_c0,0);
        if ((-1 < NVar1) && (iVar4 = memcmp(param_3,local_68,0x20), iVar4 == 0)) {
          FUN_180001a00(*(undefined8 **)(param_5 + 0x28),param_1,(ulonglong)param_2,
                        (PUCHAR)((longlong)param_3 + 0x20),local_e0);
        }
      }
    }
  }
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xfffffffffffffed8);
  return;
}



void FUN_1800047e0(undefined4 param_1)

{
  code *pcVar1;
  undefined4 local_res8;
  
  local_res8 = param_1;
  FUN_1800251e8((longlong *)&local_res8,&DAT_1800512a8);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



BOOL InitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180004800. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = InitializeCriticalSectionEx(lpCriticalSection,dwSpinCount,Flags);
  return BVar1;
}



void FUN_180004810(void)

{
  return;
}



void FUN_180004820(undefined **param_1,undefined8 param_2,undefined8 param_3,undefined8 *param_4,
                  int *param_5)

{
  undefined8 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  code **ppcVar6;
  int iVar7;
  NTSTATUS NVar8;
  undefined8 *_Memory;
  int iVar9;
  longlong lVar10;
  PUCHAR pUVar11;
  uint uVar12;
  uint local_88;
  BCRYPT_ALG_HANDLE local_80;
  int local_78;
  undefined8 local_70;
  code **local_68;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff38;
  iVar9 = 0;
  uVar12 = param_5[1] + *param_5;
  local_70 = param_2;
  local_68 = (code **)param_1;
  iVar7 = (*(code *)*param_1)(param_1[3],0,0x50,0);
  if (iVar7 != 0) {
    lVar10 = (longlong)(int)local_88;
    local_78 = local_88 + 0x40 + uVar12;
    _Memory = (undefined8 *)malloc((longlong)local_78);
    if (_Memory != (undefined8 *)0x0) {
      puVar1 = _Memory + 8;
      pUVar11 = (PUCHAR)(lVar10 + (longlong)puVar1);
      NVar8 = BCryptOpenAlgorithmProvider(&local_80,L"RNG",(LPCWSTR)0x0,0);
      if (-1 < NVar8) {
        BCryptGenRandom(local_80,(PUCHAR)puVar1,0x50,0);
        BCryptCloseAlgorithmProvider(local_80,0);
      }
      *(undefined4 *)(_Memory + 4) = 0x80000003;
      *(undefined4 *)((longlong)_Memory + 0x24) = 0;
      *(int *)(_Memory + 5) = (int)puVar1 - (int)_Memory;
      *(uint *)((longlong)_Memory + 0x2c) = local_88;
      if (0 < (int)uVar12) {
        do {
          FUN_180023f20((undefined8 *)(pUVar11 + iVar9),(undefined8 *)*param_4,(longlong)*param_5);
          iVar9 = iVar9 + *param_5;
          param_4 = param_4 + 1;
          param_5 = param_5 + 1;
        } while (iVar9 < (int)uVar12);
      }
      _Memory[6] = 0x7d3;
      *(uint *)((longlong)_Memory + 0x3c) = uVar12;
      puVar1 = _Memory + 8;
      *(int *)(_Memory + 7) = (int)pUVar11 - (int)_Memory;
      local_58 = *(undefined4 *)(_Memory + 0x10);
      uStack84 = *(undefined4 *)((longlong)_Memory + 0x84);
      uStack80 = *(undefined4 *)(_Memory + 0x11);
      uStack76 = *(undefined4 *)((longlong)_Memory + 0x8c);
      FUN_180002160((PUCHAR)puVar1,0x40,(PUCHAR)&local_58,pUVar11,uVar12,pUVar11,uVar12,(ULONG *)0x0
                   );
      ppcVar6 = local_68;
      iVar7 = (**local_68)(local_68[3],puVar1,0x50,puVar1);
      if (iVar7 != 0) {
        local_68 = (code **)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180002160(&DAT_18004d5c8,0x20,(PUCHAR)&local_68,(PUCHAR)puVar1,local_88,(PUCHAR)puVar1,
                      local_88,(ULONG *)&local_80);
        *_Memory = 0x4545464c;
        GetSystemTimeAsFileTime((LPFILETIME)(_Memory + 1));
        puVar2 = (undefined4 *)ppcVar6[2];
        uVar3 = puVar2[1];
        uVar4 = puVar2[2];
        uVar5 = puVar2[3];
        *(undefined4 *)(_Memory + 2) = *puVar2;
        *(undefined4 *)((longlong)_Memory + 0x14) = uVar3;
        *(undefined4 *)(_Memory + 3) = uVar4;
        *(undefined4 *)((longlong)_Memory + 0x1c) = uVar5;
        local_68 = (code **)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180002160(&DAT_18004d5b8,0x10,(PUCHAR)&local_68,(PUCHAR)(_Memory + 4),0x20,
                      (PUCHAR)(_Memory + 4),0x20,(ULONG *)&local_80);
        (*ppcVar6[1])(ppcVar6[3],local_70,_Memory,local_78);
      }
      free(_Memory);
    }
  }
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xffffffffffffff38);
  return;
}



void FUN_180004ad0(undefined **param_1,undefined8 param_2,undefined8 param_3,int param_4,int param_5
                  )

{
  int local_38;
  int local_34;
  undefined4 *local_30;
  undefined8 local_28;
  undefined4 local_20;
  undefined2 local_1c;
  undefined2 local_1a;
  undefined4 local_18;
  ulonglong local_10;
  
  local_10 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff98;
  local_20 = 0xc;
  local_1c = (undefined2)param_4;
  local_38 = 0xc;
  local_1a = (undefined2)param_5;
  local_30 = &local_20;
  local_34 = param_4 * param_5;
  local_18 = 0x80001;
  local_28 = param_3;
  FUN_180004820(param_1,param_2,param_3,&local_30,&local_38);
  FUN_180023ef0(local_10 ^ (ulonglong)&stack0xffffffffffffff98);
  return;
}



void FUN_180004b50(undefined8 param_1,undefined (**param_2) [16],uint *param_3,undefined param_4,
                  undefined param_5,undefined param_6,PUCHAR param_7)

{
  uint *puVar1;
  longlong lVar2;
  longlong lVar3;
  ULONG cbBuffer;
  int iVar4;
  NTSTATUS NVar5;
  ulonglong uVar6;
  undefined (*_Memory) [16];
  ulonglong uVar7;
  ULONG *pUVar8;
  uint uVar9;
  ulonglong uVar10;
  PUCHAR pUVar11;
  uint uVar12;
  uint uVar13;
  int iVar14;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  int iVar20;
  int iVar21;
  undefined in_XMM1 [16];
  undefined auStack248 [32];
  PUCHAR local_d8;
  uint local_c8 [2];
  BCRYPT_ALG_HANDLE local_c0;
  PUCHAR local_b8;
  ULONG local_b0;
  uint local_ac [3];
  ULONG UStack160;
  uint auStack156 [5];
  PUCHAR local_88 [8];
  ulonglong local_48;
  undefined auVar15 [16];
  
  local_48 = DAT_1800537e8 ^ (ulonglong)auStack248;
  local_c8[0] = 6;
  iVar4 = FUN_180003ac0((PUCHAR *)0x0,local_ac,local_c8,param_7);
  if (iVar4 == 0) {
    local_c8[0] = local_c8[0] + 1;
    uVar7 = 0;
    local_b0 = 0x20;
    local_d8 = param_7;
    uVar9 = 0;
    FUN_180003c90((PUCHAR)0x0,0,(undefined4 *)0x0,&local_b0 + local_c8[0]);
    local_c8[0] = local_c8[0] + 1;
    if (local_c8[0] != 0) {
      uVar10 = uVar7;
      uVar6 = uVar7;
      if (7 < local_c8[0]) {
        in_XMM1 = in_XMM1 & (undefined  [16])0x0;
        auVar15 = in_XMM1;
        do {
          pUVar8 = &local_b0 + uVar10;
          puVar1 = local_ac + uVar10;
          lVar2 = uVar10 + 1;
          lVar3 = uVar10 + 2;
          uVar6 = (ulonglong)((int)uVar10 + 4);
          uVar9 = (int)uVar10 + 8;
          uVar10 = (ulonglong)uVar9;
          iVar4 = *pUVar8 + SUB164(in_XMM1,0);
          iVar16 = *puVar1 + SUB164(in_XMM1 >> 0x20,0);
          iVar18 = local_ac[lVar2] + SUB164(in_XMM1 >> 0x40,0);
          iVar20 = local_ac[lVar3] + SUB164(in_XMM1 >> 0x60,0);
          in_XMM1 = CONCAT412(iVar20,CONCAT48(iVar18,CONCAT44(iVar16,iVar4)));
          iVar14 = (&local_b0)[uVar6] + SUB164(auVar15,0);
          iVar17 = local_ac[uVar6] + SUB164(auVar15 >> 0x20,0);
          iVar19 = local_ac[uVar6 + 1] + SUB164(auVar15 >> 0x40,0);
          iVar21 = local_ac[uVar6 + 2] + SUB164(auVar15 >> 0x60,0);
          auVar15 = CONCAT412(iVar21,CONCAT48(iVar19,CONCAT44(iVar17,iVar14)));
        } while (uVar9 < local_c8[0] - (local_c8[0] & 7));
        uVar6 = (ulonglong)
                (uint)(iVar4 + iVar14 + iVar18 + iVar19 + iVar16 + iVar17 + iVar20 + iVar21);
      }
      uVar9 = (uint)uVar6;
      if ((uint)uVar10 < local_c8[0]) {
        pUVar8 = &local_b0 + uVar10;
        uVar10 = (ulonglong)(local_c8[0] - (uint)uVar10);
        do {
          uVar9 = (int)uVar6 + *pUVar8;
          uVar6 = (ulonglong)uVar9;
          pUVar8 = pUVar8 + 1;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
    }
    _Memory = *param_2;
    uVar13 = (local_c8[0] * 4 + 0x13 + uVar9 & 0xfffffff0) + 0xc;
    if (_Memory == (undefined (*) [16])0x0) {
      _Memory = (undefined (*) [16])malloc((ulonglong)uVar13);
      if (_Memory == (undefined (*) [16])0x0) goto LAB_180004e20;
    }
    else {
      if (*param_3 < uVar13) {
        *param_3 = uVar13;
        goto LAB_180004e20;
      }
    }
    FUN_1800244a0(_Memory,0,(ulonglong)uVar13);
    cbBuffer = local_b0;
    *(uint *)*_Memory = uVar13;
    *(undefined4 *)(*_Memory + 4) = 1;
    *(undefined4 *)(*_Memory + 8) = 1;
    *(uint *)(*_Memory + 0xc) = local_c8[0];
    pUVar11 = _Memory[1] + (ulonglong)local_c8[0] * 4;
    if (local_c8[0] != 0) {
      do {
        uVar13 = (&local_b0)[uVar7];
        local_88[uVar7] = pUVar11;
        *(uint *)(_Memory[1] + uVar7 * 4) = uVar13;
        uVar12 = (int)uVar7 + 1;
        uVar7 = (ulonglong)uVar12;
        pUVar11 = pUVar11 + uVar13;
      } while (uVar12 < local_c8[0]);
    }
    local_b8 = local_88[0];
    NVar5 = BCryptOpenAlgorithmProvider(&local_c0,L"RNG",(LPCWSTR)0x0,0);
    uVar13 = local_c8[0];
    if (-1 < NVar5) {
      NVar5 = BCryptGenRandom(local_c0,local_b8,cbBuffer,0);
      BCryptCloseAlgorithmProvider(local_c0,0);
      uVar13 = local_c8[0];
      if (-1 < NVar5) {
        local_c8[0] = local_c8[0] - 2;
        iVar4 = FUN_180003ac0(local_88 + 1,local_ac,local_c8,param_7);
        uVar13 = local_c8[0] + 2;
        if (iVar4 == 0) {
          uVar7 = (ulonglong)(local_c8[0] + 1);
          local_d8 = param_7;
          local_c8[0] = local_c8[0] + 2;
          iVar4 = FUN_180003c90(local_88[0],uVar9 - (&local_b0)[uVar7],(undefined4 *)local_88[uVar7]
                                ,&local_b0 + uVar7);
          uVar13 = local_c8[0];
          if ((iVar4 == 0) &&
             (iVar4 = FUN_180003e90((uint *)(*_Memory + 0xc),*(int *)*_Memory - 0xc),
             uVar13 = local_c8[0], iVar4 == 0)) {
            *param_2 = _Memory;
            *param_3 = *(uint *)*_Memory;
            goto LAB_180004e20;
          }
        }
      }
    }
    local_c8[0] = uVar13;
    if (*param_2 != _Memory) {
      free(_Memory);
    }
  }
LAB_180004e20:
  FUN_180023ef0(local_48 ^ (ulonglong)auStack248);
  return;
}



void FUN_180004e40(undefined8 param_1,uint *param_2,uint param_3,undefined param_4,undefined param_5
                  ,undefined param_6,undefined4 *param_7)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint **ppuVar9;
  uint *puVar10;
  int local_78 [8];
  uint *local_58 [8];
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff58;
  if ((((0xf < param_3) && (*param_2 <= param_3)) && (param_2[1] == 2)) &&
     ((param_2[2] == 1 && (iVar4 = FUN_1800043b0(param_2 + 3,*param_2 - 0xc), iVar4 == 0)))) {
    uVar1 = param_2[3];
    uVar2 = *param_2;
    uVar6 = 0;
    if (((ulonglong)uVar1 * 4 + 0x10 <= (ulonglong)uVar2) && (uVar1 < 9)) {
      puVar10 = param_2 + (ulonglong)uVar1 + 4;
      if (uVar1 != 0) {
        puVar5 = param_2 + 4;
        ppuVar9 = local_58;
        uVar8 = 0;
        do {
          uVar7 = uVar8;
          uVar3 = *puVar5;
          uVar6 = uVar6 + uVar3;
          if (uVar2 - 4 < uVar6) goto LAB_180004f7f;
          *ppuVar9 = puVar10;
          uVar8 = uVar7 + 1;
          *(uint *)((longlong)register0x00000020 + (-0x88 - (longlong)param_2) + (longlong)puVar5) =
               uVar3;
          puVar10 = (uint *)((longlong)puVar10 + (ulonglong)uVar3);
          ppuVar9 = ppuVar9 + 1;
          puVar5 = puVar5 + 1;
        } while (uVar8 < uVar1);
        if ((1 < uVar8) &&
           (iVar4 = FUN_180004550((PUCHAR)local_58[0],uVar6 - local_78[uVar7],local_58[uVar7],
                                  local_78[uVar7],(longlong)param_7), iVar4 == 0)) {
          FUN_180004240(local_58 + 1,local_78 + 1,(ulonglong)(uVar7 - 1),param_7);
        }
      }
    }
  }
LAB_180004f7f:
  FUN_180023ef0(local_18 ^ (ulonglong)&stack0xffffffffffffff58);
  return;
}



void FUN_180004fa0(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  
  bVar1 = FUN_180005de0(param_1,param_2,param_3);
  if (bVar1 == 0xff) {
    iVar4 = 0x10;
  }
  else {
    iVar4 = ((0xff - param_4) * 0x10) / (int)(0xff - (uint)bVar1);
  }
  lVar3 = (longlong)(param_2 * param_3);
  if (0 < param_2 * param_3) {
    do {
      iVar2 = (0xff - (uint)*param_1) * iVar4 + 8;
      iVar2 = (int)(iVar2 + (iVar2 >> 0x1f & 0xfU)) >> 4;
      if (iVar2 < 0xff) {
        if (iVar2 < 0) {
          *param_1 = 0xff;
        }
        else {
          *param_1 = -(char)iVar2 - 1;
        }
      }
      else {
        *param_1 = 0;
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  return;
}



int FUN_180005060(longlong param_1,int param_2,int param_3,byte *param_4,int param_5)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  int local_res20;
  
  if (((param_5 < 0) || (param_1 == 0)) || (param_4 == (byte *)0x0)) {
    return -1;
  }
  local_res20 = 0;
  if (0 < param_5) {
    while( true ) {
      iVar5 = 0;
      iVar7 = 0;
      if (param_3 < 1) break;
      pbVar8 = param_4;
      do {
        iVar6 = 0;
        pbVar4 = pbVar8;
        if (0 < param_2) {
          do {
            if ((*pbVar4 & 1) != 0) {
              uVar1 = FUN_180005200(param_1,(longlong)param_4,iVar6,iVar7,param_2,param_3,0x10);
              if (uVar1 != 0xff) {
                iVar2 = (uVar1 + 7) * 0x112;
                uVar1 = (int)(iVar2 + (iVar2 >> 0x1f & 0xfffU)) >> 0xc & 0x80000007;
                if ((int)uVar1 < 0) {
                  uVar1 = (uVar1 - 1 | 0xfffffff8) + 1;
                }
                uVar3 = FUN_180005770((longlong)(pbVar8 + (param_1 - (longlong)param_4)),
                                      (longlong)pbVar8,param_2,param_3,iVar6,iVar7,uVar1);
                if (-1 < (int)uVar3) {
                  pbVar4[param_1 - (longlong)param_4] = (byte)uVar3;
                  *pbVar4 = 2;
                  goto LAB_180005187;
                }
              }
              iVar5 = iVar5 + 1;
            }
LAB_180005187:
            iVar6 = iVar6 + 1;
            pbVar4 = pbVar4 + 1;
          } while (iVar6 < param_2);
        }
        iVar7 = iVar7 + 1;
        pbVar8 = pbVar8 + param_2;
      } while (iVar7 < param_3);
      if (iVar5 == 0) {
        return 0;
      }
      local_res20 = local_res20 + 1;
      if (param_5 <= local_res20) {
        return iVar5;
      }
    }
  }
  return 0;
}



uint FUN_180005200(longlong param_1,longlong param_2,int param_3,int param_4,int param_5,int param_6
                  ,int param_7)

{
  longlong lVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  int local_res18;
  int local_68;
  int local_64;
  int local_60;
  
  iVar14 = 0;
  iVar7 = 0;
  iVar6 = 0;
  local_64 = 0;
  iVar4 = param_7 / 2;
  local_res18 = 0;
  local_68 = 0;
  iVar15 = param_3 - iVar4;
  iVar12 = 0;
  lVar9 = (longlong)iVar15;
  local_60 = 0;
  if (lVar9 < iVar4 + param_3) {
    lVar16 = (longlong)param_5;
    iVar2 = param_4 - iVar4;
    lVar3 = (longlong)param_4 - (longlong)iVar4;
    do {
      while (lVar3 < iVar4 + param_4) {
        if ((((0 < lVar9) && (iVar15 < param_5 + -1)) && (0 < lVar3)) && (iVar2 < param_6 + -1)) {
          lVar1 = lVar3 * lVar16 + lVar9;
          lVar8 = (lVar3 + -1) * lVar16 + lVar9;
          lVar17 = (lVar3 + 1) * lVar16 + lVar9;
          iVar6 = local_68;
          iVar7 = local_res18;
          if ((*(uint *)(lVar1 + -1 + param_2) & 0xffffff00) +
              (*(uint *)(param_2 + -1 + lVar8) & 0xffffff00) +
              (*(uint *)(lVar17 + -1 + param_2) & 0xffffff00) == 0) {
            uVar11 = (uint)*(byte *)(param_1 + -1 + lVar8);
            uVar13 = (uint)*(byte *)(lVar17 + -1 + param_1);
            uVar5 = (uint)*(byte *)(param_1 + 1 + lVar8);
            uVar10 = (uint)*(byte *)(lVar17 + 1 + param_1);
            iVar7 = ((((uint)*(byte *)(lVar1 + 1 + param_1) - (uint)*(byte *)(lVar1 + -1 + param_1))
                     - uVar11) - uVar13) + uVar5 + uVar10;
            iVar6 = ((((uint)*(byte *)(lVar17 + param_1) - (uint)*(byte *)(param_1 + lVar8)) - uVar5
                     ) - uVar11) + uVar10 + uVar13;
            iVar14 = local_64 + iVar7 * iVar7;
            local_68 = local_68 + iVar6 * iVar7;
            local_res18 = local_res18 + iVar6 * iVar6;
            iVar12 = local_60 + 1;
            iVar6 = local_68;
            iVar7 = local_res18;
            local_64 = iVar14;
            local_60 = iVar12;
          }
        }
        iVar2 = iVar2 + 1;
        lVar3 = lVar3 + 1;
      }
      lVar9 = lVar9 + 1;
      iVar15 = iVar15 + 1;
      iVar2 = param_4 - iVar4;
      lVar3 = (longlong)param_4 - (longlong)iVar4;
    } while (lVar9 < iVar4 + param_3);
    if (iVar12 != 0) {
      iVar4 = iVar12 / 2;
      uVar5 = FUN_180005490((iVar4 + iVar14) / iVar12 - (iVar4 + iVar7) / iVar12,
                            ((iVar4 + iVar6) / iVar12) * 2);
      return uVar5 & 0xff;
    }
  }
  return 0xff;
}



uint FUN_180005490(uint param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  if (param_1 == 0) {
    uVar2 = 0x1e;
    if (0 < (int)param_2) {
      uVar2 = 0x5a;
    }
    return uVar2;
  }
  iVar3 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  iVar1 = (param_2 ^ (int)param_2 >> 0x1f) - ((int)param_2 >> 0x1f);
  if (iVar3 < iVar1) {
    uVar2 = 0x1e0 - (byte)(&DAT_180034660)[(iVar1 / 2 + iVar3 * 0x80) / iVar1];
  }
  else {
    uVar2 = (uint)(byte)(&DAT_180034660)[(iVar3 / 2 + iVar1 * 0x80) / iVar3];
  }
  uVar2 = (int)(uVar2 + 8 + ((int)(uVar2 + 8) >> 0x1f & 0xfU)) >> 4;
  if ((int)param_1 < 0) {
    if (-1 < (int)param_2) {
      if ((char)uVar2 == '\0') {
        return uVar2;
      }
      return 0x78 - (uVar2 & 0xff);
    }
  }
  else {
    if ((int)param_2 < 0) {
      return 0x3c - (uVar2 & 0xff);
    }
    uVar2 = (uVar2 & 0xff) + 0x3c;
  }
  return uVar2;
}



ulonglong FUN_180005550(byte *param_1,int param_2,uint param_3,int param_4,int param_5)

{
  ulonglong uVar1;
  
  uVar1 = FUN_180005580(param_1,param_2,param_3,param_4,param_5);
  return (uVar1 & 0xffffffff) / (ulonglong)(param_3 * param_4);
}



ulonglong FUN_180005580(byte *param_1,int param_2,uint param_3,int param_4,int param_5)

{
  byte bVar1;
  byte *pbVar2;
  ulonglong uVar3;
  uint uVar4;
  uint uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  longlong lVar10;
  int iVar11;
  ulonglong uVar12;
  ulonglong uVar5;
  
  uVar7 = 0;
  lVar10 = (longlong)param_4;
  uVar12 = 0;
  if (param_5 == 0) {
    if (0 < (int)param_3) {
      uVar8 = (ulonglong)param_3;
      uVar12 = uVar7;
      do {
        iVar11 = (int)uVar12;
        uVar12 = uVar7;
        uVar6 = 0;
        uVar4 = 0;
        if (1 < lVar10) {
          uVar3 = uVar7;
          uVar5 = uVar7;
          uVar9 = uVar7;
          do {
            uVar12 = uVar3 + 2;
            uVar4 = (int)uVar5 + (uint)param_1[uVar3];
            uVar5 = (ulonglong)uVar4;
            uVar6 = (int)uVar9 + (uint)param_1[uVar3 + 1];
            uVar9 = (ulonglong)uVar6;
            uVar3 = uVar12;
          } while ((longlong)uVar12 < lVar10 + -1);
        }
        if ((longlong)uVar12 < lVar10) {
          iVar11 = iVar11 + (uint)param_1[uVar12];
        }
        param_1 = param_1 + param_2;
        uVar12 = (ulonglong)(iVar11 + uVar6 + uVar4);
        uVar8 = uVar8 - 1;
      } while (uVar8 != 0);
    }
  }
  else {
    uVar12 = uVar7;
    if (0 < (int)param_3) {
      do {
        if (0 < lVar10) {
          pbVar2 = param_1;
          do {
            bVar1 = *pbVar2;
            if ((int)(uint)bVar1 < param_5) {
              return 0;
            }
            pbVar2 = pbVar2 + 1;
            uVar12 = (ulonglong)((int)uVar12 + (uint)bVar1);
          } while ((longlong)(pbVar2 + -(longlong)param_1) < lVar10);
        }
        uVar6 = (int)uVar7 + 1;
        uVar7 = (ulonglong)uVar6;
        param_1 = param_1 + param_2;
      } while ((int)uVar6 < (int)param_3);
      return uVar12;
    }
  }
  return uVar12;
}



int FUN_180005670(longlong param_1,int param_2,byte *param_3,int param_4,uint param_5,int param_6)

{
  byte *pbVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  ulonglong uVar9;
  
  lVar8 = (longlong)param_6;
  iVar7 = 0;
  if (0 < (int)param_5) {
    uVar9 = (ulonglong)param_5;
    do {
      iVar5 = 0;
      iVar6 = 0;
      lVar3 = 0;
      if (1 < lVar8) {
        lVar4 = (lVar8 - 2U >> 1) + 1;
        lVar3 = lVar4 * 2;
        pbVar1 = param_3;
        do {
          iVar5 = iVar5 + ((uint)*pbVar1 - (uint)pbVar1[param_1 - (longlong)param_3]) *
                          ((uint)*pbVar1 - (uint)pbVar1[param_1 - (longlong)param_3]);
          iVar2 = (uint)pbVar1[1] - (uint)(pbVar1 + 2)[(param_1 - (longlong)param_3) + -1];
          iVar6 = iVar6 + iVar2 * iVar2;
          lVar4 = lVar4 + -1;
          pbVar1 = pbVar1 + 2;
        } while (lVar4 != 0);
      }
      if (lVar3 < lVar8) {
        iVar2 = (uint)param_3[lVar3] - (uint)*(byte *)(lVar3 + param_1);
        iVar7 = iVar7 + iVar2 * iVar2;
      }
      param_3 = param_3 + param_4;
      param_1 = param_1 + param_2;  // def param_2 is not a ptr
      iVar7 = iVar7 + iVar6 + iVar5;
      uVar9 = uVar9 - 1;
    } while (uVar9 != 0);
  }
  return iVar7;
}



ulonglong FUN_180005770(longlong param_1,longlong param_2,int param_3,int param_4,int param_5,
                       int param_6,int param_7)

{
  longlong lVar1;
  longlong lVar2;
  ulonglong uVar3;
  int iVar4;
  longlong lVar5;
  int iVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  longlong local_res8;
  
  iVar4 = param_6 + -1;
  iVar10 = 0;
  iVar9 = 0;
  lVar7 = 0;
  lVar5 = 0;
  lVar1 = (longlong)((param_5 - param_3) + -1);
  lVar8 = lVar1 + param_2;
  lVar1 = lVar1 + param_1;
  local_res8 = 3;
  do {
    if ((-1 < iVar4) && (iVar4 <= param_4 + -1)) {
      lVar2 = 0;
      iVar6 = param_5 + -1;
      do {
        if ((lVar5 != 1) || (lVar2 != 1)) {
          if ((-1 < iVar6) &&
             ((iVar6 < param_3 + -1 && ((((byte *)(lVar2 + lVar1))[lVar8 - lVar1] & 1) == 0)))) {
            iVar10 = iVar10 + (uint)*(byte *)(lVar2 + lVar1) *
                              (uint)(byte)(&DAT_1800346f0)[lVar7 + (longlong)param_7 * 8];
            iVar9 = iVar9 + (uint)(byte)(&DAT_1800346f0)[lVar7 + (longlong)param_7 * 8];
          }
          lVar7 = lVar7 + 1;
        }
        lVar2 = lVar2 + 1;
        iVar6 = iVar6 + 1;
      } while (lVar2 < 3);
    }
    iVar4 = iVar4 + 1;
    lVar5 = lVar5 + 1;
    lVar8 = lVar8 + param_3;
    lVar1 = lVar1 + param_3;
    local_res8 = local_res8 + -1;
  } while (local_res8 != 0);
  if (iVar9 < 1) {
    uVar3 = 0xffffffff;
  }
  else {
    uVar3 = (longlong)iVar10 / (longlong)iVar9 & 0xffffffff;
  }
  return uVar3;
}



void FUN_180005890(longlong param_1,uint param_2,int param_3)

{
  byte bVar1;
  int iVar2;
  void *_Memory;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  undefined *puVar6;
  int iVar7;
  longlong lVar8;
  int iVar9;
  longlong lVar10;
  undefined *puVar11;
  int iVar12;
  longlong lVar13;
  int iVar14;
  uint uVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  undefined auStack184 [32];
  int local_98;
  int local_94;
  longlong local_90;
  int local_88;
  int local_80;
  undefined *local_78;
  longlong local_70;
  longlong local_68;
  longlong local_60;
  void *local_58;
  byte local_50 [5];
  undefined local_4b;
  undefined local_4a;
  undefined local_49;
  undefined local_48;
  ulonglong local_40;
  
  local_40 = DAT_1800537e8 ^ (ulonglong)auStack184;
  uVar16 = SEXT48((int)param_2);
  iVar5 = 0;
  iVar14 = 0;
  local_98 = 0;
  _Memory = malloc((longlong)(int)(param_2 * 3));
  local_58 = _Memory;
  if (_Memory != (void *)0x0) {
    local_88 = param_3 + -1;
    puVar6 = (undefined *)(param_1 + uVar16);
    iVar7 = param_2 * 2;
    iVar9 = param_2 + 1;
    iVar12 = param_2 + 2;
    local_94 = 1;
    uVar15 = param_2;
    local_80 = iVar7;
    if (1 < local_88) {
      lVar4 = 0;
      local_60 = (longlong)(int)(param_2 - 1);
      local_90 = 0;
      uVar17 = uVar16;
      do {
        iVar2 = local_94;
        *(undefined *)(lVar4 + (longlong)_Memory) = *puVar6;
        lVar13 = 1;
        if (1 < local_60) {
          local_70 = (longlong)iVar7 + -2;
          lVar13 = local_60 + -1;
          puVar11 = puVar6 + (2 - uVar16);
          do {
            lVar8 = 8;
            local_50[0] = puVar11[-2];
            lVar10 = 8;
            local_50[1] = puVar11[-1];
            local_50[2] = *puVar11;
            local_50[3] = puVar11[uVar16 - 2];
            local_50[4] = puVar11[(longlong)iVar9 + -2];
            local_4b = puVar11[(longlong)iVar12 + -2];
            local_4a = puVar11[local_70];
            local_49 = puVar11[(longlong)(iVar7 + 1) + -2];
            local_48 = puVar11[(longlong)(iVar7 + 2) + -2];
            do {
              lVar3 = 0;
              if (0 < lVar8) {
                do {
                  bVar1 = local_50[lVar3];
                  if (local_50[lVar3 + 1] < bVar1) {
                    local_50[lVar3] = local_50[lVar3 + 1];
                    local_50[lVar3 + 1] = bVar1;
                  }
                  lVar3 = lVar3 + 1;
                } while (lVar3 < lVar8);
              }
              lVar8 = lVar8 + -1;
              lVar10 = lVar10 + -1;
            } while (lVar10 != 0);
            puVar11 = puVar11 + 1;
            puVar11[(longlong)
                    ((undefined *)(lVar4 + (longlong)_Memory) + (uVar16 - (longlong)puVar6) + -2)] =
                 local_50[4];
            lVar13 = lVar13 + -1;
          } while (lVar13 != 0);
          uVar17 = (ulonglong)param_2;
          lVar13 = local_60;
          lVar4 = local_90;
          _Memory = local_58;
          iVar7 = local_80;
          iVar14 = local_98;
          local_68 = local_60;
        }
        uVar15 = (uint)uVar17;
        local_98 = iVar14 + uVar15;
        local_90 = lVar4 + uVar16;
        *(undefined *)(lVar13 + lVar4 + (longlong)_Memory) = puVar6[lVar13];
        if (local_98 == uVar15 * 3) {
          local_98 = 0;
          local_90 = 0;
        }
        lVar4 = local_90;
        iVar14 = local_98;
        if (2 < local_94) {
          local_78 = puVar6;
          FUN_180023f20((undefined8 *)(puVar6 + -(longlong)iVar7),
                        (undefined8 *)((longlong)iVar5 + (longlong)_Memory),uVar16);
          iVar5 = iVar5 + uVar15;
          if (iVar5 == uVar15 * 3) {
            iVar5 = 0;
          }
        }
        local_94 = iVar2 + 1;
        puVar6 = puVar6 + uVar16;
        iVar7 = uVar15 * 2;
        iVar9 = uVar15 + 1;
        iVar12 = uVar15 + 2;
      } while (local_94 < local_88);
      iVar7 = uVar15 * 2;
    }
    local_78 = puVar6;
    FUN_180023f20((undefined8 *)(puVar6 + -(longlong)iVar7),
                  (undefined8 *)((longlong)iVar5 + (longlong)_Memory),uVar16);
    iVar5 = iVar5 + uVar15;
    if (iVar5 == uVar15 * 3) {
      iVar5 = 0;
    }
    FUN_180023f20((undefined8 *)(puVar6 + -uVar16),
                  (undefined8 *)((longlong)iVar5 + (longlong)_Memory),uVar16);
    free(_Memory);
  }
  FUN_180023ef0(local_40 ^ (ulonglong)auStack184);
  return;
}



int FUN_180005b80(byte *param_1,int param_2,int param_3)

{
  byte local_res20 [8];
  byte local_18 [24];
  
  FUN_180005be0(param_1,param_2,param_3,local_res20,local_18,1);
  return (int)((uint)local_res20[0] - (uint)local_18[0]);
}



void FUN_180005bc0(byte *param_1,int param_2,int param_3,undefined *param_4,undefined *param_5)

{
  FUN_180005be0(param_1,param_2,param_3,param_4,param_5,0);
  return;
}



void FUN_180005be0(byte *param_1,int param_2,int param_3,undefined *param_4,undefined *param_5,
                  int param_6)

{
  byte bVar1;
  uint uVar2;
  longlong lVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  longlong lVar7;
  uint uVar8;
  int *piVar9;
  ulonglong uVar10;
  undefined auStack1176 [32];
  uint local_478;
  int local_474;
  uint local_470;
  int local_46c;
  int local_468;
  ulonglong local_460;
  undefined *local_458;
  undefined *local_450;
  int local_448 [256];
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)auStack1176;
  uVar2 = 0;
  local_450 = param_5;
  local_468 = param_2 * param_3;
  local_470 = 1;
  local_46c = 1;
  uVar6 = 0;
  local_460 = 0;
  local_478 = 0;
  local_474 = 0;
  local_458 = param_4;
  FUN_1800244a0((undefined (*) [16])local_448,0,0x400);
  lVar3 = (longlong)local_468;
  uVar5 = uVar2;
  uVar8 = uVar2;
  if (0 < local_468) {
    do {
      bVar1 = *param_1;
      if ((bVar1 < 0xf0) || (param_6 < 1)) {
        uVar8 = uVar8 + bVar1;
        local_448[bVar1] = local_448[bVar1] + 1;
        uVar6 = uVar5;
      }
      else {
        uVar6 = uVar5 + 1;
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
      uVar5 = uVar6;
    } while (lVar3 != 0);
  }
  local_468 = local_468 - uVar6;
  piVar9 = local_448;
  uVar5 = uVar2;
  uVar6 = uVar2;
  do {
    iVar4 = *piVar9;
    if (iVar4 != 0) {
      uVar6 = uVar6 + iVar4;
      uVar5 = uVar5 + iVar4 * uVar2;
      iVar4 = local_468 - uVar6;
      if ((uVar6 != 0) && (iVar4 != 0)) {
        lVar7 = (longlong)(int)uVar5;
        lVar3 = (longlong)(int)(uVar8 - uVar5);
        uVar10 = (ulonglong)(lVar7 * lVar7 * (longlong)iVar4) / (ulonglong)(longlong)(int)uVar6 +
                 (ulonglong)((int)uVar6 * lVar3 * lVar3) / (ulonglong)(longlong)iVar4 +
                 lVar7 * lVar3 * -2;
        if (local_460 < uVar10) {
          local_478 = uVar5;
          local_474 = uVar8 - uVar5;
          local_470 = uVar6;
          local_46c = iVar4;
          local_460 = uVar10;
        }
      }
    }
    uVar2 = uVar2 + 1;
    piVar9 = piVar9 + 1;
  } while (uVar2 < 0x100);
  if (local_458 != (undefined *)0x0) {
    *local_458 = (char)(local_474 / local_46c);
  }
  if (local_450 != (undefined *)0x0) {
    *local_450 = (char)((int)local_478 / (int)local_470);
  }
  FUN_180023ef0(local_48 ^ (ulonglong)auStack1176);
  return;
}



void FUN_180005dc0(byte *param_1,int param_2,int param_3,undefined *param_4,undefined *param_5)

{
  FUN_180005be0(param_1,param_2,param_3,param_4,param_5,1);
  return;
}



void FUN_180005de0(byte *param_1,int param_2,int param_3)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  ulonglong uVar7;
  int iVar8;
  int *piVar9;
  longlong lVar10;
  int iVar11;
  ulonglong uVar12;
  int iVar13;
  undefined auStack1112 [32];
  int local_438 [256];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)auStack1112;
  iVar13 = 0;
  iVar11 = param_2 * param_3;
  uVar12 = 0;
  iVar6 = 0;
  iVar5 = 0;
  iVar8 = 0;
  FUN_1800244a0((undefined (*) [16])local_438,0,0x400);
  lVar4 = (longlong)iVar11;
  if (0 < iVar11) {
    do {
      bVar1 = *param_1;
      if (bVar1 < 0xf0) {
        iVar13 = iVar13 + (uint)bVar1;
        local_438[bVar1] = local_438[bVar1] + 1;
      }
      else {
        iVar6 = iVar6 + 1;
      }
      param_1 = param_1 + 1;
      lVar4 = lVar4 + -1;
    } while (lVar4 != 0);
  }
  uVar3 = 0;
  piVar9 = local_438;
  do {
    iVar2 = *piVar9;
    if (iVar2 != 0) {
      iVar5 = iVar5 + iVar2;
      iVar8 = iVar8 + iVar2 * uVar3;
      iVar2 = (iVar11 - iVar6) - iVar5;
      if ((iVar5 != 0) && (iVar2 != 0)) {
        lVar4 = (longlong)(iVar13 - iVar8);
        lVar10 = (longlong)iVar8;
        uVar7 = (ulonglong)(lVar10 * lVar10 * (longlong)iVar2) / (ulonglong)(longlong)iVar5 +
                (ulonglong)(iVar5 * lVar4 * lVar4) / (ulonglong)(longlong)iVar2 +
                lVar10 * lVar4 * -2;
        if (uVar12 < uVar7) {
          uVar12 = uVar7;
        }
      }
    }
    uVar3 = uVar3 + 1;
    piVar9 = piVar9 + 1;
  } while (uVar3 < 0x100);
  FUN_180023ef0(local_38 ^ (ulonglong)auStack1112);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180005f20(longlong param_1,uint param_2,int param_3,int param_4,uint param_5)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  longlong lVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  int iVar9;
  byte *pbVar10;
  byte *pbVar11;
  undefined8 *puVar12;
  longlong lVar13;
  ulonglong uVar14;
  undefined *puVar15;
  int iVar16;
  uint uVar17;
  longlong lVar18;
  int iVar19;
  int iVar20;
  undefined8 *puVar21;
  ulonglong uVar22;
  int iVar23;
  int iVar25;
  int iVar26;
  int iVar27;
  int iVar28;
  undefined in_XMM2 [16];
  undefined auVar24 [16];
  int iVar29;
  int iVar30;
  undefined auVar31 [16];
  undefined in_XMM4 [16];
  undefined auStack184 [32];
  longlong local_98;
  int local_90;
  ulonglong local_88;
  int local_80;
  uint local_7c;
  undefined *local_70;
  undefined *local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)auStack184;
  uVar22 = (ulonglong)param_5;
  uVar14 = SEXT48((int)param_2);
  local_7c = param_5;
  local_98 = param_1;
  local_80 = param_4;
  local_68 = (undefined *)malloc((longlong)(int)(param_5 * param_2));
  if (local_68 != (undefined *)0x0) {
    local_90 = 0;
    uVar3 = (longlong)(param_3 << 10) / (longlong)(int)param_5 & 0xffffffff;
    iVar1 = (int)uVar3;
    uVar4 = uVar14;
    local_70 = local_68;
    uVar17 = param_2;
    if (0 < (int)param_5) {
      do {
        local_88 = uVar22;
        iVar16 = 0;
        iVar2 = (int)(local_90 + (local_90 >> 0x1f & 0x3ffU)) >> 10;
        iVar9 = (iVar2 + 1) * 0x400 - local_90;
        local_58 = 0;
        local_50 = 0;
        if (0 < iVar1) {
          uVar22 = uVar3;
          puVar21 = &local_58;
          do {
            iVar19 = (int)uVar22;
            iVar20 = iVar9;
            if (iVar19 < iVar9) {
              iVar20 = iVar19;
            }
            iVar16 = iVar16 + 1;
            uVar22 = (ulonglong)(uint)(iVar19 - iVar20);
            *(int *)puVar21 = iVar20;
            iVar9 = 0x400;
            puVar21 = (undefined8 *)((longlong)puVar21 + 4);
          } while (0 < iVar19 - iVar20);
        }
        lVar13 = (longlong)iVar16;
        if (0 < (longlong)uVar14) {
          puVar15 = local_70;
          uVar22 = uVar14;
          do {
            iVar9 = 0;
            iVar16 = 0;
            lVar18 = 0;
            pbVar11 = puVar15 + (((int)uVar4 * iVar2 + param_1) - (longlong)local_70);
            if (1 < lVar13) {
              do {
                lVar8 = lVar18 * 4;
                pbVar10 = pbVar11 + uVar14;
                lVar18 = lVar18 + 2;
                iVar9 = iVar9 + *(int *)((longlong)&local_58 + lVar8) * (uint)*pbVar11;
                pbVar11 = pbVar10 + uVar14;
                iVar16 = iVar16 + *(int *)((longlong)&local_60 + lVar18 * 4 + 4) * (uint)*pbVar10;
              } while (lVar18 < lVar13 + -1);
            }
            iVar20 = iVar1 / 2;
            if (lVar18 < lVar13) {
              iVar20 = *(int *)((longlong)&local_58 + lVar18 * 4) * (uint)*pbVar11 + iVar1 / 2;
            }
            *puVar15 = (char)((iVar16 + iVar9 + iVar20) / iVar1);
            uVar22 = uVar22 - 1;
            puVar15 = puVar15 + 1;
          } while (uVar22 != 0);
          uVar4 = (ulonglong)param_2;
          param_1 = local_98;
        }
        uVar17 = (uint)uVar4;
        local_70 = local_70 + uVar14;
        local_90 = local_90 + iVar1;
        local_88 = local_88 - 1;
        uVar22 = local_88;
      } while (local_88 != 0);
      uVar22 = (ulonglong)local_7c;
      param_4 = local_80;
    }
    uVar4 = (longlong)(int)(uVar17 << 10) / (longlong)param_4 & 0xffffffff;
    lVar13 = (longlong)param_4;
    iVar1 = (int)uVar4;
    iVar2 = iVar1 / 2;
    puVar15 = local_68;
    if (0 < (int)uVar22) {
      do {
        iVar9 = _DAT_1800537e0;
        iVar16 = 0;
        lVar18 = 0;
        if (0 < lVar13) {
          do {
            uVar17 = 0;
            iVar20 = (int)(iVar16 + (iVar16 >> 0x1f & 0x3ffU)) >> 10;
            local_58 = 0;
            local_50 = 0;
            puVar21 = (undefined8 *)(puVar15 + iVar20);
            iVar20 = (iVar20 + 1) * 0x400 - iVar16;
            if (0 < iVar1) {
              uVar3 = uVar4;
              puVar12 = &local_58;
              do {
                iVar23 = (int)uVar3;
                iVar19 = iVar20;
                if (iVar23 < iVar20) {
                  iVar19 = iVar23;
                }
                uVar17 = uVar17 + 1;
                uVar3 = (ulonglong)(uint)(iVar23 - iVar19);
                *(int *)puVar12 = iVar19;
                iVar20 = 0x400;
                puVar12 = (undefined8 *)((longlong)puVar12 + 4);
              } while (0 < iVar23 - iVar19);
            }
            lVar5 = 0;
            lVar8 = lVar5;
            iVar20 = iVar2;
            if (((0 < (int)uVar17) && (7 < uVar17)) && (1 < iVar9)) {
              iVar19 = 0;
              if (((undefined8 *)((longlong)puVar21 + (longlong)(int)(uVar17 - 1)) < &local_58) ||
                 (lVar8 = 0,
                 (undefined8 *)((longlong)&local_58 + (longlong)(int)(uVar17 - 1) * 4) < puVar21)) {
                uVar7 = uVar17 & 0x80000007;
                if ((int)uVar7 < 0) {
                  uVar7 = (uVar7 - 1 | 0xfffffff8) + 1;
                }
                in_XMM4 = in_XMM4 & (undefined  [16])0x0;
                auVar31 = in_XMM4;
                do {
                  lVar8 = (longlong)iVar19;
                  lVar5 = lVar5 + 8;
                  iVar20 = iVar19 + 4;
                  iVar19 = iVar19 + 8;
                  auVar24 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)((longlong)puVar21 + lVar8)));
                  auVar24 = pmulld(auVar24,*(undefined (*) [16])((longlong)&local_58 + lVar8 * 4));
                  iVar23 = SUB164(auVar24,0) + SUB164(in_XMM4,0);
                  iVar25 = SUB164(auVar24 >> 0x20,0) + SUB164(in_XMM4 >> 0x20,0);
                  iVar27 = SUB164(auVar24 >> 0x40,0) + SUB164(in_XMM4 >> 0x40,0);
                  iVar29 = SUB164(auVar24 >> 0x60,0) + SUB164(in_XMM4 >> 0x60,0);
                  in_XMM4 = CONCAT412(iVar29,CONCAT48(iVar27,CONCAT44(iVar25,iVar23)));
                  auVar24 = pmovzxbd(in_XMM4,ZEXT416(*(uint *)((longlong)puVar21 + (longlong)iVar20)
                                                    ));
                  auVar24 = pmulld(auVar24,*(undefined (*) [16])
                                            ((longlong)&local_58 + (longlong)iVar20 * 4));
                  iVar20 = SUB164(auVar24,0) + SUB164(auVar31,0);
                  iVar26 = SUB164(auVar24 >> 0x20,0) + SUB164(auVar31 >> 0x20,0);
                  iVar28 = SUB164(auVar24 >> 0x40,0) + SUB164(auVar31 >> 0x40,0);
                  iVar30 = SUB164(auVar24 >> 0x60,0) + SUB164(auVar31 >> 0x60,0);
                  in_XMM2 = CONCAT412(iVar30,CONCAT48(iVar28,CONCAT44(iVar26,iVar20)));
                  auVar31 = in_XMM2;
                } while (iVar19 < (int)(uVar17 - uVar7));
                iVar20 = iVar20 + iVar23 + iVar28 + iVar27 + iVar26 + iVar25 + iVar30 + iVar29 +
                         iVar2;
                lVar8 = lVar5;
              }
            }
            lVar5 = (longlong)(int)uVar17;
            iVar19 = 0;
            iVar23 = 0;
            if (lVar8 < lVar5) {
              if (1 < lVar5 - lVar8) {
                lVar6 = lVar8;
                do {
                  lVar8 = lVar6 + 2;
                  iVar19 = iVar19 + (uint)*(byte *)((longlong)puVar21 + lVar6) *
                                    *(int *)((longlong)&local_60 + lVar8 * 4);
                  iVar23 = iVar23 + (uint)*(byte *)((longlong)puVar21 + lVar6 + 1) *
                                    *(int *)((longlong)&local_60 + lVar8 * 4 + 4);
                  lVar6 = lVar8;
                } while (lVar8 < lVar5 + -1);
              }
              if (lVar8 < lVar5) {
                iVar20 = iVar20 + (uint)*(byte *)((longlong)puVar21 + lVar8) *
                                  *(int *)((longlong)&local_58 + lVar8 * 4);
              }
              iVar20 = iVar20 + iVar23 + iVar19;
            }
            lVar8 = lVar18 + 1;
            iVar16 = iVar16 + iVar1;
            *(char *)(lVar18 + local_98) = (char)(iVar20 / iVar1);
            lVar18 = lVar8;
          } while (lVar8 < lVar13);
        }
        local_98 = local_98 + lVar13;
        uVar22 = uVar22 - 1;
        puVar15 = puVar15 + uVar14;
        local_88 = uVar22;
      } while (uVar22 != 0);
    }
    local_60 = uVar14;
    free(local_68);
  }
  FUN_180023ef0(local_48 ^ (ulonglong)auStack184);
  return;
}



void FUN_180006380(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  longlong lVar3;
  
  lVar3 = (longlong)(param_2 * param_3);
  if (0 < param_2 * param_3) {
    do {
      iVar2 = (uint)*param_1 + param_4;
      if (iVar2 < 0xff) {
        bVar1 = (byte)iVar2;
        if (iVar2 < 1) {
          bVar1 = 0;
        }
        *param_1 = bVar1;
      }
      else {
        *param_1 = 0xff;
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  return;
}



void FUN_1800063c0(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  ulonglong uVar2;
  int *piVar3;
  int iVar4;
  byte *pbVar5;
  longlong lVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  longlong lVar10;
  undefined auStack1080 [32];
  int local_418 [252];
  int local_28 [4];
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack1080;
  iVar9 = param_2 * param_3;
  uVar2 = (longlong)iVar9 / (longlong)param_4 & 0xffffffff;
  FUN_1800244a0((undefined (*) [16])local_418,0,0x400);
  lVar10 = (longlong)iVar9;
  pbVar5 = param_1;
  lVar6 = lVar10;
  if (0 < iVar9) {
    do {
      local_418[*pbVar5] = local_418[*pbVar5] + 1;
      lVar6 = lVar6 + -1;
      pbVar5 = pbVar5 + 1;
    } while (lVar6 != 0);
  }
  iVar4 = 0xff;
  piVar3 = local_28 + 1;
  lVar6 = 0xff;
  do {
    iVar7 = (int)uVar2 - piVar3[2];
    if (iVar7 < 1) break;
    iVar7 = iVar7 - piVar3[1];
    if (iVar7 < 1) {
      iVar4 = iVar4 + -1;
      break;
    }
    iVar7 = iVar7 - *piVar3;
    if (iVar7 < 1) {
      iVar4 = iVar4 + -2;
      break;
    }
    uVar8 = iVar7 - piVar3[-1];
    uVar2 = (ulonglong)uVar8;
    if ((int)uVar8 < 1) {
      iVar4 = iVar4 + -3;
      break;
    }
    piVar3 = piVar3 + -4;
    iVar4 = iVar4 + -4;
    lVar6 = lVar6 + -4;
  } while (-1 < lVar6);
  if (0 < iVar9) {
    do {
      iVar9 = (uint)*param_1 + (0xff - iVar4);
      if (iVar9 < 0xff) {
        bVar1 = (byte)iVar9;
        if (iVar9 < 1) {
          bVar1 = 0;
        }
        *param_1 = bVar1;
      }
      else {
        *param_1 = 0xff;
      }
      param_1 = param_1 + 1;
      lVar10 = lVar10 + -1;
    } while (lVar10 != 0);
  }
  FUN_180023ef0(local_18 ^ (ulonglong)auStack1080);
  return;
}



void FUN_1800064e0(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  ulonglong uVar2;
  int *piVar3;
  int iVar4;
  byte *pbVar5;
  longlong lVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  longlong lVar10;
  undefined auStack1080 [32];
  int local_418 [252];
  int local_28 [4];
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack1080;
  iVar9 = param_2 * param_3;
  uVar2 = (longlong)iVar9 / (longlong)param_4 & 0xffffffff;
  FUN_1800244a0((undefined (*) [16])local_418,0,0x400);
  lVar10 = (longlong)iVar9;
  pbVar5 = param_1;
  lVar6 = lVar10;
  if (0 < iVar9) {
    do {
      local_418[*pbVar5] = local_418[*pbVar5] + 1;
      lVar6 = lVar6 + -1;
      pbVar5 = pbVar5 + 1;
    } while (lVar6 != 0);
  }
  iVar4 = 0xff;
  piVar3 = local_28 + 1;
  lVar6 = 0xff;
  do {
    iVar7 = (int)uVar2 - piVar3[2];
    if (iVar7 < 1) break;
    iVar7 = iVar7 - piVar3[1];
    if (iVar7 < 1) {
      iVar4 = iVar4 + -1;
      break;
    }
    iVar7 = iVar7 - *piVar3;
    if (iVar7 < 1) {
      iVar4 = iVar4 + -2;
      break;
    }
    uVar8 = iVar7 - piVar3[-1];
    uVar2 = (ulonglong)uVar8;
    if ((int)uVar8 < 1) {
      iVar4 = iVar4 + -3;
      break;
    }
    piVar3 = piVar3 + -4;
    iVar4 = iVar4 + -4;
    lVar6 = lVar6 + -4;
  } while (-1 < lVar6);
  if (0 < iVar9) {
    do {
      if (0xff - (0xff - iVar4) <= (int)(uint)*param_1) {
        iVar9 = (uint)*param_1 + (0xff - iVar4);
        if (iVar9 < 0xff) {
          bVar1 = (byte)iVar9;
          if (iVar9 < 1) {
            bVar1 = 0;
          }
          *param_1 = bVar1;
        }
        else {
          *param_1 = 0xff;
        }
      }
      param_1 = param_1 + 1;
      lVar10 = lVar10 + -1;
    } while (lVar10 != 0);
  }
  FUN_180023ef0(local_18 ^ (ulonglong)auStack1080);
  return;
}



LPCRITICAL_SECTION FUN_180006600(LPCRITICAL_SECTION param_1,LPCWSTR param_2)

{
  int iVar1;
  HANDLE pvVar2;
  
  InitializeCriticalSection(param_1);
  *(undefined4 *)&param_1[1].OwningThread = 0;
  param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
  *(HANDLE *)&param_1[1].LockCount = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[1].LockSemaphore = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[2].OwningThread = (HANDLE)0x0;
  *(undefined8 *)&param_1[2].LockCount = 0;
  param_1[1].SpinCount = (ULONG_PTR)pvVar2;
  param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  param_1[2].LockSemaphore = (HANDLE)0x0;
  lstrcpyW((LPWSTR)&param_1[2].SpinCount,param_2);
  iVar1 = lstrlenW(param_2);
  FUN_1800014d0("u",0xe,(PUCHAR)param_2,iVar1 * 2,(PUCHAR)&param_1[0x1c].SpinCount);
  param_1[0x1d].LockSemaphore = (HANDLE)0x0;
  param_1[0x1d].SpinCount = 0;
  param_1[0x1e].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  *(undefined8 *)&param_1[0x1e].LockCount = 0;
  param_1[0x1e].OwningThread = &param_1[0x1c].SpinCount;
  param_1[0x1e].LockSemaphore = &DAT_1800445d0;
  return param_1;
}



void FUN_180006700(LPCRITICAL_SECTION param_1)

{
  PRTL_CRITICAL_SECTION_DEBUG p_Var1;
  longlong lVar2;
  ULONG_PTR *pUVar3;
  HANDLE *ppvVar4;
  
  if (param_1[1].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    *(undefined4 *)&param_1[1].OwningThread = 1;
    SetEvent(*(HANDLE *)&param_1[1].LockCount);
    WaitForSingleObject(param_1[1].DebugInfo,0xffffffff);
    CloseHandle(param_1[1].DebugInfo);
    param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  }
  CloseHandle(*(HANDLE *)&param_1[1].LockCount);
  DeleteCriticalSection(param_1);
  CloseHandle(param_1[1].LockSemaphore);
  CloseHandle((HANDLE)param_1[1].SpinCount);
  if (param_1[2].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  else {
    *(PRTL_CRITICAL_SECTION_DEBUG *)*(PRTL_CRITICAL_SECTION_DEBUG *)&param_1[2].LockCount =
         (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  p_Var1 = param_1[2].DebugInfo;
  while (p_Var1 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    *(undefined8 *)&param_1[2].LockCount = *(undefined8 *)param_1[2].DebugInfo;
    LocalFree(param_1[2].DebugInfo);
    p_Var1 = *(PRTL_CRITICAL_SECTION_DEBUG *)&param_1[2].LockCount;
    param_1[2].DebugInfo = p_Var1;
  }
  pUVar3 = &param_1[0x1c].SpinCount;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined *)pUVar3 = 0;
    pUVar3 = (ULONG_PTR *)((longlong)pUVar3 + 1);
  }
  if (*(HLOCAL *)&param_1[0x1e].LockCount != (HLOCAL)0x0) {
    FUN_180001d60(*(HLOCAL *)&param_1[0x1e].LockCount);
  }
  ppvVar4 = &param_1[0x1d].LockSemaphore;
  for (lVar2 = 0x30; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined *)ppvVar4 = 0;
    ppvVar4 = (HANDLE *)((longlong)ppvVar4 + 1);
  }
  return;
}



undefined8 FUN_1800067f0(longlong *param_1,undefined8 *param_2,uint param_3)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined4 *lpData;
  undefined8 uVar4;
  DWORD local_68 [2];
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  HLOCAL local_48;
  BCRYPT_HASH_HANDLE local_40;
  undefined8 local_38;
  ulonglong local_30;
  
  lVar1 = *param_1;
  if (lVar1 != 0) {
    local_30 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff58;
    if ((param_2 == (undefined8 *)0x0) && (param_3 == 0)) {
      PTR_FUN_180053780 = FUN_18001cbe0;
      PTR_FUN_180053788 = FUN_18001cbe0;
      RegDeleteKeyValueW((HKEY)0xffffffff80000002,(LPCWSTR)(lVar1 + 0x70),
                         (LPCWSTR)PTR_u_SecurityLogParameter_180053790);
    }
    else {
      local_60 = 0;
      local_58 = 0;
      local_50 = 0;
      local_48 = (HLOCAL)0x0;
      local_38 = *(undefined8 *)(lVar1 + 0x4c8);
      local_40 = (BCRYPT_HASH_HANDLE)(lVar1 + 0x480);
      uVar3 = FUN_180002c00(0,(ulonglong)param_3);
      local_68[0] = (DWORD)uVar3;
      lpData = (undefined4 *)LocalAlloc(0,uVar3 & 0xffffffff);
      if (lpData != (undefined4 *)0x0) {
        uVar4 = FUN_180002c30((undefined8 *)0x0,0,param_2,(ulonglong)param_3,lpData,local_68,
                              (BCRYPT_HASH_HANDLE)(lVar1 + 0x480));
        if (((int)uVar4 != 0) && (iVar2 = FUN_180004390(param_2,param_3), iVar2 == 0)) {
          if (local_48 != (HLOCAL)0x0) {
            FUN_180001d60(local_48);
          }
          RegSetKeyValueW((HKEY)0xffffffff80000002,(LPCWSTR)(lVar1 + 0x70),
                          (LPCWSTR)PTR_u_SecurityLogParameter_180053790,3,lpData,local_68[0]);
        }
        LocalFree(lpData);
      }
    }
    uVar4 = FUN_180023ef0(local_30 ^ (ulonglong)&stack0xffffffffffffff58);
    return uVar4;
  }
  return 0;
}



undefined FUN_1800069a0(longlong param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4,ULONG param_5,
                       ULONG *param_6)

{
  int *piVar1;
  bool bVar2;
  uint uVar3;
  
  piVar1 = *(int **)(param_1 + 0x18);
  uVar3 = FUN_180001d50((longlong)piVar1);
  if (param_3 + 0x42 <= uVar3 >> 3) {
    if ((param_4 != (PUCHAR)0x0) || (param_5 != 0)) {
      bVar2 = FUN_180001d70(piVar1,*(ULONG *)(param_1 + 0x10),param_2,param_3,param_4,param_5,
                            param_6);
      return bVar2;
    }
    if (param_6 != (ULONG *)0x0) {
      uVar3 = FUN_180001d50((longlong)piVar1);
      *param_6 = uVar3 >> 3;
      return 1;
    }
  }
  return 0;
}



void FUN_180006a50(LPCRITICAL_SECTION *param_1)

{
  LPCRITICAL_SECTION p_Var1;
  
  if (*param_1 != (LPCRITICAL_SECTION)0x0) {
    PTR_FUN_180053780 = FUN_18001cbe0;
    PTR_FUN_180053788 = FUN_18001cbe0;
    p_Var1 = *param_1;
    if (p_Var1[1].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      *(undefined4 *)&p_Var1[1].OwningThread = 1;
      SetEvent(*(HANDLE *)&p_Var1[1].LockCount);
      WaitForSingleObject(p_Var1[1].DebugInfo,0xffffffff);
      CloseHandle(p_Var1[1].DebugInfo);
      p_Var1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
    }
    p_Var1 = *param_1;
    if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
      FUN_180006700(p_Var1);
      free(p_Var1);
    }
    *param_1 = (LPCRITICAL_SECTION)0x0;
  }
  return;
}



void FUN_180006af0(LPCRITICAL_SECTION *param_1,LPCWSTR param_2)

{
  LPCRITICAL_SECTION p_Var1;
  LPCRITICAL_SECTION lpParameter;
  PRTL_CRITICAL_SECTION_DEBUG p_Var2;
  
  if (*param_1 == (LPCRITICAL_SECTION)0x0) {
    p_Var1 = (LPCRITICAL_SECTION)operator_new(0x4d0);
    lpParameter = (LPCRITICAL_SECTION)0x0;
    if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
      lpParameter = FUN_180006600(p_Var1,param_2);
    }
    *param_1 = lpParameter;
    if (lpParameter[1].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      ResetEvent(*(HANDLE *)&lpParameter[1].LockCount);
      *(undefined4 *)&lpParameter[1].OwningThread = 0;
      p_Var2 = (PRTL_CRITICAL_SECTION_DEBUG)
               CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_1800070f0,lpParameter,0,(LPDWORD)0x0);
      lpParameter[1].DebugInfo = p_Var2;
      if (p_Var2 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
        p_Var1 = *param_1;
        if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
          FUN_180006700(p_Var1);
          free(p_Var1);
        }
        *param_1 = (LPCRITICAL_SECTION)0x0;
      }
    }
  }
  return;
}



bool FUN_180006bb0(longlong param_1)

{
  wchar_t *lpBuffer;
  bool bVar1;
  int iVar2;
  LSTATUS LVar3;
  BOOL BVar4;
  uint *puVar5;
  uint *hMem;
  undefined8 uVar6;
  wchar_t *pwVar7;
  uint local_res8 [2];
  DWORD local_res10 [2];
  uint local_res18 [2];
  HKEY local_res20;
  
  bVar1 = true;
  local_res20 = (HKEY)0x0;
  iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),0,3,(PHKEY)&local_res20);
  if (iVar2 == 5) {
    iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),0,1,(PHKEY)&local_res20
                         );
  }
  if (iVar2 != 0) goto LAB_180006e9a;
  local_res10[0] = 3;
  local_res8[0] = 0;
  LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_180053790,(LPDWORD)0x0,
                           local_res10,(LPBYTE)0x0,local_res8);
  puVar5 = (uint *)0x0;
  if (((LVar3 == 0) || (LVar3 == 0xea)) && (local_res10[0] == 3)) {
    puVar5 = (uint *)LocalAlloc(0,(ulonglong)local_res8[0]);
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_180053790,(LPDWORD)0x0,
                             local_res10,(LPBYTE)puVar5,local_res8);
    if (LVar3 != 0) goto LAB_180006e45;
    local_res18[0] = FUN_180002c10((int *)puVar5,(int *)0x0);
    if (local_res18[0] == 0) goto LAB_180006e45;
    hMem = (uint *)LocalAlloc(0,(ulonglong)local_res18[0]);
    if (hMem == (uint *)0x0) goto LAB_180006e45;
    uVar6 = FUN_180002fc0((int *)puVar5,(uint *)0x0,(uint *)0x0,hMem,local_res18,param_1 + 0x480);
    if ((int)uVar6 == 0) {
      LocalFree(hMem);
      goto LAB_180006e45;
    }
    LocalFree(puVar5);
    local_res8[0] = local_res18[0];
    iVar2 = FUN_180004390(hMem,local_res18[0]);
    puVar5 = hMem;
    if (iVar2 != 0) goto LAB_180006e45;
    local_res8[0] = 4;
    local_res10[0] = 4;
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogMask_180053798,(LPDWORD)0x0,
                             local_res10,(LPBYTE)(int *)(param_1 + 0x6c),local_res8);
    if ((LVar3 != 0) || (*(int *)(param_1 + 0x6c) == 0)) goto LAB_180006e45;
    lpBuffer = (wchar_t *)(param_1 + 0x278);
    local_res8[0] = 0x208;
    local_res10[0] = 1;
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogPath_1800537a0,(LPDWORD)0x0,
                             local_res10,(LPBYTE)lpBuffer,local_res8);
    if (LVar3 == 0) {
      iVar2 = lstrlenW(lpBuffer);
      pwVar7 = (wchar_t *)(param_1 + 0x278 + (longlong)iVar2 * 2);
      if ((lpBuffer < pwVar7) && ((pwVar7[-1] == L'\\' || (pwVar7[-1] == L'/')))) {
        pwVar7[-1] = L'\0';
      }
    }
    else {
      GetSystemDirectoryW(lpBuffer,0x104);
      pwVar7 = wcschr(lpBuffer,L'\\');
      lstrcpyW(pwVar7,L"\\Temp2\\WBF");
    }
    BVar4 = PathFileExistsW(lpBuffer);
    if (BVar4 == 0) goto LAB_180006e45;
    PTR_FUN_180053780 = &LAB_180006ba0;
    PTR_FUN_180053788 = &DAT_180006eb0;
    bVar1 = false;
  }
  else {
LAB_180006e45:
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_180053790);
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogMask_180053798);
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogPath_1800537a0);
  }
  if (puVar5 != (uint *)0x0) {
    LocalFree(puVar5);
  }
  RegCloseKey(local_res20);
LAB_180006e9a:
  return !bVar1;
}



undefined8 FUN_1800070f0(LPCRITICAL_SECTION param_1)

{
  FUN_1800071d0(param_1);
  return 0;
}



undefined8 FUN_180007100(longlong *param_1,undefined8 param_2,uint param_3,uint *param_4)

{
  int iVar1;
  uint local_res8 [8];
  undefined8 local_18 [2];
  
  if (*param_1 != 0) {
    local_res8[0] = param_3;
    local_18[0] = param_2;
    iVar1 = FUN_180003c70(local_18,local_res8);
    if (iVar1 == 0) {
      *param_4 = local_res8[0];
      return 1;
    }
  }
  return 0;
}



void FUN_1800071d0(LPCRITICAL_SECTION param_1)

{
  bool bVar1;
  DWORD DVar2;
  undefined7 extraout_var;
  PRTL_CRITICAL_SECTION_DEBUG p_Var3;
  HANDLE local_38;
  HANDLE local_30;
  code *local_28;
  undefined *local_20;
  HANDLE *local_18;
  HANDLE *local_10;
  
  bVar1 = FUN_180006bb0((longlong)param_1);
  if (((int)CONCAT71(extraout_var,bVar1) != 0) && (*(longlong *)&param_1[0x1e].LockCount != 0)) {
    local_28 = FUN_1800069a0;
    local_20 = &LAB_180007150;
    local_18 = &param_1[0x1d].LockSemaphore;
    local_38 = *(HANDLE *)&param_1[1].LockCount;
    local_30 = param_1[1].LockSemaphore;
    local_10 = local_18;
    DVar2 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
    while (DVar2 == 1) {
      EnterCriticalSection(param_1);
      p_Var3 = param_1[2].DebugInfo;
      param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var3;
      LeaveCriticalSection(param_1);
      do {
        FUN_180004ad0(&local_28,&p_Var3->CriticalSection,&p_Var3[0xb].CriticalSection,
                      *(int *)(p_Var3 + 0xb),*(int *)&p_Var3[0xb].field_0x4);
        EnterCriticalSection(param_1);
        *(HANDLE *)p_Var3 = param_1[2].OwningThread;
        param_1[2].OwningThread = p_Var3;
        if (*(longlong *)p_Var3 == 0) {
          SetEvent((HANDLE)param_1[1].SpinCount);
        }
        p_Var3 = param_1[2].DebugInfo;
        if (p_Var3 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
          ResetEvent(param_1[1].LockSemaphore);
        }
        else {
          param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var3;
        }
        LeaveCriticalSection(param_1);
      } while ((p_Var3 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) &&
              (*(int *)&param_1[1].OwningThread == 0));
      DVar2 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
    }
  }
  return;
}



undefined ** FUN_180007320(undefined **param_1)

{
  param_1[1] = (undefined *)0x0;
  *param_1 = (undefined *)&PTR_FUN_180044688;
  return param_1;
}



undefined ** FUN_180007390(undefined **param_1,uint param_2)

{
  SIZE_T SVar1;
  undefined *puVar2;
  
  *param_1 = (undefined *)&PTR_FUN_180044688;
  if (param_1[1] != (undefined *)0x0) {
    SVar1 = LocalSize(param_1[1]);
    puVar2 = param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree(param_1[1]);
  }
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// WARNING: Type propagation algorithm not settling

void FUN_180007400(longlong param_1,longlong *param_2,int param_3,undefined4 *param_4,int param_5,
                  undefined4 *param_6)

{
  int *piVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  undefined7 extraout_var_11;
  longlong lVar4;
  UCHAR *pUVar5;
  undefined *puVar6;
  undefined4 *puVar7;
  uint *puVar8;
  int *local_238;
  int local_230 [2];
  UCHAR local_228 [8];
  undefined4 local_220;
  undefined4 uStack540;
  undefined4 uStack536;
  undefined4 uStack532;
  undefined4 local_210;
  undefined4 uStack524;
  undefined4 uStack520;
  undefined4 uStack516;
  undefined4 local_200;
  undefined4 uStack508;
  undefined4 uStack504;
  undefined4 uStack500;
  undefined4 local_1f0;
  undefined4 uStack492;
  undefined4 uStack488;
  undefined4 uStack484;
  undefined4 local_1e0 [10];
  undefined local_1b8 [4];
  int local_1b4;
  int iStack432;
  int iStack428;
  int iStack424;
  int local_1a4;
  int iStack416;
  int iStack412;
  int iStack408;
  uint local_194 [8];
  undefined8 local_174;
  undefined4 uStack364;
  undefined4 uStack360;
  undefined4 local_164;
  undefined4 uStack352;
  undefined4 uStack348;
  undefined4 uStack344;
  UCHAR local_134 [64];
  undefined4 local_f4 [11];
  undefined4 local_c8;
  undefined4 uStack196;
  undefined4 uStack192;
  undefined4 uStack188;
  UCHAR local_b8 [16];
  UCHAR local_a8 [16];
  UCHAR local_98 [16];
  uint local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  UCHAR local_68 [16];
  UCHAR local_58 [16];
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffd88;
  if (((param_3 == 0xd0) && (param_5 == 0xd0)) &&
     (piVar1 = *(int **)(param_1 + 8), piVar1 != (int *)0x0)) {
    local_238 = piVar1;
    iVar3 = FUN_1800014d0((PUCHAR)&local_238,8,(PUCHAR)(piVar1 + 1),0x20,local_a8);
    if (iVar3 != 0) {
      bVar2 = thunk_FUN_1800024b0(local_a8,local_98,(uint *)(piVar1 + 9),local_194,0xc0);
      pUVar5 = local_a8;
      for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
        *pUVar5 = '\0';
        pUVar5 = pUVar5 + 1;
      }
      if ((int)CONCAT71(extraout_var,bVar2) != 0) {
        iVar3 = FUN_180001390((PUCHAR)&local_174,0x40,(PUCHAR)&local_c8);
        if (((iVar3 != 0) && (*param_2 == CONCAT44(uStack196,local_c8))) &&
           (param_2[1] == CONCAT44(uStack188,uStack192))) {
          local_230[0] = 0;
          bVar2 = FUN_180001a00(&local_174,(PUCHAR)param_2,0x90,(PUCHAR)(param_2 + 0x12),local_230);
          if ((((int)CONCAT71(extraout_var_00,bVar2) != 0) && (local_230[0] != 0)) &&
             ((bVar2 = thunk_FUN_1800024b0(local_b8,(PUCHAR)&local_c8,(uint *)(param_2 + 2),
                                           (uint *)(param_2 + 2),0x80),
              (int)CONCAT71(extraout_var_01,bVar2) != 0 &&
              ((((bVar2 = FUN_180001ba0(local_228,1), (int)CONCAT71(extraout_var_02,bVar2) != 0 &&
                 (bVar2 = FUN_180001200((PUCHAR)&local_88,0x20),
                 (int)CONCAT71(extraout_var_03,bVar2) != 0)) &&
                (bVar2 = FUN_180002060(local_1e0,0x20,(undefined4 *)(param_2 + 6),0x40,param_2 + 0xe
                                       ,0x20,local_68,0x20),
                (int)CONCAT71(extraout_var_04,bVar2) != 0)) &&
               (bVar2 = FUN_180001200((PUCHAR)(param_4 + 4),0x20),
               (int)CONCAT71(extraout_var_05,bVar2) != 0)))))) {
            param_4[0xc] = local_220;
            param_4[0xd] = uStack540;
            param_4[0xe] = uStack536;
            param_4[0xf] = uStack532;
            param_4[0x10] = local_210;
            param_4[0x11] = uStack524;
            param_4[0x12] = uStack520;
            param_4[0x13] = uStack516;
            param_4[0x14] = local_200;
            param_4[0x15] = uStack508;
            param_4[0x16] = uStack504;
            param_4[0x17] = uStack500;
            param_4[0x18] = local_1f0;
            param_4[0x19] = uStack492;
            param_4[0x1a] = uStack488;
            param_4[0x1b] = uStack484;
            bVar2 = FUN_1800024b0(local_68,local_58,&local_88,param_4 + 0x1c,0x20);
            if (((int)CONCAT71(extraout_var_06,bVar2) != 0) &&
               (iVar3 = FUN_180001390(local_134,0x40,(PUCHAR)&local_c8), iVar3 != 0)) {
              *param_4 = local_c8;
              param_4[1] = uStack196;
              param_4[2] = uStack192;
              param_4[3] = uStack188;
              bVar2 = FUN_1800024b0(local_b8,(PUCHAR)&local_c8,param_4 + 4,param_4 + 4,0x80);
              if (((int)CONCAT71(extraout_var_07,bVar2) != 0) &&
                 (bVar2 = FUN_180001970(local_f4,(PUCHAR)param_4,0x90,(PUCHAR)(param_4 + 0x24)),
                 (int)CONCAT71(extraout_var_08,bVar2) != 0)) {
                *param_6 = 0xd0;
                bVar2 = FUN_180001200((PUCHAR)local_194,0x20);
                if ((int)CONCAT71(extraout_var_09,bVar2) != 0) {
                  local_174._0_4_ = local_88;
                  local_174._4_4_ = uStack132;
                  uStack364 = uStack128;
                  uStack360 = uStack124;
                  local_164 = local_78;
                  uStack352 = uStack116;
                  uStack348 = uStack112;
                  uStack344 = uStack108;
                  bVar2 = FUN_180001200((PUCHAR)&local_1b4,0x20);
                  piVar1 = local_238;
                  if (((int)CONCAT71(extraout_var_10,bVar2) != 0) &&
                     (iVar3 = FUN_1800014d0((PUCHAR)&local_238,8,(PUCHAR)&local_1b4,0x20,local_a8),
                     iVar3 != 0)) {
                    bVar2 = thunk_FUN_1800024b0(local_a8,local_98,local_194,(uint *)(piVar1 + 9),
                                                0x40);
                    pUVar5 = local_a8;
                    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
                      *pUVar5 = '\0';
                      pUVar5 = pUVar5 + 1;
                    }
                    if ((int)CONCAT71(extraout_var_11,bVar2) != 0) {
                      local_238[1] = local_1b4;
                      local_238[2] = iStack432;
                      local_238[3] = iStack428;
                      local_238[4] = iStack424;
                      local_238[5] = local_1a4;
                      local_238[6] = iStack416;
                      local_238[7] = iStack412;
                      local_238[8] = iStack408;
                      *local_238 = 1;
                    }
                  }
                }
              }
            }
          }
        }
        puVar6 = local_1b8;
        for (lVar4 = 0xe4; lVar4 != 0; lVar4 = lVar4 + -1) {
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        }
        pUVar5 = local_228;
        for (lVar4 = 0x68; lVar4 != 0; lVar4 = lVar4 + -1) {
          *pUVar5 = '\0';
          pUVar5 = pUVar5 + 1;
        }
        puVar7 = &local_c8;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *(undefined *)puVar7 = 0;
          puVar7 = (undefined4 *)((longlong)puVar7 + 1);
        }
        pUVar5 = local_68;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *pUVar5 = '\0';
          pUVar5 = pUVar5 + 1;
        }
        puVar8 = &local_88;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *(undefined *)puVar8 = 0;
          puVar8 = (uint *)((longlong)puVar8 + 1);
        }
      }
    }
  }
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xfffffffffffffd88);
  return;
}



void FUN_180007ef0(longlong param_1,undefined4 *param_2,int param_3,undefined4 *param_4,int param_5)

{
  uint *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  bool bVar5;
  int iVar6;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  SIZE_T SVar7;
  longlong lVar8;
  UCHAR *pUVar9;
  undefined *puVar10;
  undefined4 *puVar11;
  undefined *local_c8 [2];
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 uStack172;
  undefined4 uStack168;
  undefined4 uStack164;
  undefined4 local_a0;
  undefined4 uStack156;
  undefined4 uStack152;
  undefined4 uStack148;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_80;
  undefined4 uStack124;
  undefined4 uStack120;
  undefined4 uStack116;
  undefined4 local_70;
  undefined4 uStack108;
  undefined4 uStack104;
  undefined4 uStack100;
  undefined4 local_60;
  undefined4 uStack92;
  undefined4 uStack88;
  undefined4 uStack84;
  UCHAR local_48 [16];
  UCHAR local_38 [16];
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff08;
  if (((param_3 == 0x40) && (param_5 == 0x20)) &&
     (local_c8[0] = (undefined *)LocalAlloc(0,0xe4), local_c8[0] != (undefined *)0x0)) {
    bVar5 = FUN_180001200(local_c8[0] + 4,0x20);
    if (((int)CONCAT71(extraout_var,bVar5) != 0) &&
       (bVar5 = FUN_180001200(local_c8[0] + 0x24,0x20), (int)CONCAT71(extraout_var_00,bVar5) != 0))
    {
      FUN_1800244a0((undefined (*) [16])&local_b8,0,0x68);
      local_b8 = 0x32534345;
      local_70 = *param_4;
      uStack108 = param_4[1];
      uStack104 = param_4[2];
      uStack100 = param_4[3];
      local_60 = param_4[4];
      uStack92 = param_4[5];
      uStack88 = param_4[6];
      uStack84 = param_4[7];
      local_b4 = 0x20;
      bVar5 = FUN_180001ac0((PUCHAR)&local_b8);
      if ((int)CONCAT71(extraout_var_01,bVar5) != 0) {
        uVar2 = param_2[1];
        uVar3 = param_2[2];
        uVar4 = param_2[3];
        *(undefined4 *)(local_c8[0] + 0x44) = *param_2;
        *(undefined4 *)(local_c8[0] + 0x48) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x4c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x50) = uVar4;
        uVar2 = param_2[5];
        uVar3 = param_2[6];
        uVar4 = param_2[7];
        *(undefined4 *)(local_c8[0] + 0x54) = param_2[4];
        *(undefined4 *)(local_c8[0] + 0x58) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x5c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x60) = uVar4;
        uVar2 = param_2[9];
        uVar3 = param_2[10];
        uVar4 = param_2[0xb];
        *(undefined4 *)(local_c8[0] + 100) = param_2[8];
        *(undefined4 *)(local_c8[0] + 0x68) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x6c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x70) = uVar4;
        uVar2 = param_2[0xd];
        uVar3 = param_2[0xe];
        uVar4 = param_2[0xf];
        *(undefined4 *)(local_c8[0] + 0x74) = param_2[0xc];
        *(undefined4 *)(local_c8[0] + 0x78) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x7c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x80) = uVar4;
        *(undefined4 *)(local_c8[0] + 0x84) = local_b0;
        *(undefined4 *)(local_c8[0] + 0x88) = uStack172;
        *(undefined4 *)(local_c8[0] + 0x8c) = uStack168;
        *(undefined4 *)(local_c8[0] + 0x90) = uStack164;
        *(undefined4 *)(local_c8[0] + 0x94) = local_a0;
        *(undefined4 *)(local_c8[0] + 0x98) = uStack156;
        *(undefined4 *)(local_c8[0] + 0x9c) = uStack152;
        *(undefined4 *)(local_c8[0] + 0xa0) = uStack148;
        *(undefined4 *)(local_c8[0] + 0xa4) = local_90;
        *(undefined4 *)(local_c8[0] + 0xa8) = uStack140;
        *(undefined4 *)(local_c8[0] + 0xac) = uStack136;
        *(undefined4 *)(local_c8[0] + 0xb0) = uStack132;
        *(undefined4 *)(local_c8[0] + 0xb4) = local_80;
        *(undefined4 *)(local_c8[0] + 0xb8) = uStack124;
        *(undefined4 *)(local_c8[0] + 0xbc) = uStack120;
        *(undefined4 *)(local_c8[0] + 0xc0) = uStack116;
        *(undefined4 *)(local_c8[0] + 0xc4) = local_70;
        *(undefined4 *)(local_c8[0] + 200) = uStack108;
        *(undefined4 *)(local_c8[0] + 0xcc) = uStack104;
        *(undefined4 *)(local_c8[0] + 0xd0) = uStack100;
        *(undefined4 *)(local_c8[0] + 0xd4) = local_60;
        *(undefined4 *)(local_c8[0] + 0xd8) = uStack92;
        *(undefined4 *)(local_c8[0] + 0xdc) = uStack88;
        *(undefined4 *)(local_c8[0] + 0xe0) = uStack84;
        puVar1 = (uint *)(local_c8[0] + 0x24);
        iVar6 = FUN_1800014d0((PUCHAR)local_c8,8,local_c8[0] + 4,0x20,local_48);
        if (iVar6 != 0) {
          bVar5 = FUN_1800024b0(local_48,local_38,puVar1,puVar1,0xc0);
          pUVar9 = local_48;
          for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
            *pUVar9 = '\0';
            pUVar9 = pUVar9 + 1;
          }
          if ((int)CONCAT71(extraout_var_02,bVar5) != 0) {
            if (*(HLOCAL *)(param_1 + 8) != (HLOCAL)0x0) {
              SVar7 = LocalSize(*(HLOCAL *)(param_1 + 8));
              puVar10 = *(undefined **)(param_1 + 8);
              for (; SVar7 != 0; SVar7 = SVar7 - 1) {
                *puVar10 = 0;
                puVar10 = puVar10 + 1;
              }
            }
            *(undefined **)(param_1 + 8) = local_c8[0];
            local_c8[0] = (undefined *)0x0;
          }
        }
      }
    }
    puVar11 = &local_b8;
    for (lVar8 = 0x68; lVar8 != 0; lVar8 = lVar8 + -1) {
      *(undefined *)puVar11 = 0;
      puVar11 = (undefined4 *)((longlong)puVar11 + 1);
    }
    pUVar9 = local_48;
    for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
      *pUVar9 = '\0';
      pUVar9 = pUVar9 + 1;
    }
    if (local_c8[0] != (undefined *)0x0) {
      puVar10 = local_c8[0];
      for (lVar8 = 0xe4; lVar8 != 0; lVar8 = lVar8 + -1) {
        *puVar10 = 0;
        puVar10 = puVar10 + 1;
      }
      LocalFree(local_c8[0]);
    }
  }
  FUN_180023ef0(local_28 ^ (ulonglong)&stack0xffffffffffffff08);
  return;
}



ulonglong FUN_180008110(void)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  int iVar6;
  uint uVar7;
  ulonglong uVar8;
  LPVOID pvVar9;
  longlong *plVar10;
  longlong lVar11;
  char *pcVar12;
  longlong *plVar13;
  undefined4 *puVar14;
  undefined4 *puVar15;
  
  uVar8 = FUN_18000a320();
  if ((int)uVar8 == 0) {
    pvVar9 = TlsGetValue(DAT_180055088);
    iVar6 = FUN_180008370(*(undefined4 **)((longlong)pvVar9 + 0x28));
    if (iVar6 == 0x1d) {
      return 0xf;
    }
    plVar10 = (longlong *)TlsGetValue(DAT_180055088);
    pvVar9 = TlsGetValue(DAT_180055088);
    lVar11 = 0x29;
    puVar4 = (undefined4 *)(*plVar10 + 0xe);
    puVar5 = *(undefined4 **)((longlong)pvVar9 + 0x28);
    do {
      puVar15 = puVar5;
      puVar14 = puVar4;
      uVar1 = puVar15[1];
      uVar2 = puVar15[2];
      uVar3 = puVar15[3];
      *puVar14 = *puVar15;
      puVar14[1] = uVar1;
      puVar14[2] = uVar2;
      puVar14[3] = uVar3;
      uVar1 = puVar15[5];
      uVar2 = puVar15[6];
      uVar3 = puVar15[7];
      puVar14[4] = puVar15[4];
      puVar14[5] = uVar1;
      puVar14[6] = uVar2;
      puVar14[7] = uVar3;
      uVar1 = puVar15[9];
      uVar2 = puVar15[10];
      uVar3 = puVar15[0xb];
      puVar14[8] = puVar15[8];
      puVar14[9] = uVar1;
      puVar14[10] = uVar2;
      puVar14[0xb] = uVar3;
      uVar1 = puVar15[0xd];
      uVar2 = puVar15[0xe];
      uVar3 = puVar15[0xf];
      puVar14[0xc] = puVar15[0xc];
      puVar14[0xd] = uVar1;
      puVar14[0xe] = uVar2;
      puVar14[0xf] = uVar3;
      uVar1 = puVar15[0x11];
      uVar2 = puVar15[0x12];
      uVar3 = puVar15[0x13];
      puVar14[0x10] = puVar15[0x10];
      puVar14[0x11] = uVar1;
      puVar14[0x12] = uVar2;
      puVar14[0x13] = uVar3;
      uVar1 = puVar15[0x15];
      uVar2 = puVar15[0x16];
      uVar3 = puVar15[0x17];
      puVar14[0x14] = puVar15[0x14];
      puVar14[0x15] = uVar1;
      puVar14[0x16] = uVar2;
      puVar14[0x17] = uVar3;
      uVar1 = puVar15[0x19];
      uVar2 = puVar15[0x1a];
      uVar3 = puVar15[0x1b];
      puVar14[0x18] = puVar15[0x18];
      puVar14[0x19] = uVar1;
      puVar14[0x1a] = uVar2;
      puVar14[0x1b] = uVar3;
      uVar1 = puVar15[0x1d];
      uVar2 = puVar15[0x1e];
      uVar3 = puVar15[0x1f];
      puVar14[0x1c] = puVar15[0x1c];
      puVar14[0x1d] = uVar1;
      puVar14[0x1e] = uVar2;
      puVar14[0x1f] = uVar3;
      lVar11 = lVar11 + -1;
      puVar4 = puVar14 + 0x20;
      puVar5 = puVar15 + 0x20;
    } while (lVar11 != 0);
    uVar1 = puVar15[0x21];
    uVar2 = puVar15[0x22];
    uVar3 = puVar15[0x23];
    puVar14[0x20] = puVar15[0x20];
    puVar14[0x21] = uVar1;
    puVar14[0x22] = uVar2;
    puVar14[0x23] = uVar3;
    uVar1 = puVar15[0x25];
    uVar2 = puVar15[0x26];
    uVar3 = puVar15[0x27];
    puVar14[0x24] = puVar15[0x24];
    puVar14[0x25] = uVar1;
    puVar14[0x26] = uVar2;
    puVar14[0x27] = uVar3;
    uVar1 = puVar15[0x29];
    uVar2 = puVar15[0x2a];
    uVar3 = puVar15[0x2b];
    puVar14[0x28] = puVar15[0x28];
    puVar14[0x29] = uVar1;
    puVar14[0x2a] = uVar2;
    puVar14[0x2b] = uVar3;
    uVar1 = puVar15[0x2d];
    uVar2 = puVar15[0x2e];
    uVar3 = puVar15[0x2f];
    puVar14[0x2c] = puVar15[0x2c];
    puVar14[0x2d] = uVar1;
    puVar14[0x2e] = uVar2;
    puVar14[0x2f] = uVar3;
    uVar1 = puVar15[0x31];
    uVar2 = puVar15[0x32];
    uVar3 = puVar15[0x33];
    puVar14[0x30] = puVar15[0x30];
    puVar14[0x31] = uVar1;
    puVar14[0x32] = uVar2;
    puVar14[0x33] = uVar3;
    uVar1 = puVar15[0x35];
    uVar2 = puVar15[0x36];
    uVar3 = puVar15[0x37];
    puVar14[0x34] = puVar15[0x34];
    puVar14[0x35] = uVar1;
    puVar14[0x36] = uVar2;
    puVar14[0x37] = uVar3;
    *(undefined8 *)(puVar14 + 0x38) = *(undefined8 *)(puVar15 + 0x38);
    puVar14[0x3a] = puVar15[0x3a];
    plVar10 = (longlong *)TlsGetValue(DAT_180055088);
    FUN_180009f90((undefined *)(*plVar10 + 0x14fa),0);
    pcVar12 = strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
    if (pcVar12 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
    }
    TlsGetValue(DAT_180055088);
    FUN_180004810();
    uVar8 = FUN_180009a40();
    if ((int)uVar8 == 0) {
      FUN_18000ab70();
      plVar10 = (longlong *)TlsGetValue(DAT_180055088);
      plVar13 = (longlong *)TlsGetValue(DAT_180055088);
      uVar7 = FUN_180009330(*plVar13,(int *)(*plVar10 + 0x29e8));
      uVar8 = (ulonglong)uVar7;
      pcVar12 = strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
      if (pcVar12 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
      }
      TlsGetValue(DAT_180055088);
      FUN_180004810();
    }
  }
  return uVar8;
}



int FUN_180008370(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int iVar5;
  int iVar6;
  undefined4 *_Memory;
  char *pcVar7;
  undefined4 *puVar8;
  longlong lVar9;
  undefined4 *puVar10;
  
  _Memory = (undefined4 *)malloc(0x14ec);
  iVar5 = FUN_180009f20(_Memory,0x67,0x34);
  if (param_1 != (undefined4 *)0x0) {
    lVar9 = 0x29;
    puVar4 = _Memory;
    do {
      puVar10 = param_1;
      puVar8 = puVar4;
      uVar1 = puVar8[1];
      uVar2 = puVar8[2];
      uVar3 = puVar8[3];
      *puVar10 = *puVar8;
      puVar10[1] = uVar1;
      puVar10[2] = uVar2;
      puVar10[3] = uVar3;
      uVar1 = puVar8[5];
      uVar2 = puVar8[6];
      uVar3 = puVar8[7];
      puVar10[4] = puVar8[4];
      puVar10[5] = uVar1;
      puVar10[6] = uVar2;
      puVar10[7] = uVar3;
      uVar1 = puVar8[9];
      uVar2 = puVar8[10];
      uVar3 = puVar8[0xb];
      puVar10[8] = puVar8[8];
      puVar10[9] = uVar1;
      puVar10[10] = uVar2;
      puVar10[0xb] = uVar3;
      uVar1 = puVar8[0xd];
      uVar2 = puVar8[0xe];
      uVar3 = puVar8[0xf];
      puVar10[0xc] = puVar8[0xc];
      puVar10[0xd] = uVar1;
      puVar10[0xe] = uVar2;
      puVar10[0xf] = uVar3;
      uVar1 = puVar8[0x11];
      uVar2 = puVar8[0x12];
      uVar3 = puVar8[0x13];
      puVar10[0x10] = puVar8[0x10];
      puVar10[0x11] = uVar1;
      puVar10[0x12] = uVar2;
      puVar10[0x13] = uVar3;
      uVar1 = puVar8[0x15];
      uVar2 = puVar8[0x16];
      uVar3 = puVar8[0x17];
      puVar10[0x14] = puVar8[0x14];
      puVar10[0x15] = uVar1;
      puVar10[0x16] = uVar2;
      puVar10[0x17] = uVar3;
      uVar1 = puVar8[0x19];
      uVar2 = puVar8[0x1a];
      uVar3 = puVar8[0x1b];
      puVar10[0x18] = puVar8[0x18];
      puVar10[0x19] = uVar1;
      puVar10[0x1a] = uVar2;
      puVar10[0x1b] = uVar3;
      uVar1 = puVar8[0x1d];
      uVar2 = puVar8[0x1e];
      uVar3 = puVar8[0x1f];
      puVar10[0x1c] = puVar8[0x1c];
      puVar10[0x1d] = uVar1;
      puVar10[0x1e] = uVar2;
      puVar10[0x1f] = uVar3;
      lVar9 = lVar9 + -1;
      puVar4 = puVar8 + 0x20;
      param_1 = puVar10 + 0x20;
    } while (lVar9 != 0);
    uVar1 = puVar8[0x21];
    uVar2 = puVar8[0x22];
    uVar3 = puVar8[0x23];
    puVar10[0x20] = puVar8[0x20];
    puVar10[0x21] = uVar1;
    puVar10[0x22] = uVar2;
    puVar10[0x23] = uVar3;
    uVar1 = puVar8[0x25];
    uVar2 = puVar8[0x26];
    uVar3 = puVar8[0x27];
    puVar10[0x24] = puVar8[0x24];
    puVar10[0x25] = uVar1;
    puVar10[0x26] = uVar2;
    puVar10[0x27] = uVar3;
    uVar1 = puVar8[0x29];
    uVar2 = puVar8[0x2a];
    uVar3 = puVar8[0x2b];
    puVar10[0x28] = puVar8[0x28];
    puVar10[0x29] = uVar1;
    puVar10[0x2a] = uVar2;
    puVar10[0x2b] = uVar3;
    uVar1 = puVar8[0x2d];
    uVar2 = puVar8[0x2e];
    uVar3 = puVar8[0x2f];
    puVar10[0x2c] = puVar8[0x2c];
    puVar10[0x2d] = uVar1;
    puVar10[0x2e] = uVar2;
    puVar10[0x2f] = uVar3;
    uVar1 = puVar8[0x31];
    uVar2 = puVar8[0x32];
    uVar3 = puVar8[0x33];
    puVar10[0x30] = puVar8[0x30];
    puVar10[0x31] = uVar1;
    puVar10[0x32] = uVar2;
    puVar10[0x33] = uVar3;
    uVar1 = puVar8[0x35];
    uVar2 = puVar8[0x36];
    uVar3 = puVar8[0x37];
    puVar10[0x34] = puVar8[0x34];
    puVar10[0x35] = uVar1;
    puVar10[0x36] = uVar2;
    puVar10[0x37] = uVar3;
    *(undefined8 *)(puVar10 + 0x38) = *(undefined8 *)(puVar8 + 0x38);
    puVar10[0x3a] = puVar8[0x3a];
  }
  if (iVar5 == 0) {
    iVar6 = FUN_18000c270(_Memory,(int *)0x0,(int *)0x0);
    pcVar7 = strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
    if (pcVar7 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
    }
    FUN_180004810();
    if (0xb9 < iVar6) {
      pcVar7 = strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
      if (pcVar7 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_calibration.c",0x2f);
      }
      FUN_180005550((byte *)_Memory,0x67,0x34,0x67,0);
      FUN_180004810();
      iVar5 = 0x1d;
    }
  }
  free(_Memory);
  return iVar5;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Type propagation algorithm not settling
// WARNING: Could not reconcile some variable overlaps

void FUN_180008580(undefined8 *param_1,uint param_2,int param_3,int param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte bVar8;
  int iVar9;
  int iVar10;
  undefined8 *puVar11;
  byte *pbVar12;
  longlong lVar13;
  longlong lVar14;
  longlong lVar15;
  longlong lVar16;
  int iVar17;
  longlong lVar18;
  undefined8 local_3260;
  undefined8 local_3258;
  undefined8 local_3250;
  byte local_3247;
  byte local_3228;
  byte local_321f;
  ulonglong local_50;
  undefined8 uStack56;
  
  uStack56 = 0x180008594;
  local_50 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffcd70;
  lVar18 = (longlong)(int)param_2;
  local_3260 = 0;
  local_3258 = 0;
  FUN_180023f20(&local_3250,param_1,(longlong)(int)(param_3 * param_2));
  FUN_180005f20((longlong)&local_3250,param_2,param_3,0xa0,0x50);
  local_3260._4_4_ = 0;
  thunk_FUN_1800167e0(&local_3250,0xa0,0x50,(undefined4 *)0x0,3);
  iVar17 = 1;
  lVar16 = 8;
  iVar9 = 0;
  iVar10 = iVar9;
  if (((byte)local_3250 < 0x3c) || (iVar10 = iVar17, 0x78 < (byte)local_3250)) {
    lVar13 = (longlong)iVar10 * 4;
    iVar10 = *(int *)((longlong)&local_3260 + lVar13);
    puVar11 = param_1;
    lVar14 = lVar16;
    do {
      bVar8 = *(byte *)puVar11;
      pbVar12 = (byte *)((longlong)puVar11 + 1);
      pbVar1 = (byte *)((longlong)puVar11 + 2);
      pbVar2 = (byte *)((longlong)puVar11 + 3);
      pbVar3 = (byte *)((longlong)puVar11 + 4);
      pbVar4 = (byte *)((longlong)puVar11 + 5);
      pbVar5 = (byte *)((longlong)puVar11 + 6);
      pbVar6 = (byte *)((longlong)puVar11 + 7);
      puVar11 = (undefined8 *)((longlong)puVar11 + lVar18);
      iVar10 = iVar10 + (uint)bVar8 + (uint)*pbVar12 + (uint)*pbVar1 + (uint)*pbVar2 + (uint)*pbVar3
               + (uint)*pbVar4 + (uint)*pbVar5 + (uint)*pbVar6;
      lVar14 = lVar14 + -1;
    } while (lVar14 != 0);
    *(int *)((longlong)&local_3250 + lVar13 + -8) =
         *(int *)((longlong)&local_3250 + lVar13 + -8) + 0x40;
    *(int *)((longlong)&local_3260 + lVar13) = iVar10;
  }
  puVar11 = param_1 + -1;
  iVar10 = iVar9;
  if ((local_3247 < 0x3c) || (iVar10 = iVar17, 0x78 < local_3247)) {
    lVar13 = (longlong)iVar10 * 4;
    iVar10 = *(int *)((longlong)&local_3260 + lVar13);
    lVar14 = lVar16;
    do {
      puVar11 = (undefined8 *)((longlong)puVar11 + lVar18);
      iVar10 = iVar10 + (uint)*(byte *)puVar11 + (uint)*(byte *)((longlong)puVar11 + 1) +
               (uint)*(byte *)((longlong)puVar11 + 2) + (uint)*(byte *)((longlong)puVar11 + 3) +
               (uint)*(byte *)((longlong)puVar11 + 4) + (uint)*(byte *)((longlong)puVar11 + 5) +
               (uint)*(byte *)((longlong)puVar11 + 6) + (uint)*(byte *)((longlong)puVar11 + 7);
      lVar14 = lVar14 + -1;
    } while (lVar14 != 0);
    *(int *)((longlong)&local_3250 + lVar13 + -8) =
         *(int *)((longlong)&local_3250 + lVar13 + -8) + 0x40;
    *(int *)((longlong)&local_3260 + lVar13) = iVar10;
  }
  lVar13 = (longlong)(int)((param_3 + -8) * param_2);
  pbVar12 = (byte *)(lVar13 + (longlong)param_1);
  iVar10 = iVar9;
  if ((local_3228 < 0x3c) || (iVar10 = iVar17, 0x78 < local_3228)) {
    lVar14 = (longlong)iVar10 * 4;
    iVar10 = *(int *)((longlong)&local_3260 + lVar14);
    lVar15 = lVar16;
    do {
      bVar8 = *pbVar12;
      pbVar1 = pbVar12 + 1;
      pbVar2 = pbVar12 + 2;
      pbVar3 = pbVar12 + 3;
      pbVar4 = pbVar12 + 4;
      pbVar5 = pbVar12 + 5;
      pbVar6 = pbVar12 + 6;
      pbVar7 = pbVar12 + 7;
      pbVar12 = pbVar12 + lVar18;
      iVar10 = iVar10 + (uint)bVar8 + (uint)*pbVar1 + (uint)*pbVar2 + (uint)*pbVar3 + (uint)*pbVar4
               + (uint)*pbVar5 + (uint)*pbVar6 + (uint)*pbVar7;
      lVar15 = lVar15 + -1;
    } while (lVar15 != 0);
    *(int *)((longlong)&local_3250 + lVar14 + -8) =
         *(int *)((longlong)&local_3250 + lVar14 + -8) + 0x40;
    *(int *)((longlong)&local_3260 + lVar14) = iVar10;
  }
  pbVar12 = (byte *)((longlong)param_1 + lVar13 + lVar18 + -8);
  if ((local_321f < 0x3c) || (iVar9 = iVar17, 0x78 < local_321f)) {
    lVar13 = (longlong)iVar9 * 4;
    iVar9 = *(int *)((longlong)&local_3260 + lVar13);
    do {
      bVar8 = *pbVar12;
      pbVar1 = pbVar12 + 1;
      pbVar2 = pbVar12 + 2;
      pbVar3 = pbVar12 + 3;
      pbVar4 = pbVar12 + 4;
      pbVar5 = pbVar12 + 5;
      pbVar6 = pbVar12 + 6;
      pbVar7 = pbVar12 + 7;
      pbVar12 = pbVar12 + lVar18;
      iVar9 = iVar9 + (uint)bVar8 + (uint)*pbVar1 + (uint)*pbVar2 + (uint)*pbVar3 + (uint)*pbVar4 +
              (uint)*pbVar5 + (uint)*pbVar6 + (uint)*pbVar7;
      lVar16 = lVar16 + -1;
    } while (lVar16 != 0);
    *(int *)((longlong)&local_3250 + lVar13 + -8) =
         *(int *)((longlong)&local_3250 + lVar13 + -8) + 0x40;
    *(int *)((longlong)&local_3260 + lVar13) = iVar9;
  }
  if (0 < (int)local_3258) {
    local_3260._0_4_ = (int)local_3260 / (int)local_3258;
    if (0 < local_3258._4_4_) {
      local_3260._4_4_ = local_3260._4_4_ / local_3258._4_4_;
    }
    if (param_4 == 0) {
      if (0xff - (int)local_3260 <= 0xff - local_3260._4_4_) {
        FUN_180006380((byte *)param_1,param_2,param_3,0xff - (int)local_3260);
      }
    }
    else {
      if (((int)local_3260 <= local_3260._4_4_) || (local_3260._4_4_ < 1)) {
        FUN_180006380((byte *)param_1,param_2,param_3,-(int)local_3260);
      }
    }
  }
  FUN_180023ef0(local_50 ^ (ulonglong)&stack0xffffffffffffcd70);
  return;
}



int FUN_1800088a0(byte param_1,byte *param_2,char param_3)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  LPVOID pvVar4;
  undefined8 uVar5;
  byte bVar6;
  int iVar7;
  byte bVar8;
  int iVar9;
  int iVar10;
  byte local_res20 [8];
  undefined2 in_stack_ffffffffffffffa8;
  undefined uVar11;
  uint in_stack_ffffffffffffffb0;
  undefined3 uVar12;
  byte local_48;
  byte local_47;
  undefined local_44;
  undefined local_43;
  undefined local_40 [2];
  byte local_3e;
  
  iVar9 = 0x3f;
  bVar8 = 0xff;
  local_48 = 0;
  iVar10 = 0x1f;
  local_47 = 0;
  iVar7 = 0;
  bVar6 = local_res20[0];
  do {
    iVar2 = (int)((uint)local_48 + iVar9) >> 1;
    FUN_18000d0e0(0xf,(byte)iVar2);
    pvVar4 = TlsGetValue(DAT_180055088);
    if (*(int *)((longlong)pvVar4 + 0x20) == 1) {
      uVar12 = (undefined3)(in_stack_ffffffffffffffb0 >> 8);
      uVar11 = (undefined)((ushort)in_stack_ffffffffffffffa8 >> 8);
      if (param_3 == '\x01') {
        in_stack_ffffffffffffffb0 = CONCAT31(uVar12,0x10);
        in_stack_ffffffffffffffa8 = CONCAT11(uVar11,8);
      }
      else {
        if (param_3 != '\0') goto LAB_1800089ad;
        in_stack_ffffffffffffffb0 = CONCAT31(uVar12,0x67);
        in_stack_ffffffffffffffa8 = CONCAT11(uVar11,0x34);
      }
      FUN_180008a40((byte *)0x0,(byte *)0x0,local_res20,(byte *)0x0,in_stack_ffffffffffffffa8,
                    in_stack_ffffffffffffffb0);
      bVar6 = local_res20[0];
    }
    else {
      local_43 = 0x15;
      if (param_3 != '\0') {
        local_43 = 0x57;
      }
      local_44 = 0;
      iVar3 = FUN_18000d080(0x2c,2,&local_44);
      if (((iVar3 != 0) || (uVar5 = FUN_18000d250(0x2d,0,0x80), (int)uVar5 != 0)) ||
         (iVar3 = FUN_18000cf90(0x67,3,local_40), iVar3 != 0)) {
        return 3;
      }
      local_res20[0] = local_3e;
      bVar6 = local_3e;
    }
LAB_1800089ad:
    bVar1 = (byte)((int)((uint)bVar6 - (uint)param_1) >> 0x1f);
    bVar1 = ((byte)((uint)bVar6 - (uint)param_1) ^ bVar1) - bVar1;
    if (bVar1 < bVar8) {
      bVar8 = bVar1;
      iVar10 = iVar2;
      local_47 = bVar6;
    }
    bVar1 = (byte)iVar2;
    if (param_1 < bVar6) {
      iVar9 = iVar2;
      bVar1 = local_48;
    }
    local_48 = bVar1;
    iVar7 = iVar7 + 1;
    if (5 < iVar7) {
      FUN_18000d0e0(0xf,(char)iVar10);
      if (param_2 != (byte *)0x0) {
        *param_2 = local_47;
      }
      return iVar10;
    }
  } while( true );
}



int FUN_180008a40(byte *param_1,byte *param_2,undefined *param_3,byte *param_4,undefined2 param_5,
                 uint param_6)

{
  byte bVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  longlong *plVar5;
  undefined8 uVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  byte bVar12;
  int iVar13;
  int iVar14;
  byte *pbVar15;
  int iVar16;
  int iVar17;
  byte local_68;
  int local_64;
  byte *local_58;
  
  iVar17 = 0;
  local_68 = 0xff;
  local_64 = 0;
  plVar5 = (longlong *)TlsGetValue(DAT_180055088);
  uVar3 = param_6;
  lVar2 = *plVar5;
  iVar4 = 1;
  uVar10 = (uint)(byte)param_5;
  uVar11 = param_6 & 0xff;
  iVar13 = (param_6 & 0xff) * uVar10;
  iVar14 = 0;
  iVar8 = 0;
  param_6 = 1;
  if (((byte)param_5 < 0x34) || ((byte)param_6 < 0x67)) {
    iVar14 = 0xb;
    iVar8 = 6;
  }
  local_58 = param_4;
  if (param_4 == (byte *)0x0) {
    local_58 = (byte *)malloc((longlong)iVar13);
    bVar12 = 0;
    param_5 = 0x5000;
    local_64 = FUN_18000d080(0x2c,2,&param_5);
    if (local_64 == 0) {
      do {
        bVar12 = bVar12 + 1;
        uVar6 = FUN_18000d250(0,1,1);
        if ((int)uVar6 == 0) {
          local_64 = FUN_18000cf00((longlong)local_58,uVar10,uVar3 & 0xff,0,1);
          if ((local_64 == 0) && (local_64 = FUN_18000d0e0(0x2d,0x20), local_64 == 0)) {
            if (((byte)param_5 < 0x34) || ((byte)param_6 < 0x67)) {
              pcVar7 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
              if (pcVar7 != (char *)0x0) {
                strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
              }
              FUN_180004810();
              iVar14 = 6;
              iVar8 = 5;
              iVar4 = 6;
              param_6 = 6;
            }
            else {
              pcVar7 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
              if (pcVar7 != (char *)0x0) {
                strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
              }
              FUN_180004810();
              iVar14 = 0;
              iVar8 = iVar17;
            }
            goto LAB_180008cbf;
          }
          break;
        }
        pcVar7 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar7 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
      } while (bVar12 < 5);
    }
  }
  else {
LAB_180008cbf:
    iVar14 = iVar8 * 0x67 + iVar14;
    iVar16 = 0;
    iVar8 = ((uVar3 & 0xff) - 1) * iVar4 + iVar14;
    bVar12 = 0;
    pbVar15 = local_58;
    do {
      if (*(char *)((longlong)iVar14 + 0x14fb + lVar2) == '\x01') {
        iVar16 = iVar16 + 1;
        *pbVar15 = *(char *)(lVar2 + 0x14fa) + 1;
      }
      else {
        bVar1 = *pbVar15;
        if (bVar1 < local_68) {
          local_68 = bVar1;
        }
        if (bVar12 < bVar1) {
          bVar12 = bVar1;
        }
        iVar17 = iVar17 + (uint)bVar1;
      }
      iVar9 = iVar14 - iVar8;
      if (iVar9 == (iVar9 / 0x67) * 0x67) {
        iVar14 = iVar14 + param_6 * 0x67 + (1 - uVar11) * iVar4;
      }
      else {
        iVar14 = iVar14 + iVar4;
      }
      pbVar15 = pbVar15 + 1;
    } while (iVar14 <= (int)((uVar10 - 1) * param_6 * 0x67 + iVar8));
    if (param_1 != (byte *)0x0) {
      *param_1 = local_68;
    }
    if (param_2 != (byte *)0x0) {
      *param_2 = bVar12;
    }
    if (param_3 != (undefined *)0x0) {
      *param_3 = (char)(iVar17 / (iVar13 - iVar16));
    }
    pcVar7 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar7 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
    if (param_4 != (byte *)0x0) {
      return local_64;
    }
  }
  if (local_58 != (byte *)0x0) {
    free(local_58);
  }
  return local_64;
}



undefined8 FUN_180008e80(void)

{
  char *pcVar1;
  longlong lVar2;
  byte bVar3;
  int iVar4;
  longlong *plVar5;
  char *pcVar6;
  undefined7 extraout_var;
  LPVOID pvVar7;
  undefined8 uVar8;
  byte local_res8 [8];
  undefined2 local_res10 [4];
  undefined local_res18 [2];
  byte local_res1a;
  undefined4 uVar9;
  
  plVar5 = (longlong *)TlsGetValue(DAT_180055088);
  lVar2 = *plVar5;
  pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar6 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  pcVar6 = "++++ calibrate_detect_mode ++++";
  uVar9 = 0x438;
  FUN_180004810();
  bVar3 = FUN_1800092c0(lVar2 + 6);
  if ((int)CONCAT71(extraout_var,bVar3) != 0) {
    return 3;
  }
  *(undefined *)(lVar2 + 5) = 10;
  FUN_18000d0e0(0x12,10);
  do {
    FUN_18000d0e0(0xf,*(undefined *)(lVar2 + 8));
    pvVar7 = TlsGetValue(DAT_180055088);
    if (*(int *)((longlong)pvVar7 + 0x20) == 1) {
      pcVar6 = (char *)CONCAT71((int7)((ulonglong)pcVar6 >> 8),0x10);
      uVar9 = CONCAT31((int3)((uint)uVar9 >> 8),8);
      FUN_180008a40((byte *)0x0,(byte *)0x0,local_res8,(byte *)0x0,(short)uVar9,(uint)pcVar6);
    }
    else {
      local_res10[0] = 0x5700;
      iVar4 = FUN_18000d080(0x2c,2,local_res10);
      if (((iVar4 != 0) || (uVar8 = FUN_18000d250(0x2d,0,0x80), (int)uVar8 != 0)) ||
         (iVar4 = FUN_18000cf90(0x67,3,local_res18), iVar4 != 0)) {
        return 3;
      }
      local_res8[0] = local_res1a;
    }
    if (local_res8[0] < 0x80) break;
    pcVar1 = (char *)(lVar2 + 8);
    *pcVar1 = *pcVar1 + -1;
  } while (*pcVar1 != '\0');
  *(byte *)(lVar2 + 0xb) = DAT_1800537b0 + local_res8[0];
  pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar6 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  *(undefined2 *)(lVar2 + 0xc) = 0xff00;
  return 0;
}



int FUN_180009060(int param_1)

{
  int iVar1;
  LPVOID pvVar2;
  char *pcVar3;
  
  iVar1 = FUN_180009190();
  if (iVar1 == 0) {
    pvVar2 = TlsGetValue(DAT_180055088);
    *(undefined4 *)((longlong)pvVar2 + 0x10) = 0;
    return 0;
  }
  pvVar2 = TlsGetValue(DAT_180055088);
  if (0x31 < *(int *)((longlong)pvVar2 + 0x10)) {
    pvVar2 = TlsGetValue(DAT_180055088);
    *(undefined4 *)((longlong)pvVar2 + 0x10) = 0;
    return 0x18;
  }
  if (iVar1 != 3) {
    return iVar1;
  }
  pvVar2 = TlsGetValue(DAT_180055088);
  *(int *)((longlong)pvVar2 + 0x10) = *(int *)((longlong)pvVar2 + 0x10) + 1;
  pvVar2 = TlsGetValue(DAT_180055088);
  if (*(int *)((longlong)pvVar2 + 0x18) == 1) {
    FUN_18000d040();
    iVar1 = FUN_18000ae00(param_1);
    return iVar1;
  }
  pvVar2 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar2 + 0x18) = 1;
  pcVar3 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar3 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  return 3;
}


// Sends first poll sequence (0xaa in middle)
undefined4 FUN_180009190(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined8 uVar3;
  char *pcVar4;
  int iVar5;
  byte local_res8 [8];
  
  iVar5 = 0;
  local_res8[0] = 0;
  uVar3 = FUN_18000d250(0,0xaa,0xfe);
  iVar1 = (int)uVar3;
  while (iVar1 != 0) {
    pcVar4 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar4 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
    if (1 < iVar5) goto LAB_1800092a5;
    iVar5 = iVar5 + 1;  // Adds retry counter?
    uVar3 = FUN_18000d250(0,0xaa,0xfe);
    iVar1 = (int)uVar3;
  }
  uVar2 = FUN_18000cff0(1,local_res8);
  if ((local_res8[0] & 3) != 0) {
    pcVar4 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar4 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
LAB_1800092a5:
    uVar2 = 3;
  }
  return uVar2;
}



byte FUN_1800092c0(undefined8 param_1)

{
  int iVar1;
  undefined2 local_res10;
  undefined local_res12;
  
  local_res10 = 1;
  local_res12 = 0x72;
  iVar1 = FUN_18000d080(0x11,3,&local_res10);
  if (iVar1 == 0) {
    local_res10 = 0x107;
    iVar1 = FUN_18000d080(0x34,2,&local_res10);
    if (iVar1 == 0) {
      FUN_18000d250(0x35,0,0x80);
      iVar1 = FUN_18000cf90(0xd,3,param_1);
      return -(iVar1 != 0) & 3;
    }
  }
  return 3;
}



void FUN_180009330(longlong param_1,int *param_2)

{
  byte bVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  byte *_Memory;
  char *pcVar6;
  ulonglong uVar7;
  undefined (*pauVar8) [16];
  LPVOID pvVar9;
  uint uVar10;
  byte *pbVar11;
  int iVar12;
  int iVar13;
  uint uVar14;
  longlong lVar15;
  undefined (*pauVar16) [16];
  uint uVar17;
  longlong lVar18;
  uint uVar19;
  int local_res8;
  
  _Memory = (byte *)malloc(0x3ec4);
  pauVar8 = (undefined (*) [16])(param_1 + 0x14fb);
  lVar15 = 0x14ec;
  iVar12 = 0;
  local_res8 = 0;
  FUN_1800244a0(pauVar8,0,0x14ec);
  FUN_18000d0e0(0x2c,0);
  pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar6 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  iVar13 = 0;
  pbVar11 = _Memory;
  do {
    iVar3 = FUN_18000d0e0(0x2d,0x13);
    if (iVar3 != 0) goto LAB_180009997;
    FUN_18000d250(0,1,1);
    FUN_18000cf00((longlong)pbVar11,0x34,0x67,0,1);
    FUN_18000d0e0(0x2d,0x20);
    uVar7 = FUN_180005550(pbVar11,0x67,0x34,0x67,0);
    lVar18 = 0x14ec;
    pauVar16 = pauVar8;
    do {
      uVar4 = ((uint)uVar7 & 0xff) -
              (uint)pbVar11[(longlong)*(undefined (*) [16])((longlong)pauVar16 - (longlong)pauVar8)]
      ;
      uVar10 = (int)uVar4 >> 0x1f;
      if (0x20 < (int)((uVar4 ^ uVar10) - uVar10)) {
        (*pauVar16)[0] = 1;
      }
      pauVar16 = (undefined (*) [16])(*pauVar16 + 1);
      lVar18 = lVar18 + -1;
    } while (lVar18 != 0);
    iVar13 = iVar13 + 1;
    pbVar11 = pbVar11 + 0x14ec;
  } while (iVar13 < 3);
  bVar2 = false;
  do {
    if ((*pauVar8)[0] == '\x01') {
      bVar2 = true;
LAB_1800094ac:
      iVar12 = iVar12 + 1;
    }
    else {
      if (bVar2) {
        bVar2 = false;
        (*pauVar8)[0] = 1;
        goto LAB_1800094ac;
      }
    }
    pauVar8 = (undefined (*) [16])(*pauVar8 + 1);
    lVar15 = lVar15 + -1;
  } while (lVar15 != 0);
  if (param_2 != (int *)0x0) {
    *param_2 = iVar12;
  }
  if (*(char *)(param_1 + 0x1f3d) == '\x01') {
    pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar6 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
  }
  else {
    pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (iVar12 < 0xa77) {
      if (pcVar6 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180004810();
      FUN_18000cf90(0x26,6,(byte *)(param_1 + 0x29ec));
      if ((*(byte *)(param_1 + 0x29ee) == 0) || (*(char *)(param_1 + 0x29f1) == '\0')) {
        pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar6 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
        pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar6 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
      }
      else {
        bVar1 = *(byte *)(param_1 + 0x29ec);
        uVar4 = (uint)bVar1;
        uVar10 = (uint)*(byte *)(param_1 + 0x29ed);
        do {
          if (0x66 < (int)uVar10) break;
          iVar12 = 0;
          uVar14 = (uint)*(byte *)(param_1 + 0x29ef);
          uVar19 = (uint)*(byte *)(param_1 + 0x29f0);
LAB_180009660:
          if ((int)uVar19 < 0x34) {
            lVar15 = param_1 + 0x14fb;
            uVar5 = uVar14;
            for (uVar17 = uVar14; lVar15 = lVar15 + (int)(uVar5 * 0x67), uVar5 = uVar4,
                (int)uVar17 <= (int)uVar19; uVar17 = uVar17 + uVar5) {
              for (; (int)uVar5 <= (int)uVar10; uVar5 = uVar5 + *(byte *)(param_1 + 0x29ee)) {
                if (*(char *)((int)uVar5 + lVar15) == '\x01') {
                  if (iVar12 == 0) {
                    iVar12 = 1;
                  }
                  else {
                    if (iVar12 < 1) {
                      iVar12 = 1 - iVar12;
                    }
                    else {
                      iVar12 = -iVar12;
                    }
                  }
                  uVar14 = (uint)*(byte *)(param_1 + 0x29ef) + iVar12;
                  uVar19 = (uint)*(byte *)(param_1 + 0x29f0) + iVar12;
                  if ((int)uVar14 < 0) goto LAB_1800096de;
                  goto LAB_180009660;
                }
              }
              uVar5 = (uint)*(byte *)(param_1 + 0x29f1);
            }
            *(char *)(param_1 + 0x29ef) = (char)uVar14;
            *(char *)(param_1 + 0x29f0) = (char)uVar19;
            *(char *)(param_1 + 0x29ec) = (char)uVar4;
            *(char *)(param_1 + 0x29ed) = (char)uVar10;
            goto LAB_180009997;
          }
LAB_1800096de:
          if (local_res8 == 0) {
            local_res8 = 1;
          }
          else {
            if (local_res8 < 1) {
              local_res8 = 1 - local_res8;
            }
            else {
              local_res8 = -local_res8;
            }
          }
          uVar4 = local_res8 + (uint)bVar1;
          uVar10 = (uint)*(byte *)(param_1 + 0x29ed) + local_res8;
        } while (-1 < (int)uVar4);
        pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar6 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
        pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar6 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
        pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar6 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
        pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar6 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        FUN_180004810();
      }
      pvVar9 = TlsGetValue(DAT_180055088);
      *(undefined4 *)((longlong)pvVar9 + 0x20) = 1;
    }
    else {
      if (pcVar6 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180004810();
    }
  }
LAB_180009997:
  free(_Memory);
  pvVar9 = TlsGetValue(DAT_180055088);
  if (*(int *)((longlong)pvVar9 + 0x20) == 1) {
    pcVar6 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar6 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
    *(undefined4 *)(param_1 + 0x29ec) = 0x5066006;
    *(undefined2 *)(param_1 + 0x29f0) = 0x62f;
  }
  FUN_18000d080(0x26,6,param_1 + 0x29ec);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180009a70)
// WARNING: Removing unreachable block (ram,0x000180009a8f)
// WARNING: Removing unreachable block (ram,0x000180009a9f)
// WARNING: Removing unreachable block (ram,0x000180009aa6)
// WARNING: Removing unreachable block (ram,0x000180009aaa)
// WARNING: Removing unreachable block (ram,0x000180009ab9)

undefined8 FUN_180009a40(void)

{
  longlong lVar1;
  longlong *plVar2;
  
  plVar2 = (longlong *)TlsGetValue(DAT_180055088);
  lVar1 = *plVar2;
  *(char *)(lVar1 + 1) = (char)DAT_1800537ac;
  *(undefined2 *)(lVar1 + 2) = 0x80f;
  *(undefined *)(lVar1 + 4) = 0x20;
  return 0;
}



void FUN_180009af0(void)

{
  int iVar1;
  LPVOID pvVar2;
  
  iVar1 = FUN_180009190();
  if (iVar1 == 3) {
    FUN_18000d040();
    pvVar2 = TlsGetValue(DAT_180055088);
    FUN_18000ae00(*(int *)((longlong)pvVar2 + 8));
    return;
  }
  return;
}



void FUN_180009b20(byte *param_1,uint param_2,uint param_3,longlong param_4,uint param_5)

{
  byte bVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  char *pcVar4;
  ulonglong uVar5;
  uint uVar6;
  int iVar7;
  undefined4 in_stack_ffffffffffffff38;
  undefined8 in_stack_ffffffffffffff40;
  char *local_b8;
  byte local_a8;
  byte local_a7;
  byte local_a6 [2];
  undefined2 local_a4 [2];
  byte local_a0;
  byte local_9f;
  uint local_9c;
  int local_98 [4];
  undefined4 local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined8 local_78;
  undefined8 uStack112;
  undefined8 local_68;
  undefined8 uStack96;
  ulonglong local_58;
  
  local_58 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff18;
  local_98[0] = 0x800;
  local_98[1] = 0x395c;
  local_98[2] = 0x42e1;
  local_98[3] = 0x4c66;
  local_88 = 0x508f;
  uStack132 = 0x5f33;
  uStack128 = 0x68cd;
  uStack124 = 0x7266;
  local_78 = 0x859a00007c00;
  uStack112 = 0x980000008e66;
  local_68 = 0xab330000a19a;
  uStack96 = 0xbe660000b4cd;
  local_9c = param_3;
  pvVar2 = TlsGetValue(DAT_180055088);
  if (*(int *)((longlong)pvVar2 + 0x20) == 1) {
    FUN_180008a40(local_a6,&local_a7,(undefined *)0x0,(byte *)0x0,
                  (short)CONCAT31((int3)((uint)in_stack_ffffffffffffff38 >> 8),8),
                  (uint)CONCAT71((int7)((ulonglong)in_stack_ffffffffffffff40 >> 8),0x10));
  }
  else {
    local_a4[0] = 0x5700;
    iVar7 = FUN_18000d080(0x2c,2,local_a4);
    if (((iVar7 == 0) && (uVar3 = FUN_18000d250(0x2d,0,0x80), (int)uVar3 == 0)) &&
       (iVar7 = FUN_18000cf90(0x67,3,&local_a0), iVar7 == 0)) goto LAB_180009bd0;
  }
  local_a0 = local_a6[0];
  local_9f = local_a7;
LAB_180009bd0:
  if ((local_a0 == 0) && (local_9f == 0xff)) {
    FUN_18000cff0(0x12,&local_a8);
    if (1 < local_a8) {
      FUN_18000d0e0(0x12,local_a8 - 1);
    }
  }
  else {
    if (*(char *)(param_4 + 0xd) == -1) {
      FUN_18000cff0(0xf,param_4 + 0xd);
    }
    if (local_9f == 0xff) {
      pcVar4 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pcVar4 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      local_b8 = "et5xx_fetch_dynamic_intensity";
      FUN_180004810();
      uVar5 = (ulonglong)local_a0 << 10;
      FUN_18000cff0(0x12,&local_a8);
      uVar6 = (uint)*(byte *)(param_4 + 0xd);
      do {
        if ((int)uVar5 < local_98[local_a8]) break;
        uVar5 = (ulonglong)(uint)((int)uVar5 - local_98[local_a8]);
        uVar6 = uVar6 - 1;
      } while (-1 < (int)uVar6);
      if (uVar6 != *(byte *)(param_4 + 0xd)) {
        FUN_18000d0e0(0xf,(char)uVar6);
        *(char *)(param_4 + 0xd) = (char)uVar6;
      }
    }
    else {
      if (local_a0 == 0) {
        pcVar4 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        if (pcVar4 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
        }
        local_b8 = "et5xx_fetch_dynamic_intensity";
        FUN_180004810();
        iVar7 = (0xff - (uint)local_9f) * 0x400;
        FUN_18000cff0(0x12,&local_a8);
        bVar1 = *(byte *)(param_4 + 0xd);
        uVar6 = (uint)bVar1;
        if (bVar1 < 0x40) {
          do {
            if (iVar7 < local_98[local_a8]) break;
            uVar6 = uVar6 + 1;
            iVar7 = iVar7 - local_98[local_a8];
          } while ((int)uVar6 < 0x40);
        }
        if (uVar6 != bVar1) {
          FUN_18000d0e0(0xf,(char)uVar6);
          *(char *)(param_4 + 0xd) = (char)uVar6;
        }
      }
    }
  }
  FUN_180009e30(param_1,param_2,local_9c,param_4,param_5);
  FUN_180023ef0(local_58 ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



int FUN_180009e30(byte *param_1,uint param_2,uint param_3,undefined8 param_4,uint param_5)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte local_res10 [8];
  uint uVar4;
  uint in_stack_ffffffffffffffe0;
  
  uVar1 = param_5;
  uVar3 = (ulonglong)param_5;
  local_res10[0] = 0;
  param_5._0_2_ = CONCAT11(0x13,(char)param_5 + -1);
  param_5 = param_5 & 0xffff0000 | (uint)(ushort)param_5;
  iVar2 = FUN_18000d080(0x2c,2,&param_5);
  if (iVar2 == 0) {
    FUN_18000d250(0,1,1);
    uVar4 = uVar1;
    iVar2 = FUN_18000cf00((longlong)param_1,param_3,param_2,0,uVar1);
    if (uVar1 != 0) {
      do {
        in_stack_ffffffffffffffe0 = in_stack_ffffffffffffffe0 & 0xffffff00 | param_2 & 0xff;
        uVar4 = uVar4 & 0xffffff00 | param_3 & 0xff;
        FUN_180008a40(local_res10,(byte *)0x0,(undefined *)0x0,param_1,(short)uVar4,
                      in_stack_ffffffffffffffe0);
        FUN_18000ad50((longlong)param_1,local_res10[0],param_3 & 0xff,(byte)param_2);
        param_1 = param_1 + (int)(param_2 * param_3);
        uVar3 = uVar3 - 1;
      } while (uVar3 != 0);
    }
    if (iVar2 == 0) {
      iVar2 = FUN_18000d0e0(0x2d,0x20);
    }
  }
  else {
    iVar2 = 3;
  }
  return iVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180009f20(undefined8 param_1,int param_2,int param_3)

{
  if (_DAT_180055080 == 1) {
    FUN_18000d0e0(9,3);
  }
  FUN_18000d0e0(10,0xf4);
  FUN_18000d0e0(0xc,0x44);
  FUN_18000d0e0(0x50,1);
  FUN_18000d250(0x50,0x80,0x80);
  FUN_18000d190(param_1,param_3,param_2);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180009f90(undefined *param_1,int param_2)

{
  int iVar1;
  LPVOID pvVar2;
  undefined8 uVar3;
  undefined2 in_stack_ffffffffffffffc8;
  undefined uVar4;
  undefined4 in_stack_ffffffffffffffd0;
  undefined2 local_28 [2];
  undefined local_24 [2];
  undefined local_22;
  undefined local_20;
  undefined uStack31;
  undefined uStack30;
  undefined2 uStack29;
  undefined4 local_1b;
  undefined2 local_17;
  ulonglong local_10;
  
  uVar4 = (undefined)((ushort)in_stack_ffffffffffffffc8 >> 8);
  local_10 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffffa8;
  local_20 = 0x83;
  if (_DAT_180055080 != 0) {
    local_20 = 3;
  }
  uStack31 = 0x24;
  uStack30 = 0;
  uStack29 = 0xf44;
  local_1b = 0x202008;
  local_17 = 0x5200;
  FUN_18000d080(9,0xb,&local_20);
  if (param_2 != 0) {
    local_20 = 1;
    uStack31 = 0x33;
    uStack30 = 0x19;
    FUN_18000d080(0x54,3,&local_20);
  }
  pvVar2 = TlsGetValue(DAT_180055088);
  if (*(int *)((longlong)pvVar2 + 0x20) == 1) {
    FUN_180008a40((byte *)0x0,(byte *)0x0,param_1,(byte *)0x0,CONCAT11(uVar4,0x34),
                  CONCAT31((int3)((uint)in_stack_ffffffffffffffd0 >> 8),0x67));
  }
  else {
    local_28[0] = 0x1500;
    iVar1 = FUN_18000d080(0x2c,2,local_28);
    if ((((iVar1 == 0) && (uVar3 = FUN_18000d250(0x2d,0,0x80), (int)uVar3 == 0)) &&
        (iVar1 = FUN_18000cf90(0x67,3,local_24), iVar1 == 0)) && (param_1 != (undefined *)0x0)) {
      *param_1 = local_22;
    }
  }
  if (param_2 != 0) {
    FUN_18000d0e0(0x54,0);
  }
  FUN_180023ef0(local_10 ^ (ulonglong)&stack0xffffffffffffffa8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_18000a0c0(void)

{
  longlong lVar1;
  int iVar2;
  undefined4 uVar3;
  longlong *plVar4;
  char *pcVar5;
  undefined8 uVar6;
  undefined uVar7;
  undefined2 local_res8 [4];
  
  plVar4 = (longlong *)TlsGetValue(DAT_180055088);
  lVar1 = *plVar4;
  pcVar5 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar5 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  FUN_18000d0e0(10,0xfd);
  FUN_18000d0e0(0x35,2);
  FUN_18000d0e0(0x80,0);
  uVar6 = FUN_18000d250(0x80,0,0xc0);
  if ((int)uVar6 != 0) {
    pcVar5 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar5 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
  }
  FUN_18000d0e0(10,0xfc);
  local_res8[0] = 0x30f;
  iVar2 = FUN_18000d080(1,2,local_res8);
  if (iVar2 == 0) {
    FUN_18000d0e0(0xc,0x22);
    uVar7 = 0x83;
    if (_DAT_180055080 != 0) {
      uVar7 = 0x43;
    }
    FUN_18000d0e0(9,uVar7);
    uVar3 = FUN_18000d080(0x26,6,lVar1 + 0x29ec);
    return uVar3;
  }
  return 3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000a240(undefined8 param_1,int param_2,int param_3)

{
  if (_DAT_180055080 == 1) {
    FUN_18000d0e0(9,3);
  }
  FUN_18000d0e0(10,0xf4);
  FUN_18000d0e0(0xc,0x44);
  FUN_18000d0e0(0x50,3);
  FUN_18000d250(0x50,0x80,0x80);
  FUN_18000d1f0(param_1,param_3,param_2);
  return;
}



void FUN_18000a2b0(byte *param_1,uint param_2,uint param_3,uint param_4)

{
  int iVar1;
  LPVOID pvVar2;
  longlong *plVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = FUN_180009060(*(int *)((longlong)pvVar2 + 8));
  if (iVar1 == 0) {
    plVar3 = (longlong *)TlsGetValue(DAT_180055088);
    FUN_180009b20(param_1,param_3,param_2,*plVar3,param_4);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000a320(void)

{
  int iVar1;
  char *pcVar2;
  LPVOID pvVar3;
  undefined8 uVar4;
  byte bVar5;
  undefined4 uVar6;
  char *local_58;
  byte local_48;
  byte local_47 [3];
  undefined2 local_44 [2];
  undefined local_40 [2];
  byte local_3e;
  undefined local_38;
  undefined4 local_37;
  undefined4 local_33;
  undefined2 local_2f;
  byte local_28;
  undefined2 local_27;
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff78;
  bVar5 = 0;
  local_48 = 0;
  pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar2 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  local_58 = "fp_tz_secure_pre_calibrate";
  pcVar2 = "%s";
  uVar6 = 0x2ad;
  FUN_180004810();
  pvVar3 = TlsGetValue(DAT_180055088);
  iVar1 = FUN_180009060(*(int *)((longlong)pvVar3 + 8));
  if (iVar1 == 0) {
    FUN_18000cff0(0x40,local_47);
    if ((local_47[0] & 0x81) == 0x81) {
      pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pcVar2 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      pcVar2 = "pre_calibration, exit detect_mode first";
      uVar6 = 0x2b6;
      FUN_180004810();
      iVar1 = FUN_18000a910();
      if (iVar1 != 0) goto LAB_18000a575;
    }
    local_38 = 0x83;
    if (_DAT_180055080 != 0) {
      local_38 = 3;
    }
    local_37 = 0xf440024;
    local_33 = 0x202008;
    local_2f = 0x5200;
    FUN_18000d080(9,0xb,&local_38);
    pvVar3 = TlsGetValue(DAT_180055088);
    if (*(int *)((longlong)pvVar3 + 0x20) == 1) {
      FUN_180008a40((byte *)0x0,(byte *)0x0,&local_48,(byte *)0x0,
                    (short)CONCAT31((int3)((uint)uVar6 >> 8),0x34),
                    (uint)CONCAT71((int7)((ulonglong)pcVar2 >> 8),0x67));
      bVar5 = local_48;
    }
    else {
      local_44[0] = 0x1500;
      iVar1 = FUN_18000d080(0x2c,2,local_44);
      if ((iVar1 == 0) && (uVar4 = FUN_18000d250(0x2d,0,0x80), (int)uVar4 == 0)) {
        iVar1 = FUN_18000cf90(0x67,3,local_40);
        bVar5 = 0;
        if (iVar1 == 0) {
          bVar5 = local_3e;
        }
      }
    }
    pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar2 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    local_58 = (char *)((ulonglong)local_58 & 0xffffffff00000000 | (ulonglong)bVar5);
    FUN_180004810();
    local_27 = 0x110;
    local_28 = bVar5;
    iVar1 = FUN_18000d080(0x33,3,&local_28);
    if (iVar1 == 0) {
      FUN_18000d250(0x35,0,0x80);
    }
  }
LAB_18000a575:
  FUN_180023ef0(local_18 ^ (ulonglong)&stack0xffffffffffffff78);
  return;
}



undefined8 FUN_18000a5a0(void)

{
  char *pcVar1;
  undefined8 uVar2;
  byte local_res8 [8];
  
  FUN_18001cbe0();
  pcVar1 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar1 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  uVar2 = FUN_18000d250(0,0xaa,0xfe);
  if ((int)uVar2 == 0) {
    FUN_18000cff0(1,local_res8);
    if ((local_res8[0] & 3) != 0) {
      pcVar1 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      if (pcVar1 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
      }
      FUN_180004810();
      FUN_18000a0c0();
    }
    return 0;
  }
  return 3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000a6b0(void)

{
  longlong lVar1;
  int iVar2;
  longlong *plVar3;
  char *pcVar4;
  LPVOID pvVar5;
  undefined uVar6;
  undefined uVar7;
  undefined auStack104 [32];
  undefined4 local_48;
  char *local_40;
  char *local_38;
  byte local_28 [8];
  undefined local_20;
  undefined uStack31;
  undefined uStack30;
  undefined uStack29;
  undefined uStack28;
  undefined uStack27;
  undefined uStack26;
  undefined uStack25;
  undefined uStack24;
  undefined local_17;
  undefined local_16;
  ulonglong local_10;
  
  local_10 = DAT_1800537e8 ^ (ulonglong)auStack104;
  plVar3 = (longlong *)TlsGetValue(DAT_180055088);
  lVar1 = *plVar3;
  FUN_18000cff0(0x40,local_28);
  if ((local_28[0] & 0x81) == 0x81) {
    pcVar4 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar4 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    local_38 = "fp_tz_secure_set_detect_mode";
    local_40 = "%s, preivious detect_mode";
    local_48 = 0x2d8;
    FUN_180004810();
    iVar2 = FUN_18000a910();
    if (iVar2 != 0) goto LAB_18000a8dc;
  }
  pvVar5 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar5 + 8) = 1;
  FUN_18000d080(0x26,6,lVar1 + 0x29ec);
  pcVar4 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar4 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  local_38 = "fp_tz_secure_set_detect_mode";
  local_40 = "%s";
  local_48 = 0x2e5;
  FUN_180004810();
  local_20 = 0x83;
  if (_DAT_180055080 != 0) {
    local_20 = 3;
  }
  uStack31 = 0xf4;
  uStack30 = 3;
  uStack29 = 0x44;
  if (DAT_180055084 == 0) {
    uStack28 = *(undefined *)(lVar1 + 6);
    uStack27 = *(undefined *)(lVar1 + 7);
    uStack26 = *(undefined *)(lVar1 + 8);
    local_16 = 0x72;
  }
  else {
    uStack28 = 0xf;
    uStack27 = 8;
    uStack26 = 0x20;
    local_16 = 0x52;
  }
  uStack24 = 1;
  uStack25 = 0x20;
  local_17 = *(undefined *)(lVar1 + 5);
  FUN_18000d080(9,0xb,&local_20);
  local_20 = 0xc;
  uStack31 = 3;
  FUN_18000d080(1,2,&local_20);
  FUN_18000d0e0(0xc,0x22);
  FUN_18000d0e0(0xb,3);
  FUN_18000d0e0(10,0xfc);
  if (_DAT_180055080 == 1) {
    FUN_18000d0e0(9,0x43);
  }
  if (DAT_180055084 == 0) {
    local_20 = *(undefined *)(lVar1 + 0xc);
    uVar7 = 6;
    uVar6 = 0x45;
    uStack31 = *(undefined *)(lVar1 + 0xb);
    uStack30 = 0x87;
    uStack29 = 0x13;
    uStack28 = 0;
    uStack27 = 3;
  }
  else {
    local_20 = 6;
    uStack31 = 6;
    uStack30 = 0;
    uStack29 = 0;
    uStack28 = 0x87;
    uStack27 = 0x13;
    uStack26 = (undefined)DAT_180055084;
    uStack25 = 3;
    uVar7 = 8;
    uVar6 = 0x47;
  }
  FUN_18000d130(uVar6,uVar7,&local_20);
LAB_18000a8dc:
  FUN_180023ef0(local_10 ^ (ulonglong)auStack104);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 FUN_18000a910(void)

{
  undefined4 uVar1;
  char *pcVar2;
  undefined8 uVar3;
  undefined2 local_res8 [4];
  
  pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar2 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  if (_DAT_180055080 == 1) {
    FUN_18000d0e0(9,3);
  }
  FUN_18000d0e0(10,0xf4);
  FUN_18000d0e0(0xc,0x44);
  uVar1 = FUN_18000d0e0(0x40,0);
  uVar3 = FUN_18000d250(0x40,0,0x80);
  if ((int)uVar3 != 0) {
    pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar2 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
  }
  local_res8[0] = 0xc01;
  FUN_18000d130(2,2,local_res8);
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_18000aa40(void)

{
  int iVar1;
  char *pcVar2;
  LPVOID pvVar3;
  byte local_res8 [8];
  
  pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar2 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  FUN_18000cff0(0x40,local_res8);
  if ((local_res8[0] & 0x81) == 0x81) {
    pcVar2 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar2 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    FUN_180004810();
    iVar1 = FUN_18000a910();
    if (iVar1 != 0) {
      return iVar1;
    }
  }
  pvVar3 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar3 + 8) = 0;
  FUN_18000d0e0(0xc,0x22);
  FUN_18000d0e0(0xb,3);
  FUN_18000d0e0(10,0xfc);
  if (_DAT_180055080 == 1) {
    FUN_18000d0e0(9,0x43);
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18000ab70(void)

{
  longlong lVar1;
  int iVar2;
  char *pcVar3;
  LPVOID pvVar4;
  longlong *plVar5;
  undefined auStack104 [32];
  undefined4 local_48;
  char *local_40;
  char *local_38;
  byte local_28 [8];
  undefined local_20;
  undefined2 local_1f;
  undefined local_1d;
  undefined local_1c;
  undefined local_1b;
  undefined local_1a;
  undefined2 local_19;
  undefined local_17;
  undefined local_16;
  ulonglong local_10;
  
  local_10 = DAT_1800537e8 ^ (ulonglong)auStack104;
  pcVar3 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar3 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  local_38 = "fp_tz_secure_set_sensor_mode";
  local_40 = "%s";
  local_48 = 0x321;
  FUN_180004810();
  FUN_18000cff0(0x40,local_28);
  if ((local_28[0] & 0x81) == 0x81) {
    pcVar3 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    if (pcVar3 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
    }
    local_38 = "fp_tz_secure_set_sensor_mode";
    local_40 = "%s, preivious detect_mode";
    local_48 = 0x329;
    FUN_180004810();
    iVar2 = FUN_18000a910();
    if (iVar2 != 0) goto LAB_18000ad2e;
  }
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 8) = 2;
  plVar5 = (longlong *)TlsGetValue(DAT_180055088);
  lVar1 = *plVar5;
  local_1f = 0x24;
  local_1d = 0x44;
  local_20 = 0x83;
  if (_DAT_180055080 != 0) {
    local_20 = 3;
  }
  local_1c = *(undefined *)(lVar1 + 2);
  local_1b = *(undefined *)(lVar1 + 3);
  local_1a = *(undefined *)(lVar1 + 4);
  local_19 = 0x120;
  local_17 = *(undefined *)(lVar1 + 1);
  local_16 = 0x12;
  FUN_18000d080(9,0xb,&local_20);
  *(undefined *)(lVar1 + 0xd) = 0xff;
  FUN_18000d080(0x26,6,lVar1 + 0x29ec);
  FUN_18000d0e0(0x23,0);
  FUN_18000d0e0(0x24,0x33);
  FUN_18000d0e0(0x20,0);
  FUN_18000d0e0(0x21,0x66);
LAB_18000ad2e:
  FUN_180023ef0(local_10 ^ (ulonglong)auStack104);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018000ad8b)

void FUN_18000ad50(longlong param_1,char param_2,uint param_3,byte param_4)

{
  char *pcVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  char cVar5;
  char cVar6;
  char cVar7;
  char cVar8;
  char cVar9;
  char cVar10;
  char cVar11;
  char cVar12;
  char cVar13;
  char cVar14;
  char cVar15;
  char cVar16;
  char *pcVar17;
  int iVar18;
  int iVar19;
  longlong lVar20;
  uint uVar21;
  
  iVar18 = 0;
  uVar21 = (param_3 & 0xff) * (uint)param_4;
  iVar19 = iVar18;
  if ((uVar21 != 0) && (iVar19 = 0, 0x1f < uVar21)) {
    do {
      pcVar17 = (char *)(iVar18 + param_1);
      cVar2 = pcVar17[1];
      cVar3 = pcVar17[2];
      cVar4 = pcVar17[3];
      cVar5 = pcVar17[4];
      cVar6 = pcVar17[5];
      cVar7 = pcVar17[6];
      cVar8 = pcVar17[7];
      cVar9 = pcVar17[8];
      cVar10 = pcVar17[9];
      cVar11 = pcVar17[10];
      cVar12 = pcVar17[0xb];
      cVar13 = pcVar17[0xc];
      cVar14 = pcVar17[0xd];
      cVar15 = pcVar17[0xe];
      cVar16 = pcVar17[0xf];
      pcVar1 = (char *)(iVar18 + param_1);
      *pcVar1 = *pcVar17 - param_2;
      pcVar1[1] = cVar2 - param_2;
      pcVar1[2] = cVar3 - param_2;
      pcVar1[3] = cVar4 - param_2;
      pcVar1[4] = cVar5 - param_2;
      pcVar1[5] = cVar6 - param_2;
      pcVar1[6] = cVar7 - param_2;
      pcVar1[7] = cVar8 - param_2;
      pcVar1[8] = cVar9 - param_2;
      pcVar1[9] = cVar10 - param_2;
      pcVar1[10] = cVar11 - param_2;
      pcVar1[0xb] = cVar12 - param_2;
      pcVar1[0xc] = cVar13 - param_2;
      pcVar1[0xd] = cVar14 - param_2;
      pcVar1[0xe] = cVar15 - param_2;
      pcVar1[0xf] = cVar16 - param_2;
      iVar19 = iVar18 + 0x10;
      iVar18 = iVar18 + 0x20;
      pcVar17 = (char *)(iVar19 + param_1);
      cVar2 = pcVar17[1];
      cVar3 = pcVar17[2];
      cVar4 = pcVar17[3];
      cVar5 = pcVar17[4];
      cVar6 = pcVar17[5];
      cVar7 = pcVar17[6];
      cVar8 = pcVar17[7];
      cVar9 = pcVar17[8];
      cVar10 = pcVar17[9];
      cVar11 = pcVar17[10];
      cVar12 = pcVar17[0xb];
      cVar13 = pcVar17[0xc];
      cVar14 = pcVar17[0xd];
      cVar15 = pcVar17[0xe];
      cVar16 = pcVar17[0xf];
      pcVar1 = (char *)(iVar19 + param_1);
      *pcVar1 = *pcVar17 - param_2;
      pcVar1[1] = cVar2 - param_2;
      pcVar1[2] = cVar3 - param_2;
      pcVar1[3] = cVar4 - param_2;
      pcVar1[4] = cVar5 - param_2;
      pcVar1[5] = cVar6 - param_2;
      pcVar1[6] = cVar7 - param_2;
      pcVar1[7] = cVar8 - param_2;
      pcVar1[8] = cVar9 - param_2;
      pcVar1[9] = cVar10 - param_2;
      pcVar1[10] = cVar11 - param_2;
      pcVar1[0xb] = cVar12 - param_2;
      pcVar1[0xc] = cVar13 - param_2;
      pcVar1[0xd] = cVar14 - param_2;
      pcVar1[0xe] = cVar15 - param_2;
      pcVar1[0xf] = cVar16 - param_2;
      iVar19 = iVar18;
    } while (iVar18 < (int)(uVar21 - (uVar21 & 0x8000001f)));
  }
  lVar20 = (longlong)iVar19;
  if (lVar20 < (int)uVar21) {
    pcVar17 = (char *)(lVar20 + param_1);
    lVar20 = (int)uVar21 - lVar20;
    do {
      *pcVar17 = *pcVar17 - param_2;
      pcVar17 = pcVar17 + 1;
      lVar20 = lVar20 + -1;
    } while (lVar20 != 0);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_18000ae00(int param_1)

{
  longlong lVar1;
  int iVar2;
  char *pcVar3;
  longlong *plVar4;
  LPVOID pvVar5;
  
  pcVar3 = strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  if (pcVar3 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_common_5XX.c",0x2f);
  }
  FUN_180004810();
  FUN_18000a5a0();
  plVar4 = (longlong *)TlsGetValue(DAT_180055088);
  lVar1 = *plVar4;
  if (_DAT_180055080 == 1) {
    FUN_18000d0e0(9,3);
  }
  FUN_18000d0e0(10,0xf4);
  FUN_18000d0e0(0xc,0x44);
  FUN_18000d0e0(0x50,3);
  FUN_18000d250(0x50,0x80,0x80);
  FUN_18000d1f0(lVar1 + 0xe,0x34,0x67);
  if (param_1 == 2) {
    iVar2 = FUN_18000ab70();
  }
  else {
    if (param_1 == 1) {
      iVar2 = FUN_18000a6b0();
    }
    else {
      iVar2 = FUN_18000aa40();
    }
  }
  if (iVar2 == 0) {
    pvVar5 = TlsGetValue(DAT_180055088);
    *(undefined4 *)((longlong)pvVar5 + 0x18) = 0;
  }
  return iVar2;
}



ulonglong FUN_18000af10(int *param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  LPVOID pvVar4;
  char *pcVar5;
  ulonglong uVar6;
  int iVar7;
  int local_res10 [2];
  int local_res18 [2];
  int local_res20 [2];
  
  iVar7 = 0;
  local_res20[0] = 0;
  local_res18[0] = 0;
  local_res10[0] = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  uVar1 = FUN_180009060(*(int *)((longlong)pvVar4 + 8));
  if (uVar1 != 0) {
    pcVar5 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    if (pcVar5 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    }
    FUN_180004810();
    return (ulonglong)uVar1;
  }
  uVar6 = FUN_18000ab70();
  if ((int)uVar6 == 0) {
    do {
      pvVar4 = TlsGetValue(DAT_180055088);
      uVar6 = FUN_18000a2b0(*(byte **)((longlong)pvVar4 + 0x28),0x34,0x67,1);
      if ((int)uVar6 != 0) {
        return uVar6;
      }
      pvVar4 = TlsGetValue(DAT_180055088);
      FUN_18000c1f0(*(byte **)((longlong)pvVar4 + 0x28),0);
      pvVar4 = TlsGetValue(DAT_180055088);
      FUN_180008580(*(undefined8 **)((longlong)pvVar4 + 0x28),0x67,0x34,0);
      pvVar4 = TlsGetValue(DAT_180055088);
      iVar2 = FUN_18000c270(*(undefined4 **)((longlong)pvVar4 + 0x28),local_res20,local_res18);
      pvVar4 = TlsGetValue(DAT_180055088);
      iVar3 = FUN_180018850(*(undefined8 **)((longlong)pvVar4 + 0x28),0x67,0x34,local_res10);
      pcVar5 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      if (pcVar5 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      }
      FUN_180004810();
      pcVar5 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      if (pcVar5 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      }
      FUN_180004810();
      pcVar5 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      if (pcVar5 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      }
      TlsGetValue(DAT_180055088);
      FUN_180004810();
      if (iVar2 < *param_1) {
        *param_1 = iVar2;
      }
      pvVar4 = TlsGetValue(DAT_180055088);
      if (0 < *(int *)((longlong)pvVar4 + 0x58)) {
        pvVar4 = TlsGetValue(DAT_180055088);
        *(undefined4 *)((longlong)pvVar4 + 0x58) = 0;
      }
      if ((iVar3 < 3) && ((local_res10[0] < 0x1f || (local_res18[0] < 2)))) {
        *param_1 = iVar2;
        pvVar4 = TlsGetValue(DAT_180055088);
        *(undefined4 *)((longlong)pvVar4 + 0x58) = 0;
        pvVar4 = TlsGetValue(DAT_180055088);
        *(int *)((longlong)pvVar4 + 0x60) = local_res10[0];
        break;
      }
      if (iVar7 == 4) {
        return 0x11;
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 < 5);
    pcVar5 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    if (pcVar5 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    }
    FUN_180004810();
    uVar6 = 0;
  }
  return uVar6;
}



// WARNING: Removing unreachable block (ram,0x00018000b3d7)
// WARNING: Removing unreachable block (ram,0x00018000b3de)

undefined8
FUN_18000b2f0(undefined8 *param_1,uint param_2,int param_3,undefined8 param_4,int *param_5)

{
  char *pcVar1;
  byte bVar2;
  char cVar3;
  char cVar4;
  char cVar5;
  char cVar6;
  char cVar7;
  char cVar8;
  char cVar9;
  char cVar10;
  char cVar11;
  char cVar12;
  char cVar13;
  char cVar14;
  char cVar15;
  char cVar16;
  char cVar17;
  byte bVar18;
  uint uVar19;
  int iVar20;
  char *pcVar21;
  longlong *plVar22;
  int iVar23;
  undefined8 *puVar24;
  uint uVar25;
  byte *pbVar26;
  longlong lVar27;
  int local_res10 [2];
  int local_res18 [4];
  
  bVar18 = 0xff;
  uVar25 = param_2 * param_3;
  iVar20 = uVar25 - 1;
  if (-1 < iVar20) {
    pbVar26 = (byte *)((longlong)iVar20 + (longlong)param_1);
    lVar27 = (longlong)iVar20 + 1;
    do {
      bVar2 = *pbVar26;
      pbVar26 = pbVar26 + -1;
      if (bVar2 < bVar18) {
        bVar18 = bVar2;
      }
      lVar27 = lVar27 + -1;
    } while (lVar27 != 0);
  }
  iVar23 = 0;
  iVar20 = iVar23;
  if ((0 < (int)uVar25) && (iVar20 = 0, 0x1f < uVar25)) {
    uVar19 = uVar25 & 0x8000001f;
    if ((int)uVar19 < 0) {
      uVar19 = (uVar19 - 1 | 0xffffffe0) + 1;
    }
    do {
      pcVar21 = (char *)((longlong)iVar23 + (longlong)param_1);
      cVar3 = pcVar21[1];
      cVar4 = pcVar21[2];
      cVar5 = pcVar21[3];
      cVar6 = pcVar21[4];
      cVar7 = pcVar21[5];
      cVar8 = pcVar21[6];
      cVar9 = pcVar21[7];
      cVar10 = pcVar21[8];
      cVar11 = pcVar21[9];
      cVar12 = pcVar21[10];
      cVar13 = pcVar21[0xb];
      cVar14 = pcVar21[0xc];
      cVar15 = pcVar21[0xd];
      cVar16 = pcVar21[0xe];
      cVar17 = pcVar21[0xf];
      pcVar1 = (char *)((longlong)iVar23 + (longlong)param_1);
      *pcVar1 = *pcVar21 - bVar18;
      pcVar1[1] = cVar3 - bVar18;
      pcVar1[2] = cVar4 - bVar18;
      pcVar1[3] = cVar5 - bVar18;
      pcVar1[4] = cVar6 - bVar18;
      pcVar1[5] = cVar7 - bVar18;
      pcVar1[6] = cVar8 - bVar18;
      pcVar1[7] = cVar9 - bVar18;
      pcVar1[8] = cVar10 - bVar18;
      pcVar1[9] = cVar11 - bVar18;
      pcVar1[10] = cVar12 - bVar18;
      pcVar1[0xb] = cVar13 - bVar18;
      pcVar1[0xc] = cVar14 - bVar18;
      pcVar1[0xd] = cVar15 - bVar18;
      pcVar1[0xe] = cVar16 - bVar18;
      pcVar1[0xf] = cVar17 - bVar18;
      iVar20 = iVar23 + 0x10;
      iVar23 = iVar23 + 0x20;
      pcVar21 = (char *)((longlong)iVar20 + (longlong)param_1);
      cVar3 = pcVar21[1];
      cVar4 = pcVar21[2];
      cVar5 = pcVar21[3];
      cVar6 = pcVar21[4];
      cVar7 = pcVar21[5];
      cVar8 = pcVar21[6];
      cVar9 = pcVar21[7];
      cVar10 = pcVar21[8];
      cVar11 = pcVar21[9];
      cVar12 = pcVar21[10];
      cVar13 = pcVar21[0xb];
      cVar14 = pcVar21[0xc];
      cVar15 = pcVar21[0xd];
      cVar16 = pcVar21[0xe];
      cVar17 = pcVar21[0xf];
      pcVar1 = (char *)((longlong)iVar20 + (longlong)param_1);
      *pcVar1 = *pcVar21 - bVar18;
      pcVar1[1] = cVar3 - bVar18;
      pcVar1[2] = cVar4 - bVar18;
      pcVar1[3] = cVar5 - bVar18;
      pcVar1[4] = cVar6 - bVar18;
      pcVar1[5] = cVar7 - bVar18;
      pcVar1[6] = cVar8 - bVar18;
      pcVar1[7] = cVar9 - bVar18;
      pcVar1[8] = cVar10 - bVar18;
      pcVar1[9] = cVar11 - bVar18;
      pcVar1[10] = cVar12 - bVar18;
      pcVar1[0xb] = cVar13 - bVar18;
      pcVar1[0xc] = cVar14 - bVar18;
      pcVar1[0xd] = cVar15 - bVar18;
      pcVar1[0xe] = cVar16 - bVar18;
      pcVar1[0xf] = cVar17 - bVar18;
      iVar20 = iVar23;
    } while (iVar23 < (int)(uVar25 - uVar19));
  }
  lVar27 = (longlong)iVar20;
  if (lVar27 < (int)uVar25) {
    pcVar21 = (char *)(lVar27 + (longlong)param_1);
    lVar27 = (int)uVar25 - lVar27;
    do {
      *pcVar21 = *pcVar21 - bVar18;
      pcVar21 = pcVar21 + 1;
      lVar27 = lVar27 + -1;
    } while (lVar27 != 0);
  }
  if (param_1 != (undefined8 *)0x0) {
    lVar27 = 0x14ec;
    puVar24 = param_1;
    do {
      *(char *)puVar24 = -1 - *(char *)puVar24;
      lVar27 = lVar27 + -1;
      puVar24 = (undefined8 *)((longlong)puVar24 + 1);
    } while (lVar27 != 0);
  }
  FUN_180008580(param_1,param_2,param_3,0);
  iVar20 = FUN_18000c270((undefined4 *)param_1,local_res18,local_res10);
  if (iVar20 < 0x3c) {
    *param_5 = iVar20;
    return 0xe;
  }
  FUN_180004fa0((byte *)param_1,param_2,param_3,0x8c);
  plVar22 = (longlong *)TlsGetValue(DAT_180055088);
  FUN_18000cdd0((longlong)param_1,param_2,param_3,(undefined4 *)(*plVar22 + 0x14fb));
  *param_5 = iVar20;
  return 0;
}



// WARNING: Removing unreachable block (ram,0x00018000b507)
// WARNING: Removing unreachable block (ram,0x00018000b50f)

undefined8 FUN_18000b4a0(undefined8 *param_1,uint *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int iVar5;
  uint uVar6;
  undefined8 uVar7;
  LPVOID pvVar8;
  char *pcVar9;
  undefined4 *puVar10;
  uint uVar11;
  undefined8 *puVar12;
  undefined8 *puVar13;
  longlong lVar14;
  int iVar15;
  longlong lVar16;
  int local_res10 [2];
  int local_res18 [2];
  
  iVar15 = 1;
  *param_2 = 0;
  local_res18[0] = 0;
  local_res10[0] = 0;
  uVar7 = FUN_18000a2b0((byte *)param_1,0x34,0x67,1);
  if ((int)uVar7 == 0) {
    lVar14 = 0x29;
    do {
      if (param_1 != (undefined8 *)0x0) {
        lVar16 = 0x14ec;
        puVar12 = param_1;
        do {
          *(char *)puVar12 = -1 - *(char *)puVar12;
          lVar16 = lVar16 + -1;
          puVar12 = (undefined8 *)((longlong)puVar12 + 1);
        } while (lVar16 != 0);
      }
      FUN_180008580(param_1,0x67,0x34,0);
      iVar5 = FUN_18000c270((undefined4 *)param_1,local_res18,local_res10);
      pvVar8 = TlsGetValue(DAT_180055088);
      if ((**(int **)((longlong)pvVar8 + 0x50) <= iVar5) &&
         (pvVar8 = TlsGetValue(DAT_180055088),
         *(int *)(*(longlong *)((longlong)pvVar8 + 0x50) + 4) <= local_res10[0])) {
        pvVar8 = TlsGetValue(DAT_180055088);
        **(int **)((longlong)pvVar8 + 0x50) = iVar5;
        pvVar8 = TlsGetValue(DAT_180055088);
        *(int *)(*(longlong *)((longlong)pvVar8 + 0x50) + 4) = local_res10[0];
        pvVar8 = TlsGetValue(DAT_180055088);
        lVar16 = lVar14;
        puVar4 = (undefined4 *)(*(longlong *)((longlong)pvVar8 + 0x50) + 0x10);
        puVar12 = param_1;
        do {
          puVar13 = puVar12;
          puVar10 = puVar4;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 4);
          uVar2 = *(undefined4 *)(puVar13 + 1);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0xc);
          *puVar10 = *(undefined4 *)puVar13;
          puVar10[1] = uVar1;
          puVar10[2] = uVar2;
          puVar10[3] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 0x14);
          uVar2 = *(undefined4 *)(puVar13 + 3);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x1c);
          puVar10[4] = *(undefined4 *)(puVar13 + 2);
          puVar10[5] = uVar1;
          puVar10[6] = uVar2;
          puVar10[7] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 0x24);
          uVar2 = *(undefined4 *)(puVar13 + 5);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x2c);
          puVar10[8] = *(undefined4 *)(puVar13 + 4);
          puVar10[9] = uVar1;
          puVar10[10] = uVar2;
          puVar10[0xb] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 0x34);
          uVar2 = *(undefined4 *)(puVar13 + 7);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x3c);
          puVar10[0xc] = *(undefined4 *)(puVar13 + 6);
          puVar10[0xd] = uVar1;
          puVar10[0xe] = uVar2;
          puVar10[0xf] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 0x44);
          uVar2 = *(undefined4 *)(puVar13 + 9);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x4c);
          puVar10[0x10] = *(undefined4 *)(puVar13 + 8);
          puVar10[0x11] = uVar1;
          puVar10[0x12] = uVar2;
          puVar10[0x13] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 0x54);
          uVar2 = *(undefined4 *)(puVar13 + 0xb);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x5c);
          puVar10[0x14] = *(undefined4 *)(puVar13 + 10);
          puVar10[0x15] = uVar1;
          puVar10[0x16] = uVar2;
          puVar10[0x17] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 100);
          uVar2 = *(undefined4 *)(puVar13 + 0xd);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x6c);
          puVar10[0x18] = *(undefined4 *)(puVar13 + 0xc);
          puVar10[0x19] = uVar1;
          puVar10[0x1a] = uVar2;
          puVar10[0x1b] = uVar3;
          uVar1 = *(undefined4 *)((longlong)puVar13 + 0x74);
          uVar2 = *(undefined4 *)(puVar13 + 0xf);
          uVar3 = *(undefined4 *)((longlong)puVar13 + 0x7c);
          puVar10[0x1c] = *(undefined4 *)(puVar13 + 0xe);
          puVar10[0x1d] = uVar1;
          puVar10[0x1e] = uVar2;
          puVar10[0x1f] = uVar3;
          lVar16 = lVar16 + -1;
          puVar4 = puVar10 + 0x20;
          puVar12 = puVar13 + 0x10;
        } while (lVar16 != 0);
        uVar1 = *(undefined4 *)((longlong)puVar13 + 0x84);
        uVar2 = *(undefined4 *)(puVar13 + 0x11);
        uVar3 = *(undefined4 *)((longlong)puVar13 + 0x8c);
        puVar10[0x20] = *(undefined4 *)(puVar13 + 0x10);
        puVar10[0x21] = uVar1;
        puVar10[0x22] = uVar2;
        puVar10[0x23] = uVar3;
        uVar1 = *(undefined4 *)((longlong)puVar13 + 0x94);
        uVar2 = *(undefined4 *)(puVar13 + 0x13);
        uVar3 = *(undefined4 *)((longlong)puVar13 + 0x9c);
        puVar10[0x24] = *(undefined4 *)(puVar13 + 0x12);
        puVar10[0x25] = uVar1;
        puVar10[0x26] = uVar2;
        puVar10[0x27] = uVar3;
        uVar1 = *(undefined4 *)((longlong)puVar13 + 0xa4);
        uVar2 = *(undefined4 *)(puVar13 + 0x15);
        uVar3 = *(undefined4 *)((longlong)puVar13 + 0xac);
        puVar10[0x28] = *(undefined4 *)(puVar13 + 0x14);
        puVar10[0x29] = uVar1;
        puVar10[0x2a] = uVar2;
        puVar10[0x2b] = uVar3;
        uVar1 = *(undefined4 *)((longlong)puVar13 + 0xb4);
        uVar2 = *(undefined4 *)(puVar13 + 0x17);
        uVar3 = *(undefined4 *)((longlong)puVar13 + 0xbc);
        puVar10[0x2c] = *(undefined4 *)(puVar13 + 0x16);
        puVar10[0x2d] = uVar1;
        puVar10[0x2e] = uVar2;
        puVar10[0x2f] = uVar3;
        uVar1 = *(undefined4 *)((longlong)puVar13 + 0xc4);
        uVar2 = *(undefined4 *)(puVar13 + 0x19);
        uVar3 = *(undefined4 *)((longlong)puVar13 + 0xcc);
        puVar10[0x30] = *(undefined4 *)(puVar13 + 0x18);
        puVar10[0x31] = uVar1;
        puVar10[0x32] = uVar2;
        puVar10[0x33] = uVar3;
        uVar1 = *(undefined4 *)((longlong)puVar13 + 0xd4);
        uVar2 = *(undefined4 *)(puVar13 + 0x1b);
        uVar3 = *(undefined4 *)((longlong)puVar13 + 0xdc);
        puVar10[0x34] = *(undefined4 *)(puVar13 + 0x1a);
        puVar10[0x35] = uVar1;
        puVar10[0x36] = uVar2;
        puVar10[0x37] = uVar3;
        *(undefined8 *)(puVar10 + 0x38) = puVar13[0x1c];
        puVar10[0x3a] = *(undefined4 *)(puVar13 + 0x1d);
      }
      if ((iVar5 < 0x3c) || (9 < iVar15)) {
LAB_18000b6e4:
        TlsGetValue(DAT_180055088);
        pvVar8 = TlsGetValue(DAT_180055088);
        local_res10[0] = *(int *)(*(longlong *)((longlong)pvVar8 + 0x50) + 4);
        pvVar8 = TlsGetValue(DAT_180055088);
        puVar4 = (undefined4 *)(*(longlong *)((longlong)pvVar8 + 0x50) + 0x10);
        do {
          puVar12 = param_1;
          puVar10 = puVar4;
          uVar1 = puVar10[1];
          uVar2 = puVar10[2];
          uVar3 = puVar10[3];
          *(undefined4 *)puVar12 = *puVar10;
          *(undefined4 *)((longlong)puVar12 + 4) = uVar1;
          *(undefined4 *)(puVar12 + 1) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0xc) = uVar3;
          uVar1 = puVar10[5];
          uVar2 = puVar10[6];
          uVar3 = puVar10[7];
          *(undefined4 *)(puVar12 + 2) = puVar10[4];
          *(undefined4 *)((longlong)puVar12 + 0x14) = uVar1;
          *(undefined4 *)(puVar12 + 3) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x1c) = uVar3;
          uVar1 = puVar10[9];
          uVar2 = puVar10[10];
          uVar3 = puVar10[0xb];
          *(undefined4 *)(puVar12 + 4) = puVar10[8];
          *(undefined4 *)((longlong)puVar12 + 0x24) = uVar1;
          *(undefined4 *)(puVar12 + 5) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x2c) = uVar3;
          uVar1 = puVar10[0xd];
          uVar2 = puVar10[0xe];
          uVar3 = puVar10[0xf];
          *(undefined4 *)(puVar12 + 6) = puVar10[0xc];
          *(undefined4 *)((longlong)puVar12 + 0x34) = uVar1;
          *(undefined4 *)(puVar12 + 7) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x3c) = uVar3;
          uVar1 = puVar10[0x11];
          uVar2 = puVar10[0x12];
          uVar3 = puVar10[0x13];
          *(undefined4 *)(puVar12 + 8) = puVar10[0x10];
          *(undefined4 *)((longlong)puVar12 + 0x44) = uVar1;
          *(undefined4 *)(puVar12 + 9) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x4c) = uVar3;
          uVar1 = puVar10[0x15];
          uVar2 = puVar10[0x16];
          uVar3 = puVar10[0x17];
          *(undefined4 *)(puVar12 + 10) = puVar10[0x14];
          *(undefined4 *)((longlong)puVar12 + 0x54) = uVar1;
          *(undefined4 *)(puVar12 + 0xb) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x5c) = uVar3;
          uVar1 = puVar10[0x19];
          uVar2 = puVar10[0x1a];
          uVar3 = puVar10[0x1b];
          *(undefined4 *)(puVar12 + 0xc) = puVar10[0x18];
          *(undefined4 *)((longlong)puVar12 + 100) = uVar1;
          *(undefined4 *)(puVar12 + 0xd) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x6c) = uVar3;
          uVar1 = puVar10[0x1d];
          uVar2 = puVar10[0x1e];
          uVar3 = puVar10[0x1f];
          *(undefined4 *)(puVar12 + 0xe) = puVar10[0x1c];
          *(undefined4 *)((longlong)puVar12 + 0x74) = uVar1;
          *(undefined4 *)(puVar12 + 0xf) = uVar2;
          *(undefined4 *)((longlong)puVar12 + 0x7c) = uVar3;
          lVar14 = lVar14 + -1;
          puVar4 = puVar10 + 0x20;
          param_1 = puVar12 + 0x10;
        } while (lVar14 != 0);
        uVar1 = puVar10[0x21];
        uVar2 = puVar10[0x22];
        uVar3 = puVar10[0x23];
        *(undefined4 *)(puVar12 + 0x10) = puVar10[0x20];
        *(undefined4 *)((longlong)puVar12 + 0x84) = uVar1;
        *(undefined4 *)(puVar12 + 0x11) = uVar2;
        *(undefined4 *)((longlong)puVar12 + 0x8c) = uVar3;
        uVar1 = puVar10[0x25];
        uVar2 = puVar10[0x26];
        uVar3 = puVar10[0x27];
        *(undefined4 *)(puVar12 + 0x12) = puVar10[0x24];
        *(undefined4 *)((longlong)puVar12 + 0x94) = uVar1;
        *(undefined4 *)(puVar12 + 0x13) = uVar2;
        *(undefined4 *)((longlong)puVar12 + 0x9c) = uVar3;
        uVar1 = puVar10[0x29];
        uVar2 = puVar10[0x2a];
        uVar3 = puVar10[0x2b];
        *(undefined4 *)(puVar12 + 0x14) = puVar10[0x28];
        *(undefined4 *)((longlong)puVar12 + 0xa4) = uVar1;
        *(undefined4 *)(puVar12 + 0x15) = uVar2;
        *(undefined4 *)((longlong)puVar12 + 0xac) = uVar3;
        uVar1 = puVar10[0x2d];
        uVar2 = puVar10[0x2e];
        uVar3 = puVar10[0x2f];
        *(undefined4 *)(puVar12 + 0x16) = puVar10[0x2c];
        *(undefined4 *)((longlong)puVar12 + 0xb4) = uVar1;
        *(undefined4 *)(puVar12 + 0x17) = uVar2;
        *(undefined4 *)((longlong)puVar12 + 0xbc) = uVar3;
        uVar1 = puVar10[0x31];
        uVar2 = puVar10[0x32];
        uVar3 = puVar10[0x33];
        *(undefined4 *)(puVar12 + 0x18) = puVar10[0x30];
        *(undefined4 *)((longlong)puVar12 + 0xc4) = uVar1;
        *(undefined4 *)(puVar12 + 0x19) = uVar2;
        *(undefined4 *)((longlong)puVar12 + 0xcc) = uVar3;
        uVar1 = puVar10[0x35];
        uVar2 = puVar10[0x36];
        uVar3 = puVar10[0x37];
        *(undefined4 *)(puVar12 + 0x1a) = puVar10[0x34];
        *(undefined4 *)((longlong)puVar12 + 0xd4) = uVar1;
        *(undefined4 *)(puVar12 + 0x1b) = uVar2;
        *(undefined4 *)((longlong)puVar12 + 0xdc) = uVar3;
        puVar12[0x1c] = *(undefined8 *)(puVar10 + 0x38);
        *(undefined4 *)(puVar12 + 0x1d) = puVar10[0x3a];
        pcVar9 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
        if (pcVar9 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180004810();
        if (local_res10[0] < 8) {
          if (local_res10[0] < 2) {
            *param_2 = *param_2 | 1;
          }
          else {
            *param_2 = *param_2 | 8;
          }
        }
        return 0;
      }
      if ((7 < local_res10[0]) &&
         ((pvVar8 = TlsGetValue(DAT_180055088), uVar6 = *(int *)((longlong)pvVar8 + 0x48) - iVar5,
          uVar11 = (int)uVar6 >> 0x1f, (int)((uVar6 ^ uVar11) - uVar11) < 9 && (1 < iVar15)))) {
        pvVar8 = TlsGetValue(DAT_180055088);
        *(int *)((longlong)pvVar8 + 0x48) = iVar5;
        goto LAB_18000b6e4;
      }
      pvVar8 = TlsGetValue(DAT_180055088);
      *(int *)((longlong)pvVar8 + 0x48) = iVar5;
      iVar15 = iVar15 + 1;
      uVar7 = FUN_18000a2b0((byte *)param_1,0x34,0x67,1);
    } while ((int)uVar7 == 0);
  }
  return uVar7;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Removing unreachable block (ram,0x00018000b9b7)
// WARNING: Removing unreachable block (ram,0x00018000b9be)
// WARNING: Could not reconcile some variable overlaps

void FUN_18000b850(void)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined8 *puVar5;
  int iVar6;
  undefined4 uVar7;
  int iVar8;
  LPVOID pvVar9;
  undefined4 *puVar10;
  char *pcVar11;
  LPVOID pvVar12;
  longlong lVar13;
  undefined4 *puVar14;
  undefined8 *puVar15;
  undefined4 *puVar16;
  longlong lVar17;
  int iVar18;
  undefined auStack5504 [32];
  undefined8 local_1560;
  char *local_1558;
  int local_1550;
  int local_1548;
  int local_1540;
  int local_1538;
  int local_1530;
  int local_152c;
  int local_1528;
  int local_1524;
  undefined8 local_1520 [670];
  ulonglong local_30;
  undefined8 local_20;
  
  local_20 = 0x18000b86a;
  local_30 = DAT_1800537e8 ^ (ulonglong)auStack5504;
  iVar18 = 0;
  lVar17 = 0x29;
  local_1528 = 0;
  local_1530 = 0;
  local_152c = 0;
  do {
    pvVar9 = TlsGetValue(DAT_180055088);
    iVar6 = FUN_18000a2b0(*(byte **)((longlong)pvVar9 + 0x28),0x34,0x67,1);
    if (iVar6 != 0) goto LAB_18000bbc0;
    pvVar9 = TlsGetValue(DAT_180055088);
    puVar4 = *(undefined4 **)((longlong)pvVar9 + 0x28);
    lVar13 = lVar17;
    puVar5 = local_1520;
    do {
      puVar15 = puVar5;
      puVar10 = puVar4;
      uVar7 = puVar10[1];
      uVar1 = puVar10[2];
      uVar2 = puVar10[3];
      *(undefined4 *)puVar15 = *puVar10;
      *(undefined4 *)((longlong)puVar15 + 4) = uVar7;
      *(undefined4 *)(puVar15 + 1) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0xc) = uVar2;
      uVar7 = puVar10[5];
      uVar1 = puVar10[6];
      uVar2 = puVar10[7];
      *(undefined4 *)(puVar15 + 2) = puVar10[4];
      *(undefined4 *)((longlong)puVar15 + 0x14) = uVar7;
      *(undefined4 *)(puVar15 + 3) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x1c) = uVar2;
      uVar7 = puVar10[9];
      uVar1 = puVar10[10];
      uVar2 = puVar10[0xb];
      *(undefined4 *)(puVar15 + 4) = puVar10[8];
      *(undefined4 *)((longlong)puVar15 + 0x24) = uVar7;
      *(undefined4 *)(puVar15 + 5) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x2c) = uVar2;
      uVar7 = puVar10[0xd];
      uVar1 = puVar10[0xe];
      uVar2 = puVar10[0xf];
      *(undefined4 *)(puVar15 + 6) = puVar10[0xc];
      *(undefined4 *)((longlong)puVar15 + 0x34) = uVar7;
      *(undefined4 *)(puVar15 + 7) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x3c) = uVar2;
      uVar7 = puVar10[0x11];
      uVar1 = puVar10[0x12];
      uVar2 = puVar10[0x13];
      *(undefined4 *)(puVar15 + 8) = puVar10[0x10];
      *(undefined4 *)((longlong)puVar15 + 0x44) = uVar7;
      *(undefined4 *)(puVar15 + 9) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x4c) = uVar2;
      uVar7 = puVar10[0x15];
      uVar1 = puVar10[0x16];
      uVar2 = puVar10[0x17];
      *(undefined4 *)(puVar15 + 10) = puVar10[0x14];
      *(undefined4 *)((longlong)puVar15 + 0x54) = uVar7;
      *(undefined4 *)(puVar15 + 0xb) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x5c) = uVar2;
      uVar7 = puVar10[0x19];
      uVar1 = puVar10[0x1a];
      uVar2 = puVar10[0x1b];
      *(undefined4 *)(puVar15 + 0xc) = puVar10[0x18];
      *(undefined4 *)((longlong)puVar15 + 100) = uVar7;
      *(undefined4 *)(puVar15 + 0xd) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x6c) = uVar2;
      uVar7 = puVar10[0x1d];
      uVar1 = puVar10[0x1e];
      uVar2 = puVar10[0x1f];
      *(undefined4 *)(puVar15 + 0xe) = puVar10[0x1c];
      *(undefined4 *)((longlong)puVar15 + 0x74) = uVar7;
      *(undefined4 *)(puVar15 + 0xf) = uVar1;
      *(undefined4 *)((longlong)puVar15 + 0x7c) = uVar2;
      lVar13 = lVar13 + -1;
      puVar4 = puVar10 + 0x20;
      puVar5 = puVar15 + 0x10;
    } while (lVar13 != 0);
    uVar7 = puVar10[0x21];
    uVar1 = puVar10[0x22];
    uVar2 = puVar10[0x23];
    *(undefined4 *)(puVar15 + 0x10) = puVar10[0x20];
    *(undefined4 *)((longlong)puVar15 + 0x84) = uVar7;
    *(undefined4 *)(puVar15 + 0x11) = uVar1;
    *(undefined4 *)((longlong)puVar15 + 0x8c) = uVar2;
    uVar7 = puVar10[0x25];
    uVar1 = puVar10[0x26];
    uVar2 = puVar10[0x27];
    *(undefined4 *)(puVar15 + 0x12) = puVar10[0x24];
    *(undefined4 *)((longlong)puVar15 + 0x94) = uVar7;
    *(undefined4 *)(puVar15 + 0x13) = uVar1;
    *(undefined4 *)((longlong)puVar15 + 0x9c) = uVar2;
    uVar7 = puVar10[0x29];
    uVar1 = puVar10[0x2a];
    uVar2 = puVar10[0x2b];
    *(undefined4 *)(puVar15 + 0x14) = puVar10[0x28];
    *(undefined4 *)((longlong)puVar15 + 0xa4) = uVar7;
    *(undefined4 *)(puVar15 + 0x15) = uVar1;
    *(undefined4 *)((longlong)puVar15 + 0xac) = uVar2;
    uVar7 = puVar10[0x2d];
    uVar1 = puVar10[0x2e];
    uVar2 = puVar10[0x2f];
    *(undefined4 *)(puVar15 + 0x16) = puVar10[0x2c];
    *(undefined4 *)((longlong)puVar15 + 0xb4) = uVar7;
    *(undefined4 *)(puVar15 + 0x17) = uVar1;
    *(undefined4 *)((longlong)puVar15 + 0xbc) = uVar2;
    uVar7 = puVar10[0x31];
    uVar1 = puVar10[0x32];
    uVar2 = puVar10[0x33];
    *(undefined4 *)(puVar15 + 0x18) = puVar10[0x30];
    *(undefined4 *)((longlong)puVar15 + 0xc4) = uVar7;
    *(undefined4 *)(puVar15 + 0x19) = uVar1;
    *(undefined4 *)((longlong)puVar15 + 0xcc) = uVar2;
    uVar7 = puVar10[0x35];
    uVar1 = puVar10[0x36];
    uVar2 = puVar10[0x37];
    *(undefined4 *)(puVar15 + 0x1a) = puVar10[0x34];
    *(undefined4 *)((longlong)puVar15 + 0xd4) = uVar7;
    *(undefined4 *)(puVar15 + 0x1b) = uVar1;
    *(undefined4 *)((longlong)puVar15 + 0xdc) = uVar2;
    puVar15[0x1c] = *(undefined8 *)(puVar10 + 0x38);
    *(undefined4 *)(puVar15 + 0x1d) = puVar10[0x3a];
    pvVar9 = TlsGetValue(DAT_180055088);
    if (*(char **)((longlong)pvVar9 + 0x28) != (char *)0x0) {
      lVar13 = 0x14ec;
      pcVar11 = *(char **)((longlong)pvVar9 + 0x28);
      do {
        *pcVar11 = -1 - *pcVar11;
        lVar13 = lVar13 + -1;
        pcVar11 = pcVar11 + 1;
      } while (lVar13 != 0);
    }
    pvVar9 = TlsGetValue(DAT_180055088);
    FUN_180008580(*(undefined8 **)((longlong)pvVar9 + 0x28),0x67,0x34,0);
    pvVar9 = TlsGetValue(DAT_180055088);
    local_1560 = &local_1524;
    uVar7 = FUN_18000c270(*(undefined4 **)((longlong)pvVar9 + 0x28),&local_1528,&local_1530);
    pvVar9 = TlsGetValue(DAT_180055088);
    *(undefined4 *)((longlong)pvVar9 + 0x48) = uVar7;
    pvVar9 = TlsGetValue(DAT_180055088);
    iVar6 = FUN_180018850(*(undefined8 **)((longlong)pvVar9 + 0x28),0x67,0x34,&local_152c);
    pcVar11 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    if (pcVar11 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    }
    pvVar9 = TlsGetValue(DAT_180055088);
    local_1550 = *(undefined4 *)((longlong)pvVar9 + 0x48);
    local_1540 = local_1530;
    local_1548 = local_1528;
    local_1558 = "[IsFP]detect qty = %d,corner = %d,cover = %d,level = %d";
    local_1560 = (int *)CONCAT44(local_1560._4_4_,0x14d);
    local_1538 = iVar6;
    FUN_180004810();
    pcVar11 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    if (pcVar11 != (char *)0x0) {
      strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
    }
    iVar3 = local_1524;
    local_1548 = local_1524;
    local_1550 = local_152c;
    local_1558 = "[IsFP]detect percentage = %d,intensity = %d";
    local_1560 = (int *)CONCAT44(local_1560._4_4_,0x14e);
    FUN_180004810();
    pvVar9 = TlsGetValue(DAT_180055088);
    if (*(int *)((longlong)pvVar9 + 0x58) < iVar3) {
      pvVar9 = TlsGetValue(DAT_180055088);
      *(int *)((longlong)pvVar9 + 0x58) = iVar3;
    }
    pvVar9 = TlsGetValue(DAT_180055088);
    if ((0x78 < *(int *)((longlong)pvVar9 + 0x48)) && (1 < local_1530 - local_1528)) {
      if (local_152c < 0x33) {
        if ((local_152c - 0x1fU < 0x14) && (3 < iVar6)) goto LAB_18000bb94;
      }
      else {
        if (5 < iVar6) {
LAB_18000bb94:
          iVar8 = FUN_180018850(local_1520,0x67,0x34,(undefined4 *)0x0);
          if (0 < iVar8) {
            pcVar11 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
            if (pcVar11 != (char *)0x0) {
              strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
            }
            local_1558 = "get_image finger touch";
            local_1560 = (int *)CONCAT44(local_1560._4_4_,0x169);
            FUN_180004810();
            pvVar9 = TlsGetValue(DAT_180055088);
            *(int *)((longlong)pvVar9 + 0x58) = iVar3;
            pvVar9 = TlsGetValue(DAT_180055088);
            pvVar12 = TlsGetValue(DAT_180055088);
            **(undefined4 **)((longlong)pvVar12 + 0x50) = *(undefined4 *)((longlong)pvVar9 + 0x48);
            pvVar9 = TlsGetValue(DAT_180055088);
            *(int *)(*(longlong *)((longlong)pvVar9 + 0x50) + 4) = local_1530;
            pvVar9 = TlsGetValue(DAT_180055088);
            *(int *)(*(longlong *)((longlong)pvVar9 + 0x50) + 8) = iVar6;
            pvVar9 = TlsGetValue(DAT_180055088);
            *(int *)(*(longlong *)((longlong)pvVar9 + 0x50) + 0xc) = local_152c;
            pvVar9 = TlsGetValue(DAT_180055088);
            pvVar12 = TlsGetValue(DAT_180055088);
            puVar4 = (undefined4 *)(*(longlong *)((longlong)pvVar12 + 0x50) + 0x10);
            puVar10 = *(undefined4 **)((longlong)pvVar9 + 0x28);
            do {
              puVar16 = puVar10;
              puVar14 = puVar4;
              uVar7 = puVar16[1];
              uVar1 = puVar16[2];
              uVar2 = puVar16[3];
              *puVar14 = *puVar16;
              puVar14[1] = uVar7;
              puVar14[2] = uVar1;
              puVar14[3] = uVar2;
              uVar7 = puVar16[5];
              uVar1 = puVar16[6];
              uVar2 = puVar16[7];
              puVar14[4] = puVar16[4];
              puVar14[5] = uVar7;
              puVar14[6] = uVar1;
              puVar14[7] = uVar2;
              uVar7 = puVar16[9];
              uVar1 = puVar16[10];
              uVar2 = puVar16[0xb];
              puVar14[8] = puVar16[8];
              puVar14[9] = uVar7;
              puVar14[10] = uVar1;
              puVar14[0xb] = uVar2;
              uVar7 = puVar16[0xd];
              uVar1 = puVar16[0xe];
              uVar2 = puVar16[0xf];
              puVar14[0xc] = puVar16[0xc];
              puVar14[0xd] = uVar7;
              puVar14[0xe] = uVar1;
              puVar14[0xf] = uVar2;
              uVar7 = puVar16[0x11];
              uVar1 = puVar16[0x12];
              uVar2 = puVar16[0x13];
              puVar14[0x10] = puVar16[0x10];
              puVar14[0x11] = uVar7;
              puVar14[0x12] = uVar1;
              puVar14[0x13] = uVar2;
              uVar7 = puVar16[0x15];
              uVar1 = puVar16[0x16];
              uVar2 = puVar16[0x17];
              puVar14[0x14] = puVar16[0x14];
              puVar14[0x15] = uVar7;
              puVar14[0x16] = uVar1;
              puVar14[0x17] = uVar2;
              uVar7 = puVar16[0x19];
              uVar1 = puVar16[0x1a];
              uVar2 = puVar16[0x1b];
              puVar14[0x18] = puVar16[0x18];
              puVar14[0x19] = uVar7;
              puVar14[0x1a] = uVar1;
              puVar14[0x1b] = uVar2;
              uVar7 = puVar16[0x1d];
              uVar1 = puVar16[0x1e];
              uVar2 = puVar16[0x1f];
              puVar14[0x1c] = puVar16[0x1c];
              puVar14[0x1d] = uVar7;
              puVar14[0x1e] = uVar1;
              puVar14[0x1f] = uVar2;
              lVar17 = lVar17 + -1;
              puVar4 = puVar14 + 0x20;
              puVar10 = puVar16 + 0x20;
            } while (lVar17 != 0);
            uVar7 = puVar16[0x21];
            uVar1 = puVar16[0x22];
            uVar2 = puVar16[0x23];
            puVar14[0x20] = puVar16[0x20];
            puVar14[0x21] = uVar7;
            puVar14[0x22] = uVar1;
            puVar14[0x23] = uVar2;
            uVar7 = puVar16[0x25];
            uVar1 = puVar16[0x26];
            uVar2 = puVar16[0x27];
            puVar14[0x24] = puVar16[0x24];
            puVar14[0x25] = uVar7;
            puVar14[0x26] = uVar1;
            puVar14[0x27] = uVar2;
            uVar7 = puVar16[0x29];
            uVar1 = puVar16[0x2a];
            uVar2 = puVar16[0x2b];
            puVar14[0x28] = puVar16[0x28];
            puVar14[0x29] = uVar7;
            puVar14[0x2a] = uVar1;
            puVar14[0x2b] = uVar2;
            uVar7 = puVar16[0x2d];
            uVar1 = puVar16[0x2e];
            uVar2 = puVar16[0x2f];
            puVar14[0x2c] = puVar16[0x2c];
            puVar14[0x2d] = uVar7;
            puVar14[0x2e] = uVar1;
            puVar14[0x2f] = uVar2;
            uVar7 = puVar16[0x31];
            uVar1 = puVar16[0x32];
            uVar2 = puVar16[0x33];
            puVar14[0x30] = puVar16[0x30];
            puVar14[0x31] = uVar7;
            puVar14[0x32] = uVar1;
            puVar14[0x33] = uVar2;
            uVar7 = puVar16[0x35];
            uVar1 = puVar16[0x36];
            uVar2 = puVar16[0x37];
            puVar14[0x34] = puVar16[0x34];
            puVar14[0x35] = uVar7;
            puVar14[0x36] = uVar1;
            puVar14[0x37] = uVar2;
            *(undefined8 *)(puVar14 + 0x38) = *(undefined8 *)(puVar16 + 0x38);
            puVar14[0x3a] = puVar16[0x3a];
LAB_18000bbc0:
            FUN_180023ef0(local_30 ^ (ulonglong)auStack5504);
            return;
          }
        }
      }
    }
    iVar18 = iVar18 + 1;
    if (4 < iVar18) goto LAB_18000bbc0;
  } while( true );
}



ulonglong FUN_18000bd90(int *param_1,undefined4 *param_2,byte **param_3,undefined4 *param_4,
                       undefined4 *param_5,uint *param_6)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  uint uVar7;
  char *pcVar8;
  LPVOID pvVar9;
  ulonglong uVar10;
  byte *pbVar11;
  longlong lVar12;
  longlong *plVar13;
  undefined4 *puVar14;
  undefined4 *puVar15;
  ulonglong uVar16;
  
  uVar7 = 0;
  pcVar8 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
  if (pcVar8 != (char *)0x0) {
    strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
  }
  FUN_180004810();
  iVar1 = *param_1;
  if (iVar1 == 0x13) {
    *param_2 = 0xffffffff;
    *param_1 = 0x14;
    uVar10 = FUN_18000a6b0();
    if ((int)uVar10 == 0) {
      pcVar8 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      if (pcVar8 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      }
      FUN_180004810();
      uVar10 = 0xc;
    }
  }
  else {
    if (iVar1 == 0x14) {
      pcVar8 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      if (pcVar8 != (char *)0x0) {
        strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
      }
      FUN_180004810();
      pvVar9 = TlsGetValue(DAT_180055088);
      *(undefined4 *)((longlong)pvVar9 + 0x30) = 0;
      pvVar9 = TlsGetValue(DAT_180055088);
      *(undefined4 *)((longlong)pvVar9 + 0x38) = 0;
      pvVar9 = TlsGetValue(DAT_180055088);
      *(undefined4 *)((longlong)pvVar9 + 0x40) = 1;
      pvVar9 = TlsGetValue(DAT_180055088);
      *(undefined4 *)((longlong)pvVar9 + 0x48) = 0;
      pvVar9 = TlsGetValue(DAT_180055088);
      if ((*(int *)((longlong)pvVar9 + 8) != 2) && (uVar10 = FUN_18000ab70(), (int)uVar10 != 0)) {
        return uVar10;
      }
      uVar10 = FUN_18000b850();
      uVar7 = (uint)uVar10;
      if (uVar7 == 0xe) {
        *param_2 = 0xffffffff;
        uVar7 = FUN_18000a6b0();
        if (uVar7 == 0) {
          uVar7 = 0xc;
        }
      }
      else {
        if (uVar7 == 0xf) {
          *param_1 = 0x15;
          return uVar10;
        }
      }
    }
    else {
      if (iVar1 == 0x15) {
        pcVar8 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
        if (pcVar8 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180004810();
        pvVar9 = TlsGetValue(DAT_180055088);
        uVar10 = FUN_18000b4a0(*(undefined8 **)((longlong)pvVar9 + 0x28),param_6);
        uVar16 = uVar10 & 0xffffffff;
        if ((int)uVar10 == 0xe) {
          uVar16 = 0;
        }
        else {
          if ((int)uVar10 != 0) {
            return uVar10;
          }
        }
        pbVar11 = (byte *)malloc(0x14ec);
        *param_3 = pbVar11;
        if (pbVar11 == (byte *)0x0) {
          pcVar8 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
          if (pcVar8 != (char *)0x0) {
            strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
          }
          FUN_180004810();
          return 2;
        }
        *param_4 = 0x67;
        *param_5 = 0x34;
        pvVar9 = TlsGetValue(DAT_180055088);
        lVar12 = 0x29;
        puVar5 = (undefined4 *)*param_3;
        puVar6 = *(undefined4 **)((longlong)pvVar9 + 0x28);
        do {
          puVar15 = puVar6;
          puVar14 = puVar5;
          uVar2 = puVar15[1];
          uVar3 = puVar15[2];
          uVar4 = puVar15[3];
          *puVar14 = *puVar15;
          puVar14[1] = uVar2;
          puVar14[2] = uVar3;
          puVar14[3] = uVar4;
          uVar2 = puVar15[5];
          uVar3 = puVar15[6];
          uVar4 = puVar15[7];
          puVar14[4] = puVar15[4];
          puVar14[5] = uVar2;
          puVar14[6] = uVar3;
          puVar14[7] = uVar4;
          uVar2 = puVar15[9];
          uVar3 = puVar15[10];
          uVar4 = puVar15[0xb];
          puVar14[8] = puVar15[8];
          puVar14[9] = uVar2;
          puVar14[10] = uVar3;
          puVar14[0xb] = uVar4;
          uVar2 = puVar15[0xd];
          uVar3 = puVar15[0xe];
          uVar4 = puVar15[0xf];
          puVar14[0xc] = puVar15[0xc];
          puVar14[0xd] = uVar2;
          puVar14[0xe] = uVar3;
          puVar14[0xf] = uVar4;
          uVar2 = puVar15[0x11];
          uVar3 = puVar15[0x12];
          uVar4 = puVar15[0x13];
          puVar14[0x10] = puVar15[0x10];
          puVar14[0x11] = uVar2;
          puVar14[0x12] = uVar3;
          puVar14[0x13] = uVar4;
          uVar2 = puVar15[0x15];
          uVar3 = puVar15[0x16];
          uVar4 = puVar15[0x17];
          puVar14[0x14] = puVar15[0x14];
          puVar14[0x15] = uVar2;
          puVar14[0x16] = uVar3;
          puVar14[0x17] = uVar4;
          uVar2 = puVar15[0x19];
          uVar3 = puVar15[0x1a];
          uVar4 = puVar15[0x1b];
          puVar14[0x18] = puVar15[0x18];
          puVar14[0x19] = uVar2;
          puVar14[0x1a] = uVar3;
          puVar14[0x1b] = uVar4;
          uVar2 = puVar15[0x1d];
          uVar3 = puVar15[0x1e];
          uVar4 = puVar15[0x1f];
          puVar14[0x1c] = puVar15[0x1c];
          puVar14[0x1d] = uVar2;
          puVar14[0x1e] = uVar3;
          puVar14[0x1f] = uVar4;
          lVar12 = lVar12 + -1;
          puVar5 = puVar14 + 0x20;
          puVar6 = puVar15 + 0x20;
        } while (lVar12 != 0);
        uVar2 = puVar15[0x21];
        uVar3 = puVar15[0x22];
        uVar4 = puVar15[0x23];
        puVar14[0x20] = puVar15[0x20];
        puVar14[0x21] = uVar2;
        puVar14[0x22] = uVar3;
        puVar14[0x23] = uVar4;
        uVar2 = puVar15[0x25];
        uVar3 = puVar15[0x26];
        uVar4 = puVar15[0x27];
        puVar14[0x24] = puVar15[0x24];
        puVar14[0x25] = uVar2;
        puVar14[0x26] = uVar3;
        puVar14[0x27] = uVar4;
        uVar2 = puVar15[0x29];
        uVar3 = puVar15[0x2a];
        uVar4 = puVar15[0x2b];
        puVar14[0x28] = puVar15[0x28];
        puVar14[0x29] = uVar2;
        puVar14[0x2a] = uVar3;
        puVar14[0x2b] = uVar4;
        uVar2 = puVar15[0x2d];
        uVar3 = puVar15[0x2e];
        uVar4 = puVar15[0x2f];
        puVar14[0x2c] = puVar15[0x2c];
        puVar14[0x2d] = uVar2;
        puVar14[0x2e] = uVar3;
        puVar14[0x2f] = uVar4;
        uVar2 = puVar15[0x31];
        uVar3 = puVar15[0x32];
        uVar4 = puVar15[0x33];
        puVar14[0x30] = puVar15[0x30];
        puVar14[0x31] = uVar2;
        puVar14[0x32] = uVar3;
        puVar14[0x33] = uVar4;
        uVar2 = puVar15[0x35];
        uVar3 = puVar15[0x36];
        uVar4 = puVar15[0x37];
        puVar14[0x34] = puVar15[0x34];
        puVar14[0x35] = uVar2;
        puVar14[0x36] = uVar3;
        puVar14[0x37] = uVar4;
        *(undefined8 *)(puVar14 + 0x38) = *(undefined8 *)(puVar15 + 0x38);
        puVar14[0x3a] = puVar15[0x3a];
        FUN_180004fa0(*param_3,0x67,0x34,0x8c);
        plVar13 = (longlong *)TlsGetValue(DAT_180055088);
        FUN_18000cdd0((longlong)*param_3,0x67,0x34,(undefined4 *)(*plVar13 + 0x14fb));
        pcVar8 = strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
        if (pcVar8 != (char *)0x0) {
          strrchr("ET5XX\\egis_fp_get_image.c",0x2f);
        }
        FUN_180004810();
        return uVar16;
      }
    }
    uVar10 = (ulonglong)uVar7;
  }
  return uVar10;
}



// WARNING: Removing unreachable block (ram,0x00018000c22f)
// WARNING: Removing unreachable block (ram,0x00018000c20c)
// WARNING: Removing unreachable block (ram,0x00018000c213)

void FUN_18000c1f0(byte *param_1,int param_2)

{
  uint uVar1;
  longlong lVar2;
  
  if (param_1 != (byte *)0x0) {
    lVar2 = 0x14ec;
    if (param_2 == 0) {
      do {
        *param_1 = -*param_1 - 1;
        lVar2 = lVar2 + -1;
        param_1 = param_1 + 1;
      } while (lVar2 != 0);
      return;
    }
    do {
      uVar1 = (int)(((uint)*param_1 + (uint)*param_1 * 2) * 0x10 + 8) >> 4;
      if ((int)uVar1 < 0) {
        uVar1 = 0;
      }
      else {
        if (0xff < uVar1) {
          uVar1 = 0xff;
        }
      }
      *param_1 = -(char)uVar1 - 1;
      param_1 = param_1 + 1;
      lVar2 = lVar2 + -1;
    } while (lVar2 != 0);
  }
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_18000c270(undefined4 *param_1,int *param_2,int *param_3)

{
  undefined8 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined8 *puVar10;
  undefined8 *puVar11;
  ulonglong uVar12;
  longlong lVar13;
  undefined4 *puVar14;
  undefined4 *local_res20;
  undefined8 local_2d30 [1440];
  ulonglong local_30;
  undefined8 uStack32;
  
  uStack32 = 0x18000c27e;
  local_30 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffd2a0;
  lVar13 = 0x29;
  puVar10 = local_2d30;
  do {
    puVar14 = param_1;
    puVar11 = puVar10;
    uVar2 = puVar14[1];
    uVar3 = puVar14[2];
    uVar4 = puVar14[3];
    uVar5 = puVar14[4];
    uVar6 = puVar14[5];
    uVar7 = puVar14[6];
    uVar8 = puVar14[7];
    *(undefined4 *)puVar11 = *puVar14;
    *(undefined4 *)((longlong)puVar11 + 4) = uVar2;
    *(undefined4 *)(puVar11 + 1) = uVar3;
    *(undefined4 *)((longlong)puVar11 + 0xc) = uVar4;
    uVar2 = puVar14[8];
    uVar3 = puVar14[9];
    uVar4 = puVar14[10];
    uVar9 = puVar14[0xb];
    *(undefined4 *)(puVar11 + 2) = uVar5;
    *(undefined4 *)((longlong)puVar11 + 0x14) = uVar6;
    *(undefined4 *)(puVar11 + 3) = uVar7;
    *(undefined4 *)((longlong)puVar11 + 0x1c) = uVar8;
    uVar5 = puVar14[0xc];
    uVar6 = puVar14[0xd];
    uVar7 = puVar14[0xe];
    uVar8 = puVar14[0xf];
    *(undefined4 *)(puVar11 + 4) = uVar2;
    *(undefined4 *)((longlong)puVar11 + 0x24) = uVar3;
    *(undefined4 *)(puVar11 + 5) = uVar4;
    *(undefined4 *)((longlong)puVar11 + 0x2c) = uVar9;
    uVar2 = puVar14[0x10];
    uVar3 = puVar14[0x11];
    uVar4 = puVar14[0x12];
    uVar9 = puVar14[0x13];
    *(undefined4 *)(puVar11 + 6) = uVar5;
    *(undefined4 *)((longlong)puVar11 + 0x34) = uVar6;
    *(undefined4 *)(puVar11 + 7) = uVar7;
    *(undefined4 *)((longlong)puVar11 + 0x3c) = uVar8;
    uVar5 = puVar14[0x14];
    uVar6 = puVar14[0x15];
    uVar7 = puVar14[0x16];
    uVar8 = puVar14[0x17];
    *(undefined4 *)(puVar11 + 8) = uVar2;
    *(undefined4 *)((longlong)puVar11 + 0x44) = uVar3;
    *(undefined4 *)(puVar11 + 9) = uVar4;
    *(undefined4 *)((longlong)puVar11 + 0x4c) = uVar9;
    uVar2 = puVar14[0x18];
    uVar3 = puVar14[0x19];
    uVar4 = puVar14[0x1a];
    uVar9 = puVar14[0x1b];
    *(undefined4 *)(puVar11 + 10) = uVar5;
    *(undefined4 *)((longlong)puVar11 + 0x54) = uVar6;
    *(undefined4 *)(puVar11 + 0xb) = uVar7;
    *(undefined4 *)((longlong)puVar11 + 0x5c) = uVar8;
    uVar5 = puVar14[0x1c];
    uVar6 = puVar14[0x1d];
    uVar7 = puVar14[0x1e];
    uVar8 = puVar14[0x1f];
    *(undefined4 *)(puVar11 + 0xc) = uVar2;
    *(undefined4 *)((longlong)puVar11 + 100) = uVar3;
    *(undefined4 *)(puVar11 + 0xd) = uVar4;
    *(undefined4 *)((longlong)puVar11 + 0x6c) = uVar9;
    *(undefined4 *)(puVar11 + 0xe) = uVar5;
    *(undefined4 *)((longlong)puVar11 + 0x74) = uVar6;
    *(undefined4 *)(puVar11 + 0xf) = uVar7;
    *(undefined4 *)((longlong)puVar11 + 0x7c) = uVar8;
    lVar13 = lVar13 + -1;
    puVar10 = puVar11 + 0x10;
    param_1 = puVar14 + 0x20;
  } while (lVar13 != 0);
  uVar1 = *(undefined8 *)(puVar14 + 0x38);
  uVar2 = puVar14[0x21];
  uVar3 = puVar14[0x22];
  uVar4 = puVar14[0x23];
  uVar5 = puVar14[0x24];
  uVar6 = puVar14[0x25];
  uVar7 = puVar14[0x26];
  uVar8 = puVar14[0x27];
  *(undefined4 *)(puVar11 + 0x10) = puVar14[0x20];
  *(undefined4 *)((longlong)puVar11 + 0x84) = uVar2;
  *(undefined4 *)(puVar11 + 0x11) = uVar3;
  *(undefined4 *)((longlong)puVar11 + 0x8c) = uVar4;
  uVar2 = puVar14[0x28];
  uVar3 = puVar14[0x29];
  uVar4 = puVar14[0x2a];
  uVar9 = puVar14[0x2b];
  *(undefined4 *)(puVar11 + 0x12) = uVar5;
  *(undefined4 *)((longlong)puVar11 + 0x94) = uVar6;
  *(undefined4 *)(puVar11 + 0x13) = uVar7;
  *(undefined4 *)((longlong)puVar11 + 0x9c) = uVar8;
  uVar5 = puVar14[0x2c];
  uVar6 = puVar14[0x2d];
  uVar7 = puVar14[0x2e];
  uVar8 = puVar14[0x2f];
  *(undefined4 *)(puVar11 + 0x14) = uVar2;
  *(undefined4 *)((longlong)puVar11 + 0xa4) = uVar3;
  *(undefined4 *)(puVar11 + 0x15) = uVar4;
  *(undefined4 *)((longlong)puVar11 + 0xac) = uVar9;
  uVar2 = puVar14[0x30];
  uVar3 = puVar14[0x31];
  uVar4 = puVar14[0x32];
  uVar9 = puVar14[0x33];
  *(undefined4 *)(puVar11 + 0x16) = uVar5;
  *(undefined4 *)((longlong)puVar11 + 0xb4) = uVar6;
  *(undefined4 *)(puVar11 + 0x17) = uVar7;
  *(undefined4 *)((longlong)puVar11 + 0xbc) = uVar8;
  uVar5 = puVar14[0x34];
  uVar6 = puVar14[0x35];
  uVar7 = puVar14[0x36];
  uVar8 = puVar14[0x37];
  *(undefined4 *)(puVar11 + 0x18) = uVar2;
  *(undefined4 *)((longlong)puVar11 + 0xc4) = uVar3;
  *(undefined4 *)(puVar11 + 0x19) = uVar4;
  *(undefined4 *)((longlong)puVar11 + 0xcc) = uVar9;
  *(undefined4 *)(puVar11 + 0x1a) = uVar5;
  *(undefined4 *)((longlong)puVar11 + 0xd4) = uVar6;
  *(undefined4 *)(puVar11 + 0x1b) = uVar7;
  *(undefined4 *)((longlong)puVar11 + 0xdc) = uVar8;
  puVar11[0x1c] = uVar1;
  *(undefined4 *)(puVar11 + 0x1d) = puVar14[0x3a];
  FUN_180005f20((longlong)local_2d30,0x67,0x34,0x90,0x50);
  FUN_1800180a0(local_2d30,0x90,0x50,param_2,param_3,0);
  if (local_res20 != (undefined4 *)0x0) {
    uVar12 = FUN_180005550((byte *)local_2d30,0x90,0x50,0x90,0);
    *local_res20 = (int)uVar12;
  }
  FUN_180023ef0(local_30 ^ (ulonglong)&stack0xffffffffffffd2a0);
  return;
}



undefined ** FUN_18000c3d0(undefined **param_1)

{
  undefined2 *puVar1;
  undefined *puVar2;
  undefined8 *puVar3;
  LPVOID pvVar4;
  
  *param_1 = (undefined *)&PTR_FUN_180044fd8;
  FUN_1800244a0((undefined (*) [16])(param_1 + 1),0,0x68);
  TlsSetValue(DAT_180055088,param_1 + 1);
  puVar2 = (undefined *)LocalAlloc(0x40,0x29f4);
  param_1[1] = puVar2;
  puVar2 = (undefined *)LocalAlloc(0x40,0x14ec);
  param_1[6] = puVar2;
  puVar2 = (undefined *)LocalAlloc(0x40,0x14fc);
  param_1[0xb] = puVar2;
  puVar3 = (undefined8 *)TlsGetValue(DAT_180055088);
  puVar1 = (undefined2 *)*puVar3;
  *puVar1 = 0xf03;
  *(undefined4 *)(puVar1 + 0x14f6) = 0x5066006;
  puVar1[0x14f8] = 0x62f;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 8) = 2;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x10) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x18) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x20) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x30) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x38) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x40) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x48) = 0;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x58) = 0xff;
  pvVar4 = TlsGetValue(DAT_180055088);
  *(undefined4 *)((longlong)pvVar4 + 0x60) = 0;
  return param_1;
}



void FUN_18000c520(undefined **param_1)

{
  HLOCAL *ppvVar1;
  LPVOID pvVar2;
  
  *param_1 = (undefined *)&PTR_FUN_180044fd8;
  ppvVar1 = (HLOCAL *)TlsGetValue(DAT_180055088);
  LocalFree(*ppvVar1);
  pvVar2 = TlsGetValue(DAT_180055088);
  LocalFree(*(HLOCAL *)((longlong)pvVar2 + 0x28));
  pvVar2 = TlsGetValue(DAT_180055088);
                    // WARNING: Could not recover jumptable at 0x00018000c56d. Too many branches
                    // WARNING: Treating indirect jump as call
  LocalFree(*(HLOCAL *)((longlong)pvVar2 + 0x50));
  return;
}



undefined ** FUN_18000c580(undefined **param_1,uint param_2)

{
  HLOCAL *ppvVar1;
  LPVOID pvVar2;
  
  *param_1 = (undefined *)&PTR_FUN_180044fd8;
  ppvVar1 = (HLOCAL *)TlsGetValue(DAT_180055088);
  LocalFree(*ppvVar1);
  pvVar2 = TlsGetValue(DAT_180055088);
  LocalFree(*(HLOCAL *)((longlong)pvVar2 + 0x28));
  pvVar2 = TlsGetValue(DAT_180055088);
  LocalFree(*(HLOCAL *)((longlong)pvVar2 + 0x50));
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



undefined8
FUN_18000c600(longlong param_1,undefined8 *param_2,uint param_3,int param_4,uint param_5,
             int *param_6)

{
  undefined8 uVar1;
  undefined8 uVar2;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  uVar1 = FUN_18000b2f0(param_2,param_3,param_4,(ulonglong)param_5,param_6);
  uVar2 = 0;
  if ((int)uVar1 != 0) {
    uVar2 = 0x3e3;
  }
  return uVar2;
}



undefined8
FUN_18000c670(longlong *param_1,byte *param_2,undefined8 *param_3,undefined4 *param_4,uint param_5)

{
  int iVar1;
  ULONGLONG UVar2;
  ulonglong uVar3;
  LPVOID pvVar4;
  ulonglong uVar5;
  int local_res8 [2];
  undefined4 local_res10 [2];
  int local_38;
  int local_34;
  uint local_30 [2];
  undefined8 *local_28 [2];
  
  TlsSetValue(DAT_180055088,param_1 + 1);
  local_res10[0] = 0;
  local_res8[0] = 0x14;
  if (param_5 == 0xffffffff) {
    uVar5 = 0xffffffffffffffff;
  }
  else {
    UVar2 = GetTickCount64();
    uVar5 = param_5 + UVar2;
  }
  if (*param_2 == 0) {
    FUN_180009af0();
    do {
      uVar3 = FUN_18000bd90(local_res8,local_res10,(byte **)local_28,&local_38,&local_34,local_30);
      if ((int)uVar3 == 0xf) {
        uVar3 = FUN_18000bd90(local_res8,local_res10,(byte **)local_28,&local_38,&local_34,local_30)
        ;
        if ((int)uVar3 == 0) {
          FUN_180023f20(param_3,local_28[0],(longlong)(local_38 * local_34));
          free(local_28[0]);
          pvVar4 = TlsGetValue(DAT_180055088);
          *param_4 = *(undefined4 *)((longlong)pvVar4 + 0x48);
          return 0;
        }
        local_res8[0] = 0x13;
      }
      else {
        if ((int)uVar3 != 0xc) {
          return 1;
        }
        if (*param_2 != 0) {
          return 0x3e3;
        }
        while( true ) {
          UVar2 = GetTickCount64();
          if (uVar5 < UVar2) {
            return 0x5b4;
          }
          iVar1 = (**(code **)(*param_1 + 0x10))(param_1,1,&param_5);
          if (iVar1 == 0) {
            return 1;
          }
          if (((byte)param_5 >> 2 & 1) != 0) break;
          if (*param_2 != ((byte)param_5 >> 2 & 1)) {
            return 0x3e3;
          }
        }
      }
    } while (*param_2 == 0);
  }
  return 0x3e3;
}



longlong FUN_18000c800(longlong param_1)

{
  longlong *plVar1;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  plVar1 = (longlong *)TlsGetValue(DAT_180055088);
  return *plVar1 + 0xe;
}



bool FUN_18000c830(longlong param_1,undefined8 param_2,undefined *param_3,undefined *param_4)

{
  longlong lVar1;
  int iVar2;
  longlong *plVar3;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  plVar3 = (longlong *)TlsGetValue(DAT_180055088);
  lVar1 = *plVar3;
  iVar2 = (*(code *)param_3)(param_2,L"sensor_gain",lVar1 + 1);
  if (((((iVar2 != 0) &&
        (iVar2 = (*(code *)param_3)(param_2,L"sensor_vref_sel",lVar1 + 2), iVar2 != 0)) &&
       (iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_p",lVar1 + 3), iVar2 != 0)) &&
      ((((iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_c",lVar1 + 4), iVar2 != 0 &&
         (iVar2 = (*(code *)param_3)(param_2,L"detect_gain",lVar1 + 5), iVar2 != 0)) &&
        ((iVar2 = (*(code *)param_3)(param_2,L"detect_vref_sel",lVar1 + 6), iVar2 != 0 &&
         ((iVar2 = (*(code *)param_3)(param_2,L"detect_dc_p",lVar1 + 7), iVar2 != 0 &&
          (iVar2 = (*(code *)param_3)(param_2,L"detect_dc_c",lVar1 + 8), iVar2 != 0)))))) &&
       (iVar2 = (*(code *)param_3)(param_2,L"detect_dc_f_g",lVar1 + 9), iVar2 != 0)))) &&
     ((((iVar2 = (*(code *)param_3)(param_2,L"detect_mean",lVar1 + 10), iVar2 != 0 &&
        (iVar2 = (*(code *)param_3)(param_2,L"detect_thh",lVar1 + 0xb), iVar2 != 0)) &&
       (iVar2 = (*(code *)param_3)(param_2,L"detect_thl",lVar1 + 0xc), iVar2 != 0)) &&
      ((iVar2 = (*(code *)param_4)(param_2,L"vdm_bk",lVar1 + 0xe,0x14ec), iVar2 != 0 &&
       (iVar2 = (*(code *)param_4)(param_2,L"bad_pixel",lVar1 + 0x14fb,0x14ec), iVar2 != 0)))))) {
    plVar3 = (longlong *)TlsGetValue(DAT_180055088);
    iVar2 = FUN_18000a240(*plVar3 + 0xe,0x67,0x34);
    if (iVar2 == 0) {
      iVar2 = FUN_18000ab70();
      return iVar2 == 0;
    }
  }
  return false;
}



bool FUN_18000ca10(longlong param_1)

{
  int iVar1;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009af0();
  return iVar1 == 0;
}



bool FUN_18000ca40(longlong param_1)

{
  int iVar1;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009af0();
  if (iVar1 != 0) {
    return false;
  }
  iVar1 = FUN_18000a6b0();
  return iVar1 == 0;
}



bool FUN_18000ca80(longlong param_1)

{
  int iVar1;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009af0();
  if (iVar1 != 0) {
    return false;
  }
  iVar1 = FUN_18000ab70();
  return iVar1 == 0;
}



bool FUN_18000cac0(longlong param_1)

{
  int iVar1;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  iVar1 = FUN_180009af0();
  if (iVar1 != 0) {
    return false;
  }
  iVar1 = FUN_18000aa40();
  return iVar1 == 0;
}



undefined8 FUN_18000cb00(longlong param_1,char *param_2)

{
  char cVar1;
  LPVOID pvVar2;
  ulonglong uVar3;
  int local_res8 [8];
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  pvVar2 = TlsGetValue(DAT_180055088);
  cVar1 = *param_2;
  local_res8[0] = *(int *)((longlong)pvVar2 + 0x48);
  while( true ) {
    if (cVar1 != '\0') {
      return 0x3e3;
    }
    uVar3 = FUN_18000af10(local_res8);
    if ((int)uVar3 != 0x11) break;
    cVar1 = *param_2;
  }
  return 0;
}



bool FUN_18000cb60(longlong param_1,undefined8 param_2,undefined *param_3,undefined *param_4)

{
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  longlong *plVar5;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  uVar3 = FUN_180008110();
  if ((int)uVar3 != 0) {
    return false;
  }
  uVar4 = FUN_180008e80();
  if ((int)uVar4 == 0) {
    plVar5 = (longlong *)TlsGetValue(DAT_180055088);
    lVar1 = *plVar5;
    iVar2 = (*(code *)param_3)(param_2,L"sensor_gain",*(undefined *)(lVar1 + 1));
    if (((((iVar2 != 0) &&
          (iVar2 = (*(code *)param_3)(param_2,L"sensor_vref_sel",*(undefined *)(lVar1 + 2)),
          iVar2 != 0)) &&
         (iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_p",*(undefined *)(lVar1 + 3)), iVar2 != 0))
        && (((iVar2 = (*(code *)param_3)(param_2,L"sensor_dc_c",*(undefined *)(lVar1 + 4)),
             iVar2 != 0 &&
             (iVar2 = (*(code *)param_3)(param_2,L"detect_gain",*(undefined *)(lVar1 + 5)),
             iVar2 != 0)) &&
            ((iVar2 = (*(code *)param_3)(param_2,L"detect_vref_sel",*(undefined *)(lVar1 + 6)),
             iVar2 != 0 &&
             ((iVar2 = (*(code *)param_3)(param_2,L"detect_dc_p",*(undefined *)(lVar1 + 7)),
              iVar2 != 0 &&
              (iVar2 = (*(code *)param_3)(param_2,L"detect_dc_c",*(undefined *)(lVar1 + 8)),
              iVar2 != 0)))))))) &&
       ((iVar2 = (*(code *)param_3)(param_2,L"detect_dc_f_g",*(undefined *)(lVar1 + 9)), iVar2 != 0
        && ((((iVar2 = (*(code *)param_3)(param_2,L"detect_mean",*(undefined *)(lVar1 + 10)),
              iVar2 != 0 &&
              (iVar2 = (*(code *)param_3)(param_2,L"detect_thh",*(undefined *)(lVar1 + 0xb)),
              iVar2 != 0)) &&
             (iVar2 = (*(code *)param_3)(param_2,L"detect_thl",*(undefined *)(lVar1 + 0xc)),
             iVar2 != 0)) &&
            (iVar2 = (*(code *)param_4)(param_2,L"vdm_bk",lVar1 + 0xe,0x14ec), iVar2 != 0)))))) {
      iVar2 = (*(code *)param_4)(param_2,L"bad_pixel",lVar1 + 0x14fb,0x14ec);
      return iVar2 != 0;
    }
    return false;
  }
  return false;
}



bool FUN_18000cd30(longlong param_1)

{
  undefined8 uVar1;
  
  TlsSetValue(DAT_180055088,(LPVOID)(param_1 + 8));
  uVar1 = FUN_18000a5a0();
  return (int)uVar1 == 0;
}



bool FUN_18000cd60(longlong *param_1,undefined param_2,char param_3)

{
  int iVar1;
  char local_res8 [8];
  
  iVar1 = (**(code **)(*param_1 + 0x18))();
  if (iVar1 != 0) {
    iVar1 = (**(code **)(*param_1 + 0x10))(param_1,param_2,local_res8);
    if (iVar1 != 0) {
      return param_3 == local_res8[0];
    }
  }
  return false;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_18000cdd0(longlong param_1,int param_2,int param_3,undefined4 *param_4)

{
  undefined8 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 *puVar10;
  longlong lVar11;
  longlong lVar12;
  undefined4 *puVar13;
  undefined4 *puVar14;
  int local_res20;
  undefined4 local_1510;
  ulonglong local_20;
  undefined8 uStack8;
  
  uStack8 = 0x18000cdda;
  local_20 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffeac0;
  lVar11 = 0x29;
  puVar10 = &local_1510;
  do {
    puVar14 = param_4;
    puVar13 = puVar10;
    uVar2 = puVar14[1];
    uVar3 = puVar14[2];
    uVar4 = puVar14[3];
    uVar5 = puVar14[4];
    uVar6 = puVar14[5];
    uVar7 = puVar14[6];
    uVar8 = puVar14[7];
    *puVar13 = *puVar14;
    puVar13[1] = uVar2;
    puVar13[2] = uVar3;
    puVar13[3] = uVar4;
    uVar2 = puVar14[8];
    uVar3 = puVar14[9];
    uVar4 = puVar14[10];
    uVar9 = puVar14[0xb];
    puVar13[4] = uVar5;
    puVar13[5] = uVar6;
    puVar13[6] = uVar7;
    puVar13[7] = uVar8;
    uVar5 = puVar14[0xc];
    uVar6 = puVar14[0xd];
    uVar7 = puVar14[0xe];
    uVar8 = puVar14[0xf];
    puVar13[8] = uVar2;
    puVar13[9] = uVar3;
    puVar13[10] = uVar4;
    puVar13[0xb] = uVar9;
    uVar2 = puVar14[0x10];
    uVar3 = puVar14[0x11];
    uVar4 = puVar14[0x12];
    uVar9 = puVar14[0x13];
    puVar13[0xc] = uVar5;
    puVar13[0xd] = uVar6;
    puVar13[0xe] = uVar7;
    puVar13[0xf] = uVar8;
    uVar5 = puVar14[0x14];
    uVar6 = puVar14[0x15];
    uVar7 = puVar14[0x16];
    uVar8 = puVar14[0x17];
    puVar13[0x10] = uVar2;
    puVar13[0x11] = uVar3;
    puVar13[0x12] = uVar4;
    puVar13[0x13] = uVar9;
    uVar2 = puVar14[0x18];
    uVar3 = puVar14[0x19];
    uVar4 = puVar14[0x1a];
    uVar9 = puVar14[0x1b];
    puVar13[0x14] = uVar5;
    puVar13[0x15] = uVar6;
    puVar13[0x16] = uVar7;
    puVar13[0x17] = uVar8;
    uVar5 = puVar14[0x1c];
    uVar6 = puVar14[0x1d];
    uVar7 = puVar14[0x1e];
    uVar8 = puVar14[0x1f];
    puVar13[0x18] = uVar2;
    puVar13[0x19] = uVar3;
    puVar13[0x1a] = uVar4;
    puVar13[0x1b] = uVar9;
    puVar13[0x1c] = uVar5;
    puVar13[0x1d] = uVar6;
    puVar13[0x1e] = uVar7;
    puVar13[0x1f] = uVar8;
    lVar11 = lVar11 + -1;
    puVar10 = puVar13 + 0x20;
    param_4 = puVar14 + 0x20;
  } while (lVar11 != 0);
  uVar1 = *(undefined8 *)(puVar14 + 0x38);
  uVar2 = puVar14[0x21];
  uVar3 = puVar14[0x22];
  uVar4 = puVar14[0x23];
  uVar5 = puVar14[0x24];
  uVar6 = puVar14[0x25];
  uVar7 = puVar14[0x26];
  uVar8 = puVar14[0x27];
  puVar13[0x20] = puVar14[0x20];
  puVar13[0x21] = uVar2;
  puVar13[0x22] = uVar3;
  puVar13[0x23] = uVar4;
  uVar2 = puVar14[0x28];
  uVar3 = puVar14[0x29];
  uVar4 = puVar14[0x2a];
  uVar9 = puVar14[0x2b];
  puVar13[0x24] = uVar5;
  puVar13[0x25] = uVar6;
  puVar13[0x26] = uVar7;
  puVar13[0x27] = uVar8;
  uVar5 = puVar14[0x2c];
  uVar6 = puVar14[0x2d];
  uVar7 = puVar14[0x2e];
  uVar8 = puVar14[0x2f];
  puVar13[0x28] = uVar2;
  puVar13[0x29] = uVar3;
  puVar13[0x2a] = uVar4;
  puVar13[0x2b] = uVar9;
  uVar2 = puVar14[0x30];
  uVar3 = puVar14[0x31];
  uVar4 = puVar14[0x32];
  uVar9 = puVar14[0x33];
  puVar13[0x2c] = uVar5;
  puVar13[0x2d] = uVar6;
  puVar13[0x2e] = uVar7;
  puVar13[0x2f] = uVar8;
  uVar5 = puVar14[0x34];
  uVar6 = puVar14[0x35];
  uVar7 = puVar14[0x36];
  uVar8 = puVar14[0x37];
  puVar13[0x30] = uVar2;
  puVar13[0x31] = uVar3;
  puVar13[0x32] = uVar4;
  puVar13[0x33] = uVar9;
  puVar13[0x34] = uVar5;
  puVar13[0x35] = uVar6;
  puVar13[0x36] = uVar7;
  puVar13[0x37] = uVar8;
  *(undefined8 *)(puVar13 + 0x38) = uVar1;
  puVar13[0x3a] = puVar14[0x3a];
  lVar11 = 0;
  if (0 < param_3 * param_2) {
    do {
      lVar12 = lVar11;
      if ((*(char *)((longlong)&local_1510 + lVar11) == '\x01') &&
         (lVar12 = lVar11 + 1, *(char *)((longlong)&local_1510 + lVar11 + 1) != '\x01')) {
        *(undefined *)((longlong)&local_1510 + lVar11 + 1) = 1;
      }
      lVar11 = lVar12 + 1;
    } while (lVar11 < param_3 * param_2);
  }
  FUN_180005060(param_1,param_2,param_3,(byte *)&local_1510,local_res20);
  FUN_180023ef0(local_20 ^ (ulonglong)&stack0xffffffffffffeac0);
  return;
}



int FUN_18000cf00(longlong param_1,int param_2,int param_3,undefined8 param_4,int param_5)

{
  int iVar1;
  int iVar2;
  LPVOID pvVar3;
  
  if (param_5 == 0) {
    iVar2 = 0;
  }
  else {
    do {
      pvVar3 = TlsGetValue(DAT_180055088);
      iVar1 = (**(code **)(*(longlong *)((longlong)pvVar3 + -8) + 8))
                        ((longlong *)((longlong)pvVar3 + -8),param_1,param_3,param_2);
      iVar2 = 3;
      if (iVar1 != 0) {
        iVar2 = 0;
      }
      if (iVar2 != 0) {
        return iVar2;
      }
      param_1 = param_1 + param_2 * param_3;
      param_5 = param_5 + -1;
    } while (param_5 != 0);
  }
  return iVar2;
}



undefined4 FUN_18000cf90(undefined param_1,undefined param_2,undefined8 param_3)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x28))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2,param_3);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000cff0(undefined param_1,undefined8 param_2)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x10))
                    ((longlong)pvVar2 + -8,param_1,param_2);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000d040(void)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x88))((longlong)pvVar2 + -8);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000d080(undefined param_1,undefined param_2,undefined8 param_3)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x30))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2,param_3);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000d0e0(undefined param_1,undefined param_2)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x18))
                    ((longlong)pvVar2 + -8,param_1,param_2);  // Expected to call FUN_18001b290
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000d130(undefined param_1,undefined param_2,undefined8 param_3)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x40))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2,param_3);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000d190(undefined8 param_1,int param_2,int param_3)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x70))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2 * param_3);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_18000d1f0(undefined8 param_1,int param_2,int param_3)

{
  int iVar1;
  LPVOID pvVar2;
  undefined4 uVar3;
  
  pvVar2 = TlsGetValue(DAT_180055088);
  iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x78))
                    ((longlong *)((longlong)pvVar2 + -8),param_1,param_2 * param_3);
  uVar3 = 3;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}


// Sends sequence with middle being param_2, and probably last being (param_3 - 2)
undefined8 FUN_18000d250(undefined param_1,byte param_2,byte param_3)

{
  int iVar1;
  LPVOID pvVar2;
  int iVar3;
  byte local_res20 [8];
  
  iVar3 = 0;
  while( true ) {
    pvVar2 = TlsGetValue(DAT_180055088);
    // Quite similar to FUN_18000cff0(param_1, res)
    iVar1 = (**(code **)(*(longlong *)((longlong)pvVar2 + -8) + 0x10))
                      ((longlong)pvVar2 + -8,param_1,local_res20);
    if (iVar1 == 0) {
      return 3;
    }
    if ((local_res20[0] & param_3) == param_2) break;
    iVar3 = iVar3 + 1;
    if (2999 < iVar3) {
      return 3;
    }
  }
  return 0;
}



undefined ** FUN_18000d430(undefined **param_1)

{
  *(undefined4 *)(param_1 + 1) = 0;
  param_1[2] = (undefined *)0x0;
  param_1[3] = (undefined *)0x0;
  param_1[4] = (undefined *)0x0;
  param_1[5] = (undefined *)0x0;
  param_1[6] = (undefined *)0x0;
  *(undefined *)(param_1 + 7) = 0;
  *param_1 = (undefined *)&PTR_LAB_180045480;
  (**(code **)(*DAT_180056a00 + 8))();
  return param_1;
}



void FUN_18000d490(longlong param_1)

{
  longlong *plVar1;
  longlong *plVar2;
  
  plVar1 = DAT_180056a28;
  plVar2 = DAT_180056a20;
  if (DAT_180056a20 < DAT_180056a28) {
    do {
      if (*plVar2 != 0) {
        (**(code **)(*plVar2 + 0x38))(0);
        plVar1 = DAT_180056a28;
      }
      plVar2 = plVar2 + 1;
    } while (plVar2 < plVar1);
  }
  if (*(int *)(param_1 + 8) != 0) {
    if (*(longlong *)(param_1 + 0x10) != 0) {
      FUN_18000d700(param_1 + 8);
      *(undefined8 *)(param_1 + 0x10) = 0;
    }
    if (*(longlong **)(param_1 + 0x40) != (longlong *)0x0) {
      (**(code **)(**(longlong **)(param_1 + 0x40) + 0x10))();
    }
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x18));
    *(undefined4 *)(param_1 + 8) = 0;
  }
  return;
}



undefined ** FUN_18000d560(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)&PTR_LAB_180045480;
  *(undefined4 *)(param_1 + 1) = 0xc0000001;
  (**(code **)(*DAT_180056a00 + 0x10))();
  if (*(char *)(param_1 + 7) != '\0') {
    *(undefined *)(param_1 + 7) = 0;
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  }
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



undefined ** FUN_18000d5d0(undefined **param_1,uint param_2)

{
  *(undefined4 *)(param_1 + 1) = 0xc0000001;
  *param_1 = (undefined *)&PTR_LAB_1800452f8;
  if (*(char *)(param_1 + 7) != '\0') {
    *(undefined *)(param_1 + 7) = 0;
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  }
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



int FUN_18000d6d0(longlong param_1)

{
  int *piVar1;
  int iVar2;
  
  LOCK();
  piVar1 = (int *)(param_1 + 8);
  iVar2 = *piVar1;
  *piVar1 = *piVar1 + 1;
  if (iVar2 + 1 == 2) {
    (**(code **)(*DAT_180056a00 + 8))();
  }
  return iVar2 + 1;
}



void FUN_18000d700(longlong param_1)

{
  code **ppcVar1;
  code *pcVar2;
  code **_Memory;
  
  if (param_1 == 0) {
    RaiseException(0xc0000005,1,0,(ULONG_PTR *)0x0);
    pcVar2 = (code *)swi(3);
    (*pcVar2)();
    return;
  }
  _Memory = *(code ***)(param_1 + 8);
  while (_Memory != (code **)0x0) {
    (**_Memory)(_Memory[1]);
    ppcVar1 = (code **)_Memory[2];
    free(_Memory);
    _Memory = ppcVar1;
  }
  *(undefined8 *)(param_1 + 8) = 0;
  return;
}



HRESULT FUN_18000db80(longlong param_1,longlong **param_2)

{
  longlong **ppv;
  HRESULT HVar1;
  
  if (param_2 == (longlong **)0x0) {
    return -0x7fffbffd;
  }
  ppv = (longlong **)(param_1 + 0x40);
  HVar1 = 0;
  if ((*ppv == (longlong *)0x0) &&
     (HVar1 = CoCreateInstance((IID *)&DAT_180047628,(LPUNKNOWN)0x0,1,(IID *)&DAT_18004d6e0,ppv),
     HVar1 < 0)) {
    return HVar1;
  }
  *param_2 = *ppv;
  (**(code **)(**ppv + 8))();
  return HVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_18000dc00(void)

{
  BOOL BVar1;
  uint uVar2;
  
  if ((DAT_1800551c0 & 1) == 0) {
    DAT_1800551c0 = DAT_1800551c0 | 1;
    DAT_180055188 = 0;
    _DAT_1800551b8 = 0;
    BVar1 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)&DAT_180055190,0,0);
    if (BVar1 == 0) {
      uVar2 = GetLastError();
      if (0 < (int)uVar2) {
        uVar2 = uVar2 & 0xffff | 0x80070000;
      }
      _DAT_1800551b8 = _DAT_1800551b8 & 0xffffffff | (ulonglong)uVar2 << 0x20;
    }
    atexit(FUN_180033e90);
  }
  return (undefined *)&DAT_180055188;
}



undefined8 FUN_18000dc90(undefined8 param_1,int param_2)

{
  if (param_2 != 0) {
    (**(code **)(*DAT_180056a00 + 8))();
    return 0;
  }
  (**(code **)(*DAT_180056a00 + 0x10))();
  return 0;
}



int FUN_18000dd00(longlong *param_1)

{
  longlong *plVar1;
  int iVar2;
  int iVar3;
  
  LOCK();
  plVar1 = param_1 + 1;
  iVar2 = *(int *)plVar1;
  *(int *)plVar1 = *(int *)plVar1 + -1;
  iVar3 = iVar2 + -1;
  if (iVar3 == 0) {
    (**(code **)(*DAT_180056a00 + 8))();
    if (param_1 != (longlong *)0x0) {
      (**(code **)(*param_1 + 0x30))(param_1,iVar2);
    }
    (**(code **)(*DAT_180056a00 + 0x10))();
  }
  return iVar3;
}



int FUN_18000dd60(longlong *param_1)

{
  longlong *plVar1;
  int iVar2;
  int iVar3;
  
  LOCK();
  plVar1 = param_1 + 1;
  iVar2 = *(int *)plVar1;
  *(int *)plVar1 = *(int *)plVar1 + -1;
  iVar3 = iVar2 + -1;
  if (iVar3 == 0) {
    if (param_1 != (longlong *)0x0) {
      (**(code **)(*param_1 + 0x28))(param_1,iVar2);
      return 0;
    }
  }
  else {
    if (iVar3 == 1) {
      (**(code **)(*DAT_180056a00 + 0x10))();
    }
  }
  return iVar3;
}



// WARNING: Removing unreachable block (ram,0x00018000d7a9)

HRESULT DllGetClassObject(IID *rclsid,IID *riid,LPVOID *ppv)

{
  ulong **ppuVar1;
  ulong *puVar2;
  PVOID *ppvVar3;
  ulong **ppuVar4;
  int iVar5;
  PVOID pvVar6;
  code **ppcVar7;
  PVOID local_res20;
  
  if (ppv == (LPVOID *)0x0) {
    return -0x7fffbffd;
  }
  iVar5 = 0;
  *ppv = (LPVOID)0x0;
  ppuVar4 = DAT_180056a20;
  if (DAT_180056a10 == 0) {
    return -0x7fff0001;
  }
  while( true ) {
    if (DAT_180056a28 <= ppuVar4) {
      return -0x7ffbfeef;
    }
    ppuVar1 = (ulong **)*ppuVar4;
    if ((((ppuVar1 != (ulong **)0x0) && (ppuVar1[2] != (ulong *)0x0)) &&
        (puVar2 = *ppuVar1, rclsid->Data1 == *puVar2)) &&
       (((*(ulong *)&rclsid->Data2 == puVar2[1] && (*(ulong *)rclsid->Data4 == puVar2[2])) &&
        (*(ulong *)(rclsid->Data4 + 4) == puVar2[3])))) break;
    ppuVar4 = ppuVar4 + 1;
  }
  ppvVar3 = (PVOID *)ppuVar1[4];
  pvVar6 = *ppvVar3;
  if (pvVar6 == (PVOID)0x0) {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180056a30);
    if (*ppvVar3 == (PVOID)0x0) {
      local_res20 = (PVOID)0x0;
      iVar5 = (*(code *)ppuVar1[2])(ppuVar1[3],&DAT_18004d6d0,&local_res20);
      if (-1 < iVar5) {
        pvVar6 = EncodePointer(local_res20);
        *ppvVar3 = pvVar6;
      }
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180056a30);
    pvVar6 = *ppvVar3;
    if (pvVar6 == (PVOID)0x0) goto LAB_18000d8a6;
  }
  ppcVar7 = (code **)DecodePointer(pvVar6);
  iVar5 = (**(code **)*ppcVar7)(ppcVar7,riid,ppv);
LAB_18000d8a6:
  if (*ppv != (LPVOID)0x0) {
    return iVar5;
  }
  if (iVar5 == 0) {
    return -0x7ffbfeef;
  }
  return iVar5;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18000dde0(HMODULE param_1,int param_2)

{
  if (param_2 == 1) {
    DAT_1800550e8 = &DAT_180045240;
    _DAT_180055100 = 0;
    PTR_LOOP_1800537c8 = (undefined *)&DAT_1800550f0;
    DAT_1800550f0 = 0;
    _DAT_180055108 = 1;
    FUN_18000df80();
    DAT_180055138 = param_1;
    DisableThreadLibraryCalls(param_1);
    if (DAT_1800569f9 != '\0') {
      return 0;
    }
  }
  else {
    if (param_2 == 0) {
      FUN_18000de80();
    }
  }
  return 1;
}



void FUN_18000de80(void)

{
  longlong *plVar1;
  
  if (PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) {
    plVar1 = (longlong *)PTR_LOOP_1800537c8;
    if (PTR_LOOP_1800537c8 != (undefined **)0x0) {
      do {
        if (plVar1[1] != 0) {
          UnregisterTraceGuids();
          plVar1[1] = 0;
        }
        plVar1 = (longlong *)*plVar1;
      } while (plVar1 != (longlong *)0x0);
    }
    PTR_LOOP_1800537c8 = &PTR_LOOP_1800537c8;
  }
  return;
}



undefined8 FUN_18000def0(int param_1,longlong param_2,undefined4 *param_3,undefined8 param_4)

{
  undefined uVar1;
  undefined4 uVar2;
  undefined8 /* TraceHandle */ uVar3;
  
  uVar3 = 0;
  *param_3 = 0;
  if (param_1 == 4) {
    uVar3 = GetTraceLoggerHandle(param_4);
    uVar1 = GetTraceEnableLevel(uVar3);
    uVar2 = GetTraceEnableFlags(uVar3);
  }
  else {
    if (param_1 != 5) {
      return 0x57;
    }
    uVar2 = 0;
    uVar1 = 0;
  }
  if (((*(byte *)(param_2 + 0x1a) & 2) != 0) && (*(longlong *)(param_2 + 0x10) != 0)) {
    param_2 = *(longlong *)(param_2 + 0x10);
  }
  *(undefined *)(param_2 + 0x19) = uVar1;
  *(undefined8 *)(param_2 + 0x10) = uVar3;
  *(undefined4 *)(param_2 + 0x1c) = uVar2;
  return 0;
}



void FUN_18000df80(void)

{
  longlong *plVar1;
  longlong *plVar2;
  longlong local_18;
  undefined8 local_10;
  
  plVar2 = &DAT_1800550e8;
  plVar1 = (longlong *)PTR_LOOP_1800537c8;
  if (PTR_LOOP_1800537c8 != (undefined *)0x0) {
    do {
      local_18 = *plVar2;
      local_10 = 0;
      plVar2 = plVar2 + 1;
      plVar1[4] = local_18;
      RegisterTraceGuidsW(FUN_18000def0,plVar1,local_18,1,&local_18,0,0,plVar1 + 1);
      plVar1 = (longlong *)*plVar1;
    } while (plVar1 != (longlong *)0x0);
  }
  return;
}



DWORD FUN_18000e010(undefined8 param_1,longlong *param_2,longlong *param_3)

{
  DWORD DVar1;
  ulonglong uVar2;
  undefined *local_res20;
  
  DVar1 = FUN_18000e5e0(param_2,param_3,&local_res20);
  if (-1 < (int)DVar1) {
    uVar2 = FUN_18000e260(local_res20);
    DVar1 = (DWORD)uVar2;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 1) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),10,&DAT_180045500);
  }
  return DVar1;
}



void FUN_18000e080(undefined8 param_1,undefined2 param_2,undefined8 param_3)

{
  // 0x2b = TRACE_MESSAGE_SEQUENCE | TRACE_MESSAGE_GUID | TRACE_MESSAGE_TIMESTAMP | TRACE_MESSAGE_SYSTEMINFO
  TraceMessage(param_1,0x2b,param_3,param_2,0);
  return;
}


undefined ** FUN_18000e0a0(undefined **param_1)

{
  *(undefined4 *)(param_1 + 3) = 0;
  param_1[4] = (undefined *)0x0;
  param_1[5] = (undefined *)0x0;
  param_1[6] = (undefined *)0x0;
  param_1[7] = (undefined *)0x0;
  param_1[8] = (undefined *)0x0;
  *(undefined *)(param_1 + 9) = 0;
  param_1[10] = (undefined *)0x0;
  param_1[0xb] = (undefined *)0x0;
  param_1[0xc] = (undefined *)0x0;
  param_1[0xd] = (undefined *)0x0;
  param_1[0xe] = (undefined *)0x0;
  param_1[0xf] = (undefined *)0x0;
  param_1[0x10] = (undefined *)0x0;
  param_1[0x11] = (undefined *)0x0;
  param_1[0x12] = (undefined *)0x0;
  *param_1 = (undefined *)&PTR_LAB_180045770;
  param_1[1] = (undefined *)&PTR_LAB_180045798;
  param_1[2] = (undefined *)&PTR_LAB_1800457d8;
  (**(code **)(*DAT_180056a00 + 8))();
  return param_1;
}



void FUN_18000e140(undefined **param_1)

{
  *param_1 = (undefined *)&PTR_LAB_180045630;
  param_1[1] = (undefined *)&PTR_LAB_180045650;
  param_1[2] = (undefined *)&PTR_LAB_180045690;
  if ((longlong *)param_1[0x11] != (longlong *)0x0) {
    (**(code **)(*(longlong *)param_1[0x11] + 0x10))();
  }
  if (*(char *)(param_1 + 9) != '\0') {
    *(undefined *)(param_1 + 9) = 0;
                    // WARNING: Could not recover jumptable at 0x00018000e19c. Too many branches
                    // WARNING: Treating indirect jump as call
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 4));
    return;
  }
  return;
}



undefined ** FUN_18000e1b0(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)&PTR_LAB_180045770;
  param_1[1] = (undefined *)&PTR_LAB_180045798;
  param_1[2] = (undefined *)&PTR_LAB_1800457d8;
  *(undefined4 *)(param_1 + 3) = 0xc0000001;
  (**(code **)(*DAT_180056a00 + 0x10))();
  FUN_18000e140(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_18000e260(undefined *param_1)

{
  DWORD DVar1;
  int iVar2;
  LSTATUS LVar3;
  ulonglong uVar4;
  undefined2 uVar5;
  undefined4 uVar6;
  longlong *local_res8;
  DWORD local_res10 [2];
  longlong *local_res18;
  HKEY local_res20;
  undefined8 local_58;
  ulonglong local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined *local_38;
  
  *(undefined4 *)(param_1 + 0x94) = 2;
  DVar1 = FUN_18001d040(*(longlong **)(param_1 + 0x50),param_1,(undefined **)(param_1 + 0x58));
  uVar6 = 0;
  local_res18 = (longlong *)0x0;
  uVar4 = (ulonglong)DVar1;
  if (-1 < (int)DVar1) {
    uVar4 = 0;
  }
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  iVar2 = (**(code **)**(code ***)(param_1 + 0x50))
                    (*(code ***)(param_1 + 0x50),&DAT_180045810,&local_res18);
  if (iVar2 < 0) {
LAB_18000e3bc:
    if ((short)local_58 != 0) goto LAB_18000e476;
  }
  else {
    local_res8 = (longlong *)0x0;
    local_40 = 0x18;
    local_38 = &DAT_180045628;
    iVar2 = (**(code **)(*local_res18 + 0x18))(local_res18,&local_40,0,0x20019,0,&local_res8,0);
    if (-1 < iVar2) {
      iVar2 = (**(code **)(*local_res8 + 0x18))(local_res8,L"IgnoreOTA",&local_58);
      if (-1 < iVar2) {
        if (((short)local_58 != 0) && ((int)local_50 != 0)) {
          uVar6 = 1;
        }
        *(undefined4 *)(param_1 + 0x78) = uVar6;
      }
      (**(code **)(*local_res8 + 0x18))(local_res8,L"LowerIoInterface",&local_58);
      (**(code **)(*local_res8 + 0x10))();
    }
    (**(code **)(*local_res18 + 0x10))();
    if ((int)local_50 != 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        uVar5 = 0xf;
LAB_18000e3ac:
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar5,&DAT_180045550);
      }
      goto LAB_18000e3bc;
    }
    if ((short)local_58 != 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        uVar5 = 0x10;
        goto LAB_18000e3ac;
      }
      goto LAB_18000e3bc;
    }
  }
  LVar3 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                        L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WUDF\\Services\\EgisTouchFP0575"
                        ,0,0x20019,(PHKEY)&local_res20);
  if (LVar3 == 0) {
    local_res10[0] = 4;
    LVar3 = RegQueryValueExW(local_res20,L"LowerIoInterface",(LPDWORD)0x0,(LPDWORD)0x0,
                             (LPBYTE)&local_res8,local_res10);
    RegCloseKey(local_res20);
    if ((LVar3 == 0) && ((uint)local_res8 != 0)) {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 2) != 0 && (3 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x11,&DAT_180045550);
      }
      local_50 = local_50 & 0xffffffff00000000 | (ulonglong)(uint)local_res8;
      local_58 = CONCAT62(local_58._2_6_,0x13);
    }
  }
LAB_18000e476:
  if ((int)local_50 == 0) {
    if (-1 < (int)uVar4) {
      DVar1 = FUN_180021790(*(undefined ***)(param_1 + 0x50),(longlong)param_1,
                            (longlong **)(param_1 + 0x88));
      uVar4 = (ulonglong)DVar1;
    }
  }
  else {
    uVar4 = (**(code **)(**(longlong **)(param_1 + 0x50) + 0x78))
                      (*(longlong **)(param_1 + 0x50),&DAT_180045230,0);
    if ((-1 < (int)uVar4) &&
       (uVar4 = (**(code **)(**(longlong **)(param_1 + 0x50) + 0x80))
                          (*(longlong **)(param_1 + 0x50),&DAT_180045230,0,1), -1 < (int)uVar4)) {
      *(undefined4 *)(param_1 + 0x74) = 1;
      return uVar4;
    }
  }
  return uVar4;
}



DWORD FUN_18000e4f0(longlong **param_1)

{
  BOOL BVar1;
  undefined **ppuVar2;
  DWORD DVar3;
  
  if (param_1 == (longlong **)0x0) {
    return 0x80004003;
  }
  *param_1 = (longlong *)0x0;
  DVar3 = 0x8007000e;
  ppuVar2 = (undefined **)FUN_1800251c0(0x98);
  if (ppuVar2 == (undefined **)0x0) {
    ppuVar2 = (undefined **)0x0;
  }
  else {
    ppuVar2 = FUN_18000e0a0(ppuVar2);
  }
  if (ppuVar2 == (undefined **)0x0) goto LAB_18000e5c3;
  DVar3 = 0;
  BVar1 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(ppuVar2 + 4),0,0);
  if (BVar1 == 0) {
    DVar3 = GetLastError();
    if (0 < (int)DVar3) {
      DVar3 = DVar3 & 0xffff | 0x80070000;
    }
    if (-1 < (int)DVar3) goto LAB_18000e5a6;
  }
  else {
LAB_18000e5a6:
    *(undefined *)(ppuVar2 + 9) = 1;
    if (-1 < (int)DVar3) {
      DVar3 = 0;
      goto LAB_18000e5c3;
    }
  }
  (**(code **)(*ppuVar2 + 0x20))(ppuVar2,1);
  ppuVar2 = (undefined **)0x0;
LAB_18000e5c3:
  *param_1 = (longlong *)ppuVar2;
  return DVar3;
}



DWORD FUN_18000e5e0(longlong *param_1,longlong *param_2,undefined **param_3)

{
  undefined **ppuVar1;
  DWORD DVar2;
  undefined **local_res20;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),10,&DAT_180045550);
  }
  local_res20 = (undefined **)0x0;
  DVar2 = FUN_18000e4f0((longlong **)&local_res20);
  ppuVar1 = local_res20;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_180023a10(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xb,&DAT_180045550,local_res20);
  }
  if (-1 < (int)DVar2) {
    DVar2 = FUN_18000e7f0(ppuVar1,param_1,param_2);
    *param_3 = (undefined *)ppuVar1;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xc,&DAT_180045550);
  }
  return DVar2;
}



undefined8 FUN_18000e6f0(longlong param_1,longlong param_2)

{
  ushort uVar1;
  LPCWSTR lpString;
  int iVar2;
  LPWSTR pWVar3;
  
  lpString = *(LPCWSTR *)(*(longlong *)(param_1 + 0x60) + 0x60);
  if (lpString != (LPCWSTR)0x0) {
    iVar2 = lstrlenW(lpString);
    if (iVar2 < 0x100) {
      lstrcpyW((LPWSTR)(param_2 + 0x41c),*(LPCWSTR *)(*(longlong *)(param_1 + 0x60) + 0x60));
    }
  }
  uVar1 = *(ushort *)(*(longlong *)(param_1 + 0x60) + 0x54);
  if (0x103f < (uVar1 & 0xfff0)) {
    *(uint *)(param_2 + 0x61c) = (uint)(uVar1 >> 0xc);
    *(uint *)(param_2 + 0x620) = *(ushort *)(*(longlong *)(param_1 + 0x60) + 0x54) >> 8 & 0xf;
    pWVar3 = StrStrIW((LPCWSTR)(param_2 + 0x21c),L" Rev");
    if (pWVar3 == (LPWSTR)0x0) {
      iVar2 = lstrlenW((LPCWSTR)(param_2 + 0x21c));
      wsprintfW((LPWSTR)(param_2 + ((longlong)iVar2 + 0x10e) * 2),L" Rev%d");
    }
    return 0;
  }
  return 0;
}



int FUN_18000e7f0(undefined **param_1,longlong *param_2,longlong *param_3)

{
  int iVar1;
  longlong *local_res18;
  code **local_res20;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xd,&DAT_180045550);
  }
  local_res20 = (code **)0x0;
  local_res18 = (longlong *)0x0;
  (**(code **)(*param_3 + 0x20))(param_3,1);
  (**(code **)(*param_3 + 0x30))(param_3,0);
  iVar1 = (**(code **)*param_1)(param_1,&DAT_18004d6d0,&local_res18);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_2 + 0x40))(param_2,param_3,local_res18,&local_res20);
    if (local_res18 != (longlong *)0x0) {
      (**(code **)(*local_res18 + 0x10))();
    }
    local_res18 = (longlong *)0x0;
    if (-1 < iVar1) {
      iVar1 = (**(code **)*local_res20)(local_res20,&DAT_180045800,param_1 + 10);
      if (-1 < iVar1) {
        (**(code **)(*(longlong *)param_1[10] + 0x10))();
      }
      if (local_res20 != (code **)0x0) {
        (**(code **)(*local_res20 + 0x10))();
      }
      local_res20 = (code **)0x0;
    }
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xe,&DAT_180045550);
  }
  return iVar1;
}



void FUN_18000e930(longlong param_1,longlong *param_2,undefined8 param_3,undefined **param_4)

{
  int iVar1;
  longlong *local_res10;
  longlong *local_res20;
  undefined8 local_28 [2];
  
  local_res10 = (longlong *)0x0;
  local_res20 = (longlong *)0x0;
  local_28[0] = 0;
  iVar1 = (**(code **)(*param_4 + 0x18))(param_4);
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 2) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1f,&DAT_180045550,iVar1);
  }
  if (iVar1 < 0) {
    *(int *)(param_1 + 0x70) = iVar1;
  }
  else {
    iVar1 = (**(code **)*param_4)(param_4,&DAT_180045a08,&local_res10);
    if ((iVar1 < 0) || (local_res10 == (longlong *)0x0)) {
      DebugBreak();
    }
    (**(code **)(*local_res10 + 0x48))(local_res10,&local_res20,local_28,0);
  }
  (**(code **)(*param_2 + 0x18))(param_2);
  if (local_res10 != (longlong *)0x0) {
    (**(code **)(*local_res10 + 0x10))();
  }
  local_res10 = (longlong *)0x0;
  if (local_res20 != (longlong *)0x0) {
    (**(code **)(*local_res20 + 0x10))();
  }
  return;
}



undefined8 FUN_18000ea30(longlong param_1,undefined8 param_2,int param_3)

{
  ULONGLONG UVar1;
  
  if (*(int *)(param_1 + 0x6c) == 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x22,&DAT_180045550,param_3,
                    (char)*(undefined4 *)(*(longlong *)(param_1 + 0x80) + 0xdc));
    }
    if ((*(int *)(param_1 + 0x88) == 3) ||
       ((1 < *(int *)(param_1 + 0x88) && (*(int *)(*(longlong *)(param_1 + 0x58) + 0x44) == 4)))) {
      UVar1 = GetTickCount64();
      *(ULONGLONG *)(*(longlong *)(param_1 + 0x80) + 0xc0) = UVar1;
      *(undefined4 *)(*(longlong *)(param_1 + 0x80) + 200) = *(undefined4 *)(param_1 + 0x88);
    }
    FUN_1800204d0(*(longlong **)(param_1 + 0x60),param_3,1,1);
    if (1 < *(int *)(param_1 + 0x88)) {
      FUN_18001dc40(*(longlong *)(param_1 + 0x50));
    }
    *(undefined4 *)(param_1 + 0x88) = 0;
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x23,&DAT_180045550,param_3,
                    (char)*(undefined4 *)(*(longlong *)(param_1 + 0x80) + 0xdc));
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x20,&DAT_180045550,param_3);
    }
    if (1 < *(int *)(param_1 + 0x88)) {
      FUN_18001dc40(*(longlong *)(param_1 + 0x50));
    }
    *(undefined4 *)(param_1 + 0x88) = 0;
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x21,&DAT_180045550,param_3);
      return 0;
    }
  }
  return 0;
}



void FUN_18000ee50(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  uint local_res10 [2];
  longlong *local_res18;
  ulonglong local_res20;
  
  local_res18 = (longlong *)0x0;
  (**(code **)(*param_2 + 0x88))(param_2,&local_res18);
  if (local_res18 == (longlong *)0x0) {
    iVar1 = -0x7ff8ffa9;
  }
  else {
    uVar2 = (**(code **)(*local_res18 + 0x60))(local_res18,&local_res20);
    (**(code **)(*local_res18 + 0x10))();
    local_res10[0] = (uint)(local_res20 >> 1);
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x50) + 0x50))
                      (*(longlong **)(param_1 + 0x50),uVar2,local_res10);
    if (-1 < iVar1) {
      (**(code **)(*param_2 + 0x40))(param_2,0,(ulonglong)local_res10[0] * 2);
      return;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,iVar1);
  return;
}



void FUN_18000ef00(longlong param_1,undefined **param_2)

{
  int iVar1;
  longlong *plVar2;
  undefined4 local_res10;
  int local_res18 [2];
  longlong *local_res20;
  int iVar3;
  longlong local_58;
  longlong *local_50;
  longlong *local_48;
  longlong local_40;
  longlong *local_38 [2];
  
  FUN_18001ecf0((longlong *)param_2,local_res18,&local_50,&local_40,&local_res20,&local_58);
  iVar1 = -0x7ff8ffa9;
  local_res10 = 0;
  if (local_res18[0] == 0x222018) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2e,&DAT_180045550);
    }
    if ((local_res20 != (longlong *)0x0) && (local_58 != 0)) {
      iVar1 = 0;
      plVar2 = local_res20;
LAB_18000f26c:
      iVar3 = 1;
LAB_18000f274:
      iVar1 = FUN_18001e2a0(*(longlong ***)(param_1 + 0x60),(longlong *)param_2,plVar2,0,iVar3,iVar1
                            ,0,(longlong *)&local_res10);
    }
  }
  else {
    if (local_res18[0] == 0x22201c) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2f,&DAT_180045550);
      }
      if (local_50 == (longlong *)0x0) goto LAB_18000f297;
      if (local_40 != 0) {
        iVar1 = 1;
        plVar2 = local_50;
        goto LAB_18000f26c;
      }
    }
    else {
      if (local_res18[0] == 0x222020) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x30,&DAT_180045550);
        }
LAB_18000f17f:
        if ((local_res20 != (longlong *)0x0) && (local_58 != 0)) {
          iVar1 = 0;
          iVar3 = 0;
          plVar2 = local_res20;
          goto LAB_18000f274;
        }
      }
      else {
        if (local_res18[0] == 0x222024) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x31,&DAT_180045550);
          }
          if (local_50 == (longlong *)0x0) goto LAB_18000f297;
          if (local_40 != 0) {
            iVar1 = 1;
            iVar3 = 0;
            plVar2 = local_50;
            goto LAB_18000f274;
          }
        }
        else {
          if (local_res18[0] == 0x222028) {
            if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
              FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x32,&DAT_180045550);
            }
            if ((local_50 == (longlong *)0x0) || (local_40 == 0)) goto LAB_18000f17f;
            iVar1 = FUN_18001e2a0(*(longlong ***)(param_1 + 0x60),(longlong *)param_2,local_50,0,1,1
                                  ,0,(longlong *)&local_res10);
            if (((-1 < iVar1) && (local_res20 != (longlong *)0x0)) && (local_58 != 0)) {
              iVar1 = (**(code **)*param_2)(param_2,&DAT_180045a18,local_38);
              if (iVar1 < 0) {
                iVar1 = (**(code **)(**(longlong **)(param_1 + 0x50) + 0xb8))
                                  (*(longlong **)(param_1 + 0x50),0,0);
              }
              else {
                (**(code **)(*local_38[0] + 0xf8))(local_38[0],0);
                local_48 = local_38[0];
              }
              if (-1 < iVar1) {
                iVar1 = FUN_18001e2a0(*(longlong ***)(param_1 + 0x60),local_48,local_res20,0,1,0,0,
                                      (longlong *)&local_res10);
                (**(code **)(*local_48 + 0x10))();
              }
            }
          }
          else {
            if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
              FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x33,&DAT_180045550,
                            local_res18[0]);
            }
            iVar1 = -0x7fffbffb;
          }
        }
      }
    }
  }
  if (local_50 != (longlong *)0x0) {
    (**(code **)(*local_50 + 0x10))();
  }
LAB_18000f297:
  if (local_res20 != (longlong *)0x0) {
    (**(code **)(*local_res20 + 0x10))();
  }
  (**(code **)(*param_2 + 0x40))(param_2,iVar1,local_res10);
  return;
}



undefined8 FUN_18000fb60(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2c,&DAT_180045550);
  }
  *(undefined4 *)(param_1 + 0x8c) = 4;
  if (((*(longlong *)(param_1 + 0x60) != 0) && (*(longlong *)(param_1 + 0x80) != 0)) &&
     (*(longlong *)(*(longlong *)(param_1 + 0x80) + 0x78) != 0)) {
    FUN_18001f680(*(longlong *)(param_1 + 0x60),4);
    WaitForSingleObject(*(HANDLE *)(*(longlong *)(param_1 + 0x80) + 0xb0),0xffffffff);
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2d,&DAT_180045550);
  }
  return 0;
}



undefined8 FUN_18000fc30(longlong param_1)

{
  code **ppcVar1;
  void *_Memory;
  
  if (*(int *)(param_1 + 0x84) < 5) {
    FUN_18001dd70(*(longlong *)(param_1 + 0x50),1);
  }
  *(undefined4 *)(param_1 + 0x84) = 6;
  if (((*(longlong *)(param_1 + 0x58) != 0) && (*(longlong *)(param_1 + 0x78) != 0)) &&
     (*(longlong *)(*(longlong *)(param_1 + 0x78) + 0x78) != 0)) {
    FUN_18001f680(*(longlong *)(param_1 + 0x58),4);
    WaitForSingleObject(*(HANDLE *)(*(longlong *)(param_1 + 0x78) + 0xb0),0xffffffff);
  }
  if (*(longlong *)(param_1 + 0x58) != 0) {
    FUN_180006a50((LPCRITICAL_SECTION *)(*(longlong *)(param_1 + 0x58) + 0x10));
    if (*(int *)(param_1 + 0x6c) != 0) {
      (**(code **)(**(longlong **)(param_1 + 0x58) + 0x40))();
    }
    ppcVar1 = *(code ***)(param_1 + 0x58);
    if (ppcVar1 != (code **)0x0) {
      (**(code **)*ppcVar1)(ppcVar1,1);
    }
    *(undefined8 *)(param_1 + 0x58) = 0;
  }
  _Memory = *(void **)(param_1 + 0x50);
  if (_Memory != (void *)0x0) {
    FUN_18001dd30((longlong)_Memory);
    free(_Memory);
    *(undefined8 *)(param_1 + 0x50) = 0;
  }
  if (*(longlong *)(param_1 + 0x78) != 0) {
    FUN_180021990(*(longlong *)(param_1 + 0x78));
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1e,&DAT_180045550);
  }
  return 0;
}



void FUN_18000fd50(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x28,&DAT_180045550);
  }
  if (*(int *)(param_1 + 0x8c) < 5) {
    FUN_18001dd70(*(longlong *)(param_1 + 0x58),1);
  }
  *(undefined4 *)(param_1 + 0x8c) = 5;
  if (((*(longlong *)(param_1 + 0x60) != 0) && (*(longlong *)(param_1 + 0x80) != 0)) &&
     (*(longlong *)(*(longlong *)(param_1 + 0x80) + 0x78) != 0)) {
    FUN_18001f680(*(longlong *)(param_1 + 0x60),4);
    WaitForSingleObject(*(HANDLE *)(*(longlong *)(param_1 + 0x80) + 0xb0),0xffffffff);
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x29,&DAT_180045550);
  }
  return;
}



int FUN_18000fe60(longlong *param_1)

{
  longlong *plVar1;
  int iVar2;
  int iVar3;
  
  LOCK();
  plVar1 = param_1 + 3;
  iVar2 = *(int *)plVar1;
  *(int *)plVar1 = *(int *)plVar1 + -1;
  iVar3 = iVar2 + -1;
  if (iVar3 == 0) {
    (**(code **)(*DAT_180056a00 + 8))();
    if (param_1 != (longlong *)0x0) {
      (**(code **)(*param_1 + 0x20))(param_1,iVar2);
    }
    (**(code **)(*DAT_180056a00 + 0x10))();
  }
  return iVar3;
}



void FUN_18000fed0(longlong param_1,int param_2)

{
  longlong lVar1;
  
  lVar1 = *(longlong *)(param_1 + 0x58);
  if (param_2 == 0) {
    FUN_18001dbf0(lVar1);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x50));
  *(int *)(lVar1 + 0x78) = *(int *)(lVar1 + 0x78) + 1;  // A counter maybe
  SetEvent(*(HANDLE *)(lVar1 + 0x88));
                    // WARNING: Could not recover jumptable at 0x00018001d315. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x50));
  return;
}



void FUN_18000fef0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
  return;
}



void FUN_18000ff30(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4)

{
  longlong lVar1;
  longlong lVar2;
  
  if (param_4 == (wchar_t *)0x0) {
    lVar2 = 10;
    param_4 = L"NULL";
  }
  else {
    if (*param_4 == L'\0') {
      lVar2 = 0xe;
      param_4 = L"<NULL>";
    }
    else {
      lVar2 = -1;
      do {
        lVar1 = lVar2 + 1;
        lVar2 = lVar2 + 1;
      } while (param_4[lVar1] != L'\0');
      lVar2 = lVar2 * 2 + 2;
      if (*param_4 == L'\0') {
        param_4 = L"<NULL>";
      }
    }
  }
  TraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar2,0);
  return;
}



void FUN_18000ffc0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
  return;
}



void FUN_180010010(void **param_1,int param_2,void *param_3,int param_4)

{
  code *pcVar1;
  void *pvVar2;
  
  if (param_1 == (void **)0x0) {
    FUN_1800047e0(0x80070057);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_2 < 0) {
    FUN_1800047e0(0x80070057);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  if (param_3 == (void *)0x0) {
    FUN_1800047e0(0x80070057);
    pcVar1 = (code *)swi(3);
    (*pcVar1)();
    return;
  }
  pvVar2 = *param_1;
  if (pvVar2 == param_3) {
    if (param_2 <= param_4) {
      *param_1 = param_3;
      goto LAB_180010074;
    }
    pvVar2 = calloc((longlong)param_2,2);
  }
  else {
    if (param_2 <= param_4) {
      free(pvVar2);
      *param_1 = param_3;
      goto LAB_180010074;
    }
    pvVar2 = _recalloc(pvVar2,(longlong)param_2,2);
    if (pvVar2 == (void *)0x0) {
      FUN_1800047e0(0x8007000e);
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
  }
  *param_1 = pvVar2;
LAB_180010074:
  if (*param_1 != (void *)0x0) {
    return;
  }
  FUN_1800047e0(0x8007000e);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800100c0(wchar_t *param_1,wchar_t *param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res18;
  undefined8 local_res20;
  
  local_res18 = param_3;
  local_res20 = param_4;
  FUN_180025de0(param_1,0x104,param_2,(va_list)&local_res18);
  return;
}



undefined ** FUN_1800100f0(undefined **param_1,undefined *param_2,undefined *param_3)

{
  undefined **ppuVar1;
  undefined *puVar2;
  
  FUN_18001f400(param_1,param_2,param_3);
  *param_1 = (undefined *)&PTR_FUN_180045bc0;
  *(undefined4 *)(param_1 + 0x87a) = 0x80;
  *(undefined8 *)((longlong)param_1 + 0x43d4) = 0x80;
  *(undefined4 *)((longlong)param_1 + 0x43dc) = 0;
  *(undefined4 *)(param_1 + 0x87c) = 0x7f;
  *(undefined4 *)((longlong)param_1 + 0x43e4) = 0x7f;
  *(undefined4 *)(param_1 + 0x87d) = 1;
  *(undefined *)((longlong)param_1 + 0x43ec) = 0xd;
  *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
  param_1[0x8c4] = (undefined *)0x0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (2 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1d,&DAT_180045a70);
  }
  *(undefined4 *)(param_1 + 0x879) = 0x53494745;
  *(undefined2 *)((longlong)param_1 + 0x43cc) = 0;
  *(undefined *)((longlong)param_1 + 0x43ce) = 0;
  param_1[0x878] = (undefined *)0x0;
  *(undefined4 *)(param_1 + 0x872) = 0x80000000;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x873));
  FUN_1800244a0((undefined (*) [16])((longlong)param_1 + 0x43ee),0,0x200);
  *(undefined4 *)((longlong)param_1 + 0x43ee) = 0x690046;
  *(undefined4 *)((longlong)param_1 + 0x43f2) = 0x67006e;
  *(undefined4 *)((longlong)param_1 + 0x43f6) = 0x720065;
  *(undefined4 *)((longlong)param_1 + 0x43fa) = 0x720070;
  *(undefined4 *)((longlong)param_1 + 0x43fe) = 0x6e0069;
  *(undefined4 *)((longlong)param_1 + 0x4402) = 0x200074;
  *(undefined4 *)((longlong)param_1 + 0x4406) = 0x540045;
  *(undefined4 *)((longlong)param_1 + 0x440a) = 0x300033;
  *(undefined4 *)((longlong)param_1 + 0x440e) = 0x30;
  ppuVar1 = (undefined **)operator_new(0x60);
  if (ppuVar1 == (undefined **)0x0) {
    ppuVar1 = (undefined **)0x0;
  }
  else {
    *ppuVar1 = (undefined *)&PTR_LAB_180045ae8;
    InitializeCriticalSection((LPCRITICAL_SECTION)(ppuVar1 + 2));
    ppuVar1[7] = &LAB_18001f940;
    ppuVar1[8] = (undefined *)param_1;
    *(undefined4 *)(ppuVar1 + 1) = 0;
    *ppuVar1 = (undefined *)&PTR_LAB_180045b50;
    *(undefined4 *)(ppuVar1 + 9) = 1;
    *(undefined4 *)((longlong)ppuVar1 + 0x4c) = 0x53494745;
  }
  param_1[0x8c5] = (undefined *)ppuVar1;
  *(undefined4 *)(param_1 + 99) = 0x4000;
  puVar2 = (undefined *)LocalAlloc(0x40,0x4000);
  param_1[0x62] = puVar2;
  return param_1;
}



void FUN_1800102d0(undefined **param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  code **ppcVar1;
  
  *param_1 = (undefined *)&PTR_FUN_180045bc0;
  if ((longlong *)param_1[0x8c4] != (longlong *)0x0) {
    (**(code **)(*(longlong *)param_1[0x8c4] + 0x10))();
    param_1[0x8c4] = (undefined *)0x0;
  }
  if (param_1[0x62] != (undefined *)0x0) {
    LocalFree(param_1[0x62]);
    param_1[0x62] = (undefined *)0x0;
  }
  ppcVar1 = (code **)param_1[0x8c5];
  if (ppcVar1 != (code **)0x0) {
    (**(code **)*ppcVar1)(ppcVar1,1);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x873));
  FUN_18001f5b0(param_1);
  return;
}



void FUN_180010360(undefined **param_1)

{
  longlong *plVar1;
  undefined *ho;
  longlong *plVar2;
  
  *param_1 = (undefined *)&PTR_LAB_180045ae0;
  ho = param_1[1];
  if (ho != (undefined *)0x0) {
    param_1[1] = (undefined *)0x0;
    param_1[2] = (undefined *)0x0;
    param_1[3] = (undefined *)0x0;
    param_1[4] = (undefined *)0x0;
    *(undefined8 *)((longlong)param_1 + 0x2c) = 0xffffffffffffffff;
    *(undefined2 *)(param_1 + 5) = 0;
    DeleteObject(ho);
  }
  plVar2 = (longlong *)FUN_18000dc00();
  EnterCriticalSection((LPCRITICAL_SECTION)(plVar2 + 1));
  plVar1 = plVar2 + 6;
  *(int *)plVar1 = *(int *)plVar1 + -1;
  if (*(int *)plVar1 == 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(plVar2 + 1));
    if (*plVar2 != 0) {
      GdiplusShutdown();
    }
    *plVar2 = 0;
    LeaveCriticalSection((LPCRITICAL_SECTION)(plVar2 + 1));
  }
                    // WARNING: Could not recover jumptable at 0x0001800103f7. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(plVar2 + 1));
  return;
}



undefined **
FUN_180010440(undefined **param_1,ulonglong param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_1800102d0(param_1,param_2,param_3,param_4);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



undefined8 FUN_180010980(longlong *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined (*_Memory) [16];
  longlong lVar5;
  int iVar6;
  double dVar7;
  double dVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined2 local_98 [4];
  undefined4 local_90;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x41,&DAT_180045a70);
  }
  _Memory = (undefined (*) [16])
            operator_new(*(int *)(param_1 + 0x87a) * *(int *)((longlong)param_1 + 0x43d4));
  uVar9 = 0;
  uVar10 = 0;
  FUN_1800244a0(_Memory,0,
                (longlong)*(int *)(param_1 + 0x87a) * (longlong)*(int *)((longlong)param_1 + 0x43d4)
               );
  uVar17 = 0;
  uVar18 = 0x3f700000;
  uVar11 = 0;
  uVar12 = 0x3ff00000;
  uVar13 = 0x33333333;
  uVar14 = 0x3fe33333;
  iVar6 = 0;
  uVar15 = 0x9999999a;
  uVar16 = 0x3fd99999;
  do {
    iVar1 = (**(code **)(*param_1 + 0x168))(param_1,_Memory,*(undefined4 *)(param_1 + 0x87a));
    if (iVar1 != 1) {
      return 0;
    }
    iVar2 = FUN_180005670((longlong)(param_1 + 0x72),*(int *)(param_1 + 0x87a),(byte *)_Memory,
                          *(int *)(param_1 + 0x87a),0x10,0x10);
    iVar1 = *(int *)(param_1 + 0x87a);
    iVar3 = FUN_180005670((longlong)param_1 + (longlong)(iVar1 + -0x10) + 0x390,iVar1,
                          *_Memory + (iVar1 + -0x10),iVar1,0x10,0x10);
    iVar1 = *(int *)(param_1 + 0x87a);
    lVar5 = (longlong)((*(int *)((longlong)param_1 + 0x43d4) + -0x10) * iVar1);
    iVar4 = FUN_180005670(lVar5 + 0x390 + (longlong)param_1,iVar1,*_Memory + lVar5,iVar1,0x10,0x10);
    iVar1 = *(int *)(param_1 + 0x87a);
    lVar5 = (longlong)(iVar1 + -0x10) +
            (longlong)((*(int *)((longlong)param_1 + 0x43d4) + -0x10) * iVar1);
    iVar1 = FUN_180005670(lVar5 + 0x390 + (longlong)param_1,iVar1,*_Memory + lVar5,iVar1,0x10,0x10);
    if (iVar1 < iVar4) {
      iVar1 = iVar4;
    }
    if (iVar3 < iVar2) {
      iVar3 = iVar2;
    }
    if (iVar1 < iVar3) {
      iVar1 = iVar3;
    }
    dVar7 = (double)iVar1 * (double)CONCAT44(uVar18,uVar17);
    if ((double)CONCAT44(uVar10,uVar9) <= dVar7 && dVar7 != (double)CONCAT44(uVar10,uVar9)) {
      uVar9 = SUB84(dVar7,0);
      uVar10 = (undefined4)((ulonglong)dVar7 >> 0x20);
    }
    if (iVar6 == 9) {
      dVar8 = (double)(uint)(*(byte *)((longlong)param_1 + 0x45ef) >> 2) +
              (double)CONCAT44(uVar12,uVar11);
      dVar7 = sqrt((double)CONCAT44(uVar10,uVar9));
      uVar9 = SUB84(dVar7,0);
      uVar10 = (undefined4)((ulonglong)dVar7 >> 0x20);
      dVar7 = dVar7 + (double)CONCAT44(uVar12,uVar11);
      *(int *)(param_1 + 0x8c1) = (int)(dVar8 * (double)CONCAT44(uVar14,uVar13) + dVar7);
      *(int *)(param_1 + 0x8c0) = (int)(dVar8 * (double)CONCAT44(uVar16,uVar15) + dVar7);
    }
    iVar6 = iVar6 + 1;
  } while (iVar6 < 10);
  local_90 = *(undefined4 *)(param_1 + 0x8c1);
  local_98[0] = 0x13;
  iVar6 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
                    ((longlong *)param_1[0x8c4],L"FingerOnThreshold",local_98);
  PropVariantClear((PROPVARIANT *)local_98);
  if (-1 < iVar6) {
    local_90 = *(undefined4 *)(param_1 + 0x8c0);
    local_98[0] = 0x13;
    (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
              ((longlong *)param_1[0x8c4],L"FingerOnThresholdLoose",local_98);
    PropVariantClear((PROPVARIANT *)local_98);
  }
  if (_Memory != (undefined (*) [16])0x0) {
    free(_Memory);
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x42,&DAT_180045a70,
                  *(undefined4 *)(param_1 + 0x8c1),(char)*(undefined4 *)(param_1 + 0x8c0));
  }
  return 0;
}



void FUN_180011320(longlong param_1)

{
  undefined4 uVar1;
  int iVar2;
  undefined **ppuVar3;
  
  iVar2 = GdipCloneImage(*(undefined8 *)(param_1 + 8));
  if (iVar2 != 0) {
    *(int *)(param_1 + 0x10) = iVar2;
  }
  ppuVar3 = (undefined **)GdipAlloc(0x18);
  if (ppuVar3 != (undefined **)0x0) {
    uVar1 = *(undefined4 *)(param_1 + 0x10);
    ppuVar3[1] = (undefined *)0x0;
    *(undefined4 *)(ppuVar3 + 2) = uVar1;
    *ppuVar3 = (undefined *)&PTR_LAB_180045ad0;
    return;
  }
  return;
}



void FUN_180011380(undefined8 param_1,byte *param_2,int param_3,int param_4,int param_5,
                  uint *param_6,uint *param_7)

{
  byte bVar1;
  uint uVar2;
  longlong lVar3;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3f,&DAT_180045a70);
  }
  lVar3 = (longlong)(param_3 * param_4);
  if (0 < param_3 * param_4) {
    do {
      bVar1 = *param_2;
      uVar2 = (uint)bVar1;
      if (((int)*param_6 < (int)(uint)bVar1) && ((int)(uint)bVar1 < param_5 + (0xff - param_5) / 2))
      {
        *param_6 = uVar2;
      }
      else {
        if (((int)uVar2 < (int)*param_7) &&
           (uVar2 != param_5 / 2 && param_5 / 2 <= (int)(uint)bVar1)) {
          *param_7 = uVar2;
        }
      }
      param_2 = param_2 + 1;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x40,&DAT_180045a70);
  }
  return;
}



BITMAPINFO *
FUN_180011480(longlong param_1,LONG param_2,int param_3,int param_4,DWORD param_5,void *param_6,
             byte param_7)

{
  code *pcVar1;
  errno_t eVar2;
  BITMAPINFO *pBVar3;
  HBITMAP pHVar4;
  BITMAPINFO *pBVar5;
  BITMAPINFO *pBVar6;
  BITMAPINFO *pBVar7;
  
  pBVar6 = (BITMAPINFO *)0x0;
  pBVar3 = (BITMAPINFO *)malloc(0x438);
  pBVar5 = pBVar6;
  pBVar7 = pBVar6;
  if (pBVar3 != (BITMAPINFO *)0x0) {
    *(undefined8 *)&pBVar3->bmiHeader = 0;
    pBVar5 = pBVar3;
    pBVar7 = (BITMAPINFO *)&(pBVar3->bmiHeader).biCompression;
  }
  if (pBVar7 != (BITMAPINFO *)0x0) {
    *(undefined8 *)&pBVar7->bmiHeader = 0;
    *(undefined8 *)&(pBVar7->bmiHeader).biHeight = 0;
    *(undefined8 *)&(pBVar7->bmiHeader).biCompression = 0;
    *(undefined8 *)&(pBVar7->bmiHeader).biXPelsPerMeter = 0;
    *(undefined8 *)&(pBVar7->bmiHeader).biClrUsed = 0;
    (pBVar7->bmiHeader).biWidth = param_2;
    (pBVar7->bmiHeader).biSize = 0x28;
    (pBVar7->bmiHeader).biCompression = param_5;
    (pBVar7->bmiHeader).biHeight = param_3;
    (pBVar7->bmiHeader).biBitCount = (WORD)param_4;
    (pBVar7->bmiHeader).biPlanes = 1;
    if (param_4 < 9) {
      FUN_1800244a0((undefined (*) [16])pBVar7->bmiColors,0,0x400);
    }
    else {
      if ((param_5 == 3) && (eVar2 = memcpy_s(pBVar7->bmiColors,0xc,param_6,0xc), eVar2 != 0)) {
        if (eVar2 == 0xc) {
          FUN_1800047e0(0x8007000e);
          pcVar1 = (code *)swi(3);
          pBVar5 = (BITMAPINFO *)(*pcVar1)();
          return pBVar5;
        }
        if ((eVar2 == 0x16) || (eVar2 == 0x22)) {
          FUN_1800047e0(0x80070057);
          pcVar1 = (code *)swi(3);
          pBVar5 = (BITMAPINFO *)(*pcVar1)();
          return pBVar5;
        }
        if (eVar2 != 0x50) {
          FUN_1800047e0(0x80004005);
          pcVar1 = (code *)swi(3);
          pBVar5 = (BITMAPINFO *)(*pcVar1)();
          return pBVar5;
        }
      }
    }
    pHVar4 = CreateDIBSection((HDC)0x0,pBVar7,0,(void **)(param_1 + 0x10),(HANDLE)0x0,0);
    if (pHVar4 != (HBITMAP)0x0) {
      *(HBITMAP *)(param_1 + 8) = pHVar4;
      FUN_1800155f0(param_1,(-1 < param_3) + 1);
      pBVar6 = (BITMAPINFO *)0x1;
      if ((param_7 & 1) != 0) {
        *(undefined *)(param_1 + 0x29) = 1;
      }
    }
  }
  while (pBVar5 != (BITMAPINFO *)0x0) {
    pBVar7 = *(BITMAPINFO **)&pBVar5->bmiHeader;
    free(pBVar5);
    pBVar5 = pBVar7;
  }
  return pBVar6;
}



void FUN_180011600(LPVOID param_1)

{
  DWORD DVar1;
  HANDLE pvVar2;
  
  FUN_180020980((longlong)param_1);
  pvVar2 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_180011e90,param_1,0,(LPDWORD)0x0);
  *(HANDLE *)((longlong)param_1 + 0x43c0) = pvVar2;
  if (pvVar2 == (HANDLE)0x0) {
    FUN_180020930((longlong)param_1);
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    DVar1 = GetThreadId(*(HANDLE *)((longlong)param_1 + 0x43c0));
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3c,&DAT_180045a70,DVar1);
    return;
  }
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Could not reconcile some variable overlaps

void FUN_1800116a0(longlong param_1,longlong param_2)

{
  undefined4 uVar1;
  UINT cEntries;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined8 uVar4;
  HDC hdc;
  code *pcVar5;
  rsize_t _DstSize;
  char cVar6;
  int iVar7;
  errno_t eVar8;
  BITMAPINFO *pBVar9;
  ulonglong uVar10;
  undefined8 *puVar11;
  ulonglong uVar12;
  undefined8 *_Memory;
  undefined *puVar13;
  undefined *puVar14;
  uint uVar15;
  undefined8 *puVar16;
  uint uVar18;
  void *_Dst;
  uint uVar19;
  ulonglong uVar20;
  bool bVar21;
  undefined8 uStack1184;
  ulonglong local_498;
  undefined4 local_490;
  undefined4 local_48c;
  uint local_488;
  uint local_484;
  undefined8 local_480;
  undefined4 local_478 [2];
  undefined local_470 [8];
  int local_468;
  void *local_460;
  RGBQUAD local_448 [256];
  ulonglong local_48;
  undefined8 *puVar17;
  
  puVar13 = &stack0xfffffffffffffb28;
  puVar14 = &stack0xfffffffffffffb28;
  local_48 = DAT_1800537e8 ^ (ulonglong)&local_498;
  iVar7 = GdipGetImagePixelFormat(*(undefined8 *)(param_2 + 8),&local_498);
  uVar12 = local_498;
  if (iVar7 != 0) {
    *(int *)(param_2 + 0x10) = iVar7;
  }
  uVar15 = (uint)local_498;
  puVar17 = (undefined8 *)0x0;
  local_488 = 0x20;
  local_484 = 0x22009;
  if (((uint)local_498 >> 0x11 & 1) != 0) {
    local_484 = (uint)local_498;
    local_488 = (int)(uint)local_498 >> 8 & 0xff;
  }
  bVar21 = ((uint)local_498 >> 0x12 & 1) != 0;
  if (bVar21) {
    local_488 = 0x20;
    local_484 = 0x26200a;
  }
  uVar19 = local_484;
  uVar18 = local_488;
  local_478[0] = 0;
  iVar7 = GdipGetImageHeight(*(undefined8 *)(param_2 + 8),local_478);
  if (iVar7 != 0) {
    *(int *)(param_2 + 0x10) = iVar7;
  }
  local_480 = CONCAT44(local_480._4_4_,local_478[0]);
  local_498 = local_498 & 0xffffffff00000000;
  iVar7 = GdipGetImageWidth(*(undefined8 *)(param_2 + 8));
  if (iVar7 != 0) {
    *(int *)(param_2 + 0x10) = iVar7;
  }
  pBVar9 = FUN_180011480(param_1,(uint)local_498,(int)local_480,uVar18,0,(void *)0x0,bVar21);
  if ((int)pBVar9 == 0) goto LAB_180011a33;
  _Memory = puVar17;
  if ((uVar15 >> 0x10 & 1) == 0) {
LAB_1800118e0:
    puVar14 = puVar13;
    if (uVar19 == uVar15) {
      uVar4 = *(undefined8 *)(param_2 + 8);
      local_490 = *(undefined4 *)(param_1 + 0x18);
      local_48c = *(undefined4 *)(param_1 + 0x1c);
      *(undefined **)(puVar13 + 0x20) = local_470;
      local_498 = 0;
      *(undefined8 *)(puVar13 + -8) = 0x180011918;
      iVar7 = GdipBitmapLockBits(uVar4,&local_498,1,uVar12 & 0xffffffff);
      if (iVar7 == 0) {
        _Dst = *(void **)(param_1 + 0x10);
        local_480 = (ulonglong)(*(int *)(param_1 + 0x18) * uVar18 + 7 >> 3);
        if (0 < *(int *)(param_1 + 0x1c)) {
          do {
            _DstSize = local_480;
            *(undefined8 *)(puVar13 + -8) = 0x180011961;
            eVar8 = memcpy_s(_Dst,_DstSize,local_460,_DstSize);
            if (eVar8 != 0) {
              if (eVar8 == 0xc) {
                *(undefined8 *)(puVar13 + -8) = 0x180011a87;
                FUN_1800047e0(0x8007000e);
                pcVar5 = (code *)swi(3);
                (*pcVar5)();
                return;
              }
              if ((eVar8 == 0x16) || (eVar8 == 0x22)) {
                *(undefined8 *)(puVar13 + -8) = 0x180011a7c;
                FUN_1800047e0(0x80070057);
                pcVar5 = (code *)swi(3);
                (*pcVar5)();
                return;
              }
              if (eVar8 != 0x50) {
                *(undefined8 *)(puVar13 + -8) = 0x180011a71;
                FUN_1800047e0(0x80004005);
                pcVar5 = (code *)swi(3);
                (*pcVar5)();
                return;
              }
            }
            uVar15 = (int)puVar17 + 1;
            puVar17 = (undefined8 *)(ulonglong)uVar15;
            _Dst = (void *)((longlong)_Dst + (longlong)*(int *)(param_1 + 0x20));
            local_460 = (void *)((longlong)local_460 + (longlong)local_468);
          } while ((int)uVar15 < *(int *)(param_1 + 0x1c));
        }
        uVar4 = *(undefined8 *)(param_2 + 8);
        *(undefined8 *)(puVar13 + -8) = 0x1800119b1;
        iVar7 = GdipBitmapUnlockBits(uVar4,local_470);
        if (iVar7 != 0) {
          *(int *)(param_2 + 0x10) = iVar7;
        }
      }
      else {
        *(int *)(param_2 + 0x10) = iVar7;
      }
    }
    else {
      uVar4 = *(undefined8 *)(param_1 + 0x10);
      uVar1 = *(undefined4 *)(param_1 + 0x20);
      uVar2 = *(undefined4 *)(param_1 + 0x1c);
      local_480 = 0;
      *(undefined8 **)(puVar13 + 0x28) = &local_480;
      uVar3 = *(undefined4 *)(param_1 + 0x18);
      *(undefined8 *)(puVar13 + 0x20) = uVar4;
      *(undefined8 *)(puVar13 + -8) = 0x1800119e3;
      GdipCreateBitmapFromScan0(uVar3,uVar2,uVar1,uVar19);
      uVar12 = local_480;
      local_498 = 0;
      *(undefined8 *)(puVar13 + -8) = 0x1800119f4;
      GdipGetImageGraphicsContext(uVar12,&local_498);
      uVar12 = local_498;
      uVar4 = *(undefined8 *)(param_2 + 8);
      *(undefined8 *)(puVar13 + -8) = 0x180011a0a;
      GdipDrawImageI(uVar12,uVar4,0,0);
      *(undefined8 *)(puVar13 + -8) = 0x180011a12;
      GdipDeleteGraphics(uVar12);
      uVar12 = local_480;
      *(undefined8 *)(puVar13 + -8) = 0x180011a1b;
      GdipDisposeImage(uVar12);
    }
  }
  else {
    local_498 = local_498 & 0xffffffff00000000;
    iVar7 = GdipGetImagePaletteSize(*(undefined8 *)(param_2 + 8),&local_498);
    if (iVar7 != 0) {
      *(int *)(param_2 + 0x10) = iVar7;
    }
    uVar20 = local_498 & 0xffffffff;
    if (((uint)local_498 < 0x401) && (cVar6 = FUN_180015a40(local_498 & 0xffffffff), cVar6 != '\0'))
    {
      uVar10 = uVar20 + 0xf;
      if (uVar10 <= uVar20) {
        uVar10 = 0xffffffffffffff0;
      }
      puVar13 = &stack0xfffffffffffffb20 + -(uVar10 & 0xfffffffffffffff0);
      puVar16 = (undefined8 *)((longlong)&uStack1184 + -(uVar10 & 0xfffffffffffffff0));
    }
    else {
      if (-uVar20 - 1 < 0x10) {
        FUN_1800047e0(0x80070216);
        pcVar5 = (code *)swi(3);
        (*pcVar5)();
        return;
      }
      puVar11 = (undefined8 *)malloc(uVar20 + 0x10);
      puVar13 = &stack0xfffffffffffffb28;
      puVar16 = puVar17;
      if (puVar11 != (undefined8 *)0x0) {
        *puVar11 = 0;
        _Memory = puVar11;
        puVar13 = &stack0xfffffffffffffb28;
        puVar16 = puVar11 + 2;
      }
    }
    puVar14 = puVar13;
    if (puVar16 != (undefined8 *)0x0) {
      uVar4 = *(undefined8 *)(param_2 + 8);
      *(undefined8 *)(puVar13 + -8) = 0x180011859;
      iVar7 = GdipGetImagePalette(uVar4,puVar16);
      if (iVar7 != 0) {
        *(int *)(param_2 + 0x10) = iVar7;
      }
      if (*(int *)((longlong)puVar16 + 4) - 1U < 0x100) {
        puVar11 = puVar17;
        if (*(int *)((longlong)puVar16 + 4) != 0) {
          do {
            uVar18 = (int)puVar11 + 1;
            uVar1 = *(undefined4 *)((longlong)puVar16 + (longlong)puVar11 * 4 + 8);
            local_448[(longlong)puVar11].rgbBlue = (BYTE)uVar1;
            local_448[(longlong)puVar11].rgbReserved = '\0';
            local_448[(longlong)puVar11].rgbRed = (BYTE)((uint)uVar1 >> 0x10);
            local_448[(longlong)puVar11].rgbGreen = (BYTE)((uint)uVar1 >> 8);
            puVar11 = (undefined8 *)(ulonglong)uVar18;
          } while (uVar18 < *(uint *)((longlong)puVar16 + 4));
        }
        cEntries = *(UINT *)((longlong)puVar16 + 4);
        *(undefined8 *)(puVar13 + -8) = 0x1800118be;
        FUN_1800125e0(param_1);
        hdc = *(HDC *)(param_1 + 0x38);
        *(undefined8 *)(puVar13 + -8) = 0x1800118d1;
        SetDIBColorTable(hdc,0,cEntries,local_448);
        *(undefined8 *)(puVar13 + -8) = 0x1800118d9;
        FUN_180014b10(param_1);
        uVar19 = local_484;
        uVar18 = local_488;
        goto LAB_1800118e0;
      }
    }
  }
  while (_Memory != (undefined8 *)0x0) {
    puVar17 = (undefined8 *)*_Memory;
    *(undefined8 *)(puVar14 + -8) = 0x180011a2b;
    free(_Memory);
    _Memory = puVar17;
  }
LAB_180011a33:
  uVar12 = local_48 ^ (ulonglong)&local_498;
  *(undefined8 *)(puVar14 + -8) = 0x180011a42;
  FUN_180023ef0(uVar12);
  return;
}



void FUN_180011a90(longlong param_1,undefined *param_2)

{
  undefined1 local_res8;
  undefined local_res18 [8];
  undefined local_res20 [8];
  undefined local_58;
  undefined local_57;
  undefined local_56;
  undefined local_55;
  undefined local_54;
  undefined local_53;
  undefined local_52;
  undefined local_51;
  undefined local_50;
  undefined local_4f;
  undefined local_4e;
  undefined local_4d;
  undefined local_4c [12];
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3d,&DAT_180045a70);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),1,local_4c);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),2,&local_4e)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),3,&local_50)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),4,&local_52)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),5,&local_54)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),6,&local_56)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),7,&local_58)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),8,&local_4f)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),9,&local_53)
  ;
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0xb,&local_4d);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0xc,&local_55);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),*(undefined *)(param_1 + 0x43ec),&local_51);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x10,&local_57);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x11,local_res20);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
            (*(longlong **)(param_1 + 0x4628),0x12,local_res18);
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))(*(longlong **)(param_1 + 0x4628),0x13);
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_180015ad0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3e,&DAT_180045a70,param_2,local_4c[0]
                  ,local_4e,local_50,local_52,local_54,local_56,local_58,local_4f,local_53,local_4d,
                  local_55,local_51,local_57,local_res20[0],local_res18[0],local_res8);
  }
  return;
}



undefined8 FUN_180011e90(longlong *param_1)

{
  HANDLE hObject;
  
  (**(code **)(*param_1 + 0x160))();
  FUN_180020930((longlong)param_1);
  hObject = (HANDLE)param_1[0x878];
  param_1[0x878] = 0;
  if (hObject != (HANDLE)0x0) {
    CloseHandle(hObject);
  }
  return 0;
}



char FUN_180011ed0(longlong param_1,longlong param_2,int param_3,int param_4)

{
  char *pcVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  char cVar5;
  char cVar6;
  char cVar7;
  char cVar8;
  char cVar9;
  char cVar10;
  char cVar11;
  char cVar12;
  char cVar13;
  char cVar14;
  char cVar15;
  char cVar16;
  int iVar17;
  char *pcVar18;
  uint uVar19;
  ulonglong uVar20;
  ulonglong uVar21;
  uint uVar22;
  char cVar23;
  byte local_res8 [8];
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2d,&DAT_180045a70);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  iVar17 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                     (*(longlong **)(param_1 + 0x4628),*(undefined *)(param_1 + 0x43ec),
                      *(undefined *)(param_1 + 0x43e8));
  if (-1 < iVar17) {
    iVar17 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
                       (*(longlong **)(param_1 + 0x4628),*(undefined *)(param_1 + 0x43ec),local_res8
                       );
    if (-1 < iVar17) {
      if (((uint)local_res8[0] & *(uint *)(param_1 + 0x43e8)) != 0) {
        do {
          iVar17 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
                             (*(longlong **)(param_1 + 0x4628),1);
          if (iVar17 < 0) goto LAB_180011fb6;
          if (*(char *)(param_1 + 0x18) != '\0') goto LAB_18001205f;
        } while ((local_res8[0] & 1) == 0);
        if (*(char *)(param_1 + 0x18) == '\0') {
          uVar22 = param_3 * param_4;
          iVar17 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x30))();
          uVar20 = 0;
          cVar23 = (iVar17 < 0) + '\x01';
          if (((cVar23 == '\x01') && (*(int *)(param_1 + 0x4390) != 2)) && (uVar22 != 0)) {
            if (0x1f < uVar22) {
              do {
                pcVar18 = (char *)(uVar20 + param_2);
                cVar2 = pcVar18[1];
                cVar3 = pcVar18[2];
                cVar4 = pcVar18[3];
                cVar5 = pcVar18[4];
                cVar6 = pcVar18[5];
                cVar7 = pcVar18[6];
                cVar8 = pcVar18[7];
                cVar9 = pcVar18[8];
                cVar10 = pcVar18[9];
                cVar11 = pcVar18[10];
                cVar12 = pcVar18[0xb];
                cVar13 = pcVar18[0xc];
                cVar14 = pcVar18[0xd];
                cVar15 = pcVar18[0xe];
                cVar16 = pcVar18[0xf];
                uVar21 = (ulonglong)((int)uVar20 + 0x10);
                pcVar1 = (char *)(uVar20 + param_2);
                *pcVar1 = -1 - *pcVar18;
                pcVar1[1] = -1 - cVar2;
                pcVar1[2] = -1 - cVar3;
                pcVar1[3] = -1 - cVar4;
                pcVar1[4] = -1 - cVar5;
                pcVar1[5] = -1 - cVar6;
                pcVar1[6] = -1 - cVar7;
                pcVar1[7] = -1 - cVar8;
                pcVar1[8] = -1 - cVar9;
                pcVar1[9] = -1 - cVar10;
                pcVar1[10] = -1 - cVar11;
                pcVar1[0xb] = -1 - cVar12;
                pcVar1[0xc] = -1 - cVar13;
                pcVar1[0xd] = -1 - cVar14;
                pcVar1[0xe] = -1 - cVar15;
                pcVar1[0xf] = -1 - cVar16;
                pcVar18 = (char *)(uVar21 + param_2);
                cVar2 = pcVar18[1];
                cVar3 = pcVar18[2];
                cVar4 = pcVar18[3];
                cVar5 = pcVar18[4];
                cVar6 = pcVar18[5];
                cVar7 = pcVar18[6];
                cVar8 = pcVar18[7];
                cVar9 = pcVar18[8];
                cVar10 = pcVar18[9];
                cVar11 = pcVar18[10];
                cVar12 = pcVar18[0xb];
                cVar13 = pcVar18[0xc];
                cVar14 = pcVar18[0xd];
                cVar15 = pcVar18[0xe];
                cVar16 = pcVar18[0xf];
                uVar19 = (int)uVar20 + 0x20;
                uVar20 = (ulonglong)uVar19;
                pcVar1 = (char *)(uVar21 + param_2);
                *pcVar1 = -1 - *pcVar18;
                pcVar1[1] = -1 - cVar2;
                pcVar1[2] = -1 - cVar3;
                pcVar1[3] = -1 - cVar4;
                pcVar1[4] = -1 - cVar5;
                pcVar1[5] = -1 - cVar6;
                pcVar1[6] = -1 - cVar7;
                pcVar1[7] = -1 - cVar8;
                pcVar1[8] = -1 - cVar9;
                pcVar1[9] = -1 - cVar10;
                pcVar1[10] = -1 - cVar11;
                pcVar1[0xb] = -1 - cVar12;
                pcVar1[0xc] = -1 - cVar13;
                pcVar1[0xd] = -1 - cVar14;
                pcVar1[0xe] = -1 - cVar15;
                pcVar1[0xf] = -1 - cVar16;
              } while (uVar19 < uVar22 - (uVar22 & 0x1f));
            }
            if ((uint)uVar20 < uVar22) {
              uVar21 = (ulonglong)(uVar22 - (uint)uVar20);
              pcVar18 = (char *)(uVar20 + param_2);
              do {
                *pcVar18 = -1 - *pcVar18;
                uVar21 = uVar21 - 1;
                pcVar18 = pcVar18 + 1;
              } while (uVar21 != 0);
            }
          }
        }
        else {
LAB_18001205f:
          cVar23 = '\x0f';
        }
        goto LAB_180011fbb;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2e,&DAT_180045a70,
                      *(uint *)(param_1 + 0x43e8),local_res8[0]);
      }
    }
  }
LAB_180011fb6:
  cVar23 = '\x02';
LAB_180011fbb:
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
            (*(longlong **)(param_1 + 0x4628),*(undefined *)(param_1 + 0x43ec),0);
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2f,&DAT_180045a70);
  }
  return cVar23;
}



undefined8 FUN_180012130(longlong param_1,undefined4 *param_2,uint *param_3)

{
  if ((param_2 != (undefined4 *)0x0) && (0x2f < *param_3)) {
    FUN_180020a80(param_1,param_2,param_3);
    *(undefined *)(param_2 + 3) = 2;
    *(ushort *)param_2 = *(ushort *)param_2 | 0x1480;
    *(undefined *)((longlong)param_2 + 0xd) = *(undefined *)(param_1 + 0x308);
    *(undefined *)((longlong)param_2 + 0xe) = *(undefined *)(param_1 + 0x309);
    *param_3 = 0x30;
    return 0;
  }
  *param_3 = 0x30;
  return 0x8007007a;
}



undefined8 FUN_1800121b0(longlong *param_1,longlong *param_2,uint *param_3)

{
  if ((param_2 != (longlong *)0x0) && (0x4037 < *param_3)) {
    FUN_180020b70(param_1,param_2,param_3);
    *param_2 = *param_2 + 0x4010;
    *(undefined4 *)(param_2 + 3) = 0x1fc01fc;
    *(undefined4 *)((longlong)param_2 + 0x1c) = 0x1fc01fc;
    *(undefined4 *)(param_2 + 4) = 0x80101;
    *(undefined2 *)((longlong)param_2 + 0x14) = 0x300;
    param_2[5] = 0;
    param_2[6] = 0;
    *(undefined4 *)(param_2 + 5) = 0x4010;
    *(undefined4 *)((longlong)param_2 + 0x2c) = 0x800080;
    *(undefined4 *)(param_2 + 6) = 0xfe010100;
    (**(code **)(*param_1 + 0x20))(param_1,param_1[0x62],param_2 + 7,0x4000);
    *param_3 = *(uint *)param_2;
    return 0;
  }
  *param_3 = 0x4038;
  return 0x8007007a;
}



undefined8 FUN_180012460(longlong param_1,undefined (*param_2) [16])

{
  longlong lVar1;
  HANDLE hObject;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5e,&DAT_180045a70);
  }
  if (*(HANDLE *)(param_1 + 0x43c0) != (HANDLE)0x0) {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x43c0),0xffffffff);
    hObject = *(HANDLE *)(param_1 + 0x43c0);
    *(HANDLE *)(param_1 + 0x43c0) = (HANDLE)0x0;
    if (hObject != (HANDLE)0x0) {
      CloseHandle(hObject);
    }
  }
  FUN_1800244a0(param_2,0,0x62c);
  *(undefined8 *)*param_2 = 0x62c;
  *(undefined8 *)(*param_2 + 8) = 1;
  *(undefined4 *)param_2[1] = 8;
  *(undefined4 *)(param_2[1] + 4) = 2;
  *(undefined4 *)(param_2[1] + 8) = 1;
  *(undefined4 *)(param_2[0x62] + 4) = 1;
  *(undefined4 *)(param_2[0x62] + 8) = 0x401001b;
  lVar2 = -1;
  *(undefined4 *)(param_2[1] + 0xc) = 0x670045;
  *(undefined4 *)param_2[2] = 0x730069;
  *(undefined4 *)(param_2[2] + 4) = 0x650054;
  *(undefined4 *)(param_2[2] + 8) = 0x2e0063;
  *(undefined2 *)(param_2[2] + 0xc) = 0;
  do {
    lVar1 = lVar2 * 2;
    lVar2 = lVar2 + 1;
  } while (*(short *)(param_1 + 0x43f0 + lVar1) != 0);
  FUN_180023f20((undefined8 *)(param_2[0x21] + 0xc),(undefined8 *)(param_1 + 0x43ee),lVar2 * 2 + 2);
  *(undefined4 *)(param_2[0x41] + 0xc) = 0x300030;
  *(undefined4 *)param_2[0x42] = 0x2d0030;
  *(undefined4 *)(param_2[0x42] + 4) = 0x300030;
  *(undefined4 *)(param_2[0x42] + 8) = 0x2d0030;
  *(undefined8 *)(param_2[0x42] + 0xc) = 0x3200310031;
  *(undefined8 *)(param_2[0x61] + 0xc) = 1;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5f,&DAT_180045a70);
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_1800125e0(longlong param_1)

{
  HDC hdc;
  HGDIOBJ pvVar1;
  int iVar2;
  
  *(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x40) + 1;
  if (*(longlong *)(param_1 + 0x38) != 0) {
    return *(undefined8 *)(param_1 + 0x38);
  }
  if ((DAT_1800551e8 & 1) == 0) {
    DAT_1800551e8 = DAT_1800551e8 | 1;
    _DAT_1800551c8 = ZEXT816(0);
    _DAT_1800551d8 = ZEXT816(0);
    atexit(FUN_180033e50);
  }
  iVar2 = 0;
  do {
    hdc = *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar2 * 8);
    *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar2 * 8) = (HDC)0x0;
    if (hdc != (HDC)0x0) goto LAB_180012652;
    iVar2 = iVar2 + 1;
  } while (iVar2 < 4);
  hdc = CreateCompatibleDC((HDC)0x0);
LAB_180012652:
  *(HDC *)(param_1 + 0x38) = hdc;
  pvVar1 = SelectObject(hdc,*(HGDIOBJ *)(param_1 + 8));
  *(HGDIOBJ *)(param_1 + 0x48) = pvVar1;
  return *(undefined8 *)(param_1 + 0x38);
}



int FUN_1800128b0(longlong *param_1,undefined *param_2)

{
  int iVar1;
  undefined local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)(param_1 + 10) = 3;
  *(undefined *)((longlong)param_1 + 0x52) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x15,&DAT_180045a70,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
       (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
      iVar1 = 0;
      *param_2 = *(undefined *)(param_1 + 0xb);
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x16,&DAT_180045a70,
                      (uint)*(byte *)((longlong)param_1 + 0x59));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



undefined8 FUN_1800129d0(longlong *param_1,undefined8 param_2,longlong param_3,undefined4 *param_4)

{
  undefined uVar1;
  int iVar2;
  longlong lVar3;
  undefined8 uVar4;
  uint in_stack_ffffffffffffffb8;
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  
  uVar4 = 1;
  param_1[0xd] = param_3;
  *(undefined4 *)(param_1 + 0xe) = 0x80;
  *(undefined4 *)((longlong)param_1 + 0x74) = 0x8c;
  if ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) {
    if (((PTR_LOOP_1800537c8[0x1c] & 8) != 0) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x35,&DAT_180045a70);
    }
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x36,&DAT_180045a70,
                    *(undefined4 *)(param_1 + 0x878));
    }
  }
  if ((*(int *)(param_1 + 0x872) != 2) && ((HANDLE)param_1[0x878] != (HANDLE)0x0)) {
    WaitForSingleObject((HANDLE)param_1[0x878],0xffffffff);
  }
  local_38 = 0;
  local_30 = 0;
  local_28 = 0;
  iVar2 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"FetchImageMode",&local_38);
  *(int *)(param_1 + 0x872) = (int)local_30;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x37,&DAT_180045a70,(int)local_30);
  }
  PropVariantClear((PROPVARIANT *)&local_38);
  if (-1 < iVar2) {
    local_38 = 0;
    local_30 = 0;
    local_28 = 0;
    iVar2 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                      ((longlong *)param_1[0x8c4],L"FingerOnMode",&local_38);
    *(int *)((longlong)param_1 + 0x4394) = (int)local_30;
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x38,&DAT_180045a70,(int)local_30);
    }
    PropVariantClear((PROPVARIANT *)&local_38);
    if (-1 < iVar2) {
      (**(code **)(*(longlong *)param_1[0x8c5] + 0x68))
                ((longlong *)param_1[0x8c5],*(undefined4 *)(param_1 + 0x872));
      iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                        ((longlong *)param_1[0x8c5],3,*(undefined *)((longlong)param_1 + 0x45ee));
      if (((-1 < iVar2) &&
          (iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                             ((longlong *)param_1[0x8c5],9,
                              *(undefined *)((longlong)param_1 + 0x45ef)), -1 < iVar2)) &&
         ((iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                             ((longlong *)param_1[0x8c5],2,0xff), -1 < iVar2 &&
          (iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],5,2)
          , -1 < iVar2)))) {
        (**(code **)(*param_1 + 0x178))(param_1,"CET300::GetImage ...Set Register");
        iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,1);
        if (-1 < iVar2) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x39,&DAT_180045a70);
          }
          do {
            if (*(char *)(param_1 + 3) != '\0') {
              return 0xf;
            }
            iVar2 = (**(code **)(*param_1 + 0x168))
                              (param_1,param_1[0xd],*(undefined4 *)(param_1 + 0x87a),
                               *(undefined4 *)((longlong)param_1 + 0x43d4));
            if (iVar2 != 1) {
              return 1;
            }
            in_stack_ffffffffffffffb8 = in_stack_ffffffffffffffb8 & 0xffffff00;
            iVar2 = (**(code **)(*param_1 + 0x188))
                              (param_1,param_1[0xd],*(undefined4 *)(param_1 + 0x87a),
                               *(undefined4 *)((longlong)param_1 + 0x43d4),in_stack_ffffffffffffffb8
                              );
          } while (iVar2 == 0);
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3a,&DAT_180045a70);
          }
          iVar2 = (*(code *)PTR_FUN_180053780)(param_1 + 2,0x1000000);
          if (iVar2 != 0) {
            (*(code *)PTR_FUN_180053788)
                      (param_1 + 2,L"Image",param_1[0xd],*(undefined4 *)(param_1 + 0x87a),
                       *(undefined4 *)((longlong)param_1 + 0x43d4));
          }
          if ((*(int *)(param_1 + 0x872) != 2) &&
             (iVar2 = 0, 0 < *(int *)(param_1 + 0x87a) * *(int *)((longlong)param_1 + 0x43d4))) {
            lVar3 = 0;
            do {
              uVar1 = (**(code **)(*param_1 + 0x120))
                                (param_1,(uint)*(byte *)((longlong)param_1 + lVar3 + 0x390) -
                                         (uint)*(byte *)(lVar3 + param_1[0xd]));
              iVar2 = iVar2 + 1;
              *(undefined *)(lVar3 + param_1[0xd]) = uVar1;
              lVar3 = lVar3 + 1;
            } while (iVar2 < *(int *)(param_1 + 0x87a) * *(int *)((longlong)param_1 + 0x43d4));
          }
          iVar2 = (*(code *)PTR_FUN_180053780)(param_1 + 2,0x1000000);
          if (iVar2 != 0) {
            (*(code *)PTR_FUN_180053788)
                      (param_1 + 2,L"Image_not_bkg",param_1[0xd],*(undefined4 *)(param_1 + 0x87a),
                       *(undefined4 *)((longlong)param_1 + 0x43d4));
          }
          if (param_4 != (undefined4 *)0x0) {
            *param_4 = 100;
          }
          if (*(int *)(param_1 + 0x872) != 2) {
            (**(code **)(*param_1 + 0x170))(param_1);
          }
          if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
            return 1;
          }
          if ((PTR_LOOP_1800537c8[0x1c] & 8) == 0) {
            return 1;
          }
          if ((byte)PTR_LOOP_1800537c8[0x19] < 4) {
            return 1;
          }
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3b,&DAT_180045a70);
          return 1;
        }
      }
      uVar4 = 2;
    }
  }
  return uVar4;
}



void FUN_180012e60(longlong *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined auStack88 [32];
  int local_38;
  undefined4 local_34;
  undefined2 local_30;
  undefined local_2e;
  undefined local_2c;
  undefined uStack43;
  undefined uStack42;
  undefined uStack41;
  undefined2 uStack40;
  undefined uStack38;
  ulonglong local_20;
  
  local_20 = DAT_1800537e8 ^ (ulonglong)auStack88;
  iVar3 = 0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x29,&DAT_180045a70);
  }
  if (param_2 != 0) {
    (**(code **)(*param_1 + 0x158))(param_1);
  }
  local_2c = *(undefined *)((longlong)param_1 + 0x45f1);
  local_34 = 0x2080903;
  uStack43 = *(undefined *)(param_1 + 0x8be);
  local_30 = 0xb0c;
  uStack42 = *(undefined *)((longlong)param_1 + 0x45f2);
  local_2e = 5;
  uStack41 = 2;
  uStack40 = 0x1ff;
  uStack38 = 0;
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                    ((longlong *)param_1[0x8c5],&local_34,&local_2c,7);
  if (-1 < iVar1) {
    iVar1 = 0;
    do {
      iVar2 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x48))
                        ((longlong *)param_1[0x8c5],&local_38);
      if (iVar2 < 0) goto LAB_180012fe1;
      if (local_38 != 0) {
        iVar3 = iVar3 + 1;
      }
      iVar1 = iVar1 + 1;
    } while (iVar1 < 8);
    local_2c = 5;
    uStack43 = 0xb;
    uStack42 = 8;
    uStack41 = 2;
    uStack40 = 0x407;
    local_34 = 0xff010002;
    local_30 = 0;
    iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                      ((longlong *)param_1[0x8c5],&local_2c,&local_34);
    if (((-1 < iVar1) && ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8)) &&
       (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (2 < (byte)PTR_LOOP_1800537c8[0x19])))) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2a,&DAT_180045a70,iVar3);
    }
  }
LAB_180012fe1:
  FUN_180023ef0(local_20 ^ (ulonglong)auStack88);
  return;
}



bool FUN_180013010(longlong param_1,byte *param_2,int param_3,int param_4,char param_5)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2b,&DAT_180045a70);
  }
  if (param_5 == '\0') {
    iVar3 = *(int *)(param_1 + 0x4608);
  }
  else {
    iVar3 = *(int *)(param_1 + 0x4600);
  }
  uVar4 = iVar3 * iVar3 * 0x100;
  uVar1 = FUN_180005670(param_1 + 0x390,*(int *)(param_1 + 0x43d0),param_2,param_3,0x10,0x10);
  lVar5 = (longlong)(param_3 + -0x10);
  uVar1 = (uint)(uVar4 <= uVar1);
  uVar2 = FUN_180005670(param_1 + 0x390 + lVar5,*(int *)(param_1 + 0x43d0),param_2 + lVar5,param_3,
                        0x10,0x10);
  if (uVar4 <= uVar2) {
    uVar1 = uVar1 + 1;
  }
  lVar6 = (longlong)((param_4 + -0x10) * param_3);
  uVar2 = FUN_180005670(param_1 + 0x390 + lVar6,*(int *)(param_1 + 0x43d0),param_2 + lVar6,param_3,
                        0x10,0x10);
  if (uVar4 <= uVar2) {
    uVar1 = uVar1 + 1;
  }
  uVar2 = FUN_180005670(param_1 + 0x390 + lVar6 + lVar5,*(int *)(param_1 + 0x43d0),
                        param_2 + lVar6 + lVar5,param_3,0x10,0x10);
  if (uVar4 <= uVar2) {
    uVar1 = uVar1 + 1;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2c,&DAT_180045a70,uVar1);
  }
  return 2 < uVar1;
}



ulonglong FUN_1800131d0(longlong *param_1)

{
  int iVar1;
  ulonglong in_RAX;
  ulonglong uVar2;
  undefined local_38 [16];
  undefined4 local_28 [2];
  undefined8 local_20;
  undefined8 local_18;
  
  if (*(int *)((longlong)param_1 + 0x34) != 0) {
    return in_RAX & 0xffffffffffffff00;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 1));
  uVar2 = 1;
  if (*param_1 == 0) {
    local_28[0] = 1;
    local_20 = 0;
    local_18 = 0;
    iVar1 = GdiplusStartup(param_1,local_28,local_38);
    uVar2 = (ulonglong)(iVar1 == 0);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 1));
  return uVar2;
}



void FUN_180013260(longlong *param_1)

{
  int iVar1;
  undefined2 uVar2;
  undefined auStack72 [32];
  undefined4 local_28;
  undefined local_24;
  undefined2 local_20;
  undefined2 local_1e;
  undefined local_1c;
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack72;
  if (*(int *)(param_1 + 0x67) != 0) goto LAB_180013508;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1e,&DAT_180045a70);
  }
  FUN_180014280((longlong)param_1);
  *(undefined8 *)((longlong)param_1 + 0x4614) = 0;
  *(undefined *)(param_1 + 3) = 0;
  iVar1 = (**(code **)(*param_1 + 0x148))(param_1);
  if (iVar1 == 0) {
    iVar1 = (**(code **)(*param_1 + 0x150))(param_1);
    if (iVar1 == 0) {
      iVar1 = (**(code **)(*param_1 + 0x158))(param_1);
      if ((iVar1 == 0) || (*(int *)(param_1 + 0x8c3) == 0)) {
        *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
      }
      else {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
           (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
          uVar2 = 0x21;
          goto LAB_18001338b;
        }
      }
    }
    else {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
         (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
        uVar2 = 0x20;
        goto LAB_18001338b;
      }
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
       (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
      uVar2 = 0x1f;
LAB_18001338b:
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar2,&DAT_180045a70);
    }
  }
  local_28 = 0x13121110;
  local_20 = CONCAT11(*(undefined *)(param_1 + 0x87c),*(undefined *)(param_1 + 0x87b));
  local_1e = CONCAT11(*(undefined *)((longlong)param_1 + 0x43e4),
                      *(undefined *)((longlong)param_1 + 0x43e4));
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                    ((longlong *)param_1[0x8c5],&local_28,&local_20,4);
  if (-1 < iVar1) {
    local_20 = 0x108;
    local_28 = CONCAT22(local_28._2_2_,0x205);
    iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                      ((longlong *)param_1[0x8c5],&local_20,&local_28,2);
    if (-1 < iVar1) {
      iVar1 = (**(code **)(*param_1 + 0x68))(param_1);
      if (iVar1 != 0) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
           (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x22,&DAT_180045a70);
        }
        local_28 = 0x7020903;
        local_20 = *(undefined2 *)((longlong)param_1 + 0x45ee);
        local_24 = 4;
        local_1e = 0xff;
        local_1c = 0;
        iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                          ((longlong *)param_1[0x8c5],&local_28,&local_20,5);
        if (iVar1 < 0) goto LAB_180013508;
        (**(code **)(*param_1 + 0x178))(param_1,"InitSensor");
      }
      *(undefined4 *)(param_1 + 0x67) = 1;
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
         (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x23,&DAT_180045a70);
      }
    }
  }
LAB_180013508:
  FUN_180023ef0(local_18 ^ (ulonglong)auStack72);
  return;
}



bool FUN_180013610(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  byte local_res8 [8];
  undefined8 local_38;
  undefined8 local_30;
  undefined8 local_28;
  
  local_38 = 0;
  local_30 = 0;
  local_28 = 0;
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x18))
                    (*(longlong **)(param_1 + 0x4620),L"FetchImageMode",&local_38);
  *(int *)(param_1 + 0x4390) = (int)local_30;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x60,&DAT_180045a70,(int)local_30);
  }
  PropVariantClear((PROPVARIANT *)&local_38);
  if (-1 < iVar1) {
    local_38 = 0;
    local_30 = 0;
    local_28 = 0;
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x18))
                      (*(longlong **)(param_1 + 0x4620),L"FingerOnMode",&local_38);
    *(int *)(param_1 + 0x4394) = (int)local_30;
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x61,&DAT_180045a70,(int)local_30);
    }
    PropVariantClear((PROPVARIANT *)&local_38);
    if (-1 < iVar1) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))
                        (*(longlong **)(param_1 + 0x4628),*(undefined *)(param_1 + 0x43ec),
                         *(undefined *)(param_1 + 0x43e8));
      if (-1 < iVar1) {
        do {
          iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 8))
                            (*(longlong **)(param_1 + 0x4628),1,local_res8);
          if (iVar1 < 0) goto LAB_1800137a9;
        } while ((local_res8[0] & 1) == 0);
        (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x68))
                  (*(longlong **)(param_1 + 0x4628),*(undefined4 *)(param_1 + 0x4390));
        iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x30))
                          (*(longlong **)(param_1 + 0x4628),param_2,param_3);
      }
    }
  }
LAB_1800137a9:
  (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x10))(*(longlong **)(param_1 + 0x4628),0xd,0);
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(param_1 + 0x4628) + 0x10));
  return iVar1 < 0;
}



undefined8 FUN_180013800(longlong param_1,undefined *param_2)

{
  int iVar1;
  undefined local_res8 [32];
  
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x48))
                    (*(longlong **)(param_1 + 0x4628),local_res8);
  if (iVar1 < 0) {
    return 1;
  }
  *param_2 = local_res8[0];
  return 0;
}



bool FUN_180013840(longlong param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4)

{
  int iVar1;
  
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x18))
                    (*(longlong **)(param_1 + 0x4628),param_2,param_4,param_3);   // Possible call to FUN_18001b290
  return iVar1 < 0;
}



bool FUN_180013880(longlong param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4)

{
  int iVar1;
  
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4628) + 0x20))
                    (*(longlong **)(param_1 + 0x4628),param_2,param_4,param_3);
  return iVar1 < 0;
}



void FUN_1800138c0(longlong param_1,void *param_2)

{
  code *pcVar1;
  rsize_t _DstSize;
  errno_t eVar2;
  int iVar3;
  longlong *plVar4;
  ulonglong uVar5;
  longlong lVar6;
  undefined8 uVar7;
  undefined auStack360 [32];
  undefined8 local_148;
  undefined **local_140;
  undefined8 local_138;
  undefined4 local_130;
  undefined *local_128;
  undefined local_120 [264];
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack360;
  plVar4 = (longlong *)FUN_18000dc00();
  uVar5 = FUN_1800131d0(plVar4);
  if ((char)uVar5 != '\0') {
    local_128 = local_120;
    if (param_2 == (void *)0x0) {
      local_128 = (undefined *)0x0;
    }
    else {
      lVar6 = -1;
      do {
        lVar6 = lVar6 + 1;
      } while (*(short *)((longlong)param_2 + lVar6 * 2) != 0);
      iVar3 = (int)lVar6 + 1;
      FUN_180010010(&local_128,iVar3,local_120,0x80);
      _DstSize = (longlong)iVar3 * 2;
      eVar2 = memcpy_s(local_128,_DstSize,param_2,_DstSize);
      if (eVar2 != 0) {
        if (eVar2 == 0xc) {
          FUN_1800047e0(0x8007000e);
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
        if ((eVar2 == 0x16) || (eVar2 == 0x22)) {
          FUN_1800047e0(0x80070057);
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
        if (eVar2 != 0x50) {
          FUN_1800047e0(0x80004005);
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
      }
    }
    local_148 = 0;
    local_140 = &PTR_LAB_180045ad0;
    iVar3 = GdipCreateBitmapFromFile(local_128,&local_148);
    uVar7 = local_148;
    local_138 = local_148;
    if (local_128 != local_120) {
      free(local_128);
    }
    local_130 = 0;
    if (iVar3 == 0) {
      FUN_1800116a0(param_1,(longlong)&local_140);
      uVar7 = local_138;
    }
    GdipDisposeImage(uVar7);
  }
  FUN_180023ef0(local_18 ^ (ulonglong)auStack360);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

HLOCAL FUN_180013a40(HLOCAL param_1,void *param_2,int *param_3,int *param_4)

{
  HDC hdc;
  HGDIOBJ ho;
  int iVar1;
  int iVar2;
  COLORREF CVar3;
  BOOL BVar4;
  uint uVar5;
  undefined *puVar6;
  HDC pHVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  undefined **local_88;
  HGDIOBJ local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined2 local_60;
  undefined8 local_5c;
  HDC local_50;
  int local_48;
  HGDIOBJ local_40;
  
  local_88 = &PTR_LAB_180045ae0;
  local_5c = 0xffffffffffffffff;
  local_80 = (HGDIOBJ)0x0;
  local_78 = 0;
  local_70 = 0;
  local_68 = 0;
  local_60 = 0;
  local_50 = (HDC)0x0;
  local_48 = 0;
  local_40 = (HGDIOBJ)0x0;
  puVar6 = FUN_18000dc00();
  EnterCriticalSection((LPCRITICAL_SECTION)(puVar6 + 8));
  *(int *)(puVar6 + 0x30) = *(int *)(puVar6 + 0x30) + 1;
  LeaveCriticalSection((LPCRITICAL_SECTION)(puVar6 + 8));
  iVar1 = FUN_1800138c0((longlong)&local_88,param_2);
  if (iVar1 == 0) {
    if (param_1 == (HLOCAL)0x0) {
      param_1 = LocalAlloc(0,(longlong)(local_70._4_4_ * (int)local_70 * 4));
    }
    uVar8 = 0;
    uVar9 = uVar8;
    if (0 < local_70._4_4_) {
      do {
        iVar1 = 0;
        if (0 < (int)local_70) {
          do {
            iVar2 = 0;
            local_48 = local_48 + 1;
            if (local_50 == (HDC)0x0) {
              if ((DAT_1800551e8 & 1) == 0) {
                DAT_1800551e8 = DAT_1800551e8 | 1;
                DAT_1800551c8 = 0;
                DAT_1800551d0 = 0;
                _DAT_1800551d8 = 0;
                _DAT_1800551e0 = 0;
                atexit(FUN_180033e50);
              }
              do {
                pHVar7 = *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar2 * 8);
                *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar2 * 8) = (HDC)0x0;
                if (pHVar7 != (HDC)0x0) goto LAB_180013ba1;
                iVar2 = iVar2 + 1;
              } while (iVar2 < 4);
              pHVar7 = CreateCompatibleDC((HDC)0x0);
LAB_180013ba1:
              local_50 = pHVar7;
              local_40 = SelectObject(pHVar7,local_80);
            }
            CVar3 = GetPixel(local_50,iVar1,(int)uVar9);
            local_48 = local_48 + -1;
            if (local_48 == 0) {
              SelectObject(local_50,local_40);
              if ((DAT_1800551e8 & 1) == 0) {
                DAT_1800551e8 = DAT_1800551e8 | 1;
                DAT_1800551c8 = 0;
                DAT_1800551d0 = 0;
                _DAT_1800551d8 = 0;
                _DAT_1800551e0 = 0;
                atexit(FUN_180033e50);
              }
              iVar2 = 0;
              pHVar7 = local_50;
              do {
                hdc = *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar2 * 8);
                *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar2 * 8) = pHVar7;
                if (hdc == (HDC)0x0) goto LAB_180013c49;
                iVar2 = iVar2 + 1;
                pHVar7 = hdc;
              } while (iVar2 < 4);
              DeleteDC(hdc);
LAB_180013c49:
              local_50 = (HDC)0x0;
            }
            *(char *)(uVar8 + (longlong)param_1) = (char)CVar3;
            iVar1 = iVar1 + 1;
            uVar8 = uVar8 + 1;
          } while (iVar1 < (int)local_70);
        }
        uVar5 = (int)uVar9 + 1;
        uVar9 = (ulonglong)uVar5;
      } while ((int)uVar5 < local_70._4_4_);
    }
    *param_3 = (int)local_70;
    *param_4 = local_70._4_4_;
  }
  else {
    param_1 = (HLOCAL)0x0;
  }
  ho = local_80;
  local_88 = &PTR_LAB_180045ae0;
  if (local_80 != (HGDIOBJ)0x0) {
    local_80 = (HGDIOBJ)0x0;
    local_78 = 0;
    local_70 = 0;
    local_68 = 0;
    local_5c = 0xffffffffffffffff;
    local_60 = 0;
    DeleteObject(ho);
  }
  if ((DAT_1800551c0 & 1) == 0) {
    DAT_1800551c0 = DAT_1800551c0 | 1;
    DAT_180055188 = 0;
    _DAT_1800551b8 = 0;
    BVar4 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)&DAT_180055190,0,0);
    if (BVar4 == 0) {
      uVar5 = GetLastError();
      if (0 < (int)uVar5) {
        uVar5 = uVar5 & 0xffff | 0x80070000;
      }
      _DAT_1800551b8 = _DAT_1800551b8 & 0xffffffff | (ulonglong)uVar5 << 0x20;
    }
    atexit(FUN_180033e90);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
  _DAT_1800551b8 = _DAT_1800551b8 - 1;
  _DAT_1800551b8 = _DAT_1800551b8 & 0xffffffff00000000 | (ulonglong)_DAT_1800551b8;
  if (_DAT_1800551b8 == 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
    if (DAT_180055188 != 0) {
      GdiplusShutdown();
    }
    DAT_180055188 = 0;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_180013dc0(longlong *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x54,&DAT_180045a70);
  }
  if (*(int *)((longlong)param_1 + 0x45fc) == 0) {
    *(undefined4 *)(param_1 + 0x8c3) = 0;
    return 0;
  }
  local_28 = 0;
  local_20 = 0;
  local_18 = 0;
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"RemoteWakeupEnable",&local_28);
  if ((iVar1 < 0) || ((int)local_20 != 0)) {
    uVar2 = 1;
  }
  else {
    uVar2 = 0;
  }
  *(undefined4 *)(param_1 + 0x8c3) = uVar2;
  PropVariantClear((PROPVARIANT *)&local_28);
  local_28 = 0;
  local_20 = 0;
  local_18 = 0;
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"CALIBRATE_TYPE(Detect)",&local_28);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_1 + 0x98))(param_1);
    if ((int)local_20 == iVar1) {
      local_28 = 0;
      local_20 = 0;
      local_18 = 0;
      iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                        ((longlong *)param_1[0x8c4],L"FPS_CTL(Detect)",&local_28);
      if (-1 < iVar1) {
        *(undefined *)((longlong)param_1 + 0x45f1) = (undefined)local_20;
        PropVariantClear((PROPVARIANT *)&local_28);
        local_28 = 0;
        local_20 = 0;
        local_18 = 0;
        iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                          ((longlong *)param_1[0x8c4],L"PGA_CONTL(Detect)",&local_28);
        if (-1 < iVar1) {
          *(undefined *)(param_1 + 0x8be) = (undefined)local_20;
          PropVariantClear((PROPVARIANT *)&local_28);
          local_28 = 0;
          local_20 = 0;
          local_18 = 0;
          iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                            ((longlong *)param_1[0x8c4],L"DETC(Detect)");
          if (-1 < iVar1) {
            *(undefined *)((longlong)param_1 + 0x45f2) = (undefined)local_20;
            PropVariantClear((PROPVARIANT *)&local_28);
            if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
               (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
              FUN_18001cc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x56,&DAT_180045a70,
                            (uint)*(byte *)((longlong)param_1 + 0x45f1),
                            *(undefined *)(param_1 + 0x8be),
                            *(undefined *)((longlong)param_1 + 0x45f2));
            }
            iVar1 = 0;
          }
        }
      }
    }
    else {
      iVar1 = 1;
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x55,&DAT_180045a70);
      }
    }
  }
  PropVariantClear((PROPVARIANT *)&local_28);
  if (iVar1 < 0) {
    *(undefined2 *)(param_1 + 0x8be) = 0;
    *(undefined *)((longlong)param_1 + 0x45f2) = 0;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x57,&DAT_180045a70);
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_180014080(longlong *param_1)

{
  int iVar1;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x58,&DAT_180045a70);
  }
  local_28 = 0;
  local_20 = 0;
  local_18 = 0;
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"CALIBRATE_TYPE(Sensor)",&local_28);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_1 + 0x98))(param_1);
    if ((int)local_20 == iVar1) {
      local_28 = 0;
      local_20 = 0;
      local_18 = 0;
      iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                        ((longlong *)param_1[0x8c4],L"FPS_CTL(Sensor)",&local_28);
      if (-1 < iVar1) {
        *(undefined *)((longlong)param_1 + 0x45ee) = (undefined)local_20;
        PropVariantClear((PROPVARIANT *)&local_28);
        local_28 = 0;
        local_20 = 0;
        local_18 = 0;
        iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                          ((longlong *)param_1[0x8c4],L"PGA_CONTL(Sensor)",&local_28);
        if (-1 < iVar1) {
          *(undefined *)((longlong)param_1 + 0x45ef) = (undefined)local_20;
          PropVariantClear((PROPVARIANT *)&local_28);
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
             (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5a,&DAT_180045a70,
                          (uint)*(byte *)((longlong)param_1 + 0x45ee),
                          *(undefined *)((longlong)param_1 + 0x45ef));
          }
          iVar1 = 0;
        }
      }
    }
    else {
      iVar1 = 1;
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x59,&DAT_180045a70);
      }
    }
  }
  PropVariantClear((PROPVARIANT *)&local_28);
  if (iVar1 < 0) {
    *(undefined2 *)((longlong)param_1 + 0x45ee) = 0;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5b,&DAT_180045a70);
  }
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180014280(longlong param_1)

{
  int iVar1;
  longlong *local_res8;
  longlong *local_res10;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  undefined *local_28;
  
  local_res8 = (longlong *)0x0;
  local_res10 = (longlong *)0x0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x33,&DAT_180045a70);
  }
  iVar1 = (**(code **)**(code ***)(param_1 + 0x58))
                    (*(code ***)(param_1 + 0x58),&DAT_180045810,&local_res10);
  if (-1 < iVar1) {
    local_30 = 0x18;
    local_28 = &DAT_180045628;
    iVar1 = (**(code **)(*local_res10 + 0x18))(local_res10,&local_30,0,0x20019,0,&local_res8,0);
    if (-1 < iVar1) {
      local_48 = 0;
      local_40 = 0;
      local_38 = 0;
      iVar1 = (**(code **)(*local_res8 + 0x18))(local_res8,L"DeviceIdleEnabled",&local_48);
      if (-1 < iVar1) {
        *(undefined4 *)(param_1 + 0x45fc) = (undefined4)local_40;
        PropVariantClear((PROPVARIANT *)&local_48);
        local_48 = 0;
        local_40 = 0;
        local_38 = 0;
        iVar1 = (**(code **)(*local_res8 + 0x18))(local_res8,L"DefaultIdleTimeout",&local_48);
        if (-1 < iVar1) {
          *(undefined4 *)(param_1 + 0x460c) = (undefined4)local_40;
          PropVariantClear((PROPVARIANT *)&local_48);
          local_48 = 0;
          local_40 = 0;
          local_38 = 0;
          iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x18))
                            (*(longlong **)(param_1 + 0x4620),
                             L"ResumingDetectModeParameterTuningEnabled",&local_48);
          if (-1 < iVar1) {
            *(undefined4 *)(param_1 + 0x4610) = (undefined4)local_40;
            PropVariantClear((PROPVARIANT *)&local_48);
          }
        }
      }
    }
  }
  (**(code **)(*local_res10 + 0x10))();
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x34,&DAT_180045a70,
                  *(undefined4 *)(param_1 + 0x45fc));
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_180014440(longlong param_1)

{
  int iVar1;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5c,&DAT_180045a70);
  }
  local_28 = 0;
  local_20 = 0;
  local_18 = 0;
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x18))
                    (*(longlong **)(param_1 + 0x4620),L"FingerOnThreshold",&local_28);
  if (-1 < iVar1) {
    *(undefined4 *)(param_1 + 0x4608) = (undefined4)local_20;
    PropVariantClear((PROPVARIANT *)&local_28);
    local_28 = 0;
    local_20 = 0;
    local_18 = 0;
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x18))
                      (*(longlong **)(param_1 + 0x4620),L"FingerOnThresholdLoose",&local_28);
    if (-1 < iVar1) {
      *(undefined4 *)(param_1 + 0x4600) = (undefined4)local_20;
      PropVariantClear((PROPVARIANT *)&local_28);
      local_28 = 0;
      local_20 = 0;
      local_18 = 0;
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x18))
                        (*(longlong **)(param_1 + 0x4620),L"FingerOnThresholdLoose",&local_28);
      if (-1 < iVar1) {
        *(undefined4 *)(param_1 + 0x4604) = (undefined4)local_20;
        PropVariantClear((PROPVARIANT *)&local_28);
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5d,&DAT_180045a70,iVar1,
                  (char)*(undefined4 *)(param_1 + 0x4600));
  }
  PropVariantClear((PROPVARIANT *)&local_28);
  return iVar1;
}



int FUN_1800145c0(longlong *param_1,uint *param_2)

{
  int iVar1;
  undefined local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)(param_1 + 10) = 5;
  *(undefined *)((longlong)param_1 + 0x52) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x19,&DAT_180045a70,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
       (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
      iVar1 = 0;
      *param_2 = (uint)(*(char *)(param_1 + 0xb) != '\0');
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1a,&DAT_180045a70,
                      (uint)*(byte *)((longlong)param_1 + 0x59));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_180014810(longlong *param_1,longlong param_2,undefined *param_3,uint param_4)

{
  int iVar1;
  uint uVar2;
  undefined *puVar3;
  undefined local_res20 [8];
  
  iVar1 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined *)(param_1 + 10) = 0;
  uVar2 = 0;
  if (param_4 != 0) {
    puVar3 = param_3;
    do {
      *(undefined *)((longlong)param_1 + 0x51) = puVar3[param_2 - (longlong)param_3];
      iVar1 = (**(code **)(*param_1 + 0x60))
                        (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res20
                        );
      if (iVar1 < 0) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xc,&DAT_180045a70,
                        (uint)*(byte *)((ulonglong)uVar2 + param_2),(char)iVar1);
        }
        break;
      }
      if ((*(int *)((longlong)param_1 + 0x53) != 0x45474953) ||
         (*(char *)((longlong)param_1 + 0x59) != '\x01')) {
        if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
           (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xd,&DAT_180045a70,
                        (uint)*(byte *)((longlong)param_1 + 0x59));
        }
        iVar1 = -0x7fff0001;
        break;
      }
      uVar2 = uVar2 + 1;
      *puVar3 = *(undefined *)(param_1 + 0xb);
      puVar3 = puVar3 + 1;
    } while (uVar2 < param_4);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar1) {
    iVar1 = 0;
  }
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



void FUN_180014990(longlong param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
                  undefined8 param_5)

{
  (**(code **)(param_1 + 0x38))(*(undefined8 *)(param_1 + 0x40),param_2,param_3,1,0,param_4,param_5)
  ;
  return;
}



undefined8 FUN_1800149d0(longlong *param_1)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  longlong *plVar6;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x62,&DAT_180045a70);
  }
  plVar6 = param_1 + 0x72;
  iVar2 = (**(code **)(*param_1 + 0x168))(param_1);
  if (iVar2 != 1) {
    return 1;
  }
  uVar4 = FUN_180005550((byte *)plVar6,*(int *)(param_1 + 0x87a),
                        *(uint *)((longlong)param_1 + 0x43d4),*(int *)(param_1 + 0x87a),0);
  *(undefined4 *)((longlong)param_1 + 0x45f4) = 0;
  uVar3 = *(int *)((longlong)param_1 + 0x43d4) * *(int *)(param_1 + 0x87a);
  if (0 < (int)uVar3) {
    uVar5 = (ulonglong)uVar3;
    do {
      bVar1 = *(byte *)plVar6;
      if ((int)(uint)bVar1 <= (int)uVar4 + (0xff - (int)uVar4) / 2) {
        uVar3 = *(uint *)((longlong)param_1 + 0x45f4);
        if (*(uint *)((longlong)param_1 + 0x45f4) < (uint)bVar1) {
          uVar3 = (uint)bVar1;
        }
        *(uint *)((longlong)param_1 + 0x45f4) = uVar3;
      }
      plVar6 = (longlong *)((longlong)plVar6 + 1);
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),99,&DAT_180045a70);
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180014b10(longlong param_1)

{
  int *piVar1;
  HDC hdc;
  HDC pHVar2;
  int iVar3;
  
  piVar1 = (int *)(param_1 + 0x40);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SelectObject(*(HDC *)(param_1 + 0x38),*(HGDIOBJ *)(param_1 + 0x48));
    if ((DAT_1800551e8 & 1) == 0) {
      DAT_1800551e8 = DAT_1800551e8 | 1;
      _DAT_1800551c8 = ZEXT816(0);
      _DAT_1800551d8 = ZEXT816(0);
      atexit(FUN_180033e50);
    }
    iVar3 = 0;
    pHVar2 = *(HDC *)(param_1 + 0x38);
    do {
      hdc = *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar3 * 8);
      *(HDC *)((longlong)&DAT_1800551c8 + (longlong)iVar3 * 8) = pHVar2;
      if (hdc == (HDC)0x0) goto LAB_180014b89;
      iVar3 = iVar3 + 1;
      pHVar2 = hdc;
    } while (iVar3 < 4);
    DeleteDC(hdc);
LAB_180014b89:
    *(undefined8 *)(param_1 + 0x38) = 0;
  }
  return;
}



undefined8 FUN_180014ba0(longlong param_1)

{
  undefined2 local_28 [4];
  undefined4 local_20;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x52,&DAT_180045a70);
  }
  local_20 = 0;
  local_28[0] = 0x13;
  (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x20))
            (*(longlong **)(param_1 + 0x4620),L"CALIBRATE_TYPE(Sensor)",local_28);
  (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x20))
            (*(longlong **)(param_1 + 0x4620),L"CALIBRATE_TYPE(Detect)",local_28);
  *(undefined4 *)(param_1 + 0x4614) = 0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x53,&DAT_180045a70);
  }
  return 0;
}



undefined8 FUN_180014c70(longlong param_1)

{
  HANDLE hObject;
  
  if (*(HANDLE *)(param_1 + 0x43c0) != (HANDLE)0x0) {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x43c0),0xffffffff);
    hObject = *(HANDLE *)(param_1 + 0x43c0);
    *(HANDLE *)(param_1 + 0x43c0) = (HANDLE)0x0;
    if (hObject != (HANDLE)0x0) {
      CloseHandle(hObject);
    }
  }
  return 0;
}



undefined8 FUN_180014cb0(longlong *param_1)

{
  int iVar1;
  DWORD DVar2;
  int iVar3;
  undefined2 local_28 [4];
  uint local_20;
  
  DVar2 = GetTickCount();
  iVar1 = *(int *)(param_1 + 0x8bf);
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x46,&DAT_180045a70,DVar2 - iVar1);
  }
  iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],5,2);
  if (-1 < iVar3) {
    iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],0xb,2);
    if (-1 < iVar3) {
      iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],8,1);
      if (-1 < iVar3) {
        iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],2,0xff)
        ;
        if (-1 < iVar3) {
          iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))((longlong *)param_1[0x8c5],7,0);
          if (-1 < iVar3) {
            iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                              ((longlong *)param_1[0x8c5],4,0);
            if (-1 < iVar3) {
              iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                                ((longlong *)param_1[0x8c5],3,
                                 *(undefined *)((longlong)param_1 + 0x45ee));
              if (-1 < iVar3) {
                iVar3 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x10))
                                  ((longlong *)param_1[0x8c5],9,
                                   *(undefined *)((longlong)param_1 + 0x45ef));
                if (-1 < iVar3) {
                  if ((DVar2 - iVar1 < 1000) && (*(int *)(param_1 + 0x8c2) != 0)) {
                    *(char *)((longlong)param_1 + 0x45f2) =
                         *(char *)((longlong)param_1 + 0x45f2) + '\x02';
                    local_28[0] = 0x13;
                    local_20 = (uint)*(byte *)((longlong)param_1 + 0x45f2);
                    (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
                              ((longlong *)param_1[0x8c4],L"DETC(Detect)",local_28);
                    PropVariantClear((PROPVARIANT *)local_28);
                  }
                  (**(code **)(*param_1 + 0x178))(param_1,"ResumeFromSuspend");
                  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) &&
                     (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
                    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x47,&DAT_180045a70);
                  }
                  return 1;
                }
              }
            }
          }
        }
      }
    }
  }
  return 2;
}



void FUN_180014e90(longlong param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
                  undefined8 param_5)

{
  (**(code **)(param_1 + 0x38))(*(undefined8 *)(param_1 + 0x40),param_2,param_3,1,1,param_4,param_5)
  ;
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180014ed0(longlong *param_1,int param_2)

{
  int iVar1;
  DWORD DVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined auStack104 [32];
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined4 local_30;
  undefined2 local_2c;
  undefined local_2a;
  undefined local_28;
  undefined uStack39;
  undefined uStack38;
  undefined uStack37;
  undefined2 uStack36;
  undefined uStack34;
  ulonglong local_20;
  
  local_20 = DAT_1800537e8 ^ (ulonglong)auStack104;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x27,&DAT_180045a70);
  }
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"FPS_CTL(Detect)",&local_48);
  *(undefined *)((longlong)param_1 + 0x45f1) = (undefined)local_40;
  PropVariantClear((PROPVARIANT *)&local_48);
  if (-1 < iVar1) {
    local_48 = 0;
    local_40 = 0;
    local_38 = 0;
    iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                      ((longlong *)param_1[0x8c4],L"PGA_CONTL(Detect)",&local_48);
    *(undefined *)(param_1 + 0x8be) = (undefined)local_40;
    PropVariantClear((PROPVARIANT *)&local_48);
    if (-1 < iVar1) {
      local_48 = 0;
      local_40 = 0;
      local_38 = 0;
      iVar1 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                        ((longlong *)param_1[0x8c4],L"DETC(Detect)",&local_48);
      *(undefined *)((longlong)param_1 + 0x45f2) = (undefined)local_40;
      PropVariantClear((PROPVARIANT *)&local_48);
      if (-1 < iVar1) {
        if (param_2 == 0) {
          local_28 = 3;
          uStack39 = 4;
          uStack38 = 5;
          uStack37 = 7;
          uStack36 = 0x908;
          uStack34 = 0xb;
          local_30 = 0x3000101;
          local_2c = 0x301;
          local_2a = 0;
          puVar4 = &local_30;
          puVar3 = (undefined4 *)&local_28;
        }
        else {
          local_28 = *(undefined *)((longlong)param_1 + 0x45f1);
          local_30 = 0x2080903;
          local_2c = 0x50c;
          uStack39 = *(undefined *)(param_1 + 0x8be);
          local_2a = 0xb;
          uStack38 = *(undefined *)((longlong)param_1 + 0x45f2);
          uStack37 = 2;
          uStack36 = 0xff;
          uStack34 = 1;
          puVar4 = (undefined4 *)&local_28;
          puVar3 = &local_30;
        }
        iVar1 = (**(code **)(*(longlong *)param_1[0x8c5] + 0x20))
                          ((longlong *)param_1[0x8c5],puVar3,puVar4);
        if (iVar1 < 0) goto LAB_1800150de;
        DVar2 = GetTickCount();
        *(DWORD *)(param_1 + 0x8bf) = DVar2;
      }
    }
  }
  (**(code **)(*param_1 + 0x178))(param_1,"SetDetectModeParameters");
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x28,&DAT_180045a70,param_2);
  }
LAB_1800150de:
  FUN_180023ef0(local_20 ^ (ulonglong)auStack104);
  return;
}



int FUN_180015120(longlong *param_1,undefined param_2)

{
  int iVar1;
  undefined local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)(param_1 + 10) = 4;
  *(undefined *)((longlong)param_1 + 0x52) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x17,&DAT_180045a70,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
       (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
      iVar1 = 0;
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x18,&DAT_180045a70,
                      (uint)*(byte *)((longlong)param_1 + 0x59));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



undefined8 FUN_180015550(void)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x24,&DAT_180045a70);
  }
  return 1;
}



void FUN_1800155a0(longlong param_1)

{
  HANDLE hObject;
  
  *(undefined *)(param_1 + 0x18) = 1;
  if (*(HANDLE *)(param_1 + 0x43c0) != (HANDLE)0x0) {
    WaitForSingleObject(*(HANDLE *)(param_1 + 0x43c0),0xffffffff);
    hObject = *(HANDLE *)(param_1 + 0x43c0);
    *(HANDLE *)(param_1 + 0x43c0) = (HANDLE)0x0;
    if (hObject != (HANDLE)0x0) {
      CloseHandle(hObject);
    }
  }
  *(undefined4 *)(param_1 + 0x338) = 0;
  return;
}



void FUN_1800155f0(longlong param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined auStack168 [32];
  undefined local_88 [4];
  undefined4 local_84;
  undefined4 local_80;
  ushort local_76;
  longlong local_70;
  int local_64;
  uint local_60;
  ushort local_5a;
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack168;
  iVar1 = GetObjectW(*(HANDLE *)(param_1 + 8),0x68,local_88);
  if (iVar1 == 0x68) {
    *(undefined *)(param_1 + 0x28) = 1;
    *(int *)(param_1 + 0x18) = local_64;
    *(uint *)(param_1 + 0x24) = (uint)local_5a;
    iVar2 = (local_60 ^ (int)local_60 >> 0x1f) - ((int)local_60 >> 0x1f);
    *(int *)(param_1 + 0x1c) = iVar2;
    iVar1 = (uint)local_5a * local_64 + 0x1f;
    *(longlong *)(param_1 + 0x10) = local_70;
    iVar1 = (int)((iVar1 >> 0x1f & 0x1fU) + iVar1) >> 5;
    iVar3 = iVar1 * 4;
    *(int *)(param_1 + 0x20) = iVar3;
    if (param_2 == 0) {
      param_2 = (0 < (int)local_60) + 1;
    }
    *(undefined4 *)(param_1 + 0x2c) = 0xffffffff;
    *(undefined *)(param_1 + 0x29) = 0;
    if (param_2 == 2) {
      *(int *)(param_1 + 0x20) = iVar1 * -4;
      *(longlong *)(param_1 + 0x10) = (iVar2 + -1) * iVar3 + local_70;
    }
  }
  else {
    *(undefined2 *)(param_1 + 0x28) = 0;
    *(undefined4 *)(param_1 + 0x18) = local_84;
    *(undefined4 *)(param_1 + 0x20) = 0;
    *(undefined4 *)(param_1 + 0x1c) = local_80;
    *(undefined8 *)(param_1 + 0x10) = 0;
    *(uint *)(param_1 + 0x24) = (uint)local_76;
    *(undefined4 *)(param_1 + 0x2c) = 0xffffffff;
  }
  FUN_180023ef0(local_18 ^ (ulonglong)auStack168);
  return;
}



int FUN_180015700(longlong *param_1,byte param_2,undefined param_3)

{
  int iVar1;
  undefined local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined *)(param_1 + 10) = 1;
  *(byte *)((longlong)param_1 + 0x51) = param_2;
  *(undefined *)((longlong)param_1 + 0x52) = param_3;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4c,7,(longlong)param_1 + 0x53,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xe,&DAT_180045a70,(uint)param_2,
                    (char)iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x53) == 0x45474953) &&
       (*(char *)((longlong)param_1 + 0x59) == '\x01')) {
      iVar1 = 0;
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xf,&DAT_180045a70,
                      (uint)*(byte *)((longlong)param_1 + 0x59));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_180015820(longlong *param_1,undefined param_2)

{
  int iVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  iVar1 = (**(code **)(*param_1 + 8))(param_1,param_2);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_1 + 0x10))(param_1,param_2);
    if (-1 < iVar1) {
      iVar1 = 0;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_180015a40(longlong param_1)

{
  ulonglong uVar1;
  undefined *puVar2;
  undefined8 uStack64;
  undefined auStack56 [32];
  undefined local_18 [8];
  ulonglong local_10;
  
  puVar2 = auStack56;
  local_10 = DAT_1800537e8 ^ (ulonglong)local_18;
  if (-param_1 - 1U < 0x4000) {
    local_18[0] = 0;
  }
  else {
    uVar1 = param_1 + 0x400f;
    if (uVar1 <= param_1 + 0x4000U) {
      uVar1 = 0xffffffffffffff0;
    }
    uStack64 = 0x180015a94;
    puVar2 = auStack56 + (-8 - (uVar1 & 0xfffffffffffffff0));
  }
  *(undefined8 *)(puVar2 + -8) = 0x180015aba;
  FUN_180023ef0(DAT_1800537e8);
  return;
}



void FUN_180015ad0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined *param_4,
                  undefined param_5,undefined param_6,undefined param_7,undefined param_8,
                  undefined param_9,undefined param_10,undefined param_11,undefined param_12,
                  undefined param_13,undefined param_14,undefined param_15,undefined param_16,
                  undefined param_17,undefined param_18,undefined param_19,undefined param_20)

{
  longlong lVar1;
  longlong lVar2;
  undefined *puVar3;
  
  if (param_4 == (undefined *)0x0) {
    lVar2 = 5;
  }
  else {
    lVar1 = -1;
    do {
      lVar2 = lVar1;
      lVar1 = lVar2 + 1;
    } while (param_4[lVar1] != '\0');
    lVar2 = lVar2 + 2;
  }
  puVar3 = &DAT_180045d50;
  if (param_4 != (undefined *)0x0) {
    puVar3 = param_4;
  }
  TraceMessage(param_1,0x2b,param_3,param_2,puVar3,lVar2,&param_5,4,&param_6,4,&param_7,4,&param_8,4
               ,&param_9,4,&param_10,4,&param_11,4,&param_12,4,&param_13,4,&param_14,4,&param_15,4,
               &param_16,4,&param_17,4,&param_18,4,&param_19,4,&param_20,4,0);
  return;
}



bool FUN_180015ce0(longlong param_1,int param_2,int param_3,int param_4,int param_5,int param_6)

{
  byte bVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  uint uVar6;
  byte *pbVar7;
  int iVar8;
  int iVar9;
  byte bVar10;
  byte bVar11;
  int iVar12;
  int iVar13;
  int local_res20;
  
  local_res20 = 0;
  iVar2 = (param_5 + -1) / 2;  // 3? I guess this may not be the function we're looking for
  iVar12 = param_4 - iVar2;
  iVar2 = iVar2 + param_4;
  iVar8 = 0;
  if ((-1 < iVar12) && (iVar2 < param_2)) {
    if (iVar12 <= iVar2) {
      lVar3 = (longlong)iVar12;
      uVar5 = (ulonglong)((iVar2 - iVar12) + 1);
      do {
        iVar12 = 2;
        iVar2 = 0;
        if (2 < param_3 + -8) {
          iVar8 = param_2 * 2;
          do {
            bVar10 = 0;
            bVar11 = 0xff;
            iVar9 = 0;
            iVar13 = 0;
            pbVar7 = (byte *)(iVar8 + lVar3 + param_1);
            iVar4 = 0;
            do {
              bVar1 = *pbVar7;
              if (bVar1 < bVar11) {
                bVar11 = bVar1;
                iVar9 = iVar4;
              }
              if (bVar10 < bVar1) {
                bVar10 = bVar1;
                iVar13 = iVar4;
              }
              iVar4 = iVar4 + 1;
              pbVar7 = pbVar7 + param_2;
            } while (iVar4 < 8);
            if ((bVar11 < bVar10) &&
               (uVar6 = iVar13 - iVar9 >> 0x1f, ((iVar13 - iVar9 ^ uVar6) - uVar6) - 2 < 4)) {
              bVar10 = bVar10 - bVar11;
            }
            else {
              bVar10 = 0;
            }
            if (param_6 < (int)(uint)bVar10) {
              iVar12 = iVar12 + 8;
              iVar8 = iVar8 + param_2 * 8;
              iVar2 = iVar2 + 1;
            }
            iVar12 = iVar12 + 1;
            iVar8 = iVar8 + param_2;
          } while (iVar12 < param_3 + -8);
          iVar8 = local_res20;
          if (4 < iVar2) {
            iVar8 = local_res20 + 1;
            local_res20 = iVar8;
          }
        }
        lVar3 = lVar3 + 1;
        uVar5 = uVar5 - 1;
      } while (uVar5 != 0);
    }
    return param_5 / 2 <= iVar8;
  }
  return false;
}



bool FUN_180015e80(longlong param_1,int param_2,int param_3,int param_4,int param_5,int param_6)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  byte bVar7;
  byte bVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  ulonglong uVar12;
  longlong lVar13;
  
  iVar11 = 0;
  iVar2 = (param_5 + -1) / 2;  // That's very similar to FUN_180015ce0
  iVar9 = param_4 - iVar2;
  iVar2 = iVar2 + param_4;
  if ((-1 < iVar9) && (iVar2 < param_3)) {
    if (iVar9 <= iVar2) {
      lVar13 = iVar9 * param_2 + param_1;
      uVar12 = (ulonglong)((iVar2 - iVar9) + 1);
      do {
        iVar9 = 2;
        iVar2 = 0;
        if (2 < param_2 + -8) {
          do {
            bVar7 = 0;
            bVar8 = 0xff;
            iVar6 = 0;
            iVar10 = 0;
            iVar3 = 0;
            pbVar5 = (byte *)(iVar9 + lVar13);
            do {
              bVar1 = *pbVar5;
              if (bVar1 < bVar8) {
                bVar8 = bVar1;
                iVar6 = iVar3;
              }
              if (bVar7 < bVar1) {
                bVar7 = bVar1;
                iVar10 = iVar3;
              }
              iVar3 = iVar3 + 1;
              pbVar5 = pbVar5 + 1;
            } while (iVar3 < 8);
            if ((bVar8 < bVar7) &&
               (uVar4 = iVar10 - iVar6 >> 0x1f, ((iVar10 - iVar6 ^ uVar4) - uVar4) - 2 < 4)) {
              bVar7 = bVar7 - bVar8;
            }
            else {
              bVar7 = 0;
            }
            if (param_6 < (int)(uint)bVar7) {
              iVar9 = iVar9 + 8;
              iVar2 = iVar2 + 1;
            }
            iVar9 = iVar9 + 1;
          } while (iVar9 < param_2 + -8);
          if (4 < iVar2) {
            iVar11 = iVar11 + 1;
          }
        }
        lVar13 = lVar13 + param_2;
        uVar12 = uVar12 - 1;
      } while (uVar12 != 0);
    }
    return param_5 / 2 <= iVar11;
  }
  return false;
}



ulonglong FUN_180015fe0(undefined8 *param_1,uint param_2,int param_3)

{
  byte bVar1;
  undefined8 *_Memory;
  ulonglong uVar2;
  int iVar3;
  ulonglong uVar4;
  size_t _Size;
  int iVar5;
  byte local_res8 [8];
  undefined local_res20 [8];
  
  uVar2 = 0;
  iVar3 = 0;
  if (((param_1 != (undefined8 *)0x0) && (param_2 != 0)) && (param_3 != 0)) {
    iVar5 = param_2 * param_3;
    _Size = SEXT48(iVar5);
    _Memory = (undefined8 *)malloc(_Size);
    if (_Memory == (undefined8 *)0x0) {
      uVar2 = 0xfffffffd;
    }
    else {
      FUN_180023f20(_Memory,param_1,_Size);
      FUN_180005890((longlong)_Memory,param_2,param_3);
      bVar1 = FUN_180005dc0((byte *)_Memory,param_2,param_3,local_res8,local_res20);
      if (bVar1 == 0) {
        free(_Memory);
        uVar2 = 0xfffffffe;
      }
      else {
        FUN_180016290((longlong)_Memory,param_2,param_3,local_res8[0],local_res8[0]);
        FUN_180016130((longlong)_Memory,param_2,param_3,local_res8[0],local_res8[0]);
        FUN_180016130((longlong)_Memory,param_2,param_3,local_res8[0],local_res8[0]);
        uVar4 = uVar2;
        if (0 < iVar5) {
          do {
            if (*(byte *)(uVar2 + (longlong)_Memory) < bVar1) {
              uVar4 = (ulonglong)((int)uVar4 + 1);
            }
            iVar3 = (int)uVar4;
            uVar2 = uVar2 + 1;
          } while ((longlong)uVar2 < (longlong)_Size);
        }
        free(_Memory);
        uVar2 = (longlong)(iVar3 * 100) / (longlong)iVar5 & 0xffffffff;
      }
    }
    return uVar2;
  }
  return 0xffffffff;
}



void FUN_180016130(longlong param_1,int param_2,int param_3,byte param_4,char param_5)

{
  byte *pbVar1;
  char *pcVar2;
  byte bVar3;
  void *_Memory;
  longlong lVar4;
  longlong lVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  int iVar11;
  
  _Memory = calloc((longlong)(param_2 * param_3),1);
  if (0 < (int)(param_3 - 1U)) {
    uVar6 = (ulonglong)(param_3 - 1U);
    lVar9 = 0;
    iVar11 = 0;
    do {
      lVar4 = 0;
      iVar10 = iVar11;
      if (0 < (longlong)(param_2 + -1)) {
        do {
          lVar5 = (longlong)iVar10;
          pbVar1 = (byte *)(lVar5 + (longlong)_Memory);
          if ((*pbVar1 < 2) && (*(byte *)(lVar5 + param_1) < param_4)) {
            lVar7 = (lVar9 + 1) * (longlong)param_2;
            lVar8 = lVar7 + lVar4;
            bVar3 = *(byte *)(lVar8 + param_1);
            if (param_4 < bVar3) {
              *(byte *)(lVar8 + param_1) = bVar3 - param_5;
              lVar7 = lVar7 + lVar4;
              if (*pbVar1 == 0) {
                pcVar2 = (char *)(lVar7 + (longlong)_Memory);
                *pcVar2 = *pcVar2 + '\x01';
              }
              else {
                pcVar2 = (char *)(lVar7 + (longlong)_Memory);
                *pcVar2 = *pcVar2 + '\x02';
              }
            }
            if (*(byte *)(lVar5 + param_1) < param_4) {
              lVar8 = param_2 * lVar9;
              lVar5 = lVar8 + lVar4;
              bVar3 = *(byte *)(lVar5 + 1 + param_1);
              if (param_4 < bVar3) {
                *(byte *)(lVar5 + param_1 + 1) = bVar3 - param_5;
                lVar8 = lVar8 + lVar4;
                if (*pbVar1 == 0) {
                  pcVar2 = (char *)(lVar8 + 1 + (longlong)_Memory);
                  *pcVar2 = *pcVar2 + '\x01';
                }
                else {
                  pcVar2 = (char *)(lVar8 + 1 + (longlong)_Memory);
                  *pcVar2 = *pcVar2 + '\x02';
                }
              }
            }
          }
          lVar4 = lVar4 + 1;
          iVar10 = iVar10 + 1;
        } while (lVar4 < param_2 + -1);
      }
      iVar11 = iVar11 + param_2;
      lVar9 = lVar9 + 1;
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
  }
  free(_Memory);
  return;
}



void FUN_180016290(longlong param_1,int param_2,int param_3,byte param_4,byte param_5)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  
  iVar2 = param_2 * param_3 + -1;
  if (-1 < iVar2) {
    pbVar1 = (byte *)(iVar2 + param_1);
    lVar4 = (longlong)iVar2 + 1;
    do {
      if (*pbVar1 < param_4) {
        iVar3 = (uint)*pbVar1 - (uint)param_5;
        iVar2 = 0;
        if (-1 < iVar3) {
          iVar2 = iVar3;
        }
        *pbVar1 = (byte)iVar2;
      }
      pbVar1 = pbVar1 + -1;
      lVar4 = lVar4 + -1;
    } while (lVar4 != 0);
  }
  return;
}



uint FUN_1800162d0(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  bool bVar2;
  int iVar3;
  int iVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  uint uVar5;
  int iVar6;
  uint uVar7;
  
  iVar6 = (int)((param_2 >> 0x1f & 3U) + param_2) >> 2;
  iVar3 = (int)(param_2 * 3 + (param_2 * 3 >> 0x1f & 3U)) >> 2;
  iVar4 = FUN_180005b80(param_1,param_2,param_3);
  if ((byte)iVar4 == 0) {
    bVar1 = 0x12;
  }
  else {
    bVar1 = (byte)iVar4 >> 1;
    if (bVar1 < 0x12) {
      bVar1 = 0x12;
    }
  }
  bVar2 = FUN_180015e80((longlong)param_1,param_2,param_3,5,param_4,(uint)bVar1);
  uVar5 = (uint)((int)CONCAT71(extraout_var,bVar2) != 0);
  bVar2 = FUN_180015e80((longlong)param_1,param_2,param_3,param_3 / 2,param_4,(uint)bVar1);
  if ((int)CONCAT71(extraout_var_00,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  uVar7 = (uint)bVar1;
  bVar2 = FUN_180015e80((longlong)param_1,param_2,param_3,param_3 + -5,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_01,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015ce0((longlong)param_1,param_2,param_3,iVar6,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_02,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015ce0((longlong)param_1,param_2,param_3,param_2 / 2,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_03,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015ce0((longlong)param_1,param_2,param_3,iVar3,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_04,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  uVar7 = (int)((uint)bVar1 + (uint)bVar1 * 2) >> 1 & 0xff;
  bVar2 = FUN_180015e80((longlong)param_1,param_2,param_3,5,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_05,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015e80((longlong)param_1,param_2,param_3,param_3 / 2,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_06,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015e80((longlong)param_1,param_2,param_3,param_3 + -5,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_07,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015ce0((longlong)param_1,param_2,param_3,iVar6,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_08,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015ce0((longlong)param_1,param_2,param_3,param_2 / 2,param_4,uVar7);
  if ((int)CONCAT71(extraout_var_09,bVar2) != 0) {
    uVar5 = uVar5 + 1;
  }
  bVar2 = FUN_180015ce0((longlong)param_1,param_2,param_3,iVar3,param_4,uVar7);
  uVar7 = uVar5 + 1;
  if ((int)CONCAT71(extraout_var_10,bVar2) == 0) {
    uVar7 = uVar5;
  }
  return uVar7;
}



char FUN_180016520(longlong *param_1,int param_2,int param_3,int param_4)

{
  char cVar1;
  byte *pbVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  char cVar13;
  
  iVar11 = 0;
  lVar6 = (longlong)param_2;
  lVar7 = 0x10;
  lVar8 = *param_1;
  do {
    iVar9 = 0;
    iVar10 = 0;
    lVar3 = 4;
    iVar12 = 0;
    pbVar2 = (byte *)(lVar8 + 1);
    do {
      iVar11 = iVar11 + (uint)pbVar2[-1];
      iVar9 = iVar9 + (uint)pbVar2[2];
      iVar12 = iVar12 + (uint)*pbVar2;
      iVar10 = iVar10 + (uint)pbVar2[1];
      lVar3 = lVar3 + -1;
      pbVar2 = pbVar2 + 4;
    } while (lVar3 != 0);
    lVar8 = lVar8 + lVar6;
    iVar11 = iVar11 + iVar9 + iVar10 + iVar12;
    lVar7 = lVar7 + -1;
  } while (lVar7 != 0);
  cVar13 = (int)(iVar11 + (iVar11 >> 0x1f & 0xffU)) >> 8 < param_4;
  iVar11 = 0;
  lVar8 = (longlong)(param_2 + -0x11) + *param_1;
  lVar3 = 0x10;
  lVar7 = 0x10;
  do {
    iVar9 = 0;
    iVar10 = 0;
    lVar4 = 4;
    iVar12 = 0;
    pbVar2 = (byte *)(lVar8 + 1);
    do {
      iVar11 = iVar11 + (uint)pbVar2[-1];
      iVar9 = iVar9 + (uint)pbVar2[2];
      iVar12 = iVar12 + (uint)*pbVar2;
      iVar10 = iVar10 + (uint)pbVar2[1];
      lVar4 = lVar4 + -1;
      pbVar2 = pbVar2 + 4;
    } while (lVar4 != 0);
    lVar8 = lVar8 + lVar6;
    iVar11 = iVar11 + iVar9 + iVar10 + iVar12;
    lVar7 = lVar7 + -1;
  } while (lVar7 != 0);
  if ((int)(iVar11 + (iVar11 >> 0x1f & 0xffU)) >> 8 < param_4) {
    cVar13 = cVar13 + '\x01';
  }
  iVar11 = 0;
  lVar7 = param_1[(longlong)param_3 + -0x11];
  lVar4 = 0x10;
  lVar8 = lVar7 + (param_2 + -0x11);
  do {
    iVar9 = 0;
    iVar10 = 0;
    lVar5 = 4;
    iVar12 = 0;
    pbVar2 = (byte *)(lVar8 + 1);
    do {
      iVar11 = iVar11 + (uint)pbVar2[-1];
      iVar9 = iVar9 + (uint)pbVar2[2];
      iVar12 = iVar12 + (uint)*pbVar2;
      iVar10 = iVar10 + (uint)pbVar2[1];
      lVar5 = lVar5 + -1;
      pbVar2 = pbVar2 + 4;
    } while (lVar5 != 0);
    lVar8 = lVar8 + lVar6;
    iVar11 = iVar11 + iVar9 + iVar10 + iVar12;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  if ((int)(iVar11 + (iVar11 >> 0x1f & 0xffU)) >> 8 < param_4) {
    cVar13 = cVar13 + '\x01';
  }
  iVar11 = 0;
  do {
    iVar9 = 0;
    iVar10 = 0;
    lVar8 = 4;
    iVar12 = 0;
    pbVar2 = (byte *)(lVar7 + 1);
    do {
      iVar11 = iVar11 + (uint)pbVar2[-1];
      iVar9 = iVar9 + (uint)pbVar2[2];
      iVar12 = iVar12 + (uint)*pbVar2;
      iVar10 = iVar10 + (uint)pbVar2[1];
      lVar8 = lVar8 + -1;
      pbVar2 = pbVar2 + 4;
    } while (lVar8 != 0);
    lVar7 = lVar7 + lVar6;
    iVar11 = iVar11 + iVar9 + iVar10 + iVar12;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  cVar1 = cVar13 + '\x01';
  if (param_4 <= (int)(iVar11 + (iVar11 >> 0x1f & 0xffU)) >> 8) {
    cVar1 = cVar13;
  }
  return cVar1;
}



ulonglong FUN_180016740(longlong param_1,int param_2,uint param_3)

{
  byte *pbVar1;
  longlong lVar2;
  longlong lVar3;
  ulonglong uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  
  iVar7 = 0;
  uVar4 = (ulonglong)param_3;
  lVar3 = (longlong)(int)param_3;
  if (0 < (int)param_3) {
    do {
      iVar5 = 0;
      iVar6 = 0;
      lVar2 = 0;
      if (1 < lVar3) {
        do {
          pbVar1 = (byte *)(param_1 + lVar2);
          lVar2 = lVar2 + 2;
          iVar5 = iVar5 + (uint)*pbVar1;
          iVar6 = iVar6 + (uint)*(byte *)(param_1 + -1 + lVar2);
        } while (lVar2 < lVar3 + -1);
      }
      if (lVar2 < lVar3) {
        iVar7 = iVar7 + (uint)*(byte *)(lVar2 + param_1);
      }
      param_1 = param_1 + param_2;
      iVar7 = iVar7 + iVar6 + iVar5;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  return (longlong)iVar7 / (longlong)(int)(param_3 * param_3) & 0xffffffff;
}



int FUN_1800167e0(undefined8 *param_1,uint param_2,uint param_3,undefined4 *param_4,int param_5)

{
  byte bVar1;
  char cVar2;
  byte **_Memory;
  undefined8 *_Memory_00;
  ulonglong uVar3;
  undefined7 extraout_var;
  undefined8 *_Memory_01;
  undefined8 *_Memory_02;
  undefined8 *puVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  byte local_res10 [8];
  undefined local_res18 [16];
  undefined4 in_stack_ffffffffffffffb0;
  
  _Memory = (byte **)FUN_180016a50(param_2,param_3);
  _Memory_00 = (undefined8 *)FUN_180016a50(param_2,param_3);
  uVar5 = (int)(((int)param_2 >> 0x1f & 0xfU) + param_2) >> 4;
  iVar6 = (int)(((int)param_3 >> 0x1f & 0xfU) + param_3) >> 4;
  uVar3 = FUN_180005550((byte *)param_1,param_2,param_3,param_2,0);
  if (0xf4 < (int)uVar3) {
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = 0;
    }
    iVar7 = uVar5 * iVar6;
    goto LAB_180016a10;
  }
  if (param_4 != (undefined4 *)0x0) {
    FUN_180023f20((undefined8 *)*_Memory,param_1,(longlong)(int)(param_2 * param_3));
    FUN_1800063c0(*_Memory,param_2,param_3,8);
    bVar1 = FUN_180005bc0(*_Memory,param_2,param_3,local_res10,local_res18);
    iVar8 = (uint)local_res10[0] -
            ((int)(((uint)local_res10[0] - (uint)bVar1) +
                  ((int)((uint)local_res10[0] - (uint)bVar1) >> 0x1f & 7U)) >> 3);
    iVar7 = 0xf5;
    if (0xf5 < iVar8) {
      iVar7 = iVar8;
    }
    cVar2 = FUN_180016520((longlong *)_Memory,param_2,param_3,iVar7);
    *param_4 = (int)CONCAT71(extraout_var,cVar2);
  }
  uVar3 = SEXT48((int)(param_2 * param_3));
  FUN_180023f20((undefined8 *)*_Memory,param_1,uVar3);
  FUN_180017c20(param_2,param_3,(longlong)_Memory);
  FUN_180023f20((undefined8 *)*_Memory_00,(undefined8 *)*_Memory,uVar3);
  FUN_180017de0(param_2,param_3,(longlong)_Memory_00,4);
  FUN_1800175f0(param_2,param_3,(longlong)_Memory,(longlong)_Memory_00,0x40);
  if (param_5 == 1) {
    FUN_180023f20(param_1,(undefined8 *)*_Memory_00,uVar3);
  }
  FUN_180017c20(param_2,param_3,(longlong)_Memory_00);
  _Memory_01 = (undefined8 *)FUN_180016a50(uVar5,iVar6);
  _Memory_02 = (undefined8 *)FUN_180016a50(uVar5,iVar6);
  FUN_180016c70(param_2,param_3,(longlong)_Memory_00,uVar5,iVar6,(longlong)_Memory_01,
                (longlong)_Memory_02,CONCAT31((int3)((uint)in_stack_ffffffffffffffb0 >> 8),0x32));
  iVar7 = FUN_180016ae0(uVar5,iVar6,(longlong)_Memory_01,(longlong)_Memory_02,0x50);
  if (param_5 == 2) {
    puVar4 = (undefined8 *)*_Memory_01;
LAB_1800169f8:
    FUN_180023f20(param_1,puVar4,(longlong)(int)(uVar5 * iVar6));
  }
  else {
    if (param_5 == 3) {
      puVar4 = (undefined8 *)*_Memory_02;
      goto LAB_1800169f8;
    }
  }
  free(_Memory_02);
  free(_Memory_01);
LAB_180016a10:
  free(_Memory_00);
  free(_Memory);
  return 0x100 - (iVar7 << 8) / (int)(uVar5 * iVar6);
}



void * FUN_180016a50(int param_1,int param_2)

{
  void *pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = malloc((longlong)(param_1 * param_2 + param_2 * 8));
  if (pvVar1 != (void *)0x0) {
    lVar2 = 0;
    lVar3 = (longlong)pvVar1 + (longlong)(param_2 * 8);
    if (0 < param_2) {
      do {
        *(longlong *)((longlong)pvVar1 + lVar2 * 8) = lVar3;
        lVar2 = lVar2 + 1;
        lVar3 = lVar3 + param_1;
      } while (lVar2 < param_2);
    }
    return pvVar1;
  }
  return (void *)0x0;
}



int FUN_180016ae0(int param_1,int param_2,longlong param_3,longlong param_4,byte param_5)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  longlong lVar13;
  int local_res10;
  
  iVar12 = 0;
  lVar13 = 0;
  local_res10 = 0;
  if (0 < param_2) {
    iVar12 = 0;
    do {
      if (lVar13 < 1) {
        lVar5 = 0;
      }
      else {
        lVar5 = lVar13 + -1;
      }
      iVar2 = param_2 + -1;
      if (local_res10 <= param_2 + -2) {
        iVar2 = local_res10 + 1;
      }
      iVar6 = 0;
      lVar8 = 0;
      if (0 < (longlong)param_1) {
        do {
          if (lVar8 < 1) {
            lVar11 = 0;
          }
          else {
            lVar11 = lVar8 + -1;
          }
          iVar3 = param_1 + -1;
          if (iVar6 <= param_1 + -2) {
            iVar3 = iVar6 + 1;
          }
          iVar9 = 0;
          iVar7 = 0;
          for (lVar10 = lVar5; lVar10 <= iVar2; lVar10 = lVar10 + 1) {
            if (lVar11 <= iVar3) {
              iVar7 = iVar7 + 1 + (iVar3 - (int)lVar11);
              lVar4 = lVar11;
              do {
                pbVar1 = (byte *)(*(longlong *)(param_4 + lVar10 * 8) + lVar4);
                if (param_5 <= *pbVar1 && *pbVar1 != param_5) {
                  iVar9 = iVar9 + 1;
                }
                lVar4 = lVar4 + 1;
              } while (lVar4 <= iVar3);
            }
          }
          if (iVar9 <= iVar7 / 2) {
            iVar12 = iVar12 + 1;
            *(undefined *)(lVar8 + *(longlong *)(param_3 + lVar13 * 8)) = 0xff;
          }
          lVar8 = lVar8 + 1;
          iVar6 = iVar6 + 1;
        } while (lVar8 < param_1);
      }
      lVar13 = lVar13 + 1;
      local_res10 = local_res10 + 1;
    } while (lVar13 < param_2);
  }
  return iVar12;
}



void FUN_180016c70(int param_1,int param_2,longlong param_3,uint param_4,int param_5,
                  longlong param_6,longlong param_7,uint param_8)

{
  undefined (**ppauVar1) [16];
  undefined (*pauVar2) [16];
  undefined (*pauVar3) [16];
  undefined (*pauVar4) [16];
  undefined (*pauVar5) [16];
  int *piVar6;
  int *piVar7;
  uint uVar8;
  uint uVar9;
  undefined (**_Memory) [16];
  undefined (*pauVar10) [16];
  byte *pbVar11;
  byte bVar12;
  int iVar13;
  longlong lVar14;
  longlong lVar15;
  int *piVar16;
  undefined (*pauVar17) [16];
  int iVar18;
  ulonglong uVar19;
  longlong lVar20;
  int iVar21;
  int iVar22;
  undefined (**ppauVar23) [16];
  undefined (*pauVar24) [16];
  undefined (*pauVar25) [16];
  undefined (*pauVar26) [16];
  undefined (*pauVar27) [16];
  int iVar28;
  longlong lVar29;
  longlong lVar30;
  undefined (*pauVar31) [16];
  undefined (*pauVar32) [16];
  int iVar33;
  int iVar34;
  longlong lVar35;
  ulonglong uVar36;
  int iVar37;
  int iVar38;
  longlong *plVar39;
  int local_f0;
  int local_d8;
  longlong *local_d0;
  longlong local_a8;
  
  uVar8 = param_8 & 0xff;
  local_f0 = 0x10;
  _Memory = (undefined (**) [16])malloc((longlong)(int)((param_4 * 4 + 6) * 0xc));
  ppauVar1 = _Memory + 3;
  ppauVar23 = _Memory + 6;
  pauVar24 = (undefined (*) [16])(_Memory + 9);
  FUN_1800244a0(pauVar24,0,(longlong)(int)(param_4 * 0xc));
  lVar14 = (longlong)(int)(param_4 * 4);
  uVar19 = SEXT48((int)param_4);
  pauVar25 = (undefined (*) [16])(*pauVar24 + lVar14);
  pauVar26 = (undefined (*) [16])(*pauVar25 + lVar14);
  *_Memory = (undefined (*) [16])(*pauVar26 + lVar14);
  pauVar31 = (undefined (*) [16])(*(undefined (*) [16])(*pauVar26 + lVar14) + lVar14);
  *ppauVar1 = pauVar31;
  pauVar31 = (undefined (*) [16])(*pauVar31 + lVar14);
  *ppauVar23 = pauVar31;
  pauVar31 = (undefined (*) [16])(*pauVar31 + lVar14);
  _Memory[1] = pauVar31;
  pauVar31 = (undefined (*) [16])(*pauVar31 + lVar14);
  _Memory[4] = pauVar31;
  pauVar31 = (undefined (*) [16])(*pauVar31 + lVar14);
  _Memory[7] = pauVar31;
  pauVar31 = (undefined (*) [16])(*pauVar31 + lVar14);
  _Memory[2] = pauVar31;
  pauVar31 = (undefined (*) [16])(*pauVar31 + lVar14);
  _Memory[5] = pauVar31;
  _Memory[8] = (undefined (*) [16])(*pauVar31 + lVar14);
  param_8 = 0;
  local_a8 = -1;
  if (-1 < param_5) {
    local_d0 = (longlong *)(param_7 + -8);
    uVar36 = uVar19;
    iVar28 = 0;
    do {
      pauVar31 = _Memory[2];
      pauVar17 = _Memory[5];
      pauVar32 = _Memory[8];
      if (iVar28 == 0) {
        iVar28 = 1;
      }
      iVar37 = local_f0;
      if (local_f0 == param_2) {
        iVar37 = param_2 + -1;
      }
      if (-1 < (int)(param_8 - 3)) {
        lVar30 = 0;
        lVar29 = 0;
        uVar9 = (uint)uVar36;
        lVar14 = lVar30;
        if ((0 < (int)uVar9) && (3 < uVar9)) {
          iVar18 = 0;
          lVar15 = (longlong)(int)(uVar9 - 1);
          pauVar2 = (undefined (*) [16])(*pauVar25 + lVar15 * 4);
          pauVar10 = (undefined (*) [16])(*pauVar26 + lVar15 * 4);
          if (((((pauVar2 < pauVar26) || (pauVar10 < pauVar25)) &&
               ((pauVar27 = (undefined (*) [16])(*pauVar24 + lVar15 * 4), lVar14 = lVar29,
                pauVar27 < pauVar26 || (pauVar10 < pauVar24)))) &&
              (((((pauVar3 = (undefined (*) [16])(*pauVar32 + lVar15 * 4), pauVar3 < pauVar26 ||
                  (pauVar10 < pauVar32)) &&
                 ((((pauVar4 = (undefined (*) [16])(*pauVar17 + lVar15 * 4), pauVar4 < pauVar26 ||
                    (pauVar10 < pauVar17)) &&
                   ((pauVar5 = (undefined (*) [16])(*pauVar31 + lVar15 * 4), pauVar5 < pauVar26 ||
                    (pauVar10 < pauVar31)))) && ((pauVar27 < pauVar25 || (pauVar2 < pauVar24))))))
                && ((pauVar3 < pauVar25 || (pauVar2 < pauVar32)))) &&
               ((((pauVar4 < pauVar25 || (pauVar2 < pauVar17)) &&
                 ((pauVar5 < pauVar25 || (pauVar2 < pauVar31)))) &&
                (((pauVar3 < pauVar24 || (pauVar27 < pauVar32)) &&
                 ((pauVar4 < pauVar24 || (pauVar27 < pauVar17)))))))))) &&
             ((pauVar5 < pauVar24 || (pauVar27 < pauVar31)))) {
            uVar9 = param_4 & 0x80000003;
            if ((int)uVar9 < 0) {
              uVar9 = (uVar9 - 1 | 0xfffffffc) + 1;
            }
            do {
              lVar14 = (longlong)iVar18;
              iVar18 = iVar18 + 4;
              lVar30 = lVar30 + 4;
              piVar16 = (int *)(*pauVar31 + lVar14 * 4);
              iVar21 = piVar16[1];
              iVar22 = piVar16[2];
              iVar38 = piVar16[3];
              piVar7 = (int *)(*pauVar24 + lVar14 * 4);
              iVar33 = piVar7[1];
              iVar13 = piVar7[2];
              iVar34 = piVar7[3];
              piVar6 = (int *)(*pauVar24 + lVar14 * 4);
              *piVar6 = *piVar7 - *piVar16;
              piVar6[1] = iVar33 - iVar21;
              piVar6[2] = iVar13 - iVar22;
              piVar6[3] = iVar34 - iVar38;
              piVar16 = (int *)(*pauVar17 + lVar14 * 4);
              iVar21 = piVar16[1];
              iVar22 = piVar16[2];
              iVar38 = piVar16[3];
              piVar7 = (int *)(*pauVar25 + lVar14 * 4);
              iVar33 = piVar7[1];
              iVar13 = piVar7[2];
              iVar34 = piVar7[3];
              piVar6 = (int *)(*pauVar25 + lVar14 * 4);
              *piVar6 = *piVar7 - *piVar16;
              piVar6[1] = iVar33 - iVar21;
              piVar6[2] = iVar13 - iVar22;
              piVar6[3] = iVar34 - iVar38;
              piVar7 = (int *)(*pauVar26 + lVar14 * 4);
              iVar21 = piVar7[1];
              iVar22 = piVar7[2];
              iVar38 = piVar7[3];
              piVar16 = (int *)(*pauVar32 + lVar14 * 4);
              iVar33 = piVar16[1];
              iVar13 = piVar16[2];
              iVar34 = piVar16[3];
              piVar6 = (int *)(*pauVar26 + lVar14 * 4);
              *piVar6 = *piVar7 - *piVar16;
              piVar6[1] = iVar21 - iVar33;
              piVar6[2] = iVar22 - iVar13;
              piVar6[3] = iVar38 - iVar34;
              lVar14 = lVar30;
            } while (iVar18 < (int)(param_4 - uVar9));
          }
        }
        if (lVar14 < (longlong)uVar19) {
          lVar29 = uVar19 - lVar14;
          piVar16 = (int *)(*pauVar24 + lVar14 * 4);
          do {
            piVar7 = piVar16 + 1;
            *piVar16 = *piVar16 -
                       *(int *)((longlong)piVar16 +
                               (longlong)
                               *(undefined (*) [16])((longlong)pauVar31 - (longlong)pauVar24));
            piVar6 = (int *)((longlong)piVar7 + (longlong)pauVar25 + (-4 - (longlong)pauVar24));
            *piVar6 = *piVar6 - *(int *)((longlong)piVar7 +
                                        (longlong)pauVar17 + (-4 - (longlong)pauVar24));
            piVar16 = (int *)((longlong)piVar16 +
                             (longlong)((longlong)pauVar26 - (longlong)pauVar24));
            *piVar16 = *piVar16 -
                       *(int *)((longlong)piVar7 + (longlong)pauVar32 + (-4 - (longlong)pauVar24));
            lVar29 = lVar29 + -1;
            piVar16 = piVar7;
          } while (lVar29 != 0);
        }
      }
      _Memory[2] = _Memory[1];
      _Memory[5] = _Memory[4];
      _Memory[8] = _Memory[7];
      _Memory[1] = *_Memory;
      _Memory[4] = *ppauVar1;
      _Memory[7] = *ppauVar23;
      *_Memory = pauVar31;
      *ppauVar1 = pauVar17;
      *ppauVar23 = pauVar32;
      if ((int)param_8 < param_5) {
        local_d8 = 0x10;
        if (0 < (longlong)uVar19) {
          lVar14 = (longlong)iVar28;
          pauVar31 = pauVar25;
          uVar36 = uVar19;
          iVar28 = 0;
          do {
            if (iVar28 == 0) {
              iVar28 = 1;
            }
            iVar22 = 0;
            iVar21 = 0;
            iVar38 = 0;
            iVar18 = local_d8;
            if (local_d8 == param_1) {
              iVar18 = param_1 + -1;
            }
            if (lVar14 < iVar37) {
              lVar29 = (longlong)iVar28;
              lVar30 = iVar37 - lVar14;
              plVar39 = (longlong *)(param_3 + 8 + lVar14 * 8);
              do {
                lVar15 = plVar39[-2];
                if (lVar29 < iVar18) {
                  lVar20 = *plVar39 - lVar15;
                  lVar35 = iVar18 - lVar29;
                  pbVar11 = (byte *)(lVar15 + 1 + lVar29);
                  do {
                    iVar28 = ((uint)pbVar11[lVar20] - (uint)pbVar11[-2]) +
                             ((uint)pbVar11[plVar39[-1] - lVar15] -
                             (uint)pbVar11[(plVar39[-1] - lVar15) + -2]) * 4 +
                             ((uint)*pbVar11 - (uint)pbVar11[lVar20 + -2]);
                    iVar33 = ((uint)pbVar11[lVar20] - (uint)pbVar11[-2]) +
                             (((uint)(pbVar11 + 1)[lVar20 + -2] - (uint)pbVar11[-1]) * 4 -
                             ((uint)*pbVar11 - (uint)pbVar11[lVar20 + -2]));
                    iVar22 = iVar22 + iVar28 * iVar28;
                    iVar38 = iVar38 + iVar33 * iVar28;
                    iVar21 = iVar21 + iVar33 * iVar33;
                    lVar35 = lVar35 + -1;
                    pbVar11 = pbVar11 + 1;
                  } while (lVar35 != 0);
                }
                plVar39 = plVar39 + 1;
                lVar30 = lVar30 + -1;
              } while (lVar30 != 0);
            }
            pauVar17 = (undefined (*) [16])((longlong)pauVar31 - (longlong)pauVar25);
            pauVar32 = (undefined (*) [16])(*pauVar31 + 4);
            *(int *)(**_Memory + (longlong)*pauVar17) = iVar22;
            *(int *)(**ppauVar1 + (longlong)*pauVar17) = iVar21;
            *(int *)(**ppauVar23 + (longlong)*pauVar17) = iVar38;
            piVar16 = (int *)((longlong)pauVar24 + (-4 - (longlong)pauVar25) + (longlong)pauVar32);
            *piVar16 = *piVar16 + iVar22;
            *(int *)*pauVar31 = *(int *)*pauVar31 + iVar21;
            piVar16 = (int *)((longlong)pauVar26 + (-4 - (longlong)pauVar25) + (longlong)pauVar32);
            *piVar16 = *piVar16 + iVar38;
            uVar36 = uVar36 - 1;
            pauVar31 = pauVar32;
            iVar28 = local_d8;
            local_d8 = local_d8 + 0x10;
          } while (uVar36 != 0);
        }
      }
      if (-1 < local_a8) {
        iVar28 = 0;
        iVar18 = 0;
        iVar37 = 0;
        if (-1 < (longlong)uVar19) {
          piVar16 = (int *)(pauVar25[-1] + 4);
          lVar14 = -1;
          do {
            if (-1 < lVar14 + -2) {
              iVar28 = iVar28 - *(int *)(*(undefined (*) [16])
                                          ((longlong)pauVar24 - (longlong)pauVar25) +
                                        (longlong)piVar16);
              iVar18 = iVar18 - *piVar16;
              iVar37 = iVar37 - *(int *)(*(undefined (*) [16])
                                          ((longlong)pauVar26 - (longlong)pauVar25) +
                                        (longlong)piVar16);
            }
            lVar29 = lVar14 + 1;
            if (lVar29 < (longlong)uVar19) {
              iVar28 = iVar28 + *(int *)(*(undefined (*) [16])
                                          ((longlong)pauVar24 - (longlong)pauVar25) + 0xc +
                                        (longlong)piVar16);
              iVar18 = iVar18 + piVar16[3];
              iVar37 = iVar37 + *(int *)(*(undefined (*) [16])
                                          ((longlong)pauVar26 - (longlong)pauVar25) + 0xc +
                                        (longlong)piVar16);
            }
            if (-1 < lVar14) {
              iVar38 = (iVar28 + 0x480) / 0x900;
              iVar33 = (iVar18 + 0x480) / 0x900;
              iVar21 = (iVar37 + 0x480) / 0x900;
              uVar9 = FUN_180017530(iVar38 - iVar33,iVar21 * 2);
              *(char *)(lVar14 + *(longlong *)((param_6 - param_7) + (longlong)local_d0)) =
                   (char)uVar9;
              iVar33 = iVar33 / 0x24;
              iVar22 = iVar38 / 0x24 >> 2;
              iVar13 = iVar33 >> 2;
              iVar34 = iVar22 - iVar13;
              iVar13 = iVar13 + iVar22;
              iVar22 = (iVar21 / 0x24 >> 2) * 2;
              iVar21 = (iVar13 * iVar13) / 0xfe01;
              if ((iVar33 + iVar38 / 0x24 < (int)(uVar8 * uVar8)) || (iVar21 == 0)) {
                iVar21 = 0;
LAB_180017438:
                bVar12 = (&DAT_180046220)[iVar21];
LAB_18001744a:
                iVar22 = bVar12 + 1;
                if (iVar22 * iVar22 - iVar21 < (int)(iVar21 - (uint)bVar12 * (uint)bVar12)) {
                  bVar12 = (byte)iVar22;
                }
              }
              else {
                iVar21 = (iVar34 * iVar34 + iVar22 * iVar22) / iVar21;
                lVar30 = (longlong)iVar21;
                if (iVar21 < 0xfe01) {
                  if (iVar21 < 0x100) goto LAB_180017438;
                  if (iVar21 < 0x400) {
                    bVar12 = (&DAT_180046310)[lVar30 >> 4];
                  }
                  else {
                    if (iVar21 < 0x1000) {
                      bVar12 = (&DAT_180046330)[lVar30 >> 5];
                    }
                    else {
                      if (iVar21 < 0x4000) {
                        bVar12 = (&DAT_180046370)[lVar30 >> 6];
                      }
                      else {
                        bVar12 = (&DAT_1800463f0)[lVar30 >> 7];
                      }
                    }
                  }
                  goto LAB_18001744a;
                }
                bVar12 = 0xff;
              }
              *(byte *)(lVar14 + *local_d0) = bVar12;
            }
            piVar16 = piVar16 + 1;
            lVar14 = lVar29;
          } while (lVar29 < (longlong)uVar19);
        }
      }
      param_8 = param_8 + 1;
      local_d0 = local_d0 + 1;
      uVar36 = (ulonglong)param_4;
      local_a8 = local_a8 + 1;
      iVar28 = local_f0;
      local_f0 = local_f0 + 0x10;
    } while (local_a8 < param_5);
  }
  free(_Memory);
  return;
}



uint FUN_180017530(uint param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  if (param_1 == 0) {
    uVar2 = 0x1e;
    if (0 < (int)param_2) {
      uVar2 = 0x5a;
    }
    return uVar2;
  }
  iVar3 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  iVar1 = (param_2 ^ (int)param_2 >> 0x1f) - ((int)param_2 >> 0x1f);
  if (iVar3 < iVar1) {
    uVar2 = 0x1e0 - (byte)(&DAT_1800465f0)[(iVar1 / 2 + iVar3 * 0x80) / iVar1];
  }
  else {
    uVar2 = (uint)(byte)(&DAT_1800465f0)[(iVar3 / 2 + iVar1 * 0x80) / iVar3];
  }
  uVar2 = (int)(uVar2 + 8 + ((int)(uVar2 + 8) >> 0x1f & 0xfU)) >> 4;
  if ((int)param_1 < 0) {
    if (-1 < (int)param_2) {
      if ((char)uVar2 == '\0') {
        return uVar2;
      }
      return 0x78 - (uVar2 & 0xff);
    }
  }
  else {
    if ((int)param_2 < 0) {
      return 0x3c - (uVar2 & 0xff);
    }
    uVar2 = (uVar2 & 0xff) + 0x3c;
  }
  return uVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800175f0(uint param_1,int param_2,longlong param_3,longlong param_4,int param_5)

{
  undefined (*pauVar1) [16];
  byte *pbVar2;
  int *piVar3;
  undefined *puVar4;
  int iVar5;
  int iVar6;
  byte bVar7;
  uint uVar8;
  int iVar9;
  void *_Memory;
  longlong lVar10;
  longlong lVar11;
  byte bVar12;
  longlong lVar13;
  longlong lVar14;
  uint uVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  longlong lVar19;
  undefined *puVar20;
  ulonglong uVar21;
  longlong lVar22;
  ulonglong uVar23;
  undefined (*pauVar24) [16];
  byte *pbVar25;
  longlong lVar26;
  byte bVar27;
  int iVar28;
  int *piVar29;
  int iVar30;
  int iVar31;
  undefined8 *puVar32;
  int iVar33;
  longlong lVar34;
  undefined auVar35 [16];
  undefined in_XMM2 [16];
  undefined auVar36 [16];
  
  lVar34 = (longlong)param_5;
  uVar23 = SEXT48((int)(param_1 * 4));
  iVar31 = param_5 * 2 + 1;
  lVar16 = (longlong)param_2;
  if (iVar31 < param_2) {
    param_2 = iVar31;
  }
  iVar30 = 0;
  _Memory = malloc((longlong)(int)(param_2 * param_1) + uVar23 + lVar16 * 8);
  pauVar1 = (undefined (*) [16])(lVar16 * 8 + (longlong)_Memory);
  puVar20 = *pauVar1 + uVar23;
  FUN_1800244a0(pauVar1,0,uVar23);
  lVar13 = 0;
  if (param_2 < 1) {
    uVar23 = (ulonglong)param_1;
  }
  else {
    uVar23 = SEXT48((int)param_1);
    do {
      *(undefined **)((longlong)_Memory + lVar13 * 8) = puVar20;
      lVar13 = lVar13 + 1;
      puVar20 = puVar20 + uVar23;
    } while (lVar13 < param_2);
  }
  uVar21 = SEXT48((int)uVar23);
  lVar13 = (longlong)-param_5;
  if (lVar13 < lVar16) {
    lVar17 = (longlong)-iVar31;
    puVar32 = (undefined8 *)(lVar17 * 8 + (longlong)_Memory);
    lVar10 = (lVar13 - lVar17) * 8 - (longlong)_Memory;
    lVar22 = lVar13;
    iVar33 = _DAT_1800537e0;
    do {
      lVar19 = lVar22 + (lVar17 - lVar13);
      uVar15 = (uint)uVar23;
      if (-1 < lVar19) {
        puVar20 = *(undefined **)((longlong)puVar32 + (param_3 - (longlong)_Memory));
        puVar4 = (undefined *)*puVar32;
        lVar11 = 0;
        lVar18 = lVar11;
        if (((0 < (int)uVar15) && (7 < uVar15)) && (1 < iVar33)) {
          iVar28 = 0;
          lVar14 = (longlong)(int)(uVar15 - 1);
          lVar18 = 0;
          if ((((undefined (*) [16])(puVar20 + lVar14) < pauVar1) ||
              (*pauVar1 + lVar14 * 4 < puVar20)) &&
             (((undefined (*) [16])(puVar4 + lVar14) < pauVar1 || (*pauVar1 + lVar14 * 4 < puVar4)))
             ) {
            uVar8 = uVar15 & 0x80000007;
            if ((int)uVar8 < 0) {
              uVar8 = (uVar8 - 1 | 0xfffffff8) + 1;
            }
            lVar18 = lVar11;
            do {
              lVar11 = (longlong)iVar28;
              lVar18 = lVar18 + 8;
              piVar29 = (int *)(*pauVar1 + lVar11 * 4);
              iVar9 = piVar29[1];
              iVar5 = piVar29[2];
              iVar6 = piVar29[3];
              auVar36 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)(puVar4 + lVar11)));
              auVar35 = pmovzxbd(ZEXT416(*(uint *)(puVar4 + lVar11)),
                                 ZEXT416(*(uint *)(puVar20 + lVar11)));
              auVar36 = CONCAT412(SUB164(auVar36 >> 0x60,0) - SUB164(auVar35 >> 0x60,0),
                                  CONCAT48(SUB164(auVar36 >> 0x40,0) - SUB164(auVar35 >> 0x40,0),
                                           CONCAT44(SUB164(auVar36 >> 0x20,0) -
                                                    SUB164(auVar35 >> 0x20,0),
                                                    SUB164(auVar36,0) - SUB164(auVar35,0))));
              auVar35 = pabsd(ZEXT416(*(uint *)(puVar20 + lVar11)),auVar36);
              piVar3 = (int *)(*pauVar1 + lVar11 * 4);
              *piVar3 = *piVar29 - SUB164(auVar35,0);
              piVar3[1] = iVar9 - SUB164(auVar35 >> 0x20,0);
              piVar3[2] = iVar5 - SUB164(auVar35 >> 0x40,0);
              piVar3[3] = iVar6 - SUB164(auVar35 >> 0x60,0);
              iVar9 = iVar28 + 4;
              iVar28 = iVar28 + 8;
              lVar11 = (longlong)iVar9;
              piVar29 = (int *)(*pauVar1 + lVar11 * 4);
              iVar9 = piVar29[1];
              iVar5 = piVar29[2];
              iVar6 = piVar29[3];
              auVar36 = pmovzxbd(auVar36,ZEXT416(*(uint *)(puVar4 + lVar11)));
              auVar35 = pmovzxbd(ZEXT416(*(uint *)(puVar4 + lVar11)),
                                 ZEXT416(*(uint *)(puVar20 + lVar11)));
              in_XMM2 = CONCAT412(SUB164(auVar36 >> 0x60,0) - SUB164(auVar35 >> 0x60,0),
                                  CONCAT48(SUB164(auVar36 >> 0x40,0) - SUB164(auVar35 >> 0x40,0),
                                           CONCAT44(SUB164(auVar36 >> 0x20,0) -
                                                    SUB164(auVar35 >> 0x20,0),
                                                    SUB164(auVar36,0) - SUB164(auVar35,0))));
              auVar35 = pabsd(ZEXT416(*(uint *)(puVar20 + lVar11)),in_XMM2);
              piVar3 = (int *)(*pauVar1 + lVar11 * 4);
              *piVar3 = *piVar29 - SUB164(auVar35,0);
              piVar3[1] = iVar9 - SUB164(auVar35 >> 0x20,0);
              piVar3[2] = iVar5 - SUB164(auVar35 >> 0x40,0);
              piVar3[3] = iVar6 - SUB164(auVar35 >> 0x60,0);
            } while (iVar28 < (int)(uVar15 - uVar8));
          }
        }
        if (lVar18 < (longlong)uVar21) {
          pbVar25 = puVar20 + lVar18;
          lVar11 = uVar21 - lVar18;
          piVar29 = (int *)(*pauVar1 + lVar18 * 4);
          do {
            pbVar2 = pbVar25 + (longlong)(puVar4 + -(longlong)puVar20);
            bVar12 = *pbVar25;
            pbVar25 = pbVar25 + 1;
            uVar8 = (int)((uint)*pbVar2 - (uint)bVar12) >> 0x1f;
            *piVar29 = *piVar29 - (((uint)*pbVar2 - (uint)bVar12 ^ uVar8) - uVar8);
            lVar11 = lVar11 + -1;
            piVar29 = piVar29 + 1;
          } while (lVar11 != 0);
        }
        iVar30 = iVar30 + -1;
      }
      if (lVar22 - lVar13 < lVar16) {
        if (-1 < lVar19) {
          puVar32[-lVar17] = *puVar32;
        }
        FUN_180023f20((undefined8 *)puVar32[-lVar17],
                      *(undefined8 **)
                       ((longlong)puVar32 + ((param_4 + lVar17 * -8) - (longlong)_Memory)),uVar21);
        puVar20 = *(undefined **)((longlong)puVar32 + ((param_3 + lVar17 * -8) - (longlong)_Memory))
        ;
        puVar4 = (undefined *)puVar32[-lVar17];
        lVar18 = 0;
        lVar19 = lVar18;
        if (((0 < (int)uVar15) && (7 < uVar15)) && (1 < iVar33)) {
          iVar28 = 0;
          lVar11 = (longlong)(int)(uVar15 - 1);
          lVar19 = 0;
          if ((((undefined (*) [16])(puVar20 + lVar11) < pauVar1) ||
              (*pauVar1 + lVar11 * 4 < puVar20)) &&
             (((undefined (*) [16])(puVar4 + lVar11) < pauVar1 || (*pauVar1 + lVar11 * 4 < puVar4)))
             ) {
            uVar8 = uVar15 & 0x80000007;
            if ((int)uVar8 < 0) {
              uVar8 = (uVar8 - 1 | 0xfffffff8) + 1;
            }
            lVar19 = lVar18;
            do {
              lVar18 = (longlong)iVar28;
              lVar19 = lVar19 + 8;
              auVar36 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)(puVar4 + lVar18)));
              auVar35 = pmovzxbd(ZEXT416(*(uint *)(puVar4 + lVar18)),
                                 ZEXT416(*(uint *)(puVar20 + lVar18)));
              auVar36 = CONCAT412(SUB164(auVar36 >> 0x60,0) - SUB164(auVar35 >> 0x60,0),
                                  CONCAT48(SUB164(auVar36 >> 0x40,0) - SUB164(auVar35 >> 0x40,0),
                                           CONCAT44(SUB164(auVar36 >> 0x20,0) -
                                                    SUB164(auVar35 >> 0x20,0),
                                                    SUB164(auVar36,0) - SUB164(auVar35,0))));
              auVar35 = pabsd(ZEXT416(*(uint *)(puVar20 + lVar18)),auVar36);
              piVar29 = (int *)(*pauVar1 + lVar18 * 4);
              iVar9 = piVar29[1];
              iVar5 = piVar29[2];
              iVar6 = piVar29[3];
              piVar3 = (int *)(*pauVar1 + lVar18 * 4);
              *piVar3 = SUB164(auVar35,0) + *piVar29;
              piVar3[1] = SUB164(auVar35 >> 0x20,0) + iVar9;
              piVar3[2] = SUB164(auVar35 >> 0x40,0) + iVar5;
              piVar3[3] = SUB164(auVar35 >> 0x60,0) + iVar6;
              iVar9 = iVar28 + 4;
              iVar28 = iVar28 + 8;
              lVar18 = (longlong)iVar9;
              auVar36 = pmovzxbd(auVar36,ZEXT416(*(uint *)(puVar4 + lVar18)));
              auVar35 = pmovzxbd(ZEXT416(*(uint *)(puVar4 + lVar18)),
                                 ZEXT416(*(uint *)(puVar20 + lVar18)));
              in_XMM2 = CONCAT412(SUB164(auVar36 >> 0x60,0) - SUB164(auVar35 >> 0x60,0),
                                  CONCAT48(SUB164(auVar36 >> 0x40,0) - SUB164(auVar35 >> 0x40,0),
                                           CONCAT44(SUB164(auVar36 >> 0x20,0) -
                                                    SUB164(auVar35 >> 0x20,0),
                                                    SUB164(auVar36,0) - SUB164(auVar35,0))));
              auVar35 = pabsd(ZEXT416(*(uint *)(puVar20 + lVar18)),in_XMM2);
              piVar29 = (int *)(*pauVar1 + lVar18 * 4);
              iVar9 = piVar29[1];
              iVar5 = piVar29[2];
              iVar6 = piVar29[3];
              piVar3 = (int *)(*pauVar1 + lVar18 * 4);
              *piVar3 = SUB164(auVar35,0) + *piVar29;
              piVar3[1] = SUB164(auVar35 >> 0x20,0) + iVar9;
              piVar3[2] = SUB164(auVar35 >> 0x40,0) + iVar5;
              piVar3[3] = SUB164(auVar35 >> 0x60,0) + iVar6;
            } while (iVar28 < (int)(uVar15 - uVar8));
          }
        }
        if (lVar19 < (longlong)uVar21) {
          pbVar25 = puVar20 + lVar19;
          lVar18 = uVar21 - lVar19;
          piVar29 = (int *)(*pauVar1 + lVar19 * 4);
          do {
            pbVar2 = pbVar25 + (longlong)(puVar4 + -(longlong)puVar20);
            bVar12 = *pbVar25;
            pbVar25 = pbVar25 + 1;
            uVar15 = (int)((uint)*pbVar2 - (uint)bVar12) >> 0x1f;
            *piVar29 = *piVar29 + (((uint)*pbVar2 - (uint)bVar12 ^ uVar15) - uVar15);
            lVar18 = lVar18 + -1;
            piVar29 = piVar29 + 1;
          } while (lVar18 != 0);
        }
        iVar30 = iVar30 + 1;
      }
      if (-1 < lVar22) {
        iVar9 = 0;
        lVar19 = *(longlong *)((longlong)puVar32 + lVar10 + param_4);
        lVar18 = *(longlong *)((longlong)puVar32 + lVar10 + param_3);
        lVar14 = -lVar34;
        lVar11 = puVar32[lVar13 - lVar17];
        iVar28 = 0;
        iVar33 = _DAT_1800537e0;
        if (lVar14 < (longlong)uVar21) {
          lVar26 = 0;
          pauVar24 = pauVar1;
          do {
            if (-1 < lVar26 - iVar31) {
              iVar9 = iVar9 - *(int *)*(undefined (*) [16])
                                       ((longlong)iVar31 * -4 + (longlong)pauVar24);
              iVar28 = iVar28 - iVar30;
            }
            if (lVar26 < (longlong)uVar21) {
              iVar9 = iVar9 + *(int *)*pauVar24;
              iVar28 = iVar28 + iVar30;
            }
            if (-1 < lVar26 + lVar14) {
              bVar12 = *(byte *)(lVar11 + (lVar26 - lVar34));
              bVar7 = (byte)((longlong)iVar9 / (longlong)iVar28);
              if (bVar12 < bVar7) {
                bVar27 = 0;
              }
              else {
                bVar27 = bVar12 - bVar7;
              }
              if ((int)(0xff - ((uint)((longlong)iVar9 / (longlong)iVar28) & 0xff)) <
                  (int)(uint)bVar12) {
                bVar12 = 0xff;
              }
              else {
                bVar12 = bVar12 + bVar7;
              }
              bVar7 = *(byte *)((lVar18 - lVar34) + lVar26);
              if ((byte)(bVar12 - bVar27) != 0) {
                if (bVar27 < bVar7) {
                  if (bVar7 < bVar12) {
                    bVar7 = (byte)((int)(((uint)bVar7 - (uint)bVar27) * 0xff) /
                                  (int)(uint)(byte)(bVar12 - bVar27));
                  }
                  else {
                    bVar7 = 0xff;
                  }
                }
                else {
                  bVar7 = 0;
                }
              }
              *(byte *)((lVar19 - lVar34) + lVar26) = bVar7;
            }
            lVar26 = lVar26 + 1;
            pauVar24 = (undefined (*) [16])(*pauVar24 + 4);
          } while (lVar26 + lVar14 < (longlong)uVar21);
          uVar23 = (ulonglong)param_1;
          iVar33 = _DAT_1800537e0;
        }
      }
      lVar22 = lVar22 + 1;
      puVar32 = puVar32 + 1;
    } while (lVar22 < lVar16);
  }
  free(_Memory);
  return;
}



void FUN_180017c20(uint param_1,int param_2,longlong param_3)

{
  undefined (*pauVar1) [16];
  bool bVar2;
  undefined8 *puVar3;
  undefined8 *_Memory;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  ulonglong uVar9;
  int iVar10;
  int iVar11;
  undefined (*pauVar12) [16];
  undefined8 *puVar13;
  int iVar14;
  longlong lVar15;
  undefined8 *local_res20;
  undefined8 *local_58;
  
  uVar9 = SEXT48((int)param_1);
  iVar8 = 0;
  lVar15 = (longlong)param_2;
  if ((uVar9 & 7) != 0) {
    param_1 = (param_1 & 0xfffffff8) + 8;
  }
  _Memory = (undefined8 *)malloc((longlong)(int)(param_1 * 7));
  lVar5 = (longlong)(int)param_1;
  local_res20 = (undefined8 *)((longlong)_Memory + lVar5);
  pauVar1 = (undefined (*) [16])(lVar5 + (longlong)(undefined8 *)((longlong)local_res20 + lVar5));
  FUN_1800244a0(pauVar1,0,uVar9 * 4);
  iVar14 = -3;
  lVar7 = -1;
  puVar3 = _Memory;
  local_58 = (undefined8 *)((longlong)local_res20 + lVar5);
  if (-1 < lVar15) {
    do {
      puVar13 = puVar3;
      puVar3 = local_res20;
      if (-1 < iVar14) {
        lVar5 = 0;
        if (0 < (longlong)uVar9) {
          do {
            lVar4 = lVar5 + 1;
            *(uint *)(*pauVar1 + lVar5 * 4) =
                 *(int *)(*pauVar1 + lVar5 * 4) - (uint)*(byte *)(lVar5 + (longlong)puVar13);
            lVar5 = lVar4;
          } while (lVar4 < (longlong)uVar9);
        }
        iVar8 = iVar8 + -1;
      }
      lVar5 = lVar7 + 1;
      local_res20 = local_58;
      if (lVar5 < lVar15) {
        FUN_180023f20(puVar13,*(undefined8 **)(param_3 + 8 + lVar7 * 8),uVar9);
        lVar4 = 0;
        if (0 < (longlong)uVar9) {
          do {
            lVar6 = lVar4 + 1;
            *(uint *)(*pauVar1 + lVar4 * 4) =
                 *(int *)(*pauVar1 + lVar4 * 4) + (uint)*(byte *)(lVar4 + (longlong)puVar13);
            lVar4 = lVar6;
          } while (lVar6 < (longlong)uVar9);
        }
        iVar8 = iVar8 + 1;
      }
      if (-1 < lVar7) {
        iVar10 = 0;
        iVar11 = 0;
        lVar7 = *(longlong *)(param_3 + lVar7 * 8);
        if (-1 < (longlong)uVar9) {
          lVar4 = 0;
          pauVar12 = pauVar1;
          do {
            if (-1 < lVar4 + -3) {
              iVar10 = iVar10 - *(int *)(pauVar12[-1] + 4);
              iVar11 = iVar11 - iVar8;
            }
            if (lVar4 < (longlong)uVar9) {
              iVar10 = iVar10 + *(int *)*pauVar12;
              iVar11 = iVar11 + iVar8;
            }
            if (-1 < lVar4 + -1) {
              *(char *)(lVar7 + -1 + lVar4) = (char)(iVar10 / iVar11);
            }
            pauVar12 = (undefined (*) [16])(*pauVar12 + 4);
            bVar2 = lVar4 < (longlong)uVar9;
            lVar4 = lVar4 + 1;
          } while (bVar2);
        }
      }
      iVar14 = iVar14 + 1;
      lVar7 = lVar5;
      local_58 = puVar13;
    } while (lVar5 < lVar15);
  }
  free(_Memory);
  return;
}



void FUN_180017de0(int param_1,int param_2,longlong param_3,int param_4)

{
  undefined (*pauVar1) [16];
  longlong lVar2;
  void *_Memory;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  undefined *puVar8;
  longlong *plVar9;
  ulonglong uVar10;
  longlong lVar11;
  int iVar12;
  int iVar13;
  undefined (*pauVar14) [16];
  int iVar15;
  int iVar16;
  ulonglong uVar17;
  longlong lVar18;
  
  uVar17 = SEXT48(param_1);
  lVar4 = (longlong)param_2;
  uVar10 = SEXT48(param_1 * 4);
  iVar15 = param_4 * 2 + 1;
  if (iVar15 < param_2) {
    param_2 = iVar15;
  }
  iVar16 = 0;
  _Memory = malloc((longlong)(param_2 * param_1) + uVar10 + lVar4 * 8);
  pauVar1 = (undefined (*) [16])(lVar4 * 8 + (longlong)_Memory);
  puVar8 = *pauVar1 + uVar10;
  FUN_1800244a0(pauVar1,0,uVar10);
  lVar5 = 0;
  if (0 < param_2) {
    do {
      *(undefined **)((longlong)_Memory + lVar5 * 8) = puVar8;
      lVar5 = lVar5 + 1;
      puVar8 = puVar8 + uVar17;
    } while (lVar5 < param_2);
  }
  lVar5 = (longlong)-param_4;
  if (lVar5 < lVar4) {
    lVar7 = (longlong)-iVar15;
    plVar9 = (longlong *)(lVar7 * 8 + (longlong)_Memory);
    lVar18 = lVar5;
    do {
      lVar2 = lVar18 + (lVar7 - lVar5);
      if (-1 < lVar2) {
        lVar11 = *plVar9;
        lVar3 = 0;
        if (0 < (longlong)uVar17) {
          do {
            lVar6 = lVar3 + 1;
            *(uint *)(*pauVar1 + lVar3 * 4) =
                 *(int *)(*pauVar1 + lVar3 * 4) - (uint)*(byte *)(lVar3 + lVar11);
            lVar3 = lVar6;
          } while (lVar6 < (longlong)uVar17);
        }
        iVar16 = iVar16 + -1;
      }
      if (lVar18 - lVar5 < lVar4) {
        if (-1 < lVar2) {
          plVar9[-lVar7] = *plVar9;
        }
        FUN_180023f20((undefined8 *)plVar9[-lVar7],
                      *(undefined8 **)
                       (((param_3 + lVar7 * -8) - (longlong)_Memory) + (longlong)plVar9),uVar17);
        lVar2 = plVar9[-lVar7];
        lVar11 = 0;
        if (0 < (longlong)uVar17) {
          do {
            lVar3 = lVar11 + 1;
            *(uint *)(*pauVar1 + lVar11 * 4) =
                 *(int *)(*pauVar1 + lVar11 * 4) + (uint)*(byte *)(lVar11 + lVar2);
            lVar11 = lVar3;
          } while (lVar3 < (longlong)uVar17);
        }
        iVar16 = iVar16 + 1;
      }
      if (-1 < lVar18) {
        lVar2 = *(longlong *)
                 (((lVar5 - lVar7) * 8 - (longlong)_Memory) + param_3 + (longlong)plVar9);
        iVar12 = 0;
        iVar13 = 0;
        lVar11 = -(longlong)param_4;
        if (lVar11 < (longlong)uVar17) {
          lVar3 = 0;
          pauVar14 = pauVar1;
          do {
            if (-1 < lVar3 - iVar15) {
              iVar12 = iVar12 - *(int *)*(undefined (*) [16])
                                         ((longlong)iVar15 * -4 + (longlong)pauVar14);
              iVar13 = iVar13 - iVar16;
            }
            if (lVar3 < (longlong)uVar17) {
              iVar12 = iVar12 + *(int *)*pauVar14;
              iVar13 = iVar13 + iVar16;
            }
            if (-1 < lVar3 + lVar11) {
              *(char *)(lVar3 + (lVar2 - param_4)) = (char)(iVar12 / iVar13);
            }
            lVar3 = lVar3 + 1;
            pauVar14 = (undefined (*) [16])(*pauVar14 + 4);
          } while (lVar3 + lVar11 < (longlong)uVar17);
        }
      }
      lVar18 = lVar18 + 1;
      plVar9 = plVar9 + 1;
    } while (lVar18 < lVar4);
  }
  free(_Memory);
  return;
}



int thunk_FUN_1800167e0(undefined8 *param_1,uint param_2,uint param_3,undefined4 *param_4,
                       int param_5)

{
  byte bVar1;
  char cVar2;
  byte **_Memory;
  undefined8 *_Memory_00;
  ulonglong uVar3;
  undefined7 extraout_var;
  undefined8 *_Memory_01;
  undefined8 *_Memory_02;
  undefined8 *puVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  byte abStackX16 [8];
  undefined auStackX24 [16];
  undefined4 in_stack_ffffffffffffffb0;
  
  _Memory = (byte **)FUN_180016a50(param_2,param_3);
  _Memory_00 = (undefined8 *)FUN_180016a50(param_2,param_3);
  uVar5 = (int)(((int)param_2 >> 0x1f & 0xfU) + param_2) >> 4;
  iVar6 = (int)(((int)param_3 >> 0x1f & 0xfU) + param_3) >> 4;
  uVar3 = FUN_180005550((byte *)param_1,param_2,param_3,param_2,0);
  if (0xf4 < (int)uVar3) {
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = 0;
    }
    iVar7 = uVar5 * iVar6;
    goto LAB_180016a10;
  }
  if (param_4 != (undefined4 *)0x0) {
    FUN_180023f20((undefined8 *)*_Memory,param_1,(longlong)(int)(param_2 * param_3));
    FUN_1800063c0(*_Memory,param_2,param_3,8);
    bVar1 = FUN_180005bc0(*_Memory,param_2,param_3,abStackX16,auStackX24);
    iVar8 = (uint)abStackX16[0] -
            ((int)(((uint)abStackX16[0] - (uint)bVar1) +
                  ((int)((uint)abStackX16[0] - (uint)bVar1) >> 0x1f & 7U)) >> 3);
    iVar7 = 0xf5;
    if (0xf5 < iVar8) {
      iVar7 = iVar8;
    }
    cVar2 = FUN_180016520((longlong *)_Memory,param_2,param_3,iVar7);
    *param_4 = (int)CONCAT71(extraout_var,cVar2);
  }
  uVar3 = SEXT48((int)(param_2 * param_3));
  FUN_180023f20((undefined8 *)*_Memory,param_1,uVar3);
  FUN_180017c20(param_2,param_3,(longlong)_Memory);
  FUN_180023f20((undefined8 *)*_Memory_00,(undefined8 *)*_Memory,uVar3);
  FUN_180017de0(param_2,param_3,(longlong)_Memory_00,4);
  FUN_1800175f0(param_2,param_3,(longlong)_Memory,(longlong)_Memory_00,0x40);
  if (param_5 == 1) {
    FUN_180023f20(param_1,(undefined8 *)*_Memory_00,uVar3);
  }
  FUN_180017c20(param_2,param_3,(longlong)_Memory_00);
  _Memory_01 = (undefined8 *)FUN_180016a50(uVar5,iVar6);
  _Memory_02 = (undefined8 *)FUN_180016a50(uVar5,iVar6);
  FUN_180016c70(param_2,param_3,(longlong)_Memory_00,uVar5,iVar6,(longlong)_Memory_01,
                (longlong)_Memory_02,CONCAT31((int3)((uint)in_stack_ffffffffffffffb0 >> 8),0x32));
  iVar7 = FUN_180016ae0(uVar5,iVar6,(longlong)_Memory_01,(longlong)_Memory_02,0x50);
  if (param_5 == 2) {
    puVar4 = (undefined8 *)*_Memory_01;
LAB_1800169f8:
    FUN_180023f20(param_1,puVar4,(longlong)(int)(uVar5 * iVar6));
  }
  else {
    if (param_5 == 3) {
      puVar4 = (undefined8 *)*_Memory_02;
      goto LAB_1800169f8;
    }
  }
  free(_Memory_02);
  free(_Memory_01);
LAB_180016a10:
  free(_Memory_00);
  free(_Memory);
  return 0x100 - (iVar7 << 8) / (int)(uVar5 * iVar6);
}



// WARNING: Could not reconcile some variable overlaps

void FUN_1800180a0(undefined8 *param_1,uint param_2,uint param_3,int *param_4,int *param_5,
                  int param_6)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  undefined8 *puVar6;
  byte **ppbVar7;
  longlong lVar8;
  int iVar9;
  longlong lVar10;
  longlong lVar11;
  int iVar12;
  undefined4 in_stack_ffffffffffffff10;
  uint local_e8;
  int local_e4;
  byte local_e0 [4];
  int local_dc;
  int local_d8;
  ulonglong local_d0;
  int local_c8;
  int local_c4;
  int local_c0;
  int local_bc;
  int local_b8;
  uint local_b4;
  int local_b0;
  byte **local_a8;
  int local_a0;
  undefined local_9c [4];
  undefined8 *local_98;
  undefined8 *local_90;
  undefined8 *local_88;
  ulonglong local_80;
  undefined8 local_74;
  undefined8 local_6c;
  undefined8 local_64;
  ulonglong local_58;
  
  local_58 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffed8;
  local_d0 = local_d0 & 0xffffffff00000000 | (ulonglong)param_2;
  local_b4 = param_3;
  local_90 = param_1;
  local_a8 = (byte **)FUN_180016a50(param_2,param_3);
  local_98 = (undefined8 *)FUN_180016a50(param_2,param_3);
  iVar9 = 0;
  local_dc = 0;
  local_80 = 0;
  local_74 = 0;
  local_6c = 0;
  local_64 = 0;
  if (param_4 != (int *)0x0) {
    *param_4 = 0;
  }
  if (param_5 != (int *)0x0) {
    *param_5 = 0;
  }
  uVar3 = (int)(param_2 + ((int)param_2 >> 0x1f & 0xfU)) >> 4;
  local_e4 = (int)(param_3 + ((int)param_3 >> 0x1f & 0xfU)) >> 4;
  local_e8 = uVar3;
  uVar4 = FUN_180005550((byte *)param_1,param_2,param_3,param_2,0);
  ppbVar7 = local_a8;
  local_c8 = (int)uVar4;
  if (0xf4 < local_c8) goto LAB_1800187cd;
  uVar4 = (longlong)(int)(uVar3 - 4) / 3 + ((longlong)(int)(uVar3 - 4) >> 0x3f) & 0xffffffff;
  local_bc = (int)(uVar4 >> 0x1f) + (int)uVar4;
  local_d0._0_4_ = param_2;
  if ((param_4 == (int *)0x0) && (param_5 == (int *)0x0)) {
LAB_1800183fd:
    local_a0 = local_64._4_4_;
    local_c4 = (int)local_64;
    local_c0 = local_6c._4_4_;
    local_b8 = (int)local_6c;
    local_b0 = local_74._4_4_;
    local_d8 = (int)local_74;
  }
  else {
    FUN_180023f20((undefined8 *)*local_a8,param_1,(longlong)(int)(param_3 * param_2));
    FUN_1800064e0(*ppbVar7,param_2,param_3,8);
    bVar2 = FUN_180005bc0(*ppbVar7,param_2,param_3,local_e0,local_9c);
    iVar12 = (uint)local_e0[0] -
             ((int)(((uint)local_e0[0] - (uint)bVar2) +
                   ((int)((uint)local_e0[0] - (uint)bVar2) >> 0x1f & 7U)) >> 3);
    iVar9 = 0xf5;
    if (0xf5 < iVar12) {
      iVar9 = iVar12;
    }
    if (((int)param_2 < 0x11) || ((int)param_3 < 0x11)) goto LAB_1800183fd;
    pbVar1 = *ppbVar7;
    uVar4 = FUN_180016740((longlong)pbVar1,param_2,0x10);
    local_dc = (int)uVar4;
    uVar4 = FUN_180016740((longlong)(pbVar1 + (int)(param_2 - 0x11)),param_2,0x10);
    local_d8 = (int)uVar4;
    ppbVar7 = local_a8 + (int)param_3;
    pbVar1 = ppbVar7[-0x11];
    uVar4 = FUN_180016740((longlong)(pbVar1 + (int)(param_2 - 0x11)),param_2,0x10);
    local_b0 = (int)uVar4;
    uVar5 = FUN_180016740((longlong)pbVar1,param_2,0x10);
    iVar12 = local_bc;
    local_b8 = (int)uVar5;
    if (param_4 != (int *)0x0) {
      if (local_dc < iVar9) {
        *param_4 = *param_4 + 1;
      }
      if (local_d8 < iVar9) {
        *param_4 = *param_4 + 1;
      }
      if ((int)uVar4 < iVar9) {
        *param_4 = *param_4 + 1;
      }
      if (local_b8 < iVar9) {
        *param_4 = *param_4 + 1;
      }
    }
    if ((param_5 == (int *)0x0) || ((int)local_e8 < 4)) {
      local_a0 = local_64._4_4_;
      local_c4 = (int)local_64;
      local_c0 = local_6c._4_4_;
      uVar3 = local_e8;
      param_3 = local_b4;
    }
    else {
      lVar10 = (longlong)(local_bc * 0x10 + 0xf);
      pbVar1 = *local_a8;
      uVar4 = FUN_180016740((longlong)(pbVar1 + lVar10),(uint)local_d0,0x10);
      local_c0 = (int)uVar4;
      lVar11 = (longlong)(int)((uint)local_d0 + iVar12 * -0x10 + -0x21);
      uVar4 = FUN_180016740((longlong)(pbVar1 + lVar11),(uint)local_d0,0x10);
      pbVar1 = ppbVar7[-0x11];
      local_c4 = (int)uVar4;
      uVar4 = FUN_180016740((longlong)(pbVar1 + lVar11),(uint)local_d0,0x10);
      local_a0 = (int)uVar4;
      uVar5 = FUN_180016740((longlong)(pbVar1 + lVar10),(uint)local_d0,0x10);
      local_80 = uVar5 & 0xffffffff;
      if (local_dc < iVar9) {
        *param_5 = *param_5 + 1;
      }
      if (local_d8 < iVar9) {
        *param_5 = *param_5 + 1;
      }
      if (local_b0 < iVar9) {
        *param_5 = *param_5 + 1;
      }
      if (local_b8 < iVar9) {
        *param_5 = *param_5 + 1;
      }
      if (local_c0 < iVar9) {
        *param_5 = *param_5 + 1;
      }
      if (local_c4 < iVar9) {
        *param_5 = *param_5 + 1;
      }
      if ((int)uVar4 < iVar9) {
        *param_5 = *param_5 + 1;
      }
      uVar3 = local_e8;
      param_3 = local_b4;
      if ((int)uVar5 < iVar9) {
        *param_5 = *param_5 + 1;
      }
    }
  }
  uVar4 = SEXT48((int)(param_3 * (uint)local_d0));
  FUN_180023f20((undefined8 *)*local_a8,local_90,uVar4);
  FUN_180017c20((uint)local_d0,param_3,(longlong)local_a8);
  FUN_180023f20((undefined8 *)*local_98,(undefined8 *)*local_a8,uVar4);
  FUN_180017de0((uint)local_d0,param_3,(longlong)local_98,4);
  FUN_1800175f0((uint)local_d0,param_3,(longlong)local_a8,(longlong)local_98,0x40);
  if (param_6 == 1) {
    FUN_180023f20(local_90,(undefined8 *)*local_98,uVar4);
  }
  FUN_180017c20((uint)local_d0,param_3,(longlong)local_98);
  puVar6 = (undefined8 *)FUN_180016a50(uVar3,local_e4);
  local_88 = puVar6;
  ppbVar7 = (byte **)FUN_180016a50(uVar3,local_e4);
  FUN_180016c70((uint)local_d0,param_3,(longlong)local_98,uVar3,local_e4,(longlong)puVar6,
                (longlong)ppbVar7,CONCAT31((int3)((uint)in_stack_ffffffffffffff10 >> 8),0x32));
  local_d0 = SEXT48(local_e4);
  lVar11 = 0;
  lVar10 = (longlong)(int)uVar3;
  if (0 < local_e4) {
    do {
      lVar8 = 0;
      if (0 < (int)uVar3) {
        do {
          lVar8 = lVar8 + 1;
        } while (lVar8 < lVar10);
      }
      lVar11 = lVar11 + 1;
    } while (lVar11 < (longlong)local_d0);
  }
  FUN_180016ae0(uVar3,local_e4,(longlong)local_88,(longlong)ppbVar7,0x50);
  if (param_6 == 2) {
    puVar6 = (undefined8 *)*local_88;
LAB_1800185ff:
    FUN_180023f20(local_90,puVar6,(longlong)(int)(local_e8 * local_e4));
  }
  else {
    if (param_6 == 3) {
      puVar6 = (undefined8 *)*ppbVar7;
      goto LAB_1800185ff;
    }
  }
  if ((0x10 < (int)(uint)local_d0) && (0x10 < (int)local_b4)) {
    if (param_4 != (int *)0x0) {
      if (((local_dc < iVar9) && (local_c8 <= local_dc)) && (**ppbVar7 < 0x50)) {
        *param_4 = *param_4 + -1;
      }
      if (((local_d8 < iVar9) && (local_c8 <= local_d8)) && ((*ppbVar7)[lVar10 + -1] < 0x50)) {
        *param_4 = *param_4 + -1;
      }
      if (((local_b0 < iVar9) && (local_c8 <= local_b0)) &&
         (ppbVar7[local_d0 - 1][lVar10 + -1] < 0x50)) {
        *param_4 = *param_4 + -1;
      }
      if (((local_b8 < iVar9) && (local_c8 <= local_b8)) && (*ppbVar7[local_d0 - 1] < 0x50)) {
        *param_4 = *param_4 + -1;
      }
    }
    if ((param_5 != (int *)0x0) && (3 < (int)local_e8)) {
      if ((local_dc < iVar9) && ((local_c8 <= local_dc && (**ppbVar7 < 0x50)))) {
        *param_5 = *param_5 + -1;
      }
      if (((local_d8 < iVar9) && (local_c8 <= local_d8)) && ((*ppbVar7)[lVar10 + -1] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
      if (((local_b0 < iVar9) && (local_c8 <= local_b0)) &&
         (ppbVar7[local_d0 - 1][lVar10 + -1] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
      if (((local_b8 < iVar9) && (local_c8 <= local_b8)) && (*ppbVar7[local_d0 - 1] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
      if (((local_c0 < iVar9) && (local_c8 <= local_c0)) &&
         ((*ppbVar7)[(longlong)local_bc + 1] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
      if (((local_c4 < iVar9) && (local_c8 <= local_c4)) &&
         ((*ppbVar7)[lVar10 + (-2 - (longlong)local_bc)] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
      if (((local_a0 < iVar9) && (local_c8 <= local_a0)) &&
         (ppbVar7[local_d0 - 1][lVar10 + (-2 - (longlong)local_bc)] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
      if ((((int)local_80 < iVar9) && (local_c8 <= (int)local_80)) &&
         (ppbVar7[local_d0 - 1][(longlong)local_bc + 1] < 0x50)) {
        *param_5 = *param_5 + -1;
      }
    }
  }
  free(ppbVar7);
  free(local_88);
LAB_1800187cd:
  free(local_98);
  free(local_a8);
  FUN_180023ef0(local_58 ^ (ulonglong)&stack0xfffffffffffffed8);
  return;
}



void FUN_180018850(undefined8 *param_1,uint param_2,int param_3,undefined4 *param_4)

{
  ulonglong uVar1;
  
  if (param_4 != (undefined4 *)0x0) {
    uVar1 = FUN_180015fe0(param_1,param_2,param_3);
    *param_4 = (int)uVar1;
  }
  FUN_1800162d0((byte *)param_1,param_2,param_3,5);
  return;
}



undefined ** FUN_1800188b0(undefined **param_1,undefined *param_2,undefined *param_3)

{
  undefined2 uVar1;
  undefined **ppuVar2;
  undefined *puVar3;
  undefined **ppuVar4;
  undefined **ppuVar5;
  undefined **local_res8;
  undefined **local_res20;
  
  local_res8 = param_1;
  FUN_1800100f0(param_1,param_2,param_3);
  *param_1 = (undefined *)&PTR_FUN_180046870;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x44,&DAT_180046780);
  }
  *(undefined4 *)(param_1 + 0x87a) = 0x67;
  *(undefined4 *)((longlong)param_1 + 0x43d4) = 0x34;
  lstrcpyW((LPWSTR)((longlong)param_1 + 0x43ee),L"Fingerprint ET510");
  if ((code **)param_1[0x8c5] != (code **)0x0) {
    (***(code ***)param_1[0x8c5])();
  }
  ppuVar2 = (undefined **)operator_new(0x8d8);
  ppuVar4 = (undefined **)0x0;
  ppuVar5 = ppuVar4;
  local_res20 = ppuVar2;
  if (ppuVar2 != (undefined **)0x0) {
    uVar1 = *(undefined2 *)(param_2 + 0x54);
    FUN_18000c3d0(ppuVar2);
    FUN_180018a10(ppuVar2 + 0xe,uVar1,&LAB_18001f940,(undefined *)param_1,(int *)&local_res8);
    *ppuVar2 = (undefined *)&PTR_FUN_180046c10;
    ppuVar2[0xe] = (undefined *)&PTR_LAB_180046ca8;
    ppuVar5 = ppuVar2;
  }
  if (ppuVar5 != (undefined **)0x0) {
    ppuVar4 = ppuVar5 + 0xe;
  }
  param_1[0x8c5] = (undefined *)ppuVar4;
  *(undefined4 *)(param_1 + 99) = 0x14ec;
  puVar3 = (undefined *)LocalReAlloc(param_1[0x62],0x14ec,0x42);
  param_1[0x62] = puVar3;
  return param_1;
}



undefined **
FUN_180018a10(undefined **param_1,undefined2 param_2,undefined *param_3,undefined *param_4,
             int *param_5)

{
  int iVar1;
  undefined *puVar2;
  
  *param_1 = (undefined *)&PTR_LAB_180045ae8;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  param_1[8] = param_4;
  param_1[7] = param_3;
  iVar1 = -0x7fffbffd;
  if (param_3 != (undefined *)0x0) {
    iVar1 = 0;
  }
  *(int *)(param_1 + 1) = iVar1;
  *param_5 = iVar1;
  *(undefined2 *)(param_1 + 9) = param_2;
  param_1[0x8a] = (undefined *)0x0;
  param_1[0x8b] = (undefined *)0x0;
  *param_1 = (undefined *)&PTR_FUN_1800467b8;
  *(uint *)(param_1 + 0x10c) = (uint)(((byte)param_2 & 0xf) == 1);
  if ((-1 < *param_5) &&
     (*(undefined4 *)((longlong)param_1 + 0x4a) = 0x53494745, *(ushort *)(param_1 + 9) < 3)) {
    puVar2 = (undefined *)LocalAlloc(0,0x1600);
    param_1[0x8a] = puVar2;
    if (puVar2 == (undefined *)0x0) {
      *param_5 = -0x7ff8fff2;
    }
  }
  return param_1;
}



undefined ** FUN_180018b00(undefined **param_1,uint param_2)

{
  param_1[0xe] = (undefined *)&PTR_FUN_1800467b8;
  if (param_1[0x98] != (undefined *)0x0) {
    LocalFree(param_1[0x98]);
  }
  param_1[0xe] = (undefined *)&PTR_LAB_180045ae8;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x10));
  FUN_18000c520(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



undefined **
FUN_180018b70(undefined **param_1,ulonglong param_2,undefined8 param_3,undefined8 param_4)

{
  *param_1 = (undefined *)&PTR_FUN_180046870;
  FUN_1800102d0(param_1,param_2,param_3,param_4);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



undefined ** FUN_180018bb0(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)&PTR_FUN_1800467b8;
  if (param_1[0x8a] != (undefined *)0x0) {
    LocalFree(param_1[0x8a]);
  }
  *param_1 = (undefined *)&PTR_LAB_180045ae8;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180018c10(longlong *param_1)

{
  bool bVar1;
  undefined4 uVar2;
  int iVar3;
  undefined7 extraout_var;
  longlong lVar4;
  longlong *plVar5;
  longlong *plVar6;
  undefined auStack312 [32];
  uint local_118;
  uint local_110;
  uint local_108;
  uint local_100;
  uint local_f8;
  undefined2 local_e8 [4];
  undefined8 local_e0;
  undefined2 local_d0 [4];
  int local_c8;
  undefined *local_c0;
  undefined4 local_b8;
  uint local_b4;
  ushort local_b0;
  ushort local_ae;
  ushort local_ac;
  ushort local_aa;
  wchar_t local_a8 [64];
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)auStack312;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x62,&DAT_180046780);
  }
  plVar6 = (longlong *)0x0;
  plVar5 = (longlong *)(param_1[0x8c5] + -0x70);
  if (param_1[0x8c5] == 0) {
    plVar5 = plVar6;
  }
  bVar1 = FUN_18000cb60((longlong)plVar5,param_1[0x8c4],&LAB_18001c220,&LAB_18001c250);
  iVar3 = -0x7fff0001;
  if ((int)CONCAT71(extraout_var,bVar1) != 0) {
    iVar3 = 0;
  }
  if (iVar3 < 0) {
    *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),99,&DAT_180046780,iVar3);
    }
  }
  else {
    local_e0._0_4_ = 0x510d0100;
    local_e8[0] = 0x13;
    (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
              ((longlong *)param_1[0x8c4],L"CALIBRATE_VERSION(Sensor)",local_e8);
    uVar2 = (**(code **)(*param_1 + 0x98))(param_1);
    local_e8[0] = 0x13;
    local_e0 = (wchar_t *)CONCAT44(local_e0._4_4_,uVar2);
    (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
              ((longlong *)param_1[0x8c4],L"CALIBRATE_TYPE(Sensor)",local_e8);
    GetLocalTime((LPSYSTEMTIME)&local_b8);
    local_118 = local_b4 >> 0x10;
    local_f8 = (uint)local_aa;
    local_100 = (uint)local_ac;
    local_108 = (uint)local_ae;
    local_110 = (uint)local_b0;
    _swprintf(local_a8,L"%d/%02d/%02d %02d:%02d:%02d.%03d",(ulonglong)(ushort)local_b8);
    local_e8[0] = 0x1f;
    local_e0 = local_a8;
    (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
              ((longlong *)param_1[0x8c4],L"CALIBRATE_DATE(Sensor)",local_e8);
    iVar3 = (*(code *)PTR_FUN_180053780)(param_1 + 2,0x10000);
    if (iVar3 != 0) {
      plVar5 = (longlong *)(param_1[0x8c5] + -0x70);
      if (param_1[0x8c5] == 0) {
        plVar5 = plVar6;
      }
      lVar4 = FUN_18000c800((longlong)plVar5);
      local_118 = 0x34;
      (*(code *)PTR_FUN_180053788)(param_1 + 2,L"vdm_bkg",lVar4);
    }
    *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
    iVar3 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                      ((longlong *)param_1[0x8c4],L"RemoteWakeupEnable",local_d0);
    if ((iVar3 < 0) || (uVar2 = 0, local_c8 != 0)) {
      uVar2 = 1;
    }
    *(undefined4 *)(param_1 + 0x8c3) = uVar2;
    plVar5 = plVar6;
    if (param_1[0x8c5] != 0) {
      plVar5 = (longlong *)(param_1[0x8c5] + -0x70);
    }
    if (*(int *)(plVar5 + 0x11a) != 0) {
      local_b8 = 0x45474953;
      local_b4 = 0x5750510;
      GetSystemTimeAsFileTime((LPFILETIME)&local_b0);
      if (param_1[0x8c5] != 0) {
        plVar6 = (longlong *)(param_1[0x8c5] + -0x70);
      }
      iVar3 = (**(code **)(*plVar6 + 0x90))(plVar6,&local_b8,1);
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),100,&DAT_180046780,iVar3);
      }
      if (-1 < iVar3) {
        local_c8 = 0x10;
        local_d0[0] = 0x41;
        local_c0 = (undefined *)&local_b8;
        (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
                  ((longlong *)param_1[0x8c4],L"POA_UUID",local_d0);
      }
    }
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x65,&DAT_180046780);
    }
  }
  FUN_180023ef0(local_28 ^ (ulonglong)auStack312);
  return;
}



undefined4 FUN_180019400(longlong param_1,undefined4 *param_2)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  if (*(int *)(param_1 + 0x8d0) == 0) {
    return 0x80004001;
  }
  FUN_18000cac0(param_1);
  *(undefined4 *)(param_1 + 0x4cc) = 1;
  *(undefined4 *)(param_1 + 0x4c8) = 0;
  FUN_18000ca80(param_1);
  *(undefined4 *)(param_1 + 0x4cc) = 0;
  uVar1 = *(uint *)(param_1 + 0x4c8);
  puVar3 = (undefined4 *)FUN_18000c800(param_1);
  uVar2 = FUN_18001bae0((longlong *)(param_1 + 0x70),param_2,param_1 + 0x4d0,
                        (undefined *)(param_1 + 0x6d0),uVar1,puVar3);
  return uVar2;
}



undefined8 FUN_1800195a0(longlong *param_1,longlong *param_2,uint *param_3)

{
  char cVar1;
  int iVar2;
  int iVar3;
  longlong lVar4;
  longlong lVar5;
  
  if ((param_2 != (longlong *)0x0) && (0x1523 < *param_3)) {
    FUN_180020b70(param_1,param_2,param_3);
    *param_2 = *param_2 + 0x14fc;
    *(undefined4 *)(param_2 + 3) = 0x16b016b;
    *(undefined4 *)((longlong)param_2 + 0x1c) = 0x16b016b;
    *(undefined4 *)(param_2 + 4) = 0x80101;
    *(undefined2 *)((longlong)param_2 + 0x14) = 0x510;
    param_2[5] = 0;
    param_2[6] = 0;
    *(undefined4 *)(param_2 + 5) = 0x14fc;
    *(undefined4 *)((longlong)param_2 + 0x2c) = 0x340067;
    *(undefined2 *)(param_2 + 6) = 0x100;
    *(undefined *)((longlong)param_2 + 0x32) = 1;
    *(undefined *)((longlong)param_2 + 0x33) = *(undefined *)((longlong)param_1 + 0x309);
    iVar2 = (**(code **)(*param_1 + 0x20))(param_1,param_1[0x62],param_2 + 7,0x14ec);
    if (iVar2 == 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x66,&DAT_180046780);
      }
      iVar2 = 0;
      lVar5 = 0;
      do {
        iVar3 = 0;
        lVar4 = lVar5;
        do {
          cVar1 = (char)iVar3;
          iVar3 = iVar3 + 1;
          lVar5 = lVar4 + 1;
          *(char *)((longlong)param_2 + lVar4 + 0x38) = cVar1 + (char)iVar2;
          lVar4 = lVar5;
        } while (iVar3 < 0x67);
        iVar2 = iVar2 + 1;
      } while (iVar2 < 0x34);
    }
    *param_3 = *(uint *)param_2;
    return 0;
  }
  *param_3 = 0x1524;
  return 0x8007007a;
}



void FUN_180019700(longlong param_1)

{
  longlong lVar1;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x55,&DAT_180046780);
  }
  if (*(longlong *)(param_1 + 0x4628) == 0) {
    lVar1 = 0;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  FUN_18000cb00(lVar1,(char *)(param_1 + 0x18));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x56,&DAT_180046780);
  }
  return;
}



ulonglong FUN_1800197a0(longlong param_1,undefined (*param_2) [16])

{
  int iVar1;
  ulonglong uVar2;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4a,&DAT_180046780);
  }
  uVar2 = FUN_180012460(param_1,param_2);
  if (-1 < (int)uVar2) {
    *(uint *)(param_2[0x61] + 0xc) =
         (uint)(*(ushort *)(*(longlong *)(param_1 + 0x60) + 0x54) >> 0xc);
    *(uint *)param_2[0x62] = *(ushort *)(*(longlong *)(param_1 + 0x60) + 0x54) >> 8 & 0xf;
    iVar1 = lstrlenW((LPCWSTR)(param_2[0x21] + 0xc));
    wsprintfW((LPWSTR)(param_2[0x21] + (longlong)iVar1 * 2 + 0xc),L" Rev%04X");
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4b,&DAT_180046780);
  }
  return uVar2 & 0xffffffff;
}



int FUN_180019d40(longlong *param_1,undefined8 *param_2,ulonglong param_3)

{
  int iVar1;
  undefined8 *puVar2;
  uint uVar3;
  ulonglong uVar4;
  uint uVar5;
  undefined local_res8 [8];
  
  uVar4 = param_3 & 0xffffffff;
  uVar3 = (uint)uVar4;
  if (*(ushort *)(param_1 + 9) < 3) {
    uVar5 = uVar3 + 0x1ff & 0xfffffe00;
    puVar2 = param_2;
    if (uVar3 < uVar5) {
      puVar2 = (undefined8 *)param_1[0x8a];
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
    *(undefined2 *)((longlong)param_1 + 0x4e) = 0x64;  // Last sequence that ask for image, interested
    *(char *)(param_1 + 10) = (char)(uVar3 + 0x1ff >> 9);
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,puVar2,uVar5,0,local_res8);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x16,&DAT_180046780,uVar3,
                      (char)iVar1);
        LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
        goto LAB_180019ede;
      }
    }
    else {
      if (puVar2 != param_2) {
        FUN_180023f20(param_2,puVar2,uVar4);
      }
      iVar1 = 0;
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  }
  else {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
    *(undefined *)((longlong)param_1 + 0x4e) = 0x64;  // // Last sequence that ask for image, interested
    *(char *)(param_1 + 10) = (char)uVar4;
    *(char *)((longlong)param_1 + 0x4f) = (char)(uVar4 >> 8);
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,param_2,uVar3,0,local_res8);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x17,&DAT_180046780,uVar3,
                      (char)iVar1);
      }
    }
    else {
      iVar1 = 0;
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  }
LAB_180019ede:
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_180019f00(longlong *param_1,undefined *param_2)

{
  int iVar1;
  undefined local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 3;  // Nope
  *(undefined *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x18,&DAT_180046780,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      iVar1 = 0;
      *param_2 = *(undefined *)((longlong)param_1 + 0x24f);
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x19,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



undefined4
FUN_18001a030(longlong *param_1,undefined8 param_2,undefined4 *param_3,undefined4 *param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  DWORD DVar3;
  int iVar4;
  undefined8 uVar5;
  undefined4 uVar6;
  longlong *plVar7;
  undefined4 *puVar8;
  undefined2 uVar9;
  undefined4 *puVar10;
  uint uVar11;
  longlong *plVar12;
  
  uVar11 = 0xffffffff;
  if ((HANDLE)param_1[0x878] == (HANDLE)0x0) {
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((PTR_LOOP_1800537c8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 4))
    goto LAB_18001a111;
    uVar9 = 0x59;
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      DVar3 = GetThreadId((HANDLE)param_1[0x878]);
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x57,&DAT_180046780,DVar3);
    }
    WaitForSingleObject((HANDLE)param_1[0x878],0xffffffff);
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((PTR_LOOP_1800537c8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 4))
    goto LAB_18001a111;
    uVar9 = 0x58;
  }
  FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar9,&DAT_180046780);
LAB_18001a111:
  if (*(int *)(param_1 + 0x8c3) != 0) {
    uVar11 = *(uint *)((longlong)param_1 + 0x460c);
  }
  plVar12 = (longlong *)0x0;
  plVar7 = (longlong *)(param_1[0x8c5] + -0x70);
  if (param_1[0x8c5] == 0) {
    plVar7 = plVar12;
  }
  uVar5 = FUN_18000c670(plVar7,(byte *)(param_1 + 3),param_1 + 0x8c6,param_4,uVar11);
  iVar4 = (int)uVar5;
  if (iVar4 == 0) {
    puVar8 = param_3;
    puVar10 = (undefined4 *)((longlong)param_1 + 0x5ab5);
    do {
      uVar6 = puVar10[1];
      uVar1 = puVar10[2];
      uVar2 = puVar10[3];
      uVar11 = (int)plVar12 + 0x67;
      plVar12 = (longlong *)(ulonglong)uVar11;
      *puVar8 = *puVar10;
      puVar8[1] = uVar6;
      puVar8[2] = uVar1;
      puVar8[3] = uVar2;
      uVar6 = puVar10[5];
      uVar1 = puVar10[6];
      uVar2 = puVar10[7];
      puVar8[4] = puVar10[4];
      puVar8[5] = uVar6;
      puVar8[6] = uVar1;
      puVar8[7] = uVar2;
      uVar6 = puVar10[9];
      uVar1 = puVar10[10];
      uVar2 = puVar10[0xb];
      puVar8[8] = puVar10[8];
      puVar8[9] = uVar6;
      puVar8[10] = uVar1;
      puVar8[0xb] = uVar2;
      uVar6 = puVar10[0xd];
      uVar1 = puVar10[0xe];
      uVar2 = puVar10[0xf];
      puVar8[0xc] = puVar10[0xc];
      puVar8[0xd] = uVar6;
      puVar8[0xe] = uVar1;
      puVar8[0xf] = uVar2;
      uVar6 = puVar10[0x11];
      uVar1 = puVar10[0x12];
      uVar2 = puVar10[0x13];
      puVar8[0x10] = puVar10[0x10];
      puVar8[0x11] = uVar6;
      puVar8[0x12] = uVar1;
      puVar8[0x13] = uVar2;
      uVar6 = puVar10[0x15];
      uVar1 = puVar10[0x16];
      uVar2 = puVar10[0x17];
      puVar8[0x14] = puVar10[0x14];
      puVar8[0x15] = uVar6;
      puVar8[0x16] = uVar1;
      puVar8[0x17] = uVar2;
      puVar8[0x18] = puVar10[0x18];
      *(undefined2 *)(puVar8 + 0x19) = *(undefined2 *)(puVar10 + 0x19);
      *(undefined *)((longlong)puVar8 + 0x66) = *(undefined *)((longlong)puVar10 + 0x66);
      puVar8 = (undefined4 *)((longlong)puVar8 + 0x67);
      puVar10 = (undefined4 *)((longlong)puVar10 + -0x67);
    } while (uVar11 < 0x14ec);
    iVar4 = (*(code *)PTR_FUN_180053780)(param_1 + 2,0x1000000);
    if (iVar4 != 0) {
      (*(code *)PTR_FUN_180053788)(param_1 + 2,L"getImage",param_3,0x67,0x34);
    }
    (**(code **)(*param_1 + 0x170))(param_1);
    uVar6 = 1;
  }
  else {
    if (iVar4 == 0x5b4) {
      uVar6 = 3;
    }
    else {
      uVar6 = 2;
      if (iVar4 == 0x3e3) {
        uVar6 = 0xf;
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5a,&DAT_180046780,uVar6);
  }
  return uVar6;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_18001a2a0(longlong *param_1)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined7 extraout_var;
  longlong lVar4;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  if (*(int *)(param_1 + 0x67) != 0) {
    return 1;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4c,&DAT_180046780);
  }
  FUN_180014280((longlong)param_1);
  local_28 = 0;
  local_20 = 0;
  local_18 = 0;
  iVar2 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"RemoteWakeupEnable",&local_28);
  if ((iVar2 < 0) || ((int)local_20 != 0)) {
    uVar3 = 1;
  }
  else {
    uVar3 = 0;
  }
  *(undefined4 *)(param_1 + 0x8c3) = uVar3;
  if (param_1[0x8c5] == 0) {
    lVar4 = 0;
  }
  else {
    lVar4 = param_1[0x8c5] + -0x70;
  }
  bVar1 = FUN_18000cd30(lVar4);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    return CONCAT71(extraout_var,bVar1);
  }
  *(undefined4 *)((longlong)param_1 + 0x4614) = 0;
  iVar2 = (**(code **)(*param_1 + 0x148))(param_1);
  if (iVar2 == 0) {
    *(undefined4 *)((longlong)param_1 + 0x4614) = 1;
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
       (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4d,&DAT_180046780);
    }
  }
  *(undefined4 *)(param_1 + 0x67) = 1;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4e,&DAT_180046780,1);
  }
  return 1;
}



HRSRC FUN_18001a410(longlong param_1,HMODULE param_2,undefined8 param_3,undefined4 param_4)

{
  DWORD DVar1;
  HRSRC hResInfo;
  HGLOBAL hResData;
  LPVOID pvVar2;
  longlong lVar3;
  undefined2 local_38 [4];
  undefined4 local_30;
  
  hResInfo = FindResourceW(param_2,(LPCWSTR)0x294f,L"FW575");
  if (hResInfo != (HRSRC)0x0) {
    DVar1 = SizeofResource(param_2,hResInfo);
    hResData = LoadResource(param_2,hResInfo);
    pvVar2 = LockResource(hResData);
    lVar3 = *(longlong *)(param_1 + 0x4628);
    if (lVar3 != 0) {
      lVar3 = lVar3 + -0x70;
    }
    hResInfo = (HRSRC)(**(code **)(*(longlong *)(lVar3 + 0x70) + 0xa8))
                                (lVar3 + 0x70,pvVar2,DVar1,param_3,param_4);
    if ((int)hResInfo == 1) {
      local_30 = 0;
      local_38[0] = 0x13;
      (**(code **)(**(longlong **)(param_1 + 0x4620) + 0x20))
                (*(longlong **)(param_1 + 0x4620),L"CALIBRATE_VERSION(Sensor)",local_38);
      hResInfo = (HRSRC)((ulonglong)hResInfo & 0xffffffff);
    }
  }
  return hResInfo;
}



bool FUN_18001a500(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5c,&DAT_180046780);
  }
  lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  if (*(longlong *)(param_1 + 0x4628) == 0) {
    lVar2 = 0;
  }
  iVar1 = (**(code **)(*(longlong *)(lVar2 + 0x70) + 0x30))(lVar2 + 0x70,param_2,param_3);
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x5d,&DAT_180046780);
  }
  return iVar1 != 0;
}



int FUN_18001a660(longlong *param_1,undefined8 *param_2,ulonglong param_3)

{
  int iVar1;
  ulonglong uVar2;
  undefined local_res18 [16];
  
  uVar2 = param_3 & 0xffffffff;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x499;
  *(char *)(param_1 + 10) = (char)uVar2;
  FUN_180023f20((undefined8 *)((longlong)param_1 + 0x51),param_2,uVar2);
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,(int)uVar2 + 7,(longlong)param_1 + 0x24a,7,0,
                     local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x40,&DAT_180046780,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      iVar1 = 0;
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x41,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001a790(longlong *param_1,undefined8 *param_2,ulonglong param_3)

{
  int iVar1;
  ulonglong uVar2;
  undefined local_res18 [16];
  
  uVar2 = param_3 & 0xffffffff;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x199;  // what? 3 digit?
  *(char *)(param_1 + 10) = (char)uVar2;
  FUN_180023f20((undefined8 *)((longlong)param_1 + 0x51),param_2,uVar2);
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,(int)uVar2 + 7,(longlong)param_1 + 0x24a,7,0,
                     local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3a,&DAT_180046780,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      iVar1 = 0;
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3b,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001a8c0(longlong *param_1,undefined8 param_2,int param_3)

{
  int iVar1;
  undefined local_res18 [16];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (param_3 == 0x1000) {
    *(undefined2 *)((longlong)param_1 + 0x4e) = 0x299;  // what? 3 digit?
    *(undefined *)(param_1 + 10) = 0x10;
    iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res18);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3d,&DAT_180046780,iVar1);
      }
    }
    else {
      iVar1 = (**(code **)(*param_1 + 0x60))
                        (param_1,param_2,0x1000,(longlong)param_1 + 0x24a,7,0,local_res18);
      if (iVar1 < 0) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3e,&DAT_180046780,iVar1);
        }
      }
      else {
        if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) &&
           (*(char *)(param_1 + 0x4a) == '\x01')) {
          iVar1 = 0;
        }
        else {
          if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
             (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
            FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3f,&DAT_180046780,
                          (uint)*(byte *)(param_1 + 0x4a));
          }
          iVar1 = -0x7fff0001;
        }
      }
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3c,&DAT_180046780,param_3);
    }
    iVar1 = -0x7ff8ffa9;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_18001aaa0(longlong *param_1,undefined8 param_2,undefined *param_3)

{
  int iVar1;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 local_18;
  
  local_28 = 0;
  local_20 = 0;
  local_18 = 0;
  iVar1 = (**(code **)(*param_1 + 0x18))(param_1,param_2,&local_28);  // seems like call to FUN_18001cbf0 or "FUN_18001b290?
  if (iVar1 != 0) {
    return 0;
  }
  *param_3 = (undefined)local_20;
  return 1;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18001aaf0(longlong *param_1)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  undefined7 extraout_var;
  longlong *plVar4;
  longlong *plVar5;
  undefined auStack136 [32];
  undefined8 local_68;
  undefined8 local_60;
  undefined4 *local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined4 *local_40;
  undefined4 local_38;
  undefined4 uStack52;
  _FILETIME _Stack48;
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)auStack136;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x45,&DAT_180046780);
  }
  local_68 = 0;
  local_60 = 0;
  local_58 = (undefined4 *)0x0;
  iVar2 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                    ((longlong *)param_1[0x8c4],L"CALIBRATE_TYPE(Sensor)",&local_68);
  if (-1 < iVar2) {
    iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
    if ((int)local_60 == iVar2) {
      iVar2 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                        ((longlong *)param_1[0x8c4],L"CALIBRATE_VERSION(Sensor)",&local_68);
      if (-1 < iVar2) {
        if ((int)local_60 == 0x510d0100) {
          plVar5 = (longlong *)0x0;
          plVar4 = (longlong *)(param_1[0x8c5] + -0x70);
          if (param_1[0x8c5] == 0) {
            plVar4 = plVar5;
          }
          bVar1 = FUN_18000c830((longlong)plVar4,param_1[0x8c4],FUN_18001aaa0,FUN_18001ae50);
          iVar2 = -0x7fff0001;
          if ((int)CONCAT71(extraout_var,bVar1) != 0) {
            iVar2 = 0;
          }
          if (-1 < iVar2) {
            plVar4 = plVar5;
            if (param_1[0x8c5] != 0) {
              plVar4 = (longlong *)(param_1[0x8c5] + -0x70);
            }
            if (*(int *)(plVar4 + 0x11a) != 0) {
              local_50 = 0;
              local_48 = 0;
              local_40 = (undefined4 *)0x0;
              iVar3 = (**(code **)(*(longlong *)param_1[0x8c4] + 0x18))
                                ((longlong *)param_1[0x8c4],L"POA_UUID",&local_50);
              if (iVar3 == 0) {
                bVar1 = false;
                if (((short)local_50 == 0x41) && (bVar1 = false, (int)local_48 == 0x10)) {
                  bVar1 = true;
                  local_38 = *local_40;
                  uStack52 = local_40[1];
                  _Stack48.dwLowDateTime = local_40[2];
                  _Stack48.dwHighDateTime = local_40[3];
                }
                PropVariantClear((PROPVARIANT *)&local_50);
                if (bVar1) {
                  plVar4 = (longlong *)(param_1[0x8c5] + -0x70);
                  if (param_1[0x8c5] == 0) {
                    plVar4 = plVar5;
                  }
                  iVar3 = (**(code **)(plVar4[0xe] + 0xa0))(plVar4 + 0xe,&local_38);
                  if (-1 < iVar3) goto LAB_18001aded;
                }
              }
              local_38 = 0x45474953;
              uStack52 = 0x5750510;
              GetSystemTimeAsFileTime((LPFILETIME)&_Stack48);
              if (param_1[0x8c5] != 0) {
                plVar5 = (longlong *)(param_1[0x8c5] + -0x70);
              }
              iVar3 = (**(code **)(*plVar5 + 0x90))(plVar5,&local_38,1);
              if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                  ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
                 (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
                FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x48,&DAT_180046780,iVar3);
              }
              if (-1 < iVar3) {
                local_60 = CONCAT44(local_60._4_4_,0x10);
                local_68 = CONCAT62(local_68._2_6_,0x41);
                local_58 = &local_38;
                (**(code **)(*(longlong *)param_1[0x8c4] + 0x20))
                          ((longlong *)param_1[0x8c4],L"POA_UUID",&local_68);
              }
            }
          }
        }
        else {
          if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001ae19;
          iVar2 = 1;
          if (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0) &&
             (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x47,&DAT_180046780,
                          (int)local_60);
            iVar2 = 1;
          }
        }
      }
    }
    else {
      if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001ae19;
      iVar2 = 1;
      if (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0) &&
         (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x46,&DAT_180046780);
        iVar2 = 1;
      }
    }
  }
LAB_18001aded:
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x49,&DAT_180046780,iVar2);
  }
LAB_18001ae19:
  FUN_180023ef0(local_28 ^ (ulonglong)auStack136);
  return;
}



// WARNING: Could not reconcile some variable overlaps

undefined8 FUN_18001ae50(longlong *param_1,undefined8 param_2,undefined8 *param_3,uint param_4)

{
  int iVar1;
  undefined8 uVar2;
  undefined8 local_28;
  undefined8 local_20;
  undefined8 *local_18;
  
  local_28 = 0;
  local_20 = 0;
  local_18 = (undefined8 *)0x0;
  uVar2 = 0;
  iVar1 = (**(code **)(*param_1 + 0x18))();
  if (iVar1 == 0) {
    if (((short)local_28 == 0x41) && ((uint)local_20 == param_4)) {
      FUN_180023f20(param_3,local_18,(ulonglong)param_4);
      uVar2 = 1;
    }
    PropVariantClear((PROPVARIANT *)&local_28);
  }
  return uVar2;
}



int FUN_18001aed0(longlong *param_1,uint param_2,uint param_3,undefined8 param_4)

{
  int iVar1;
  undefined local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if ((param_2 & 0xff) + (param_3 & 0xff) < 0x101) {
    *(undefined *)((longlong)param_1 + 0x4e) = 0x80;  // Nope
    *(char *)((longlong)param_1 + 0x4f) = (char)param_2;
    *(char *)(param_1 + 10) = (char)param_3;
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,param_4,(param_3 & 0xff) << 8,0,
                       local_res10);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x27,&DAT_180046780,iVar1);
      }
    }
    else {
      iVar1 = 0;
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x26,&DAT_180046780,param_2 & 0xff,
                    (char)param_3);
    }
    iVar1 = -0x7ff8ffa9;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001b000(longlong *param_1,uint *param_2)

{
  int iVar1;
  undefined local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 5;  // Nope
  *(undefined *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1c,&DAT_180046780,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      iVar1 = 0;
      *param_2 = (uint)(*(char *)((longlong)param_1 + 0x24f) != '\0');
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1d,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001b140(longlong *param_1,byte param_2,undefined *param_3)

{
  int iVar1;
  undefined local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined *)((longlong)param_1 + 0x4e) = 0x60;  // Interested, starting sequence
  *(byte *)((longlong)param_1 + 0x4f) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),10,&DAT_180046780,(uint)param_2,
                    (char)iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      iVar1 = 0;
      *param_3 = *(undefined *)((longlong)param_1 + 0x24f);  // replied middle param
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xb,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001b290(longlong *param_1,ulonglong param_2,undefined8 *param_3,ulonglong param_4)

{
  uint uVar1;
  undefined uVar2;
  int iVar3;
  undefined2 uVar4;
  uint uVar5;
  undefined8 *puVar6;
  ulonglong uVar7;
  undefined local_res8 [8];
  
  uVar7 = param_4 & 0xffffffff;
  iVar3 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar1 = (uint)uVar7;
  if (param_2 < 0x200) {
    uVar2 = 0x62;  // This one's probably changing sequence, need to understand better
    if ((param_2 >> 8 & 1) != 0) {
      uVar2 = 0x70;  // Never encountered
    }
    *(undefined *)((longlong)param_1 + 0x4e) = uVar2;
    *(char *)((longlong)param_1 + 0x4f) = (char)param_2;
    *(char *)(param_1 + 10) = (char)uVar7;
    iVar3 = (**(code **)(*param_1 + 0x60))
                      (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,uVar1 + 7,0,
                       local_res8);
    if (iVar3 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18001cc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xc,&DAT_180046780,
                      (uint)*(byte *)((longlong)param_1 + 0x4f),
                      *(char *)(param_1 + 10) + *(byte *)((longlong)param_1 + 0x4f),(char)iVar3);
      }
    }
    else {
      if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) &&
         (*(char *)(param_1 + 0x4a) == '\x01')) {
        FUN_180023f20(param_3,(undefined8 *)((longlong)param_1 + 0x251),uVar7);
      }
      else {
        if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
           (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
          uVar4 = 0xd;
LAB_18001b3d0:
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180046780,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
LAB_18001b3e8:
        iVar3 = -0x7fff0001;
      }
    }
  }
  else {
    // We're interested here
    *(undefined *)((longlong)param_1 + 0x4e) = 0x60;
    uVar5 = 0;
    if (uVar1 != 0) {
      puVar6 = param_3;
      do {
        *(undefined *)((longlong)param_1 + 0x4f) =
             *(undefined *)((param_2 - (longlong)param_3) + (longlong)puVar6);
        iVar3 = (**(code **)(*param_1 + 0x60))
                          (param_1,(longlong)param_1 + 0x4a /* EGIS */,7,(longlong)param_1 + 0x24a /* SIGE */,7,0,
                           local_res8);
        if (iVar3 < 0) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xe,&DAT_180046780,
                          (uint)*(byte *)(uVar5 + param_2),(char)iVar3);
          }
          break;
        }
        if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) ||
           (*(char *)(param_1 + 0x4a) != '\x01')) {
          if (((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
             (((PTR_LOOP_1800537c8[0x1c] & 8) == 0 || ((byte)PTR_LOOP_1800537c8[0x19] < 2))))
          goto LAB_18001b3e8;
          uVar4 = 0xf;
          goto LAB_18001b3d0;
        }
        uVar5 = uVar5 + 1;
        *(undefined *)puVar6 = *(undefined *)((longlong)param_1 + 0x24f);
        puVar6 = (undefined8 *)((longlong)puVar6 + 1);
      } while (uVar5 < uVar1);
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar3) {
    iVar3 = 0;
  }
  *(int *)(param_1 + 1) = iVar3;
  return iVar3;
}



int FUN_18001b530(longlong *param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  undefined local_res18 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(char *)((longlong)param_1 + 0x4f) = (char)((uint)param_3 >> 8);
  *(undefined *)((longlong)param_1 + 0x4e) = 0x72;  // This actually never happened
  *(char *)(param_1 + 10) = (char)param_3;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,param_2,param_3,0,local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x22,&DAT_180046780,iVar1);
    }
  }
  else {
    iVar1 = 0;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001b600(longlong *param_1)

{
  int iVar1;
  undefined local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x98;  // Neither this
  *(undefined *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x36,&DAT_180046780,iVar1);
    }
    goto LAB_18001b715;
  }
  iVar1 = (**(code **)(*param_1 + 0x58))(param_1,(longlong)param_1 + 0x24a,7,1,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x37,&DAT_180046780,iVar1);
    }
    if ((*(ushort *)(param_1 + 9) & 0xff00) < 0x300) goto LAB_18001b715;
  }
  else {
    if (*(int *)((longlong)param_1 + 0x24a) != 0x45474953) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x38,&DAT_180046780);
      }
      iVar1 = -0x7fff0001;
      goto LAB_18001b715;
    }
    if (*(byte *)(param_1 + 0x4a) != 1) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x39,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fffbfff;
      goto LAB_18001b715;
    }
  }
  iVar1 = 0;
LAB_18001b715:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001b7d0(longlong *param_1)

{
  int iVar1;
  char local_res8 [8];
  undefined local_res10 [8];
  
  if ((*(ushort *)(param_1 + 9) & 0xfff0) < 0x1071) {
    local_res8[0] = '\x01';
    iVar1 = (**(code **)(*param_1 + 8))(param_1,2,local_res8);
    if ((-1 < iVar1) && (local_res8[0] != '\x01')) {
      iVar1 = (**(code **)(*param_1 + 0x10))(param_1,2,1);
      if (-1 < iVar1) {
        iVar1 = FUN_18001b600(param_1);
        if (iVar1 < 0) {
          (**(code **)(*param_1 + 0x10))(param_1,2,local_res8[0]);
          (**(code **)(*param_1 + 0x48))(param_1,local_res10);
        }
        return iVar1;
      }
    }
  }
  iVar1 = FUN_18001b600(param_1);
  return iVar1;
}



int FUN_18001b870(longlong *param_1)

{
  int iVar1;
  undefined local_res8 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 0x97;  // Niether this
  *(undefined *)(param_1 + 10) = 0;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1e,&DAT_180046780,iVar1);
    }
    goto LAB_18001b985;
  }
  iVar1 = (**(code **)(*param_1 + 0x58))(param_1,(longlong)param_1 + 0x24a,7,1,local_res8);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1f,&DAT_180046780,iVar1);
    }
    if ((*(ushort *)(param_1 + 9) & 0xff00) < 0x300) goto LAB_18001b985;
  }
  else {
    if (*(int *)((longlong)param_1 + 0x24a) != 0x45474953) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x20,&DAT_180046780);
      }
      iVar1 = -0x7fff0001;
      goto LAB_18001b985;
    }
    if (*(byte *)(param_1 + 0x4a) != 1) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x21,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fffbfff;
      goto LAB_18001b985;
    }
  }
  iVar1 = 0;
LAB_18001b985:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



bool FUN_18001ba40(longlong param_1)

{
  bool bVar1;
  longlong lVar2;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x60,&DAT_180046780);
  }
  if (*(longlong *)(param_1 + 0x4628) == 0) {
    lVar2 = 0;
  }
  else {
    lVar2 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  bVar1 = FUN_18000ca10(lVar2);
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x61,&DAT_180046780);
  }
  return bVar1;
}



undefined4
FUN_18001bae0(longlong *param_1,undefined4 *param_2,longlong param_3,undefined *param_4,uint param_5
             ,undefined4 *param_6)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined *hMem;
  longlong lVar6;
  undefined *puVar7;
  undefined4 *puVar8;
  char *pcVar9;
  char *pcVar10;
  uint uVar11;
  ulonglong uVar12;
  undefined4 *puVar13;
  uint uVar14;
  undefined *puVar15;
  ulonglong uVar16;
  char cVar17;
  char cVar18;
  char cVar20;
  char cVar21;
  char cVar22;
  char cVar23;
  char cVar24;
  char cVar25;
  char cVar26;
  char cVar27;
  char cVar28;
  char cVar29;
  char cVar30;
  char cVar31;
  char cVar32;
  char cVar33;
  char cVar34;
  char cVar35;
  char cVar36;
  char cVar37;
  char cVar38;
  char cVar39;
  char cVar40;
  char cVar41;
  char cVar42;
  char cVar43;
  char cVar44;
  char cVar45;
  char cVar46;
  char cVar47;
  char cVar48;
  char cVar49;
  undefined in_XMM1 [16];
  undefined auVar19 [16];
  
  if (*(int *)(param_1 + 0x10c) == 0) {
    *(undefined4 *)(param_1 + 1) = 0x80004001;
    return 0x80004001;
  }
  uVar14 = param_5 * 2 + 0x15 + (-(uint)(param_6 != (undefined4 *)0x0) & 0x14ec);
  hMem = (undefined *)LocalAlloc(0x40,(ulonglong)(uVar14 + 0x118 & 0xffffff00));
  if (param_2 != (undefined4 *)0x0) {
    uVar5 = param_2[1];
    uVar1 = param_2[2];
    uVar2 = param_2[3];
    *(undefined4 *)(hMem + 4) = *param_2;
    *(undefined4 *)(hMem + 8) = uVar5;
    *(undefined4 *)(hMem + 0xc) = uVar1;
    *(undefined4 *)(hMem + 0x10) = uVar2;
  }
  hMem[0x18] = (char)param_5;
  *(undefined2 *)(hMem + 0x14) = 0x14ec;
  *(ushort *)(hMem + 0x16) = -(ushort)(param_6 != (undefined4 *)0x0) & 0x14ec;
  if (param_5 != 0) {
    puVar7 = hMem + 0x1a;
    uVar12 = (ulonglong)param_5;
    puVar15 = param_4;
    do {
      puVar7[-1] = puVar15[param_3 - (longlong)param_4];
      *puVar7 = *puVar15;
      uVar12 = uVar12 - 1;
      puVar7 = puVar7 + 2;
      puVar15 = puVar15 + 1;
    } while (uVar12 != 0);
  }
  if (param_6 != (undefined4 *)0x0) {
    lVar6 = 0x29;
    puVar3 = (undefined4 *)(hMem + (ulonglong)param_5 * 2 + 0x19);
    do {
      puVar13 = param_6;
      puVar8 = puVar3;
      uVar5 = puVar13[1];
      uVar1 = puVar13[2];
      uVar2 = puVar13[3];
      *puVar8 = *puVar13;
      puVar8[1] = uVar5;
      puVar8[2] = uVar1;
      puVar8[3] = uVar2;
      uVar5 = puVar13[5];
      uVar1 = puVar13[6];
      uVar2 = puVar13[7];
      puVar8[4] = puVar13[4];
      puVar8[5] = uVar5;
      puVar8[6] = uVar1;
      puVar8[7] = uVar2;
      uVar5 = puVar13[9];
      uVar1 = puVar13[10];
      uVar2 = puVar13[0xb];
      puVar8[8] = puVar13[8];
      puVar8[9] = uVar5;
      puVar8[10] = uVar1;
      puVar8[0xb] = uVar2;
      uVar5 = puVar13[0xd];
      uVar1 = puVar13[0xe];
      uVar2 = puVar13[0xf];
      puVar8[0xc] = puVar13[0xc];
      puVar8[0xd] = uVar5;
      puVar8[0xe] = uVar1;
      puVar8[0xf] = uVar2;
      uVar5 = puVar13[0x11];
      uVar1 = puVar13[0x12];
      uVar2 = puVar13[0x13];
      puVar8[0x10] = puVar13[0x10];
      puVar8[0x11] = uVar5;
      puVar8[0x12] = uVar1;
      puVar8[0x13] = uVar2;
      uVar5 = puVar13[0x15];
      uVar1 = puVar13[0x16];
      uVar2 = puVar13[0x17];
      puVar8[0x14] = puVar13[0x14];
      puVar8[0x15] = uVar5;
      puVar8[0x16] = uVar1;
      puVar8[0x17] = uVar2;
      uVar5 = puVar13[0x19];
      uVar1 = puVar13[0x1a];
      uVar2 = puVar13[0x1b];
      puVar8[0x18] = puVar13[0x18];
      puVar8[0x19] = uVar5;
      puVar8[0x1a] = uVar1;
      puVar8[0x1b] = uVar2;
      uVar5 = puVar13[0x1d];
      uVar1 = puVar13[0x1e];
      uVar2 = puVar13[0x1f];
      puVar8[0x1c] = puVar13[0x1c];
      puVar8[0x1d] = uVar5;
      puVar8[0x1e] = uVar1;
      puVar8[0x1f] = uVar2;
      lVar6 = lVar6 + -1;
      puVar3 = puVar8 + 0x20;
      param_6 = puVar13 + 0x20;
    } while (lVar6 != 0);
    uVar5 = puVar13[0x21];
    uVar1 = puVar13[0x22];
    uVar2 = puVar13[0x23];
    puVar8[0x20] = puVar13[0x20];
    puVar8[0x21] = uVar5;
    puVar8[0x22] = uVar1;
    puVar8[0x23] = uVar2;
    uVar5 = puVar13[0x25];
    uVar1 = puVar13[0x26];
    uVar2 = puVar13[0x27];
    puVar8[0x24] = puVar13[0x24];
    puVar8[0x25] = uVar5;
    puVar8[0x26] = uVar1;
    puVar8[0x27] = uVar2;
    uVar5 = puVar13[0x29];
    uVar1 = puVar13[0x2a];
    uVar2 = puVar13[0x2b];
    puVar8[0x28] = puVar13[0x28];
    puVar8[0x29] = uVar5;
    puVar8[0x2a] = uVar1;
    puVar8[0x2b] = uVar2;
    uVar5 = puVar13[0x2d];
    uVar1 = puVar13[0x2e];
    uVar2 = puVar13[0x2f];
    puVar8[0x2c] = puVar13[0x2c];
    puVar8[0x2d] = uVar5;
    puVar8[0x2e] = uVar1;
    puVar8[0x2f] = uVar2;
    uVar5 = puVar13[0x31];
    uVar1 = puVar13[0x32];
    uVar2 = puVar13[0x33];
    puVar8[0x30] = puVar13[0x30];
    puVar8[0x31] = uVar5;
    puVar8[0x32] = uVar1;
    puVar8[0x33] = uVar2;
    in_XMM1 = *(undefined (*) [16])(puVar13 + 0x34);
    *(undefined (*) [16])(puVar8 + 0x34) = in_XMM1;
    *(undefined8 *)(puVar8 + 0x38) = *(undefined8 *)(puVar13 + 0x38);
    puVar8[0x3a] = puVar13[0x3a];
  }
  cVar17 = '\0';
  uVar12 = 0;
  pcVar10 = hMem + 4;
  if (0x1f < uVar14) {
    in_XMM1 = in_XMM1 & (undefined  [16])0x0;
    pcVar9 = pcVar10;
    auVar19 = in_XMM1;
    do {
      uVar11 = (int)uVar12 + 0x20;
      uVar12 = (ulonglong)uVar11;
      pcVar10 = pcVar9 + 0x20;
      cVar17 = *pcVar9 + SUB161(in_XMM1,0);
      cVar20 = pcVar9[1] + SUB161(in_XMM1 >> 8,0);
      cVar22 = pcVar9[2] + SUB161(in_XMM1 >> 0x10,0);
      cVar24 = pcVar9[3] + SUB161(in_XMM1 >> 0x18,0);
      cVar26 = pcVar9[4] + SUB161(in_XMM1 >> 0x20,0);
      cVar28 = pcVar9[5] + SUB161(in_XMM1 >> 0x28,0);
      cVar30 = pcVar9[6] + SUB161(in_XMM1 >> 0x30,0);
      cVar32 = pcVar9[7] + SUB161(in_XMM1 >> 0x38,0);
      cVar34 = pcVar9[8] + SUB161(in_XMM1 >> 0x40,0);
      cVar36 = pcVar9[9] + SUB161(in_XMM1 >> 0x48,0);
      cVar38 = pcVar9[10] + SUB161(in_XMM1 >> 0x50,0);
      cVar40 = pcVar9[0xb] + SUB161(in_XMM1 >> 0x58,0);
      cVar42 = pcVar9[0xc] + SUB161(in_XMM1 >> 0x60,0);
      cVar44 = pcVar9[0xd] + SUB161(in_XMM1 >> 0x68,0);
      cVar46 = pcVar9[0xe] + SUB161(in_XMM1 >> 0x70,0);
      cVar48 = pcVar9[0xf] + SUB161(in_XMM1 >> 0x78,0);
      in_XMM1 = CONCAT115(cVar48,CONCAT114(cVar46,CONCAT113(cVar44,CONCAT112(cVar42,CONCAT111(cVar40
                                                  ,CONCAT110(cVar38,CONCAT19(cVar36,CONCAT18(cVar34,
                                                  CONCAT17(cVar32,CONCAT16(cVar30,CONCAT15(cVar28,
                                                  CONCAT14(cVar26,CONCAT13(cVar24,CONCAT12(cVar22,
                                                  CONCAT11(cVar20,cVar17)))))))))))))));
      cVar18 = pcVar9[0x10] + SUB161(auVar19,0);
      cVar21 = pcVar9[0x11] + SUB161(auVar19 >> 8,0);
      cVar23 = pcVar9[0x12] + SUB161(auVar19 >> 0x10,0);
      cVar25 = pcVar9[0x13] + SUB161(auVar19 >> 0x18,0);
      cVar27 = pcVar9[0x14] + SUB161(auVar19 >> 0x20,0);
      cVar29 = pcVar9[0x15] + SUB161(auVar19 >> 0x28,0);
      cVar31 = pcVar9[0x16] + SUB161(auVar19 >> 0x30,0);
      cVar33 = pcVar9[0x17] + SUB161(auVar19 >> 0x38,0);
      cVar35 = pcVar9[0x18] + SUB161(auVar19 >> 0x40,0);
      cVar37 = pcVar9[0x19] + SUB161(auVar19 >> 0x48,0);
      cVar39 = pcVar9[0x1a] + SUB161(auVar19 >> 0x50,0);
      cVar41 = pcVar9[0x1b] + SUB161(auVar19 >> 0x58,0);
      cVar43 = pcVar9[0x1c] + SUB161(auVar19 >> 0x60,0);
      cVar45 = pcVar9[0x1d] + SUB161(auVar19 >> 0x68,0);
      cVar47 = pcVar9[0x1e] + SUB161(auVar19 >> 0x70,0);
      cVar49 = pcVar9[0x1f] + SUB161(auVar19 >> 0x78,0);
      auVar19 = CONCAT115(cVar49,CONCAT114(cVar47,CONCAT113(cVar45,CONCAT112(cVar43,CONCAT111(cVar41
                                                  ,CONCAT110(cVar39,CONCAT19(cVar37,CONCAT18(cVar35,
                                                  CONCAT17(cVar33,CONCAT16(cVar31,CONCAT15(cVar29,
                                                  CONCAT14(cVar27,CONCAT13(cVar25,CONCAT12(cVar23,
                                                  CONCAT11(cVar21,cVar18)))))))))))))));
      pcVar9 = pcVar10;
    } while (uVar11 < uVar14 - (uVar14 & 0x1f));
    cVar17 = cVar17 + cVar18 + cVar34 + cVar35 + cVar26 + cVar27 + cVar42 + cVar43 +
             cVar22 + cVar23 + cVar38 + cVar39 + cVar30 + cVar31 + cVar46 + cVar47 +
             cVar20 + cVar21 + cVar36 + cVar37 + cVar28 + cVar29 + cVar44 + cVar45 +
             cVar24 + cVar25 + cVar40 + cVar41 + cVar32 + cVar33 + cVar48 + cVar49;
  }
  cVar20 = '\0';
  cVar18 = '\0';
  uVar11 = (uint)uVar12;
  if (uVar11 < uVar14) {
    if (1 < uVar14 - uVar11) {
      uVar4 = ((uVar14 - uVar11) - 2 >> 1) + 1;
      uVar16 = (ulonglong)uVar4;
      uVar12 = (ulonglong)(uVar11 + uVar4 * 2);
      do {
        cVar20 = cVar20 + *pcVar10;
        cVar18 = cVar18 + pcVar10[1];
        pcVar10 = pcVar10 + 2;
        uVar16 = uVar16 - 1;
      } while (uVar16 != 0);
    }
    if ((uint)uVar12 < uVar14) {
      cVar17 = cVar17 + *pcVar10;
    }
    cVar17 = cVar17 + cVar18 + cVar20;
  }
  *hMem = 1;
  *(short *)(hMem + 2) = (short)uVar14;
  hMem[1] = -cVar17;
  uVar5 = (**(code **)(*param_1 + 0x88))
                    (param_1,CONCAT71((int7)(uVar12 >> 8),0xe0),uVar14 + 0x118 >> 8 & 0xff,hMem);
  LocalFree(hMem);
  return uVar5;
}



int FUN_18001be80(longlong *param_1,undefined param_2)

{
  int iVar1;
  undefined local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined2 *)((longlong)param_1 + 0x4e) = 4;  // Neither this
  *(undefined *)(param_1 + 10) = param_2;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1a,&DAT_180046780,iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      iVar1 = 0;
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1b,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



undefined4 FUN_18001c0c0(longlong param_1)

{
  bool bVar1;
  undefined7 extraout_var;
  undefined4 uVar2;
  longlong lVar3;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4f,&DAT_180046780);
  }
  if (*(longlong *)(param_1 + 0x4628) == 0) {
    lVar3 = 0;
  }
  else {
    lVar3 = *(longlong *)(param_1 + 0x4628) + -0x70;
  }
  bVar1 = FUN_18000ca80(lVar3);
  uVar2 = 1;
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    uVar2 = 2;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x80) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x50,&DAT_180046780,uVar2);
  }
  return uVar2;
}



int FUN_18001c290(longlong *param_1,uint param_2,uint param_3,undefined8 param_4)

{
  int iVar1;
  undefined2 uVar2;
  uint uVar3;
  undefined local_res10 [8];
  
  uVar3 = param_3 & 0xff;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (0x100 < (param_2 & 0xff) + uVar3) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x28,&DAT_180046780,param_2 & 0xff,
                    (char)param_3);
    }
    iVar1 = -0x7ff8fff2;
    goto LAB_18001c443;
  }
  *(undefined *)((longlong)param_1 + 0x4e) = 0x81;  // Neither this
  *(char *)((longlong)param_1 + 0x4f) = (char)param_2;
  *(char *)(param_1 + 10) = (char)uVar3;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((PTR_LOOP_1800537c8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
    goto LAB_18001c443;
    uVar2 = 0x29;
  }
  else {
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,param_4,uVar3 << 8,(longlong)param_1 + 0x24a,7,0,local_res10);
    if (-1 < iVar1) {
      if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) &&
         (*(char *)(param_1 + 0x4a) == '\x01')) {
        iVar1 = 0;
      }
      else {
        if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
           (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2b,&DAT_180046780,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
        iVar1 = -0x7fff0001;
      }
      goto LAB_18001c443;
    }
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((PTR_LOOP_1800537c8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
    goto LAB_18001c443;
    uVar2 = 0x2a;
  }
  FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar2,&DAT_180046780,iVar1);
LAB_18001c443:
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001c470(longlong *param_1,byte param_2,undefined param_3)

{
  int iVar1;
  undefined local_res10 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(undefined *)((longlong)param_1 + 0x4e) = 0x61;  // Yes we're interested, its probably repeating sequence!
  *(byte *)((longlong)param_1 + 0x4f) = param_2;
  *(undefined *)(param_1 + 10) = param_3;
  iVar1 = (**(code **)(*param_1 + 0x60))
                    (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,7,0,local_res10);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x10,&DAT_180046780,(uint)param_2,
                    (char)iVar1);
    }
  }
  else {
    if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) && (*(char *)(param_1 + 0x4a) == '\x01')
       ) {
      if (*(int *)((longlong)param_1 + 0x45c) != 0) {
        *(byte *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x460 + (longlong)param_1) = param_2;
        *(undefined *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x660 + (longlong)param_1) = param_3;
        *(int *)(param_1 + 0x8b) = *(int *)(param_1 + 0x8b) + 1;
        if (0x1ff < *(uint *)(param_1 + 0x8b)) {
          *(undefined4 *)((longlong)param_1 + 0x45c) = 0;
        }
      }
      iVar1 = 0;
    }
    else {
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x11,&DAT_180046780,
                      (uint)*(byte *)(param_1 + 0x4a));
      }
      iVar1 = -0x7fff0001;
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



int FUN_18001c600(longlong *param_1,ulonglong param_2,undefined8 *param_3,ulonglong param_4)

{
  undefined uVar1;
  int iVar2;
  int iVar3;
  undefined2 uVar4;
  uint uVar5;
  longlong lVar6;
  uint uVar7;
  ulonglong uVar8;
  undefined local_res8 [8];
  
  uVar8 = param_4 & 0xffffffff;
  iVar2 = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  uVar7 = (uint)uVar8;
  if (param_2 < 0x200) {
    uVar1 = 0x63;  // Yes we're interested
    if ((param_2 >> 8 & 1) != 0) {
      uVar1 = 0x71;  // also here, its repeating sequence!
    }
    *(char *)((longlong)param_1 + 0x4f) = (char)param_2;
    *(char *)(param_1 + 10) = (char)uVar8;
    *(undefined *)((longlong)param_1 + 0x4e) = uVar1;
    FUN_180023f20((undefined8 *)((longlong)param_1 + 0x51),param_3,uVar8);
    iVar2 = (**(code **)(*param_1 + 0x60))();
    if (iVar2 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18001cc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x12,&DAT_180046780,
                      (uint)*(byte *)((longlong)param_1 + 0x4f),
                      *(char *)(param_1 + 10) + *(byte *)((longlong)param_1 + 0x4f),(char)iVar2);
      }
    }
    else {
      if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) &&
         (*(char *)(param_1 + 0x4a) == '\x01')) {
        if (*(int *)((longlong)param_1 + 0x45c) != 0) {
          iVar3 = 1;
          if (((uint)param_2 >> 8 & 1) != 0) {
            iVar3 = -1;
          }
          uVar5 = 0;
          if (uVar7 != 0) {
            do {
              *(char *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x460 + (longlong)param_1) =
                   (char)param_2;
              *(undefined *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x660 + (longlong)param_1) =
                   *(undefined *)param_3;
              *(int *)(param_1 + 0x8b) = *(int *)(param_1 + 0x8b) + 1;
              if (0x1ff < *(uint *)(param_1 + 0x8b)) {
                *(undefined4 *)((longlong)param_1 + 0x45c) = 0;
                break;
              }
              uVar5 = uVar5 + 1;
              param_3 = (undefined8 *)((longlong)param_3 + 1);
              param_2 = (ulonglong)(uint)((int)param_2 + iVar3);
            } while (uVar5 < uVar7);
          }
        }
      }
      else {
        if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
           (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
          uVar4 = 0x13;
LAB_18001c7b3:
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180046780,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
LAB_18001c7cb:
        iVar2 = -0x7fff0001;
      }
    }
  }
  else {
    *(undefined *)((longlong)param_1 + 0x4e) = 0x61;  // Yes we're interested
    uVar5 = 0;
    if (uVar7 != 0) {
      lVar6 = param_2 - (longlong)param_3;
      do {
        *(undefined *)((longlong)param_1 + 0x4f) = *(undefined *)(lVar6 + (longlong)param_3);
        *(undefined *)(param_1 + 10) = *(undefined *)param_3;
        iVar2 = (**(code **)(*param_1 + 0x60))
                          (param_1,(longlong)param_1 + 0x4a,7,(longlong)param_1 + 0x24a,7,0,
                           local_res8);
        if (iVar2 < 0) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x14,&DAT_180046780,
                          (uint)*(byte *)(uVar5 + param_2),(char)iVar2);
          }
          break;
        }
        if ((*(int *)((longlong)param_1 + 0x24a) != 0x45474953) ||
           (*(char *)(param_1 + 0x4a) != '\x01')) {
          if (((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
             (((PTR_LOOP_1800537c8[0x1c] & 8) == 0 || ((byte)PTR_LOOP_1800537c8[0x19] < 2))))
          goto LAB_18001c7cb;
          uVar4 = 0x15;
          goto LAB_18001c7b3;
        }
        if (*(int *)((longlong)param_1 + 0x45c) != 0) {
          *(undefined *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x460 + (longlong)param_1) =
               *(undefined *)(lVar6 + (longlong)param_3);
          *(undefined *)((ulonglong)*(uint *)(param_1 + 0x8b) + 0x660 + (longlong)param_1) =
               *(undefined *)param_3;
          *(int *)(param_1 + 0x8b) = *(int *)(param_1 + 0x8b) + 1;
          if (0x1ff < *(uint *)(param_1 + 0x8b)) {
            *(undefined4 *)((longlong)param_1 + 0x45c) = 0;
          }
        }
        uVar5 = uVar5 + 1;
        param_3 = (undefined8 *)((longlong)param_3 + 1);
      } while (uVar5 < uVar7);
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  if (-1 < iVar2) {
    iVar2 = 0;
  }
  *(int *)(param_1 + 1) = iVar2;
  return iVar2;
}



int FUN_18001c960(longlong *param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  undefined local_res18 [8];
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(char *)((longlong)param_1 + 0x4f) = (char)((uint)param_3 >> 8);
  *(undefined *)((longlong)param_1 + 0x4e) = 0x73;  // Yes we're interested
  *(char *)(param_1 + 10) = (char)param_3;
  iVar1 = (**(code **)(*param_1 + 0x50))(param_1,(longlong)param_1 + 0x4a,7,0,local_res18);
  if (iVar1 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x23,&DAT_180046780,iVar1);
    }
  }
  else {
    iVar1 = (**(code **)(*param_1 + 0x60))
                      (param_1,param_2,param_3,(longlong)param_1 + 0x24a,7,0,local_res18);
    if (iVar1 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x24,&DAT_180046780,iVar1);
      }
    }
    else {
      if ((*(int *)((longlong)param_1 + 0x24a) == 0x45474953) &&
         (*(char *)(param_1 + 0x4a) == '\x01')) {
        iVar1 = 0;
      }
      else {
        if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
           (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x25,&DAT_180046780,
                        (uint)*(byte *)(param_1 + 0x4a));
        }
        iVar1 = -0x7fff0001;
      }
    }
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  *(int *)(param_1 + 1) = iVar1;
  return iVar1;
}



bool FUN_18001cb00(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_18001b290((longlong *)(param_1 + 0x70),(ulonglong)param_2,param_4,(ulonglong)param_3);
  return iVar1 == 0;
}



bool FUN_18001cb30(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_18001b290((longlong *)(param_1 + 0x70),(ulonglong)param_2 | 0x100,param_4,
                        (ulonglong)param_3);
  return iVar1 == 0;
}



bool FUN_18001cb60(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_18001c600((longlong *)(param_1 + 0x70),(ulonglong)param_2,param_4,(ulonglong)param_3);
  return iVar1 == 0;
}



bool FUN_18001cb90(longlong param_1,byte param_2,byte param_3,undefined8 *param_4)

{
  int iVar1;
  
  iVar1 = FUN_18001c600((longlong *)(param_1 + 0x70),(ulonglong)param_2 | 0x100,param_4,
                        (ulonglong)param_3);
  return iVar1 == 0;
}



bool FUN_18001cbc0(longlong param_1,undefined8 *param_2,int param_3,int param_4)

{
  int iVar1;
  
  iVar1 = FUN_180019d40((longlong *)(param_1 + 0x70),param_2,(ulonglong)(uint)(param_3 * param_4));
  return iVar1 == 0;
}



undefined8 FUN_18001cbe0(void)

{
  return 0;
}



bool FUN_18001cbf0(longlong param_1,byte param_2,undefined *param_3)

{
  int iVar1;
  
  iVar1 = FUN_18001b140((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



bool FUN_18001cc10(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  
  iVar1 = FUN_18001b530((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



bool FUN_18001cc30(longlong param_1)

{
  int iVar1;
  
  iVar1 = FUN_18001b870((longlong *)(param_1 + 0x70));
  return iVar1 == 0;
}



bool FUN_18001cc50(longlong param_1,byte param_2,undefined param_3)

{
  int iVar1;
  
  iVar1 = FUN_18001c470((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



bool FUN_18001cc70(longlong param_1,undefined8 param_2,undefined4 param_3)

{
  int iVar1;
  
  iVar1 = FUN_18001c960((longlong *)(param_1 + 0x70),param_2,param_3);
  return iVar1 == 0;
}



void FUN_18001cc90(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,0);
  return;
}



undefined ** FUN_18001ccf0(undefined **param_1)

{
  undefined *puVar1;
  
  *(undefined4 *)(param_1 + 1) = 0;
  param_1[2] = (undefined *)0x0;
  param_1[3] = (undefined *)0x0;
  param_1[4] = (undefined *)0x0;
  param_1[5] = (undefined *)0x0;
  param_1[6] = (undefined *)0x0;
  *(undefined *)(param_1 + 7) = 0;
  param_1[8] = (undefined *)0x0;
  *param_1 = (undefined *)&PTR_LAB_180046ee8;
  param_1[9] = (undefined *)0x0;
  param_1[0x13] = (undefined *)0x0;
  *(undefined4 *)(param_1 + 0xf) = 0;
  puVar1 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[0x10] = puVar1;
  puVar1 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[0x11] = puVar1;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 10));
  return param_1;
}



void FUN_18001cd80(undefined **param_1)

{
  *param_1 = (undefined *)&PTR_LAB_180046ee8;
  if ((longlong *)param_1[0x13] != (longlong *)0x0) {
    (**(code **)(*(longlong *)param_1[0x13] + 0x10))();
  }
  if (param_1[0x10] != (undefined *)0x0) {
    CloseHandle(param_1[0x10]);
  }
  if (param_1[0x11] != (undefined *)0x0) {
    CloseHandle(param_1[0x11]);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 10));
  if (*(char *)(param_1 + 7) != '\0') {
    *(undefined *)(param_1 + 7) = 0;
                    // WARNING: Could not recover jumptable at 0x00018001cdf4. Too many branches
                    // WARNING: Treating indirect jump as call
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
    return;
  }
  return;
}



undefined ** FUN_18001ce10(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)&PTR_LAB_180046f48;
  *(undefined4 *)(param_1 + 1) = 0xc0000001;
  (**(code **)(*DAT_180056a00 + 0x10))();
  FUN_18001cd80(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



bool FUN_18001ce70(longlong param_1,DWORD param_2)

{
  DWORD DVar1;
  HANDLE local_18;
  undefined8 local_10;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x12,&DAT_180046e60);
  }
  local_18 = *(HANDLE *)(param_1 + 0x88);
  local_10 = *(undefined8 *)(param_1 + 0x80);
  DVar1 = WaitForMultipleObjects(2,&local_18,0,param_2);
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x13,&DAT_180046e60,DVar1);
  }
  return DVar1 != 0x102;
}



DWORD FUN_18001cf40(longlong **param_1)

{
  BOOL BVar1;
  undefined **ppuVar2;
  DWORD DVar3;
  
  if (param_1 == (longlong **)0x0) {
    return 0x80004003;
  }
  *param_1 = (longlong *)0x0;
  DVar3 = 0x8007000e;
  ppuVar2 = (undefined **)FUN_1800251c0(0xa0);
  if (ppuVar2 == (undefined **)0x0) {
    ppuVar2 = (undefined **)0x0;
  }
  else {
    FUN_18001ccf0(ppuVar2);
    *ppuVar2 = (undefined *)&PTR_LAB_180046f48;
    (**(code **)(*DAT_180056a00 + 8))();
  }
  if (ppuVar2 == (undefined **)0x0) goto LAB_18001d02a;
  DVar3 = 0;
  BVar1 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(ppuVar2 + 2),0,0);
  if (BVar1 == 0) {
    DVar3 = GetLastError();
    if (0 < (int)DVar3) {
      DVar3 = DVar3 & 0xffff | 0x80070000;
    }
    if (-1 < (int)DVar3) goto LAB_18001d00d;
  }
  else {
LAB_18001d00d:
    *(undefined *)(ppuVar2 + 7) = 1;
    if (-1 < (int)DVar3) {
      DVar3 = 0;
      goto LAB_18001d02a;
    }
  }
  (**(code **)(*ppuVar2 + 0x20))(ppuVar2,1);
  ppuVar2 = (undefined **)0x0;
LAB_18001d02a:
  *param_1 = (longlong *)ppuVar2;
  return DVar3;
}



DWORD FUN_18001d040(longlong *param_1,undefined *param_2,undefined **param_3)

{
  undefined **ppuVar1;
  DWORD DVar2;
  undefined **local_res20;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),10,&DAT_180046e60);
  }
  local_res20 = (undefined **)0x0;
  DVar2 = FUN_18001cf40((longlong **)&local_res20);
  ppuVar1 = local_res20;
  if (-1 < (int)DVar2) {
    DVar2 = FUN_18001d110(local_res20,param_1,param_2);
    *param_3 = (undefined *)ppuVar1;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xb,&DAT_180046e60);
  }
  return DVar2;
}



int FUN_18001d110(undefined **param_1,longlong *param_2,undefined *param_3)

{
  int iVar1;
  undefined2 uVar2;
  longlong *local_res10 [2];
  longlong *local_res20;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xc,&DAT_180046e60);
  }
  local_res20 = (longlong *)0x0;
  local_res10[0] = (longlong *)0x0;
  if (param_2 == (longlong *)0x0) {
    if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
      return -0x7ff8ffa9;
    }
    if ((PTR_LOOP_1800537c8[0x1c] & 4) == 0) {
      return -0x7ff8ffa9;
    }
    if ((byte)PTR_LOOP_1800537c8[0x19] < 2) {
      return -0x7ff8ffa9;
    }
    uVar2 = 0xd;
LAB_18001d189:
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar2,&DAT_180046e60);
    return -0x7ff8ffa9;
  }
  if (param_3 == (undefined *)0x0) {
    if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
      return -0x7ff8ffa9;
    }
    if ((PTR_LOOP_1800537c8[0x1c] & 4) == 0) {
      return -0x7ff8ffa9;
    }
    if ((byte)PTR_LOOP_1800537c8[0x19] < 2) {
      return -0x7ff8ffa9;
    }
    uVar2 = 0xe;
    goto LAB_18001d189;
  }
  iVar1 = (**(code **)*param_1)(param_1,&DAT_18004d6d0,local_res10);
  if (-1 < iVar1) {
    iVar1 = (**(code **)(*param_2 + 0x70))(param_2,local_res10[0],0,1,0,0,&local_res20);
    if (local_res10[0] != (longlong *)0x0) {
      (**(code **)(*local_res10[0] + 0x10))();
    }
    local_res10[0] = (longlong *)0x0;
    if (-1 < iVar1) {
      iVar1 = (**(code **)(*param_2 + 0x98))(param_2,local_res20,5);
      if (-1 < iVar1) {
        param_1[8] = (undefined *)local_res20;
        param_1[9] = param_3;
      }
      if (local_res20 != (longlong *)0x0) {
        (**(code **)(*local_res20 + 0x10))();
      }
      local_res20 = (longlong *)0x0;
      if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
        return iVar1;
      }
      if ((PTR_LOOP_1800537c8[0x1c] & 4) == 0) {
        return iVar1;
      }
      if ((byte)PTR_LOOP_1800537c8[0x19] < 4) {
        return iVar1;
      }
      uVar2 = 0x10;
      goto LAB_18001d2b4;
    }
  }
  if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
    return iVar1;
  }
  if ((PTR_LOOP_1800537c8[0x1c] & 4) == 0) {
    return iVar1;
  }
  if ((byte)PTR_LOOP_1800537c8[0x19] < 2) {
    return iVar1;
  }
  uVar2 = 0xf;
LAB_18001d2b4:
  FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar2,&DAT_180046e60);
  return iVar1;
}



void FUN_18001d2e0(longlong param_1)

{
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x50));
  *(int *)(param_1 + 0x78) = *(int *)(param_1 + 0x78) + 1;
  SetEvent(*(HANDLE *)(param_1 + 0x88));
                    // WARNING: Could not recover jumptable at 0x00018001d315. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x50));
  return;
}


// Handles IOCTL codes from Sensor
void FUN_18001d320(longlong this,undefined8 FxQueue,undefined **FxRequest,uint ControlCode,
                  undefined8 InputBufferSizeInBytes,undefined8 OutputBufferSizeInBytes)

{
  int *piVar1;
  int iVar2;
  longlong lVar3;
  undefined8 uVar4;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18001dc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x15,&DAT_180046e60,
                  InputBufferSizeInBytes,(undefined1)OutputBufferSizeInBytes,(char)FxRequest,
                  (char)ControlCode);
  }
  if (*(longlong *)(this + 0x48) == 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x16,&DAT_180046e60);
    }
    (**(code **)(*FxRequest + 0x50))(FxRequest,0x80004003);
    return;
  }
  iVar2 = *(int *)(*(longlong *)(this + 0x48) + 0x94);
  if (4 < iVar2) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x17,&DAT_180046e60,iVar2);
    }
    (**(code **)(*FxRequest + 0x50))(FxRequest,0x80070651);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(this + 0x50));
  *(int *)(this + 0x78) = *(int *)(this + 0x78) + 1;
  if (*(int *)(this + 0x78) == 1) {
    ResetEvent(*(HANDLE *)(this + 0x80));
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(this + 0x50));
  lVar3 = *(longlong *)(this + 0x48);
  if (ControlCode == 0x220000) {
    FUN_18000ee50(lVar3,(longlong *)FxRequest);
    goto LAB_18001da25;
  }
  if (*(int *)(lVar3 + 0x74) != 0) {
    FUN_18000ef00(lVar3,FxRequest);
    goto LAB_18001da25;
  }
  if (*(longlong *)(this + 0x98) == 0) {
    uVar4 = 0x8000ffff;
    goto LAB_18001da1c;
  }

  // *(longlong *)(this + 0x98) == CBiometricDevice https://github.com/microsoft/Windows-driver-samples/blob/master/biometrics/driver/Device.h
  if (ControlCode < 0x440025) {
    if (ControlCode == 0x440024) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x20,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_180023590(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      goto LAB_18001da25;
    }
    switch(ControlCode) {
    case 0x440004 /* IOCTL_BIOMETRIC_GET_ATTRIBUTES */:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x18,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_180022200(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    default:
      goto switchD_18001d787_caseD_442005;
    case 0x440008 /* IOCTL_BIOMETRIC_RESET */:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x19,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_180023330(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    case 0x44000c /* IOCTL_BIOMETRIC_CALIBRATE */:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1a,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_1800219e0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    case 0x440010 /* IOCTL_BIOMETRIC_GET_SENSOR_STATUS */:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1b,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_180022eb0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    case 0x440014 /* IOCTL_BIOMETRIC_CAPTURE_DATA */:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1c,&DAT_180046e60);
      }
      if (*(longlong **)(this + 0x98) != (longlong *)0x0) {
        FUN_180021cd0(*(longlong **)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    case 0x440018:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1d,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_1800236e0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    case 0x44001c:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1e,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_1800230b0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
      break;
    case 0x440020:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1f,&DAT_180046e60);
      }
      if (*(longlong *)(this + 0x98) != 0) {
        FUN_180022640(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      }
    }
    goto LAB_18001da25;
  }
  
  // These are not ioctls, what are these? Do we have to know?
  switch(ControlCode) {
  case 0x442004:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x21,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_1800227b0(*(longlong *)(this + 0x98));
    }
    uVar4 = 0;
    goto LAB_18001da1c;
  default:
switchD_18001d787_caseD_442005:
    if (ControlCode - 0x442400 < 0x3fd) {
      FUN_180023110(*(longlong *)(this + 0x98),(longlong *)FxRequest);
      break;
    }
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x29,&DAT_180046e60,ControlCode);
    }
    uVar4 = 0x80070001;
LAB_18001da1c:
    (**(code **)(*FxRequest + 0x50))(FxRequest,uVar4);
    break;
  case 0x44200c:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x22,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_180022170(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
    break;
  case 0x442010:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x23,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_180023260(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
    break;
  case 0x442014:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x24,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_180023740(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
    break;
  case 0x442018:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x25,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_1800224a0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
    break;
  case 0x44201c:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x26,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_180022560(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
    break;
  case 0x442020:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x27,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_1800231b0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
    break;
  case 0x442024:
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x28,&DAT_180046e60);
    }
    if (*(longlong *)(this + 0x98) != 0) {
      FUN_1800223e0(*(longlong *)(this + 0x98),(longlong *)FxRequest);
    }
  }
LAB_18001da25:
  EnterCriticalSection((LPCRITICAL_SECTION)(this + 0x50));
  piVar1 = (int *)(this + 0x78);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SetEvent(*(HANDLE *)(this + 0x80));
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(this + 0x50));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2a,&DAT_180046e60);
  }
  return;
}



void FUN_18001db40(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x11,&DAT_180046e60);
  }
                    // WARNING: Could not recover jumptable at 0x00018001db8b. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(longlong **)(param_1 + 0x40) + 0x70))(*(longlong **)(param_1 + 0x40),0);
  return;
}



void FUN_18001dbf0(longlong param_1)

{
  int *piVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x50));
  ResetEvent(*(HANDLE *)(param_1 + 0x88));
  piVar1 = (int *)(param_1 + 0x78);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SetEvent(*(HANDLE *)(param_1 + 0x80));
  }
                    // WARNING: Could not recover jumptable at 0x00018001dc34. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x50));
  return;
}



void FUN_18001dc40(longlong param_1)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 4) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x14,&DAT_180046e60);
  }
                    // WARNING: Could not recover jumptable at 0x00018001dc89. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(longlong **)(param_1 + 0x40) + 0x68))();
  return;
}



void FUN_18001dc90(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5,undefined param_6,undefined param_7)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,8,&param_6,8,&param_7,4,0);
  return;
}



undefined8 * FUN_18001dd00(undefined8 *param_1,undefined8 param_2)

{
  *param_1 = param_2;
  param_1[1] = 0;
  param_1[0xd] = 0;
  *(undefined4 *)(param_1 + 0xe) = 0;
  param_1[9] = 0;
  param_1[10] = 0;
  *(undefined2 *)(param_1 + 0xb) = 0;
  param_1[0xc] = 0;
  return param_1;
}



void FUN_18001dd30(longlong param_1)

{
  if (*(HLOCAL *)(param_1 + 0x60) != (HLOCAL)0x0) {
    LocalFree(*(HLOCAL *)(param_1 + 0x60));
  }
  if (*(longlong **)(param_1 + 8) != (longlong *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018001dd59. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(longlong **)(param_1 + 8) + 0x18))();
    return;
  }
  return;
}



undefined8 FUN_18001dd70(longlong param_1,int param_2)

{
  longlong *plVar1;
  
  if (param_2 != 0) {
    *(undefined4 *)(param_1 + 0x70) = 0;
  }
  plVar1 = *(longlong **)(param_1 + 0x68);
  *(longlong **)(param_1 + 0x68) = (longlong *)0x0;
  if (plVar1 != (longlong *)0x0) {
    (**(code **)(*plVar1 + 0xa8))(plVar1);
    (**(code **)(*plVar1 + 0x10))(plVar1);
    return 0;
  }
  return 1;
}



int FUN_18001ddb0(undefined **param_1)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  undefined2 uVar5;
  byte bVar6;
  longlong *local_res8;
  longlong *local_res10;
  longlong *local_res18;
  longlong *local_res20;
  uint uVar7;
  
  local_res20 = (longlong *)0x0;
  local_res10 = (longlong *)0x0;
  local_res18 = (longlong *)0x0;
  local_res8 = (longlong *)0x0;
  iVar3 = (***(code ***)*param_1)(*param_1,&DAT_180046fc0,&local_res20);
  if (iVar3 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((PTR_LOOP_1800537c8[0x1c] & 0x10) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
    goto LAB_18001e0db;
    uVar5 = 0x13;
  }
  else {
    iVar3 = (**(code **)(*local_res20 + 0x18))(local_res20,&local_res10);
    if (iVar3 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
          ((PTR_LOOP_1800537c8[0x1c] & 0x10) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
      goto LAB_18001e0db;
      uVar5 = 0x14;
    }
    else {
      param_1[1] = (undefined *)local_res10;
      (**(code **)(*local_res10 + 0x10))();
      cVar1 = (**(code **)(*local_res10 + 0x70))();
      if (cVar1 != '\x01') {
        DebugBreak();
      }
      iVar3 = (**(code **)(*local_res10 + 0x78))(local_res10,0,&local_res18);
      if (-1 < iVar3) {
        param_1[2] = (undefined *)local_res18;
        (**(code **)(*local_res18 + 0x10))();
        bVar2 = (**(code **)(*local_res18 + 0x50))();
        if (bVar2 < 2) {
          iVar3 = -0x7fff0001;
          if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
              ((PTR_LOOP_1800537c8[0x1c] & 0x10) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
          goto LAB_18001e0db;
          FUN_18001cc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x16,&DAT_180046fb0,(uint)bVar2,2
                        ,0xff);
        }
        else {
          uVar7 = 0;
          if (bVar2 != 0) {
            do {
              iVar3 = (**(code **)(*local_res18 + 0x70))(local_res18,uVar7,&local_res8);
              if (iVar3 < 0) {
                if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                    ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) &&
                   (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
                  FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x17,&DAT_180046fb0,uVar7
                                ,(char)iVar3);
                }
              }
              else {
                iVar4 = (**(code **)(*local_res8 + 0x88))();
                if (iVar4 == 0) {
                  iVar4 = (**(code **)(*local_res8 + 0x98))();
                  if (iVar4 == 2) {
                    param_1[5] = (undefined *)local_res8;
                  }
                  else {
                    if (iVar4 == 3) {
                      param_1[7] = (undefined *)local_res8;
                    }
                    else {
                      (**(code **)(*local_res8 + 0x18))();
                    }
                  }
                }
                else {
                  iVar4 = (**(code **)(*local_res8 + 0x98))();
                  if (iVar4 == 0) {
                    param_1[3] = (undefined *)local_res8;
                  }
                  else {
                    if (iVar4 == 2) {
                      param_1[4] = (undefined *)local_res8;
                    }
                    else {
                      if (iVar4 == 3) {
                        param_1[6] = (undefined *)local_res8;
                      }
                      else {
                        (**(code **)(*local_res8 + 0x18))();
                      }
                    }
                  }
                }
                if (local_res8 != (longlong *)0x0) {
                  (**(code **)(*local_res8 + 0x10))();
                }
                local_res8 = (longlong *)0x0;
              }
              bVar6 = (char)uVar7 + 1;
              uVar7 = (uint)bVar6;
            } while (bVar6 < bVar2);
          }
          if (((param_1[4] != (undefined *)0x0) && (param_1[5] != (undefined *)0x0)) ||
             ((iVar3 = -0x7fff0001, (undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8 ||
              (((PTR_LOOP_1800537c8[0x1c] & 0x10) == 0 || ((byte)PTR_LOOP_1800537c8[0x19] < 2))))))
          goto LAB_18001e0db;
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x18,&DAT_180046fb0,0x8000ffff);
        }
        iVar3 = -0x7fff0001;
        goto LAB_18001e0db;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
          ((PTR_LOOP_1800537c8[0x1c] & 0x10) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
      goto LAB_18001e0db;
      uVar5 = 0x15;
    }
  }
  FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar5,&DAT_180046fb0,iVar3);
LAB_18001e0db:
  if (local_res20 != (longlong *)0x0) {
    (**(code **)(*local_res20 + 0x10))(local_res20);
  }
  local_res20 = (longlong *)0x0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x19,&DAT_180046fb0);
  }
  return iVar3;
}



int FUN_18001e140(longlong **param_1,undefined8 *param_2,uint param_3,int param_4,int param_5,
                 int param_6,longlong *param_7)

{
  uint uVar1;
  longlong *plVar2;
  int iVar3;
  undefined8 *puVar4;
  undefined8 local_res10 [3];
  
  plVar2 = param_7;
  if ((param_2 == (undefined8 *)0x0) || ((param_3 == 0 && (param_4 != 0)))) {
    iVar3 = -0x7ff8ffa9;
  }
  else {
    if (*(int *)(param_1 + 0xe) == 0) {
      iVar3 = -0x7ff8ffeb;
    }
    else {
      if (param_4 == 0) {
        local_res10[0] = *param_2;
        if (param_5 == 0) {
          puVar4 = (undefined8 *)0x0;
          if (param_3 != 0) {
            puVar4 = param_2;
          }
        }
        else {
          uVar1 = (uint)((ulonglong)local_res10[0] >> 0x20);
          if ((short)((ulonglong)local_res10[0] >> 0x30) == 0) {
            param_3 = uVar1 >> 0x10;
            puVar4 = (undefined8 *)0x0;
          }
          else {
            param_3 = uVar1 >> 0x10;
            puVar4 = param_2 + 1;
          }
        }
        iVar3 = FUN_18001e900(param_1,local_res10,puVar4,param_3,param_7);
      }
      else {
        if (param_4 != 1) {
          iVar3 = -0x7fffbfff;
          goto LAB_18001e23f;
        }
        if (param_5 == 0) {
          iVar3 = FUN_18001ee60(*param_1,param_1[4],(longlong)param_2,(ulonglong)param_3,
                                (undefined4 *)param_7,1,param_6,(longlong *)(param_1 + 0xd));
        }
        else {
          iVar3 = FUN_18001ee60(*param_1,param_1[5],(longlong)param_2,(ulonglong)param_3,
                                (undefined4 *)param_7,0,param_6,(longlong *)(param_1 + 0xd));
        }
      }
      if (-1 < iVar3) {
        return iVar3;
      }
    }
  }
LAB_18001e23f:
  if (plVar2 != (longlong *)0x0) {
    *(undefined4 *)plVar2 = 0;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1e,&DAT_180046fb0,param_5,(char)iVar3
                 );
  }
  return iVar3;
}



int FUN_18001e2a0(longlong **param_1,longlong *param_2,longlong *param_3,undefined8 param_4,
                 int param_5,int param_6,int param_7,longlong *param_8)

{
  int iVar1;
  longlong *plVar2;
  int iVar3;
  undefined8 *puVar4;
  uint local_res10 [2];
  
  plVar2 = param_8;
  iVar1 = param_6;
  if ((param_2 == (longlong *)0x0) || (param_3 == (longlong *)0x0)) {
    iVar3 = -0x7ff8ffa9;
  }
  else {
    if (*(int *)(param_1 + 0xe) == 0) {
      iVar3 = -0x7ff8ffeb;
    }
    else {
      if (param_5 == 0) {
        puVar4 = (undefined8 *)(**(code **)(*param_3 + 0x60))(param_3,local_res10);
        iVar3 = FUN_18001e140(param_1,puVar4,local_res10[0],0,iVar1,param_7,plVar2);
      }
      else {
        if (param_5 == 1) {
          if (param_6 == 0) {
            iVar3 = FUN_18001f1b0(param_1[4],param_2,param_3,param_4,(undefined4 *)param_8,1,param_7
                                  ,param_1 + 0xd);
          }
          else {
            iVar3 = FUN_18001f1b0(param_1[5],param_2,param_3,param_4,(undefined4 *)param_8,0,param_7
                                  ,param_1 + 0xd);
          }
        }
        else {
          if (param_5 != 2) {
            iVar3 = -0x7fffbfff;
            goto LAB_18001e3e1;
          }
          if (param_6 == 0) {
            iVar3 = FUN_18001f1b0(param_1[6],param_2,param_3,param_4,(undefined4 *)param_8,1,param_7
                                  ,param_1 + 0xd);
          }
          else {
            iVar3 = FUN_18001f1b0(param_1[7],param_2,param_3,param_4,(undefined4 *)param_8,0,param_7
                                  ,param_1 + 0xd);
          }
        }
      }
      if (-1 < iVar3) {
        return iVar3;
      }
    }
  }
LAB_18001e3e1:
  if (plVar2 != (longlong *)0x0) {
    *(undefined4 *)plVar2 = 0;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1f,&DAT_180046fb0,iVar1,(char)iVar3);
  }
  return iVar3;
}



void FUN_18001e440(undefined **param_1)

{
  short sVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined8 *puVar5;
  ulonglong uVar6;
  longlong lVar7;
  undefined2 uVar8;
  undefined auStack632 [32];
  uint *local_258;
  undefined **local_250;
  uint local_248;
  undefined4 local_244;
  uint local_240;
  undefined4 local_23c;
  uint local_238 [4];
  undefined local_228 [256];
  undefined *local_128 [32];
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)auStack632;
  iVar3 = FUN_18001ddb0(param_1);
  if (iVar3 < 0) {
    if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001e8df;
    if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      uVar8 = 10;
LAB_18001e49b:
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar8,&DAT_180046fb0,iVar3);
    }
  }
  else {
    local_23c = 1;
    iVar3 = (**(code **)(*(longlong *)param_1[1] + 0x88))(param_1[1],1);
    if (iVar3 < 0) {
      if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001e8df;
      if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        uVar8 = 0xb;
        goto LAB_18001e49b;
      }
    }
    else {
      local_244 = 2000;
      iVar3 = (**(code **)(*(longlong *)param_1[4] + 0xa8))();
      if (iVar3 < 0) {
        if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001e8df;
        if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
          uVar8 = 0xc;
          goto LAB_18001e49b;
        }
      }
      else {
        iVar3 = (**(code **)(*(longlong *)param_1[5] + 0xa8))();
        if (iVar3 < 0) {
          if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001e8df;
          if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            uVar8 = 0xd;
            goto LAB_18001e49b;
          }
        }
        else {
          local_250 = param_1 + 9;
          local_238[0] = 0x12;
          local_258 = local_238;
          iVar3 = (**(code **)(*(longlong *)param_1[1] + 0x90))(param_1[1],1);
          if (iVar3 < 0) {
            if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001e8df;
            if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
              uVar8 = 0xe;
              goto LAB_18001e49b;
            }
          }
          else {
            sVar1 = *(short *)((longlong)param_1 + 0x52);
            if (sVar1 == 0x300) {
              *(undefined4 *)((longlong)param_1 + 0x44) = 1;
            }
            else {
              if (sVar1 == 0x570) {
                *(undefined4 *)((longlong)param_1 + 0x44) = 2;
                if (0x103f < (*(ushort *)((longlong)param_1 + 0x54) & 0xfff0)) {
                  *(undefined4 *)((longlong)param_1 + 0x44) = 3;
                }
              }
              else {
                if (sVar1 == 0x575) {
                  *(undefined4 *)((longlong)param_1 + 0x44) = 4;
                }
                else {
                  *(undefined4 *)((longlong)param_1 + 0x44) = 0;
                }
              }
            }
            if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
              FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xf,&DAT_180046fb0,
                            *(undefined4 *)((longlong)param_1 + 0x44));
            }
            if (*(char *)(param_1 + 0xb) != '\0') {
              iVar3 = 0;
              do {
                local_250 = (undefined **)local_228;
                local_258 = &local_248;
                local_248 = 0xff;
                iVar4 = (**(code **)(*(longlong *)param_1[1] + 0x90))
                                  (param_1[1],CONCAT71((int7)((ulonglong)local_258 >> 8),3));
                if (-1 < iVar4) {
                  local_250 = local_128;
                  local_258 = &local_240;
                  local_240 = 0xff;
                  iVar4 = (**(code **)(*(longlong *)param_1[1] + 0x90))
                                    (param_1[1],CONCAT71((int7)((ulonglong)local_258 >> 8),3));
                  uVar2 = local_248;
                  if ((((-1 < iVar4) && (local_248 == local_240)) &&
                      ((iVar4 = memcmp(local_228,local_128,(ulonglong)local_248), iVar4 == 0 &&
                       ((local_228[0] == uVar2 && (2 < local_228[0])))))) &&
                     ((local_228[0] & 1) == 0)) {
                    iVar4 = (int)((ulonglong)(longlong)(int)(local_228[0] - 2) >> 1) + -1;
                    lVar7 = (longlong)iVar4;
                    if (-1 < iVar4) {
                      do {
                        if ((0x36 < (ushort)(*(short *)(local_228 + lVar7 * 2 + 2) - 0x30U)) ||
                           ((0x7e0000007e03ffU >>
                             ((ulonglong)(ushort)(*(short *)(local_228 + lVar7 * 2 + 2) - 0x30U) &
                             0x3f) & 1) == 0)) break;
                        iVar4 = iVar4 + -1;
                        lVar7 = lVar7 + -1;
                      } while (-1 < lVar7);
                    }
                    if (iVar4 < 0) {
                      puVar5 = (undefined8 *)LocalAlloc(0x40,(ulonglong)local_228[0]);
                      param_1[0xc] = (undefined *)puVar5;
                      FUN_180023f20(puVar5,(undefined8 *)(local_228 + 2),
                                    (longlong)(int)(local_228[0] - 2));
                      *(undefined2 *)
                       (param_1[0xc] + ((longlong)(int)(local_228[0] - 2) & 0xfffffffffffffffe)) = 0
                      ;
                      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                          ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) &&
                         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
                        FUN_18000ff30(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x10,&DAT_180046fb0
                                      ,(wchar_t *)param_1[0xc]);
                      }
                      break;
                    }
                  }
                }
                iVar3 = iVar3 + 1;
              } while (iVar3 < 3);
            }
            uVar6 = FUN_18001eae0((longlong)param_1);
            iVar3 = (int)uVar6;
            if (iVar3 < 0) {
              if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) goto LAB_18001e8df;
              if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19]))
              {
                uVar8 = 0x11;
                goto LAB_18001e49b;
              }
            }
            else {
              *(undefined4 *)(param_1 + 0xe) = 1;
            }
          }
        }
      }
    }
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x12,&DAT_180046fb0);
  }
LAB_18001e8df:
  FUN_180023ef0(local_28 ^ (ulonglong)auStack632);
  return;
}



int FUN_18001e900(longlong **param_1,undefined8 param_2,undefined8 param_3,int param_4,
                 longlong *param_5)

{
  longlong *plVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  longlong *local_res8;
  code **local_38;
  longlong *local_30;
  
  plVar1 = param_5;
  local_res8 = (longlong *)0x0;
  local_30 = (longlong *)0x0;
  if (param_5 != (longlong *)0x0) {
    *(undefined4 *)param_5 = 0;
  }
  iVar2 = (**(code **)(**param_1 + 0xb8))(*param_1,0,0,&local_res8);
  iVar3 = iVar2;
  if (-1 < iVar2) {
    if (param_4 != 0) {
      param_5 = (longlong *)0x0;
      (**(code **)(**param_1 + 0x48))(*param_1,&param_5);
      iVar3 = (**(code **)(*param_5 + 0x50))(param_5,param_3,param_4,0,local_res8,&local_30);
      (**(code **)(*param_5 + 0x10))();
    }
    if (-1 < iVar3) {
      iVar3 = (**(code **)(*param_1[1] + 0x80))(param_1[1],local_res8,param_2,local_30,0);
      if (-1 < iVar3) {
        iVar3 = (**(code **)(*local_res8 + 0xb8))(local_res8,param_1[1],2,0);
        if (-1 < iVar3) {
          local_38 = (code **)0x0;
          (**(code **)(*local_res8 + 0xf0))(local_res8,&local_38);
          if (plVar1 != (longlong *)0x0) {
            param_5 = (longlong *)0x0;
            iVar4 = (**(code **)*local_38)(local_38,&DAT_180045a08,&param_5);
            if (iVar4 < 0) {
              DebugBreak();
            }
            iVar4 = (**(code **)(*param_5 + 0x30))();
            if (iVar4 != 2) {
              DebugBreak();
            }
            (**(code **)(*param_5 + 0x38))(param_5,0,plVar1,0,0);
            if (param_5 != (longlong *)0x0) {
              (**(code **)(*param_5 + 0x10))();
            }
          }
          if (local_38 != (code **)0x0) {
            (**(code **)(*local_38 + 0x10))();
          }
        }
      }
    }
  }
  if (local_30 != (longlong *)0x0) {
    (**(code **)(*local_30 + 0x10))();
  }
  if (-1 < iVar2) {
    (**(code **)(*local_res8 + 0x18))();
  }
  if (local_res8 != (longlong *)0x0) {
    (**(code **)(*local_res8 + 0x10))();
  }
  return iVar3;
}



ulonglong FUN_18001eae0(longlong param_1)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1a,&DAT_180046fb0);
  }
  uVar2 = (**(code **)(**(longlong **)(param_1 + 8) + 0xa0))(*(longlong **)(param_1 + 8),0x83,4);
  uVar3 = uVar2 & 0xffffffff;
  if ((int)uVar2 < 0) {
    if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
      return uVar2;
    }
    if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1b,&DAT_180046fb0,(int)uVar2);
    }
  }
  else {
    uVar1 = (**(code **)(**(longlong **)(param_1 + 8) + 0xa0))(*(longlong **)(param_1 + 8),0x81,4);
    uVar3 = (ulonglong)uVar1;
    if (-1 < (int)uVar1) goto LAB_18001ebe5;
  }
  if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
    return uVar3;
  }
  if (((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1c,&DAT_180046fb0,(int)uVar3);
  }
LAB_18001ebe5:
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 0x10) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1d,&DAT_180046fb0);
  }
  return uVar3;
}


// https://github.com/microsoft/Windows-driver-samples/blob/6ec85eac7246dcf8ee54943b8dc8463cbdf030c0/biometrics/driver/Device.cpp#L1064
void FUN_18001ec20(longlong *FxRequest,undefined8 /* char-array [8] or long ptr [2] */ param_2,undefined8 *param_3,undefined8 /* long ptr */ param_4,
                  undefined8 *param_5,undefined8 /* int ptr */ param_6)

{
  undefined8 uVar1;
  longlong *local_res8;
  
  // GetDeviceIoControlParameters
  (**(code **)(*FxRequest + 0x80))(FxRequest,param_2,param_4,param_6);
  local_res8 = (longlong *)0x0;

  // GetInputMemory
  (**(code **)(*FxRequest + 0x90))(FxRequest,&local_res8);
  if (local_res8 != (longlong *)0x0) {

    // IWDFMemory->GetDataBuffer
    uVar1 = (**(code **)(*local_res8 + 0x60))(local_res8,param_4 /* BufferSize */);
    *param_3 = uVar1;
    if (local_res8 != (longlong *)0x0) {
      (**(code **)(*local_res8 + 0x10))();
    }
  }
  local_res8 = (longlong *)0x0;

  // GetOutputMemory
  (**(code **)(*FxRequest + 0x88))(FxRequest,&local_res8);
  if (local_res8 != (longlong *)0x0) {
    uVar1 = (**(code **)(*local_res8 + 0x60))(local_res8,param_6);
    *param_5 = uVar1;
    if (local_res8 != (longlong *)0x0) {
      (**(code **)(*local_res8 + 0x10))();
    }
  }
  return;
}



void FUN_18001ecf0(longlong *param_1,undefined8 param_2,undefined8 *param_3,longlong *param_4,
                  undefined8 *param_5,longlong *param_6)

{
  // FUN_18001b290
  (**(code **)(*param_1 + 0x80))(param_1,param_2,param_4,param_6);
  if (*param_4 == 0) {
    *param_3 = 0;
  }
  else {
    (**(code **)(*param_1 + 0x90))(param_1,param_3);
  }
  if (*param_6 == 0) {
    *param_5 = 0;
  }
  else {
    (**(code **)(*param_1 + 0x88))(param_1,param_5);
  }
  return;
}



void FUN_18001ed80(ushort param_1,undefined2 param_2,ushort param_3)

{
  undefined8 uVar1;
  DWORDLONG dwlConditionMask;
  undefined auStack360 [32];
  undefined local_148 [12];
  undefined8 local_13c;
  WCHAR local_134;
  undefined local_132 [254];
  ulonglong local_34;
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)auStack360;
  local_148._0_4_ = 0x11c;
  local_148._4_8_ = 0;
  local_13c = 0;
  local_134 = L'\0';
  FUN_1800244a0((undefined (*) [16])local_132,0,0xfe);
  local_34 = 0;
  uVar1 = VerSetConditionMask(0,2,3);
  uVar1 = VerSetConditionMask(uVar1,1,3);
  dwlConditionMask = VerSetConditionMask(uVar1,0x20,3);
  local_148._4_8_ = (ulonglong)CONCAT24(param_2,(uint)param_1);
  local_34 = local_34 & 0xffffffffffff0000 | (ulonglong)param_3;
  VerifyVersionInfoW((LPOSVERSIONINFOEXW)local_148,0x23,dwlConditionMask);
  FUN_180023ef0(local_28 ^ (ulonglong)auStack360);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018001f175)

int FUN_18001ee60(longlong *param_1,longlong *param_2,longlong param_3,undefined8 param_4,
                 undefined4 *param_5,int param_6,int param_7,longlong *param_8)

{
  longlong lVar1;
  int iVar2;
  undefined4 uVar3;
  undefined2 uVar4;
  longlong *local_48;
  longlong *local_40;
  longlong *local_38 [2];
  
  local_40 = (longlong *)0x0;
  local_38[0] = (longlong *)0x0;
  if (param_3 == 0) {
    return -0x7fff0001;
  }
  iVar2 = (**(code **)(*param_1 + 0xb8))(param_1,0,0);
  if (iVar2 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((PTR_LOOP_1800537c8[0x1c] & 0x20) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
    goto LAB_18001f14f;
    uVar4 = 0xc;
  }
  else {
    (**(code **)(*param_1 + 0x48))(param_1,local_38);
    iVar2 = (**(code **)(*local_38[0] + 0x50))(local_38[0],param_3,param_4,0,0,&local_40);
    if (iVar2 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
          ((PTR_LOOP_1800537c8[0x1c] & 0x20) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
      goto LAB_18001f14f;
      uVar4 = 0xd;
    }
    else {
      if (param_6 == 1) {
        iVar2 = (**(code **)(*param_2 + 0x50))();
      }
      else {
        iVar2 = (**(code **)(*param_2 + 0x58))(param_2,0,0,local_40,0,0);
      }
      if (iVar2 < 0) {
        if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
          return iVar2;
        }
        if ((PTR_LOOP_1800537c8[0x1c] & 0x20) == 0) {
          return iVar2;
        }
        if ((byte)PTR_LOOP_1800537c8[0x19] < 2) {
          return iVar2;
        }
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xe,&DAT_180047010,iVar2);
        return iVar2;
      }
      (**(code **)(lRam0000000000000000 + 8))();
      *param_8 = 0;
      if (param_7 == 0) {
        iVar2 = (**(code **)(lRam0000000000000000 + 0xb8))(0,param_2,2);
      }
      else {
        iVar2 = (**(code **)(lRam0000000000000000 + 0xb8))(0,param_2,3);
      }
      if (((iVar2 < 0) && ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8)) &&
         (((PTR_LOOP_1800537c8[0x1c] & 0x20) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xf,&DAT_180047010,iVar2);
      }
      lVar1 = *param_8;
      *param_8 = 0;
      if (lVar1 == 0) {
        iVar2 = -0x7fffbffc;
        goto LAB_18001f14f;
      }
      (**(code **)(lRam0000000000000000 + 0x10))();
      if (-1 < iVar2) {
        local_48 = (longlong *)0x0;
        (**(code **)(lRam0000000000000000 + 0xf0))(0,&local_48);
        iVar2 = (**(code **)(*local_48 + 0x18))();
        if (iVar2 < 0) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x11,&DAT_180047010,iVar2);
          }
          (**(code **)(*local_48 + 0x10))();
        }
        else {
          if (param_5 != (undefined4 *)0x0) {
            uVar3 = (**(code **)(*local_48 + 0x20))();
            *param_5 = uVar3;
          }
          (**(code **)(*local_48 + 0x10))();
        }
        goto LAB_18001f14f;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
          ((PTR_LOOP_1800537c8[0x1c] & 0x20) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 2))
      goto LAB_18001f14f;
      uVar4 = 0x10;
    }
  }
  FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180047010,iVar2);
LAB_18001f14f:
  if (local_40 != (longlong *)0x0) {
    (**(code **)(*local_40 + 0x10))();
  }
  local_40 = (longlong *)0x0;
  (**(code **)(lRam0000000000000000 + 0x18))();
  if (local_38[0] != (longlong *)0x0) {
    (**(code **)(*local_38[0] + 0x10))();
  }
  return iVar2;
}



int FUN_18001f1b0(longlong *param_1,longlong *param_2,undefined8 param_3,undefined8 param_4,
                 undefined4 *param_5,int param_6,int param_7,longlong **param_8)

{
  longlong *plVar1;
  int iVar2;
  undefined4 uVar3;
  undefined2 uVar4;
  longlong *local_18 [2];
  
  if (param_6 == 1) {
    iVar2 = (**(code **)(*param_1 + 0x50))();
  }
  else {
    iVar2 = (**(code **)(*param_1 + 0x58))(param_1,param_2,0,param_3,param_4,0);
  }
  if (iVar2 < 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      uVar4 = 0x12;
LAB_18001f221:
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180047010,iVar2);
      return iVar2;
    }
  }
  else {
    (**(code **)(*param_2 + 8))();
    *param_8 = param_2;
    if (param_7 == 0) {
      iVar2 = (**(code **)(*param_2 + 0xb8))(param_2,param_1,2);
    }
    else {
      iVar2 = (**(code **)(*param_2 + 0xb8))(param_2,param_1,3);
    }
    if ((((iVar2 < 0) && ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8)) &&
        ((PTR_LOOP_1800537c8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x13,&DAT_180047010,iVar2);
    }
    plVar1 = *param_8;
    *param_8 = (longlong *)0x0;
    if (plVar1 == (longlong *)0x0) {
      iVar2 = -0x7fffbffc;
    }
    else {
      (**(code **)(*param_2 + 0x10))(param_2);
      if (-1 < iVar2) {
        local_18[0] = (longlong *)0x0;
        (**(code **)(*param_2 + 0xf0))(param_2,local_18);
        iVar2 = (**(code **)(*local_18[0] + 0x18))();
        if (iVar2 < 0) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((PTR_LOOP_1800537c8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x15,&DAT_180047010,iVar2);
            (**(code **)(*local_18[0] + 0x10))();
            return iVar2;
          }
        }
        else {
          if (param_5 != (undefined4 *)0x0) {
            uVar3 = (**(code **)(*local_18[0] + 0x20))();
            *param_5 = uVar3;
          }
        }
        (**(code **)(*local_18[0] + 0x10))();
        return iVar2;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 0x20) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        uVar4 = 0x14;
        goto LAB_18001f221;
      }
    }
  }
  return iVar2;
}



undefined ** FUN_18001f400(undefined **param_1,undefined *param_2,undefined *param_3)

{
  DWORD DVar1;
  undefined *puVar2;
  
  param_1[2] = (undefined *)0x0;
  FUN_180007320(param_1);
  *(undefined *)(param_1 + 3) = 0;
  *(undefined4 *)(param_1 + 4) = 0;
  param_1[0xb] = param_3;
  param_1[0xc] = param_2;
  param_1[0x5f] = &DAT_00000030;
  param_1[0x60] = (undefined *)0x80;
  *(undefined4 *)(param_1 + 0x67) = 0;
  *param_1 = (undefined *)&PTR_FUN_180047070;
  param_1[0x61] = (undefined *)0x0;
  param_1[0x62] = (undefined *)0x0;
  param_1[99] = (undefined *)0x0;
  param_1[100] = (undefined *)0x0;
  param_1[0x65] = (undefined *)0x0;
  param_1[0x66] = (undefined *)0x0;
  puVar2 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[5] = puVar2;
  puVar2 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[6] = puVar2;
  puVar2 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[7] = puVar2;
  puVar2 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[9] = puVar2;
  puVar2 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  *(undefined4 *)(param_1 + 8) = 0;
  param_1[10] = puVar2;
  param_1[0xd] = (undefined *)0x0;
  param_1[0xe] = (undefined *)0x0;
  param_1[0xf] = (undefined *)0x0;
  param_1[0x10] = (undefined *)0x0;
  param_1[0x11] = (undefined *)0x0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  if (((((param_1[5] == (undefined *)0x0) || (param_1[6] == (undefined *)0x0)) ||
       (param_1[7] == (undefined *)0x0)) ||
      ((param_1[9] == (undefined *)0x0 || (param_1[10] == (undefined *)0x0)))) &&
     (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8 &&
      (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])))))) {
    DVar1 = GetLastError();
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),10,&DAT_180047060,DVar1);
  }
  return param_1;
}



void FUN_18001f5b0(undefined **param_1)

{
  SIZE_T SVar1;
  undefined *puVar2;
  
  *param_1 = (undefined *)&PTR_FUN_180047070;
  if (param_1[0x65] != (undefined *)0x0) {
    LocalFree(param_1[0x65]);
  }
  if (param_1[5] != (undefined *)0x0) {
    CloseHandle(param_1[5]);
  }
  if (param_1[6] != (undefined *)0x0) {
    CloseHandle(param_1[6]);
  }
  if (param_1[7] != (undefined *)0x0) {
    CloseHandle(param_1[7]);
  }
  if (param_1[9] != (undefined *)0x0) {
    CloseHandle(param_1[9]);
  }
  if (param_1[10] != (undefined *)0x0) {
    CloseHandle(param_1[10]);
  }
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  *param_1 = (undefined *)&PTR_FUN_180044688;
  if (param_1[1] != (undefined *)0x0) {
    SVar1 = LocalSize(param_1[1]);
    puVar2 = param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree(param_1[1]);
  }
  return;
}



undefined ** FUN_18001f650(undefined **param_1,uint param_2)

{
  FUN_18001f5b0(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



void FUN_18001f680(longlong param_1,int param_2)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x20,&DAT_180047060);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  *(undefined *)(param_1 + 0x18) = 1;
  if (*(int *)(param_1 + 0x1c) != 1) {
    *(int *)(param_1 + 0x1c) = param_2;
  }
  if (param_2 != 2) {
    SetEvent(*(HANDLE *)(param_1 + 0x38));
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x21,&DAT_180047060);
  }
  return;
}



int FUN_18001f750(longlong *param_1)

{
  longlong *plVar1;
  int iVar2;
  HLOCAL pvVar3;
  undefined uVar4;
  uint local_res8 [2];
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1b,&DAT_180047060);
  }
  local_res8[0] = 0;
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
  if (*(int *)(param_1 + 8) == 1) {
    ResetEvent((HANDLE)param_1[9]);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  if (param_1[0x65] == 0) {
    pvVar3 = LocalAlloc(0x40,(ulonglong)*(uint *)(param_1 + 99));
    param_1[0x65] = (longlong)pvVar3;
    *(undefined4 *)(param_1 + 0x66) = *(undefined4 *)(param_1 + 99);
  }
  iVar2 = (**(code **)(*param_1 + 0xc0))(param_1,param_1[0x65],local_res8);
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  plVar1 = param_1 + 8;
  *(int *)plVar1 = *(int *)plVar1 + -1;
  if (*(int *)plVar1 == 0) {
    SetEvent((HANDLE)param_1[9]);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  if (iVar2 == 1) {
    uVar4 = 100;
    if (local_res8[0] < 100) {
      uVar4 = (char)local_res8[0];
    }
    *(undefined *)((longlong)param_1 + 0x321) = uVar4;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1c,&DAT_180047060,iVar2);
  }
  return iVar2;
}



void FUN_18001f8b0(longlong param_1)

{
  ulonglong uVar1;
  undefined *puVar2;
  
  if (*(longlong *)(param_1 + 0x328) != 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1f,&DAT_180047060);
    }
    puVar2 = *(undefined **)(param_1 + 0x328);
    for (uVar1 = (ulonglong)*(uint *)(param_1 + 0x330); uVar1 != 0; uVar1 = uVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree(*(HLOCAL *)(param_1 + 0x328));
    *(undefined8 *)(param_1 + 800) = 0;
    *(undefined8 *)(param_1 + 0x328) = 0;
    *(undefined8 *)(param_1 + 0x330) = 0;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

int FUN_18001f960(longlong *param_1,undefined param_2,int *param_3)

{
  longlong *plVar1;
  LPCRITICAL_SECTION lpCriticalSection;
  longlong lVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  int iVar7;
  undefined4 uVar8;
  DWORD DVar9;
  int iVar10;
  bool bVar11;
  bool bVar12;
  int local_res10;
  longlong *local_a0;
  longlong *local_98;
  undefined4 local_90;
  HANDLE local_88;
  longlong local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  undefined *local_58;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xd,&DAT_180047060);
  }
  local_88 = (HANDLE)param_1[7];
  local_80 = 0;
  local_90 = 1;
  local_a0 = (longlong *)0x0;
  local_98 = (longlong *)0x0;
  iVar10 = 3;
  local_res10 = 1;
  bVar4 = false;
  iVar7 = (***(code ***)(code **)param_1[0xb])((code **)param_1[0xb],&DAT_180045810,&local_98);
  if (-1 < iVar7) {
    local_60 = 0x18;
    local_58 = &DAT_180045628;
    (**(code **)(*local_98 + 0x18))(local_98,&local_60,0,0x20019,0,&local_a0,0);
    (**(code **)(*local_98 + 0x10))();
  }
  *(undefined *)(param_1 + 0x61) = param_2;
  *(undefined *)((longlong)param_1 + 0x309) = 0;
  iVar7 = (**(code **)(**(longlong **)(param_1[0xc] + 8) + 0xa0))
                    (*(longlong **)(param_1[0xc] + 8),0x81,4);
  WaitForSingleObject((HANDLE)param_1[5],0xffffffff);
  local_78 = 0;
  local_68 = 0;
  local_70 = 1;
  bVar5 = false;
  bVar12 = -1 < iVar7;
LAB_18001fac0:
  if (iVar10 == 3) {
    if (local_a0 != (longlong *)0x0) {
      (**(code **)(*local_a0 + 0x18))(local_a0,L"DeviceIdleEnabled",&local_78);
    }
    if (((int)local_70 != 0) != bVar4) {
      lVar2 = **(longlong **)(param_1[0xc] + 8);
      if (bVar4) {
        uVar8 = (**(code **)(lVar2 + 0xa0))(*(longlong **)(param_1[0xc] + 8),0x83,4);
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xf,&DAT_180047060,uVar8);
        }
        bVar4 = false;
      }
      else {
        uVar8 = (**(code **)(lVar2 + 0xa0))();
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xe,&DAT_180047060,uVar8);
        }
        bVar4 = true;
      }
    }
  }
  if ((param_3 != (int *)0x0) && (*param_3 == 0)) {
    if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
       (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (3 < (byte)PTR_LOOP_1800537c8[0x19])))) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x10,&DAT_180047060);
    }
LAB_180020124:
    iVar10 = 0xf;
LAB_1800201d6:
    if (!bVar5) goto LAB_180020203;
    goto LAB_1800201da;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x11,&DAT_180047060);
  }
  if (!bVar5) {
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
    if (*(int *)(param_1 + 8) == 1) {
      ResetEvent((HANDLE)param_1[9]);
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
    bVar5 = true;
  }
  lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0x68);
  EnterCriticalSection(lpCriticalSection);
  if (*(char *)(param_1 + 3) == '\0') {
    *(undefined4 *)(param_1 + 4) = 2;
    LeaveCriticalSection(lpCriticalSection);
    iVar10 = (**(code **)(*param_1 + 0xb8))(param_1);
  }
  else {
    LeaveCriticalSection(lpCriticalSection);
    iVar10 = 0xf;
  }
  bVar3 = false;
  bVar6 = false;
  bVar11 = false;
  EnterCriticalSection(lpCriticalSection);
  if (iVar10 == 3) {
    if (*(char *)(param_1 + 3) == '\x01') {
      iVar10 = 0xf;
LAB_18001fcc5:
      iVar7 = *(int *)((longlong)param_1 + 0x1c);
      bVar3 = false;
      bVar11 = bVar6;
      if (iVar7 - 2U < 2) {
        if (iVar7 != 3) {
          *(undefined4 *)(param_1 + 4) = 4;
        }
        else {
          *(undefined4 *)(param_1 + 4) = 3;
        }
        bVar3 = iVar7 == 3;
        *(char *)(param_1 + 3) = '\0';
        *(undefined4 *)((longlong)param_1 + 0x1c) = 0;
        iVar10 = 3;
        bVar11 = true;
      }
    }
    else {
      bVar11 = bVar6;
      if ((int)local_70 != 0) {
        bVar3 = true;
        *(undefined4 *)(param_1 + 4) = 3;
      }
    }
  }
  else {
    if (iVar10 == 0xf) goto LAB_18001fcc5;
  }
  LeaveCriticalSection(lpCriticalSection);
  if (iVar10 != 3) {
    if (iVar10 == 1) {
      *(undefined *)((longlong)param_1 + 0x309) = 0;
    }
    else {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x19,&DAT_180047060,
                      *(undefined4 *)((longlong)param_1 + 0x1c));
      }
    }
    goto LAB_1800201d6;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x12,&DAT_180047060);
  }
  if (bVar11) {
    if (bVar3) goto LAB_18001fd5e;
  }
  else {
    if (!bVar3) goto LAB_18001fac0;
LAB_18001fd5e:
    local_res10 = (**(code **)(*param_1 + 0xa8))(param_1,1);
    if (local_res10 != 1) goto LAB_1800201d6;
  }
  if (!bVar11) {
    (**(code **)(**(longlong **)(param_1[0xc] + 8) + 0xa0))();
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x13,&DAT_180047060);
    }
    local_80 = param_1[6];
    DVar9 = WaitForMultipleObjects(2,&local_88,0,2000);
    bVar12 = bVar11;
    if (DVar9 != 1) {
      if (bVar3) {
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
        plVar1 = param_1 + 8;
        *(int *)plVar1 = *(int *)plVar1 + -1;
        if (*(int *)plVar1 == 0) {
          SetEvent((HANDLE)param_1[9]);
        }
        LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
        iVar7 = (**(code **)(**(longlong **)(param_1[0xc] + 8) + 0xa0))();
        bVar11 = -1 < iVar7;
        WaitForSingleObject((HANDLE)param_1[5],0xffffffff);
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
        *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
        if (*(int *)(param_1 + 8) == 1) {
          ResetEvent((HANDLE)param_1[9]);
        }
        LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
        bVar5 = true;
        local_res10 = (**(code **)(*param_1 + 0xa8))(param_1);
        bVar12 = bVar11;
        if (local_res10 != 1) goto LAB_1800201da;
      }
      bVar12 = bVar11;
      if (DVar9 == 0) {
        if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
            ((PTR_LOOP_1800537c8[0x1c] & 8) == 0)) || ((byte)PTR_LOOP_1800537c8[0x19] < 4))
        goto LAB_180020124;
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x14,&DAT_180047060,
                      *(undefined4 *)((longlong)param_1 + 0x1c));
        iVar10 = 0xf;
        goto LAB_1800201d6;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x15,&DAT_180047060);
      }
      goto LAB_18001fac0;
    }
  }
  ResetEvent((HANDLE)param_1[10]);
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  plVar1 = param_1 + 8;
  *(int *)plVar1 = *(int *)plVar1 + -1;
  if (*(int *)plVar1 == 0) {
    SetEvent((HANDLE)param_1[9]);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x16,&DAT_180047060);
  }
  local_80 = param_1[5];
  DVar9 = WaitForMultipleObjects(2,&local_88,0,0xffffffff);
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x17,&DAT_180047060,DVar9);
  }
  FUN_180020980((longlong)param_1);
  bVar5 = true;
  if (!bVar11) {
    iVar7 = (**(code **)(**(longlong **)(param_1[0xc] + 8) + 0xa0))();
    bVar12 = -1 < iVar7;
    if (DVar9 == 0) {
      WaitForSingleObject((HANDLE)param_1[5],0xffffffff);
    }
  }
  if (bVar3) {
    local_res10 = (**(code **)(*param_1 + 0xa8))();
  }
  else {
    local_res10 = (**(code **)(*param_1 + 200))(param_1);
  }
  if (local_res10 == 1) {
    EnterCriticalSection(lpCriticalSection);
    if ((DVar9 == 0) || (*(char *)(param_1 + 3) == '\x01')) {
      LeaveCriticalSection(lpCriticalSection);
      if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
         (((PTR_LOOP_1800537c8[0x1c] & 8) != 0 && (3 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x18,&DAT_180047060,
                      *(undefined4 *)((longlong)param_1 + 0x1c));
      }
      iVar10 = 0xf;
      local_res10 = (**(code **)(*param_1 + 0xb0))(param_1);
    }
    else {
      *(undefined4 *)(param_1 + 4) = 1;
      LeaveCriticalSection(lpCriticalSection);
    }
  }
  SetEvent((HANDLE)param_1[10]);
  if (local_res10 != 1) {
LAB_1800201da:
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
    plVar1 = param_1 + 8;
    *(int *)plVar1 = *(int *)plVar1 + -1;
    if (*(int *)plVar1 == 0) {
      SetEvent((HANDLE)param_1[9]);
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x6d));
LAB_180020203:
    *(undefined4 *)(param_1 + 4) = 5;
    if (local_res10 != 1) {
      iVar10 = 2;
    }
    if (bVar4) {
      (**(code **)(**(longlong **)(param_1[0xc] + 8) + 0xa0))
                (*(longlong **)(param_1[0xc] + 8),0x83,4);
    }
    if (bVar12) {
      (**(code **)(**(longlong **)(param_1[0xc] + 8) + 0xa0))
                (*(longlong **)(param_1[0xc] + 8),0x81,4);
    }
    if (local_a0 != (longlong *)0x0) {
      (**(code **)(*local_a0 + 0x10))();
    }
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1a,&DAT_180047060,iVar10);
    }
    return iVar10;
  }
  goto LAB_18001fac0;
}



undefined4
FUN_180020320(longlong *param_1,int param_2,longlong *param_3,uint param_4,undefined4 *param_5,
             uint param_6,uint *param_7)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 uVar3;
  
  if (param_2 == 0x4427c0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x26,&DAT_180047060);
    }
    iVar1 = FUN_1800209d0(param_1);
    if (iVar1 == 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x27,&DAT_180047060);
      }
      return 0x8000ffff;
    }
    iVar1 = FUN_180007400((longlong)param_1,param_3,param_4,param_5,param_6,param_7);
  }
  else {
    if (param_2 == 0x4427c4) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x28,&DAT_180047060);
      }
      uVar2 = FUN_180007100(param_1 + 2,param_5,param_6,param_7);
      iVar1 = (int)uVar2;
    }
    else {
      if (param_2 != 0x4427c8) {
        if (param_7 != (uint *)0x0) {
          *param_7 = 0;
        }
        return 0x80070001;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x400) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x29,&DAT_180047060);
      }
      uVar2 = FUN_1800067f0(param_1 + 2,param_3,param_4);
      iVar1 = (int)uVar2;
    }
  }
  uVar3 = 0x8000ffff;
  if (iVar1 != 0) {
    uVar3 = 0;
  }
  return uVar3;
}



undefined8 FUN_1800204d0(longlong *param_1,int param_2,int param_3,int param_4)

{
  bool bVar1;
  uint uVar2;
  bool bVar3;
  DWORD DVar4;
  int iVar5;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18001cc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x22,&DAT_180047060,param_2,
                  (char)param_3,(char)*(undefined4 *)(param_1 + 4));
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
  iVar5 = 0;
  uVar2 = (uint)(*(int *)(param_1 + 4) - 1U < 2);
  bVar1 = *(int *)(param_1 + 4) - 3U < 2;
  if ((uVar2 != 0) || (bVar3 = false, bVar1)) {
    bVar3 = true;
  }
  *(uint *)((longlong)param_1 + 0x33c) = (uint)(param_4 == 0);
  if ((param_4 == 0) == 0) {
    if (*(int *)((longlong)param_1 + 0x1c) - 2U < 2) {
      *(undefined *)(param_1 + 3) = 0;
      goto LAB_1800205b0;
    }
  }
  else {
    if (*(int *)((longlong)param_1 + 0x1c) == 0) {
      *(undefined *)(param_1 + 3) = 1;
      iVar5 = (param_3 < 4) + 2;
LAB_1800205b0:
      *(int *)((longlong)param_1 + 0x1c) = iVar5;
    }
  }
  if (param_2 == param_3) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
    goto LAB_180020698;
  }
  if (1 < param_3) {
    ResetEvent((HANDLE)param_1[5]);
    SetEvent((HANDLE)param_1[6]);
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x68));
  if (param_3 == 2) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x23,&DAT_180047060);
    }
LAB_180020720:
    WaitForSingleObject((HANDLE)param_1[9],0xffffffff);
    if (!bVar3) {
      (**(code **)(*param_1 + 0xb0))(param_1);
    }
  }
  else {
    if (param_3 == 3) goto LAB_180020720;
    if (param_3 - 4U < 3) {
      WaitForSingleObject((HANDLE)param_1[9],0xffffffff);
      (**(code **)(*param_1 + 0xb0))(param_1);
    }
  }
  if (param_3 == 1) {
    ResetEvent((HANDLE)param_1[6]);
    SetEvent((HANDLE)param_1[5]);
    if ((bVar3) && (DVar4 = WaitForSingleObject((HANDLE)param_1[10],2000), DVar4 != 0)) {
      if ((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) {
        return 1;
      }
      if (((PTR_LOOP_1800537c8[0x1c] & 8) != 0) && (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x24,&DAT_180047060);
      }
    }
  }
LAB_180020698:
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18001cc90(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x25,&DAT_180047060,uVar2,bVar1,
                  (char)*(undefined4 *)(param_1 + 4));
  }
  return 1;
}



void FUN_180020750(longlong param_1,undefined param_2)

{
  if (*(longlong *)(param_1 + 0x328) != 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1d,&DAT_180047060);
    }
    FUN_180023f20(*(undefined8 **)(param_1 + 0x310),*(undefined8 **)(param_1 + 0x328),
                  (ulonglong)*(uint *)(param_1 + 0x330));
    *(undefined *)(param_1 + 0x308) = param_2;
    *(undefined *)(param_1 + 0x309) = *(undefined *)(param_1 + 0x321);
    return;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1e,&DAT_180047060);
  }
  FUN_1800244a0(*(undefined (**) [16])(param_1 + 0x310),0,(ulonglong)*(uint *)(param_1 + 0x318));
  *(undefined2 *)(param_1 + 0x308) = 0;
  return;
}



undefined8 FUN_180020840(longlong param_1,byte param_2)

{
  int iVar1;
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xb,&DAT_180047060,(uint)param_2);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  ResetEvent(*(HANDLE *)(param_1 + 0x38));
  iVar1 = *(int *)(param_1 + 0x33c);
  *(undefined4 *)(param_1 + 0x20) = 1;
  if (iVar1 == 0) {
    *(undefined4 *)(param_1 + 0x1c) = 0;
    *(undefined *)(param_1 + 0x18) = 0;
  }
  else {
    *(undefined4 *)(param_1 + 0x1c) = 2;
    *(undefined *)(param_1 + 0x18) = 1;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x340));
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((PTR_LOOP_1800537c8[0x1c] & 8) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xc,&DAT_180047060,iVar1);
  }
  return 1;
}



void FUN_180020930(longlong param_1)

{
  int *piVar1;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  piVar1 = (int *)(param_1 + 0x40);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    SetEvent(*(HANDLE *)(param_1 + 0x48));
  }
                    // WARNING: Could not recover jumptable at 0x00018002096a. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  return;
}



void FUN_180020980(longlong param_1)

{
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  *(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x40) + 1;
  if (*(int *)(param_1 + 0x40) == 1) {
    ResetEvent(*(HANDLE *)(param_1 + 0x48));
  }
                    // WARNING: Could not recover jumptable at 0x0001800209be. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x368));
  return;
}



void FUN_1800209d0(longlong *param_1)

{
  int iVar1;
  longlong lVar2;
  UCHAR *pUVar3;
  UCHAR local_38 [32];
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff98;
  iVar1 = FUN_1800014d0("U2Vj",0x24,&DAT_1800471c0,0x20,local_38);
  if (iVar1 != 0) {
    (**(code **)(*param_1 + 8))(param_1,&DAT_1800471e0,0x40,local_38);
    pUVar3 = local_38;
    for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
      *pUVar3 = '\0';
      pUVar3 = pUVar3 + 1;
    }
    FUN_180023ef0(local_18 ^ (ulonglong)&stack0xffffffffffffff98);
    return;
  }
  FUN_180023ef0(local_18 ^ (ulonglong)&stack0xffffffffffffff98);
  return;
}



undefined8 FUN_180020a70(longlong param_1)

{
  *(undefined4 *)(param_1 + 0x20) = 5;
  return 1;
}



void FUN_180020a80(undefined8 param_1,undefined4 *param_2,uint *param_3)

{
  undefined auStack104 [32];
  _FILETIME local_48;
  _FILETIME local_40;
  uint local_38;
  undefined4 uStack52;
  undefined4 uStack48;
  undefined4 uStack44;
  uint local_28;
  undefined4 uStack36;
  undefined4 uStack32;
  undefined4 uStack28;
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack104;
  if ((param_2 == (undefined4 *)0x0) || (*param_3 < 0x30)) {
    *param_3 = 0x30;
  }
  else {
    GetSystemTime((LPSYSTEMTIME)&local_38);
    uStack36 = uStack52;
    uStack32 = uStack48;
    uStack28 = uStack44;
    local_28 = local_38 & 0xffff0000 | (uint)(ushort)((short)local_38 + 1);
    SystemTimeToFileTime((SYSTEMTIME *)&local_38,(LPFILETIME)&local_40);
    SystemTimeToFileTime((SYSTEMTIME *)&local_28,(LPFILETIME)&local_48);
    *param_2 = 0x11112b72;
    *(_FILETIME *)(param_2 + 4) = local_40;
    *(_FILETIME *)(param_2 + 6) = local_40;
    *(_FILETIME *)(param_2 + 8) = local_48;
    *(undefined *)(param_2 + 1) = 0x20;
    param_2[2] = 8;
    *(undefined2 *)(param_2 + 3) = 0;
    *(undefined *)((longlong)param_2 + 0xe) = 0xff;
    param_2[10] = 0x401001b;
    param_2[0xb] = 0x401001b;
    *param_3 = 0x30;
  }
  FUN_180023ef0(local_18 ^ (ulonglong)auStack104);
  return;
}



undefined8 FUN_180020b70(undefined8 param_1,undefined8 *param_2,uint *param_3)

{
  if ((param_2 != (undefined8 *)0x0) && (0x27 < *param_3)) {
    param_2[1] = 0;
    param_2[2] = 0;
    param_2[3] = 0;
    param_2[4] = 0;
    *param_2 = 0x28;
    *(undefined4 *)(param_2 + 1) = 0x46495200;
    *(undefined4 *)((longlong)param_2 + 0xc) = 0x30313000;
    *(undefined4 *)(param_2 + 2) = 0x401001b;
    *param_3 = *(uint *)param_2;
    return 1;
  }
  *param_3 = 0x28;
  return 0x8007007a;
}



undefined ** FUN_180020bd0(undefined **param_1)

{
  undefined *puVar1;
  
  *(undefined4 *)(param_1 + 1) = 0;
  param_1[2] = (undefined *)0x0;
  param_1[3] = (undefined *)0x0;
  param_1[4] = (undefined *)0x0;
  param_1[5] = (undefined *)0x0;
  param_1[6] = (undefined *)0x0;
  *(undefined *)(param_1 + 7) = 0;
  *(undefined4 *)(param_1 + 8) = 5;
  param_1[9] = (undefined *)0x0;
  param_1[10] = (undefined *)0x0;
  *(undefined2 *)(param_1 + 0xd) = 0;
  *param_1 = (undefined *)&PTR_LAB_1800474c8;
  *(undefined4 *)((longlong)param_1 + 0x6c) = 2;
  param_1[0xf] = (undefined *)0x0;
  param_1[0x10] = (undefined *)0x0;
  param_1[0x11] = (undefined *)0x0;
  param_1[0x16] = (undefined *)0x0;
  param_1[0x1a] = (undefined *)0x0;
  *(undefined4 *)(param_1 + 0x1b) = 0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x18,&DAT_180047260);
  }
  *(undefined4 *)(param_1 + 0xe) = 0;
  *(undefined4 *)(param_1 + 0xb) = 0;
  puVar1 = (undefined *)CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,1,(LPCWSTR)0x0);
  param_1[0xc] = puVar1;
  return param_1;
}



void FUN_180020cd0(undefined **param_1)

{
  *param_1 = (undefined *)&PTR_LAB_1800474c8;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x19,&DAT_180047260);
  }
  if (*(char *)(param_1 + 7) != '\0') {
    *(undefined *)(param_1 + 7) = 0;
                    // WARNING: Could not recover jumptable at 0x000180020d2d. Too many branches
                    // WARNING: Treating indirect jump as call
    DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
    return;
  }
  return;
}



undefined ** FUN_180020d40(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)&PTR_LAB_180047528;
  *(undefined4 *)(param_1 + 1) = 0xc0000001;
  (**(code **)(*DAT_180056a00 + 0x10))();
  FUN_180020cd0(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180020da0(longlong param_1)

{
  undefined2 uVar1;
  bool bVar2;
  bool bVar3;
  DWORD DVar4;
  int iVar5;
  int iVar6;
  ULONGLONG UVar7;
  ULONGLONG UVar8;
  ULONGLONG UVar9;
  int *piVar10;
  uint uVar11;
  int iVar12;
  undefined4 uVar13;
  longlong lVar14;
  undefined8 *puVar15;
  undefined4 *puVar16;
  undefined2 local_res8 [4];
  uint local_res10;
  undefined4 uStackX20;
  
  UVar7 = GetTickCount64();
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),10,&DAT_180047260,
                  (uint)*(byte *)(*(longlong *)(param_1 + 0xa0) + 4));
  }
LAB_180020e10:
  bVar3 = false;
  lVar14 = 0;
  if (*(int *)(param_1 + 0xdc) != 0) {
LAB_180020f03:
    if (*(short *)(param_1 + 0x68) != 0) goto LAB_180020f0e;
LAB_180021108:
    iVar5 = FUN_18001f960(*(longlong **)(param_1 + 0xb8),
                          *(undefined *)(*(longlong *)(param_1 + 0xa0) + 4),(int *)(param_1 + 0xdc))
    ;
    if (((*(int *)(param_1 + 0xdc) != 0) || (iVar5 != 0xf)) || (*(int *)(param_1 + 0x58) != 0))
    goto LAB_18002117d;
    goto LAB_180020e10;
  }
  *(undefined4 *)(param_1 + 0xdc) = 1;
  if (*(short *)(param_1 + 0x68) == 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xb,&DAT_180047260);
    }
    UVar8 = GetTickCount64();
    FUN_1800227b0(param_1);
    if (*(ushort *)(param_1 + 0x68) == 0) {
      iVar5 = FUN_18001f750(*(longlong **)(param_1 + 0xb8));
      if (iVar5 == 1) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
           (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xd,&DAT_180047260);
        }
        *(undefined2 *)(param_1 + 0x68) = 0xffff;
      }
    }
    else {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xc,&DAT_180047260,
                      (uint)*(ushort *)(param_1 + 0x68));
      }
    }
    UVar9 = GetTickCount64();
    lVar14 = UVar9 - UVar8;
    goto LAB_180020f03;
  }
LAB_180020f0e:
  UVar8 = GetTickCount64();
  if ((ulonglong)(*(longlong *)(param_1 + 0xc0) + 0x1d4c + lVar14) < UVar8) {
    if ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) {
      if (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xe,&DAT_180047260);
      }
LAB_180021084:
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x53,&DAT_180047260);
      }
    }
    if (*(short *)(param_1 + 0x68) == -1) {
      FUN_18001f8b0(*(longlong *)(param_1 + 0xb8));
    }
    *(undefined4 *)(param_1 + 0xdc) = 1;
    *(undefined2 *)(param_1 + 0x68) = 0;
    goto LAB_180021108;
  }
  DVar4 = WTSGetActiveConsoleSessionId();
  if (DVar4 != 0xffffffff) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0xf,&DAT_180047260,DVar4);
    }
    iVar5 = WTSQuerySessionInformationW(0,DVar4,0x19);
    if (iVar5 != 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (4 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x10,&DAT_180047260,
                      *(undefined4 *)(CONCAT44(uStackX20,local_res10) + 0xc),
                      (char)*(undefined4 *)(CONCAT44(uStackX20,local_res10) + 8));
      }
      piVar10 = (int *)CONCAT44(uStackX20,local_res10);
      if ((((*piVar10 != 1) ||
           ((bVar2 = true, piVar10[3] == (uint)(_DAT_1800555a0 != 0) && (piVar10[2] == 0)))) &&
          (bVar2 = bVar3, (undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8)) &&
         (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0 &&
          (3 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x11,&DAT_180047260);
        piVar10 = (int *)CONCAT44(uStackX20,local_res10);
      }
      WTSFreeMemory(piVar10);
      if (!bVar2) goto LAB_180021084;
    }
  }
  if ((*(ulonglong *)(param_1 + 0xc0) <= UVar7) || (DVar4 = 0x5dc, *(int *)(param_1 + 200) != 3)) {
    DVar4 = 0xfa;
  }
  DVar4 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x60),DVar4);
  if (DVar4 == 0) {
    FUN_180020a70(*(longlong *)(param_1 + 0xb8));
    iVar5 = 0xf;
    goto LAB_18002117d;
  }
  if (*(char *)(*(longlong *)(param_1 + 0xa0) + 4) != '\x02') goto LAB_180021108;
  if (*(short *)(param_1 + 0x68) == -1) {
    FUN_180020750(*(longlong *)(param_1 + 0xb8),*(undefined *)(*(longlong *)(param_1 + 0xa0) + 4));
  }
  FUN_180020a70(*(longlong *)(param_1 + 0xb8));
  iVar5 = 1;
LAB_18002117d:
  lVar14 = *(longlong *)(param_1 + 0xa8);
  puVar15 = (undefined8 *)(lVar14 + 0x14);
  *puVar15 = 0;
  *(undefined8 *)(lVar14 + 0x1c) = 0;
  *(undefined8 *)(lVar14 + 0x24) = 0;
  *(undefined8 *)(lVar14 + 0x2c) = 0;
  if (iVar5 == 1) {
    puVar16 = (undefined4 *)(lVar14 + 0x34);
    uVar11 = *(int *)(*(longlong *)(param_1 + 0xa8) + 0x10) - 0x20;
    local_res10 = uVar11;
    iVar6 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x88))
                      (*(longlong **)(param_1 + 0xb8),puVar16,&local_res10);
    iVar12 = (int)puVar15;
    if (iVar6 == 0) {
      iVar6 = (int)puVar16;
      puVar16 = (undefined4 *)((longlong)puVar16 + (ulonglong)local_res10);
      uVar11 = uVar11 - local_res10;
      *(int *)(lVar14 + 0x18) = iVar6 - iVar12;
      *(uint *)puVar15 = local_res10;
    }
    local_res10 = uVar11;
    iVar6 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x90))
                      (*(longlong **)(param_1 + 0xb8),puVar16,&local_res10);
    if (iVar6 == 0) {
      *(int *)(lVar14 + 0x20) = (int)puVar16 - iVar12;
      *(uint *)(lVar14 + 0x1c) = local_res10;
      puVar16 = (undefined4 *)((longlong)puVar16 + (ulonglong)local_res10);
    }
    if ((*(short *)(param_1 + 0x68) == 0) ||
       (*(char *)(*(longlong *)(param_1 + 0xa0) + 4) != '\x02')) {
      *(undefined2 *)(puVar16 + 1) = 0;
      *puVar16 = 0;
    }
    else {
      local_res8[0] = 0;
      (**(code **)(**(longlong **)(param_1 + 0xb8) + 0xd8))
                (*(longlong **)(param_1 + 0xb8),local_res8,1);
      uVar1 = *(undefined2 *)(param_1 + 0x68);
      *puVar16 = 1;
      *(undefined2 *)(puVar16 + 1) = uVar1;
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x12,&DAT_180047260,
                      (uint)*(ushort *)(param_1 + 0x68));
      }
    }
    *(undefined4 *)(lVar14 + 0x24) = 8;
    *(int *)(lVar14 + 0x28) = (int)puVar16 - iVar12;
  }
  if ((*(int *)(*(longlong *)(param_1 + 0x80) + 0x94) < 3) && (*(int *)(param_1 + 0x58) == 0)) {
    if (iVar5 == 1) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x16,&DAT_180047260);
      }
      *(undefined4 *)(param_1 + 0x90) = 0;
      *(undefined4 *)(param_1 + 0x40) = 1;
      *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 4) = 0;
      *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 0xc) = 0;
      *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 8) = 1;
      goto LAB_180021480;
    }
    if (iVar5 == 0x14) {
      uVar13 = 9;
    }
    else {
      if (iVar5 == 0x1b) {
        uVar13 = 5;
      }
      else {
        if (iVar5 != 0x1c) {
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
             (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x14,&DAT_180047260);
          }
          *(undefined4 *)(param_1 + 0x90) = 0x8000ffff;
          goto LAB_180021446;
        }
        uVar13 = 7;
      }
    }
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x15,&DAT_180047260,uVar13);
    }
    *(undefined4 *)(param_1 + 0x90) = 0;
    *(undefined4 *)(param_1 + 0x94) = 0x18;
    *(undefined4 *)(param_1 + 0x40) = 2;
    **(undefined4 **)(param_1 + 0xa8) = 0x18;
    *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 4) = 0;
    *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 0xc) = uVar13;
  }
  else {
    if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
       (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0 && (3 < (byte)PTR_LOOP_1800537c8[0x19])
        ))) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x13,&DAT_180047260);
    }
    *(undefined4 *)(param_1 + 0x90) = 0x800703e3;
LAB_180021446:
    *(undefined4 *)(param_1 + 0x94) = 0x18;
    *(undefined4 *)(param_1 + 0x40) = 2;
    **(undefined4 **)(param_1 + 0xa8) = 0x18;
    *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 4) = 0x80098004;
  }
  *(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 8) = 2;
LAB_180021480:
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_1800239b0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x17,&DAT_180047260,
                  *(undefined4 *)(param_1 + 0x90),(char)*(undefined4 *)(param_1 + 0x94),
                  (char)*(undefined4 *)(*(longlong *)(param_1 + 0xa8) + 0xc));
  }
  return;
}



undefined8 FUN_1800214f0(longlong *param_1)

{
  FUN_180020da0((longlong)param_1);
  CloseHandle((HANDLE)param_1[0x16]);
  param_1[0x16] = 0;
  FUN_1800215e0((longlong)param_1);
  (**(code **)(*param_1 + 0x10))(param_1);
  return 0;
}



undefined4 FUN_180021540(undefined8 param_1,longlong param_2)

{
  byte bVar1;
  undefined4 uVar2;
  
  bVar1 = *(byte *)(param_2 + 4);
  if (((bVar1 < 0x11) && ((0x10116U >> (bVar1 & 0x1f) & 1) != 0)) || (bVar1 == 0x80)) {
    if (*(short *)(param_2 + 8) == 0x401 /* 1025 */) {
      if (*(short *)(param_2 + 6) == 0x1b /* 27 */) {
        uVar2 = 0;
        if (*(char *)(param_2 + 0x1c) != ' ') {
          uVar2 = 0x8009800d;
        }
      }
      else {
        uVar2 = 0x8009800c;
      }
    }
    else {
      uVar2 = 0x8009800c;
    }
  }
  else {
    uVar2 = 0x8009800e;
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2b,&DAT_180047260,uVar2);
  }
  return uVar2;
}



void FUN_1800215e0(longlong param_1)

{
  longlong *plVar1;
  
  plVar1 = *(longlong **)(param_1 + 0x78);
  *(longlong **)(param_1 + 0x78) = (longlong *)0x0;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (4 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2a,&DAT_180047260,(int)plVar1);
  }
  if (plVar1 != (longlong *)0x0) {
    (**(code **)(*plVar1 + 0xa0))(plVar1);
    (**(code **)(*plVar1 + 0x48))(plVar1);
    (**(code **)(*plVar1 + 0x50))(plVar1);
    FUN_18000fed0(*(longlong *)(param_1 + 0x80),0);
  }
  return;
}



DWORD FUN_180021690(longlong **param_1)

{
  BOOL BVar1;
  undefined **ppuVar2;
  DWORD DVar3;
  
  if (param_1 == (longlong **)0x0) {
    return 0x80004003;
  }
  *param_1 = (longlong *)0x0;
  DVar3 = 0x8007000e;
  ppuVar2 = (undefined **)FUN_1800251c0(0xe0);
  if (ppuVar2 == (undefined **)0x0) {
    ppuVar2 = (undefined **)0x0;
  }
  else {
    FUN_180020bd0(ppuVar2);
    *ppuVar2 = (undefined *)&PTR_LAB_180047528;
    (**(code **)(*DAT_180056a00 + 8))();
  }
  if (ppuVar2 == (undefined **)0x0) goto LAB_18002177a;
  DVar3 = 0;
  BVar1 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(ppuVar2 + 2),0,0);
  if (BVar1 == 0) {
    DVar3 = GetLastError();
    if (0 < (int)DVar3) {
      DVar3 = DVar3 & 0xffff | 0x80070000;
    }
    if (-1 < (int)DVar3) goto LAB_18002175d;
  }
  else {
LAB_18002175d:
    *(undefined *)(ppuVar2 + 7) = 1;
    if (-1 < (int)DVar3) {
      DVar3 = 0;
      goto LAB_18002177a;
    }
  }
  (**(code **)(*ppuVar2 + 0x20))(ppuVar2,1);
  ppuVar2 = (undefined **)0x0;
LAB_18002177a:
  *param_1 = (longlong *)ppuVar2;
  return DVar3;
}



DWORD FUN_180021790(undefined **param_1,longlong param_2,longlong **param_3)

{
  longlong *plVar1;
  DWORD DVar2;
  uint uVar3;
  DWORD local_res20 [2];
  HKEY local_28;
  longlong *local_20;
  
  local_20 = (longlong *)0x0;
  DVar2 = FUN_180021690(&local_20);
  local_28 = (HKEY)0x0;
  if (-1 < (int)DVar2) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1a,&DAT_180047260);
    }
    plVar1 = local_20;
    local_20[0x11] = (longlong)param_1;
    local_20[0x10] = param_2;
    DVar2 = (**(code **)*param_1)(param_1,&DAT_180045800,local_20 + 9);
    if (((int)DVar2 < 0) || (plVar1[9] == 0)) {
      DebugBreak();
    }
    *param_3 = plVar1;
    (**(code **)(*plVar1 + 8))(plVar1);
    uVar3 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                          L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WUDF\\Services\\EgisTouchFP0575\\FPParameters"
                          ,0,0x20019,(PHKEY)&local_28);
    if (uVar3 == 0) {
      local_res20[0] = 4;
      uVar3 = RegQueryValueExW(local_28,L"VerticalFlipEnabled",(LPDWORD)0x0,(LPDWORD)0x0,
                               (LPBYTE)(plVar1 + 0xe),local_res20);
      if (((uVar3 != 0) && ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8)) &&
         (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0 &&
          (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
        FUN_180023890(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1c,&DAT_180047260,
                      (ulonglong)uVar3,(char)local_res20[0]);
      }
    }
    else {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_180023a10(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1b,&DAT_180047260,
                      (ulonglong)uVar3);
      }
    }
    if (local_28 != (HKEY)0x0) {
      RegCloseKey(local_28);
    }
  }
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x1d,&DAT_180047260);
  }
  return DVar2;
}



void FUN_180021990(longlong param_1)

{
  CloseHandle(*(HANDLE *)(param_1 + 0x60));
  if (*(longlong **)(param_1 + 0x48) != (longlong *)0x0) {
    (**(code **)(**(longlong **)(param_1 + 0x48) + 0x10))();
  }
  if (*(longlong **)(param_1 + 0x50) != (longlong *)0x0) {
    (**(code **)(**(longlong **)(param_1 + 0x50) + 0x90))();
                    // WARNING: Could not recover jumptable at 0x0001800219d0. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(longlong **)(param_1 + 0x50) + 0x10))();
    return;
  }
  return;
}


// Calibrate
void FUN_1800219e0(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_res10 [8];
  undefined (*local_res18) [16];
  ulonglong local_res20;
  undefined local_40 [8];
  undefined8 local_38;
  longlong *local_30;
  
  local_30 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_38,local_40,&local_res18,&local_res20);
  if ((local_res18 == (undefined (*) [16])0x0) || (local_res20 < 4)) {
    uVar2 = 0x80070057;
  }
  else {
    if (local_res20 < 0x10) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x34,&DAT_180047260,0x10);
      }
      *(undefined4 *)*local_res18 = 0x10;
      (**(code **)(*param_2 + 0x48))(param_2,4);
      uVar2 = 0;
    }
    else {
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x68))();
      if (iVar1 == 0) {
        iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x70))();
        if ((((iVar1 < 0) && ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8)) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
           (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x35,&DAT_180047260);
        }
      }
      FUN_1800244a0(local_res18,0,local_res20);
      *(undefined4 *)*local_res18 = 0x10;
      uVar2 = 0;
      *(undefined4 *)(*local_res18 + 4) = 0;
      *(undefined4 *)(param_1 + 0x40) = 3;
      (**(code **)(*param_2 + 0x48))(param_2);
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x36,&DAT_180047260);
      }
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}


// Capture Data
// https://github.com/microsoft/Windows-driver-samples/blob/6ec85eac7246dcf8ee54943b8dc8463cbdf030c0/biometrics/driver/Device.cpp#L1451

void FUN_180021cd0(longlong *this,longlong *FxRequest)

{
  ulonglong *puVar1;
  ulonglong uVar2;
  int iVar3;
  undefined8 uVar4;
  HANDLE pvVar5;
  int iVar6;
  longlong lVar7;
  uint local_res18 [2];
  uint local_res20 [2];
  undefined controlCode [8];
  int *captureData;
  int outputBufferSize;
  undefined4 uStack68;
  longlong captureParams;
  ulonglong inputBufferSize [2];
  
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x39,&DAT_180047260);
  }
                    /* GetIoRequestParams */
  FUN_18001ec20(FxRequest,controlCode,&captureParams,inputBufferSize,&captureData,&outputBufferSize)
  ;
  if ((inputBufferSize[0] < 0x20) || (CONCAT44(uStack68,outputBufferSize) < 4)) {
                    /* FxRequest->SetInformation(information) */
    (**(code **)(*FxRequest + 0x48))(FxRequest,0);
                    /* FxRequest->Complete(hr) */
    (**(code **)(*FxRequest + 0x50))(FxRequest,0x80070057);
    return;
  }
  local_res20[0] = 0;
  local_res18[0] = 0;
  (**(code **)(*(longlong *)this[0x17] + 0x88))((longlong *)this[0x17],0,local_res20);  // this?
  (**(code **)(*(longlong *)this[0x17] + 0x90))((longlong *)this[0x17],0,local_res18);
  lVar7 = (ulonglong)local_res20[0] + 0x28 + (ulonglong)local_res18[0];
  iVar6 = (int)lVar7;
  if (CONCAT44(uStack68,outputBufferSize) < lVar7 + 0x18U) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_180023960(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3a,&DAT_180047260,outputBufferSize)
      ;
    }
    *captureData = iVar6 + 0x18;
    (**(code **)(*FxRequest + 0x48))(FxRequest,4);
    (**(code **)(*FxRequest + 0x50))(FxRequest,0);
  }
  else {
    iVar3 = FUN_180021540(this,captureParams);  // verifies captureParams
    if (iVar3 < 0) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3b,&DAT_180047260,iVar3);
      }
      captureData[1] = iVar3;  // hr
      *captureData = 0x18;  // PayloadSize
      captureData[2] = 3;  // ready
      captureData[3] = 0;  // reject detail
      captureData[4] = 0;  // capure data, NULL, this is probably where we're stuck at in linux
      (**(code **)(*FxRequest + 0x48))(FxRequest,0x18);
      lVar7 = *FxRequest;
      uVar4 = 0;
    }
    else {
      LOCK();
      puVar1 = (ulonglong *)(this + 0xf);
      uVar2 = *puVar1;
      *puVar1 = *puVar1 ^ (ulonglong)(uVar2 == 0) * (*puVar1 ^ (ulonglong)FxRequest);
      if (uVar2 == 0) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
           (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3c,&DAT_180047260);
        }
        *(undefined4 *)(this + 8) = 3;  // status?
        uVar4 = FUN_180020840(this[0x17],*(byte *)(captureParams + 4));
        if ((int)uVar4 == 1) {  // Ohk this is what windows returned right?
          this[0xf] = (longlong)FxRequest;  // Some precious info, at index 15
          if (FxRequest != (longlong *)0x0) {
            ResetEvent((HANDLE)this[0xc]);
            *(undefined4 *)(this + 0xb) = 0;
            FUN_18000fed0(this[0x10],1);  // Increments a counter
            (**(code **)(*FxRequest + 0x98))();  // CancelSentRequest or "UnmarkCancelable"?
          }
          *captureData = outputBufferSize;  // 4?
          captureData[1] = iVar3;  // hr
          captureData[2] = 3;  // ready
          captureData[3] = 0;  // reject detail
          captureData[4] = iVar6;  // data an int? waet?
          *(undefined4 *)(this + 0x12 /* 18 */) = 0;
          iVar6 = *captureData;  // waet?
          this[0x15 /* 21 */] = (longlong)captureData;
          *(int *)((longlong)this + 0x94) = iVar6;
          this[0x14 /* 20 */] = captureParams;
          (**(code **)(*this + 8))(this);
          // Whew?
          pvVar5 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_1800214f0,this,0,(LPDWORD)0x0);
          this[0x16] = (longlong)pvVar5;
          if (pvVar5 != (HANDLE)0x0) {
            return;
          }
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
             (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3f,&DAT_180047260);
          }
          FUN_180020a70(this[0x17]);  // what is there at 0x17
          FUN_1800215e0((longlong)this);
          (**(code **)(*this + 0x10))(this);
          return;
        }
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
           (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3d,&DAT_180047260);
        }
        this[0xf] = 0;
        *captureData = 0x18;
        captureData[1] = -0x7ff67fca;
        captureData[2] = 4;
        captureData[3] = 0;
        captureData[4] = 0;
        (**(code **)(*FxRequest + 0x48))(FxRequest,0x18);
        lVar7 = *FxRequest;
                    /* E_UNEXPECTED */
        uVar4 = 0x8000ffff;
      }
      else {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
           (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
          FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x3e,&DAT_180047260);
        }
        *captureData = 0x18;
        captureData[1] = -0x7ff67ff5;
        captureData[2] = 4;
        captureData[3] = 0;
        captureData[4] = 0;
        (**(code **)(*FxRequest + 0x48))(FxRequest,0x18);
        lVar7 = *FxRequest;
                    /* WINBIO_E_DATA_COLLECTION_IN_PROGRESS */
        uVar4 = 0x8009800b;
      }
    }
    (**(code **)(lVar7 + 0x50))(FxRequest,uVar4);
  }
  return;
}



void FUN_180022170(longlong param_1,longlong *param_2)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x53,&DAT_180047260);
  }
  if (*(short *)(param_1 + 0x68) == -1) {
    FUN_18001f8b0(*(longlong *)(param_1 + 0xb8));
  }
  *(undefined4 *)(param_1 + 0xdc) = 1;
  *(undefined2 *)(param_1 + 0x68) = 0;
  if (param_2 != (longlong *)0x0) {
    (**(code **)(*param_2 + 0x50))(param_2,0);
  }
  return;
}


// GET ATTRUBUTES
void FUN_180022200(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_res10 [2];
  undefined4 *local_res18;
  undefined8 local_res20;
  undefined8 local_48;
  ulonglong local_40;
  undefined8 local_38;
  longlong *local_30;
  
  local_38 = 0xfffffffffffffffe;
  uVar2 = 0;
  local_res10[0] = 0;
  local_48 = 0;
  local_res20 = 0;
  local_res18 = (undefined4 *)0x0;
  local_30 = param_2;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2c,&DAT_180047260);
  }
  FUN_18001ec20(param_2,local_res10,&local_48,&local_res20,&local_res18,&local_40);
  if ((local_res18 == (undefined4 *)0x0) || (local_40 < 4)) {
    if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
       (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])
        ))) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2d,&DAT_180047260);
    }
    uVar2 = 0x80070057;
  }
  else {
    if (local_40 < 0x62c) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2e,&DAT_180047260,0x62c);
      }
      *local_res18 = 0x62c;
      (**(code **)(*param_2 + 0x48))(param_2,4);
    }
    else {
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x60))();
      if (-1 < iVar1) {
        FUN_18000e6f0(*(longlong *)(param_1 + 0x80),(longlong)local_res18);
      }
      (**(code **)(*param_2 + 0x48))(param_2,*local_res18);
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (uVar2 = 0, 3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x2f,&DAT_180047260);
      }
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}



void FUN_1800223e0(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined4 local_res10;
  undefined local_res18 [8];
  uint *local_res20;
  longlong local_38;
  longlong local_30;
  ulonglong local_28;
  undefined8 local_20;
  longlong *local_18;
  
  local_20 = 0xfffffffffffffffe;
  local_18 = param_2;
  FUN_18001ec20(param_2,local_res18,&local_res20,&local_38,&local_30,&local_28);
  if ((((local_res20 == (uint *)0x0) || (local_38 != 4)) || (local_30 == 0)) ||
     (local_28 < *local_res20)) {
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x100))();
    if (iVar1 == 0) {
      (**(code **)(*param_2 + 0x48))(param_2,local_res10);
      uVar2 = 0;
    }
    else {
      uVar2 = 0x80004005;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}



void FUN_1800224a0(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_res10 [8];
  longlong local_res18;
  longlong local_res20;
  longlong local_38;
  longlong local_30;
  undefined8 local_28;
  longlong *local_20;
  
  local_28 = 0xfffffffffffffffe;
  local_20 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_res20,&local_38,&local_30,&local_res18);
  if ((((local_res20 == 0) || (local_38 == 0)) || (local_30 == 0)) || (local_res18 == 0)) {
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0xe8))();
    if (iVar1 == 0) {
      (**(code **)(*param_2 + 0x48))(param_2,local_res18);
      uVar2 = 0;
    }
    else {
      uVar2 = 0x80004005;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}



void FUN_180022560(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_res10 [8];
  undefined4 local_res18;
  undefined4 uStackX28;
  undefined *local_res20;
  undefined (*local_38) [16];
  longlong local_30;
  undefined8 local_28;
  longlong *local_20;
  
  local_28 = 0xfffffffffffffffe;
  local_20 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_res20,&local_30,&local_38,&local_res18);
  if ((((local_res20 == (undefined *)0x0) || (local_30 == 0)) ||
      (local_38 == (undefined (*) [16])0x0)) || (CONCAT44(uStackX28,local_res18) == 0)) {
    uVar2 = 0x80070057;
  }
  else {
    FUN_1800244a0(local_38,0xff,CONCAT44(uStackX28,local_res18));
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0xf8))
                      (*(longlong **)(param_1 + 0xb8),local_38,local_res18,*local_res20);
    if (iVar1 == 0) {
      (**(code **)(*param_2 + 0x48))(param_2,CONCAT44(uStackX28,local_res18));
      uVar2 = 0;
    }
    else {
      uVar2 = 0x80004005;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}



void FUN_180022640(longlong param_1,longlong *param_2)

{
  undefined4 local_res10 [2];
  undefined4 *local_res18;
  ulonglong local_res20;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  longlong *local_30;
  
  local_38 = 0xfffffffffffffffe;
  local_res10[0] = 0;
  local_40 = 0;
  local_48 = 0;
  local_res18 = (undefined4 *)0x0;
  local_res20 = 0;
  local_30 = param_2;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x42,&DAT_180047260);
  }
  FUN_18001ec20(param_2,local_res10,&local_40,&local_48,&local_res18,&local_res20);
  if (local_res20 < 0xc) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x43,&DAT_180047260,0xc);
    }
    (**(code **)(*param_2 + 0x48))(param_2,0);
  }
  else {
    *local_res18 = 0xc;
    local_res18[1] = 0;
    local_res18[2] = *(undefined4 *)(param_1 + 0x6c);
    (**(code **)(*param_2 + 0x48))(param_2,*local_res18);
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x44,&DAT_180047260);
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,0);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_1800227b0(longlong param_1)

{
  undefined uVar1;
  int iVar2;
  ULONGLONG UVar3;
  undefined2 uVar4;
  longlong **local_40a8;
  longlong *local_40a0;
  undefined8 local_4098;
  code **local_4090;
  longlong *local_4088;
  longlong *local_4080;
  longlong *local_4078;
  longlong *local_4070;
  longlong *local_4068;
  undefined8 local_4060;
  undefined local_4048 [14];
  ushort local_403a;
  ulonglong local_28;
  undefined8 local_20;
  
  local_20 = 0x1800227c8;
  local_4060 = 0xfffffffffffffffe;
  local_28 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffbf30;
  local_4090 = (code **)0x0;
  local_4078 = (longlong *)0x0;
  local_4070 = (longlong *)0x0;
  FUN_1800244a0((undefined (*) [16])local_4048,0,0x4014);
  if (*(longlong *)(param_1 + 0x50) == 0) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x53,&DAT_180047260);
    }
    if (*(short *)(param_1 + 0x68) == -1) {
      FUN_18001f8b0(*(longlong *)(param_1 + 0xb8));
    }
    *(undefined4 *)(param_1 + 0xdc) = 1;
    *(undefined2 *)(param_1 + 0x68) = 0;
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) == 0)) ||
       ((byte)PTR_LOOP_1800537c8[0x19] < 4)) goto LAB_180022e76;
    uVar4 = 0x48;
  }
  else {
    if (*(longlong *)(param_1 + 0xd0) != *(longlong *)(param_1 + 0xc0)) {
      *(longlong *)(param_1 + 0xd0) = *(longlong *)(param_1 + 0xc0);
      iVar2 = (**(code **)(**(longlong **)(param_1 + 0x88) + 0xb8))
                        (*(longlong **)(param_1 + 0x88),0,0);
      if (iVar2 < 0) {
LAB_180022cdf:
        if ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) {
          if (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0) &&
             (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
            uVar4 = 0x4a;
LAB_180022d08:
            FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180047260,iVar2);
          }
LAB_180022d22:
          if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
              ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
             (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
            FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x52,&DAT_180047260,
                          (uint)*(ushort *)(param_1 + 0x68),(char)*(undefined4 *)(param_1 + 0xdc));
          }
        }
      }
      else {
        (**(code **)(**(longlong **)(param_1 + 0x88) + 0x48))
                  (*(longlong **)(param_1 + 0x88),&local_4068);
        local_40a8 = &local_4078;
        (**(code **)(*local_4068 + 0x50))(local_4068,local_4048,0x4014);
        local_40a8 = &local_4070;
        iVar2 = (**(code **)(*local_4068 + 0x50))(local_4068,local_4048,0x4014);
        if (iVar2 < 0) goto LAB_180022cdf;
        local_4098 = 0;
        local_40a0 = local_4070;
        local_40a8 = (longlong **)0x0;
        iVar2 = (**(code **)(**(longlong **)(param_1 + 0x50) + 0x60))
                          (*(longlong **)(param_1 + 0x50),local_4090,0x8010204c);
        if (-1 < iVar2) {
          iVar2 = (**(code **)(*local_4090 + 0xb8))(local_4090,*(undefined8 *)(param_1 + 0x50),2);
          if (iVar2 < 0) {
            if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
               (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
              uVar4 = 0x4c;
LAB_180022a27:
              FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180047260,iVar2);
            }
LAB_180022a37:
            FUN_180022170(param_1,(longlong *)0x0);
          }
          else {
            local_4080 = (longlong *)0x0;
            (**(code **)(*local_4090 + 0xf0))(local_4090,&local_4080);
            iVar2 = (**(code **)(*local_4080 + 0x18))();
            uVar1 = (**(code **)(*local_4080 + 0x20))();
            (**(code **)(*local_4080 + 0x10))();
            if (iVar2 < 0) {
              if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                  ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
                 (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
                uVar4 = 0x4d;
                goto LAB_180022a27;
              }
              goto LAB_180022a37;
            }
            if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
               (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
              FUN_18000ffc0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x4e,&DAT_180047260,
                            (uint)local_403a,uVar1);
            }
            if (0xffe < (ushort)(local_403a - 1)) goto LAB_180022a37;
            *(ushort *)(param_1 + 0x68) = local_403a;
            local_403a = 0;
            local_4088 = (longlong *)0x0;
            if ((local_4090 != (code **)0x0) &&
               (iVar2 = (**(code **)*local_4090)(local_4090,&DAT_180045a18,&local_4088), iVar2 < 0))
            {
              local_4088 = (longlong *)0x0;
            }
            (**(code **)(*local_4088 + 0xf8))(local_4088,0);
            local_4098 = 0;
            local_40a0 = local_4070;
            local_40a8 = (longlong **)0x0;
            iVar2 = (**(code **)(**(longlong **)(param_1 + 0x50) + 0x60))
                              (*(longlong **)(param_1 + 0x50),local_4088,0x80102050);
            if (iVar2 < 0) {
              if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                  ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
                 (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
                uVar4 = 0x4f;
LAB_180022bb7:
                FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180047260,iVar2)
                ;
              }
LAB_180022bce:
              if (local_4088 != (longlong *)0x0) {
LAB_180022bdc:
                (**(code **)(*local_4088 + 0x10))();
              }
            }
            else {
              iVar2 = (**(code **)(*local_4088 + 0xb8))
                                (local_4088,*(undefined8 *)(param_1 + 0x50),2);
              if (-1 < iVar2) {
                (**(code **)(*local_4088 + 0xf0))(local_4088,&local_4080);
                iVar2 = (**(code **)(*local_4080 + 0x18))();
                (**(code **)(*local_4080 + 0x10))();
                if (((iVar2 + 0x80000000U & 0x80000000) == 0) && (iVar2 != -0x7ff8fffb)) {
                  if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                     (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0 &&
                      (1 < (byte)PTR_LOOP_1800537c8[0x19])))) {
                    uVar4 = 0x51;
                    goto LAB_180022bb7;
                  }
                  goto LAB_180022bce;
                }
                if (local_4088 == (longlong *)0x0) goto LAB_180022d22;
                goto LAB_180022bdc;
              }
              if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
                  ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
                 (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
                FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x50,&DAT_180047260,iVar2);
              }
              FUN_180022170(param_1,(longlong *)0x0);
              if (local_4088 != (longlong *)0x0) {
                (**(code **)(*local_4088 + 0x10))();
              }
            }
          }
          goto LAB_180022d22;
        }
        if ((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) {
          if (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) == 0) ||
             ((byte)PTR_LOOP_1800537c8[0x19] < 2)) goto LAB_180022d22;
          uVar4 = 0x4b;
          goto LAB_180022d08;
        }
      }
      if (local_4078 != (longlong *)0x0) {
        (**(code **)(*local_4078 + 0x10))();
      }
      local_4078 = (longlong *)0x0;
      if (local_4070 != (longlong *)0x0) {
        (**(code **)(*local_4070 + 0x10))();
      }
      local_4070 = (longlong *)0x0;
      (**(code **)(*local_4090 + 0x18))();
      if (local_4090 != (code **)0x0) {
        (**(code **)(*local_4090 + 0x10))();
      }
      local_4090 = (code **)0x0;
      if (local_4068 != (longlong *)0x0) {
        (**(code **)(*local_4068 + 0x10))();
      }
      goto LAB_180022e76;
    }
    UVar3 = GetTickCount64();
    if (UVar3 - *(longlong *)(param_1 + 0xd0) < 0x493e1) {
      WaitForSingleObject(*(HANDLE *)(param_1 + 0x60),0x9c4);
      goto LAB_180022e76;
    }
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x53,&DAT_180047260);
    }
    if (*(short *)(param_1 + 0x68) == -1) {
      FUN_18001f8b0(*(longlong *)(param_1 + 0xb8));
    }
    *(undefined4 *)(param_1 + 0xdc) = 1;
    *(undefined2 *)(param_1 + 0x68) = 0;
    if ((((undefined **)PTR_LOOP_1800537c8 == &PTR_LOOP_1800537c8) ||
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) == 0)) ||
       ((byte)PTR_LOOP_1800537c8[0x19] < 4)) goto LAB_180022e76;
    uVar4 = 0x49;
  }
  FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar4,&DAT_180047260);
LAB_180022e76:
  FUN_180023ef0(local_28 ^ (ulonglong)&stack0xffffffffffffbf30);
  return;
}



void FUN_180022eb0(longlong param_1,longlong *param_2)

{
  ulonglong uVar1;
  int iVar2;
  undefined8 uVar3;
  undefined local_res10 [8];
  undefined (*local_res18) [16];
  undefined4 local_res20;
  undefined4 uStackX36;
  undefined local_40 [8];
  undefined8 local_38;
  longlong *local_30;
  
  local_30 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_38,local_40,&local_res18,&local_res20);
  if ((local_res18 == (undefined (*) [16])0x0) ||
     (uVar1 = CONCAT44(uStackX36,local_res20), uVar1 < 4)) {
    uVar3 = 0x80070057;
  }
  else {
    if (uVar1 < 0x14) {
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x37,&DAT_180047260,0x14);
      }
      *(undefined4 *)*local_res18 = 0x14;
      (**(code **)(*param_2 + 0x48))(param_2,4);
      uVar3 = 0;
    }
    else {
      FUN_1800244a0(local_res18,0,uVar1);
      *(undefined4 *)*local_res18 = 0x14;
      uVar3 = 0;
      if (*(int *)(*(longlong *)(param_1 + 0x80) + 0x94) < 3) {
        *(undefined4 *)(*local_res18 + 4) = 0;
        if (*(int *)(param_1 + 0x40) - 1U < 2) {
          *(undefined4 *)(param_1 + 0x40) = 3;
        }
        *(undefined4 *)(*local_res18 + 8) = *(undefined4 *)(param_1 + 0x40);
        if (*(int *)(param_1 + 0x40) == 5) {
          iVar2 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x68))();
          if (iVar2 != 0) {
            *(undefined4 *)(param_1 + 0x40) = 3;
            *(undefined4 *)(*local_res18 + 8) = 3;
          }
        }
      }
      else {
        *(undefined4 *)(*local_res18 + 8) = 2;
        *(undefined4 *)(param_1 + 0x40) = 2;
        *(undefined4 *)(*local_res18 + 4) = 0x8009800f;
      }
      if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
          ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
         (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
        FUN_1800238e0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x38,&DAT_180047260,
                      (ulonglong)*(uint *)(*local_res18 + 8),(char)*(undefined4 *)(*local_res18 + 4)
                      ,0,(char)local_res20,(char)*(undefined4 *)*local_res18);
      }
      (**(code **)(*param_2 + 0x48))(param_2,CONCAT44(uStackX36,local_res20));
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar3);
  return;
}



void FUN_1800230b0(undefined8 param_1,longlong *param_2)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x41,&DAT_180047260);
  }
                    // WARNING: Could not recover jumptable at 0x000180023100. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_2 + 0x50))(param_2,0x80004001);
  return;
}



void FUN_180023110(longlong param_1,longlong *param_2)

{
  undefined4 uVar1;
  undefined4 local_res8 [2];
  undefined4 local_res10 [2];
  uint local_res18 [2];
  undefined8 local_res20;
  uint *puVar2;
  undefined4 local_28 [2];
  undefined8 local_20 [2];
  
  puVar2 = local_res18;
  FUN_18001ec20(param_2,local_res10,local_20,local_28,&local_res20,puVar2);
  local_res8[0] = 0;
  uVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x118))
                    (*(longlong **)(param_1 + 0xb8),local_res10[0],local_20[0],local_28[0],
                     local_res20,(ulonglong)puVar2 & 0xffffffff00000000 | (ulonglong)local_res18[0],
                     local_res8);
  (**(code **)(*param_2 + 0x40))(param_2,uVar1,local_res8[0]);
  return;
}



void FUN_1800231b0(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_res10 [8];
  longlong local_res18;
  longlong local_res20;
  undefined local_30 [8];
  undefined8 local_28;
  longlong *local_20;
  
  local_20 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_28,local_30,&local_res20,&local_res18);
  if ((local_res20 == 0) || (local_res18 == 0)) {
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0xf0))();
    if (iVar1 == 0) {
      (**(code **)(*param_2 + 0x48))(param_2,local_res18);
      uVar2 = 0;
    }
    else {
      uVar2 = 0x80004005;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}



void FUN_180023260(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined local_res10 [8];
  ulonglong local_res18;
  longlong local_res20;
  longlong local_38;
  ulonglong local_30;
  undefined8 local_28;
  longlong *local_20;
  
  local_28 = 0xfffffffffffffffe;
  local_20 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_38,&local_30,&local_res20,&local_res18);
  if ((((local_res20 == 0) || (local_res18 == 0)) || (local_38 == 0)) ||
     ((local_30 == 0 || (local_30 != local_res18)))) {
    uVar2 = 0x80070057;
  }
  else {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0xd8))
                      (*(longlong **)(param_1 + 0xb8),local_38,local_30 & 0xffffffff);
    if (iVar1 == 0) {
      (**(code **)(*param_2 + 0x48))(param_2,local_res18);
      uVar2 = 0;
    }
    else {
      uVar2 = 0x80004005;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar2);
  return;
}



void FUN_180023330(longlong param_1,longlong *param_2)

{
  int iVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  undefined local_res10 [8];
  undefined4 *local_res18;
  ulonglong local_res20;
  undefined local_40 [8];
  undefined8 local_38;
  longlong *local_30;
  
  local_30 = param_2;
  FUN_18001ec20(param_2,local_res10,&local_38,local_40,&local_res18,&local_res20);
  if ((local_res18 == (undefined4 *)0x0) || (local_res20 < 4)) {
    (**(code **)(*param_2 + 0x48))(param_2,0);
    uVar3 = 0x80070057;
    goto LAB_180023576;
  }
  if (local_res20 < 8) {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000fef0(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x30,&DAT_180047260,8);
    }
    (**(code **)(*param_2 + 0x48))(param_2,4);
    uVar3 = 0;
    goto LAB_180023576;
  }
  if (*(longlong *)(param_1 + 0x78) != 0) {
    FUN_18001f680(*(longlong *)(param_1 + 0xb8),5);
    WaitForSingleObject(*(HANDLE *)(param_1 + 0xb0),0xffffffff);
  }
  (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x40))();
  (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x58))();
  *local_res18 = 8;
  uVar3 = 0;
  local_res18[1] = 0;
  iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x38))();
  if (iVar1 == 1) {
    iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x68))();
    if (iVar1 == 0) {
      iVar1 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0x70))();
      if (iVar1 < 0) {
        if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
            ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
           (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
          uVar2 = 0x32;
          goto LAB_1800234ca;
        }
        goto LAB_1800234da;
      }
    }
    *(undefined4 *)(param_1 + 0x40) = 3;
    (**(code **)(*param_2 + 0x48))(param_2,*local_res18);
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (2 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x33,&DAT_180047260);
    }
  }
  else {
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (1 < (byte)PTR_LOOP_1800537c8[0x19])) {
      uVar2 = 0x31;
LAB_1800234ca:
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),uVar2,&DAT_180047260);
    }
LAB_1800234da:
    *local_res18 = 8;
    local_res18[1] = 0x80098036;
    (**(code **)(*param_2 + 0x48))(param_2,*local_res18);
    uVar3 = 0x80004005;
  }
LAB_180023576:
  (**(code **)(*param_2 + 0x50))(param_2,uVar3);
  return;
}



void FUN_180023590(longlong param_1,longlong *param_2)

{
  undefined8 uVar1;
  undefined4 local_res10 [2];
  longlong local_res18;
  ulonglong local_res20;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  longlong *local_30;
  
  local_38 = 0xfffffffffffffffe;
  uVar1 = 0;
  local_res10[0] = 0;
  local_res18 = 0;
  local_res20 = 0;
  local_40 = 0;
  local_48 = 0;
  local_30 = param_2;
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x45,&DAT_180047260);
  }
  FUN_18001ec20(param_2,local_res10,&local_res18,&local_res20,&local_40,&local_48);
  if ((local_res18 == 0) || (local_res20 < 8)) {
    if (((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
       (((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0 && (1 < (byte)PTR_LOOP_1800537c8[0x19])
        ))) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x46,&DAT_180047260);
    }
    uVar1 = 0x80070057;
  }
  else {
    *(undefined4 *)(param_1 + 0x6c) = *(undefined4 *)(local_res18 + 4);
    (**(code **)(*param_2 + 0x48))(param_2,0);
    if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
        ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) &&
       (3 < (byte)PTR_LOOP_1800537c8[0x19])) {
      FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x47,&DAT_180047260);
      uVar1 = 0;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar1);
  return;
}



void FUN_1800236e0(undefined8 param_1,longlong *param_2)

{
  if ((((undefined **)PTR_LOOP_1800537c8 != &PTR_LOOP_1800537c8) &&
      ((*(uint *)(PTR_LOOP_1800537c8 + 0x1c) & 0x200) != 0)) && (3 < (byte)PTR_LOOP_1800537c8[0x19])
     ) {
    FUN_18000e080(*(undefined8 *)(PTR_LOOP_1800537c8 + 0x10),0x40,&DAT_180047260);
  }
                    // WARNING: Could not recover jumptable at 0x000180023730. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(*param_2 + 0x50))(param_2,0x80004001);
  return;
}



void FUN_180023740(longlong param_1,longlong *param_2)

{
  longlong lVar1;
  int iVar2;
  undefined4 uVar3;
  longlong local_258;
  ulonglong local_250;
  undefined local_248 [8];
  undefined8 local_240;
  undefined8 local_238;
  undefined8 local_230;
  longlong *local_228;
  undefined local_218 [256];
  undefined local_118 [256];
  ulonglong local_18;
  
  local_238 = 0xfffffffffffffffe;
  local_18 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffd78;
  local_228 = param_2;
  FUN_18001ec20(param_2,local_248,&local_258,&local_250,&local_230,&local_240);
  if (((local_258 == 0) || (local_250 == 0)) || ((local_250 & 1) != 0)) {
    uVar3 = 0x80070057;
  }
  else {
    uVar3 = 0;
    iVar2 = 0;
    if (local_250 >> 1 != 0) {
      lVar1 = 0;
      do {
        local_118[lVar1] = *(undefined *)(local_258 + lVar1 * 2);
        local_218[lVar1] = *(undefined *)(local_258 + 1 + lVar1 * 2);
        iVar2 = iVar2 + 1;
        lVar1 = lVar1 + 1;
      } while ((ulonglong)(longlong)iVar2 < local_250 >> 1);
    }
    iVar2 = (**(code **)(**(longlong **)(param_1 + 0xb8) + 0xe0))
                      (*(longlong **)(param_1 + 0xb8),local_118,local_250 >> 1 & 0x7fffffff,
                       local_218);
    if (iVar2 == 0) {
      (**(code **)(*param_2 + 0x48))(param_2,local_240);
    }
    else {
      uVar3 = 0x80004005;
    }
  }
  (**(code **)(*param_2 + 0x50))(param_2,uVar3);
  FUN_180023ef0(local_18 ^ (ulonglong)&stack0xfffffffffffffd78);
  return;
}



void FUN_180023890(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,4,0);
  return;
}



void FUN_1800238e0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5,undefined param_6,undefined param_7,undefined param_8)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,4,&param_6,4,&param_7,4,&param_8
               ,4,0);
  return;
}



void FUN_180023960(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,8,0);
  return;
}



void FUN_1800239b0(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
                  undefined param_5,undefined param_6)

{
  undefined4 local_res20 [2];
  
  local_res20[0] = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,8,&param_6,8,0);
  return;
}



void FUN_180023a10(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,0);
  return;
}



void FUN_180023a50(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
                  undefined param_5)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,8,0);
  return;
}



void TraceMessage(void)

{
                    // WARNING: Could not recover jumptable at 0x000180023a96. Too many branches
                    // WARNING: Treating indirect jump as call
  TraceMessage();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180023a9c(undefined8 param_1,int param_2,longlong param_3)

{
  bool bVar1;
  int iVar2;
  DWORD DVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  longlong lVar5;
  DWORD *_Memory;
  
  if (param_2 == 1) {
    bVar1 = FUN_180026ce0();
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      iVar2 = _mtinit();
      if (iVar2 != 0) {
        FUN_180027de8();
        DAT_180057bd0 = GetCommandLineA();
        DAT_180055680 = __crtGetEnvironmentStringsA();
        uVar4 = FUN_180026d0c();
        if (-1 < (int)uVar4) {
          iVar2 = _setargv();
          if (((-1 < iVar2) && (iVar2 = _setenvp(), -1 < iVar2)) &&
             (uVar4 = FUN_1800269a4(), (int)uVar4 == 0)) {
            DAT_180055678 = DAT_180055678 + 1;
            goto LAB_180023bf0;
          }
          _ioterm();
        }
        FUN_1800267a4();
      }
      FUN_180026d00();
    }
LAB_180023ab7:
    uVar4 = 0;
  }
  else {
    if (param_2 == 0) {
      if (DAT_180055678 < 1) goto LAB_180023ab7;
      DAT_180055678 = DAT_180055678 + -1;
      if (_DAT_180055c60 == 0) {
        FUN_180026994();
      }
      FUN_180026824();
      if (param_3 == 0) {
        _ioterm();
        FUN_1800267a4();
        FUN_180026d00();
        if (DAT_180053808 != -1) {
          FUN_1800267a4();
        }
      }
    }
    else {
      if (param_2 == 2) {
        lVar5 = FUN_18002775c();
        if (lVar5 == 0) {
          _Memory = (DWORD *)FUN_180027c68(1,0x478);
          if (_Memory != (DWORD *)0x0) {
            iVar2 = FUN_180027778();
            if (iVar2 != 0) {
              FUN_180026660((longlong)_Memory,0);
              DVar3 = GetCurrentThreadId();
              *_Memory = DVar3;
              *(undefined8 *)(_Memory + 2) = 0xffffffffffffffff;
              goto LAB_180023bf0;
            }
            free(_Memory);
          }
          goto LAB_180023ab7;
        }
      }
      else {
        if (param_2 == 3) {
          _freeptd((_ptiddata)0x0);
        }
      }
    }
LAB_180023bf0:
    uVar4 = 1;
  }
  return uVar4;
}



// WARNING: Removing unreachable block (ram,0x000180023cfb)
// WARNING: Removing unreachable block (ram,0x000180023c8d)
// WARNING: Removing unreachable block (ram,0x000180023d35)

ulonglong entry(HMODULE param_1,int param_2,longlong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  if (param_2 == 1) {
    FUN_1800274a0();
  }
  if ((param_2 == 0) && (DAT_180055678 == 0)) {
    uVar1 = 0;
  }
  else {
    if ((param_2 - 1U < 2) && (uVar2 = FUN_180023a9c(param_1,param_2,param_3), (int)uVar2 == 0)) {
      uVar1 = 0;
    }
    else {
      uVar3 = FUN_18000dde0(param_1,param_2);
      uVar1 = uVar3 & 0xffffffff;
      if ((param_2 == 1) && ((int)uVar3 == 0)) {
        FUN_18000dde0(param_1,0);
        FUN_180023a9c(param_1,0,param_3);
      }
      if ((param_2 == 0) || (param_2 == 3)) {
        uVar2 = FUN_180023a9c(param_1,param_2,param_3);
        uVar1 = (ulonglong)(-(uint)((int)uVar2 != 0) & (uint)uVar1);
      }
    }
  }
  return uVar1;
}



// Library Function - Single Match
//  free
// 
// Library: Visual Studio 2012 Release

void free(void *_Memory)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  int *piVar4;
  
  if ((_Memory != (void *)0x0) && (BVar1 = HeapFree(DAT_180055c78,0,_Memory), BVar1 == 0)) {
    piVar4 = _errno();
    DVar2 = GetLastError();
    iVar3 = _get_errno_from_oserr(DVar2);
    *piVar4 = iVar3;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  malloc
// 
// Library: Visual Studio 2012 Release

void * malloc(size_t _Size)

{
  int iVar1;
  void *pvVar2;
  int *piVar3;
  SIZE_T dwBytes;
  
  if (_Size < 0xffffffffffffffe1) {
    dwBytes = 1;
    if (_Size != 0) {
      dwBytes = _Size;
    }
    do {
      if (DAT_180055c78 == (HANDLE)0x0) {
        _FF_MSGBANNER();
        _NMSG_WRITE(0x1e);
        FUN_18002680c(0xff);
      }
      pvVar2 = HeapAlloc(DAT_180055c78,0,dwBytes);
      if (pvVar2 != (LPVOID)0x0) {
        return pvVar2;
      }
      if (_DAT_1800565d8 == 0) {
        piVar3 = _errno();
        *piVar3 = 0xc;
        break;
      }
      iVar1 = _callnewh(_Size);
    } while (iVar1 != 0);
    piVar3 = _errno();
    *piVar3 = 0xc;
  }
  else {
    _callnewh(_Size);
    piVar3 = _errno();
    *piVar3 = 0xc;
    pvVar2 = (void *)0x0;
  }
  return pvVar2;
}



// Library Function - Single Match
//  __GSHandlerCheckCommon
// 
// Library: Visual Studio 2012 Release

void __GSHandlerCheckCommon(ulonglong param_1,longlong param_2,uint *param_3)

{
  longlong lVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*(byte *)param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  lVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8) + *(longlong *)(param_2 + 8);
  if ((*(byte *)(lVar1 + 3) & 0xf) != 0) {
    param_1 = param_1 + (longlong)(int)(*(byte *)(lVar1 + 3) & 0xfffffff0);
  }
  FUN_180023ef0(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180023ef0(longlong param_1)

{
  code *pcVar1;
  BOOL BVar2;
  undefined *puVar3;
  undefined auStack56 [8];
  undefined auStack48 [48];
  
  if ((param_1 == DAT_1800537e8) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
    return;
  }
  puVar3 = auStack56;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack48;
  }
  *(undefined8 *)(puVar3 + -8) = 0x180024dae;
  __crtCapturePreviousContext((CONTEXT *)&DAT_180055740);
  _DAT_1800556b0 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_1800557d8 = puVar3 + 0x40;
  _DAT_1800557c0 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_1800556a0 = 0xc0000409;
  _DAT_1800556a4 = 1;
  _DAT_1800556b8 = 1;
  DAT_1800556c0 = 2;
  *(longlong *)(puVar3 + 0x20) = DAT_1800537e8;
  *(undefined8 *)(puVar3 + 0x28) = DAT_1800537f0;
  *(undefined8 *)(puVar3 + -8) = 0x180024e50;
  DAT_180055838 = _DAT_1800556b0;
  FUN_180024d38((EXCEPTION_POINTERS *)&PTR_DAT_180047668);
  return;
}



undefined8 * FUN_180023f20(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  longlong lVar2;
  undefined4 *puVar3;
  undefined8 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined8 *puVar8;
  undefined8 *puVar9;
  undefined (*pauVar10) [16];
  undefined4 *puVar11;
  undefined (*pauVar12) [16];
  undefined8 *puVar13;
  undefined (*pauVar14) [16];
  ulonglong uVar15;
  ulonglong uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined4 uVar19;
  undefined4 uVar20;
  
  if (0x10 < param_3) {
    puVar13 = (undefined8 *)((longlong)param_2 - (longlong)param_1);
    if ((param_2 < param_1) && ((longlong)param_1 < (longlong)((longlong)param_2 + param_3))) {
      if ((DAT_180055690 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          uVar15 = (longlong)param_1 + param_3;
          if ((uVar15 & 0xf) == 0) {
            pauVar10 = (undefined (*) [16])(uVar15 - 0x10);
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
            pauVar14 = (undefined (*) [16])(param_3 - 0x10);
          }
          else {
            puVar11 = (undefined4 *)(uVar15 - 0x10);
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar11);
            uVar5 = puVar1[1];
            uVar6 = puVar1[2];
            uVar7 = puVar1[3];
            pauVar10 = (undefined (*) [16])((ulonglong)puVar11 & 0xfffffffffffffff0);
            puVar3 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
            uVar17 = *puVar3;
            uVar18 = puVar3[1];
            uVar19 = puVar3[2];
            uVar20 = puVar3[3];
            *puVar11 = *puVar1;
            *(undefined4 *)(uVar15 - 0xc) = uVar5;
            *(undefined4 *)(uVar15 - 8) = uVar6;
            *(undefined4 *)(uVar15 - 4) = uVar7;
            pauVar14 = (undefined (*) [16])((longlong)pauVar10 - (longlong)param_1);
          }
          uVar15 = (ulonglong)pauVar14 >> 7;
          if (uVar15 != 0) {
            *pauVar10 = CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            pauVar12 = pauVar10;
            while( true ) {
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)pauVar12);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x20) + (longlong)pauVar12);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              pauVar10 = pauVar12[-8];
              *(undefined4 *)pauVar12[-1] = *puVar1;
              *(undefined4 *)(pauVar12[-1] + 4) = uVar17;
              *(undefined4 *)(pauVar12[-1] + 8) = uVar18;
              *(undefined4 *)(pauVar12[-1] + 0xc) = uVar19;
              *(undefined4 *)pauVar12[-2] = uVar20;
              *(undefined4 *)(pauVar12[-2] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-2] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-2] + 0xc) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + 0x50) + (longlong)pauVar10);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x40) + (longlong)pauVar10);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              uVar15 = uVar15 - 1;
              *(undefined4 *)pauVar12[-3] = *puVar1;
              *(undefined4 *)(pauVar12[-3] + 4) = uVar17;
              *(undefined4 *)(pauVar12[-3] + 8) = uVar18;
              *(undefined4 *)(pauVar12[-3] + 0xc) = uVar19;
              *(undefined4 *)pauVar12[-4] = uVar20;
              *(undefined4 *)(pauVar12[-4] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-4] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-4] + 0xc) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + 0x30) + (longlong)pauVar10);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x20) + (longlong)pauVar10);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              *(undefined4 *)pauVar12[-5] = *puVar1;
              *(undefined4 *)(pauVar12[-5] + 4) = uVar17;
              *(undefined4 *)(pauVar12[-5] + 8) = uVar18;
              *(undefined4 *)(pauVar12[-5] + 0xc) = uVar19;
              *(undefined4 *)pauVar12[-6] = uVar20;
              *(undefined4 *)(pauVar12[-6] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-6] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-6] + 0xc) = uVar7;
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x10) + (longlong)pauVar10);
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
              uVar17 = *puVar1;
              uVar18 = puVar1[1];
              uVar19 = puVar1[2];
              uVar20 = puVar1[3];
              if (uVar15 == 0) break;
              *(undefined4 *)pauVar12[-7] = *puVar3;
              *(undefined4 *)(pauVar12[-7] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-7] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-7] + 0xc) = uVar7;
              *(undefined4 *)*pauVar10 = uVar17;
              *(undefined4 *)(pauVar12[-8] + 4) = uVar18;
              *(undefined4 *)(pauVar12[-8] + 8) = uVar19;
              *(undefined4 *)(pauVar12[-8] + 0xc) = uVar20;
              pauVar12 = pauVar10;
            }
            *(undefined4 *)pauVar12[-7] = *puVar3;
            *(undefined4 *)(pauVar12[-7] + 4) = uVar5;
            *(undefined4 *)(pauVar12[-7] + 8) = uVar6;
            *(undefined4 *)(pauVar12[-7] + 0xc) = uVar7;
            pauVar14 = (undefined (*) [16])((ulonglong)pauVar14 & 0x7f);
          }
          for (uVar15 = (ulonglong)pauVar14 >> 4; uVar15 != 0; uVar15 = uVar15 - 1) {
            *pauVar10 = CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            pauVar10 = pauVar10[-1];
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
          }
          if (((ulonglong)pauVar14 & 0xf) != 0) {
            uVar5 = *(undefined4 *)((longlong)param_2 + 4);
            uVar6 = *(undefined4 *)(param_2 + 1);
            uVar7 = *(undefined4 *)((longlong)param_2 + 0xc);
            *(undefined4 *)param_1 = *(undefined4 *)param_2;
            *(undefined4 *)((longlong)param_1 + 4) = uVar5;
            *(undefined4 *)(param_1 + 1) = uVar6;
            *(undefined4 *)((longlong)param_1 + 0xc) = uVar7;
          }
          *pauVar10 = CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
          return param_1;
        }
LAB_1800242b0:
        uVar17 = *(undefined4 *)((longlong)param_2 + 4);
        uVar18 = *(undefined4 *)(param_2 + 1);
        uVar19 = *(undefined4 *)((longlong)param_2 + 0xc);
        puVar3 = (undefined4 *)((param_3 - 0x10) + (longlong)param_1);
        puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar3);
        uVar20 = *puVar1;
        uVar5 = puVar1[1];
        uVar6 = puVar1[2];
        uVar7 = puVar1[3];
        *(undefined4 *)param_1 = *(undefined4 *)param_2;
        *(undefined4 *)((longlong)param_1 + 4) = uVar17;
        *(undefined4 *)(param_1 + 1) = uVar18;
        *(undefined4 *)((longlong)param_1 + 0xc) = uVar19;
        *puVar3 = uVar20;
        puVar3[1] = uVar5;
        puVar3[2] = uVar6;
        puVar3[3] = uVar7;
        return param_1;
      }
      puVar8 = (undefined8 *)((longlong)param_1 + param_3);
      if (((ulonglong)puVar8 & 7) != 0) {
        if (((ulonglong)puVar8 & 1) != 0) {
          puVar8 = (undefined8 *)((longlong)puVar8 + -1);
          param_3 = param_3 - 1;
          *(undefined *)puVar8 = *(undefined *)((longlong)puVar13 + (longlong)puVar8);
        }
        if (((ulonglong)puVar8 & 2) != 0) {
          puVar8 = (undefined8 *)((longlong)puVar8 + -2);
          param_3 = param_3 - 2;
          *(undefined2 *)puVar8 = *(undefined2 *)((longlong)puVar13 + (longlong)puVar8);
        }
        if (((ulonglong)puVar8 & 4) != 0) {
          puVar8 = (undefined8 *)((longlong)puVar8 + -4);
          param_3 = param_3 - 4;
          *(undefined4 *)puVar8 = *(undefined4 *)((longlong)puVar13 + (longlong)puVar8);
        }
      }
      uVar15 = param_3 >> 5;
      puVar9 = puVar8;
      if (uVar15 != 0) {
        do {
          uVar4 = *(undefined8 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar9);
          puVar8 = puVar9 + -4;
          puVar9[-1] = *(undefined8 *)((longlong)((longlong)puVar13 + -8) + (longlong)puVar9);
          puVar9[-2] = uVar4;
          uVar4 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar8);
          uVar15 = uVar15 - 1;
          puVar9[-3] = *(undefined8 *)((longlong)((longlong)puVar13 + 8) + (longlong)puVar8);
          *puVar8 = uVar4;
          puVar9 = puVar8;
        } while (uVar15 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar15 = param_3 >> 3;
      if (uVar15 != 0) {
        do {
          puVar8 = puVar8 + -1;
          uVar15 = uVar15 - 1;
          *puVar8 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar8);
        } while (uVar15 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_1 = (undefined8 *)((longlong)puVar8 - param_3);
      param_2 = (undefined8 *)((longlong)puVar13 + (longlong)param_1);
    }
    else {
      puVar8 = param_1;
      if ((DAT_180055690 >> 1 & 1) != 0) {
        for (; param_3 != 0; param_3 = param_3 - 1) {
          *(undefined *)puVar8 = *(undefined *)param_2;
          param_2 = (undefined8 *)((longlong)param_2 + 1);
          puVar8 = (undefined8 *)((longlong)puVar8 + 1);
        }
        return param_1;
      }
      if ((DAT_180055690 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          if (((ulonglong)param_1 & 0xf) == 0) {
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)param_1);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
            puVar8 = param_1 + 2;
            uVar15 = param_3 - 0x10;
          }
          else {
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)param_1);
            uVar5 = puVar1[1];
            uVar6 = puVar1[2];
            uVar7 = puVar1[3];
            puVar8 = (undefined8 *)((ulonglong)(param_1 + 4) & 0xfffffffffffffff0);
            puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar8);
            uVar17 = *puVar3;
            uVar18 = puVar3[1];
            uVar19 = puVar3[2];
            uVar20 = puVar3[3];
            *(undefined4 *)param_1 = *puVar1;
            *(undefined4 *)((longlong)param_1 + 4) = uVar5;
            *(undefined4 *)(param_1 + 1) = uVar6;
            *(undefined4 *)((longlong)param_1 + 0xc) = uVar7;
            uVar15 = param_3 - (longlong)((longlong)puVar8 - (longlong)param_1);
          }
          uVar16 = uVar15 >> 7;
          if (uVar16 != 0) {
            *(undefined (*) [16])(puVar8 + -2) =
                 CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            puVar9 = puVar8;
            while( true ) {
              puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar9);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x10) + (longlong)puVar9);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              puVar8 = puVar9 + 0x10;
              *(undefined4 *)puVar9 = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 4) = uVar17;
              *(undefined4 *)(puVar9 + 1) = uVar18;
              *(undefined4 *)((longlong)puVar9 + 0xc) = uVar19;
              *(undefined4 *)(puVar9 + 2) = uVar20;
              *(undefined4 *)((longlong)puVar9 + 0x14) = uVar5;
              *(undefined4 *)(puVar9 + 3) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x1c) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x60) + (longlong)puVar8);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x50) + (longlong)puVar8);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              uVar16 = uVar16 - 1;
              *(undefined4 *)(puVar9 + 4) = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 0x24) = uVar17;
              *(undefined4 *)(puVar9 + 5) = uVar18;
              *(undefined4 *)((longlong)puVar9 + 0x2c) = uVar19;
              *(undefined4 *)(puVar9 + 6) = uVar20;
              *(undefined4 *)((longlong)puVar9 + 0x34) = uVar5;
              *(undefined4 *)(puVar9 + 7) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x3c) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x40) + (longlong)puVar8);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x30) + (longlong)puVar8);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              *(undefined4 *)(puVar9 + 8) = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 0x44) = uVar17;
              *(undefined4 *)(puVar9 + 9) = uVar18;
              *(undefined4 *)((longlong)puVar9 + 0x4c) = uVar19;
              *(undefined4 *)(puVar9 + 10) = uVar20;
              *(undefined4 *)((longlong)puVar9 + 0x54) = uVar5;
              *(undefined4 *)(puVar9 + 0xb) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x5c) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x20) + (longlong)puVar8);
              uVar5 = puVar1[1];
              uVar6 = puVar1[2];
              uVar7 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar8);
              uVar17 = *puVar3;
              uVar18 = puVar3[1];
              uVar19 = puVar3[2];
              uVar20 = puVar3[3];
              if (uVar16 == 0) break;
              *(undefined4 *)(puVar9 + 0xc) = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 100) = uVar5;
              *(undefined4 *)(puVar9 + 0xd) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x6c) = uVar7;
              *(undefined4 *)(puVar9 + 0xe) = uVar17;
              *(undefined4 *)((longlong)puVar9 + 0x74) = uVar18;
              *(undefined4 *)(puVar9 + 0xf) = uVar19;
              *(undefined4 *)((longlong)puVar9 + 0x7c) = uVar20;
              puVar9 = puVar8;
            }
            *(undefined4 *)(puVar9 + 0xc) = *puVar1;
            *(undefined4 *)((longlong)puVar9 + 100) = uVar5;
            *(undefined4 *)(puVar9 + 0xd) = uVar6;
            *(undefined4 *)((longlong)puVar9 + 0x6c) = uVar7;
            uVar15 = uVar15 & 0x7f;
          }
          for (uVar16 = uVar15 >> 4; uVar16 != 0; uVar16 = uVar16 - 1) {
            *(undefined (*) [16])(puVar8 + -2) =
                 CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar8);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
            puVar8 = puVar8 + 2;
          }
          if ((uVar15 & 0xf) != 0) {
            lVar2 = (uVar15 & 0xf) + (longlong)puVar8;
            puVar1 = (undefined4 *)((longlong)puVar13 + lVar2 + -0x10);
            uVar5 = puVar1[1];
            uVar6 = puVar1[2];
            uVar7 = puVar1[3];
            *(undefined4 *)(lVar2 + -0x10) = *puVar1;
            *(undefined4 *)(lVar2 + -0xc) = uVar5;
            *(undefined4 *)(lVar2 + -8) = uVar6;
            *(undefined4 *)(lVar2 + -4) = uVar7;
          }
          *(undefined (*) [16])(puVar8 + -2) =
               CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
          return param_1;
        }
        goto LAB_1800242b0;
      }
      if (((ulonglong)param_1 & 7) != 0) {
        if (((ulonglong)param_1 & 1) != 0) {
          param_3 = param_3 - 1;
          *(undefined *)param_1 = *(undefined *)((longlong)puVar13 + (longlong)param_1);
          puVar8 = (undefined8 *)((longlong)param_1 + 1);
        }
        if (((ulonglong)puVar8 & 2) != 0) {
          param_3 = param_3 - 2;
          *(undefined2 *)puVar8 = *(undefined2 *)((longlong)puVar13 + (longlong)puVar8);
          puVar8 = (undefined8 *)((longlong)puVar8 + 2);
        }
        if (((ulonglong)puVar8 & 4) != 0) {
          param_3 = param_3 - 4;
          *(undefined4 *)puVar8 = *(undefined4 *)((longlong)puVar13 + (longlong)puVar8);
          puVar8 = (undefined8 *)((longlong)puVar8 + 4);
        }
      }
      uVar15 = param_3 >> 5;
      puVar9 = puVar8;
      if (uVar15 != 0) {
        do {
          uVar4 = *(undefined8 *)((longlong)((longlong)puVar13 + 8) + (longlong)puVar9);
          puVar8 = puVar9 + 4;
          *puVar9 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar9);
          puVar9[1] = uVar4;
          uVar4 = *(undefined8 *)((longlong)((longlong)puVar13 + -8) + (longlong)puVar8);
          uVar15 = uVar15 - 1;
          puVar9[2] = *(undefined8 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar8);
          puVar9[3] = uVar4;
          puVar9 = puVar8;
        } while (uVar15 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar15 = param_3 >> 3;
      if (uVar15 != 0) {
        do {
          *puVar8 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar8);
          puVar8 = puVar8 + 1;
          uVar15 = uVar15 - 1;
        } while (uVar15 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_2 = (undefined8 *)((longlong)puVar13 + (longlong)puVar8);
      param_1 = puVar8;
    }
  }
                    // WARNING: Could not recover jumptable at 0x000180023ffe. Too many branches
                    // WARNING: Treating indirect jump as call
  puVar13 = (undefined8 *)
            (*(code *)((ulonglong)*(uint *)(&DAT_180024000 + param_3 * 4) + 0x180000000))
                      (param_1,param_2);
  return puVar13;
}



undefined (*) [16] FUN_1800244a0(undefined (*param_1) [16],byte param_2,ulonglong param_3)

{
  uint uVar1;
  undefined (*pauVar2) [16];
  undefined (*pauVar3) [16];
  undefined *puVar4;
  undefined2 uVar5;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined auVar11 [12];
  undefined4 uVar6;
  undefined auVar12 [13];
  undefined auVar13 [16];
  undefined uVar14;
  
  if (0xf < param_3) {
    pauVar2 = param_1;
    if ((DAT_180055690 >> 1 & 1) == 0) {
      uVar7 = (ulonglong)param_2 * 0x101010101010101;
      if ((DAT_180055690 >> 2 & 1) != 0) {
        uVar14 = SUB141(ZEXT814(uVar7) >> 0x30,0);
        auVar12 = ZEXT813(uVar7);
        auVar11 = ZEXT812(uVar7);
        auVar13 = CONCAT142(SUB1614(CONCAT133(SUB1613(CONCAT124(SUB1612(CONCAT115(SUB1611(CONCAT106(
                                                  SUB1610(CONCAT97(SUB169(CONCAT88(SUB168(CONCAT79(
                                                  SUB167(CONCAT610(SUB166(CONCAT511(SUB165(CONCAT412
                                                  (SUB164(CONCAT313(SUB163(CONCAT214(SUB162(
                                                  CONCAT115(SUB161(ZEXT816(uVar7) >> 0x38,0),
                                                            CONCAT114(SUB151(ZEXT815(uVar7) >> 0x38,
                                                                             0),ZEXT814(uVar7))) >>
                                                  0x70,0),CONCAT113(uVar14,auVar12)) >> 0x68,0),
                                                  CONCAT112(uVar14,auVar11)) >> 0x60,0),
                                                  CONCAT111(SUB131(auVar12 >> 0x28,0),ZEXT811(uVar7)
                                                           )) >> 0x58,0),
                                                  CONCAT110(SUB121(auVar11 >> 0x28,0),
                                                            (unkuint10)uVar7)) >> 0x50,0),
                                                  CONCAT19(SUB131(auVar12 >> 0x20,0),(unkuint9)uVar7
                                                          )) >> 0x48,0),
                                                  CONCAT18(SUB121(auVar11 >> 0x20,0),uVar7)) >> 0x40
                                                  ,0),(uVar7 >> 0x18) << 0x38) >> 0x38,0),
                                                  ((uint7)uVar7 >> 0x18) << 0x30) >> 0x30,0),
                                                  ((uint6)uVar7 >> 0x10) << 0x28) >> 0x28,0),
                                                  ((uint5)uVar7 >> 0x10) << 0x20) >> 0x20,0),
                                                  ((uint)uVar7 >> 8) << 0x18) >> 0x18,0),
                                              ((uint3)uVar7 >> 8) << 0x10) >> 0x10,0),
                            (ushort)uVar7 & 0xff | (ushort)uVar7 << 8);
        if (((ulonglong)param_1 & 0xf) != 0) {
          *param_1 = auVar13;
          pauVar2 = (undefined (*) [16])((longlong)param_1 + (0x10 - ((ulonglong)param_1 & 0xf)));
          param_3 = (((ulonglong)param_1 & 0xf) - 0x10) + param_3;
        }
        uVar7 = param_3 >> 7;
        pauVar3 = pauVar2;
        if (uVar7 != 0) {
          do {
            *pauVar2 = auVar13;
            pauVar2[1] = auVar13;
            pauVar3 = pauVar2[8];
            pauVar2[2] = auVar13;
            pauVar2[3] = auVar13;
            uVar7 = uVar7 - 1;
            pauVar2[4] = auVar13;
            pauVar2[5] = auVar13;
            pauVar2[6] = auVar13;
            pauVar2[7] = auVar13;
            pauVar2 = pauVar3;
          } while (uVar7 != 0);
          param_3 = param_3 & 0x7f;
        }
        for (uVar7 = param_3 >> 4; uVar7 != 0; uVar7 = uVar7 - 1) {
          *pauVar3 = auVar13;
          pauVar3 = pauVar3[1];
        }
        if ((param_3 & 0xf) != 0) {
          *(undefined (*) [16])(pauVar3[-1] + (param_3 & 0xf)) = auVar13;
        }
        return param_1;
      }
      if (0x3f < param_3) {
        uVar1 = -(int)param_1 & 7;
        uVar9 = param_3;
        if (uVar1 != 0) {
          uVar9 = param_3 - uVar1;
          *(ulonglong *)*param_1 = uVar7;
        }
        param_3 = uVar9 & 0x3f;
        pauVar2 = (undefined (*) [16])(*param_1 + uVar1);
        for (uVar9 = uVar9 >> 6; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(ulonglong *)*pauVar2 = uVar7;
          *(ulonglong *)(*pauVar2 + 8) = uVar7;
          *(ulonglong *)pauVar2[1] = uVar7;
          *(ulonglong *)(pauVar2[1] + 8) = uVar7;
          *(ulonglong *)pauVar2[2] = uVar7;
          *(ulonglong *)(pauVar2[2] + 8) = uVar7;
          *(ulonglong *)pauVar2[3] = uVar7;
          *(ulonglong *)(pauVar2[3] + 8) = uVar7;
          pauVar2 = pauVar2[4];
        }
      }
      uVar10 = param_3 & 7;
      for (uVar9 = param_3 >> 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(ulonglong *)*pauVar2 = uVar7;
        pauVar2 = (undefined (*) [16])(*pauVar2 + 8);
      }
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        (*pauVar2)[0] = (char)uVar7;
        pauVar2 = (undefined (*) [16])(*pauVar2 + 1);
      }
    }
    else {
      for (; param_3 != 0; param_3 = param_3 - 1) {
        (*pauVar2)[0] = param_2;
        pauVar2 = (undefined (*) [16])(*pauVar2 + 1);
      }
    }
    return param_1;
  }
  lVar8 = (ulonglong)param_2 * 0x101010101010101;
  puVar4 = *param_1 + param_3;
  uVar14 = (undefined)lVar8;
  uVar5 = (undefined2)lVar8;
  uVar6 = (undefined4)lVar8;
  switch(param_3) {
  case 0:
    return param_1;
  case 1:
    goto switchD_180024632_caseD_1;
  case 8:
    *(longlong *)(puVar4 + -8) = lVar8;
    return param_1;
  case 9:
    *(longlong *)(puVar4 + -9) = lVar8;
    puVar4[-1] = uVar14;
    return param_1;
  case 10:
    *(longlong *)(puVar4 + -10) = lVar8;
    *(undefined2 *)(puVar4 + -2) = uVar5;
    return param_1;
  case 0xb:
    *(longlong *)(puVar4 + -0xb) = lVar8;
    break;
  case 0xc:
    *(longlong *)(puVar4 + -0xc) = lVar8;
  case 4:
    *(undefined4 *)(puVar4 + -4) = uVar6;
    return param_1;
  case 0xd:
    *(longlong *)(puVar4 + -0xd) = lVar8;
  case 5:
    *(undefined4 *)(puVar4 + -5) = uVar6;
    puVar4[-1] = uVar14;
    return param_1;
  case 0xe:
    *(longlong *)(puVar4 + -0xe) = lVar8;
  case 6:
    *(undefined4 *)(puVar4 + -6) = uVar6;
  case 2:
    *(undefined2 *)(puVar4 + -2) = uVar5;
    return param_1;
  case 0xf:
    *(longlong *)(puVar4 + -0xf) = lVar8;
  case 7:
    *(undefined4 *)(puVar4 + -7) = uVar6;
  }
  *(undefined2 *)(puVar4 + -3) = uVar5;
switchD_180024632_caseD_1:
  puVar4[-1] = uVar14;
  return param_1;
}



// Library Function - Single Match
//  calloc
// 
// Library: Visual Studio 2012 Release

void * calloc(size_t _Count,size_t _Size)

{
  LPVOID pvVar1;
  int *piVar2;
  int local_res18 [4];
  
  local_res18[0] = 0;
  pvVar1 = _calloc_impl(_Count,_Size,local_res18);
  if ((pvVar1 == (LPVOID)0x0) && (local_res18[0] != 0)) {
    piVar2 = _errno();
    if (piVar2 != (int *)0x0) {
      piVar2 = _errno();
      *piVar2 = local_res18[0];
    }
  }
  return pvVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  realloc
// 
// Library: Visual Studio 2012 Release

void * realloc(void *_Memory,size_t _NewSize)

{
  int iVar1;
  DWORD DVar2;
  void *pvVar3;
  LPVOID pvVar4;
  int *piVar5;
  
  if (_Memory == (void *)0x0) {
    pvVar3 = malloc(_NewSize);
  }
  else {
    if (_NewSize == 0) {
      free(_Memory);
    }
    else {
      if (_NewSize < 0xffffffffffffffe1) {
        do {
          if (_NewSize == 0) {
            _NewSize = 1;
          }
          pvVar4 = HeapReAlloc(DAT_180055c78,0,_Memory,_NewSize);
          if (pvVar4 != (LPVOID)0x0) {
            return pvVar4;
          }
          if (_DAT_1800565d8 == 0) {
            piVar5 = _errno();
            DVar2 = GetLastError();
            iVar1 = _get_errno_from_oserr(DVar2);
            *piVar5 = iVar1;
            return (void *)0x0;
          }
          iVar1 = _callnewh(_NewSize);
          if (iVar1 == 0) {
            piVar5 = _errno();
            DVar2 = GetLastError();
            iVar1 = _get_errno_from_oserr(DVar2);
            *piVar5 = iVar1;
            goto LAB_180024940;
          }
        } while (_NewSize < 0xffffffffffffffe1);
      }
      _callnewh(_NewSize);
      piVar5 = _errno();
      *piVar5 = 0xc;
    }
LAB_180024940:
    pvVar3 = (void *)0x0;
  }
  return pvVar3;
}



void free(void *_Memory)

{
  free(_Memory);
  return;
}



undefined ** FUN_180024990(undefined **param_1,exception *param_2)

{
  std::exception::exception((exception *)param_1,param_2);
  *param_1 = (undefined *)std::bad_alloc::vftable;
  return param_1;
}



// Library Function - Single Match
//  void * __ptr64 __cdecl operator new(unsigned __int64)
// 
// Library: Visual Studio 2012 Release

void * operator_new(unsigned___int64 param_1)

{
  code *pcVar1;
  int iVar2;
  void *pvVar3;
  undefined4 in_register_0000000c;
  char *local_res10 [3];
  undefined **local_28 [4];
  
  do {
    pvVar3 = malloc(CONCAT44(in_register_0000000c,param_1));
    if (pvVar3 != (void *)0x0) {
      return pvVar3;
    }
    iVar2 = _callnewh(CONCAT44(in_register_0000000c,param_1));
  } while (iVar2 != 0);
  local_res10[0] = "bad allocation";
  std::exception::exception((exception *)local_28,local_res10,1);
  local_28[0] = std::bad_alloc::vftable;
  FUN_1800251e8((longlong *)local_28,&DAT_1800511b0);
  pcVar1 = (code *)swi(3);
  pvVar3 = (void *)(*pcVar1)();
  return pvVar3;
}



undefined ** FUN_180024a30(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)std::bad_alloc::vftable;
  FUN_180028550(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  __onexitinit
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

undefined4 __onexitinit(void)

{
  undefined4 uVar1;
  undefined8 *Ptr;
  
  Ptr = (undefined8 *)FUN_180027c68(0x20,8);
  DAT_180057bb8 = EncodePointer(Ptr);
  DAT_180057bc0 = DAT_180057bb8;
  if (Ptr == (undefined8 *)0x0) {
    uVar1 = 0x18;
  }
  else {
    *Ptr = 0;
    uVar1 = 0;
  }
  return uVar1;
}



// Library Function - Single Match
//  _onexit
// 
// Library: Visual Studio 2012 Release

_onexit_t _onexit(_onexit_t _Func)

{
  PVOID *_Memory;
  PVOID *ppvVar1;
  PVOID *ppvVar2;
  PVOID pvVar3;
  PVOID *ppvVar4;
  _onexit_t p_Var5;
  
  FUN_180026b30();
  _Memory = (PVOID *)DecodePointer(DAT_180057bc0);
  ppvVar1 = (PVOID *)DecodePointer(DAT_180057bb8);
  if (_Memory <= ppvVar1) {
    ppvVar4 = (PVOID *)((longlong)ppvVar1 - (longlong)_Memory) + 1;
    if ((PVOID *)0x7 < ppvVar4) {
      ppvVar2 = (PVOID *)_msize(_Memory);
      if (ppvVar2 < ppvVar4) {
        ppvVar4 = (PVOID *)0x1000;
        if (ppvVar2 < (PVOID *)0x1000) {
          ppvVar4 = ppvVar2;
        }
        if (((PVOID *)((longlong)ppvVar4 + (longlong)ppvVar2) < ppvVar2) ||
           (pvVar3 = FUN_180027d64(_Memory,(size_t)(PVOID *)((longlong)ppvVar4 + (longlong)ppvVar2))
           , pvVar3 == (void *)0x0)) {
          p_Var5 = (_onexit_t)0x0;
          if ((ppvVar2 + 4 < ppvVar2) ||
             (pvVar3 = FUN_180027d64(_Memory,(size_t)(ppvVar2 + 4)), pvVar3 == (void *)0x0))
          goto LAB_180024b98;
        }
        ppvVar1 = (PVOID *)((longlong)pvVar3 +
                           ((longlong)(PVOID *)((longlong)ppvVar1 - (longlong)_Memory) >> 3) * 8);
        DAT_180057bc0 = EncodePointer(pvVar3);
      }
      pvVar3 = EncodePointer(_Func);
      *ppvVar1 = pvVar3;
      DAT_180057bb8 = EncodePointer(ppvVar1 + 1);
      p_Var5 = _Func;
      goto LAB_180024b98;
    }
  }
  p_Var5 = (_onexit_t)0x0;
LAB_180024b98:
  FUN_180026b3c();
  return p_Var5;
}



// Library Function - Single Match
//  atexit
// 
// Library: Visual Studio 2012 Release

int atexit(void *param_1)

{
  _onexit_t p_Var1;
  
  p_Var1 = _onexit((_onexit_t)param_1);
  return (int)((p_Var1 != (_onexit_t)0x0) - 1);
}



// Library Function - Single Match
//  wcschr
// 
// Library: Visual Studio 2012 Release

wchar_t * wcschr(wchar_t *_Str,wchar_t _Ch)

{
  uint uVar1;
  uint uVar2;
  wchar_t *pwVar3;
  undefined in_XMM1 [16];
  undefined auVar4 [16];
  wchar_t wVar5;
  wchar_t wVar6;
  
  auVar4 = pshuflw(in_XMM1,ZEXT216((ushort)_Ch),0);
  while( true ) {
    for (; uVar2 = (uint)_Str & 0xfff, uVar2 < 0xff1; _Str = _Str + 8) {
      wVar5 = SUB162(auVar4,0);
      wVar6 = SUB162(auVar4 >> 0x10,0);
      uVar2 = pmovmskb(uVar2,CONCAT214(-(ushort)(_Str[7] == L'\0'),
                                       CONCAT212(-(ushort)(_Str[6] == L'\0'),
                                                 CONCAT210(-(ushort)(_Str[5] == L'\0'),
                                                           CONCAT28(-(ushort)(_Str[4] == L'\0'),
                                                                    CONCAT26(-(ushort)(_Str[3] ==
                                                                                      L'\0'),
                                                                             CONCAT24(-(ushort)(_Str
                                                  [2] == L'\0'),
                                                  CONCAT22(-(ushort)(_Str[1] == L'\0'),
                                                           -(ushort)(*_Str == L'\0')))))))) |
                             CONCAT214(-(ushort)(_Str[7] == wVar6),
                                       CONCAT212(-(ushort)(_Str[6] == wVar5),
                                                 CONCAT210(-(ushort)(_Str[5] == wVar6),
                                                           CONCAT28(-(ushort)(_Str[4] == wVar5),
                                                                    CONCAT26(-(ushort)(_Str[3] ==
                                                                                      wVar6),
                                                                             CONCAT24(-(ushort)(_Str
                                                  [2] == wVar5),
                                                  CONCAT22(-(ushort)(_Str[1] == wVar6),
                                                           -(ushort)(*_Str == wVar5)))))))));
      if (uVar2 != 0) {
        uVar1 = 0;
        if (uVar2 != 0) {
          for (; (uVar2 >> uVar1 & 1) == 0; uVar1 = uVar1 + 1) {
          }
        }
        pwVar3 = (wchar_t *)0x0;
        if (*(wchar_t *)((longlong)_Str + (ulonglong)uVar1) == _Ch) {
          pwVar3 = (wchar_t *)((longlong)_Str + (ulonglong)uVar1);
        }
        return pwVar3;
      }
    }
    if (*_Str == _Ch) break;
    if (*_Str == L'\0') {
      return (wchar_t *)0x0;
    }
    _Str = _Str + 1;
  }
  return _Str;
}



// Library Function - Single Match
//  memcmp
// 
// Library: Visual Studio

int memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
  uint uVar1;
  ulonglong uVar2;
  void *pvVar3;
  ulonglong uVar4;
  bool bVar5;
  
  pvVar3 = (void *)((longlong)_Buf2 - (longlong)_Buf1);
  if (7 < _Size) {
    uVar4 = (ulonglong)_Buf1 & 7;
    while (uVar4 != 0) {
                    // WARNING: Load size is inaccurate
      bVar5 = *_Buf1 < *(byte *)((longlong)pvVar3 + (longlong)_Buf1);
      if (*_Buf1 != *(byte *)((longlong)pvVar3 + (longlong)_Buf1)) goto LAB_180024cb3;
      _Buf1 = (void *)((longlong)_Buf1 + 1);
      _Size = _Size - 1;
      uVar4 = (ulonglong)_Buf1 & 7;
    }
    if (_Size >> 3 != 0) {
      uVar4 = _Size >> 5;
      if (uVar4 != 0) {
        do {
                    // WARNING: Load size is inaccurate
          uVar2 = *_Buf1;
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + (longlong)_Buf1)) goto LAB_180024d24;
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 8);
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + 8 + (longlong)_Buf1)) {
LAB_180024d20:
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_180024d24;
          }
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 0x10);
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + 0x10 + (longlong)_Buf1)) {
LAB_180024d1c:
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_180024d20;
          }
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 0x18);
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + 0x18 + (longlong)_Buf1)) {
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_180024d1c;
          }
          _Buf1 = (void *)((longlong)_Buf1 + 0x20);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        _Size = _Size & 0x1f;
      }
      uVar4 = _Size >> 3;
      if (uVar4 != 0) {
        do {
                    // WARNING: Load size is inaccurate
          uVar2 = *_Buf1;
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + (longlong)_Buf1)) {
LAB_180024d24:
            uVar4 = *(ulonglong *)((longlong)_Buf1 + (longlong)pvVar3);
            uVar1 = (uint)((uVar2 >> 0x38 | (uVar2 & 0xff000000000000) >> 0x28 |
                            (uVar2 & 0xff0000000000) >> 0x18 | (uVar2 & 0xff00000000) >> 8 |
                            (uVar2 & 0xff000000) << 8 | (uVar2 & 0xff0000) << 0x18 |
                            (uVar2 & 0xff00) << 0x28 | uVar2 << 0x38) <
                          (uVar4 >> 0x38 | (uVar4 & 0xff000000000000) >> 0x28 |
                           (uVar4 & 0xff0000000000) >> 0x18 | (uVar4 & 0xff00000000) >> 8 |
                           (uVar4 & 0xff000000) << 8 | (uVar4 & 0xff0000) << 0x18 |
                           (uVar4 & 0xff00) << 0x28 | uVar4 << 0x38));
            return (int)((1 - uVar1) - (uint)(uVar1 != 0));
          }
          _Buf1 = (void *)((longlong)_Buf1 + 8);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        _Size = _Size & 7;
      }
    }
  }
  while( true ) {
    if (_Size == 0) {
      return 0;
    }
                    // WARNING: Load size is inaccurate
    bVar5 = *_Buf1 < *(byte *)((longlong)pvVar3 + (longlong)_Buf1);
    if (*_Buf1 != *(byte *)((longlong)pvVar3 + (longlong)_Buf1)) break;
    _Buf1 = (void *)((longlong)_Buf1 + 1);
    _Size = _Size - 1;
  }
LAB_180024cb3:
  return (int)((1 - (uint)bVar5) - (uint)(bVar5 != 0));
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180024d38(EXCEPTION_POINTERS *param_1)

{
  HANDLE hProcess;
  
  _DAT_180055c10 = IsDebuggerPresent();
  FUN_1800286b4();
  __crtUnhandledException(param_1);
  if (_DAT_180055c10 == 0) {
    FUN_1800286b4();
  }
  hProcess = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180027c40. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(hProcess,0xc0000409);
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  __chkstk
// 
// Libraries: Visual Studio 2005, Visual Studio 2008, Visual Studio 2010, Visual Studio 2012

void __chkstk(void)

{
  undefined *in_RAX;
  undefined *puVar1;
  undefined *puVar2;
  longlong in_GS_OFFSET;
  undefined local_res8 [32];
  
  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined *)0x0;
  }
  puVar2 = *(undefined **)(in_GS_OFFSET + 0x10);
  if (puVar1 < puVar2) {
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



// Library Function - Single Match
//  sqrt
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

double sqrt(double _X)

{
  ulonglong uVar1;
  double dVar2;
  uint uVar3;
  undefined4 in_stack_ffffffffffffffd4;
  
  if (((ulonglong)_X & 0x7ff0000000000000) == 0x7ff0000000000000) {
    if (((ulonglong)_X & 0xfffffffffffff) == 0) {
      uVar1 = (ulonglong)_X & 0x8000000000000000;
LAB_180024f57:
      if (uVar1 == 0) goto LAB_180024fa9;
      uVar3 = 8;
      uVar1 = 0xfff8000000000000;
    }
    else {
      uVar1 = (ulonglong)_X | 0x8000000000000;
      uVar3 = 0;
    }
    dVar2 = (double)_handle_error(&DAT_180047678,5,uVar1,1,uVar3,
                                  CONCAT44(in_stack_ffffffffffffffd4,0x21),_X,0,1);
  }
  else {
    if (((ulonglong)_X & 0x8000000000000000) != 0) {
      uVar1 = (ulonglong)_X & 0x7fffffffffffffff;
      goto LAB_180024f57;
    }
LAB_180024fa9:
    dVar2 = SQRT(_X);
  }
  return dVar2;
}



void thunk_FUN_180024fc8(void)

{
  PTR_LAB_1800539e0 = &LAB_180028908;
  PTR_LAB_1800539e8 = &LAB_1800293bc;
  PTR_LAB_1800539f0 = &DAT_18002945c;
  PTR_LAB_1800539f8 = &LAB_1800294a4;
  PTR_LAB_180053a00 = &LAB_18002952c;
  PTR_LAB_180053a08 = &LAB_180028908;
  PTR_LAB_180053a10 = _cfltcvt_l;
  PTR_LAB_180053a18 = &LAB_180029464;
  PTR_LAB_180053a20 = _cropzeros_l;
  PTR_LAB_180053a28 = _forcdecpt_l;
  return;
}



void FUN_180024fc8(void)

{
  PTR_LAB_1800539e0 = &LAB_180028908;
  PTR_LAB_1800539e8 = &LAB_1800293bc;
  PTR_LAB_1800539f0 = &DAT_18002945c;
  PTR_LAB_1800539f8 = &LAB_1800294a4;
  PTR_LAB_180053a00 = &LAB_18002952c;
  PTR_LAB_180053a08 = &LAB_180028908;
  PTR_LAB_180053a10 = _cfltcvt_l;
  PTR_LAB_180053a18 = &LAB_180029464;
  PTR_LAB_180053a20 = _cropzeros_l;
  PTR_LAB_180053a28 = _forcdecpt_l;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  strrchr
// 
// Library: Visual Studio 2012 Release

char * strrchr(char *_Str,int _Ch)

{
  ulonglong uVar1;
  undefined4 in_EAX;
  uint uVar2;
  undefined (*pauVar3) [16];
  uint uVar4;
  int iVar5;
  char *pcVar6;
  uint uVar7;
  char *pcVar8;
  bool bVar9;
  bool bVar10;
  char cVar11;
  char cVar12;
  char cVar13;
  char cVar14;
  undefined in_XMM1 [16];
  undefined auVar15 [16];
  
  pauVar3 = (undefined (*) [16])0x0;
  if (_Ch == 0) {
    auVar15 = in_XMM1 & (undefined  [16])0x0;
    pcVar6 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
    cVar11 = SUB161(auVar15 >> 0x40,0);
    cVar12 = SUB161(auVar15 >> 0x48,0);
    cVar13 = SUB161(auVar15 >> 0x50,0);
    cVar14 = SUB161(auVar15 >> 0x58,0);
    uVar2 = pmovmskb(in_EAX,CONCAT115(-(pcVar6[0xf] == '\0'),
                                      CONCAT114(-(pcVar6[0xe] == '\0'),
                                                CONCAT113(-(pcVar6[0xd] == '\0'),
                                                          CONCAT112(-(pcVar6[0xc] == '\0'),
                                                                    CONCAT111(-(pcVar6[0xb] ==
                                                                               cVar14),CONCAT110(-(
                                                  pcVar6[10] == cVar13),
                                                  CONCAT19(-(pcVar6[9] == cVar12),
                                                           CONCAT18(-(pcVar6[8] == cVar11),
                                                                    CONCAT17(-(pcVar6[7] == '\0'),
                                                                             CONCAT16(-(pcVar6[6] ==
                                                                                       '\0'),
                                                  CONCAT15(-(pcVar6[5] == '\0'),
                                                           CONCAT14(-(pcVar6[4] == '\0'),
                                                                    CONCAT13(-(pcVar6[3] == '\0'),
                                                                             CONCAT12(-(pcVar6[2] ==
                                                                                       '\0'),
                                                  CONCAT11(-(pcVar6[1] == '\0'),-(*pcVar6 == '\0')))
                                                  ))))))))))))));
    uVar2 = uVar2 & -1 << ((byte)_Str & 0xf);
    while (uVar2 == 0) {
      uVar2 = pmovmskb(0,CONCAT115(-(pcVar6[0x1f] == '\0'),
                                   CONCAT114(-(pcVar6[0x1e] == '\0'),
                                             CONCAT113(-(pcVar6[0x1d] == '\0'),
                                                       CONCAT112(-(pcVar6[0x1c] == '\0'),
                                                                 CONCAT111(-(pcVar6[0x1b] == cVar14)
                                                                           ,CONCAT110(-(pcVar6[0x1a]
                                                                                       == cVar13),
                                                                                      CONCAT19(-(
                                                  pcVar6[0x19] == cVar12),
                                                  CONCAT18(-(pcVar6[0x18] == cVar11),
                                                           CONCAT17(-(pcVar6[0x17] == '\0'),
                                                                    CONCAT16(-(pcVar6[0x16] == '\0')
                                                                             ,CONCAT15(-(pcVar6[0x15
                                                  ] == '\0'),
                                                  CONCAT14(-(pcVar6[0x14] == '\0'),
                                                           CONCAT13(-(pcVar6[0x13] == '\0'),
                                                                    CONCAT12(-(pcVar6[0x12] == '\0')
                                                                             ,CONCAT11(-(pcVar6[0x11
                                                  ] == '\0'),-(pcVar6[0x10] == '\0')))))))))))))))))
      ;
      pcVar6 = pcVar6 + 0x10;
    }
    uVar4 = 0;
    if (uVar2 != 0) {
      for (; (uVar2 >> uVar4 & 1) == 0; uVar4 = uVar4 + 1) {
      }
    }
    pauVar3 = (undefined (*) [16])(pcVar6 + uVar4);
  }
  else {
    if (_DAT_1800537e0 < 2) {
      uVar2 = (uint)_Str & 0xf;
      pcVar6 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
      uVar7 = -1 << (sbyte)uVar2;
      auVar15 = pshuflw(in_XMM1,ZEXT416((_Ch & 0xffU) << 8 | _Ch & 0xffU),0);
      uVar4 = pmovmskb(uVar2,CONCAT115(-(pcVar6[0xf] == '\0'),
                                       CONCAT114(-(pcVar6[0xe] == '\0'),
                                                 CONCAT113(-(pcVar6[0xd] == '\0'),
                                                           CONCAT112(-(pcVar6[0xc] == '\0'),
                                                                     CONCAT111(-(pcVar6[0xb] == '\0'
                                                                                ),CONCAT110(-(pcVar6
                                                  [10] == '\0'),
                                                  CONCAT19(-(pcVar6[9] == '\0'),
                                                           CONCAT18(-(pcVar6[8] == '\0'),
                                                                    CONCAT17(-(pcVar6[7] == '\0'),
                                                                             CONCAT16(-(pcVar6[6] ==
                                                                                       '\0'),
                                                  CONCAT15(-(pcVar6[5] == '\0'),
                                                           CONCAT14(-(pcVar6[4] == '\0'),
                                                                    CONCAT13(-(pcVar6[3] == '\0'),
                                                                             CONCAT12(-(pcVar6[2] ==
                                                                                       '\0'),
                                                  CONCAT11(-(pcVar6[1] == '\0'),-(*pcVar6 == '\0')))
                                                  ))))))))))))));
      cVar11 = SUB161(auVar15,0);
      cVar12 = SUB161(auVar15 >> 8,0);
      cVar13 = SUB161(auVar15 >> 0x10,0);
      cVar14 = SUB161(auVar15 >> 0x18,0);
      uVar2 = pmovmskb(_Ch,CONCAT115(-(cVar14 == pcVar6[0xf]),
                                     CONCAT114(-(cVar13 == pcVar6[0xe]),
                                               CONCAT113(-(cVar12 == pcVar6[0xd]),
                                                         CONCAT112(-(cVar11 == pcVar6[0xc]),
                                                                   CONCAT111(-(cVar14 == pcVar6[0xb]
                                                                              ),CONCAT110(-(cVar13 
                                                  == pcVar6[10]),
                                                  CONCAT19(-(cVar12 == pcVar6[9]),
                                                           CONCAT18(-(cVar11 == pcVar6[8]),
                                                                    CONCAT17(-(cVar14 == pcVar6[7]),
                                                                             CONCAT16(-(cVar13 ==
                                                                                       pcVar6[6]),
                                                                                      CONCAT15(-(
                                                  cVar12 == pcVar6[5]),
                                                  CONCAT14(-(cVar11 == pcVar6[4]),
                                                           CONCAT13(-(cVar14 == pcVar6[3]),
                                                                    CONCAT12(-(cVar13 == pcVar6[2]),
                                                                             CONCAT11(-(cVar12 ==
                                                                                       pcVar6[1]),
                                                                                      -(cVar11 ==
                                                                                       *pcVar6))))))
                                                  )))))))))));
      uVar2 = uVar2 & uVar7;
      uVar4 = uVar4 & uVar7;
      while (uVar4 == 0) {
        uVar4 = 0x1f;
        if (uVar2 != 0) {
          for (; uVar2 >> uVar4 == 0; uVar4 = uVar4 - 1) {
          }
        }
        if (uVar2 != 0) {
          pauVar3 = (undefined (*) [16])(pcVar6 + uVar4);
        }
        pcVar8 = pcVar6 + 0x10;
        uVar4 = pmovmskb((int)(undefined (*) [16])(pcVar6 + uVar4),
                         CONCAT115(-(pcVar6[0x1f] == '\0'),
                                   CONCAT114(-(pcVar6[0x1e] == '\0'),
                                             CONCAT113(-(pcVar6[0x1d] == '\0'),
                                                       CONCAT112(-(pcVar6[0x1c] == '\0'),
                                                                 CONCAT111(-(pcVar6[0x1b] == '\0'),
                                                                           CONCAT110(-(pcVar6[0x1a]
                                                                                      == '\0'),
                                                                                     CONCAT19(-(
                                                  pcVar6[0x19] == '\0'),
                                                  CONCAT18(-(pcVar6[0x18] == '\0'),
                                                           CONCAT17(-(pcVar6[0x17] == '\0'),
                                                                    CONCAT16(-(pcVar6[0x16] == '\0')
                                                                             ,CONCAT15(-(pcVar6[0x15
                                                  ] == '\0'),
                                                  CONCAT14(-(pcVar6[0x14] == '\0'),
                                                           CONCAT13(-(pcVar6[0x13] == '\0'),
                                                                    CONCAT12(-(pcVar6[0x12] == '\0')
                                                                             ,CONCAT11(-(pcVar6[0x11
                                                  ] == '\0'),-(*pcVar8 == '\0')))))))))))))))));
        uVar2 = pmovmskb(uVar2,CONCAT115(-(cVar14 == pcVar6[0x1f]),
                                         CONCAT114(-(cVar13 == pcVar6[0x1e]),
                                                   CONCAT113(-(cVar12 == pcVar6[0x1d]),
                                                             CONCAT112(-(cVar11 == pcVar6[0x1c]),
                                                                       CONCAT111(-(cVar14 ==
                                                                                  pcVar6[0x1b]),
                                                                                 CONCAT110(-(cVar13 
                                                  == pcVar6[0x1a]),
                                                  CONCAT19(-(cVar12 == pcVar6[0x19]),
                                                           CONCAT18(-(cVar11 == pcVar6[0x18]),
                                                                    CONCAT17(-(cVar14 ==
                                                                              pcVar6[0x17]),
                                                                             CONCAT16(-(cVar13 ==
                                                                                       pcVar6[0x16])
                                                                                      ,CONCAT15(-(
                                                  cVar12 == pcVar6[0x15]),
                                                  CONCAT14(-(cVar11 == pcVar6[0x14]),
                                                           CONCAT13(-(cVar14 == pcVar6[0x13]),
                                                                    CONCAT12(-(cVar13 ==
                                                                              pcVar6[0x12]),
                                                                             CONCAT11(-(cVar12 ==
                                                                                       pcVar6[0x11])
                                                                                      ,-(cVar11 ==
                                                                                        *pcVar8)))))
                                                  ))))))))))));
        pcVar6 = pcVar8;
      }
      uVar2 = uVar2 & (-uVar4 & uVar4) - 1;
      uVar4 = 0x1f;
      if (uVar2 != 0) {
        for (; uVar2 >> uVar4 == 0; uVar4 = uVar4 - 1) {
        }
      }
      if (uVar2 != 0) {
        pauVar3 = (undefined (*) [16])(pcVar6 + uVar4);
      }
    }
    else {
      uVar1 = (ulonglong)_Str & 0xf;
      while (bVar10 = uVar1 == 0, !bVar10) {
        if (*_Str == _Ch) {
          pauVar3 = (undefined (*) [16])_Str;
        }
        if (*_Str == '\0') {
          return (char *)pauVar3;
        }
        _Str = _Str + 1;
        uVar1 = (ulonglong)_Str & 0xf;
      }
      bVar9 = false;
      while( true ) {
        iVar5 = pcmpistri(ZEXT416(_Ch & 0xff),*(undefined (*) [16])_Str,0x40);
        if (bVar9) {
          pauVar3 = (undefined (*) [16])(_Str + iVar5);
          bVar10 = pauVar3 == (undefined (*) [16])0x0;
          pcmpistri(ZEXT416(_Ch & 0xff),*(undefined (*) [16])_Str,0x40);
        }
        if (bVar10) break;
        bVar9 = (undefined (*) [16])0xffffffffffffffef < _Str;
        _Str = (char *)((longlong)_Str + 0x10);
        bVar10 = (undefined (*) [16])_Str == (undefined (*) [16])0x0;
      }
    }
  }
  return (char *)pauVar3;
}



void FUN_1800251c0(unsigned___int64 param_1)

{
  operator_new(param_1);
  return;
}



void FUN_1800251e0(void *param_1)

{
  free(param_1);
  return;
}



void FUN_1800251e8(longlong *param_1,byte *param_2)

{
  PVOID local_res8;
  undefined4 local_28;
  undefined4 uStack36;
  longlong *plStack32;
  byte *local_18;
  PVOID pvStack16;
  
  local_28 = 0x19930520;
  uStack36 = 0;
  plStack32 = (longlong *)0x0;
  local_18 = (byte *)0x0;
  pvStack16 = (PVOID)0x0;
  if ((param_2 != (byte *)0x0) && ((*param_2 & 0x10) != 0)) {
    param_2 = *(byte **)(*(longlong *)(*param_1 + -8) + 0x30);
    (**(code **)(*(longlong *)(*param_1 + -8) + 0x40))();
  }
  plStack32 = param_1;
  local_18 = param_2;
  local_res8 = RtlPcToFileHeader(param_2,&local_res8);
  if (param_2 != (byte *)0x0) {
    if ((*param_2 & 8) == 0) {
      if (local_res8 == (PVOID)0x0) {
        local_28 = 0x1994000;
      }
    }
    else {
      local_28 = 0x1994000;
    }
  }
  pvStack16 = local_res8;
  RaiseException(0xe06d7363,1,4,(ULONG_PTR *)&local_28);
  return;
}



// Library Function - Single Match
//  unsigned __int64 * __ptr64 __cdecl _GetEstablisherFrame(unsigned __int64 * __ptr64,struct
// _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2012 Release

unsigned___int64 *
_GetEstablisherFrame
          (unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
          unsigned___int64 *param_4)

{
  uint uVar1;
  int iVar2;
  PRUNTIME_FUNCTION p_Var3;
  uint uVar4;
  ulonglong uVar5;
  int *piVar6;
  longlong lVar7;
  ulonglong uVar8;
  ulonglong local_res8;
  
  uVar8 = (ulonglong)param_3->nTryBlocks;
  iVar2 = FUN_18002aaf8((longlong)param_3,(longlong *)param_2);
  *(undefined8 *)param_4 = *(undefined8 *)param_1;
  do {
    do {
      if ((int)uVar8 == 0) {
        return param_4;
      }
      uVar8 = (ulonglong)((int)uVar8 - 1);
      lVar7 = (longlong)(int)param_3->dispTryBlockMap + uVar8 * 0x14 + *(longlong *)(param_2 + 8);
    } while ((iVar2 <= *(int *)(lVar7 + 4)) || (*(int *)(lVar7 + 8) < iVar2));
    p_Var3 = RtlLookupFunctionEntry(*(DWORD64 *)param_2,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    uVar1 = *(uint *)(lVar7 + 0xc);
    lVar7 = (longlong)*(int *)(lVar7 + 0x10) + local_res8;
    uVar5 = 0;
    if (uVar1 != 0) {
      piVar6 = (int *)(lVar7 + 0xc);
      do {
        if ((longlong)*piVar6 == (ulonglong)p_Var3->BeginAddress) break;
        uVar4 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar4;
        piVar6 = piVar6 + 5;
      } while (uVar4 < uVar1);
    }
    if ((uint)uVar5 < uVar1) {
      *(undefined8 *)param_4 =
           *(undefined8 *)((longlong)*(int *)(lVar7 + 0x10 + uVar5 * 0x14) + *(longlong *)param_1);
      return param_4;
    }
  } while( true );
}



longlong FUN_18002537c(undefined8 param_1,longlong param_2,undefined8 param_3,int param_4,
                      uint *param_5,int *param_6,longlong *param_7)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  
  uVar1 = *(uint *)(param_2 + 0xc);
  lVar6 = 0;
  iVar2 = FUN_18002aaf8(param_2,param_7);
  if (uVar1 == 0) {
    _inconsistency();
  }
  uVar5 = (ulonglong)uVar1;
  *param_6 = -1;
  *param_5 = 0xffffffff;
  uVar4 = uVar1;
  if (uVar1 != 0) {
    do {
      uVar4 = (uint)uVar5;
      uVar7 = uVar4 - 1;
      uVar5 = (ulonglong)uVar7;
      lVar8 = param_7[1] + uVar5 * 0x14;
      if ((*(int *)(lVar8 + 4 + (longlong)*(int *)(param_2 + 0x10)) < iVar2) &&
         (iVar2 <= *(int *)(lVar8 + 8 + (longlong)*(int *)(param_2 + 0x10)))) break;
      uVar4 = uVar7;
    } while (uVar7 != 0);
  }
  if (uVar4 != 0) {
    lVar6 = (longlong)*(int *)(param_2 + 0x10) + (ulonglong)(uVar4 - 1) * 0x14 + param_7[1];
  }
  uVar4 = 0;
  if (uVar1 != 0) {
    lVar8 = 0;
    do {
      piVar3 = (int *)(*(int *)(param_2 + 0x10) + lVar8 + param_7[1]);
      if ((((lVar6 == 0) ||
           ((*piVar3 != *(int *)(lVar6 + 4) && *(int *)(lVar6 + 4) <= *piVar3 &&
            (piVar3[1] == *(int *)(lVar6 + 8) || piVar3[1] < *(int *)(lVar6 + 8))))) &&
          (*piVar3 <= param_4)) && (param_4 <= piVar3[1])) {
        if (*param_5 == 0xffffffff) {
          *param_5 = uVar4;
        }
        *param_6 = uVar4 + 1;
      }
      uVar4 = uVar4 + 1;
      lVar8 = lVar8 + 0x14;
    } while (uVar4 < uVar1);
    if (*param_5 != 0xffffffff) {
      return (longlong)*(int *)(param_2 + 0x10) + (ulonglong)*param_5 * 0x14 + param_7[1];
    }
  }
  *param_5 = 0;
  *param_6 = 0;
  return 0;
}



// Library Function - Single Match
//  void __cdecl __FrameUnwindToEmptyState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2012 Release

void __FrameUnwindToEmptyState
               (unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  unsigned___int64 *puVar2;
  _ptiddata p_Var3;
  longlong lVar4;
  ulonglong uVar5;
  unsigned___int64 local_res18 [4];
  
  puVar2 = _GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  iVar1 = FUN_18002aaf8((longlong)param_3,(longlong *)param_2);
  uVar5 = (ulonglong)param_3->nTryBlocks;
  do {
    if ((int)uVar5 == 0) {
      lVar4 = 0;
      break;
    }
    uVar5 = (ulonglong)((int)uVar5 - 1);
    p_Var3 = _getptd();
    lVar4 = p_Var3->_ImageBase + uVar5 * 0x14 + (longlong)(int)param_3->dispTryBlockMap;
  } while ((iVar1 <= *(int *)(lVar4 + 4)) || (*(int *)(lVar4 + 8) < iVar1));
  if (lVar4 == 0) {
    iVar1 = -1;
  }
  else {
    iVar1 = *(int *)(lVar4 + 4);
  }
  __FrameUnwindToState(puVar2,param_2,param_3,iVar1);
  return;
}



// Library Function - Single Match
//  int __cdecl __SehTransFilter(struct _EXCEPTION_POINTERS * __ptr64,struct EHExceptionRecord *
// __ptr64,unsigned __int64 * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64,int * __ptr64)
// 
// Library: Visual Studio 2012 Release

int __SehTransFilter(_EXCEPTION_POINTERS *param_1,EHExceptionRecord *param_2,
                    unsigned___int64 *param_3,_CONTEXT *param_4,_xDISPATCHER_CONTEXT *param_5,
                    _s_FuncInfo *param_6,int *param_7)

{
  PEXCEPTION_RECORD pEVar1;
  _ptiddata p_Var2;
  
  p_Var2 = _getptd();
  p_Var2->_pForeignException = param_2;
  pEVar1 = param_1->ExceptionRecord;
  p_Var2 = _getptd();
  p_Var2->_ThrowImageBase = pEVar1->ExceptionInformation[3];
  __InternalCxxFrameHandler
            ((int *)param_1->ExceptionRecord,param_3,param_4,param_5,param_6,0,
             (unsigned___int64 *)0x0,1);
  p_Var2 = _getptd();
  p_Var2->_pForeignException = (void *)0x0;
  *param_7 = 1;
  return 1;
}



// Library Function - Single Match
//  _CallSETranslator
// 
// Library: Visual Studio 2012 Release

undefined4 _CallSETranslator(undefined4 *param_1,undefined8 param_2,undefined8 param_3)

{
  _ptiddata p_Var1;
  undefined4 *local_20;
  undefined8 local_18;
  
  local_20 = param_1;
  local_18 = param_3;
  p_Var1 = _getptd();
  (*(code *)p_Var1->_translator)(*param_1,&local_20,p_Var1->_translator);
  return 0;
}



// Library Function - Single Match
//  _CreateFrameInfo
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release,
// Visual Studio 2012 Release

undefined8 * _CreateFrameInfo(undefined8 *param_1,undefined8 param_2)

{
  _ptiddata p_Var1;
  void *pvVar2;
  
  *param_1 = param_2;
  p_Var1 = _getptd();
  if (param_1 < p_Var1->_pFrameInfoChain) {
    p_Var1 = _getptd();
    pvVar2 = p_Var1->_pFrameInfoChain;
  }
  else {
    pvVar2 = (void *)0x0;
  }
  param_1[1] = pvVar2;
  p_Var1 = _getptd();
  p_Var1->_pFrameInfoChain = param_1;
  return param_1;
}



// Library Function - Single Match
//  _FindAndUnlinkFrame
// 
// Library: Visual Studio 2012 Release

void _FindAndUnlinkFrame(void *param_1)

{
  _ptiddata p_Var1;
  void *pvVar2;
  
  p_Var1 = _getptd();
  if (param_1 != p_Var1->_pFrameInfoChain) {
    _inconsistency();
  }
  p_Var1 = _getptd();
  pvVar2 = p_Var1->_pFrameInfoChain;
  while( true ) {
    if (pvVar2 == (void *)0x0) {
      _inconsistency();
      return;
    }
    if (param_1 == pvVar2) break;
    pvVar2 = *(void **)((longlong)pvVar2 + 8);
  }
  p_Var1 = _getptd();
  p_Var1->_pFrameInfoChain = *(void **)((longlong)pvVar2 + 8);
  return;
}



// Library Function - Single Match
//  _GetImageBase
// 
// Library: Visual Studio 2012 Release

ulonglong _GetImageBase(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  return p_Var1->_ImageBase;
}



// Library Function - Single Match
//  _GetThrowImageBase
// 
// Library: Visual Studio 2012 Release

ulonglong _GetThrowImageBase(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  return p_Var1->_ThrowImageBase;
}



// Library Function - Single Match
//  _IsExceptionObjectToBeDestroyed
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

undefined4 _IsExceptionObjectToBeDestroyed(longlong param_1)

{
  _ptiddata p_Var1;
  longlong *plVar2;
  
  p_Var1 = _getptd();
  plVar2 = (longlong *)p_Var1->_pFrameInfoChain;
  while( true ) {
    if (plVar2 == (longlong *)0x0) {
      return 1;
    }
    if (*plVar2 == param_1) break;
    plVar2 = (longlong *)plVar2[1];
  }
  return 0;
}



// Library Function - Single Match
//  _SetImageBase
// 
// Library: Visual Studio 2012 Release

void _SetImageBase(ulonglong param_1)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  p_Var1->_ImageBase = param_1;
  return;
}



// Library Function - Single Match
//  _SetThrowImageBase
// 
// Library: Visual Studio 2012 Release

void _SetThrowImageBase(ulonglong param_1)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  p_Var1->_ThrowImageBase = param_1;
  return;
}



void FUN_180025774(PVOID *param_1,ULONG_PTR param_2,ULONG_PTR param_3,ULONG_PTR param_4,
                  ULONG_PTR param_5,int param_6,ULONG_PTR param_7,PVOID *param_8,byte param_9)

{
  undefined local_588 [12];
  undefined4 uStack1404;
  undefined4 local_578;
  undefined4 uStack1396;
  DWORD DStack1392;
  undefined4 uStack1388;
  undefined *local_568;
  ULONG_PTR UStack1376;
  ULONG_PTR local_558;
  ULONG_PTR UStack1360;
  ULONG_PTR local_548;
  ULONG_PTR UStack1344;
  ULONG_PTR local_538;
  ulonglong uStack1328;
  ULONG_PTR local_528;
  undefined4 uStack1312;
  undefined4 uStack1308;
  undefined4 local_518;
  undefined4 uStack1300;
  undefined4 uStack1296;
  undefined4 uStack1292;
  undefined4 local_508;
  undefined4 uStack1284;
  undefined4 uStack1280;
  undefined4 uStack1276;
  ULONG_PTR local_4f8;
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffa48;
  local_588._0_4_ = 0x80000029;
  local_588._4_4_ = 1;
  local_588._8_4_ = 0;
  uStack1404 = 0;
  local_578 = 0;
  uStack1396 = 0;
  DStack1392 = 0xf;
  uStack1388 = 0;
  uStack1312 = 0;
  uStack1308 = 0;
  local_518 = 0;
  uStack1300 = 0;
  uStack1296 = 0;
  uStack1292 = 0;
  local_508 = 0;
  uStack1284 = 0;
  uStack1280 = 0;
  uStack1276 = 0;
  local_4f8 = 0;
  local_568 = &LAB_18002a31c;
  local_558 = param_5;
  UStack1360 = SEXT48(param_6);
  UStack1344 = param_7;
  uStack1328 = (ulonglong)param_9;
  local_528 = 0x19930520;
  UStack1376 = param_4;
  local_548 = param_3;
  local_538 = param_2;
  RtlUnwindEx(*param_1,*param_8,(PEXCEPTION_RECORD)local_588,(PVOID)0x0,(PCONTEXT)&local_4e8,
              (PUNWIND_HISTORY_TABLE)param_8[8]);
  FUN_180023ef0(local_18 ^ (ulonglong)&stack0xfffffffffffffa48);
  return;
}



// Library Function - Single Match
//  __CxxFrameHandler3
// 
// Library: Visual Studio 2012 Release

void __CxxFrameHandler3(int *param_1,undefined8 param_2,_CONTEXT *param_3,
                       _xDISPATCHER_CONTEXT *param_4)

{
  _ptiddata p_Var1;
  undefined8 local_res8;
  
  local_res8 = param_2;
  p_Var1 = _getptd();
  p_Var1->_ImageBase = *(ulonglong *)(param_4 + 8);
  p_Var1 = _getptd();
  p_Var1->_ThrowImageBase = *(ulonglong *)(param_1 + 0xe);
  p_Var1 = _getptd();
  __InternalCxxFrameHandler
            (param_1,(unsigned___int64 *)&local_res8,param_3,param_4,
             (_s_FuncInfo *)((ulonglong)**(uint **)(param_4 + 0x38) + p_Var1->_ImageBase),0,
             (unsigned___int64 *)0x0,0);
  return;
}



// Library Function - Single Match
//  public: bool __cdecl type_info::operator==(class type_info const & __ptr64)const __ptr64
// 
// Library: Visual Studio 2012 Release

bool __thiscall type_info::operator__(type_info *this,type_info *param_1)

{
  int iVar1;
  
  iVar1 = strcmp((char *)(param_1 + 0x11),(char *)(this + 0x11));
  return iVar1 == 0;
}



undefined ** FUN_180025940(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)type_info::vftable;
  type_info::_Type_info_dtor((type_info *)param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  __GSHandlerCheck_EH
// 
// Library: Visual Studio 2012 Release

undefined4
__GSHandlerCheck_EH(int *param_1,ulonglong param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4)

{
  uint uVar1;
  longlong lVar2;
  undefined4 uVar3;
  uint uVar4;
  
  lVar2 = *(longlong *)(param_4 + 0x38);
  __GSHandlerCheckCommon(param_2,(longlong)param_4,(uint *)(lVar2 + 4));
  uVar1 = *(uint *)(lVar2 + 4);
  uVar3 = 1;
  uVar4 = uVar1 & 2;
  if ((param_1[1] & 0x66U) == 0) {
    uVar4 = uVar1 & 1;
  }
  if (uVar4 != 0) {
    uVar3 = __CxxFrameHandler3(param_1,param_2,param_3,param_4);
  }
  return uVar3;
}



// Library Function - Single Match
//  _recalloc
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void * _recalloc(void *_Memory,size_t _Count,size_t _Size)

{
  int *piVar1;
  size_t sVar2;
  void *pvVar3;
  ulonglong _NewSize;
  
  sVar2 = 0;
  if ((_Count == 0) || (_Size <= 0xffffffffffffffe0 / _Count)) {
    _NewSize = _Count * _Size;
    if (_Memory != (void *)0x0) {
      sVar2 = _msize(_Memory);
    }
    pvVar3 = realloc(_Memory,_NewSize);
    if ((pvVar3 != (void *)0x0) && (sVar2 < _NewSize)) {
      FUN_1800244a0((undefined (*) [16])(sVar2 + (longlong)pvVar3),0,_NewSize - sVar2);
    }
  }
  else {
    piVar1 = _errno();
    *piVar1 = 0xc;
    pvVar3 = (void *)0x0;
  }
  return pvVar3;
}



void * operator_new(unsigned___int64 param_1)

{
  code *pcVar1;
  int iVar2;
  void *pvVar3;
  undefined4 in_register_0000000c;
  char *apcStackX16 [3];
  undefined **appuStack40 [4];
  
  do {
    pvVar3 = malloc(CONCAT44(in_register_0000000c,param_1));
    if (pvVar3 != (void *)0x0) {
      return pvVar3;
    }
    iVar2 = _callnewh(CONCAT44(in_register_0000000c,param_1));
  } while (iVar2 != 0);
  apcStackX16[0] = "bad allocation";
  std::exception::exception((exception *)appuStack40,apcStackX16,1);
  appuStack40[0] = std::bad_alloc::vftable;
  FUN_1800251e8((longlong *)appuStack40,&DAT_1800511b0);
  pcVar1 = (code *)swi(3);
  pvVar3 = (void *)(*pcVar1)();
  return pvVar3;
}



// Library Function - Single Match
//  memcpy_s
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release, Visual Studio 2015 Debug,
// Visual Studio 2015 Release

errno_t memcpy_s(void *_Dst,rsize_t _DstSize,void *_Src,rsize_t _MaxCount)

{
  errno_t *peVar1;
  errno_t eVar2;
  
  if (_MaxCount == 0) {
LAB_180025bdd:
    eVar2 = 0;
  }
  else {
    if (_Dst == (void *)0x0) {
LAB_180025be6:
      peVar1 = _errno();
      eVar2 = 0x16;
    }
    else {
      if ((_Src != (void *)0x0) && (_MaxCount <= _DstSize)) {
        FUN_180023f20((undefined8 *)_Dst,(undefined8 *)_Src,_MaxCount);
        goto LAB_180025bdd;
      }
      FUN_1800244a0((undefined (*) [16])_Dst,0,_DstSize);
      if (_Src == (void *)0x0) goto LAB_180025be6;
      if (_MaxCount <= _DstSize) {
        return 0x16;
      }
      peVar1 = _errno();
      eVar2 = 0x22;
    }
    *peVar1 = eVar2;
    FUN_18002add8();
  }
  return eVar2;
}



// Library Function - Single Match
//  _vswprintf_helper
// 
// Library: Visual Studio 2012 Release

ulonglong _vswprintf_helper(undefined *param_1,char *param_2,ulonglong param_3,longlong param_4,
                           undefined8 param_5,undefined8 param_6)

{
  int *piVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined local_48 [8];
  int local_40;
  char *local_38;
  int local_30;
  
  local_48 = (char *)0x0;
  FUN_1800244a0((undefined (*) [16])&local_40,0,0x28);
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (char *)0x0)))) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    FUN_18002add8();
    return 0xffffffff;
  }
  local_30 = 0x42;
  if (param_3 < 0x40000000) {
    local_40 = (int)param_3 * 2;
  }
  else {
    local_40 = 0x7fffffff;
  }
  local_48 = param_2;
  local_38 = param_2;
  uVar2 = (*(code *)param_1)(local_48,param_4,param_5,param_6);
  if (param_2 == (char *)0x0) {
    return uVar2;
  }
  if (-1 < (int)uVar2) {
    local_40 = local_40 + -1;
    if (local_40 < 0) {
      uVar3 = FUN_18002ae34(0,(FILE *)local_48);
      if ((int)uVar3 == -1) goto LAB_180025d39;
    }
    else {
      *local_48 = '\0';
      local_48 = local_48 + 1;
    }
    local_40 = local_40 + -1;
    if (-1 < local_40) {
      *local_48 = '\0';
      return uVar2 & 0xffffffff;
    }
    uVar3 = FUN_18002ae34(0,(FILE *)local_48);
    if ((int)uVar3 != -1) {
      return uVar2 & 0xffffffff;
    }
  }
LAB_180025d39:
  *(undefined2 *)(param_2 + param_3 * 2 + -2) = 0;
  return (ulonglong)((-1 < local_40) - 2);
}



// Library Function - Single Match
//  _vswprintf_s_l
// 
// Library: Visual Studio 2012 Release

int _vswprintf_s_l(wchar_t *_DstBuf,size_t _DstSize,wchar_t *_Format,_locale_t _Locale,
                  va_list _ArgList)

{
  int iVar1;
  ulonglong uVar2;
  int *piVar3;
  
  if (((_Format == (wchar_t *)0x0) || (_DstBuf == (wchar_t *)0x0)) || (_DstSize == 0)) {
    piVar3 = _errno();
    *piVar3 = 0x16;
  }
  else {
    uVar2 = _vswprintf_helper(FUN_18002baf4,(char *)_DstBuf,_DstSize,(longlong)_Format,_Locale,
                              _ArgList);
    iVar1 = (int)uVar2;
    if (iVar1 < 0) {
      *_DstBuf = L'\0';
    }
    if (iVar1 != -2) {
      return iVar1;
    }
    piVar3 = _errno();
    *piVar3 = 0x22;
  }
  FUN_18002add8();
  return -1;
}



void FUN_180025de0(wchar_t *param_1,size_t param_2,wchar_t *param_3,va_list param_4)

{
  _vswprintf_s_l(param_1,param_2,param_3,(_locale_t)0x0,param_4);
  return;
}



// Library Function - Single Match
//  public: __cdecl _LocaleUpdate::_LocaleUpdate(struct localeinfo_struct * __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

_LocaleUpdate * __thiscall
_LocaleUpdate::_LocaleUpdate(_LocaleUpdate *this,localeinfo_struct *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  _ptiddata p_Var5;
  pthreadlocinfo ptVar6;
  pthreadmbcinfo ptVar7;
  
  this[0x18] = (_LocaleUpdate)0x0;
  if (param_1 == (localeinfo_struct *)0x0) {
    p_Var5 = _getptd();
    *(_ptiddata *)(this + 0x10) = p_Var5;
    ptVar6 = p_Var5->ptlocinfo;
    *(pthreadlocinfo *)this = ptVar6;
    *(pthreadmbcinfo *)(this + 8) = p_Var5->ptmbcinfo;
    if ((ptVar6 != (pthreadlocinfo)PTR_DAT_180054240) && ((DAT_1800543b8 & p_Var5->_ownlocale) == 0)
       ) {
      ptVar6 = __updatetlocinfo();
      *(pthreadlocinfo *)this = ptVar6;
    }
    if ((*(undefined **)(this + 8) != PTR_DAT_180053f70) &&
       ((DAT_1800543b8 & *(uint *)(*(longlong *)(this + 0x10) + 200)) == 0)) {
      ptVar7 = __updatetmbcinfo();
      *(pthreadmbcinfo *)(this + 8) = ptVar7;
    }
    uVar1 = *(uint *)(*(longlong *)(this + 0x10) + 200);
    if ((uVar1 & 2) == 0) {
      *(uint *)(*(longlong *)(this + 0x10) + 200) = uVar1 | 2;
      this[0x18] = (_LocaleUpdate)0x1;
    }
  }
  else {
    uVar2 = *(undefined4 *)((longlong)&param_1->locinfo + 4);
    uVar3 = *(undefined4 *)&param_1->mbcinfo;
    uVar4 = *(undefined4 *)((longlong)&param_1->mbcinfo + 4);
    *(undefined4 *)this = *(undefined4 *)&param_1->locinfo;
    *(undefined4 *)(this + 4) = uVar2;
    *(undefined4 *)(this + 8) = uVar3;
    *(undefined4 *)(this + 0xc) = uVar4;
  }
  return this;
}



// Library Function - Single Match
//  unsigned long __cdecl strtoxl(struct localeinfo_struct * __ptr64,char const * __ptr64,char const
// * __ptr64 * __ptr64,int,int)
// 
// Library: Visual Studio 2012 Release

unsigned_long
strtoxl(localeinfo_struct *param_1,char *param_2,char **param_3,int param_4,int param_5)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  byte bVar6;
  unsigned_long uVar7;
  pthreadlocinfo ptVar8;
  localeinfo_struct local_48;
  longlong local_38;
  char local_30;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_48,param_1);
  if (param_3 != (char **)0x0) {
    *param_3 = param_2;
  }
  if ((param_2 != (char *)0x0) && ((param_4 == 0 || (param_4 - 2U < 0x23)))) {
    bVar6 = *param_2;
    uVar7 = 0;
    pbVar5 = (byte *)(param_2 + 1);
    ptVar8 = local_48.locinfo;
    while( true ) {
      if (ptVar8->mb_cur_max < 2) {
        uVar1 = ptVar8->pctype[bVar6] & 8;
      }
      else {
        uVar1 = _isctype_l((uint)bVar6,8,(_locale_t)&local_48);
        ptVar8 = local_48.locinfo;
      }
      if (uVar1 == 0) break;
      bVar6 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    }
    if (bVar6 == 0x2d) {
      param_5 = param_5 | 2;
LAB_180025ffe:
      bVar6 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    }
    else {
      if (bVar6 == 0x2b) goto LAB_180025ffe;
    }
    if (param_4 == 0) {
LAB_180026026:
      if (bVar6 != 0x30) {
        param_4 = 10;
        goto LAB_180026068;
      }
      if ((*pbVar5 + 0xa8 & 0xdf) != 0) {
        param_4 = 8;
        goto LAB_180026068;
      }
      param_4 = 0x10;
    }
    else {
      if (0x22 < param_4 - 2U) {
        if (param_3 != (char **)0x0) {
          *param_3 = param_2;
        }
        goto LAB_18002601a;
      }
      if (param_4 == 0) goto LAB_180026026;
      if ((param_4 != 0x10) || (bVar6 != 0x30)) goto LAB_180026068;
    }
    if ((*pbVar5 + 0xa8 & 0xdf) == 0) {
      bVar6 = pbVar5[1];
      pbVar5 = pbVar5 + 2;
    }
LAB_180026068:
    uVar1 = (uint)(0xffffffff / (ulonglong)(uint)param_4);
    do {
      if ((ptVar8->pctype[bVar6] & 4) == 0) {
        if ((ptVar8->pctype[bVar6] & 0x103) == 0) goto LAB_1800260c9;
        iVar4 = (int)(char)bVar6;
        if ((byte)(bVar6 + 0x9f) < 0x1a) {
          iVar4 = iVar4 + -0x20;
        }
        uVar3 = iVar4 - 0x37;
      }
      else {
        uVar3 = (int)(char)bVar6 - 0x30;
      }
      if ((uint)param_4 <= uVar3) goto LAB_1800260c9;
      if ((uVar7 < uVar1) ||
         ((uVar7 == uVar1 && (uVar3 <= (uint)(0xffffffff % (ulonglong)(uint)param_4))))) {
        uVar7 = uVar7 * param_4 + uVar3;
        param_5 = param_5 | 8;
      }
      else {
        param_5 = param_5 | 0xc;
        if (param_3 == (char **)0x0) goto LAB_1800260c9;
      }
      bVar6 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    } while( true );
  }
  piVar2 = _errno();
  *piVar2 = 0x16;
  FUN_18002add8();
LAB_18002601a:
  uVar7 = 0;
LAB_180026146:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return uVar7;
LAB_1800260c9:
  pbVar5 = pbVar5 + -1;
  if ((param_5 & 8U) == 0) {
    if (param_3 != (char **)0x0) {
      pbVar5 = (byte *)param_2;
    }
    uVar7 = 0;
  }
  else {
    if (((param_5 & 4U) != 0) ||
       (((param_5 & 1U) == 0 &&
        ((((param_5 & 2U) != 0 && (0x80000000 < uVar7)) ||
         (((param_5 & 2U) == 0 && (0x7fffffff < uVar7)))))))) {
      piVar2 = _errno();
      *piVar2 = 0x22;
      if ((param_5 & 1U) == 0) {
        uVar7 = ((param_5 & 2U) != 0) + 0x7fffffff;
      }
      else {
        uVar7 = 0xffffffff;
      }
    }
  }
  if (param_3 != (char **)0x0) {
    *param_3 = (char *)pbVar5;
  }
  if ((param_5 & 2U) != 0) {
    uVar7 = -uVar7;
  }
  goto LAB_180026146;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  strtol
// 
// Library: Visual Studio 2012 Release

long strtol(char *_Str,char **_EndPtr,int _Radix)

{
  unsigned_long uVar1;
  undefined **ppuVar2;
  
  if (_DAT_180056634 == 0) {
    ppuVar2 = &PTR_DAT_1800543a8;
  }
  else {
    ppuVar2 = (undefined **)0x0;
  }
  uVar1 = strtoxl((localeinfo_struct *)ppuVar2,_Str,_EndPtr,_Radix,0);
  return (long)uVar1;
}



// Library Function - Single Match
//  _swprintf
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _swprintf(wchar_t *_Dest,wchar_t *_Format,...)

{
  int iVar1;
  int *piVar2;
  int *in_R8;
  undefined8 in_R9;
  int *local_res18;
  undefined8 local_res20;
  undefined local_48 [8];
  int local_40;
  wchar_t *local_38;
  int local_30;
  
  local_48 = (wchar_t *)0x0;
  local_res18 = in_R8;
  local_res20 = in_R9;
  FUN_1800244a0((undefined (*) [16])&local_40,0,0x28);
  if ((_Format == (wchar_t *)0x0) || (_Dest == (wchar_t *)0x0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18002add8();
    iVar1 = -1;
  }
  else {
    local_30 = 0x42;
    local_40 = 0x7fffffff;
    local_48 = _Dest;
    local_38 = _Dest;
    iVar1 = FUN_18002afc0((FILE *)local_48,(ushort *)_Format,(localeinfo_struct *)0x0,&local_res18);
    local_40 = local_40 + -1;
    if (local_40 < 0) {
      FUN_18002ae34(0,(FILE *)local_48);
    }
    else {
      *(undefined *)local_48 = 0;
      local_48 = (wchar_t *)((longlong)local_48 + 1);
    }
    local_40 = local_40 + -1;
    if (local_40 < 0) {
      FUN_18002ae34(0,(FILE *)local_48);
    }
    else {
      *(undefined *)local_48 = 0;
    }
  }
  return iVar1;
}



undefined4 FUN_180026434(int param_1,void *param_2)

{
  int iVar1;
  int *piVar2;
  code *pcVar3;
  void *pvVar4;
  _ptiddata p_Var5;
  int *piVar6;
  longlong lVar7;
  longlong lVar8;
  
  if (param_1 != -0x1f928c9d) {
    return 0;
  }
  p_Var5 = _getptd_noexit();
  if (p_Var5 != (_ptiddata)0x0) {
    piVar2 = (int *)p_Var5->_pxcptacttab;
    piVar6 = piVar2;
    do {
      if (*piVar6 == -0x1f928c9d) break;
      piVar6 = piVar6 + 4;
    } while (piVar6 < piVar2 + 0x30);
    if ((piVar2 + 0x30 <= piVar6) || (*piVar6 != -0x1f928c9d)) {
      piVar6 = (int *)0x0;
    }
    if ((piVar6 != (int *)0x0) && (pcVar3 = *(code **)(piVar6 + 2), pcVar3 != (code *)0x0)) {
      if (pcVar3 == (code *)0x5) {
        *(undefined8 *)(piVar6 + 2) = 0;
        return 1;
      }
      if (pcVar3 != (code *)0x1) {
        pvVar4 = p_Var5->_tpxcptinfoptrs;
        p_Var5->_tpxcptinfoptrs = param_2;
        if (piVar6[1] == 8) {
          lVar7 = 0x30;
          do {
            lVar8 = lVar7 + 0x10;
            *(undefined8 *)(lVar7 + 8 + (longlong)p_Var5->_pxcptacttab) = 0;
            lVar7 = lVar8;
          } while (lVar8 < 0xc0);
          iVar1 = p_Var5->_tfpecode;
          if (*piVar6 == -0x3fffff72) {
            p_Var5->_tfpecode = 0x83;
          }
          else {
            if (*piVar6 == -0x3fffff70) {
              p_Var5->_tfpecode = 0x81;
            }
            else {
              if (*piVar6 == -0x3fffff6f) {
                p_Var5->_tfpecode = 0x84;
              }
              else {
                if (*piVar6 == -0x3fffff6d) {
                  p_Var5->_tfpecode = 0x85;
                }
                else {
                  if (*piVar6 == -0x3fffff73) {
                    p_Var5->_tfpecode = 0x82;
                  }
                  else {
                    if (*piVar6 == -0x3fffff71) {
                      p_Var5->_tfpecode = 0x86;
                    }
                    else {
                      if (*piVar6 == -0x3fffff6e) {
                        p_Var5->_tfpecode = 0x8a;
                      }
                      else {
                        if (*piVar6 == -0x3ffffd4b) {
                          p_Var5->_tfpecode = 0x8d;
                        }
                        else {
                          if (*piVar6 == -0x3ffffd4c) {
                            p_Var5->_tfpecode = 0x8e;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          (*pcVar3)(8,p_Var5->_tfpecode);
          p_Var5->_tfpecode = iVar1;
        }
        else {
          *(undefined8 *)(piVar6 + 2) = 0;
          (*pcVar3)(piVar6[1]);
        }
        p_Var5->_tpxcptinfoptrs = pvVar4;
      }
      return 0xffffffff;
    }
  }
  return 0;
}



// Library Function - Single Match
//  _freefls
// 
// Library: Visual Studio 2012 Release

void _freefls(void *_PerFiberData)

{
  int *piVar1;
  
  if (_PerFiberData != (void *)0x0) {
    if (*(void **)((longlong)_PerFiberData + 0x38) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x38));
    }
    if (*(void **)((longlong)_PerFiberData + 0x48) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x48));
    }
    if (*(void **)((longlong)_PerFiberData + 0x58) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x58));
    }
    if (*(void **)((longlong)_PerFiberData + 0x68) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x68));
    }
    if (*(void **)((longlong)_PerFiberData + 0x70) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x70));
    }
    if (*(void **)((longlong)_PerFiberData + 0x78) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x78));
    }
    if (*(void **)((longlong)_PerFiberData + 0x80) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x80));
    }
    if (*(undefined **)((longlong)_PerFiberData + 0xa0) != &DAT_1800477a0) {
      free(*(undefined **)((longlong)_PerFiberData + 0xa0));
    }
    _lock(0xd);
    piVar1 = *(int **)((longlong)_PerFiberData + 0xb8);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
      if ((*piVar1 == 0) && (piVar1 != &DAT_180053c50)) {
        free(piVar1);
      }
    }
    FUN_18002d5f0(0xd);
    _lock(0xc);
    piVar1 = *(int **)((longlong)_PerFiberData + 0xc0);
    if (piVar1 != (int *)0x0) {
      __removelocaleref(piVar1);
      if (((piVar1 != (int *)PTR_DAT_180054240) && (piVar1 != (int *)&DAT_180054250)) &&
         (*piVar1 == 0)) {
        __freetlocinfo(piVar1);
      }
    }
    FUN_18002d5f0(0xc);
    free(_PerFiberData);
  }
  return;
}



// Library Function - Single Match
//  _freeptd
// 
// Library: Visual Studio 2012 Release

void _freeptd(_ptiddata _Ptd)

{
  if (DAT_180053808 != -1) {
    if (_Ptd == (_ptiddata)0x0) {
      _Ptd = (_ptiddata)FUN_18002775c();
    }
    FUN_180027778();
    _freefls(_Ptd);
  }
  return;
}



// Library Function - Single Match
//  _getptd
// 
// Library: Visual Studio 2012 Release

_ptiddata _getptd(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd_noexit();
  if (p_Var1 == (_ptiddata)0x0) {
    _amsg_exit(0x10);
  }
  return p_Var1;
}



// Library Function - Single Match
//  _getptd_noexit
// 
// Library: Visual Studio 2012 Release

_ptiddata _getptd_noexit(void)

{
  DWORD dwErrCode;
  int iVar1;
  DWORD DVar2;
  _ptiddata _Memory;
  
  dwErrCode = GetLastError();
  _Memory = (_ptiddata)FUN_18002775c();
  if (_Memory == (_ptiddata)0x0) {
    _Memory = (_ptiddata)FUN_180027c68(1,0x478);
    if (_Memory != (_ptiddata)0x0) {
      iVar1 = FUN_180027778();
      if (iVar1 == 0) {
        free(_Memory);
        _Memory = (_ptiddata)0x0;
      }
      else {
        FUN_180026660((longlong)_Memory,0);
        DVar2 = GetCurrentThreadId();
        _Memory->_thandle = 0xffffffffffffffff;
        _Memory->_tid = DVar2;
      }
    }
  }
  SetLastError(dwErrCode);
  return _Memory;
}



void FUN_180026660(longlong param_1,longlong param_2)

{
  *(undefined **)(param_1 + 0xa0) = &DAT_1800477a0;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 1;
  *(undefined4 *)(param_1 + 200) = 1;
  *(undefined2 *)(param_1 + 0x164) = 0x43;
  *(undefined2 *)(param_1 + 0x26a) = 0x43;
  *(undefined4 **)(param_1 + 0xb8) = &DAT_180053c50;
  *(undefined8 *)(param_1 + 0x470) = 0;
  _lock(0xd);
  LOCK();
  **(int **)(param_1 + 0xb8) = **(int **)(param_1 + 0xb8) + 1;
  FUN_18002d5f0(0xd);
  _lock(0xc);
  *(longlong *)(param_1 + 0xc0) = param_2;
  if (param_2 == 0) {
    *(undefined **)(param_1 + 0xc0) = PTR_DAT_180054240;
  }
  __addlocaleref(*(int **)(param_1 + 0xc0));
  FUN_18002d5f0(0xc);
  return;
}



// Library Function - Single Match
//  _mtinit
// 
// Library: Visual Studio 2012 Release

int _mtinit(void)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  FUN_180026a48();
  iVar1 = FUN_18002d58c();
  if ((((iVar1 != 0) && (DAT_180053808 = FUN_180027724(), DAT_180053808 != -1)) &&
      (pDVar3 = (DWORD *)FUN_180027c68(1,0x478), pDVar3 != (DWORD *)0x0)) &&
     (iVar1 = FUN_180027778(), iVar1 != 0)) {
    FUN_180026660((longlong)pDVar3,0);
    DVar2 = GetCurrentThreadId();
    *(undefined8 *)(pDVar3 + 2) = 0xffffffffffffffff;
    *pDVar3 = DVar2;
    return 1;
  }
  FUN_1800267a4();
  return 0;
}



void FUN_1800267a4(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  LPCRITICAL_SECTION *pp_Var1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  if (DAT_180053808 != -1) {
    FUN_180027740();
    DAT_180053808 = -1;
  }
  lVar4 = 0x24;
  pp_Var1 = (LPCRITICAL_SECTION *)&DAT_1800543e0;
  lVar3 = 0x24;
  do {
    lpCriticalSection = *pp_Var1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (*(int *)(pp_Var1 + 1) != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      free(lpCriticalSection);
      *pp_Var1 = (LPCRITICAL_SECTION)0x0;
    }
    pp_Var1 = pp_Var1 + 2;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  piVar2 = &DAT_1800543e8;
  do {
    if ((*(LPCRITICAL_SECTION *)(piVar2 + -2) != (LPCRITICAL_SECTION)0x0) && (*piVar2 == 1)) {
      DeleteCriticalSection(*(LPCRITICAL_SECTION *)(piVar2 + -2));
    }
    piVar2 = piVar2 + 4;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return;
}



// Library Function - Single Match
//  __crtCorExitProcess
// 
// Library: Visual Studio 2012 Release

void __crtCorExitProcess(int param_1)

{
  BOOL BVar1;
  FARPROC pFVar2;
  HMODULE local_res10 [3];
  uint extraout_var;
  
  BVar1 = GetModuleHandleExW(0,L"mscoree.dll",local_res10);
  if (BVar1 != 0) {
    pFVar2 = GetProcAddress(local_res10[0],"CorExitProcess");
    extraout_var = (uint)((ulonglong)pFVar2 >> 0x20);
    if (((ulonglong)pFVar2 & 0xffffffff | (ulonglong)extraout_var << 0x20) != 0) {
      (*(code *)((ulonglong)pFVar2 & 0xffffffff | (ulonglong)extraout_var << 0x20))(param_1);
    }
  }
  return;
}



void FUN_18002680c(UINT param_1)

{
  __crtCorExitProcess(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_180026824(void)

{
  int iVar1;
  PVOID _Memory;
  void **ppvVar2;
  
  _Memory = DecodePointer(DAT_180057bc0);
  for (ppvVar2 = DAT_180055c40; (ppvVar2 != (void **)0x0 && (*ppvVar2 != (void *)0x0));
      ppvVar2 = ppvVar2 + 1) {
    free(*ppvVar2);
  }
  free(DAT_180055c40);
  DAT_180055c40 = (void **)0x0;
  for (ppvVar2 = DAT_180055c38; (ppvVar2 != (void **)0x0 && (*ppvVar2 != (void *)0x0));
      ppvVar2 = ppvVar2 + 1) {
    free(*ppvVar2);
  }
  free(DAT_180055c38);
  DAT_180055c38 = (void **)0x0;
  free(DAT_180055c30);
  free(DAT_180055c28);
  DAT_180055c30 = (void *)0x0;
  DAT_180055c28 = (void *)0x0;
  if ((_Memory != (PVOID)0xffffffffffffffff) && (DAT_180057bc0 != (PVOID)0x0)) {
    free(_Memory);
  }
  DAT_180057bc0 = EncodePointer((PVOID)0xffffffffffffffff);
  if (DAT_1800568a0 != (void *)0x0) {
    free(DAT_1800568a0);
    DAT_1800568a0 = (void *)0x0;
  }
  if (DAT_1800568a8 != (void *)0x0) {
    free(DAT_1800568a8);
    DAT_1800568a8 = (void *)0x0;
  }
  LOCK();
  iVar1 = *(int *)PTR_DAT_180053f70;
  *(int *)PTR_DAT_180053f70 = *(int *)PTR_DAT_180053f70 + -1;
  if ((iVar1 == 1) && ((undefined4 *)PTR_DAT_180053f70 != &DAT_180053c50)) {
    free(PTR_DAT_180053f70);
    PTR_DAT_180053f70 = (undefined *)&DAT_180053c50;
  }
  return;
}



// Library Function - Single Match
//  _amsg_exit
// 
// Library: Visual Studio 2012 Release

void _amsg_exit(int param_1)

{
  code *pcVar1;
  
  _FF_MSGBANNER();
  _NMSG_WRITE(param_1);
  FUN_180026b48(0xff,1,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180026994(void)

{
  FUN_180026b48(0,0,1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_1800269a4(void)

{
  BOOL BVar1;
  undefined8 uVar2;
  
  BVar1 = _IsNonwritableInCurrentImage((PBYTE)&PTR_thunk_FUN_180024fc8_180047680);
  if (BVar1 != 0) {
    thunk_FUN_180024fc8();
  }
  _initp_misc_cfltcvt_tab();
  uVar2 = _initterm_e((undefined **)&DAT_1800345b8,(undefined **)&DAT_1800345e0);
  if ((int)uVar2 == 0) {
    atexit(&LAB_180027e20);
    FUN_180026a94((undefined **)&DAT_180034580,(undefined **)&DAT_1800345b0);
    if ((_DAT_180057bb0 != (code *)0x0) &&
       (BVar1 = _IsNonwritableInCurrentImage(&DAT_180057bb0), BVar1 != 0)) {
      (*_DAT_180057bb0)(0,2);
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_180026a3c(UINT param_1)

{
  FUN_180026b48(param_1,1,0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180026a48(void)

{
  PVOID pvVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  
  pvVar1 = EncodePointer((PVOID)0x0);
  FUN_180028150(pvVar1);
  FUN_18002ad68(pvVar1);
  FUN_1800295f0(pvVar1);
  FUN_18002d6f0(pvVar1);
  FUN_180029638();
  FUN_18002d944(pvVar1);
  hModule = GetModuleHandleW(L"kernel32.dll");
  pFVar2 = GetProcAddress(hModule,"FlsAlloc");
  DAT_180057aa0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"FlsFree");
  DAT_180057aa8 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"FlsGetValue");
  DAT_180057ab0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"FlsSetValue");
  DAT_180057ab8 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"InitializeCriticalSectionEx");
  DAT_180057ac0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CreateEventExW");
  _DAT_180057ac8 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CreateSemaphoreExW");
  _DAT_180057ad0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"SetThreadStackGuarantee");
  DAT_180057ad8 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CreateThreadpoolTimer");
  _DAT_180057ae0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"SetThreadpoolTimer");
  _DAT_180057ae8 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"WaitForThreadpoolTimerCallbacks");
  _DAT_180057af0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CloseThreadpoolTimer");
  _DAT_180057af8 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CreateThreadpoolWait");
  _DAT_180057b00 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"SetThreadpoolWait");
  _DAT_180057b08 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CloseThreadpoolWait");
  _DAT_180057b10 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"FlushProcessWriteBuffers");
  _DAT_180057b18 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"FreeLibraryWhenCallbackReturns");
  _DAT_180057b20 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetCurrentProcessorNumber");
  _DAT_180057b28 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetLogicalProcessorInformation");
  _DAT_180057b30 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CreateSymbolicLinkW");
  _DAT_180057b38 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"SetDefaultDllDirectories");
  _DAT_180057b40 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"EnumSystemLocalesEx");
  _DAT_180057b50 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"CompareStringEx");
  _DAT_180057b48 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetDateFormatEx");
  _DAT_180057b58 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetLocaleInfoEx");
  _DAT_180057b60 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetTimeFormatEx");
  _DAT_180057b68 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetUserDefaultLocaleName");
  _DAT_180057b70 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"IsValidLocaleName");
  _DAT_180057b78 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"LCMapStringEx");
  DAT_180057b80 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetCurrentPackageId");
  DAT_180057b88 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetTickCount64");
  _DAT_180057b90 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"GetFileInformationByHandleExW");
  _DAT_180057b98 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  pFVar2 = GetProcAddress(hModule,"SetFileInformationByHandleW");
  _DAT_180057ba0 = (ulonglong)pFVar2 ^ DAT_1800537e8;
  return;
}



void FUN_180026a94(undefined **param_1,undefined **param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = 0;
  uVar1 = (ulonglong)((longlong)param_2 + (7 - (longlong)param_1)) >> 3;
  if (param_2 < param_1) {
    uVar1 = uVar2;
  }
  if (uVar1 != 0) {
    do {
      if ((code *)*param_1 != (code *)0x0) {
        (*(code *)*param_1)();
      }
      uVar2 = uVar2 + 1;
      param_1 = (code **)param_1 + 1;
    } while (uVar2 < uVar1);
  }
  return;
}



// Library Function - Single Match
//  _initterm_e
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

void _initterm_e(undefined **param_1,undefined **param_2)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 < param_2) {
    do {
      if (iVar1 != 0) {
        return;
      }
      if ((code *)*param_1 != (code *)0x0) {
        iVar1 = (*(code *)*param_1)();
      }
      param_1 = (code **)param_1 + 1;
    } while (param_1 < param_2);
  }
  return;
}



void FUN_180026b30(void)

{
  _lock(8);
  return;
}



void FUN_180026b3c(void)

{
  FUN_18002d5f0(8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180026b48(UINT param_1,int param_2,int param_3)

{
  PVOID *ppvVar1;
  PVOID *ppvVar2;
  PVOID pvVar3;
  code *pcVar4;
  PVOID *ppvVar5;
  PVOID *ppvVar6;
  PVOID *ppvVar7;
  PVOID *ppvVar8;
  
  _lock(8);
  if (_DAT_180055c20 != 1) {
    _DAT_180055c60 = 1;
    DAT_180055c5c = (undefined)param_3;
    if (param_2 == 0) {
      ppvVar1 = (PVOID *)DecodePointer(DAT_180057bc0);
      if (ppvVar1 != (PVOID *)0x0) {
        ppvVar2 = (PVOID *)DecodePointer(DAT_180057bb8);
        ppvVar7 = ppvVar1;
        ppvVar8 = ppvVar2;
        while (ppvVar2 = ppvVar2 + -1, ppvVar1 <= ppvVar2) {
          pvVar3 = EncodePointer((PVOID)0x0);
          if (*ppvVar2 != pvVar3) {
            if (ppvVar2 < ppvVar1) break;
            pcVar4 = (code *)DecodePointer(*ppvVar2);
            pvVar3 = EncodePointer((PVOID)0x0);
            *ppvVar2 = pvVar3;
            (*pcVar4)();
            ppvVar5 = (PVOID *)DecodePointer(DAT_180057bc0);
            ppvVar6 = (PVOID *)DecodePointer(DAT_180057bb8);
            if ((ppvVar7 != ppvVar5) || (ppvVar8 != ppvVar6)) {
              ppvVar1 = ppvVar5;
              ppvVar2 = ppvVar6;
              ppvVar7 = ppvVar5;
              ppvVar8 = ppvVar6;
            }
          }
        }
      }
      FUN_180026a94((undefined **)&DAT_1800345e8,(undefined **)&DAT_180034608);
    }
    FUN_180026a94((undefined **)&DAT_180034610,(undefined **)&DAT_180034618);
  }
  if ((param_3 != 0) && (FUN_18002d5f0(8), param_3 != 0)) {
    return;
  }
  _DAT_180055c20 = 1;
  FUN_18002d5f0(8);
  __crtCorExitProcess(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



bool FUN_180026ce0(void)

{
  DAT_180055c78 = GetProcessHeap();
  return DAT_180055c78 != (HANDLE)0x0;
}



void FUN_180026d00(void)

{
  DAT_180055c78 = 0;
  return;
}



undefined8 FUN_180026d0c(void)

{
  uint uVar1;
  byte bVar2;
  DWORD DVar3;
  undefined8 uVar4;
  HANDLE hFile;
  int iVar5;
  HANDLE *ppvVar6;
  HANDLE *ppvVar7;
  longlong lVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  undefined auStack216 [32];
  uint local_b8;
  HANDLE *local_b0;
  int local_a8;
  int *local_a0;
  HANDLE *local_98;
  undefined *local_90;
  _STARTUPINFOW local_88;
  
  local_90 = auStack216;
  _lock(0xb);
  local_b0 = (HANDLE *)FUN_180027c68(0x20,0x58);
  if (local_b0 == (HANDLE *)0x0) {
    FUN_18002d960(auStack216,(PVOID)0x180026d70);
    uVar4 = 0xffffffff;
  }
  else {
    DAT_180057ba8 = 0x20;
    DAT_180055c80 = local_b0;
    for (; local_b0 < DAT_180055c80 + 0x160; local_b0 = local_b0 + 0xb) {
      *(undefined2 *)(local_b0 + 1) = 0xa00;
      *local_b0 = (HANDLE)0xffffffffffffffff;
      *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x7f;
      *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
      *(undefined4 *)(local_b0 + 10) = 0;
      *(undefined *)((longlong)local_b0 + 0x4c) = 0;
    }
    GetStartupInfoW((LPSTARTUPINFOW)&local_88);
    if ((local_88.cbReserved2 != 0) && ((int *)local_88.lpReserved2 != (int *)0x0)) {
      piVar9 = (int *)((longlong)local_88.lpReserved2 + 4);
      ppvVar7 = (HANDLE *)((longlong)*(int *)local_88.lpReserved2 + (longlong)piVar9);
      iVar10 = 0x800;
      if (*(int *)local_88.lpReserved2 < 0x800) {
        iVar10 = *(int *)local_88.lpReserved2;
      }
      iVar5 = 1;
      local_a0 = piVar9;
      local_98 = ppvVar7;
      while ((iVar11 = iVar10, local_a8 = iVar5, DAT_180057ba8 < iVar10 &&
             (local_b0 = (HANDLE *)FUN_180027c68(0x20,0x58), iVar11 = DAT_180057ba8,
             local_b0 != (HANDLE *)0x0))) {
        *(HANDLE **)((longlong)&DAT_180055c80 + (longlong)iVar5 * 8) = local_b0;
        DAT_180057ba8 = DAT_180057ba8 + 0x20;
        for (; local_b0 <
               (HANDLE *)(*(longlong *)((longlong)&DAT_180055c80 + (longlong)iVar5 * 8) + 0xb00);
            local_b0 = local_b0 + 0xb) {
          *(undefined2 *)(local_b0 + 1) = 0xa00;
          *local_b0 = (HANDLE)0xffffffffffffffff;
          *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
          *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
          *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
          *(undefined4 *)(local_b0 + 10) = 0;
          *(undefined *)((longlong)local_b0 + 0x4c) = 0;
        }
        iVar5 = iVar5 + 1;
      }
      local_b8 = 0;
      while (uVar1 = local_b8, (int)local_b8 < iVar11) {
        if (((1 < (longlong)*ppvVar7 + 2U) && ((*(byte *)piVar9 & 1) != 0)) &&
           (((*(byte *)piVar9 & 8) != 0 || (DVar3 = GetFileType(*ppvVar7), DVar3 != 0)))) {
          ppvVar6 = (HANDLE *)
                    ((ulonglong)(uVar1 & 0x1f) * 0x58 +
                    *(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)uVar1 >> 5) * 8));
          *ppvVar6 = *ppvVar7;
          *(byte *)(ppvVar6 + 1) = *(byte *)piVar9;
          local_b0 = ppvVar6;
          FUN_180027794((LPCRITICAL_SECTION)(ppvVar6 + 2),4000);
          *(int *)((longlong)ppvVar6 + 0xc) = *(int *)((longlong)ppvVar6 + 0xc) + 1;
        }
        piVar9 = (int *)((longlong)piVar9 + 1);
        ppvVar7 = ppvVar7 + 1;
        local_a0 = piVar9;
        local_98 = ppvVar7;
        local_b8 = uVar1 + 1;
      }
    }
    local_b8 = 0;
    while (iVar10 = local_b8, (int)local_b8 < 3) {
      lVar8 = (longlong)(int)local_b8;
      ppvVar7 = DAT_180055c80 + lVar8 * 0xb;
      local_b0 = ppvVar7;
      if ((longlong)*ppvVar7 + 2U < 2) {
        *(undefined *)(ppvVar7 + 1) = 0x81;
        DVar3 = 0xfffffff5 - (local_b8 != 1);
        if (local_b8 == 0) {
          DVar3 = 0xfffffff6;
        }
        hFile = GetStdHandle(DVar3);
        if (((longlong)hFile + 1U < 2) || (DVar3 = GetFileType(hFile), DVar3 == 0)) {
          *(byte *)(ppvVar7 + 1) = *(byte *)(ppvVar7 + 1) | 0x40;
          *ppvVar7 = (HANDLE)0xfffffffffffffffe;
          if (DAT_180056a58 != 0) {
            *(undefined4 *)(*(longlong *)(DAT_180056a58 + lVar8 * 8) + 0x1c) = 0xfffffffe;
          }
        }
        else {
          *ppvVar7 = hFile;
          if ((DVar3 & 0xff) == 2) {
            bVar2 = *(byte *)(ppvVar7 + 1) | 0x40;
LAB_180026fc6:
            *(byte *)(ppvVar7 + 1) = bVar2;
          }
          else {
            if ((DVar3 & 0xff) == 3) {
              bVar2 = *(byte *)(ppvVar7 + 1) | 8;
              goto LAB_180026fc6;
            }
          }
          FUN_180027794((LPCRITICAL_SECTION)(ppvVar7 + 2),4000);
          *(int *)((longlong)ppvVar7 + 0xc) = *(int *)((longlong)ppvVar7 + 0xc) + 1;
        }
      }
      else {
        *(byte *)(ppvVar7 + 1) = *(byte *)(ppvVar7 + 1) | 0x80;
      }
      local_b8 = iVar10 + 1;
    }
    FUN_18002d5f0(0xb);
    uVar4 = 0;
  }
  return uVar4;
}



// Library Function - Single Match
//  _ioterm
// 
// Library: Visual Studio 2012 Release

void _ioterm(void)

{
  void *pvVar1;
  void *pvVar2;
  longlong lVar3;
  void **ppvVar4;
  
  ppvVar4 = (void **)&DAT_180055c80;
  lVar3 = 0x40;
  do {
    pvVar2 = *ppvVar4;
    pvVar1 = pvVar2;
    if (pvVar2 != (void *)0x0) {
      for (; pvVar2 < (void *)((longlong)pvVar1 + 0xb00); pvVar2 = (void *)((longlong)pvVar2 + 0x58)
          ) {
        if (*(int *)((longlong)pvVar2 + 0xc) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)((longlong)pvVar2 + 0x10));
        }
        pvVar1 = *ppvVar4;
      }
      free(*ppvVar4);
      *ppvVar4 = (void *)0x0;
    }
    ppvVar4 = ppvVar4 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _setargv
// 
// Library: Visual Studio 2012 Release

int _setargv(void)

{
  ulonglong uVar1;
  byte **ppbVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong uVar5;
  int local_res8 [2];
  int local_res10 [2];
  
  if (_DAT_180057bc8 == 0) {
    __initmbctable();
  }
  DAT_180055f84 = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_180055e80,0x104);
  _DAT_180055c48 = &DAT_180055e80;
  if ((DAT_180057bd0 == (byte *)0x0) || (pbVar4 = DAT_180057bd0, *DAT_180057bd0 == 0)) {
    pbVar4 = &DAT_180055e80;
  }
  parse_cmdline(pbVar4,(byte **)0x0,(byte *)0x0,local_res8,local_res10);
  uVar5 = SEXT48(local_res8[0]);
  if ((((uVar5 < 0x1fffffffffffffff) &&
       (uVar3 = SEXT48(local_res10[0]), uVar3 != 0xffffffffffffffff)) &&
      (uVar1 = uVar3 + uVar5 * 8, uVar3 <= uVar1)) &&
     (ppbVar2 = (byte **)FUN_180027ce8(uVar1), ppbVar2 != (byte **)0x0)) {
    parse_cmdline(pbVar4,ppbVar2,(byte *)(ppbVar2 + uVar5),local_res8,local_res10);
    _DAT_180055c24 = local_res8[0] + -1;
    DAT_180055c28 = ppbVar2;
    return 0;
  }
  return -1;
}



// Library Function - Single Match
//  parse_cmdline
// 
// Library: Visual Studio 2012 Release

void parse_cmdline(byte *param_1,byte **param_2,byte *param_3,int *param_4,int *param_5)

{
  bool bVar1;
  bool bVar2;
  undefined8 uVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (byte **)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  bVar2 = false;
  do {
    if (*param_1 == 0x22) {
      bVar2 = !bVar2;
      bVar7 = 0x22;
      pbVar5 = param_1 + 1;
    }
    else {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar7 = *param_1;
      pbVar5 = param_1 + 1;
      uVar3 = FUN_18002dc1c((uint)bVar7);
      if ((int)uVar3 != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        pbVar5 = param_1 + 2;
      }
      if (bVar7 == 0) {
        pbVar5 = pbVar5 + -1;
        goto LAB_180027256;
      }
    }
    param_1 = pbVar5;
  } while ((bVar2) || ((bVar7 != 0x20 && (bVar7 != 9))));
  if (param_3 != (byte *)0x0) {
    param_3[-1] = 0;
  }
LAB_180027256:
  bVar2 = false;
  while (pbVar6 = pbVar5, *pbVar5 != 0) {
    for (; (*pbVar6 == 0x20 || (*pbVar6 == 9)); pbVar6 = pbVar6 + 1) {
    }
    if (*pbVar6 == 0) break;
    if (param_2 != (byte **)0x0) {
      *param_2 = param_3;
      param_2 = param_2 + 1;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar1 = true;
      uVar4 = 0;
      for (; *pbVar6 == 0x5c; pbVar6 = pbVar6 + 1) {
        uVar4 = uVar4 + 1;
      }
      pbVar5 = pbVar6;
      if (*pbVar6 == 0x22) {
        if (((uVar4 & 1) == 0) && ((!bVar2 || (pbVar5 = pbVar6 + 1, *pbVar5 != 0x22)))) {
          bVar1 = false;
          bVar2 = !bVar2;
          pbVar5 = pbVar6;
        }
        uVar4 = uVar4 >> 1;
      }
      while (uVar4 != 0) {
        uVar4 = uVar4 - 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar7 = *pbVar5;
      if ((bVar7 == 0) || ((!bVar2 && ((bVar7 == 0x20 || (bVar7 == 9)))))) break;
      if (bVar1) {
        uVar3 = FUN_18002dc1c((int)(char)bVar7);
        if (param_3 == (byte *)0x0) {
          if ((int)uVar3 != 0) {
            pbVar5 = pbVar5 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if ((int)uVar3 != 0) {
            bVar7 = *pbVar5;
            pbVar5 = pbVar5 + 1;
            *param_3 = bVar7;
            param_3 = param_3 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar6 = pbVar5 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (param_2 != (byte **)0x0) {
    *param_2 = (byte *)0x0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _setenvp
// 
// Library: Visual Studio 2012 Release

int _setenvp(void)

{
  char cVar1;
  code *pcVar2;
  errno_t eVar3;
  size_t sVar4;
  char *_Dst;
  char *pcVar5;
  int iVar6;
  char **ppcVar7;
  
  if (_DAT_180057bc8 == 0) {
    __initmbctable();
  }
  iVar6 = 0;
  pcVar5 = DAT_180055680;
  if (DAT_180055680 != (char *)0x0) {
    for (; *pcVar5 != '\0'; pcVar5 = pcVar5 + sVar4 + 1) {
      if (*pcVar5 != '=') {
        iVar6 = iVar6 + 1;
      }
      sVar4 = strlen(pcVar5);
    }
    DAT_180055c38 = (char **)FUN_180027c68((longlong)(iVar6 + 1),8);
    if (DAT_180055c38 != (char **)0x0) {
      cVar1 = *DAT_180055680;
      ppcVar7 = DAT_180055c38;
      pcVar5 = DAT_180055680;
      do {
        if (cVar1 == '\0') {
          free(DAT_180055680);
          DAT_180055680 = (char *)0x0;
          *ppcVar7 = (char *)0x0;
          _DAT_180057bcc = 1;
          return 0;
        }
        sVar4 = strlen(pcVar5);
        iVar6 = (int)sVar4 + 1;
        if (*pcVar5 != '=') {
          _Dst = (char *)FUN_180027c68((longlong)iVar6,1);
          *ppcVar7 = _Dst;
          if (_Dst == (char *)0x0) {
            free(DAT_180055c38);
            DAT_180055c38 = (char **)0x0;
            return -1;
          }
          eVar3 = strcpy_s(_Dst,(longlong)iVar6,pcVar5);
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar2 = (code *)swi(3);
            iVar6 = (*pcVar2)();
            return iVar6;
          }
          ppcVar7 = ppcVar7 + 1;
        }
        pcVar5 = pcVar5 + iVar6;
        cVar1 = *pcVar5;
      } while( true );
    }
  }
  return -1;
}



void FUN_1800274a0(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  uint local_res18;
  undefined4 uStackX28;
  
  local_res10 = (_FILETIME)0x0;
  if (DAT_1800537e8 == 0x2b992ddfa232) {
    GetSystemTimeAsFileTime((LPFILETIME)&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter((LARGE_INTEGER *)&local_res18);
    DAT_1800537e8 =
         ((ulonglong)local_res18 << 0x20 ^ CONCAT44(uStackX28,local_res18) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_1800537e8 == 0x2b992ddfa232) {
      DAT_1800537e8 = 0x2b992ddfa233;
    }
  }
  DAT_1800537f0 = ~DAT_1800537e8;
  return;
}



// Library Function - Single Match
//  __crtGetEnvironmentStringsA
// 
// Library: Visual Studio 2012 Release

LPVOID __crtGetEnvironmentStringsA(void)

{
  WCHAR WVar1;
  int cbMultiByte;
  int iVar2;
  LPWCH lpWideCharStr;
  LPSTR lpMultiByteStr;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  
  lpWideCharStr = GetEnvironmentStringsW();
  if (lpWideCharStr != (LPWCH)0x0) {
    WVar1 = *lpWideCharStr;
    pWVar3 = lpWideCharStr;
    while (WVar1 != L'\0') {
      do {
        pWVar4 = pWVar3;
        pWVar3 = pWVar4 + 1;
      } while (*pWVar3 != L'\0');
      pWVar3 = pWVar4 + 2;
      WVar1 = *pWVar3;
    }
    iVar2 = (int)((longlong)((longlong)pWVar3 - (longlong)lpWideCharStr) >> 1);
    cbMultiByte = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,(LPSTR)0x0,0,(LPCSTR)0x0,
                                      (LPBOOL)0x0);
    if ((cbMultiByte != 0) &&
       (lpMultiByteStr = (LPSTR)FUN_180027ce8((longlong)cbMultiByte), lpMultiByteStr != (LPSTR)0x0))
    {
      iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,lpMultiByteStr,cbMultiByte,(LPCSTR)0x0
                                  ,(LPBOOL)0x0);
      if (iVar2 == 0) {
        free(lpMultiByteStr);
        lpMultiByteStr = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return lpMultiByteStr;
    }
    FreeEnvironmentStringsW(lpWideCharStr);
  }
  return (LPSTR)0x0;
}



// Library Function - Single Match
//  __crtCaptureCurrentContext
// 
// Library: Visual Studio 2012 Release

void __crtCaptureCurrentContext(CONTEXT *pContextRecord)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18;
  
  RtlCaptureContext();
  ControlPc = pContextRecord->Rip;
  FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,(PCONTEXT)pContextRecord,&local_res18,
                     &local_res10,(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  return;
}



// Library Function - Single Match
//  __crtCapturePreviousContext
// 
// Library: Visual Studio 2012 Release

void __crtCapturePreviousContext(CONTEXT *pContextRecord)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];
  
  RtlCaptureContext();
  ControlPc = pContextRecord->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,(PCONTEXT)pContextRecord,local_res18,
                     &local_res10,(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



void FUN_180027724(void)

{
  if ((code *)(DAT_180057aa0 ^ DAT_1800537e8) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180027734. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_180057aa0 ^ DAT_1800537e8))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180027737. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_180027740(void)

{
  if ((code *)(DAT_180057aa8 ^ DAT_1800537e8) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180027750. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_180057aa8 ^ DAT_1800537e8))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180027753. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_18002775c(void)

{
  if ((code *)(DAT_180057ab0 ^ DAT_1800537e8) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018002776c. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_180057ab0 ^ DAT_1800537e8))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002776f. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_180027778(void)

{
  if ((code *)(DAT_180057ab8 ^ DAT_1800537e8) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180027788. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_180057ab8 ^ DAT_1800537e8))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002778b. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsSetValue();
  return;
}



undefined8 FUN_180027794(LPCRITICAL_SECTION param_1,DWORD param_2)

{
  undefined8 uVar1;
  
  if ((code *)(DAT_180057ac0 ^ DAT_1800537e8) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800277ac. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*(code *)(DAT_180057ac0 ^ DAT_1800537e8))();
    return uVar1;
  }
  InitializeCriticalSectionAndSpinCount(param_1,param_2);
  return 1;
}



bool FUN_1800277c0(void)

{
  int iVar1;
  bool bVar2;
  undefined4 local_res8 [8];
  
  bVar2 = DAT_180053868 < 0;
  if (!bVar2) goto LAB_180027801;
  local_res8[0] = 0;
  if ((code *)(DAT_180057b88 ^ DAT_1800537e8) == (code *)0x0) {
LAB_1800277f7:
    DAT_180053868 = 0;
  }
  else {
    iVar1 = (*(code *)(DAT_180057b88 ^ DAT_1800537e8))(local_res8,0);
    DAT_180053868 = 1;
    if (iVar1 != 0x7a) goto LAB_1800277f7;
  }
  bVar2 = false;
LAB_180027801:
  return DAT_180053868 != 0 && !bVar2;
}



undefined8 FUN_180027c08(void)

{
  undefined8 uVar1;
  
  if ((code *)(DAT_180057ad8 ^ DAT_1800537e8) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180027c18. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*(code *)(DAT_180057ad8 ^ DAT_1800537e8))();
    return uVar1;
  }
  return 0;
}



void Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x000180027c20. Too many branches
                    // WARNING: Treating indirect jump as call
  Sleep(dwMilliseconds);
  return;
}



// Library Function - Single Match
//  __crtUnhandledException
// 
// Library: Visual Studio 2012 Release

LONG __crtUnhandledException(EXCEPTION_POINTERS *exceptionInfo)

{
  LONG LVar1;
  
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
                    // WARNING: Could not recover jumptable at 0x000180027c61. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = UnhandledExceptionFilter((_EXCEPTION_POINTERS *)exceptionInfo);
  return LVar1;
}



LPVOID FUN_180027c68(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    pvVar1 = _calloc_impl(param_1,param_2,(undefined4 *)0x0);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (DAT_180055f88 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180055f88 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



void * FUN_180027ce8(size_t param_1)

{
  uint uVar1;
  void *pvVar2;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    uVar1 = DAT_180055f88;
    pvVar2 = malloc(param_1);
    if (pvVar2 != (void *)0x0) {
      return pvVar2;
    }
    if (uVar1 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180055f88 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (void *)0x0;
    }
  }
  return (void *)0x0;
}



void * FUN_180027d64(void *param_1,size_t param_2)

{
  void *pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  do {
    pvVar1 = realloc(param_1,param_2);
    if (pvVar1 != (void *)0x0) {
      return pvVar1;
    }
    if (param_2 == 0) {
      return (void *)0x0;
    }
    if (DAT_180055f88 == 0) {
      return (void *)0x0;
    }
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_180055f88 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
  } while (dwMilliseconds != 0xffffffff);
  return (void *)0x0;
}



void FUN_180027de8(void)

{
  code **ppcVar1;
  
  for (ppcVar1 = (code **)&DAT_18004da10; ppcVar1 < &DAT_18004da10; ppcVar1 = ppcVar1 + 1) {
    if (*ppcVar1 != (code *)0x0) {
      (**ppcVar1)();
    }
  }
  return;
}



undefined8
FUN_180027e58(PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint uVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  BOOL BVar5;
  ulonglong uVar6;
  uint uVar7;
  ulonglong uVar8;
  uint uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  PEXCEPTION_RECORD local_38;
  undefined8 local_30;
  
  lVar2 = param_4[1];
  puVar3 = (uint *)param_4[7];
  uVar11 = *param_4 - lVar2;
  if ((*(byte *)&param_1->ExceptionFlags & 0x66) == 0) {
    local_38 = param_1;
    local_30 = param_3;
    for (uVar7 = *(uint *)(param_4 + 9); uVar7 < *puVar3; uVar7 = uVar7 + 1) {
      uVar8 = (ulonglong)uVar7;
      if (((puVar3[uVar8 * 4 + 1] <= uVar11) && (uVar11 < puVar3[uVar8 * 4 + 2])) &&
         (puVar3[uVar8 * 4 + 4] != 0)) {
        if (puVar3[uVar8 * 4 + 3] != 1) {
          iVar4 = (*(code *)((ulonglong)puVar3[uVar8 * 4 + 3] + lVar2))(&local_38,param_2);
          if (iVar4 < 0) {
            return 0;
          }
          if (iVar4 < 1) goto LAB_180027f65;
        }
        if ((param_1->ExceptionCode == 0xe06d7363) &&
           (BVar5 = _IsNonwritableInCurrentImage((PBYTE)&PTR___DestructExceptionObject_180048770),
           BVar5 != 0)) {
          __DestructExceptionObject((int *)param_1);
        }
        FUN_18002d990();
        RtlUnwindEx(param_2,(PVOID)((ulonglong)puVar3[uVar8 * 4 + 4] + lVar2),param_1,
                    (PVOID)(ulonglong)param_1->ExceptionCode,(PCONTEXT)param_4[5],
                    (PUNWIND_HISTORY_TABLE)param_4[8]);
        FUN_18002d9c0();
      }
LAB_180027f65:
    }
  }
  else {
    uVar8 = param_4[4] - lVar2;
    for (uVar7 = *(uint *)(param_4 + 9); uVar1 = *puVar3, uVar7 < uVar1; uVar7 = uVar7 + 1) {
      uVar6 = (ulonglong)uVar7;
      if ((puVar3[uVar6 * 4 + 1] <= uVar11) && (uVar11 < puVar3[uVar6 * 4 + 2])) {
        if ((*(byte *)&param_1->ExceptionFlags & 0x20) != 0) {
          uVar10 = 0;
          if (uVar1 != 0) {
            do {
              if ((((puVar3[uVar10 * 4 + 1] <= uVar8) && (uVar8 < puVar3[uVar10 * 4 + 2])) &&
                  (puVar3[uVar10 * 4 + 4] == puVar3[uVar6 * 4 + 4])) &&
                 (puVar3[uVar10 * 4 + 3] == puVar3[uVar6 * 4 + 3])) break;
              uVar9 = (int)uVar10 + 1;
              uVar10 = (ulonglong)uVar9;
            } while (uVar9 < uVar1);
          }
          if ((uint)uVar10 != uVar1) {
            return 1;
          }
        }
        if (puVar3[uVar6 * 4 + 4] == 0) {
          *(uint *)(param_4 + 9) = uVar7 + 1;
          (*(code *)((ulonglong)puVar3[uVar6 * 4 + 3] + lVar2))();
        }
        else {
          if (uVar8 == puVar3[uVar6 * 4 + 4]) {
            return 1;
          }
        }
      }
    }
  }
  return 1;
}



// Library Function - Single Match
//  __doserrno
// 
// Library: Visual Studio 2012 Release

ulong * __doserrno(void)

{
  _ptiddata p_Var1;
  ulong *puVar2;
  
  p_Var1 = _getptd_noexit();
  if (p_Var1 == (_ptiddata)0x0) {
    puVar2 = &DAT_1800539dc;
  }
  else {
    puVar2 = &p_Var1->_tdoserrno;
  }
  return puVar2;
}



// Library Function - Single Match
//  _dosmaperr
// 
// Library: Visual Studio 2012 Release

void _dosmaperr(ulong param_1)

{
  int iVar1;
  _ptiddata p_Var2;
  ulong *puVar3;
  int *piVar4;
  
  p_Var2 = _getptd_noexit();
  if (p_Var2 == (_ptiddata)0x0) {
    puVar3 = &DAT_1800539dc;
  }
  else {
    puVar3 = &p_Var2->_tdoserrno;
  }
  *puVar3 = param_1;
  p_Var2 = _getptd_noexit();
  piVar4 = (int *)&DAT_1800539d8;
  if (p_Var2 != (_ptiddata)0x0) {
    piVar4 = &p_Var2->_terrno;
  }
  iVar1 = _get_errno_from_oserr(param_1);
  *piVar4 = iVar1;
  return;
}



// Library Function - Single Match
//  _errno
// 
// Library: Visual Studio 2012 Release

int * _errno(void)

{
  _ptiddata p_Var1;
  int *piVar2;
  
  p_Var1 = _getptd_noexit();
  if (p_Var1 == (_ptiddata)0x0) {
    piVar2 = (int *)&DAT_1800539d8;
  }
  else {
    piVar2 = &p_Var1->_terrno;
  }
  return piVar2;
}



// Library Function - Single Match
//  _get_errno_from_oserr
// 
// Library: Visual Studio 2012 Release

int _get_errno_from_oserr(ulong param_1)

{
  int iVar1;
  uint uVar2;
  ulong *puVar3;
  
  uVar2 = 0;
  puVar3 = &DAT_180053870;
  do {
    if (param_1 == *puVar3) {
      return *(int *)((longlong)&DAT_180053874 + (longlong)(int)uVar2 * 8);
    }
    uVar2 = uVar2 + 1;
    puVar3 = puVar3 + 2;
  } while (uVar2 < 0x2d);
  if (param_1 - 0x13 < 0x12) {
    return 0xd;
  }
  iVar1 = 0x16;
  if (param_1 - 0xbc < 0xf) {
    iVar1 = 8;
  }
  return iVar1;
}



// Library Function - Single Match
//  _callnewh
// 
// Library: Visual Studio 2012 Release

int _callnewh(size_t _Size)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = (code *)DecodePointer(DAT_180055f90);
  if ((pcVar2 != (code *)0x0) && (iVar1 = (*pcVar2)(_Size), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



void FUN_180028150(undefined8 param_1)

{
  DAT_180055f90 = param_1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _FF_MSGBANNER
// 
// Library: Visual Studio 2012 Release

void _FF_MSGBANNER(void)

{
  int iVar1;
  
  iVar1 = _set_error_mode(3);
  if (iVar1 != 1) {
    iVar1 = _set_error_mode(3);
    if (iVar1 != 0) {
      return;
    }
    if (_DAT_180055fa0 != 1) {
      return;
    }
  }
  _NMSG_WRITE(0xfc);
  _NMSG_WRITE(0xff);
  return;
}



// Library Function - Single Match
//  _GET_RTERRMSG
// 
// Library: Visual Studio 2012 Release

wchar_t * _GET_RTERRMSG(int param_1)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = &DAT_180047bc0;
  do {
    if (param_1 == *piVar2) {
      return (wchar_t *)
             (&PTR_u_R6002___floating_point_support_n_180047bc8)[(longlong)(int)uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 4;
  } while (uVar1 < 0x17);
  return (wchar_t *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _NMSG_WRITE
// 
// Library: Visual Studio 2012 Release

void _NMSG_WRITE(int param_1)

{
  code *pcVar1;
  int iVar2;
  errno_t eVar3;
  DWORD DVar4;
  wchar_t *_Src;
  longlong lVar5;
  HANDLE hFile;
  size_t sVar6;
  char *pcVar7;
  uint uVar8;
  DWORD local_238 [4];
  char local_228 [499];
  undefined local_35;
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffd98;
  _Src = _GET_RTERRMSG(param_1);
  uVar8 = 0;
  if (_Src != (wchar_t *)0x0) {
    iVar2 = _set_error_mode(3);
    if (iVar2 != 1) {
      iVar2 = _set_error_mode(3);
      if ((iVar2 != 0) || (_DAT_180055fa0 != 1)) {
        if (param_1 != 0xfc) {
          eVar3 = wcscpy_s((wchar_t *)&DAT_180055fb0,0x314,L"Runtime Error!\n\nProgram: ");
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          _DAT_1800561ea = 0;
          DVar4 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_180055fe2,0x104);
          if (DVar4 == 0) {
            eVar3 = wcscpy_s((wchar_t *)&DAT_180055fe2,0x2fb,L"<program name unknown>");
            if (eVar3 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          lVar5 = FUN_18002de4c((short *)&DAT_180055fe2);
          if (0x3c < lVar5 + 1U) {
            lVar5 = FUN_18002de4c((short *)&DAT_180055fe2);
            eVar3 = wcsncpy_s((wchar_t *)(&DAT_180055f6c + lVar5 * 2),
                              0x2fb - (lVar5 * 2 + -0x76 >> 1),L"...",3);
            if (eVar3 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          eVar3 = wcscat_s((wchar_t *)&DAT_180055fb0,0x314,L"\n\n");
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          eVar3 = wcscat_s((wchar_t *)&DAT_180055fb0,0x314,_Src);
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          FUN_18002df74((LPCWSTR)&DAT_180055fb0,L"Microsoft Visual C++ Runtime Library",0x12010);
        }
        goto LAB_1800283a7;
      }
    }
    hFile = GetStdHandle(0xfffffff4);
    if ((longlong)hFile - 1U < 0xfffffffffffffffe) {
      pcVar7 = local_228;
      do {
        *pcVar7 = *(char *)_Src;
        if (*_Src == L'\0') break;
        uVar8 = uVar8 + 1;
        pcVar7 = pcVar7 + 1;
        _Src = _Src + 1;
      } while (uVar8 < 500);
      local_35 = 0;
      sVar6 = strlen(local_228);
      WriteFile(hFile,local_228,(DWORD)sVar6,local_238,(LPOVERLAPPED)0x0);
    }
  }
LAB_1800283a7:
  FUN_180023ef0(local_28 ^ (ulonglong)&stack0xfffffffffffffd98);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _calloc_impl
// 
// Library: Visual Studio 2012 Release

LPVOID _calloc_impl(ulonglong param_1,ulonglong param_2,undefined4 *param_3)

{
  int iVar1;
  int *piVar2;
  LPVOID pvVar3;
  ulonglong dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_2 * param_1;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar3 = (LPVOID)0x0;
      if ((dwBytes < 0xffffffffffffffe1) &&
         (pvVar3 = HeapAlloc(DAT_180055c78,8,dwBytes), pvVar3 != (LPVOID)0x0)) {
        return pvVar3;
      }
      if (_DAT_1800565d8 == 0) {
        if (param_3 == (undefined4 *)0x0) {
          return pvVar3;
        }
        *param_3 = 0xc;
        return pvVar3;
      }
      iVar1 = _callnewh(dwBytes);
    } while (iVar1 != 0);
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = 0xc;
    }
  }
  else {
    piVar2 = _errno();
    *piVar2 = 0xc;
  }
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  public: __cdecl std::exception::exception(char const * __ptr64 const & __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

exception * __thiscall std::exception::exception(exception *this,char **param_1)

{
  *(undefined8 *)(this + 8) = 0;
  this[0x10] = (exception)0x0;
  *(undefined ***)this = vftable;
  _Copy_str(this,*param_1);
  return this;
}



// Library Function - Single Match
//  public: __cdecl std::exception::exception(char const * __ptr64 const & __ptr64,int) __ptr64
// 
// Library: Visual Studio 2012 Release

exception * __thiscall std::exception::exception(exception *this,char **param_1,int param_2)

{
  char *pcVar1;
  
  *(undefined ***)this = vftable;
  pcVar1 = *param_1;
  this[0x10] = (exception)0x0;
  *(char **)(this + 8) = pcVar1;
  return this;
}



// Library Function - Single Match
//  public: __cdecl std::exception::exception(class std::exception const & __ptr64) __ptr64
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

exception * __thiscall std::exception::exception(exception *this,exception *param_1)

{
  *(undefined8 *)(this + 8) = 0;
  *(undefined ***)this = vftable;
  this[0x10] = (exception)0x0;
  operator_(this,param_1);
  return this;
}



void FUN_180028550(undefined **param_1)

{
  *param_1 = (undefined *)std::exception::vftable;
  std::exception::_Tidy((exception *)param_1);
  return;
}



// Library Function - Single Match
//  public: class std::exception & __ptr64 __cdecl std::exception::operator=(class std::exception
// const & __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

exception * __thiscall std::exception::operator_(exception *this,exception *param_1)

{
  if (this != param_1) {
    _Tidy(this);
    if (param_1[0x10] == (exception)0x0) {
      *(undefined8 *)(this + 8) = *(undefined8 *)(param_1 + 8);
    }
    else {
      _Copy_str(this,*(char **)(param_1 + 8));
    }
  }
  return this;
}



undefined ** FUN_1800285a4(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)std::exception::vftable;
  std::exception::_Tidy((exception *)param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  private: void __cdecl std::exception::_Copy_str(char const * __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

void __thiscall std::exception::_Copy_str(exception *this,char *param_1)

{
  size_t sVar1;
  char *_Dst;
  
  if (param_1 != (char *)0x0) {
    sVar1 = strlen(param_1);
    _Dst = (char *)malloc(sVar1 + 1);
    *(char **)(this + 8) = _Dst;
    if (_Dst != (char *)0x0) {
      strcpy_s(_Dst,sVar1 + 1,param_1);
      this[0x10] = (exception)0x1;
    }
  }
  return;
}



// Library Function - Single Match
//  private: void __cdecl std::exception::_Tidy(void) __ptr64
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void __thiscall std::exception::_Tidy(exception *this)

{
  if (this[0x10] != (exception)0x0) {
    free(*(void **)(this + 8));
  }
  *(undefined8 *)(this + 8) = 0;
  this[0x10] = (exception)0x0;
  return;
}



char * FUN_180028664(longlong param_1)

{
  char *pcVar1;
  
  pcVar1 = "Unknown exception";
  if (*(longlong *)(param_1 + 8) != 0) {
    pcVar1 = *(char **)(param_1 + 8);
  }
  return pcVar1;
}



// Library Function - Single Match
//  _msize
// 
// Library: Visual Studio 2012 Release

size_t _msize(void *_Memory)

{
  int *piVar1;
  size_t sVar2;
  
  if (_Memory == (void *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    FUN_18002add8();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x0001800286aa. Too many branches
                    // WARNING: Treating indirect jump as call
  sVar2 = HeapSize(DAT_180055c78,0,_Memory);
  return sVar2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800286b4(void)

{
  _DAT_180057a80 = 0;
  return;
}



// Library Function - Single Match
//  _call_matherr
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

undefined8
_call_matherr(int param_1,undefined param_2,undefined param_3,undefined param_4,undefined8 param_5,
             undefined8 param_6,undefined8 param_7)

{
  undefined8 uVar1;
  
  _ctrlfp((uint)param_7,0xffc0);
  uVar1 = FUN_18001cbe0();
  if ((int)uVar1 == 0) {
    uVar1 = _set_errno_from_matherr(param_1);
  }
  return uVar1;
}



// Library Function - Single Match
//  _exception_enabled
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

bool _exception_enabled(uint param_1,ulonglong param_2)

{
  uint uVar1;
  
  uVar1 = param_1 & 0x1f;
  if (((param_1 & 8) == 0) || (-1 < (char)param_2)) {
    if (((param_1 & 4) == 0) || ((param_2 & 0x200) == 0)) {
      if (((param_1 & 1) == 0) || ((param_2 & 0x400) == 0)) {
        if (((param_1 & 2) != 0) && ((param_2 & 0x800) != 0)) {
          if ((param_1 & 0x10) != 0) {
            _set_statfp();
          }
          uVar1 = param_1 & 0x1d;
        }
      }
      else {
        _set_statfp();
        uVar1 = param_1 & 0x1e;
      }
    }
    else {
      _set_statfp();
      uVar1 = param_1 & 0x1b;
    }
  }
  else {
    _set_statfp();
    uVar1 = param_1 & 0x17;
  }
  if (((param_1 & 0x10) != 0) && ((param_2 >> 0xc & 1) != 0)) {
    _set_statfp();
    uVar1 = uVar1 & 0xffffffef;
  }
  return uVar1 == 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _handle_error
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

void _handle_error(undefined8 param_1,uint param_2,undefined8 param_3,int param_4,uint param_5,
                  undefined8 param_6,undefined8 param_7,undefined8 param_8,int param_9)

{
  bool bVar1;
  uint uVar2;
  undefined4 extraout_var_00;
  undefined7 extraout_var;
  undefined uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  ulonglong local_d8;
  undefined8 local_d0;
  undefined8 local_c8;
  uint local_b8 [12];
  undefined8 local_88;
  uint local_78;
  ulonglong local_48;
  
  uVar3 = (undefined)param_4;
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffee8;
  uVar2 = _ctrlfp(0x1f80,0xffc0);
  local_d8 = CONCAT44(extraout_var_00,uVar2);
  local_d0 = param_3;
  local_c8 = param_3;
  bVar1 = _exception_enabled(param_5,local_d8);
  uVar4 = (undefined4)param_8;
  uVar5 = (undefined4)((ulonglong)param_8 >> 0x20);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    if (param_9 == 2) {
      local_88 = param_8;
      local_78 = local_78 & 0xffffffe3 | 3;
    }
    uVar3 = (undefined)param_2;
    _raise_exc(local_b8,&local_d8,(ulonglong)param_5,param_2,&param_7,&local_d0);
  }
  if ((_DAT_180054bb4 == 0) && (param_4 != 0)) {
    _call_matherr(param_4,(undefined)param_6,(undefined)param_1,uVar3,CONCAT44(uVar5,uVar4),local_d0
                  ,local_d8);
  }
  else {
    _set_errno_from_matherr(param_4);
    _ctrlfp((uint)local_d8,0xffc0);
  }
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xfffffffffffffee8);
  return;
}



// Library Function - Single Match
//  _cfltcvt_l
// 
// Library: Visual Studio 2012 Release

errno_t _cfltcvt_l(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps,
                  _locale_t plocinfo)

{
  int iVar1;
  
  if ((format - 0x45U & 0xffffffdf) == 0) {
    iVar1 = _cftoe_l(arg,buffer,(undefined *)sizeInBytes,precision,caps,
                     (localeinfo_struct *)plocinfo);
  }
  else {
    if (format == 0x66) {
      iVar1 = _cftof_l(arg,(undefined8 *)buffer,sizeInBytes,precision,(localeinfo_struct *)plocinfo)
      ;
    }
    else {
      if ((format - 0x41U & 0xffffffdf) == 0) {
        iVar1 = FUN_1800289ac((ulonglong *)arg,buffer,(undefined *)sizeInBytes,
                              (ulonglong)(uint)precision,caps,(localeinfo_struct *)plocinfo);
      }
      else {
        iVar1 = _cftog_l(arg,(undefined8 *)buffer,(undefined *)sizeInBytes,precision,caps,
                         (localeinfo_struct *)plocinfo);
      }
    }
  }
  return (errno_t)iVar1;
}



int FUN_1800289ac(ulonglong *param_1,undefined *param_2,undefined *param_3,ulonglong param_4,
                 int param_5,localeinfo_struct *param_6)

{
  undefined (*pauVar1) [16];
  ushort uVar2;
  int iVar3;
  int *piVar4;
  char *pcVar5;
  undefined (*pauVar6) [16];
  longlong lVar7;
  short sVar8;
  longlong lVar9;
  ulonglong uVar10;
  short sVar11;
  undefined (*pauVar12) [16];
  undefined (*pauVar13) [16];
  char *pcVar14;
  undefined *puVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  
  uVar17 = 0x3ff;
  sVar11 = 0x30;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_48,param_6);
  uVar10 = param_4 & 0xffffffff;
  if ((int)(param_4 & 0xffffffff) < 0) {
    uVar10 = 0;
  }
  if ((param_2 == (undefined *)0x0) || (param_3 == (undefined *)0x0)) {
    piVar4 = _errno();
    iVar3 = 0x16;
  }
  else {
    iVar3 = (int)uVar10;
    *param_2 = 0;
    if ((undefined *)(longlong)(iVar3 + 0xb) < param_3) {
      if ((*param_1 >> 0x34 & 0x7ff) == 0x7ff) {
        puVar15 = param_3 + -2;
        if (param_3 == (undefined *)0xffffffffffffffff) {
          puVar15 = param_3;
        }
        iVar3 = _cftoe_l(param_1,param_2 + 2,puVar15,iVar3,0,(localeinfo_struct *)0x0);
        if (iVar3 != 0) {
          *param_2 = 0;
          goto LAB_180028d29;
        }
        if (param_2[2] == '-') {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        pcVar5 = strrchr(param_2 + 2,0x65);
        if (pcVar5 != (char *)0x0) {
          *pcVar5 = (-(param_5 != 0) & 0xe0U) + 0x70;
          pcVar5[3] = '\0';
        }
      }
      else {
        if ((*param_1 & 0x8000000000000000) != 0) {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        sVar8 = (-(ushort)(param_5 != 0) & 0xffe0) + 0x27;
        if ((*param_1 & 0x7ff0000000000000) == 0) {
          param_2[2] = 0x30;
          uVar17 = (ulonglong)(-(uint)((*param_1 & 0xfffffffffffff) != 0) & 0x3fe);
        }
        else {
          param_2[2] = 0x31;
        }
        pauVar12 = (undefined (*) [16])(param_2 + 3);
        pauVar13 = (undefined (*) [16])(param_2 + 4);
        if (iVar3 == 0) {
          (*pauVar12)[0] = 0;
        }
        else {
          (*pauVar12)[0] = *(undefined *)**(undefined8 **)(local_48[0] + 0xf0);
        }
        if ((*param_1 & 0xfffffffffffff) != 0) {
          uVar16 = 0xf000000000000;
          do {
            if ((int)uVar10 < 1) break;
            uVar2 = (short)((*param_1 & uVar16) >> ((byte)sVar11 & 0x3f)) + 0x30;
            if (0x39 < uVar2) {
              uVar2 = uVar2 + sVar8;
            }
            (*pauVar13)[0] = (char)uVar2;
            uVar16 = uVar16 >> 4;
            uVar10 = (ulonglong)((int)uVar10 - 1);
            pauVar13 = (undefined (*) [16])(*pauVar13 + 1);
            sVar11 = sVar11 + -4;
          } while (-1 < sVar11);
          if ((-1 < sVar11) &&
             (pauVar1 = pauVar13, 8 < (ushort)((*param_1 & uVar16) >> ((byte)sVar11 & 0x3f)))) {
            while (pauVar6 = (undefined (*) [16])(pauVar1[-1] + 0xf),
                  ((*pauVar6)[0] + 0xba & 0xdf) == 0) {
              (*pauVar6)[0] = 0x30;
              pauVar1 = pauVar6;
            }
            if (pauVar6 == pauVar12) {
              pauVar1[-1][0xe] = pauVar1[-1][0xe] + '\x01';
            }
            else {
              if ((*pauVar6)[0] == '9') {
                (*pauVar6)[0] = (char)sVar8 + ':';
              }
              else {
                (*pauVar6)[0] = (*pauVar6)[0] + '\x01';
              }
            }
          }
        }
        if (0 < (int)uVar10) {
          FUN_1800244a0(pauVar13,0x30,uVar10);
          pauVar13 = (undefined (*) [16])(*pauVar13 + uVar10);
        }
        if ((*pauVar12)[0] == '\0') {
          pauVar13 = pauVar12;
        }
        (*pauVar13)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
        lVar7 = ((uint)(*param_1 >> 0x34) & 0x7ff) - uVar17;
        if (lVar7 < 0) {
          (*pauVar13)[1] = 0x2d;
          lVar7 = -lVar7;
        }
        else {
          (*pauVar13)[1] = 0x2b;
        }
        pcVar14 = *pauVar13 + 2;
        *pcVar14 = '0';
        pcVar5 = pcVar14;
        if (lVar7 < 1000) {
LAB_180028cb3:
          if (99 < lVar7) goto LAB_180028cb9;
        }
        else {
          *pcVar14 = (char)(lVar7 / 1000) + '0';
          pcVar5 = *pauVar13 + 3;
          lVar7 = lVar7 % 1000;
          if (pcVar5 == pcVar14) goto LAB_180028cb3;
LAB_180028cb9:
          lVar9 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar7) >> 0x40,0) + lVar7;
          lVar9 = (lVar9 >> 6) - (lVar9 >> 0x3f);
          *pcVar5 = (char)lVar9 + '0';
          pcVar5 = pcVar5 + 1;
          lVar7 = lVar7 + lVar9 * -100;
        }
        if ((pcVar5 != pcVar14) || (9 < lVar7)) {
          *pcVar5 = (char)(lVar7 / 10) + '0';
          pcVar5 = pcVar5 + 1;
          lVar7 = lVar7 % 10;
        }
        *pcVar5 = (char)lVar7 + '0';
        pcVar5[1] = '\0';
      }
      iVar3 = 0;
      goto LAB_180028d29;
    }
    piVar4 = _errno();
    iVar3 = 0x22;
  }
  *piVar4 = iVar3;
  FUN_18002add8();
LAB_180028d29:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return iVar3;
}



ulonglong FUN_180028d5c(undefined *param_1,undefined *param_2,int param_3,int param_4,int *param_5,
                       char param_6,localeinfo_struct *param_7)

{
  code *pcVar1;
  errno_t eVar2;
  uint *puVar3;
  size_t sVar4;
  ulonglong uVar5;
  undefined *puVar6;
  uint uVar7;
  undefined8 *_Str;
  char *_Dst;
  int iVar8;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_38,param_7);
  if ((param_1 == (undefined *)0x0) || (param_2 == (undefined *)0x0)) {
    puVar3 = (uint *)_errno();
    uVar7 = 0x16;
  }
  else {
    iVar8 = 0;
    if (0 < param_3) {
      iVar8 = param_3;
    }
    if ((undefined *)(longlong)(iVar8 + 9) < param_2) {
      if (param_6 != '\0') {
        _Str = (undefined8 *)(param_1 + (*param_5 == 0x2d));
        if (0 < param_3 != 0) {
          sVar4 = strlen((char *)_Str);
          FUN_180023f20((undefined8 *)((longlong)(int)(uint)(0 < param_3) + (longlong)_Str),_Str,
                        sVar4 + 1);
        }
      }
      puVar6 = param_1;
      if (*param_5 == 0x2d) {
        *param_1 = 0x2d;
        puVar6 = param_1 + 1;
      }
      if (0 < param_3) {
        *puVar6 = puVar6[1];
        puVar6 = puVar6 + 1;
        *puVar6 = *(undefined *)**(undefined8 **)(local_38[0] + 0xf0);
      }
      _Dst = puVar6 + (ulonglong)(param_6 == '\0') + (longlong)param_3;
      puVar6 = param_2 + (longlong)(param_1 + -(longlong)_Dst);
      if (param_2 == (undefined *)0xffffffffffffffff) {
        puVar6 = param_2;
      }
      eVar2 = strcpy_s(_Dst,(rsize_t)puVar6,"e+000");
      if (eVar2 != 0) {
        _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
        pcVar1 = (code *)swi(3);
        uVar5 = (*pcVar1)();
        return uVar5;
      }
      if (param_4 != 0) {
        *_Dst = 'E';
      }
      if (**(char **)(param_5 + 4) != '0') {
        iVar8 = param_5[1] + -1;
        if (iVar8 < 0) {
          iVar8 = -iVar8;
          _Dst[1] = '-';
        }
        if (99 < iVar8) {
          _Dst[2] = _Dst[2] + (char)(iVar8 / 100);
          iVar8 = iVar8 % 100;
        }
        if (9 < iVar8) {
          _Dst[3] = _Dst[3] + (char)(iVar8 / 10);
          iVar8 = iVar8 % 10;
        }
        _Dst[4] = _Dst[4] + (char)iVar8;
      }
      if (((DAT_1800568e0 & 1) != 0) && (_Dst[2] == '0')) {
        FUN_180023f20((undefined8 *)(_Dst + 2),(undefined8 *)(_Dst + 3),3);
      }
      uVar7 = 0;
      goto LAB_180028f0b;
    }
    puVar3 = (uint *)_errno();
    uVar7 = 0x22;
  }
  *puVar3 = uVar7;
  FUN_18002add8();
LAB_180028f0b:
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (ulonglong)uVar7;
}



// Library Function - Single Match
//  _cftoe_l
// 
// Library: Visual Studio 2012 Release

void _cftoe_l(undefined8 *param_1,undefined *param_2,undefined *param_3,int param_4,int param_5,
             localeinfo_struct *param_6)

{
  errno_t eVar1;
  int *piVar2;
  undefined *_SizeInBytes;
  _strflt local_68;
  char local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff58;
  FUN_18002eb40(*param_1,(int *)&local_68,local_50,0x16);
  if ((param_2 == (undefined *)0x0) || (param_3 == (undefined *)0x0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18002add8();
  }
  else {
    _SizeInBytes = (undefined *)0xffffffffffffffff;
    if (param_3 != (undefined *)0xffffffffffffffff) {
      _SizeInBytes = param_3 + (-(ulonglong)(0 < param_4) - (ulonglong)(local_68.sign == 0x2d));
    }
    eVar1 = _fptostr(param_2 + (ulonglong)(0 < param_4) + (ulonglong)(local_68.sign == 0x2d),
                     (size_t)_SizeInBytes,param_4 + 1,(STRFLT)&local_68);
    if (eVar1 == 0) {
      FUN_180028d5c(param_2,param_3,param_4,param_5,(int *)&local_68,'\0',param_6);
    }
    else {
      *param_2 = 0;
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff58);
  return;
}



// Library Function - Single Match
//  _cftof2_l
// 
// Library: Visual Studio 2012 Release

undefined4
_cftof2_l(undefined8 *param_1,longlong param_2,int param_3,int *param_4,char param_5,
         localeinfo_struct *param_6)

{
  undefined (*_Str) [16];
  int iVar1;
  int *piVar2;
  size_t sVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  undefined8 *_Str_00;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  iVar1 = param_4[1];
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,param_6);
  if ((param_1 == (undefined8 *)0x0) || (param_2 == 0)) {
    piVar2 = _errno();
    uVar6 = 0x16;
    *piVar2 = 0x16;
    FUN_18002add8();
  }
  else {
    if ((param_5 != '\0') && (iVar1 + -1 == param_3)) {
      *(undefined2 *)((longlong)param_1 + (longlong)(iVar1 + -1) + (ulonglong)(*param_4 == 0x2d)) =
           0x30;
    }
    if (*param_4 == 0x2d) {
      *(undefined *)param_1 = 0x2d;
      param_1 = (undefined8 *)((longlong)param_1 + 1);
    }
    if (param_4[1] < 1) {
      sVar3 = strlen((char *)param_1);
      FUN_180023f20((undefined8 *)((longlong)param_1 + 1),param_1,sVar3 + 1);
      *(undefined *)param_1 = 0x30;
      _Str_00 = (undefined8 *)((longlong)param_1 + 1);
    }
    else {
      _Str_00 = (undefined8 *)((longlong)param_1 + (longlong)param_4[1]);
    }
    if (0 < param_3) {
      _Str = (undefined (*) [16])((longlong)_Str_00 + 1);
      sVar3 = strlen((char *)_Str_00);
      FUN_180023f20((undefined8 *)_Str,_Str_00,sVar3 + 1);
      *(undefined *)_Str_00 = *(undefined *)**(undefined8 **)(local_28[0] + 0xf0);
      iVar1 = param_4[1];
      if (iVar1 < 0) {
        iVar4 = -iVar1;
        iVar5 = iVar4;
        if ((param_5 == '\0') && (iVar5 = param_3, SBORROW4(param_3,iVar4) == param_3 + iVar1 < 0))
        {
          iVar5 = iVar4;
        }
        if (iVar5 != 0) {
          sVar3 = strlen((char *)_Str);
          FUN_180023f20((undefined8 *)(*_Str + iVar5),(undefined8 *)_Str,sVar3 + 1);
        }
        FUN_1800244a0(_Str,0x30,(longlong)iVar5);
      }
    }
    uVar6 = 0;
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar6;
}



// Library Function - Single Match
//  _cftof_l
// 
// Library: Visual Studio 2012 Release

void _cftof_l(undefined8 *param_1,undefined8 *param_2,longlong param_3,int param_4,
             localeinfo_struct *param_5)

{
  errno_t eVar1;
  int *piVar2;
  size_t _SizeInBytes;
  _strflt local_68;
  char local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff68;
  FUN_18002eb40(*param_1,(int *)&local_68,local_50,0x16);
  if ((param_2 == (undefined8 *)0x0) || (param_3 == 0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18002add8();
  }
  else {
    _SizeInBytes = 0xffffffffffffffff;
    if (param_3 != -1) {
      _SizeInBytes = param_3 - (ulonglong)(local_68.sign == 0x2d);
    }
    eVar1 = _fptostr((char *)((ulonglong)(local_68.sign == 0x2d) + (longlong)param_2),_SizeInBytes,
                     local_68.decpt + param_4,(STRFLT)&local_68);
    if (eVar1 == 0) {
      _cftof2_l(param_2,param_3,param_4,(int *)&local_68,'\0',param_5);
    }
    else {
      *(undefined *)param_2 = 0;
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff68);
  return;
}



// Library Function - Single Match
//  _cftog_l
// 
// Library: Visual Studio 2012 Release

void _cftog_l(undefined8 *param_1,undefined8 *param_2,undefined *param_3,int param_4,int param_5,
             localeinfo_struct *param_6)

{
  char *_Buf;
  errno_t eVar1;
  int *piVar2;
  undefined *_SizeInBytes;
  char *pcVar3;
  int iVar4;
  _strflt local_68;
  char local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff58;
  FUN_18002eb40(*param_1,(int *)&local_68,local_50,0x16);
  if ((param_2 == (undefined8 *)0x0) || (param_3 == (undefined *)0x0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18002add8();
  }
  else {
    iVar4 = local_68.decpt + -1;
    _SizeInBytes = (undefined *)0xffffffffffffffff;
    _Buf = (char *)((ulonglong)(local_68.sign == 0x2d) + (longlong)param_2);
    if (param_3 != (undefined *)0xffffffffffffffff) {
      _SizeInBytes = param_3 + -(ulonglong)(local_68.sign == 0x2d);
    }
    eVar1 = _fptostr(_Buf,(size_t)_SizeInBytes,param_4,(STRFLT)&local_68);
    if (eVar1 == 0) {
      local_68.decpt = local_68.decpt + -1;
      if ((local_68.decpt < -4) || (param_4 <= local_68.decpt)) {
        FUN_180028d5c((undefined *)param_2,param_3,param_4,param_5,(int *)&local_68,'\x01',param_6);
      }
      else {
        if (iVar4 < local_68.decpt) {
          do {
            pcVar3 = _Buf;
            _Buf = pcVar3 + 1;
          } while (*pcVar3 != '\0');
          pcVar3[-1] = '\0';
        }
        _cftof2_l(param_2,(longlong)param_3,param_4,(int *)&local_68,'\x01',param_6);
      }
    }
    else {
      *(undefined *)param_2 = 0;
    }
  }
  FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff58);
  return;
}



// Library Function - Single Match
//  _cropzeros_l
// 
// Library: Visual Studio 2012 Release

void _cropzeros_l(char *_Buf,_locale_t _Locale)

{
  char cVar1;
  char *pcVar2;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  char *pcVar3;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  cVar1 = *_Buf;
  if (cVar1 != '\0') {
    do {
      if (cVar1 == ***(char ***)(local_28[0] + 0xf0)) break;
      _Buf = _Buf + 1;
      cVar1 = *_Buf;
    } while (cVar1 != '\0');
  }
  if (*_Buf != '\0') {
    do {
      _Buf = _Buf + 1;
      pcVar2 = _Buf;
      if (*_Buf == '\0') break;
    } while ((*_Buf + 0xbbU & 0xdf) != 0);
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + -1;
    } while (*pcVar2 == '0');
    if (*pcVar2 == ***(char ***)(local_28[0] + 0xf0)) {
      pcVar2 = pcVar3 + -2;
    }
    do {
      cVar1 = *_Buf;
      pcVar2 = pcVar2 + 1;
      _Buf = _Buf + 1;
      *pcVar2 = cVar1;
    } while (cVar1 != '\0');
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



// Library Function - Single Match
//  _forcdecpt_l
// 
// Library: Visual Studio 2012 Release

void _forcdecpt_l(char *_Buf,_locale_t _Locale)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  byte bVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  uVar2 = FUN_18002e7e4((int)*_Buf);
  if (uVar2 != 0x65) {
    do {
      _Buf = (char *)((byte *)_Buf + 1);
      iVar3 = isdigit((uint)(byte)*_Buf);
    } while (iVar3 != 0);
  }
  uVar2 = FUN_18002e7e4((int)*_Buf);
  if (uVar2 == 0x78) {
    _Buf = (char *)((byte *)_Buf + 2);
  }
  bVar4 = *_Buf;
  *_Buf = ***(byte ***)(local_28[0] + 0xf0);
  do {
    _Buf = (char *)((byte *)_Buf + 1);
    bVar1 = *_Buf;
    *_Buf = bVar4;
    bVar4 = bVar1;
  } while (*_Buf != 0);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



// Library Function - Single Match
//  _initp_misc_cfltcvt_tab
// 
// Library: Visual Studio 2012 Release

void _initp_misc_cfltcvt_tab(void)

{
  undefined *puVar1;
  undefined **ppuVar2;
  uint uVar3;
  
  uVar3 = 0;
  ppuVar2 = &PTR_LAB_1800539e0;
  do {
    puVar1 = (undefined *)EncodePointer(*ppuVar2);
    uVar3 = uVar3 + 1;
    *ppuVar2 = puVar1;
    ppuVar2 = ppuVar2 + 1;
  } while (uVar3 < 10);
  return;
}



void FUN_18002957c(uint param_1,uint param_2)

{
  DAT_180053a30 = ~param_2 & DAT_180053a30 | param_1 & param_2;
  return;
}



// Library Function - Single Match
//  abort
// 
// Library: Visual Studio 2012 Release

void abort(void)

{
  code *pcVar1;
  BOOL BVar2;
  longlong lVar3;
  undefined *puVar4;
  undefined auStack40 [8];
  undefined auStack32 [32];
  
  puVar4 = auStack40;
  lVar3 = FUN_18002d6e0();
  if (lVar3 != 0) {
    FUN_18002d710(0x16);
  }
  if (((byte)DAT_180053a30 & 2) != 0) {
    BVar2 = IsProcessorFeaturePresent(0x17);
    puVar4 = auStack40;
    if (BVar2 != 0) {
      pcVar1 = (code *)swi(0x29);
      (*pcVar1)();
      puVar4 = auStack32;
    }
    *(undefined8 *)(puVar4 + -8) = 0x1800295e2;
    _call_reportfault(3,0x40000015,1);
  }
  *(undefined8 *)(puVar4 + -8) = 0x1800295ec;
  FUN_180026a3c(3);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800295f0(undefined8 param_1)

{
  DAT_1800565e0 = param_1;
  return;
}



// WARNING: Unknown calling convention yet parameter storage is locked
// Library Function - Single Match
//  void __cdecl _inconsistency(void)
// 
// Library: Visual Studio 2012 Release

void _inconsistency(void)

{
  code *pcVar1;
  _ptiddata p_Var2;
  
  pcVar1 = (code *)DecodePointer(DAT_1800565e8);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  FUN_180029618();
  p_Var2 = _getptd();
  if ((code *)p_Var2->_terminate != (code *)0x0) {
    (*(code *)p_Var2->_terminate)();
  }
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180029618(void)

{
  code *pcVar1;
  _ptiddata p_Var2;
  
  p_Var2 = _getptd();
  if ((code *)p_Var2->_terminate != (code *)0x0) {
    (*(code *)p_Var2->_terminate)();
  }
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_180029638(void)

{
  DAT_1800565e8 = EncodePointer(FUN_180029618);
  return;
}



// Library Function - Single Match
//  __DestructExceptionObject
// 
// Library: Visual Studio 2012 Release

void __DestructExceptionObject(int *param_1)

{
  byte *pbVar1;
  code *pcVar2;
  
  if ((((param_1 != (int *)0x0) && (*param_1 == -0x1f928c9d)) && (param_1[6] == 4)) &&
     ((param_1[8] + 0xe66cfae0U < 3 && (pbVar1 = *(byte **)(param_1 + 0xc), pbVar1 != (byte *)0x0)))
     ) {
    if (*(int *)(pbVar1 + 4) == 0) {
      if (((*pbVar1 & 0x10) != 0) && (**(longlong ***)(param_1 + 10) != (longlong *)0x0)) {
        (**(code **)(***(longlong ***)(param_1 + 10) + 0x10))();
      }
    }
    else {
      pcVar2 = (code *)(*(longlong *)(param_1 + 0xe) + (longlong)*(int *)(pbVar1 + 4));
      (*pcVar2)(*(undefined8 *)(param_1 + 10),pcVar2);
    }
  }
  return;
}



undefined ** FUN_1800296c8(undefined **param_1,exception *param_2)

{
  std::exception::exception((exception *)param_1,param_2);
  *param_1 = (undefined *)std::bad_exception::vftable;
  return param_1;
}



undefined ** FUN_1800296fc(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)std::bad_exception::vftable;
  FUN_180028550(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  void __cdecl CatchIt(struct EHExceptionRecord * __ptr64,unsigned __int64 * __ptr64,struct
// _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,struct _s_HandlerType const * __ptr64,struct _s_CatchableType const * __ptr64,struct
// _s_TryBlockMapEntry const * __ptr64,int,unsigned __int64 * __ptr64,unsigned char,unsigned char)
// 
// Library: Visual Studio 2012 Release

void CatchIt(EHExceptionRecord *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,
            _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,_s_HandlerType *param_6,
            _s_CatchableType *param_7,_s_TryBlockMapEntry *param_8,int param_9,
            unsigned___int64 *param_10,unsigned_char param_11,unsigned_char param_12)

{
  _s_FuncInfo *p_Var1;
  _s_HandlerType *p_Var2;
  void **ppvVar3;
  ulonglong uVar4;
  unsigned___int64 local_res10 [2];
  
  p_Var1 = param_5;
  ppvVar3 = (void **)_GetEstablisherFrame(param_2,param_4,param_5,local_res10);
  p_Var2 = param_6;
  if (param_7 != (_s_CatchableType *)0x0) {
    __BuildCatchObject((longlong)param_1,ppvVar3,(uint *)param_6,(byte *)param_7);
  }
  uVar4 = _GetImageBase();
  FUN_180025774((PVOID *)param_2,(ULONG_PTR)param_1,(ULONG_PTR)param_3,(ULONG_PTR)ppvVar3,
                uVar4 + (longlong)(int)p_Var2->dispOfHandler,param_8->tryLow,(ULONG_PTR)p_Var1,
                (PVOID *)param_4,(byte)param_12);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Single Match
//  void __cdecl FindHandler(struct EHExceptionRecord * __ptr64,unsigned __int64 * __ptr64,struct
// _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,unsigned char,int,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2012 Release

void FindHandler(EHExceptionRecord *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,
                _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,unsigned_char param_6,int param_7
                ,unsigned___int64 *param_8)

{
  code *pcVar1;
  _s_FuncInfo *p_Var2;
  bool bVar3;
  int iVar4;
  int iVar5;
  unsigned_char uVar6;
  _ptiddata p_Var7;
  ulonglong uVar8;
  type_info *this;
  longlong lVar9;
  undefined8 uVar10;
  _s_ESTypeList *p_Var11;
  unsigned___int64 *puVar12;
  _s_ESTypeList *p_Var13;
  type_info *ptVar14;
  type_info *ptVar15;
  _s_HandlerType *p_Var16;
  int *piVar17;
  uint uVar18;
  type_info *ptVar19;
  undefined8 local_res8;
  _CONTEXT *local_res18;
  uint in_stack_ffffffffffffff68;
  uint in_stack_ffffffffffffff70;
  uint local_84;
  uint local_80;
  int local_7c;
  int local_78;
  int *local_70;
  _s_CatchableType *local_68;
  unsigned___int64 local_60 [2];
  undefined **local_58 [4];
  
  p_Var2 = param_5;
  ptVar15 = (type_info *)0x0;
  local_res8 = (char *)((ulonglong)local_res8 & 0xffffffffffffff00);
  bVar3 = false;
  local_res18 = param_3;
  iVar4 = FUN_18002aaf8((longlong)param_5,(longlong *)param_4);
  _GetEstablisherFrame(param_2,param_4,p_Var2,local_60);
  iVar5 = __GetUnwindTryBlock(param_2,param_4,p_Var2);
  if (iVar5 < iVar4) {
    __SetState(local_60,param_4,p_Var2,iVar4);
    __SetUnwindTryBlock(param_2,param_4,p_Var2,iVar4);
  }
  else {
    iVar4 = __GetUnwindTryBlock(param_2,param_4,p_Var2);
  }
  if ((iVar4 < -1) || (p_Var2->maxState <= iVar4)) {
    _inconsistency();
  }
  if (*(int *)param_1 == -0x1f928c9d) {
    if (((*(int *)(param_1 + 0x18) == 4) && (*(int *)(param_1 + 0x20) + 0xe66cfae0U < 3)) &&
       (*(longlong *)(param_1 + 0x30) == 0)) {
      p_Var7 = _getptd();
      if (p_Var7->_curexception == (void *)0x0) {
        return;
      }
      p_Var7 = _getptd();
      param_1 = (EHExceptionRecord *)p_Var7->_curexception;
      p_Var7 = _getptd();
      param_3 = (_CONTEXT *)p_Var7->_curcontext;
      local_res8 = (char *)CONCAT71(local_res8._1_7_,1);
      local_res18 = param_3;
      _SetThrowImageBase(*(ulonglong *)((longlong)param_1 + 0x38));
      iVar5 = _ValidateRead(param_1,1);
      if (iVar5 == 0) {
        _inconsistency();
      }
      if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)((longlong)param_1 + 0x18) == 4)) &&
         ((*(int *)((longlong)param_1 + 0x20) + 0xe66cfae0U < 3 &&
          (*(longlong *)((longlong)param_1 + 0x30) == 0)))) {
        _inconsistency();
      }
      p_Var7 = _getptd();
      if (p_Var7->_curexcspec != (void *)0x0) {
        p_Var7 = _getptd();
        piVar17 = (int *)p_Var7->_curexcspec;
        p_Var7 = _getptd();
        p_Var7->_curexcspec = (void *)0x0;
        uVar6 = IsInExceptionSpec(param_1,(_s_ESTypeList *)piVar17);
        param_3 = local_res18;
        if ((char)uVar6 == '\0') {
          ptVar14 = ptVar15;
          ptVar19 = ptVar15;
          if (0 < *piVar17) {
            do {
              uVar8 = _GetImageBase();
              this = ptVar15;
              if (*(int *)(ptVar14 + (longlong)piVar17[1] + 4 + uVar8) != 0) {
                uVar8 = _GetImageBase();
                iVar4 = *(int *)(ptVar14 + (longlong)piVar17[1] + 4 + uVar8);
                uVar8 = _GetImageBase();
                this = (type_info *)(uVar8 + (longlong)iVar4);
              }
              bVar3 = type_info::operator__
                                (this,(type_info *)&class_std__bad_exception_RTTI_Type_Descriptor);
              if (bVar3 != false) {
                __DestructExceptionObject((int *)param_1);
                local_res8 = "bad exception";
                std::exception::exception((exception *)local_58,(char **)&local_res8);
                local_58[0] = std::bad_exception::vftable;
                FUN_1800251e8((longlong *)local_58,&DAT_180051238);
                pcVar1 = (code *)swi(3);
                (*pcVar1)();
                return;
              }
              uVar18 = (int)ptVar19 + 1;
              ptVar14 = ptVar14 + 0x14;
              ptVar19 = (type_info *)(ulonglong)uVar18;
            } while ((int)uVar18 < *piVar17);
          }
          FUN_180029618();
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
      }
    }
    if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)((longlong)param_1 + 0x18) == 4)) &&
       (*(int *)((longlong)param_1 + 0x20) + 0xe66cfae0U < 3)) {
      if ((p_Var2->nTryBlocks != 0) &&
         (lVar9 = FUN_18002537c(param_2,(longlong)p_Var2,(ulonglong)(uint)param_7,iVar4,&local_84,
                                (int *)&local_80,(longlong *)param_4), local_84 < local_80)) {
        piVar17 = (int *)(lVar9 + 0x10);
        uVar18 = local_80;
        do {
          if ((piVar17[-4] == iVar4 || piVar17[-4] < iVar4) && (iVar4 <= piVar17[-3])) {
            uVar8 = _GetImageBase();
            p_Var16 = (_s_HandlerType *)((longlong)*piVar17 + uVar8);
            for (local_7c = piVar17[-1]; uVar18 = local_80, 0 < local_7c; local_7c = local_7c + -1)
            {
              uVar8 = _GetThrowImageBase();
              local_70 = (int *)(uVar8 + 4 +
                                (longlong)*(int *)(*(longlong *)((longlong)param_1 + 0x30) + 0xc));
              uVar8 = _GetThrowImageBase();
              for (local_78 = *(int *)(uVar8 + (longlong)
                                               *(int *)(*(longlong *)((longlong)param_1 + 0x30) +
                                                       0xc)); 0 < local_78; local_78 = local_78 + -1
                  ) {
                uVar8 = _GetThrowImageBase();
                local_68 = (_s_CatchableType *)(uVar8 + (longlong)*local_70);
                uVar10 = FUN_18002a92c((byte *)p_Var16,(byte *)local_68,
                                       *(byte **)((longlong)param_1 + 0x30));
                if ((int)uVar10 != 0) {
                  in_stack_ffffffffffffff70 =
                       in_stack_ffffffffffffff70 & 0xffffff00 | param_6 & 0xff;
                  in_stack_ffffffffffffff68 =
                       in_stack_ffffffffffffff68 & 0xffffff00 | (uint)(byte)local_res8;
                  bVar3 = true;
                  CatchIt(param_1,param_2,local_res18,param_4,p_Var2,p_Var16,local_68,
                          (_s_TryBlockMapEntry *)(piVar17 + -4),param_7,param_8,
                          in_stack_ffffffffffffff68,in_stack_ffffffffffffff70);
                  uVar18 = local_80;
                  goto LAB_180029b55;
                }
                local_70 = local_70 + 1;
              }
              p_Var16 = p_Var16 + 1;
            }
          }
LAB_180029b55:
          local_84 = local_84 + 1;
          piVar17 = piVar17 + 5;
        } while (local_84 < uVar18);
        if (bVar3) goto LAB_180029c00;
      }
      p_Var13 = (_s_ESTypeList *)0x0;
      if (0x19930520 < (p_Var2->magicNumber_and_bbtFlags & 0x1fffffff)) {
        iVar4 = p_Var2->dispESTypeList;
        p_Var11 = p_Var13;
        if (iVar4 != 0) {
          uVar8 = _GetImageBase();
          p_Var11 = (_s_ESTypeList *)(uVar8 + (longlong)iVar4);
        }
        if (p_Var11 != (_s_ESTypeList *)0x0) {
          if (iVar4 != 0) {
            uVar8 = _GetImageBase();
            p_Var13 = (_s_ESTypeList *)(uVar8 + (longlong)(int)p_Var2->dispESTypeList);
          }
          uVar6 = IsInExceptionSpec(param_1,p_Var13);
          if ((char)uVar6 == '\0') {
            puVar12 = _GetEstablisherFrame(param_2,param_4,p_Var2,(unsigned___int64 *)&local_res8);
            FUN_180025774((PVOID *)param_2,(ULONG_PTR)param_1,(ULONG_PTR)local_res18,
                          (ULONG_PTR)puVar12,0,-1,(ULONG_PTR)p_Var2,(PVOID *)param_4,(byte)param_6);
          }
        }
      }
      goto LAB_180029c00;
    }
  }
  if (p_Var2->nTryBlocks != 0) {
    if ((char)param_6 != '\0') {
      FUN_180029618();
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    FindHandlerForForeignException(param_1,param_2,param_3,param_4,p_Var2,iVar4,param_7,param_8);
  }
LAB_180029c00:
  p_Var7 = _getptd();
  if (p_Var7->_curexcspec != (void *)0x0) {
    _inconsistency();
  }
  return;
}



// Library Function - Single Match
//  void __cdecl FindHandlerForForeignException(struct EHExceptionRecord * __ptr64,unsigned __int64
// * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo
// const * __ptr64,int,int,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2012 Release

void FindHandlerForForeignException
               (EHExceptionRecord *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,
               _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,int param_6,int param_7,
               unsigned___int64 *param_8)

{
  int iVar1;
  _s_FuncInfo *p_Var2;
  int iVar3;
  _ptiddata p_Var4;
  PVOID pvVar5;
  longlong lVar6;
  ulonglong uVar7;
  uint uVar8;
  int *piVar9;
  uint local_res8 [2];
  _CONTEXT *local_res18;
  unsigned_char in_stack_ffffffffffffffa8;
  uint in_stack_ffffffffffffffb0;
  uint local_48 [4];
  
  if (*(int *)param_1 != -0x7ffffffd) {
    local_res18 = param_3;
    p_Var4 = _getptd();
    p_Var2 = param_5;
    uVar8 = param_7;
    if (p_Var4->_translator != (void *)0x0) {
      pvVar5 = EncodePointer((PVOID)0x0);
      p_Var4 = _getptd();
      uVar8 = param_7;
      if ((((p_Var4->_translator != pvVar5) && (*(int *)param_1 != -0x1fbcb0b3)) &&
          (*(int *)param_1 != -0x1fbcbcae)) &&
         (iVar3 = _CallSETranslator((undefined4 *)param_1,param_2,param_3), iVar3 != 0)) {
        return;
      }
    }
    if (p_Var2->nTryBlocks == 0) {
      _inconsistency();
    }
    iVar3 = param_6;
    lVar6 = FUN_18002537c(param_2,(longlong)p_Var2,(ulonglong)uVar8,param_6,local_res8,
                          (int *)local_48,(longlong *)param_4);
    if (local_res8[0] < local_48[0]) {
      piVar9 = (int *)(lVar6 + 0xc);
      do {
        if ((((_s_TryBlockMapEntry *)(piVar9 + -3))->tryLow <= iVar3) && (iVar3 <= piVar9[-2])) {
          uVar7 = _GetImageBase();
          if (*(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14) == 0) {
            lVar6 = 0;
          }
          else {
            uVar7 = _GetImageBase();
            iVar1 = *(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14);
            uVar7 = _GetImageBase();
            lVar6 = uVar7 + (longlong)iVar1;
          }
          if (lVar6 != 0) {
            uVar7 = _GetImageBase();
            if (*(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14) == 0) {
              lVar6 = 0;
            }
            else {
              uVar7 = _GetImageBase();
              iVar1 = *(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14);
              uVar7 = _GetImageBase();
              lVar6 = uVar7 + (longlong)iVar1;
            }
            if (*(char *)(lVar6 + 0x10) != '\0') goto LAB_180029ee6;
          }
          uVar7 = _GetImageBase();
          if ((*(byte *)((uVar7 - 0x14) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14) & 0x40) ==
              0) {
            uVar7 = _GetImageBase();
            in_stack_ffffffffffffffb0 = in_stack_ffffffffffffffb0 & 0xffffff00;
            in_stack_ffffffffffffffa8 = CONCAT31((int3)(in_stack_ffffffffffffffa8 >> 8),1);
            CatchIt(param_1,param_2,local_res18,param_4,p_Var2,
                    (_s_HandlerType *)
                    (uVar7 + (longlong)(*piVar9 + -1) * 0x14 + (longlong)piVar9[1]),
                    (_s_CatchableType *)0x0,(_s_TryBlockMapEntry *)(piVar9 + -3),param_7,param_8,
                    in_stack_ffffffffffffffa8,in_stack_ffffffffffffffb0);
          }
        }
LAB_180029ee6:
        local_res8[0] = local_res8[0] + 1;
        piVar9 = piVar9 + 5;
      } while (local_res8[0] < local_48[0]);
    }
  }
  return;
}



// Library Function - Single Match
//  unsigned char __cdecl IsInExceptionSpec(struct EHExceptionRecord * __ptr64,struct _s_ESTypeList
// const * __ptr64)
// 
// Library: Visual Studio 2012 Release

unsigned_char IsInExceptionSpec(EHExceptionRecord *param_1,_s_ESTypeList *param_2)

{
  int iVar1;
  code *pcVar2;
  uint in_EAX;
  unsigned_char uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  byte bVar9;
  byte bVar10;
  int *piVar11;
  
  if (param_2 == (_s_ESTypeList *)0x0) {
    _inconsistency();
    FUN_180029618();
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  iVar8 = 0;
  bVar9 = 0;
  bVar10 = 0;
  if (0 < *(int *)param_2) {
    do {
      uVar4 = _GetThrowImageBase();
      piVar11 = (int *)((longlong)*(int *)(*(longlong *)(param_1 + 0x30) + 0xc) + 4 + uVar4);
      uVar4 = _GetThrowImageBase();
      lVar6 = *(longlong *)(param_1 + 0x30);
      iVar7 = *(int *)(uVar4 + (longlong)*(int *)(lVar6 + 0xc));
      bVar9 = bVar10;
      if (0 < iVar7) {
        do {
          uVar4 = _GetThrowImageBase();
          iVar1 = *piVar11;
          uVar5 = _GetImageBase();
          lVar6 = FUN_18002a92c((byte *)((longlong)*(int *)(param_2 + 4) +
                                        uVar5 + (longlong)iVar8 * 0x14),
                                (byte *)(uVar4 + (longlong)iVar1),*(byte **)(param_1 + 0x30));
          if ((int)lVar6 != 0) {
            bVar9 = 1;
            break;
          }
          iVar7 = iVar7 + -1;
          piVar11 = piVar11 + 1;
        } while (0 < iVar7);
      }
      in_EAX = (uint)lVar6;
      iVar8 = iVar8 + 1;
      bVar10 = bVar9;
    } while (iVar8 < *(int *)param_2);
  }
  return (unsigned_char)(in_EAX & 0xffffff00 | (uint)bVar9);
}



// Library Function - Single Match
//  __AdjustPointer
// 
// Library: Visual Studio 2012 Release

longlong __AdjustPointer(longlong param_1,int *param_2)

{
  longlong lVar1;
  
  lVar1 = *param_2 + param_1;
  if (-1 < param_2[1]) {
    lVar1 = lVar1 + (longlong)*(int *)((longlong)param_2[2] + *(longlong *)(param_2[1] + param_1)) +
                    (longlong)param_2[1];
  }
  return lVar1;
}



// Library Function - Single Match
//  __BuildCatchObject
// 
// Library: Visual Studio 2012 Release

void __BuildCatchObject(longlong param_1,void **param_2,uint *param_3,byte *param_4)

{
  char cVar1;
  int iVar2;
  undefined7 extraout_var;
  ulonglong uVar3;
  longlong lVar4;
  code *pcVar5;
  void **ppvVar6;
  
  ppvVar6 = param_2;
  if ((*param_3 & 0x80000000) == 0) {
    ppvVar6 = (void **)((longlong)(int)param_3[2] + (longlong)*param_2);
  }
  cVar1 = FUN_18002a0cc(param_1,param_2,param_3,param_4);
  iVar2 = (int)CONCAT71(extraout_var,cVar1);
  if (iVar2 == 1) {
    pcVar5 = (code *)0x0;
    if (*(int *)(param_4 + 0x18) != 0) {
      uVar3 = _GetThrowImageBase();
      pcVar5 = (code *)((longlong)*(int *)(param_4 + 0x18) + uVar3);
    }
    lVar4 = __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    (*pcVar5)(ppvVar6,lVar4);
  }
  else {
    if (iVar2 == 2) {
      pcVar5 = (code *)0x0;
      if (*(int *)(param_4 + 0x18) != 0) {
        uVar3 = _GetThrowImageBase();
        pcVar5 = (code *)(uVar3 + (longlong)*(int *)(param_4 + 0x18));
      }
      lVar4 = __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
      (*pcVar5)(ppvVar6,lVar4,1);
    }
  }
  return;
}



char FUN_18002a0cc(longlong param_1,void **param_2,uint *param_3,byte *param_4)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  void *pvVar4;
  void *pvVar5;
  undefined8 *puVar6;
  void *pvVar7;
  unsigned_int uVar8;
  
  pvVar7 = (void *)0x0;
  uVar1 = param_3[1];
  pvVar5 = pvVar7;
  if (uVar1 != 0) {
    uVar3 = _GetImageBase();
    pvVar5 = (void *)((longlong)(int)uVar1 + uVar3);
  }
  if (pvVar5 == (void *)0x0) {
    return '\0';
  }
  pvVar5 = pvVar7;
  if (uVar1 != 0) {
    uVar3 = _GetImageBase();
    pvVar5 = (void *)(uVar3 + (longlong)(int)param_3[1]);
  }
  if (*(char *)((longlong)pvVar5 + 0x10) == '\0') {
    return '\0';
  }
  if ((param_3[2] == 0) && ((*param_3 & 0x80000000) == 0)) {
    return '\0';
  }
  uVar1 = *param_3;
  if (-1 < (int)uVar1) {
    param_2 = (void **)((longlong)(int)param_3[2] + (longlong)*param_2);
  }
  pvVar5 = pvVar7;
  if ((((char)uVar1 < '\0') && ((*param_4 & 0x10) != 0)) && (DAT_1800565f0 != (code *)0x0)) {
    pvVar4 = (void *)(*DAT_1800565f0)();
    iVar2 = _ValidateRead(pvVar4,1);
    if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
      *param_2 = pvVar4;
LAB_18002a1a4:
      pvVar5 = (void *)__AdjustPointer((longlong)pvVar4,(int *)(param_4 + 8));
      *param_2 = pvVar5;
      pvVar5 = pvVar7;
      goto LAB_18002a2f5;
    }
  }
  else {
    if ((uVar1 & 8) == 0) {
      if ((*param_4 & 1) == 0) {
        pvVar4 = pvVar7;
        if (*(int *)(param_4 + 0x18) != 0) {
          uVar3 = _GetThrowImageBase();
          pvVar4 = (void *)(uVar3 + (longlong)*(int *)(param_4 + 0x18));
        }
        if (pvVar4 == (void *)0x0) {
          iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
          if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
            iVar2 = *(int *)(param_4 + 0x14);
            puVar6 = (undefined8 *)
                     __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
            FUN_180023f20(param_2,puVar6,(longlong)iVar2);
            pvVar5 = (void *)0x0;
            goto LAB_18002a2f5;
          }
        }
        else {
          iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
          if (iVar2 != 0) {
            uVar8 = 1;
            iVar2 = _ValidateRead(param_2,1);
            if (iVar2 != 0) {
              if (*(int *)(param_4 + 0x18) != 0) {
                uVar3 = _GetThrowImageBase();
                pvVar7 = (void *)(uVar3 + (longlong)*(int *)(param_4 + 0x18));
              }
              iVar2 = _ValidateRead(pvVar7,uVar8);
              if (iVar2 != 0) {
                pvVar5 = (void *)(ulonglong)(((*param_4 & 4) != 0) + 1);
                goto LAB_18002a2f5;
              }
            }
          }
        }
      }
      else {
        iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
        if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
          FUN_180023f20(param_2,*(undefined8 **)(param_1 + 0x28),(longlong)*(int *)(param_4 + 0x14))
          ;
          if ((*(int *)(param_4 + 0x14) != 8) || (pvVar5 = (void *)0x0, *param_2 == (void *)0x0))
          goto LAB_18002a2f5;
          pvVar4 = *param_2;
          goto LAB_18002a1a4;
        }
      }
    }
    else {
      iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
      if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
        pvVar4 = *(void **)(param_1 + 0x28);
        *param_2 = pvVar4;
        goto LAB_18002a1a4;
      }
    }
  }
  _inconsistency();
LAB_18002a2f5:
  return (char)pvVar5;
}



// Library Function - Single Match
//  __FrameUnwindFilter
// 
// Library: Visual Studio 2012 Release

undefined8 __FrameUnwindFilter(int **param_1)

{
  int *piVar1;
  code *pcVar2;
  _ptiddata p_Var3;
  undefined8 uVar4;
  
  piVar1 = *param_1;
  if ((*piVar1 == -0x1fbcbcae) || (*piVar1 == -0x1fbcb0b3)) {
    p_Var3 = _getptd();
    if (0 < p_Var3->_ProcessingThrow) {
      p_Var3 = _getptd();
      p_Var3->_ProcessingThrow = p_Var3->_ProcessingThrow + -1;
    }
  }
  else {
    if (*piVar1 == -0x1f928c9d) {
      p_Var3 = _getptd();
      p_Var3->_ProcessingThrow = 0;
      FUN_180029618();
      pcVar2 = (code *)swi(3);
      uVar4 = (*pcVar2)();
      return uVar4;
    }
  }
  return 0;
}



// Library Function - Single Match
//  __FrameUnwindToState
// 
// Library: Visual Studio 2012 Release

void __FrameUnwindToState
               (unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
               int param_4)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  _ptiddata p_Var4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  
  uVar3 = _GetImageBase();
  iVar2 = __GetCurrentState(param_1,param_2,param_3);
  p_Var4 = _getptd();
  p_Var4->_ProcessingThrow = p_Var4->_ProcessingThrow + 1;
  while ((iVar2 != -1 && (param_4 < iVar2))) {
    if ((iVar2 < 0) || (param_3->maxState <= iVar2)) {
      _inconsistency();
    }
    lVar7 = (longlong)iVar2;
    uVar5 = _GetImageBase();
    iVar2 = *(int *)((longlong)(int)param_3->dispUnwindMap + uVar5 + lVar7 * 8);
    uVar5 = _GetImageBase();
    if (*(int *)((longlong)(int)param_3->dispUnwindMap + 4 + uVar5 + lVar7 * 8) == 0) {
      lVar6 = 0;
    }
    else {
      uVar5 = _GetImageBase();
      iVar1 = *(int *)((longlong)(int)param_3->dispUnwindMap + 4 + uVar5 + lVar7 * 8);
      uVar5 = _GetImageBase();
      lVar6 = uVar5 + (longlong)iVar1;
    }
    if (lVar6 != 0) {
      __SetState(param_1,param_2,param_3,iVar2);
      uVar5 = _GetImageBase();
      if (*(int *)((longlong)(int)param_3->dispUnwindMap + 4 + uVar5 + lVar7 * 8) != 0) {
        _GetImageBase();
        _GetImageBase();
      }
      _CallSettingFrame();
      _SetImageBase(uVar3);
    }
  }
  p_Var4 = _getptd();
  if (0 < p_Var4->_ProcessingThrow) {
    p_Var4 = _getptd();
    p_Var4->_ProcessingThrow = p_Var4->_ProcessingThrow + -1;
  }
  if ((iVar2 != -1) && (param_4 < iVar2)) {
    _inconsistency();
  }
  __SetState(param_1,param_2,param_3,iVar2);
  return;
}



// Library Function - Single Match
//  __InternalCxxFrameHandler
// 
// Library: Visual Studio 2012 Release

undefined8
__InternalCxxFrameHandler
          (int *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4,
          _s_FuncInfo *param_5,int param_6,unsigned___int64 *param_7,byte param_8)

{
  uint uVar1;
  int iVar2;
  _ptiddata p_Var3;
  ulonglong uVar4;
  longlong lVar5;
  undefined8 uVar6;
  code *pcVar7;
  uint in_stack_ffffffffffffffd0;
  undefined8 in_stack_ffffffffffffffe0;
  undefined4 uVar8;
  
  uVar8 = (undefined4)((ulonglong)in_stack_ffffffffffffffe0 >> 0x20);
  p_Var3 = _getptd();
  if (((((*(int *)&p_Var3->_reserved4 != 0) || (*param_1 == -0x1f928c9d)) ||
       ((*param_1 == -0x7fffffd7 &&
        ((param_1[6] == 0xf && (*(longlong *)(param_1 + 0x18) == 0x19930520)))))) ||
      (*param_1 == -0x7fffffda)) ||
     (((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930522 ||
      ((*(byte *)&param_5->EHFlags & 1) == 0)))) {
    if ((param_1[1] & 0x66U) == 0) {
      if (param_5->nTryBlocks == 0) {
        if ((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930521) {
          return 1;
        }
        if (param_5->dispESTypeList == 0) {
          lVar5 = 0;
        }
        else {
          uVar4 = _GetImageBase();
          lVar5 = uVar4 + (longlong)(int)param_5->dispESTypeList;
        }
        if (lVar5 == 0) {
          return 1;
        }
      }
      if (((*param_1 == -0x1f928c9d) && (2 < (uint)param_1[6])) && (0x19930522 < (uint)param_1[8]))
      {
        if (*(int *)(*(longlong *)(param_1 + 0xc) + 8) == 0) {
          pcVar7 = (code *)0x0;
        }
        else {
          uVar4 = _GetThrowImageBase();
          pcVar7 = (code *)((longlong)*(int *)(*(longlong *)(param_1 + 0xc) + 8) + uVar4);
        }
        if (pcVar7 != (code *)0x0) {
          uVar6 = (*pcVar7)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,
                            CONCAT44(uVar8,(uint)param_8));
          return uVar6;
        }
      }
      FindHandler((EHExceptionRecord *)param_1,param_2,param_3,param_4,param_5,
                  in_stack_ffffffffffffffd0 & 0xffffff00 | (uint)param_8,param_6,param_7);
    }
    else {
      if ((param_5->maxState != 0) && (param_6 == 0)) {
        uVar1 = param_1[1] & 0x20;
        if ((uVar1 == 0) || (*param_1 != -0x7fffffda)) {
          if ((uVar1 == 0) || (*param_1 != -0x7fffffd7)) {
            __FrameUnwindToEmptyState(param_2,param_4,param_5);
            return 1;
          }
          iVar2 = param_1[0xe];
          if ((iVar2 < -1) || (param_5->maxState <= iVar2)) {
            _inconsistency();
          }
          param_2 = *(unsigned___int64 **)(param_1 + 10);
        }
        else {
          iVar2 = FUN_18002ab00((longlong)param_5,(longlong)param_4,param_3->Rip);
          if ((iVar2 < -1) || (param_5->maxState <= iVar2)) {
            _inconsistency();
          }
        }
        __FrameUnwindToState(param_2,param_4,param_5,iVar2);
      }
    }
  }
  return 1;
}



undefined8 FUN_18002a92c(byte *param_1,byte *param_2,byte *param_3)

{
  int iVar1;
  ulonglong uVar2;
  longlong lVar3;
  longlong lVar4;
  
  iVar1 = *(int *)(param_1 + 4);
  lVar4 = 0;
  lVar3 = lVar4;
  if (iVar1 != 0) {
    uVar2 = _GetImageBase();
    lVar3 = (longlong)iVar1 + uVar2;
  }
  if (lVar3 != 0) {
    lVar3 = lVar4;
    if (iVar1 != 0) {
      iVar1 = *(int *)(param_1 + 4);
      uVar2 = _GetImageBase();
      lVar3 = (longlong)iVar1 + uVar2;
    }
    if ((*(char *)(lVar3 + 0x10) != '\0') && (((*param_1 & 0x80) == 0 || ((*param_2 & 0x10) == 0))))
    {
      lVar3 = lVar4;
      if (iVar1 != 0) {
        uVar2 = _GetImageBase();
        lVar3 = uVar2 + (longlong)*(int *)(param_1 + 4);
      }
      uVar2 = _GetThrowImageBase();
      if (lVar3 != uVar2 + (longlong)*(int *)(param_2 + 4)) {
        if (*(int *)(param_1 + 4) != 0) {
          uVar2 = _GetImageBase();
          lVar4 = uVar2 + (longlong)*(int *)(param_1 + 4);
        }
        uVar2 = _GetThrowImageBase();
        iVar1 = strcmp((char *)(lVar4 + 0x10),
                       (char *)((longlong)*(int *)(param_2 + 4) + 0x10 + uVar2));
        if (iVar1 != 0) {
          return 0;
        }
      }
      if (((*param_2 & 2) != 0) && ((*param_1 & 8) == 0)) {
        return 0;
      }
      if (((*param_3 & 1) != 0) && ((*param_1 & 1) == 0)) {
        return 0;
      }
      if (((*param_3 & 4) != 0) && ((*param_1 & 4) == 0)) {
        return 0;
      }
      if (((*param_3 & 2) != 0) && ((*param_1 & 2) == 0)) {
        return 0;
      }
      return 1;
    }
  }
  return 1;
}



// Library Function - Single Match
//  int __cdecl __GetCurrentState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2012 Release

int __GetCurrentState(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  
  iVar1 = *(int *)((longlong)param_3->dispUnwindHelp + *(longlong *)param_1);
  if (iVar1 == -2) {
    iVar1 = FUN_18002ab00((longlong)param_3,(longlong)param_2,*(longlong *)param_2);
  }
  return iVar1;
}



// Library Function - Single Match
//  int __cdecl __GetUnwindTryBlock(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2012 Release

int __GetUnwindTryBlock(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3
                       )

{
  longlong *plVar1;
  unsigned___int64 local_res18 [4];
  
  plVar1 = (longlong *)_GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  return *(int *)((longlong)param_3->dispUnwindHelp + 4 + *plVar1);
}



// Library Function - Single Match
//  void __cdecl __SetState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// _s_FuncInfo const * __ptr64,int)
// 
// Library: Visual Studio 2012 Release

void __SetState(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
               int param_4)

{
  *(int *)((longlong)param_3->dispUnwindHelp + *(longlong *)param_1) = param_4;
  return;
}



// Library Function - Single Match
//  void __cdecl __SetUnwindTryBlock(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64,int)
// 
// Library: Visual Studio 2012 Release

void __SetUnwindTryBlock(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,
                        _s_FuncInfo *param_3,int param_4)

{
  longlong *plVar1;
  unsigned___int64 local_res18 [4];
  
  plVar1 = (longlong *)_GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  if (*(int *)((longlong)param_3->dispUnwindHelp + 4 + *plVar1) < param_4) {
    *(int *)((longlong)param_3->dispUnwindHelp + 4 + *plVar1) = param_4;
  }
  return;
}



void FUN_18002aaf8(longlong param_1,longlong *param_2)

{
  FUN_18002ab00(param_1,(longlong)param_2,*param_2);
  return;
}



undefined4 FUN_18002ab00(longlong param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if (param_1 == 0) {
    _inconsistency();
  }
  uVar1 = *(uint *)(param_1 + 0x14);
  if ((longlong)*(int *)(param_1 + 0x18) + *(longlong *)(param_2 + 8) == 0) {
    _inconsistency();
  }
  uVar4 = 0;
  if (uVar1 != 0) {
    lVar2 = *(longlong *)(param_2 + 8);
    do {
      if (param_3 < *(int *)(lVar2 + uVar4 * 8 + (longlong)*(int *)(param_1 + 0x18)) + lVar2) break;
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulonglong)uVar3;
    } while (uVar3 < uVar1);
    if ((int)uVar4 != 0) {
      return *(undefined4 *)
              (lVar2 + (ulonglong)((int)uVar4 - 1) * 8 + 4 + (longlong)*(int *)(param_1 + 0x18));
    }
  }
  return 0xffffffff;
}



// Library Function - Single Match
//  strcmp
// 
// Library: Visual Studio 2012 Release

int strcmp(char *_Str1,char *_Str2)

{
  byte bVar1;
  ulonglong uVar2;
  char *pcVar3;
  
  pcVar3 = _Str2 + -(longlong)_Str1;
  uVar2 = (ulonglong)_Str1 & 7;
  while( true ) {
    if (uVar2 == 0) {
      while ((((int)_Str1 + (int)pcVar3 & 0xfffU) < 0xff9 &&
             (uVar2 = *(ulonglong *)_Str1,
             uVar2 == *(ulonglong *)((longlong)_Str1 + (longlong)pcVar3)))) {
        _Str1 = (char *)((longlong)_Str1 + 8);
        if ((~uVar2 & uVar2 + 0xfefefefefefefeff & 0x8080808080808080) != 0) {
          return 0;
        }
      }
    }
    bVar1 = *_Str1;
    if (bVar1 != *(byte *)((longlong)_Str1 + (longlong)pcVar3)) break;
    _Str1 = (char *)((longlong)_Str1 + 1);
    if (bVar1 == 0) {
      return 0;
    }
    uVar2 = (ulonglong)_Str1 & 7;
  }
  return (int)(-(uint)(bVar1 < *(byte *)((longlong)_Str1 + (longlong)pcVar3)) | 1);
}



// Library Function - Single Match
//  private: static void __cdecl type_info::_Type_info_dtor(class type_info * __ptr64)
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void type_info::_Type_info_dtor(type_info *param_1)

{
  longlong *_Memory;
  longlong *plVar1;
  longlong *plVar2;
  
  _lock(0xe);
  _Memory = DAT_180056600;
  if (*(longlong *)(param_1 + 8) != 0) {
    plVar1 = (longlong *)&DAT_1800565f8;
    do {
      plVar2 = plVar1;
      if (DAT_180056600 == (longlong *)0x0) goto LAB_18002ac56;
      plVar1 = DAT_180056600;
    } while (*DAT_180056600 != *(longlong *)(param_1 + 8));
    plVar2[1] = DAT_180056600[1];
    free(_Memory);
LAB_18002ac56:
    free(*(void **)(param_1 + 8));
    *(undefined8 *)(param_1 + 8) = 0;
  }
  FUN_18002d5f0(0xe);
  return;
}



// Library Function - Single Match
//  _call_reportfault
// 
// Library: Visual Studio 2012 Release

void _call_reportfault(int nDbgHookCode,DWORD dwExceptionCode,DWORD dwExceptionFlags)

{
  BOOL BVar1;
  LONG LVar2;
  undefined auStackX8 [8];
  undefined auStack1464 [32];
  EXCEPTION_POINTERS local_598;
  undefined local_588 [4];
  DWORD local_584;
  CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)auStack1464;
  if (nDbgHookCode != -1) {
    FUN_1800286b4();
  }
  local_588 = 0;
  FUN_1800244a0((undefined (*) [16])&local_584,0,0x94);
  local_598.ExceptionRecord = (PEXCEPTION_RECORD)local_588;
  local_598.ContextRecord = (PCONTEXT)&local_4e8;
  __crtCaptureCurrentContext(&local_4e8);
  local_4e8.Rsp = (DWORD64)auStackX8;
  local_588 = dwExceptionCode;
  local_584 = dwExceptionFlags;
  BVar1 = IsDebuggerPresent();
  LVar2 = __crtUnhandledException(&local_598);
  if (((LVar2 == 0) && (BVar1 == 0)) && (nDbgHookCode != -1)) {
    FUN_1800286b4();
  }
  FUN_180023ef0(local_18 ^ (ulonglong)auStack1464);
  return;
}



void FUN_18002ad68(undefined8 param_1)

{
  DAT_180056608 = param_1;
  return;
}



// Library Function - Single Match
//  _invalid_parameter
// 
// Library: Visual Studio 2012 Release

void _invalid_parameter(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,
                       uintptr_t param_5)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)DecodePointer(DAT_180056608);
  if (UNRECOVERED_JUMPTABLE != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018002adc2. Too many branches
                    // WARNING: Treating indirect jump as call
    (*UNRECOVERED_JUMPTABLE)();
    return;
  }
  _invoke_watson(param_1,param_2,param_3,param_4,param_5);
  UNRECOVERED_JUMPTABLE = (code *)swi(3);
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void FUN_18002add8(void)

{
  _invalid_parameter((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
  return;
}



// Library Function - Single Match
//  _invoke_watson
// 
// Library: Visual Studio 2012 Release

void _invoke_watson(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,
                   uintptr_t param_5)

{
  code *pcVar1;
  BOOL BVar2;
  HANDLE hProcess;
  undefined8 unaff_RBX;
  undefined *puVar3;
  undefined auStack40 [8];
  undefined auStack32 [32];
  
  puVar3 = auStack40;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)();
    puVar3 = auStack32;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18002ae25;
  _call_reportfault(2,0xc0000417,1);
  *(undefined8 *)(puVar3 + 0x20) = unaff_RBX;
  *(undefined8 *)(puVar3 + -8) = 0x180027c36;
  hProcess = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180027c40. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(hProcess,0xc0000417);
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_18002ae34(undefined4 param_1,FILE *param_2)

{
  uint _FileHandle;
  int iVar1;
  uint uVar2;
  int *piVar3;
  undefined **ppuVar4;
  longlong lVar5;
  undefined *puVar6;
  uint uVar7;
  undefined4 local_res8 [2];
  
  local_res8[0] = param_1;
  _FileHandle = _fileno(param_2);
  uVar7 = param_2->_flag;
  if ((uVar7 & 0x82) == 0) {
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((uVar7 & 0x40) == 0) {
      uVar2 = 0;
      if ((uVar7 & 1) != 0) {
        param_2->_cnt = 0;
        if ((uVar7 & 0x10) == 0) {
          param_2->_flag = uVar7 | 0x20;
          return 0xffffffff;
        }
        param_2->_ptr = param_2->_base;
        param_2->_flag = uVar7 & 0xfffffffe;
      }
      uVar7 = param_2->_flag;
      param_2->_cnt = 0;
      param_2->_flag = uVar7 & 0xffffffef | 2;
      if (((uVar7 & 0x10c) == 0) &&
         (((ppuVar4 = FUN_18002da8c(), param_2 != (FILE *)(ppuVar4 + 6) &&
           (ppuVar4 = FUN_18002da8c(), param_2 != (FILE *)(ppuVar4 + 0xc))) ||
          (iVar1 = _isatty(_FileHandle), iVar1 == 0)))) {
        _getbuf(param_2);
      }
      if ((param_2->_flag & 0x108U) == 0) {
        uVar7 = 1;
        uVar2 = FUN_18002eea0(_FileHandle,(wint_t *)local_res8,1);
      }
      else {
        uVar7 = *(int *)&param_2->_ptr - *(int *)&param_2->_base;
        param_2->_ptr = (char *)((longlong)param_2->_base + 1);
        param_2->_cnt = param_2->_bufsiz + -1;
        if ((int)uVar7 < 1) {
          if (_FileHandle + 2 < 2) {
            puVar6 = &DAT_180053810;
          }
          else {
            puVar6 = (undefined *)
                     ((ulonglong)(_FileHandle & 0x1f) * 0x58 +
                     *(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)_FileHandle >> 5) * 8)
                     );
          }
          if (((puVar6[8] & 0x20) != 0) && (lVar5 = FUN_18002f778(_FileHandle,0,2), lVar5 == -1))
          goto LAB_18002ae6c;
        }
        else {
          uVar2 = FUN_18002eea0(_FileHandle,(wint_t *)param_2->_base,uVar7);
        }
        *param_2->_base = (byte)local_res8[0];
      }
      if (uVar2 == uVar7) {
        return (ulonglong)(byte)local_res8[0];
      }
    }
    else {
      piVar3 = _errno();
      *piVar3 = 0x22;
    }
  }
LAB_18002ae6c:
  param_2->_flag = param_2->_flag | 0x20;
  return 0xffffffff;
}



// WARNING: Removing unreachable block (ram,0x00018002b419)
// WARNING: Removing unreachable block (ram,0x00018002b3f7)
// WARNING: Removing unreachable block (ram,0x00018002b564)
// WARNING: Removing unreachable block (ram,0x00018002b56d)
// WARNING: Removing unreachable block (ram,0x00018002b575)

void FUN_18002afc0(FILE *param_1,ushort *param_2,localeinfo_struct *param_3,int **param_4)

{
  ushort uVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  char cVar10;
  int iVar11;
  int *piVar12;
  int *piVar13;
  undefined7 extraout_var;
  code *pcVar14;
  size_t sVar15;
  ulonglong uVar16;
  uint uVar17;
  ulonglong uVar18;
  int *piVar19;
  FILE *pFVar20;
  ushort *puVar21;
  ulonglong uVar22;
  uint uVar23;
  ulonglong uVar24;
  uint uVar25;
  ushort uVar26;
  int iVar27;
  undefined4 local_4f0;
  localeinfo_struct *local_4e8;
  uint local_4d8;
  uint local_4d4;
  uint local_4d0;
  int local_4cc;
  int **local_4c8;
  int local_4c0;
  wint_t local_4bc [2];
  wint_t local_4b8 [2];
  char local_4b4;
  undefined local_4b3;
  uint local_4b0;
  FILE *local_4a8;
  int local_4a0;
  undefined4 local_49c;
  undefined4 local_498;
  ushort *local_490;
  localeinfo_struct local_488;
  longlong local_478;
  char local_470;
  int *local_468;
  int *local_460;
  int *local_458 [2];
  wint_t local_448;
  int local_249 [128];
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffae8;
  local_498 = 0;
  uVar25 = 0;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar5 = false;
  bVar4 = false;
  bVar3 = false;
  bVar2 = false;
  local_4c0 = 0;
  uVar17 = 0;
  local_4d4 = 0;
  local_4d0 = 0;
  local_49c = 0;
  local_4a0 = 0;
  piVar12 = (int *)0x0;
  local_4cc = 0;
  local_4c8 = param_4;
  local_4a8 = param_1;
  local_490 = param_2;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_488,param_3);
  local_460 = _errno();
  uVar16 = 0;
  if ((param_1 == (FILE *)0x0) || (local_490 == (ushort *)0x0)) {
LAB_18002b045:
    piVar12 = _errno();
    *piVar12 = 0x16;
    FUN_18002add8();
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
  else {
    uVar26 = *local_490;
    local_4d8 = 0;
    local_468 = (int *)0x0;
    uVar18 = uVar16;
    uVar24 = uVar16;
    piVar19 = (int *)PTR_s__null__1800543c8;
    puVar21 = local_490;
    while (PTR_s__null__1800543c8 = (undefined *)piVar19, uVar26 != 0) {
      uVar22 = 0;
      local_490 = puVar21 + 1;
      if ((int)uVar18 < 0) break;
      uVar23 = 0;
      if ((ushort)(uVar26 - 0x20) < 0x59) {
        uVar23 = (int)"(null)"[uVar26] & 0xf;
      }
      local_4b0 = (int)(char)(&DAT_180048c60)[(longlong)(int)uVar16 + (longlong)(int)uVar23 * 8] >>
                  4;
      uVar16 = (ulonglong)local_4b0;
      if (local_4b0 == 0) {
LAB_18002b91e:
        local_4cc = 1;
        write_char(uVar26,local_4a8,(int *)&local_4d8);
        uVar18 = (ulonglong)local_4d8;
LAB_18002b81c:
        uVar16 = (ulonglong)local_4b0;
        puVar21 = local_490;
      }
      else {
        if (local_4b0 == 1) {
          uVar17 = 0xffffffff;
          local_49c = 0;
          local_4a0 = 0;
          local_4c0 = 0;
          local_4d0 = 0;
          uVar25 = 0;
          bVar8 = false;
          bVar7 = false;
          bVar6 = false;
          bVar5 = false;
          bVar4 = false;
          bVar3 = false;
          bVar2 = false;
          local_4d4 = 0xffffffff;
          local_4cc = 0;
          puVar21 = local_490;
        }
        else {
          if (local_4b0 == 2) {
            if (uVar26 == 0x20) {
              bVar8 = true;
              puVar21 = local_490;
            }
            else {
              if (uVar26 == 0x23) {
                bVar7 = true;
                puVar21 = local_490;
              }
              else {
                if (uVar26 == 0x2b) {
                  bVar4 = true;
                  puVar21 = local_490;
                }
                else {
                  if (uVar26 == 0x2d) {
                    uVar25 = uVar25 | 4;
                    puVar21 = local_490;
                  }
                  else {
                    puVar21 = local_490;
                    if (uVar26 == 0x30) {
                      uVar25 = uVar25 | 8;
                    }
                  }
                }
              }
            }
          }
          else {
            if (local_4b0 == 3) {
              if (uVar26 == 0x2a) {
                local_4c0 = *(int *)param_4;
                param_4 = param_4 + 1;
                puVar21 = local_490;
                local_4c8 = param_4;
                if (local_4c0 < 0) {
                  uVar25 = uVar25 | 4;
                  local_4c0 = -local_4c0;
                }
              }
              else {
                local_4c0 = (uint)uVar26 + local_4c0 * 10 + -0x30;
                puVar21 = local_490;
              }
            }
            else {
              if (local_4b0 == 4) {
                local_4d4 = 0;
                puVar21 = local_490;
                uVar17 = 0;
              }
              else {
                if (local_4b0 == 5) {
                  if (uVar26 == 0x2a) {
                    uVar17 = *(uint *)param_4;
                    param_4 = param_4 + 1;
                    puVar21 = local_490;
                    local_4d4 = uVar17;
                    local_4c8 = param_4;
                    if ((int)uVar17 < 0) {
                      uVar17 = 0xffffffff;
                      local_4d4 = uVar17;
                    }
                  }
                  else {
                    uVar17 = (uint)uVar26 + (uVar17 * 5 + -0x18) * 2;
                    puVar21 = local_490;
                    local_4d4 = uVar17;
                  }
                }
                else {
                  if (local_4b0 == 6) {
                    if (uVar26 == 0x49) {
                      uVar1 = *local_490;
                      bVar6 = true;
                      if ((uVar1 == 0x36) && (puVar21[2] == 0x34)) {
                        bVar6 = true;
                        puVar21 = puVar21 + 3;
                      }
                      else {
                        if ((uVar1 == 0x33) && (puVar21[2] == 0x32)) {
                          bVar6 = false;
                          puVar21 = puVar21 + 3;
                        }
                        else {
                          if ((0x20 < (ushort)(uVar1 - 0x58)) ||
                             (puVar21 = local_490,
                             (0x120821001U >> ((ulonglong)(ushort)(uVar1 - 0x58) & 0x3f) & 1) == 0))
                          {
                            local_4b0 = 0;
                            goto LAB_18002b91e;
                          }
                        }
                      }
                    }
                    else {
                      if (uVar26 == 0x68) {
                        uVar25 = uVar25 | 0x20;
                        puVar21 = local_490;
                      }
                      else {
                        if (uVar26 == 0x6c) {
                          if (*local_490 == 0x6c) {
                            bVar3 = true;
                            puVar21 = puVar21 + 2;
                          }
                          else {
                            uVar25 = uVar25 | 0x10;
                            puVar21 = local_490;
                          }
                        }
                        else {
                          puVar21 = local_490;
                          if (uVar26 == 0x77) {
                            uVar25 = uVar25 | 0x800;
                          }
                        }
                      }
                    }
                  }
                  else {
                    puVar21 = local_490;
                    if (local_4b0 == 7) {
                      if (uVar26 < 0x65) {
                        if (uVar26 == 100) {
LAB_18002b45e:
                          bVar5 = true;
LAB_18002b462:
                          iVar11 = 10;
LAB_18002b472:
                          if ((bVar6) || (bVar3)) {
                            piVar12 = *param_4;
                          }
                          else {
                            if ((uVar25 & 0x20) == 0) {
                              if (bVar5) {
                                piVar12 = (int *)(longlong)*(int *)param_4;
                              }
                              else {
                                piVar12 = (int *)(ulonglong)*(uint *)param_4;
                              }
                            }
                            else {
                              if (bVar5) {
                                piVar12 = (int *)(longlong)*(short *)param_4;
                              }
                              else {
                                piVar12 = (int *)(ulonglong)*(ushort *)param_4;
                              }
                            }
                          }
                          param_4 = param_4 + 1;
                          if ((bVar5) && ((longlong)piVar12 < 0)) {
                            piVar12 = (int *)-(longlong)piVar12;
                            bVar2 = true;
                          }
                          if ((!bVar6) && (!bVar3)) {
                            piVar12 = (int *)((ulonglong)piVar12 & 0xffffffff);
                          }
                          if ((int)uVar17 < 0) {
                            uVar17 = 1;
                          }
                          else {
                            uVar25 = uVar25 & 0xfffffff7;
                            if (0x200 < (int)uVar17) {
                              uVar17 = 0x200;
                            }
                          }
                          piVar19 = local_249;
                          local_4d0 = -(uint)(piVar12 != (int *)0x0) & local_4d0;
                          while ((local_4d4 = uVar17 - 1, 0 < (int)uVar17 || (piVar12 != (int *)0x0)
                                 )) {
                            uVar17 = (int)((ulonglong)piVar12 % (ulonglong)(longlong)iVar11) + 0x30;
                            cVar10 = (char)uVar17;
                            if (0x39 < uVar17) {
                              cVar10 = cVar10 + (char)local_498;
                            }
                            *(char *)piVar19 = cVar10;
                            piVar19 = (int *)((longlong)piVar19 + -1);
                            piVar12 = (int *)((ulonglong)piVar12 / (ulonglong)(longlong)iVar11);
                            uVar17 = local_4d4;
                          }
                          uVar18 = (ulonglong)local_4d8;
                          piVar12 = (int *)((longlong)piVar19 + 1);
                          uVar24 = (ulonglong)
                                   (uint)(((int)register0x00000020 + -0x249) - (int)piVar19);
                          local_4c8 = param_4;
                        }
                        else {
                          if (uVar26 == 0x41) {
LAB_18002b321:
                            local_49c = 1;
                            uVar26 = uVar26 + 0x20;
                            goto LAB_18002b332;
                          }
                          if (uVar26 == 0x43) {
                            if ((uVar25 & 0x830) == 0) {
                              uVar25 = uVar25 | 0x20;
                            }
LAB_18002b2b7:
                            local_4b8[0] = *(wint_t *)param_4;
                            param_4 = param_4 + 1;
                            local_4cc = 1;
                            local_4c8 = param_4;
                            if ((uVar25 & 0x20) == 0) {
                              local_448 = local_4b8[0];
                            }
                            else {
                              local_4b4 = (char)local_4b8[0];
                              local_4b3 = 0;
                              iVar11 = _mbtowc_l((wchar_t *)&local_448,&local_4b4,
                                                 (longlong)(local_488.locinfo)->mb_cur_max,
                                                 (_locale_t)&local_488);
                              if (iVar11 < 0) {
                                local_4a0 = 1;
                              }
                            }
                            uVar24 = 1;
                            piVar12 = (int *)&local_448;
                          }
                          else {
                            if ((uVar26 - 0x45 & 0xfffffffd) == 0) goto LAB_18002b321;
                            if (uVar26 == 0x53) {
                              if ((uVar25 & 0x830) == 0) {
                                uVar25 = uVar25 | 0x20;
                              }
LAB_18002b211:
                              piVar13 = *param_4;
                              if (local_4d4 == 0xffffffff) {
                                uVar17 = 0x7fffffff;
                              }
                              param_4 = param_4 + 1;
                              piVar12 = piVar13;
                              local_4c8 = param_4;
                              if ((uVar25 & 0x20) == 0) {
                                local_4cc = 1;
                                if (piVar13 == (int *)0x0) {
                                  piVar13 = (int *)PTR_u__null__1800543d0;
                                  piVar12 = (int *)PTR_u__null__1800543d0;
                                }
                                for (; (uVar17 != 0 &&
                                       (uVar17 = uVar17 - 1, *(wint_t *)piVar13 != 0));
                                    piVar13 = (int *)((longlong)piVar13 + 2)) {
                                }
                                uVar24 = (longlong)((longlong)piVar13 - (longlong)piVar12) >> 1 &
                                         0xffffffff;
                              }
                              else {
                                if (piVar13 == (int *)0x0) {
                                  piVar12 = piVar19;
                                }
                                piVar19 = piVar12;
                                uVar24 = uVar22;
                                if (0 < (int)uVar17) {
                                  do {
                                    uVar24 = uVar22;
                                    if (*(byte *)piVar19 == 0) break;
                                    iVar11 = _isleadbyte_l((uint)*(byte *)piVar19,
                                                           (_locale_t)&local_488);
                                    if (iVar11 != 0) {
                                      piVar19 = (int *)((longlong)piVar19 + 1);
                                    }
                                    uVar23 = (int)uVar22 + 1;
                                    uVar22 = (ulonglong)uVar23;
                                    piVar19 = (int *)((longlong)piVar19 + 1);
                                    uVar24 = uVar22;
                                  } while ((int)uVar23 < (int)uVar17);
                                }
                                uVar18 = (ulonglong)local_4d8;
                              }
                            }
                            else {
                              if (uVar26 == 0x58) goto LAB_18002b3de;
                              if (uVar26 == 0x5a) {
                                piVar13 = *param_4;
                                param_4 = param_4 + 1;
                                local_4c8 = param_4;
                                if ((piVar13 == (int *)0x0) ||
                                   (piVar12 = *(int **)(piVar13 + 2), piVar12 == (int *)0x0)) {
                                  uVar24 = strlen((char *)piVar19);
                                  piVar12 = piVar19;
                                }
                                else {
                                  if (uVar25 >> 0xb == 0) {
                                    uVar24 = (ulonglong)(uint)(int)(short)*(wint_t *)piVar13;
                                    local_4cc = 0;
                                  }
                                  else {
                                    local_4cc = 1;
                                    uVar24 = (ulonglong)(uint)((int)(short)*(wint_t *)piVar13 / 2);
                                  }
                                }
                              }
                              else {
                                if (uVar26 == 0x61) goto LAB_18002b332;
                                if (uVar26 == 99) goto LAB_18002b2b7;
                              }
                            }
                          }
                        }
LAB_18002b278:
                        pFVar20 = local_4a8;
                        if (local_4a0 == 0) {
                          if (bVar5) {
                            if (bVar2) {
                              local_4bc[0] = 0x2d;
                            }
                            else {
                              if (!bVar4) {
                                if (bVar8) {
                                  local_4bc[0] = 0x20;
                                  local_4d0 = 1;
                                }
                                goto LAB_18002b6ca;
                              }
                              local_4bc[0] = 0x2b;
                            }
                            local_4d0 = 1;
                          }
LAB_18002b6ca:
                          uVar17 = local_4d0;
                          iVar11 = (int)uVar24;
                          iVar27 = (local_4c0 - iVar11) - local_4d0;
                          if ((uVar25 & 0xc) == 0) {
                            write_multi_char(0x20,iVar27,local_4a8,(int *)&local_4d8);
                          }
                          write_string(local_4bc,uVar17,pFVar20,(int *)&local_4d8,local_460);
                          pFVar20 = local_4a8;
                          if (((uVar25 & 8) != 0) && ((uVar25 & 4) == 0)) {
                            write_multi_char(0x30,iVar27,local_4a8,(int *)&local_4d8);
                          }
                          if ((local_4cc == 0) && (0 < iVar11)) {
                            uVar16 = uVar24 & 0xffffffff;
                            piVar19 = piVar12;
                            do {
                              uVar17 = (int)uVar16 - 1;
                              uVar16 = (ulonglong)uVar17;
                              iVar11 = _mbtowc_l((wchar_t *)local_4b8,(char *)piVar19,
                                                 (longlong)(local_488.locinfo)->mb_cur_max,
                                                 (_locale_t)&local_488);
                              if (iVar11 < 1) {
                                uVar18 = 0xffffffff;
                                local_4d8 = 0xffffffff;
                                pFVar20 = local_4a8;
                                param_4 = local_4c8;
                                goto LAB_18002b7d0;
                              }
                              write_char(local_4b8[0],local_4a8,(int *)&local_4d8);
                              piVar19 = (int *)((longlong)piVar19 + (longlong)iVar11);
                              pFVar20 = local_4a8;
                              param_4 = local_4c8;
                            } while (0 < (int)uVar17);
                          }
                          else {
                            write_string((wint_t *)piVar12,iVar11,pFVar20,(int *)&local_4d8,
                                         local_460);
                          }
                          uVar18 = (ulonglong)local_4d8;
LAB_18002b7d0:
                          if ((-1 < (int)uVar18) && ((uVar25 & 4) != 0)) {
                            write_multi_char(0x20,iVar27,pFVar20,(int *)&local_4d8);
                            uVar18 = (ulonglong)local_4d8;
                          }
                        }
                      }
                      else {
                        if (uVar26 < 0x68) {
LAB_18002b332:
                          piVar12 = (int *)&local_448;
                          if ((int)uVar17 < 0) {
                            uVar23 = 6;
LAB_18002b34b:
                            piVar12 = (int *)&local_448;
                            iVar11 = 0x200;
                            local_4d4 = uVar23;
                          }
                          else {
                            if (uVar17 == 0) {
                              iVar11 = 0x200;
                              if (uVar26 == 0x67) {
                                uVar23 = 1;
                                goto LAB_18002b34b;
                              }
                            }
                            else {
                              uVar23 = 0xa3;
                              if (0x200 < (int)uVar17) {
                                uVar17 = 0x200;
                              }
                              iVar11 = 0x200;
                              local_4d4 = uVar17;
                              if (0xa3 < (int)uVar17) {
                                iVar11 = uVar17 + 0x15d;
                                piVar12 = (int *)FUN_180027ce8((longlong)iVar11);
                                local_468 = piVar12;
                                if (piVar12 == (int *)0x0) goto LAB_18002b34b;
                              }
                            }
                          }
                          uVar17 = local_4d4;
                          local_458[0] = *param_4;
                          param_4 = param_4 + 1;
                          local_4c8 = param_4;
                          pcVar14 = (code *)DecodePointer(PTR_LAB_180053a10);
                          local_4e8 = &local_488;
                          local_4f0 = local_49c;
                          (*pcVar14)(local_458,piVar12,(longlong)iVar11,(int)(char)uVar26);
                          if ((bVar7) && (uVar17 == 0)) {
                            pcVar14 = (code *)DecodePointer(PTR_LAB_180053a28);
                            (*pcVar14)(piVar12);
                          }
                          if ((uVar26 == 0x67) && (!bVar7)) {
                            pcVar14 = (code *)DecodePointer(PTR_LAB_180053a20);
                            (*pcVar14)(piVar12);
                          }
                          if (*(char *)piVar12 == '-') {
                            bVar2 = true;
                            piVar12 = (int *)((longlong)piVar12 + 1);
                          }
                          bVar5 = true;
                          sVar15 = strlen((char *)piVar12);
                          uVar18 = (ulonglong)local_4d8;
                          uVar24 = sVar15 & 0xffffffff;
                          goto LAB_18002b278;
                        }
                        if (uVar26 == 0x69) goto LAB_18002b45e;
                        if (uVar26 != 0x6e) {
                          if (uVar26 == 0x6f) {
                            iVar11 = 8;
                          }
                          else {
                            if (uVar26 == 0x70) {
                              uVar17 = 0x10;
                              bVar6 = true;
LAB_18002b3de:
                              local_498 = 7;
                            }
                            else {
                              if (uVar26 == 0x73) goto LAB_18002b211;
                              if (uVar26 == 0x75) goto LAB_18002b462;
                              if (uVar26 != 0x78) goto LAB_18002b278;
                              local_498 = 0x27;
                            }
                            iVar11 = 0x10;
                          }
                          goto LAB_18002b472;
                        }
                        piVar19 = *param_4;
                        param_4 = param_4 + 1;
                        local_4c8 = param_4;
                        bVar9 = FUN_18002f9d4();
                        if ((int)CONCAT71(extraout_var,bVar9) == 0) goto LAB_18002b045;
                        if ((uVar25 & 0x20) == 0) {
                          *piVar19 = (int)uVar18;
                        }
                        else {
                          *(wint_t *)piVar19 = (wint_t)uVar18;
                        }
                        local_4a0 = 1;
                      }
                      uVar17 = local_4d4;
                      if (local_468 != (int *)0x0) {
                        free(local_468);
                        local_468 = (int *)0x0;
                        uVar17 = local_4d4;
                      }
                      goto LAB_18002b81c;
                    }
                  }
                }
              }
            }
          }
        }
      }
      piVar19 = (int *)PTR_s__null__1800543c8;
      uVar26 = *puVar21;
    }
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xfffffffffffffae8);
  return;
}



// Library Function - Single Match
//  write_string
// 
// Library: Visual Studio 2012 Release

void write_string(wint_t *param_1,int param_2,FILE *param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  iVar1 = *param_5;
  if (((*(byte *)&param_3->_flag & 0x40) == 0) || (param_3->_base != (char *)0x0)) {
    *param_5 = 0;
    if (0 < param_2) {
      do {
        param_2 = param_2 + -1;
        write_char(*param_1,param_3,param_4);
        param_1 = param_1 + 1;
        if (*param_4 == -1) {
          if (*param_5 != 0x2a) break;
          write_char(0x3f,param_3,param_4);
        }
      } while (0 < param_2);
      if (*param_5 != 0) {
        return;
      }
    }
    *param_5 = iVar1;
  }
  else {
    *param_4 = *param_4 + param_2;
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x00018002bf63)
// WARNING: Removing unreachable block (ram,0x00018002bf43)
// WARNING: Removing unreachable block (ram,0x00018002c0bc)
// WARNING: Removing unreachable block (ram,0x00018002c0c0)
// WARNING: Removing unreachable block (ram,0x00018002c0c9)

void FUN_18002baf4(FILE *param_1,ushort *param_2,localeinfo_struct *param_3,uint **param_4)

{
  ushort uVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  undefined *puVar9;
  bool bVar10;
  char cVar11;
  int iVar12;
  int *piVar13;
  undefined7 extraout_var;
  code *pcVar14;
  size_t sVar15;
  ulonglong uVar16;
  uint *puVar17;
  uint uVar18;
  FILE *pFVar19;
  uint *puVar20;
  ushort *puVar21;
  ulonglong uVar22;
  uint uVar23;
  ulonglong uVar24;
  uint uVar25;
  ushort uVar26;
  int iVar27;
  undefined4 local_4f0;
  localeinfo_struct *local_4e8;
  uint local_4d8;
  uint local_4d4;
  uint local_4d0;
  uint **local_4c8;
  int local_4c0;
  int local_4bc;
  wint_t local_4b8 [2];
  wint_t local_4b4 [2];
  char local_4b0;
  undefined local_4af;
  uint local_4ac;
  int local_4a8;
  undefined4 local_4a4;
  undefined4 local_4a0;
  FILE *local_498;
  ushort *local_490;
  localeinfo_struct local_488;
  longlong local_478;
  char local_470;
  uint *local_468;
  int *local_460;
  uint *local_458 [2];
  wint_t local_448;
  uint local_249 [128];
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffae8;
  local_4a0 = 0;
  uVar25 = 0;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar5 = false;
  bVar4 = false;
  bVar3 = false;
  bVar2 = false;
  local_4bc = 0;
  uVar18 = 0;
  local_4d4 = 0;
  local_4d0 = 0;
  local_4a4 = 0;
  local_4a8 = 0;
  puVar17 = (uint *)0x0;
  local_4c0 = 0;
  local_4c8 = param_4;
  local_498 = param_1;
  local_490 = param_2;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_488,param_3);
  local_460 = _errno();
  uVar16 = 0;
  if ((param_1 == (FILE *)0x0) || (local_490 == (ushort *)0x0)) {
    piVar13 = _errno();
    *piVar13 = 0x16;
    FUN_18002add8();
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
  else {
    uVar26 = *local_490;
    local_468 = (uint *)0x0;
    local_4d8 = 0;
    puVar21 = local_490;
    uVar22 = uVar16;
    uVar24 = uVar16;
    if (uVar26 != 0) {
      do {
        puVar9 = PTR_s__null__1800543c8;
        iVar12 = (int)uVar22;
        local_490 = puVar21 + 1;
        if ((int)uVar16 < 0) break;
        uVar23 = 0;
        if ((ushort)(uVar26 - 0x20) < 0x59) {
          uVar23 = (byte)" Complete Object Locator\'"[uVar26] & 0xf;
        }
        local_4ac = (uint)((byte)(&DAT_18004ca60)[(longlong)(int)uVar23 * 9 + (longlong)iVar12] >> 4
                          );
        uVar22 = (ulonglong)local_4ac;
        if (local_4ac == 8) goto LAB_18002c5b4;
        if (local_4ac == 0) {
LAB_18002c478:
          local_4c0 = 1;
          write_char(uVar26,local_498,(int *)&local_4d8);
          uVar16 = (ulonglong)local_4d8;
LAB_18002c369:
          uVar22 = (ulonglong)local_4ac;
          puVar21 = local_490;
        }
        else {
          if (local_4ac == 1) {
            local_4a4 = 0;
            local_4a8 = 0;
            local_4bc = 0;
            local_4d0 = 0;
            uVar25 = 0;
            bVar8 = false;
            bVar7 = false;
            bVar6 = false;
            bVar5 = false;
            bVar4 = false;
            bVar3 = false;
            bVar2 = false;
            uVar18 = 0xffffffff;
            local_4d4 = 0xffffffff;
            local_4c0 = 0;
            puVar21 = local_490;
          }
          else {
            if (local_4ac == 2) {
              if (uVar26 == 0x20) {
                bVar8 = true;
                puVar21 = local_490;
              }
              else {
                if (uVar26 == 0x23) {
                  bVar7 = true;
                  puVar21 = local_490;
                }
                else {
                  if (uVar26 == 0x2b) {
                    bVar4 = true;
                    puVar21 = local_490;
                  }
                  else {
                    if (uVar26 == 0x2d) {
                      uVar25 = uVar25 | 4;
                      puVar21 = local_490;
                    }
                    else {
                      puVar21 = local_490;
                      if (uVar26 == 0x30) {
                        uVar25 = uVar25 | 8;
                      }
                    }
                  }
                }
              }
            }
            else {
              if (local_4ac == 3) {
                if (uVar26 == 0x2a) {
                  local_4bc = *(int *)param_4;
                  param_4 = param_4 + 1;
                  puVar21 = local_490;
                  local_4c8 = param_4;
                  if (local_4bc < 0) {
                    uVar25 = uVar25 | 4;
                    local_4bc = -local_4bc;
                  }
                }
                else {
                  local_4bc = (uint)uVar26 + local_4bc * 10 + -0x30;
                  puVar21 = local_490;
                }
              }
              else {
                if (local_4ac == 4) {
                  local_4d4 = 0;
                  puVar21 = local_490;
                  uVar18 = 0;
                }
                else {
                  if (local_4ac == 5) {
                    if (uVar26 == 0x2a) {
                      local_4d4 = *(uint *)param_4;
                      param_4 = param_4 + 1;
                      puVar21 = local_490;
                      uVar18 = local_4d4;
                      local_4c8 = param_4;
                      if ((int)local_4d4 < 0) {
                        local_4d4 = 0xffffffff;
                        uVar18 = 0xffffffff;
                      }
                    }
                    else {
                      local_4d4 = (uint)uVar26 + (uVar18 * 5 + -0x18) * 2;
                      puVar21 = local_490;
                      uVar18 = local_4d4;
                    }
                  }
                  else {
                    if (local_4ac == 6) {
                      if (uVar26 == 0x49) {
                        uVar1 = *local_490;
                        bVar6 = true;
                        if ((uVar1 == 0x36) && (puVar21[2] == 0x34)) {
                          bVar6 = true;
                          puVar21 = puVar21 + 3;
                        }
                        else {
                          if ((uVar1 == 0x33) && (puVar21[2] == 0x32)) {
                            bVar6 = false;
                            puVar21 = puVar21 + 3;
                          }
                          else {
                            if ((0x20 < (ushort)(uVar1 - 0x58)) ||
                               (puVar21 = local_490,
                               (0x120821001U >> ((ulonglong)(ushort)(uVar1 - 0x58) & 0x3f) & 1) == 0
                               )) {
                              local_4ac = 0;
                              goto LAB_18002c478;
                            }
                          }
                        }
                      }
                      else {
                        if (uVar26 == 0x68) {
                          uVar25 = uVar25 | 0x20;
                          puVar21 = local_490;
                        }
                        else {
                          if (uVar26 == 0x6c) {
                            if (*local_490 == 0x6c) {
                              bVar3 = true;
                              puVar21 = puVar21 + 2;
                            }
                            else {
                              uVar25 = uVar25 | 0x10;
                              puVar21 = local_490;
                            }
                          }
                          else {
                            puVar21 = local_490;
                            if (uVar26 == 0x77) {
                              uVar25 = uVar25 | 0x800;
                            }
                          }
                        }
                      }
                    }
                    else {
                      puVar21 = local_490;
                      if (local_4ac == 7) {
                        if (uVar26 < 0x65) {
                          if (uVar26 == 100) {
LAB_18002bfaf:
                            bVar5 = true;
LAB_18002bfb3:
                            iVar12 = 10;
LAB_18002bfc8:
                            if ((bVar6) || (bVar3)) {
                              puVar17 = *param_4;
                            }
                            else {
                              if ((uVar25 & 0x20) == 0) {
                                if (bVar5) {
                                  puVar17 = (uint *)(longlong)*(int *)param_4;
                                }
                                else {
                                  puVar17 = (uint *)(ulonglong)*(uint *)param_4;
                                }
                              }
                              else {
                                if (bVar5) {
                                  puVar17 = (uint *)(longlong)*(short *)param_4;
                                }
                                else {
                                  puVar17 = (uint *)(ulonglong)*(ushort *)param_4;
                                }
                              }
                            }
                            local_4c8 = param_4 + 1;
                            if ((bVar5) && ((longlong)puVar17 < 0)) {
                              puVar17 = (uint *)-(longlong)puVar17;
                              bVar2 = true;
                            }
                            if ((!bVar6) && (!bVar3)) {
                              puVar17 = (uint *)((ulonglong)puVar17 & 0xffffffff);
                            }
                            if ((int)uVar18 < 0) {
                              uVar18 = 1;
                            }
                            else {
                              uVar25 = uVar25 & 0xfffffff7;
                              if (0x200 < (int)uVar18) {
                                uVar18 = 0x200;
                              }
                            }
                            puVar20 = local_249;
                            local_4d0 = -(uint)(puVar17 != (uint *)0x0) & local_4d0;
                            while ((local_4d4 = uVar18 - 1, 0 < (int)uVar18 ||
                                   (puVar17 != (uint *)0x0))) {
                              uVar18 = (int)((ulonglong)puVar17 % (ulonglong)(longlong)iVar12) +
                                       0x30;
                              cVar11 = (char)uVar18;
                              if (0x39 < uVar18) {
                                cVar11 = cVar11 + (char)local_4a0;
                              }
                              *(char *)puVar20 = cVar11;
                              puVar20 = (uint *)((longlong)puVar20 + -1);
                              puVar17 = (uint *)((ulonglong)puVar17 / (ulonglong)(longlong)iVar12);
                              uVar18 = local_4d4;
                            }
                            puVar17 = (uint *)((longlong)puVar20 + 1);
                            uVar24 = (ulonglong)
                                     (uint)(((int)register0x00000020 + -0x249) - (int)puVar20);
                            param_4 = local_4c8;
                          }
                          else {
                            if (uVar26 == 0x41) {
LAB_18002be61:
                              local_4a4 = 1;
                              uVar26 = uVar26 + 0x20;
                              goto LAB_18002be72;
                            }
                            if (uVar26 == 0x43) {
                              if ((uVar25 & 0x830) == 0) {
                                uVar25 = uVar25 | 0x20;
                              }
LAB_18002bdf7:
                              local_4b4[0] = *(wint_t *)param_4;
                              param_4 = param_4 + 1;
                              local_4c0 = 1;
                              local_4c8 = param_4;
                              if ((uVar25 & 0x20) == 0) {
                                local_448 = local_4b4[0];
                              }
                              else {
                                local_4b0 = (char)local_4b4[0];
                                local_4af = 0;
                                iVar12 = _mbtowc_l((wchar_t *)&local_448,&local_4b0,
                                                   (longlong)(local_488.locinfo)->mb_cur_max,
                                                   (_locale_t)&local_488);
                                if (iVar12 < 0) {
                                  local_4a8 = 1;
                                }
                              }
                              uVar24 = 1;
                              puVar17 = (uint *)&local_448;
                            }
                            else {
                              if ((uVar26 - 0x45 & 0xfffffffd) == 0) goto LAB_18002be61;
                              if (uVar26 == 0x53) {
                                if ((uVar25 & 0x830) == 0) {
                                  uVar25 = uVar25 | 0x20;
                                }
LAB_18002bd81:
                                puVar20 = *param_4;
                                if (local_4d4 == 0xffffffff) {
                                  uVar18 = 0x7fffffff;
                                }
                                param_4 = param_4 + 1;
                                puVar17 = puVar20;
                                local_4c8 = param_4;
                                if ((uVar25 & 0x20) == 0) {
                                  local_4c0 = 1;
                                  if (puVar20 == (uint *)0x0) {
                                    puVar20 = (uint *)PTR_u__null__1800543d0;
                                    puVar17 = (uint *)PTR_u__null__1800543d0;
                                  }
                                  for (; (uVar18 != 0 &&
                                         (uVar18 = uVar18 - 1, *(wint_t *)puVar20 != 0));
                                      puVar20 = (uint *)((longlong)puVar20 + 2)) {
                                  }
                                  uVar24 = (longlong)((longlong)puVar20 - (longlong)puVar17) >> 1 &
                                           0xffffffff;
                                }
                                else {
                                  uVar24 = 0;
                                  if (puVar20 == (uint *)0x0) {
                                    puVar17 = (uint *)PTR_s__null__1800543c8;
                                  }
                                  puVar20 = puVar17;
                                  uVar16 = 0;
                                  if (0 < (int)uVar18) {
                                    do {
                                      uVar24 = uVar16;
                                      if (*(byte *)puVar20 == 0) break;
                                      iVar12 = _isleadbyte_l((uint)*(byte *)puVar20,
                                                             (_locale_t)&local_488);
                                      if (iVar12 != 0) {
                                        puVar20 = (uint *)((longlong)puVar20 + 1);
                                      }
                                      uVar23 = (int)uVar24 + 1;
                                      uVar24 = (ulonglong)uVar23;
                                      puVar20 = (uint *)((longlong)puVar20 + 1);
                                      uVar16 = uVar24;
                                    } while ((int)uVar23 < (int)uVar18);
                                  }
                                }
                              }
                              else {
                                if (uVar26 == 0x58) goto LAB_18002bf22;
                                if (uVar26 == 0x5a) {
                                  puVar20 = *param_4;
                                  param_4 = param_4 + 1;
                                  local_4c8 = param_4;
                                  if ((puVar20 == (uint *)0x0) ||
                                     (puVar17 = *(uint **)(puVar20 + 2), puVar17 == (uint *)0x0)) {
                                    uVar24 = strlen(PTR_s__null__1800543c8);
                                    puVar17 = (uint *)puVar9;
                                  }
                                  else {
                                    if (uVar25 >> 0xb == 0) {
                                      uVar24 = (ulonglong)(uint)(int)(short)*(wint_t *)puVar20;
                                      local_4c0 = 0;
                                    }
                                    else {
                                      local_4c0 = 1;
                                      uVar24 = (ulonglong)(uint)((int)(short)*(wint_t *)puVar20 / 2)
                                      ;
                                    }
                                  }
                                }
                                else {
                                  if (uVar26 == 0x61) goto LAB_18002be72;
                                  if (uVar26 == 99) goto LAB_18002bdf7;
                                }
                              }
                            }
                          }
LAB_18002bce1:
                          pFVar19 = local_498;
                          if (local_4a8 == 0) {
                            if (bVar5) {
                              if (bVar2) {
                                local_4b8[0] = 0x2d;
                              }
                              else {
                                if (!bVar4) {
                                  if (bVar8) {
                                    local_4b8[0] = 0x20;
                                    local_4d0 = 1;
                                  }
                                  goto LAB_18002c219;
                                }
                                local_4b8[0] = 0x2b;
                              }
                              local_4d0 = 1;
                            }
LAB_18002c219:
                            uVar18 = local_4d0;
                            iVar12 = (int)uVar24;
                            iVar27 = (local_4bc - iVar12) - local_4d0;
                            if ((uVar25 & 0xc) == 0) {
                              write_multi_char(0x20,iVar27,local_498,(int *)&local_4d8);
                            }
                            write_string(local_4b8,uVar18,pFVar19,(int *)&local_4d8,local_460);
                            if (((uVar25 & 8) != 0) && ((uVar25 & 4) == 0)) {
                              write_multi_char(0x30,iVar27,pFVar19,(int *)&local_4d8);
                            }
                            if ((local_4c0 == 0) && (0 < iVar12)) {
                              uVar16 = uVar24 & 0xffffffff;
                              puVar20 = puVar17;
                              do {
                                uVar18 = (int)uVar16 - 1;
                                uVar16 = (ulonglong)uVar18;
                                iVar12 = _mbtowc_l((wchar_t *)local_4b4,(char *)puVar20,
                                                   (longlong)(local_488.locinfo)->mb_cur_max,
                                                   (_locale_t)&local_488);
                                if (iVar12 < 1) {
                                  uVar16 = 0xffffffff;
                                  local_4d8 = 0xffffffff;
                                  pFVar19 = local_498;
                                  param_4 = local_4c8;
                                  goto LAB_18002c316;
                                }
                                write_char(local_4b4[0],local_498,(int *)&local_4d8);
                                puVar20 = (uint *)((longlong)puVar20 + (longlong)iVar12);
                                pFVar19 = local_498;
                                param_4 = local_4c8;
                              } while (0 < (int)uVar18);
                            }
                            else {
                              write_string((wint_t *)puVar17,iVar12,pFVar19,(int *)&local_4d8,
                                           local_460);
                            }
                            uVar16 = (ulonglong)local_4d8;
LAB_18002c316:
                            if (((int)uVar16 < 0) || ((uVar25 & 4) == 0)) goto LAB_18002c342;
                            write_multi_char(0x20,iVar27,pFVar19,(int *)&local_4d8);
                          }
                          uVar16 = (ulonglong)local_4d8;
                        }
                        else {
                          if (uVar26 < 0x68) {
LAB_18002be72:
                            puVar17 = (uint *)&local_448;
                            if ((int)uVar18 < 0) {
                              uVar23 = 6;
LAB_18002be8f:
                              puVar17 = (uint *)&local_448;
                              iVar12 = 0x200;
                              local_4d4 = uVar23;
                            }
                            else {
                              if (uVar18 == 0) {
                                iVar12 = 0x200;
                                if (uVar26 == 0x67) {
                                  uVar23 = 1;
                                  goto LAB_18002be8f;
                                }
                              }
                              else {
                                uVar23 = 0xa3;
                                if (0x200 < (int)uVar18) {
                                  uVar18 = 0x200;
                                }
                                iVar12 = 0x200;
                                local_4d4 = uVar18;
                                if (0xa3 < (int)uVar18) {
                                  iVar12 = uVar18 + 0x15d;
                                  puVar17 = (uint *)FUN_180027ce8((longlong)iVar12);
                                  local_468 = puVar17;
                                  if (puVar17 == (uint *)0x0) goto LAB_18002be8f;
                                }
                              }
                            }
                            uVar18 = local_4d4;
                            local_458[0] = *param_4;
                            local_4c8 = param_4 + 1;
                            pcVar14 = (code *)DecodePointer(PTR_LAB_180053a10);
                            local_4e8 = &local_488;
                            local_4f0 = local_4a4;
                            (*pcVar14)(local_458,puVar17,(longlong)iVar12);
                            if ((bVar7) && (uVar18 == 0)) {
                              pcVar14 = (code *)DecodePointer(PTR_LAB_180053a28);
                              (*pcVar14)(puVar17);
                            }
                            if ((uVar26 == 0x67) && (!bVar7)) {
                              pcVar14 = (code *)DecodePointer(PTR_LAB_180053a20);
                              (*pcVar14)(puVar17);
                            }
                            if (*(char *)puVar17 == '-') {
                              bVar2 = true;
                              puVar17 = (uint *)((longlong)puVar17 + 1);
                            }
                            bVar5 = true;
                            sVar15 = strlen((char *)puVar17);
                            uVar24 = sVar15 & 0xffffffff;
                            param_4 = param_4 + 1;
                            goto LAB_18002bce1;
                          }
                          if (uVar26 == 0x69) goto LAB_18002bfaf;
                          if (uVar26 != 0x6e) {
                            if (uVar26 == 0x6f) {
                              iVar12 = 8;
                            }
                            else {
                              if (uVar26 == 0x70) {
                                uVar18 = 0x10;
                                bVar6 = true;
LAB_18002bf22:
                                local_4a0 = 7;
                              }
                              else {
                                if (uVar26 == 0x73) goto LAB_18002bd81;
                                if (uVar26 == 0x75) goto LAB_18002bfb3;
                                if (uVar26 != 0x78) goto LAB_18002bce1;
                                local_4a0 = 0x27;
                              }
                              iVar12 = 0x10;
                            }
                            goto LAB_18002bfc8;
                          }
                          puVar20 = *param_4;
                          param_4 = param_4 + 1;
                          local_4c8 = param_4;
                          bVar10 = FUN_18002f9d4();
                          if ((int)CONCAT71(extraout_var,bVar10) == 0) goto LAB_18002c5b4;
                          if ((uVar25 & 0x20) == 0) {
                            *puVar20 = local_4d8;
                          }
                          else {
                            *(wint_t *)puVar20 = (wint_t)local_4d8;
                          }
                          uVar16 = (ulonglong)local_4d8;
                          local_4a8 = 1;
                        }
LAB_18002c342:
                        uVar18 = local_4d4;
                        if (local_468 != (uint *)0x0) {
                          free(local_468);
                          uVar16 = (ulonglong)local_4d8;
                          local_468 = (uint *)0x0;
                          uVar18 = local_4d4;
                        }
                        goto LAB_18002c369;
                      }
                    }
                  }
                }
              }
            }
          }
        }
        iVar12 = (int)uVar22;
        uVar26 = *puVar21;
      } while (uVar26 != 0);
      if ((iVar12 != 0) && (iVar12 != 7)) {
LAB_18002c5b4:
        piVar13 = _errno();
        *piVar13 = 0x16;
        FUN_18002add8();
        if (local_470 != '\0') {
          *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
        }
        goto LAB_18002c3a2;
      }
    }
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
LAB_18002c3a2:
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xfffffffffffffae8);
  return;
}



// Library Function - Single Match
//  write_char
// 
// Library: Visual Studio 2012 Release

void write_char(wint_t param_1,FILE *param_2,int *param_3)

{
  short sVar1;
  
  if (((*(byte *)&param_2->_flag & 0x40) == 0) || (param_2->_base != (char *)0x0)) {
    sVar1 = FUN_18002f9ec(param_1,param_2);
    if (sVar1 == -1) {
      *param_3 = -1;
    }
    else {
      *param_3 = *param_3 + 1;
    }
  }
  else {
    *param_3 = *param_3 + 1;
  }
  return;
}



// Library Function - Single Match
//  write_multi_char
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

void write_multi_char(wint_t param_1,int param_2,FILE *param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      write_char(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



// Library Function - Single Match
//  __addlocaleref
// 
// Library: Visual Studio 2012 Release

void __addlocaleref(int *param_1)

{
  int *piVar1;
  int **ppiVar2;
  longlong lVar3;
  
  LOCK();
  *param_1 = *param_1 + 1;
  piVar1 = *(int **)(param_1 + 0x36);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x3a);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x38);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x3e);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  ppiVar2 = (int **)(param_1 + 10);
  lVar3 = 6;
  do {
    if ((ppiVar2[-2] != (int *)&DAT_180053f7c) && (piVar1 = *ppiVar2, piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
    }
    if ((ppiVar2[-3] != (int *)0x0) && (piVar1 = ppiVar2[-1], piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
    }
    ppiVar2 = ppiVar2 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  LOCK();
  *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
       *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + 1;
  return;
}



// Library Function - Single Match
//  __freetlocinfo
// 
// Library: Visual Studio 2012 Release

void __freetlocinfo(void *param_1)

{
  int *piVar1;
  undefined **ppuVar2;
  longlong lVar3;
  void **ppvVar4;
  int **ppiVar5;
  
  if ((((*(undefined ***)((longlong)param_1 + 0xf0) != (undefined **)0x0) &&
       (*(undefined ***)((longlong)param_1 + 0xf0) != &PTR_DAT_180054bc0)) &&
      (*(int **)((longlong)param_1 + 0xd8) != (int *)0x0)) &&
     (**(int **)((longlong)param_1 + 0xd8) == 0)) {
    piVar1 = *(int **)((longlong)param_1 + 0xe8);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      free(piVar1);
      __free_lconv_mon(*(longlong *)((longlong)param_1 + 0xf0));
    }
    piVar1 = *(int **)((longlong)param_1 + 0xe0);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      free(piVar1);
      __free_lconv_num(*(void ***)((longlong)param_1 + 0xf0));
    }
    free(*(void **)((longlong)param_1 + 0xd8));
    free(*(void **)((longlong)param_1 + 0xf0));
  }
  if ((*(int **)((longlong)param_1 + 0xf8) != (int *)0x0) &&
     (**(int **)((longlong)param_1 + 0xf8) == 0)) {
    free((void *)(*(longlong *)((longlong)param_1 + 0x100) + -0xfe));
    free((void *)(*(longlong *)((longlong)param_1 + 0x110) + -0x80));
    free((void *)(*(longlong *)((longlong)param_1 + 0x118) + -0x80));
    free(*(void **)((longlong)param_1 + 0xf8));
  }
  ppuVar2 = *(undefined ***)((longlong)param_1 + 0x120);
  if ((ppuVar2 != &PTR_DAT_180053f80) && (*(int *)((longlong)ppuVar2 + 0x15c) == 0)) {
    __free_lc_time(ppuVar2);
    free(*(void **)((longlong)param_1 + 0x120));
  }
  ppvVar4 = (void **)((longlong)param_1 + 0x128);
  ppiVar5 = (int **)((longlong)param_1 + 0x28);
  lVar3 = 6;
  do {
    if (((ppiVar5[-2] != (int *)&DAT_180053f7c) && (piVar1 = *ppiVar5, piVar1 != (int *)0x0)) &&
       (*piVar1 == 0)) {
      free(piVar1);
      free(*ppvVar4);
    }
    if (((ppiVar5[-3] != (int *)0x0) && (piVar1 = ppiVar5[-1], piVar1 != (int *)0x0)) &&
       (*piVar1 == 0)) {
      free(piVar1);
    }
    ppvVar4 = ppvVar4 + 1;
    ppiVar5 = ppiVar5 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  free(param_1);
  return;
}



// Library Function - Single Match
//  __removelocaleref
// 
// Library: Visual Studio 2012 Release

int * __removelocaleref(int *param_1)

{
  int *piVar1;
  int **ppiVar2;
  longlong lVar3;
  
  if (param_1 != (int *)0x0) {
    LOCK();
    *param_1 = *param_1 + -1;
    piVar1 = *(int **)(param_1 + 0x36);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x3a);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x38);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x3e);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    ppiVar2 = (int **)(param_1 + 10);
    lVar3 = 6;
    do {
      if ((ppiVar2[-2] != (int *)&DAT_180053f7c) && (piVar1 = *ppiVar2, piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
      }
      if ((ppiVar2[-3] != (int *)0x0) && (piVar1 = ppiVar2[-1], piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
      }
      ppiVar2 = ppiVar2 + 4;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    LOCK();
    *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
         *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + -1;
  }
  return param_1;
}



// Library Function - Single Match
//  __updatetlocinfo
// 
// Library: Visual Studio 2012 Release

pthreadlocinfo __updatetlocinfo(void)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  
  p_Var1 = _getptd();
  if (((p_Var1->_ownlocale & DAT_1800543b8) == 0) || (p_Var1->ptlocinfo == (pthreadlocinfo)0x0)) {
    _lock(0xc);
    ptVar2 = (pthreadlocinfo)
             _updatetlocinfoEx_nolock((int **)&p_Var1->ptlocinfo,(int *)PTR_DAT_180054240);
    FUN_18002d5f0(0xc);
  }
  else {
    p_Var1 = _getptd();
    ptVar2 = p_Var1->ptlocinfo;
  }
  if (ptVar2 == (pthreadlocinfo)0x0) {
    _amsg_exit(0x20);
  }
  return ptVar2;
}



// Library Function - Single Match
//  _updatetlocinfoEx_nolock
// 
// Library: Visual Studio 2012 Release

int * _updatetlocinfoEx_nolock(int **param_1,int *param_2)

{
  int *piVar1;
  
  if ((param_2 == (int *)0x0) || (param_1 == (int **)0x0)) {
    param_2 = (int *)0x0;
  }
  else {
    piVar1 = *param_1;
    if (piVar1 != param_2) {
      *param_1 = param_2;
      __addlocaleref(param_2);
      if (((piVar1 != (int *)0x0) && (__removelocaleref(piVar1), *piVar1 == 0)) &&
         (piVar1 != (int *)&DAT_180054250)) {
        __freetlocinfo(piVar1);
      }
    }
  }
  return param_2;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __initmbctable
// 
// Library: Visual Studio 2012 Release

undefined8 __initmbctable(void)

{
  if (_DAT_180057bc8 == 0) {
    FUN_18002cde8(-3);
    _DAT_180057bc8 = 1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  int __cdecl getSystemCP(int)
// 
// Library: Visual Studio 2012 Release

int getSystemCP(int param_1)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)0x0);
  _DAT_180056630 = 0;
  if (param_1 == -2) {
    _DAT_180056630 = 1;
    param_1 = GetOEMCP();
  }
  else {
    if (param_1 == -3) {
      _DAT_180056630 = 1;
      param_1 = GetACP();
    }
    else {
      if (param_1 == -4) {
        _DAT_180056630 = 1;
        param_1 = *(UINT *)(local_28[0] + 4);
      }
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return param_1;
}



// Library Function - Single Match
//  void __cdecl setSBCS(struct threadmbcinfostruct * __ptr64)
// 
// Library: Visual Studio 2012 Release

void setSBCS(threadmbcinfostruct *param_1)

{
  longlong lVar1;
  uchar *puVar2;
  undefined (*pauVar3) [16];
  longlong lVar4;
  ushort *puVar5;
  
  pauVar3 = (undefined (*) [16])param_1->mbctype;
  lVar4 = 0x101;
  FUN_1800244a0(pauVar3,0,0x101);
  *(undefined8 *)&param_1->mbcodepage = 0;
  param_1->mblocalename = (wchar_t *)0x0;
  puVar5 = param_1->mbulinfo;
  for (lVar1 = 6; lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  do {
    (*pauVar3)[0] =
         ((undefined *)((longlong)&DAT_180053c50 + -(longlong)param_1))[(longlong)pauVar3];
    pauVar3 = (undefined (*) [16])(*pauVar3 + 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  puVar2 = param_1->mbcasemap;
  lVar1 = 0x100;
  do {
    *puVar2 = puVar2[(longlong)(undefined *)((longlong)&DAT_180053c50 + -(longlong)param_1)];
    puVar2 = puVar2 + 1;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



// Library Function - Single Match
//  void __cdecl setSBUpLow(struct threadmbcinfostruct * __ptr64)
// 
// Library: Visual Studio 2012 Release

void setSBUpLow(threadmbcinfostruct *param_1)

{
  byte bVar1;
  BOOL BVar2;
  uint uVar3;
  CHAR *pCVar4;
  ulonglong uVar5;
  byte *pbVar6;
  WORD *pWVar7;
  longlong lVar8;
  _cpinfo local_538;
  CHAR local_518 [232];
  byte abStack1072 [24];
  CHAR local_418 [232];
  byte abStack816 [24];
  CHAR local_318 [256];
  WORD local_218 [256];
  ulonglong local_18;
  
  local_18 = DAT_1800537e8 ^ (ulonglong)&stack0xfffffffffffffa78;
  BVar2 = GetCPInfo(param_1->mbcodepage,(LPCPINFO)&local_538);
  lVar8 = 0x100;
  if (BVar2 == 0) {
    uVar3 = 0;
    pbVar6 = param_1->mbctype;
    do {
      pbVar6 = pbVar6 + 1;
      if (uVar3 - 0x41 < 0x1a) {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = (char)uVar3 + 0x20;
LAB_18002cced:
        pbVar6[0x100] = bVar1;
      }
      else {
        if (uVar3 - 0x61 < 0x1a) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = (char)uVar3 - 0x20;
          goto LAB_18002cced;
        }
        pbVar6[0x100] = 0;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < 0x100);
  }
  else {
    uVar3 = 0;
    pCVar4 = local_518;
    do {
      *pCVar4 = (CHAR)uVar3;
      uVar3 = uVar3 + 1;
      pCVar4 = pCVar4 + 1;
    } while (uVar3 < 0x100);
    local_518[0] = ' ';
    pbVar6 = local_538.LeadByte;
    while (local_538.LeadByte[0] != 0) {
      bVar1 = pbVar6[1];
      uVar5 = (ulonglong)local_538.LeadByte[0];
      while ((uVar3 = (uint)uVar5, uVar3 <= bVar1 && (uVar3 < 0x100))) {
        local_518[uVar5] = ' ';
        uVar5 = (ulonglong)(uVar3 + 1);
      }
      pbVar6 = pbVar6 + 2;
      local_538.LeadByte[0] = *pbVar6;
    }
    __crtGetStringTypeA((_locale_t)0x0,1,local_518,0x100,local_218,param_1->mbcodepage,0);
    __crtLCMapStringA((_locale_t)0x0,param_1->mblocalename,0x100,local_518,0x100,local_418,0x100,
                      param_1->mbcodepage,0);
    __crtLCMapStringA((_locale_t)0x0,param_1->mblocalename,0x200,local_518,0x100,local_318,0x100,
                      param_1->mbcodepage,0);
    pWVar7 = local_218;
    pbVar6 = param_1->mbctype;
    do {
      pbVar6 = pbVar6 + 1;
      if ((*(byte *)pWVar7 & 1) == 0) {
        if ((*(byte *)pWVar7 & 2) != 0) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = pbVar6[(longlong)(local_418 + (0xe7 - (longlong)param_1))];
          goto LAB_18002cca9;
        }
        pbVar6[0x100] = 0;
      }
      else {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = pbVar6[(longlong)(local_518 + (0xe7 - (longlong)param_1))];
LAB_18002cca9:
        pbVar6[0x100] = bVar1;
      }
      pWVar7 = pWVar7 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
  }
  FUN_180023ef0(local_18 ^ (ulonglong)&stack0xfffffffffffffa78);
  return;
}



// Library Function - Single Match
//  __updatetmbcinfo
// 
// Library: Visual Studio 2012 Release

pthreadmbcinfo __updatetmbcinfo(void)

{
  _ptiddata p_Var1;
  pthreadmbcinfo _Memory;
  
  p_Var1 = _getptd();
  if (((p_Var1->_ownlocale & DAT_1800543b8) == 0) || (p_Var1->ptlocinfo == (pthreadlocinfo)0x0)) {
    _lock(0xd);
    _Memory = p_Var1->ptmbcinfo;
    if (_Memory != (pthreadmbcinfo)PTR_DAT_180053f70) {
      if (_Memory != (pthreadmbcinfo)0x0) {
        LOCK();
        _Memory->refcount = _Memory->refcount + -1;
        if ((_Memory->refcount == 0) && (_Memory != (pthreadmbcinfo)&DAT_180053c50)) {
          free(_Memory);
        }
      }
      p_Var1->ptmbcinfo = (pthreadmbcinfo)PTR_DAT_180053f70;
      _Memory = (pthreadmbcinfo)PTR_DAT_180053f70;
      LOCK();
      *(int *)PTR_DAT_180053f70 = *(int *)PTR_DAT_180053f70 + 1;
    }
    FUN_18002d5f0(0xd);
  }
  else {
    _Memory = p_Var1->ptmbcinfo;
  }
  if (_Memory == (pthreadmbcinfo)0x0) {
    _amsg_exit(0x20);
  }
  return _Memory;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_18002cde8(int param_1)

{
  pthreadmbcinfo ptVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  threadmbcinfostruct *ptVar5;
  int iVar6;
  int iVar7;
  _ptiddata p_Var8;
  threadmbcinfostruct *_Memory;
  pthreadmbcinfo ptVar9;
  int *piVar10;
  threadmbcinfostruct *ptVar11;
  int iVar12;
  longlong lVar13;
  int iVar14;
  
  iVar7 = -1;
  p_Var8 = _getptd();
  __updatetmbcinfo();
  ptVar1 = p_Var8->ptmbcinfo;
  iVar6 = getSystemCP(param_1);
  if (iVar6 == ptVar1->mbcodepage) {
    iVar7 = 0;
  }
  else {
    _Memory = (threadmbcinfostruct *)FUN_180027ce8(0x228);
    iVar14 = 0;
    if (_Memory != (threadmbcinfostruct *)0x0) {
      lVar13 = 4;
      ptVar1 = p_Var8->ptmbcinfo;
      ptVar5 = _Memory;
      do {
        ptVar11 = ptVar5;
        ptVar9 = ptVar1;
        iVar7 = ptVar9->mbcodepage;
        iVar12 = ptVar9->ismbcodepage;
        uVar2 = *(undefined4 *)ptVar9->mbulinfo;
        ptVar11->refcount = ptVar9->refcount;
        ptVar11->mbcodepage = iVar7;
        ptVar11->ismbcodepage = iVar12;
        *(undefined4 *)ptVar11->mbulinfo = uVar2;
        uVar2 = *(undefined4 *)(ptVar9->mbulinfo + 4);
        uVar3 = *(undefined4 *)ptVar9->mbctype;
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 4);
        *(undefined4 *)(ptVar11->mbulinfo + 2) = *(undefined4 *)(ptVar9->mbulinfo + 2);
        *(undefined4 *)(ptVar11->mbulinfo + 4) = uVar2;
        *(undefined4 *)ptVar11->mbctype = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 4) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0xc);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x10);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x14);
        *(undefined4 *)(ptVar11->mbctype + 8) = *(undefined4 *)(ptVar9->mbctype + 8);
        *(undefined4 *)(ptVar11->mbctype + 0xc) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x10) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x14) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x1c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x20);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x24);
        *(undefined4 *)(ptVar11->mbctype + 0x18) = *(undefined4 *)(ptVar9->mbctype + 0x18);
        *(undefined4 *)(ptVar11->mbctype + 0x1c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x20) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x24) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x2c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x30);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x34);
        *(undefined4 *)(ptVar11->mbctype + 0x28) = *(undefined4 *)(ptVar9->mbctype + 0x28);
        *(undefined4 *)(ptVar11->mbctype + 0x2c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x30) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x34) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x3c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x40);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x44);
        *(undefined4 *)(ptVar11->mbctype + 0x38) = *(undefined4 *)(ptVar9->mbctype + 0x38);
        *(undefined4 *)(ptVar11->mbctype + 0x3c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x40) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x44) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x4c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x50);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x54);
        *(undefined4 *)(ptVar11->mbctype + 0x48) = *(undefined4 *)(ptVar9->mbctype + 0x48);
        *(undefined4 *)(ptVar11->mbctype + 0x4c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x50) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x54) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x5c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x60);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 100);
        *(undefined4 *)(ptVar11->mbctype + 0x58) = *(undefined4 *)(ptVar9->mbctype + 0x58);
        *(undefined4 *)(ptVar11->mbctype + 0x5c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x60) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 100) = uVar4;
        lVar13 = lVar13 + -1;
        ptVar1 = (pthreadmbcinfo)(ptVar9->mbctype + 0x68);
        ptVar5 = (threadmbcinfostruct *)(ptVar11->mbctype + 0x68);
      } while (lVar13 != 0);
      uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x6c);
      uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x70);
      uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x74);
      ((threadmbcinfostruct *)(ptVar11->mbctype + 0x68))->refcount =
           ((pthreadmbcinfo)(ptVar9->mbctype + 0x68))->refcount;
      *(undefined4 *)(ptVar11->mbctype + 0x6c) = uVar2;
      *(undefined4 *)(ptVar11->mbctype + 0x70) = uVar3;
      *(undefined4 *)(ptVar11->mbctype + 0x74) = uVar4;
      uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x7c);
      uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x80);
      uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x84);
      *(undefined4 *)(ptVar11->mbctype + 0x78) = *(undefined4 *)(ptVar9->mbctype + 0x78);
      *(undefined4 *)(ptVar11->mbctype + 0x7c) = uVar2;
      *(undefined4 *)(ptVar11->mbctype + 0x80) = uVar3;
      *(undefined4 *)(ptVar11->mbctype + 0x84) = uVar4;
      *(undefined8 *)(ptVar11->mbctype + 0x88) = *(undefined8 *)(ptVar9->mbctype + 0x88);
      _Memory->refcount = 0;
      iVar7 = FUN_18002d02c(iVar6,_Memory);
      if (iVar7 == 0) {
        ptVar1 = p_Var8->ptmbcinfo;
        LOCK();
        ptVar1->refcount = ptVar1->refcount + -1;
        if ((ptVar1->refcount == 0) && (p_Var8->ptmbcinfo != (pthreadmbcinfo)&DAT_180053c50)) {
          free(p_Var8->ptmbcinfo);
        }
        p_Var8->ptmbcinfo = (pthreadmbcinfo)_Memory;
        LOCK();
        _Memory->refcount = _Memory->refcount + 1;
        if (((*(byte *)&p_Var8->_ownlocale & 2) == 0) && (((byte)DAT_1800543b8 & 1) == 0)) {
          _lock(0xd);
          _DAT_180056610 = _Memory->mbcodepage;
          _DAT_180056614 = _Memory->ismbcodepage;
          _DAT_180056628 = _Memory->mblocalename;
          for (iVar6 = iVar14; iVar12 = iVar14, iVar6 < 5; iVar6 = iVar6 + 1) {
            *(ushort *)((longlong)&DAT_180056618 + (longlong)iVar6 * 2) = _Memory->mbulinfo[iVar6];
          }
          for (; iVar12 < 0x101; iVar12 = iVar12 + 1) {
            (&DAT_180053a40)[iVar12] = _Memory->mbctype[iVar12];
          }
          for (; iVar14 < 0x100; iVar14 = iVar14 + 1) {
            (&DAT_180053b50)[iVar14] = _Memory->mbcasemap[iVar14];
          }
          LOCK();
          iVar6 = *(int *)PTR_DAT_180053f70;
          *(int *)PTR_DAT_180053f70 = *(int *)PTR_DAT_180053f70 + -1;
          if ((iVar6 == 1) && ((undefined4 *)PTR_DAT_180053f70 != &DAT_180053c50)) {
            free(PTR_DAT_180053f70);
          }
          LOCK();
          PTR_DAT_180053f70 = (undefined *)_Memory;
          _Memory->refcount = _Memory->refcount + 1;
          FUN_18002d5f0(0xd);
        }
      }
      else {
        if (iVar7 == -1) {
          if (_Memory != (threadmbcinfostruct *)&DAT_180053c50) {
            free(_Memory);
          }
          piVar10 = _errno();
          *piVar10 = 0x16;
        }
      }
    }
  }
  return iVar7;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18002d02c(int param_1,threadmbcinfostruct *param_2)

{
  byte bVar1;
  int iVar2;
  uint CodePage;
  BOOL BVar3;
  uint *puVar4;
  byte *pbVar5;
  wchar_t *pwVar6;
  ulonglong uVar7;
  longlong lVar8;
  ushort *puVar9;
  byte *pbVar10;
  byte *pbVar11;
  uint uVar12;
  uint uVar14;
  undefined auStack104 [32];
  _cpinfo local_48;
  ulonglong local_30;
  wchar_t *pwVar13;
  
  local_30 = DAT_1800537e8 ^ (ulonglong)auStack104;
  CodePage = getSystemCP(param_1);
  pwVar6 = (wchar_t *)0x0;
  if (CodePage != 0) {
    puVar4 = &DAT_180053e80;
    pwVar13 = pwVar6;
LAB_18002d080:
    if (*puVar4 != CodePage) goto code_r0x00018002d088;
    FUN_1800244a0((undefined (*) [16])param_2->mbctype,0,0x101);
    pbVar5 = &DAT_180053e78;
    lVar8 = 4;
    pbVar10 = &DAT_180053e90 + (longlong)pwVar13 * 0x30;
    do {
      bVar1 = *pbVar10;
      pbVar11 = pbVar10;
      while ((bVar1 != 0 && (pbVar11[1] != 0))) {
        bVar1 = *pbVar11;
        uVar12 = (uint)bVar1;
        if (bVar1 <= pbVar11[1]) {
          uVar14 = (uint)bVar1;
          do {
            uVar14 = uVar14 + 1;
            if (0x100 < uVar14) break;
            uVar12 = uVar12 + 1;
            param_2->mbctype[uVar14] = param_2->mbctype[uVar14] | *pbVar5;
          } while (uVar12 <= pbVar11[1]);
        }
        pbVar11 = pbVar11 + 2;
        bVar1 = *pbVar11;
      }
      pbVar10 = pbVar10 + 8;
      pbVar5 = pbVar5 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    param_2->mbcodepage = CodePage;
    param_2->ismbcodepage = 1;
    if (CodePage == 0x3a4) {
      pwVar6 = L"ja-JP";
    }
    else {
      if (CodePage == 0x3a8) {
        pwVar6 = L"zh-CN";
      }
      else {
        if (CodePage == 0x3b5) {
          pwVar6 = L"ko-KR";
        }
        else {
          if (CodePage == 0x3b6) {
            pwVar6 = L"zh-TW";
          }
        }
      }
    }
    param_2->mblocalename = pwVar6;
    puVar9 = param_2->mbulinfo;
    lVar8 = 6;
    do {
      *puVar9 = *(ushort *)
                 ((longlong)&DAT_180053e78 + ((longlong)pwVar13 * 0x30 - (longlong)param_2) +
                 (longlong)puVar9);
      puVar9 = puVar9 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    goto LAB_18002d2aa;
  }
LAB_18002d061:
  setSBCS(param_2);
LAB_18002d2b4:
  FUN_180023ef0(local_30 ^ (ulonglong)auStack104);
  return;
code_r0x00018002d088:
  uVar12 = (int)pwVar13 + 1;
  pwVar13 = (wchar_t *)(ulonglong)uVar12;
  puVar4 = puVar4 + 0xc;
  if (4 < uVar12) goto code_r0x00018002d094;
  goto LAB_18002d080;
code_r0x00018002d094:
  if ((CodePage - 65000 < 2) || (BVar3 = IsValidCodePage(CodePage & 0xffff), BVar3 == 0))
  goto LAB_18002d2b4;
  BVar3 = GetCPInfo(CodePage,(LPCPINFO)&local_48);
  if (BVar3 != 0) {
    FUN_1800244a0((undefined (*) [16])param_2->mbctype,0,0x101);
    param_2->mbcodepage = CodePage;
    param_2->mblocalename = (wchar_t *)0x0;
    if (local_48.MaxCharSize < 2) {
      param_2->ismbcodepage = 0;
    }
    else {
      pbVar10 = local_48.LeadByte;
      while ((local_48.LeadByte[0] != 0 && (pbVar10[1] != 0))) {
        bVar1 = *pbVar10;
        if (bVar1 <= pbVar10[1]) {
          pbVar5 = param_2->mbctype + (bVar1 + 1);
          uVar7 = (ulonglong)(((uint)pbVar10[1] - (uint)bVar1) + 1);
          do {
            *pbVar5 = *pbVar5 | 4;
            pbVar5 = pbVar5 + 1;
            uVar7 = uVar7 - 1;
          } while (uVar7 != 0);
        }
        pbVar10 = pbVar10 + 2;
        local_48.LeadByte[0] = *pbVar10;
      }
      pbVar10 = param_2->mbctype + 2;
      lVar8 = 0xfe;
      do {
        *pbVar10 = *pbVar10 | 8;
        pbVar10 = pbVar10 + 1;
        lVar8 = lVar8 + -1;
      } while (lVar8 != 0);
      iVar2 = param_2->mbcodepage;
      if (iVar2 == 0x3a4) {
        pwVar6 = L"ja-JP";
      }
      else {
        if (iVar2 == 0x3a8) {
          pwVar6 = L"zh-CN";
        }
        else {
          if (iVar2 == 0x3b5) {
            pwVar6 = L"ko-KR";
          }
          else {
            if (iVar2 == 0x3b6) {
              pwVar6 = L"zh-TW";
            }
          }
        }
      }
      param_2->mblocalename = pwVar6;
      param_2->ismbcodepage = 1;
    }
    puVar9 = param_2->mbulinfo;
    for (lVar8 = 6; lVar8 != 0; lVar8 = lVar8 + -1) {
      *puVar9 = 0;
      puVar9 = puVar9 + 1;
    }
LAB_18002d2aa:
    setSBUpLow(param_2);
    goto LAB_18002d2b4;
  }
  if (_DAT_180056630 == 0) goto LAB_18002d2b4;
  goto LAB_18002d061;
}



// Library Function - Single Match
//  _isctype_l
// 
// Library: Visual Studio 2012 Release

int _isctype_l(int _C,int _Type,_locale_t _Locale)

{
  int iVar1;
  BOOL BVar2;
  int _CchSrc;
  ushort local_res8 [4];
  CHAR local_res20;
  CHAR local_res21;
  undefined local_res22;
  localeinfo_struct local_38;
  longlong local_28;
  char local_20;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_38,(localeinfo_struct *)_Locale);
  if (_C + 1U < 0x101) {
    local_res8[0] = (local_38.locinfo)->pctype[_C];
  }
  else {
    iVar1 = _isleadbyte_l(_C >> 8 & 0xff,(_locale_t)&local_38);
    _CchSrc = 1;
    if (iVar1 == 0) {
      local_res21 = '\0';
      local_res20 = (CHAR)_C;
    }
    else {
      local_res22 = 0;
      _CchSrc = 2;
      local_res20 = (CHAR)((uint)_C >> 8);
      local_res21 = (CHAR)_C;
    }
    BVar2 = __crtGetStringTypeA((_locale_t)&local_38,1,&local_res20,_CchSrc,local_res8,
                                (local_38.locinfo)->lc_codepage,1);
    if (BVar2 == 0) {
      if (local_20 != '\0') {
        *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
      }
      return 0;
    }
  }
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (int)((uint)local_res8[0] & _Type);
}



// Library Function - Single Match
//  _locterm
// 
// Library: Visual Studio 2012 Release

void _locterm(void)

{
  if (PTR_DAT_180054240 != &DAT_180054250) {
    _lock(0xc);
    PTR_DAT_180054240 =
         (undefined *)_updatetlocinfoEx_nolock((int **)&PTR_DAT_180054240,(int *)&DAT_180054250);
    FUN_18002d5f0(0xc);
  }
  return;
}



// Library Function - Single Match
//  _lock
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void _lock(int _File)

{
  undefined8 uVar1;
  
  if (*(longlong *)((longlong)&DAT_1800543e0 + (longlong)_File * 0x10) == 0) {
    uVar1 = FUN_18002d4cc(_File);
    if ((int)uVar1 == 0) {
      _amsg_exit(0x11);
    }
  }
                    // WARNING: Could not recover jumptable at 0x00018002d43d. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection(*(LPCRITICAL_SECTION *)((longlong)&DAT_1800543e0 + (longlong)_File * 0x10));
  return;
}



undefined8 FUN_18002d4cc(int param_1)

{
  LPCRITICAL_SECTION _Memory;
  int *piVar1;
  longlong lVar2;
  
  lVar2 = (longlong)param_1;
  if (DAT_180055c78 == 0) {
    _FF_MSGBANNER();
    _NMSG_WRITE(0x1e);
    FUN_18002680c(0xff);
  }
  if (*(longlong *)((longlong)&DAT_1800543e0 + lVar2 * 0x10) == 0) {
    _Memory = (LPCRITICAL_SECTION)FUN_180027ce8(0x28);
    if (_Memory == (LPCRITICAL_SECTION)0x0) {
      piVar1 = _errno();
      *piVar1 = 0xc;
      return 0;
    }
    _lock(10);
    if (*(longlong *)((longlong)&DAT_1800543e0 + lVar2 * 0x10) == 0) {
      FUN_180027794(_Memory,4000);
      *(LPCRITICAL_SECTION *)((longlong)&DAT_1800543e0 + lVar2 * 0x10) = _Memory;
    }
    else {
      free(_Memory);
    }
    LeaveCriticalSection(DAT_180054480);
  }
  return 1;
}



undefined4 FUN_18002d58c(void)

{
  longlong lVar1;
  LPCRITICAL_SECTION *pp_Var2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  pp_Var2 = (LPCRITICAL_SECTION *)&DAT_1800543e0;
  lVar4 = 0x24;
  do {
    if (*(int *)(pp_Var2 + 1) == 1) {
      lVar1 = (longlong)iVar3;
      iVar3 = iVar3 + 1;
      *pp_Var2 = (LPCRITICAL_SECTION)(&DAT_180056640 + lVar1 * 0x28);
      FUN_180027794((LPCRITICAL_SECTION)(&DAT_180056640 + lVar1 * 0x28),4000);
    }
    pp_Var2 = pp_Var2 + 2;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return 1;
}



void FUN_18002d5f0(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x00018002d601. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(*(LPCRITICAL_SECTION *)((longlong)&DAT_1800543e0 + (longlong)param_1 * 0x10))
  ;
  return;
}



// Library Function - Single Match
//  _FindPESection
// 
// Library: Visual Studio 2019 Release

PIMAGE_SECTION_HEADER _FindPESection(PBYTE pImageBase,DWORD_PTR rva)

{
  PIMAGE_SECTION_HEADER p_Var1;
  PBYTE pBVar2;
  uint uVar3;
  
  uVar3 = 0;
  pBVar2 = pImageBase + *(int *)(pImageBase + 0x3c);
  p_Var1 = (PIMAGE_SECTION_HEADER)(pBVar2 + (ulonglong)*(ushort *)(pBVar2 + 0x14) + 0x18);
  if (*(ushort *)(pBVar2 + 6) != 0) {
    do {
      if ((p_Var1->VirtualAddress <= rva) && (rva < p_Var1->Misc + p_Var1->VirtualAddress)) {
        return p_Var1;
      }
      uVar3 = uVar3 + 1;
      p_Var1 = p_Var1 + 1;
    } while (uVar3 < *(ushort *)(pBVar2 + 6));
  }
  return (PIMAGE_SECTION_HEADER)0x0;
}



// Library Function - Single Match
//  _IsNonwritableInCurrentImage
// 
// Library: Visual Studio 2019 Release

BOOL _IsNonwritableInCurrentImage(PBYTE pTarget)

{
  uint uVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  
  uVar1 = _ValidateImageBase((PBYTE)&IMAGE_DOS_HEADER_180000000);
  p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)uVar1;
  if (uVar1 != 0) {
    p_Var2 = _FindPESection((PBYTE)&IMAGE_DOS_HEADER_180000000,(DWORD_PTR)(pTarget + -0x180000000));
    if (p_Var2 != (PIMAGE_SECTION_HEADER)0x0) {
      p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)(~(p_Var2->Characteristics >> 0x1f) & 1);
    }
  }
  return (BOOL)p_Var2;
}



// Library Function - Single Match
//  _ValidateImageBase
// 
// Library: Visual Studio 2015 Release

BOOL _ValidateImageBase(PBYTE pImageBase)

{
  uint uVar1;
  
  if (*(short *)pImageBase != 0x5a4d) {
    return 0;
  }
  uVar1 = 0;
  if (*(int *)(pImageBase + *(int *)(pImageBase + 0x3c)) == 0x4550) {
    uVar1 = (uint)(*(short *)((longlong)(pImageBase + *(int *)(pImageBase + 0x3c)) + 0x18) == 0x20b)
    ;
  }
  return (BOOL)uVar1;
}



void FUN_18002d6e0(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002d6e7. Too many branches
                    // WARNING: Treating indirect jump as call
  DecodePointer(DAT_180056880);
  return;
}



void FUN_18002d6f0(undefined8 param_1)

{
  DAT_180056870 = param_1;
  DAT_180056878 = param_1;
  DAT_180056880 = param_1;
  DAT_180056888 = param_1;
  return;
}



undefined8 FUN_18002d710(uint param_1)

{
  void *pvVar1;
  bool bVar2;
  int *piVar3;
  _ptiddata p_Var4;
  code *pcVar5;
  undefined8 uVar6;
  code *pcVar7;
  void *pvVar8;
  PVOID Ptr;
  int iVar9;
  void *pvVar10;
  code **ppcVar11;
  int local_res10;
  
  pvVar10 = (void *)0x0;
  local_res10 = 0;
  bVar2 = false;
  p_Var4 = (_ptiddata)0x0;
  if (param_1 == 2) {
    ppcVar11 = (code **)&DAT_180056870;
    Ptr = DAT_180056870;
    goto LAB_18002d816;
  }
  if (param_1 == 4) {
LAB_18002d7ab:
    p_Var4 = _getptd_noexit();
    if (p_Var4 == (_ptiddata)0x0) {
      return 0xffffffff;
    }
    pvVar1 = p_Var4->_pxcptacttab;
    pvVar8 = pvVar1;
    do {
      if (*(uint *)((longlong)pvVar8 + 4) == param_1) break;
      pvVar8 = (void *)((longlong)pvVar8 + 0x10);
    } while (pvVar8 < (void *)((longlong)pvVar1 + 0xc0));
    if (((void *)((longlong)pvVar1 + 0xc0) <= pvVar8) ||
       (*(uint *)((longlong)pvVar8 + 4) != param_1)) {
      pvVar8 = (void *)0x0;
    }
    ppcVar11 = (code **)((longlong)pvVar8 + 8);
    pcVar5 = *ppcVar11;
  }
  else {
    if (param_1 == 6) {
LAB_18002d79b:
      ppcVar11 = (code **)&DAT_180056880;
      Ptr = DAT_180056880;
    }
    else {
      if ((param_1 == 8) || (param_1 == 0xb)) goto LAB_18002d7ab;
      if (param_1 == 0xf) {
        ppcVar11 = (code **)&DAT_180056888;
        Ptr = DAT_180056888;
      }
      else {
        if (param_1 != 0x15) {
          if (param_1 != 0x16) {
            piVar3 = _errno();
            *piVar3 = 0x16;
            FUN_18002add8();
            return 0xffffffff;
          }
          goto LAB_18002d79b;
        }
        ppcVar11 = (code **)&DAT_180056878;
        Ptr = DAT_180056878;
      }
    }
LAB_18002d816:
    bVar2 = true;
    pcVar5 = (code *)DecodePointer(Ptr);
  }
  if (pcVar5 == (code *)0x1) {
    return 0;
  }
  if (pcVar5 == (code *)0x0) {
    FUN_180026a3c(3);
    pcVar5 = (code *)swi(3);
    uVar6 = (*pcVar5)();
    return uVar6;
  }
  if (bVar2) {
    _lock(0);
  }
  if ((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) {
    pvVar10 = p_Var4->_tpxcptinfoptrs;
    p_Var4->_tpxcptinfoptrs = (void *)0x0;
    if (param_1 == 8) {
      local_res10 = p_Var4->_tfpecode;
      p_Var4->_tfpecode = 0x8c;
      goto LAB_18002d88e;
    }
  }
  else {
LAB_18002d88e:
    if (param_1 == 8) {
      for (iVar9 = 3; iVar9 < 0xc; iVar9 = iVar9 + 1) {
        *(undefined8 *)((longlong)p_Var4->_pxcptacttab + (longlong)iVar9 * 0x10 + 8) = 0;
      }
      goto LAB_18002d8d7;
    }
  }
  pcVar7 = (code *)EncodePointer((PVOID)0x0);
  *ppcVar11 = pcVar7;
LAB_18002d8d7:
  if (bVar2) {
    FUN_18002d5f0(0);
  }
  if (param_1 == 8) {
    (*pcVar5)(8,p_Var4->_tfpecode);
  }
  else {
    (*pcVar5)(param_1);
  }
  if (((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) &&
     (p_Var4->_tpxcptinfoptrs = pvVar10, param_1 == 8)) {
    p_Var4->_tfpecode = local_res10;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18002d944(undefined8 param_1)

{
  _DAT_180056898 = param_1;
  return;
}



void FUN_18002d960(PVOID param_1,PVOID param_2)

{
  RtlUnwindEx(param_1,param_2,(PEXCEPTION_RECORD)0x0,(PVOID)0x0,(PCONTEXT)&stack0xfffffffffffffb28,
              (PUNWIND_HISTORY_TABLE)0x0);
  return;
}



void FUN_18002d990(void)

{
  return;
}



void FUN_18002d9c0(void)

{
  return;
}



// Library Function - Single Match
//  __initstdio
// 
// Library: Visual Studio 2012 Release

undefined8 __initstdio(void)

{
  undefined **ppuVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar2 = 0;
  lVar3 = 0x14;
  if (DAT_180056a60 == 0) {
    DAT_180056a60 = 0x200;
  }
  else {
    if (DAT_180056a60 < 0x14) {
      DAT_180056a60 = 0x14;
    }
  }
  DAT_180056a58 = FUN_180027c68((longlong)DAT_180056a60,8);
  if (DAT_180056a58 == (LPVOID)0x0) {
    DAT_180056a60 = 0x14;
    DAT_180056a58 = FUN_180027c68(0x14,8);
    if (DAT_180056a58 == (LPVOID)0x0) {
      return 0x1a;
    }
  }
  ppuVar1 = &PTR_DAT_180054620;
  do {
    *(undefined ***)(lVar2 + (longlong)DAT_180056a58) = ppuVar1;
    ppuVar1 = ppuVar1 + 6;
    lVar2 = lVar2 + 8;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return 0;
}



undefined ** FUN_18002da8c(void)

{
  return &PTR_DAT_180054620;
}



// Library Function - Single Match
//  _lock_file
// 
// Library: Visual Studio 2012 Release

void _lock_file(FILE *_File)

{
  if (((FILE *)0x18005461f < _File) && (_File < (FILE *)0x1800549b1)) {
    _lock((int)((longlong)&_File[-0x8001c21]._base / 0x30) + 0x10);
    _File->_flag = _File->_flag | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002daf2. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



// Library Function - Single Match
//  _lock_file2
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void _lock_file2(int _Index,void *_File)

{
  if (_Index < 0x14) {
    _lock(_Index + 0x10);
    *(uint *)((longlong)_File + 0x18) = *(uint *)((longlong)_File + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002db26. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)((longlong)_File + 0x30));
  return;
}



// Library Function - Single Match
//  _unlock_file
// 
// Library: Visual Studio 2012 Release

void _unlock_file(FILE *_File)

{
  if (((FILE *)0x18005461f < _File) && (_File < (FILE *)0x1800549b1)) {
    _File->_flag = _File->_flag & 0xffff7fff;
    FUN_18002d5f0((int)((longlong)&_File[-0x8001c21]._base / 0x30) + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002db77. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



void FUN_18002db80(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) & 0xffff7fff;
    FUN_18002d5f0(param_1 + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002db96. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



// WARNING: Removing unreachable block (ram,0x00018002dbd7)

ulonglong FUN_18002dc1c(uint param_1)

{
  byte bVar1;
  _LocaleUpdate local_28 [8];
  longlong local_20;
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate(local_28,(localeinfo_struct *)0x0);
  bVar1 = *(byte *)(((ulonglong)param_1 & 0xff) + 0x19 + local_20);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return (ulonglong)((bVar1 & 4) != 0);
}



// Library Function - Single Match
//  strcpy_s
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

errno_t strcpy_s(char *_Dst,rsize_t _SizeInBytes,char *_Src)

{
  char cVar1;
  longlong lVar2;
  errno_t *peVar3;
  errno_t eVar4;
  
  if ((_Dst != (char *)0x0) && (_SizeInBytes != 0)) {
    if (_Src != (char *)0x0) {
      lVar2 = -(longlong)_Src;
      do {
        cVar1 = *_Src;
        (_Dst + lVar2)[(longlong)_Src] = cVar1;
        _Src = _Src + 1;
        if (cVar1 == '\0') break;
        _SizeInBytes = _SizeInBytes - 1;
      } while (_SizeInBytes != 0);
      if (_SizeInBytes != 0) {
        return 0;
      }
      *_Dst = '\0';
      peVar3 = _errno();
      eVar4 = 0x22;
      goto LAB_18002dc52;
    }
    *_Dst = '\0';
  }
  peVar3 = _errno();
  eVar4 = 0x16;
LAB_18002dc52:
  *peVar3 = eVar4;
  FUN_18002add8();
  return eVar4;
}



// Library Function - Single Match
//  strlen
// 
// Library: Visual Studio

size_t strlen(char *_Str)

{
  char cVar1;
  ulonglong uVar2;
  ulonglong *puVar3;
  longlong lVar4;
  
  lVar4 = -(longlong)_Str;
  uVar2 = (ulonglong)_Str & 7;
  while (uVar2 != 0) {
    cVar1 = *_Str;
    _Str = (char *)((longlong)_Str + 1);
    if (cVar1 == '\0') goto LAB_18002dd28;
    uVar2 = (ulonglong)_Str & 7;
  }
  do {
    do {
      puVar3 = (ulonglong *)_Str;
      _Str = (char *)(puVar3 + 1);
    } while (((~*puVar3 ^ *puVar3 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    uVar2 = *puVar3;
    if ((char)uVar2 == '\0') {
      return lVar4 + -8 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 8) == '\0') {
      return lVar4 + -7 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x10) == '\0') {
      return lVar4 + -6 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x18) == '\0') {
      return lVar4 + -5 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x20) == '\0') {
      return lVar4 + -4 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x28) == '\0') {
      return lVar4 + -3 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x30) == '\0') {
      return lVar4 + -2 + (longlong)_Str;
    }
  } while ((char)(uVar2 >> 0x38) != '\0');
LAB_18002dd28:
  return lVar4 + -1 + (longlong)_Str;
}



// Library Function - Single Match
//  wcscat_s
// 
// Library: Visual Studio 2012 Release

errno_t wcscat_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src)

{
  wchar_t wVar1;
  errno_t *peVar2;
  wchar_t *pwVar3;
  errno_t eVar4;
  
  if ((_Dst != (wchar_t *)0x0) && (_SizeInWords != 0)) {
    pwVar3 = _Dst;
    if (_Src == (wchar_t *)0x0) {
      *_Dst = L'\0';
    }
    else {
      do {
        if (*pwVar3 == L'\0') break;
        pwVar3 = pwVar3 + 1;
        _SizeInWords = _SizeInWords - 1;
      } while (_SizeInWords != 0);
      if (_SizeInWords != 0) {
        pwVar3 = (wchar_t *)((longlong)pwVar3 - (longlong)_Src);
        do {
          wVar1 = *_Src;
          *(wchar_t *)((longlong)pwVar3 + (longlong)_Src) = wVar1;
          _Src = _Src + 1;
          if (wVar1 == L'\0') break;
          _SizeInWords = _SizeInWords - 1;
        } while (_SizeInWords != 0);
        if (_SizeInWords != 0) {
          return 0;
        }
        *_Dst = L'\0';
        peVar2 = _errno();
        eVar4 = 0x22;
        goto LAB_18002dd81;
      }
      *_Dst = L'\0';
    }
  }
  peVar2 = _errno();
  eVar4 = 0x16;
LAB_18002dd81:
  *peVar2 = eVar4;
  FUN_18002add8();
  return eVar4;
}



// Library Function - Single Match
//  wcscpy_s
// 
// Library: Visual Studio 2012 Release

errno_t wcscpy_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src)

{
  wchar_t wVar1;
  errno_t *peVar2;
  errno_t eVar3;
  wchar_t *pwVar4;
  
  if ((_Dst != (wchar_t *)0x0) && (_SizeInWords != 0)) {
    if (_Src != (wchar_t *)0x0) {
      pwVar4 = (wchar_t *)((longlong)_Dst - (longlong)_Src);
      do {
        wVar1 = *_Src;
        *(wchar_t *)((longlong)pwVar4 + (longlong)_Src) = wVar1;
        _Src = _Src + 1;
        if (wVar1 == L'\0') break;
        _SizeInWords = _SizeInWords - 1;
      } while (_SizeInWords != 0);
      if (_SizeInWords != 0) {
        return 0;
      }
      *_Dst = L'\0';
      peVar2 = _errno();
      eVar3 = 0x22;
      goto LAB_18002de06;
    }
    *_Dst = L'\0';
  }
  peVar2 = _errno();
  eVar3 = 0x16;
LAB_18002de06:
  *peVar2 = eVar3;
  FUN_18002add8();
  return eVar3;
}



longlong FUN_18002de4c(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  psVar2 = param_1;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  return ((longlong)((longlong)psVar2 - (longlong)param_1) >> 1) + -1;
}



// Library Function - Single Match
//  wcsncpy_s
// 
// Library: Visual Studio 2012 Release

errno_t wcsncpy_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src,rsize_t _MaxCount)

{
  wchar_t wVar1;
  errno_t *peVar2;
  errno_t eVar3;
  rsize_t rVar4;
  wchar_t *pwVar5;
  
  if (_MaxCount == 0) {
    if (_Dst == (wchar_t *)0x0) {
      if (_SizeInWords == 0) {
        return 0;
      }
    }
    else {
LAB_18002de88:
      if (_SizeInWords != 0) {
        if (_MaxCount == 0) {
          *_Dst = L'\0';
          return 0;
        }
        if (_Src != (wchar_t *)0x0) {
          rVar4 = _SizeInWords;
          if (_MaxCount == 0xffffffffffffffff) {
            pwVar5 = (wchar_t *)((longlong)_Dst - (longlong)_Src);
            do {
              wVar1 = *_Src;
              *(wchar_t *)((longlong)pwVar5 + (longlong)_Src) = wVar1;
              _Src = _Src + 1;
              if (wVar1 == L'\0') break;
              rVar4 = rVar4 - 1;
            } while (rVar4 != 0);
          }
          else {
            pwVar5 = _Dst;
            do {
              wVar1 = *(wchar_t *)((longlong)((longlong)_Src - (longlong)_Dst) + (longlong)pwVar5);
              *pwVar5 = wVar1;
              pwVar5 = pwVar5 + 1;
              if ((wVar1 == L'\0') || (rVar4 = rVar4 - 1, rVar4 == 0)) break;
              _MaxCount = _MaxCount - 1;
            } while (_MaxCount != 0);
            if (_MaxCount == 0) {
              *pwVar5 = L'\0';
            }
          }
          if (rVar4 != 0) {
            return 0;
          }
          if (_MaxCount == 0xffffffffffffffff) {
            _Dst[_SizeInWords - 1] = L'\0';
            return 0x50;
          }
          *_Dst = L'\0';
          peVar2 = _errno();
          eVar3 = 0x22;
          goto LAB_18002dea9;
        }
        *_Dst = L'\0';
      }
    }
  }
  else {
    if (_Dst != (wchar_t *)0x0) goto LAB_18002de88;
  }
  peVar2 = _errno();
  eVar3 = 0x16;
LAB_18002dea9:
  *peVar2 = eVar3;
  FUN_18002add8();
  return eVar3;
}



// Library Function - Single Match
//  _set_error_mode
// 
// Library: Visual Studio 2012 Release

int _set_error_mode(int _Mode)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  
  if ((_Mode < 0) ||
     ((iVar2 = DAT_1800568b4, iVar1 = _Mode, 2 < _Mode && (iVar1 = DAT_1800568b4, _Mode != 3)))) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18002add8();
    iVar2 = -1;
    iVar1 = DAT_1800568b4;
  }
  DAT_1800568b4 = iVar1;
  return iVar2;
}



void FUN_18002df74(LPCWSTR param_1,undefined8 param_2,uint param_3)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  PVOID pvVar5;
  undefined7 extraout_var;
  HMODULE hModule;
  FARPROC pFVar6;
  code *pcVar7;
  code *pcVar8;
  longlong lVar9;
  longlong lVar10;
  undefined auStack136 [32];
  undefined *local_68;
  undefined local_58 [8];
  undefined local_50 [8];
  byte local_48;
  ulonglong local_40;
  
  local_40 = DAT_1800537e8 ^ (ulonglong)auStack136;
  pvVar5 = EncodePointer((PVOID)0x0);
  lVar10 = 0;
  bVar1 = FUN_1800277c0();
  iVar4 = (int)CONCAT71(extraout_var,bVar1);
  if (DAT_1800568b8 == (PVOID)0x0) {
    hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0x800);
    if (((hModule == (HMODULE)0x0) &&
        ((DVar2 = GetLastError(), DVar2 != 0x57 ||
         (hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0), hModule == (HMODULE)0x0)))) ||
       (pFVar6 = GetProcAddress(hModule,"MessageBoxW"), pFVar6 == (FARPROC)0x0)) goto LAB_18002e1cb;
    DAT_1800568b8 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetActiveWindow");
    DAT_1800568c0 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetLastActivePopup");
    DAT_1800568c8 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetUserObjectInformationW");
    DAT_1800568d8 = EncodePointer(pFVar6);
    if (DAT_1800568d8 != (PVOID)0x0) {
      pFVar6 = GetProcAddress(hModule,"GetProcessWindowStation");
      DAT_1800568d0 = EncodePointer(pFVar6);
    }
  }
  BVar3 = IsDebuggerPresent();
  if (BVar3 == 0) {
    if (iVar4 != 0) {
      DecodePointer(DAT_1800568b8);
      goto LAB_18002e1cb;
    }
  }
  else {
    if (param_1 != (LPCWSTR)0x0) {
      OutputDebugStringW(param_1);
    }
    if (iVar4 != 0) goto LAB_18002e1cb;
  }
  if ((DAT_1800568d0 == pvVar5) || (DAT_1800568d8 == pvVar5)) {
LAB_18002e167:
    if (((DAT_1800568c0 != pvVar5) &&
        (((pcVar7 = (code *)DecodePointer(DAT_1800568c0), pcVar7 != (code *)0x0 &&
          (lVar10 = (*pcVar7)(), lVar10 != 0)) && (DAT_1800568c8 != pvVar5)))) &&
       (pcVar7 = (code *)DecodePointer(DAT_1800568c8), pcVar7 != (code *)0x0)) {
      lVar10 = (*pcVar7)(lVar10);
    }
  }
  else {
    pcVar7 = (code *)DecodePointer(DAT_1800568d0);
    pcVar8 = (code *)DecodePointer(DAT_1800568d8);
    if ((pcVar7 == (code *)0x0) || (pcVar8 == (code *)0x0)) goto LAB_18002e167;
    lVar9 = (*pcVar7)();
    if (lVar9 != 0) {
      local_68 = local_58;
      iVar4 = (*pcVar8)(lVar9,1,local_50);
      if ((iVar4 != 0) && ((local_48 & 1) != 0)) goto LAB_18002e167;
    }
    param_3 = param_3 | 0x200000;
  }
  pcVar7 = (code *)DecodePointer(DAT_1800568b8);
  if (pcVar7 != (code *)0x0) {
    (*pcVar7)(lVar10,param_1,param_2,param_3);
  }
LAB_18002e1cb:
  FUN_180023ef0(local_40 ^ (ulonglong)auStack136);
  return;
}



// Library Function - Single Match
//  _raise_exc
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

void _raise_exc(uint *param_1,ulonglong *param_2,ulonglong param_3,uint param_4,undefined8 *param_5,
               undefined8 *param_6)

{
  FUN_18002e210(param_1,param_2,param_3,param_4,param_5,param_6,0);
  return;
}



void FUN_18002e210(uint *param_1,ulonglong *param_2,ulonglong param_3,uint param_4,
                  undefined8 *param_5,undefined8 *param_6,int param_7)

{
  undefined8 *puVar1;
  uint uVar2;
  DWORD dwExceptionCode;
  uint *local_res8;
  
  param_1[1] = 0;
  dwExceptionCode = 0xc000000d;
  param_1[2] = 0;
  param_1[3] = 0;
  if ((param_3 & 0x10) != 0) {
    dwExceptionCode = 0xc000008f;
    param_1[1] = param_1[1] | 1;
  }
  if ((param_3 & 2) != 0) {
    dwExceptionCode = 0xc0000093;
    param_1[1] = param_1[1] | 2;
  }
  if ((param_3 & 1) != 0) {
    dwExceptionCode = 0xc0000091;
    param_1[1] = param_1[1] | 4;
  }
  if ((param_3 & 4) != 0) {
    dwExceptionCode = 0xc000008e;
    param_1[1] = param_1[1] | 8;
  }
  if ((param_3 & 8) != 0) {
    dwExceptionCode = 0xc0000090;
    param_1[1] = param_1[1] | 0x10;
  }
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 7) << 4) ^ param_1[2]) & 0x10;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 9) << 3) ^ param_1[2]) & 8;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 10) << 2) ^ param_1[2]) & 4;
  param_1[2] = param_1[2] ^ (~((int)(*param_2 >> 0xb) * 2) ^ param_1[2]) & 2;
  param_1[2] = param_1[2] ^ (~(*(uint *)param_2 >> 0xc) ^ param_1[2]) & 1;
  local_res8 = param_1;
  uVar2 = FUN_18002e600();
  puVar1 = param_6;
  if ((uVar2 & 1) != 0) {
    local_res8[3] = local_res8[3] | 0x10;
  }
  if ((uVar2 & 4) != 0) {
    local_res8[3] = local_res8[3] | 8;
  }
  if ((uVar2 & 8) != 0) {
    local_res8[3] = local_res8[3] | 4;
  }
  if ((uVar2 & 0x10) != 0) {
    local_res8[3] = local_res8[3] | 2;
  }
  if ((uVar2 & 0x20) != 0) {
    local_res8[3] = local_res8[3] | 1;
  }
  uVar2 = *(uint *)param_2 & 0x6000;
  if ((*(uint *)param_2 & 0x6000) == 0) {
    *local_res8 = *local_res8 & 0xfffffffc;
  }
  else {
    if (uVar2 == 0x2000) {
      *local_res8 = *local_res8 & 0xfffffffd;
      *local_res8 = *local_res8 | 1;
    }
    else {
      if (uVar2 == 0x4000) {
        *local_res8 = *local_res8 & 0xfffffffe;
        *local_res8 = *local_res8 | 2;
      }
      else {
        if (uVar2 == 0x6000) {
          *local_res8 = *local_res8 | 3;
        }
      }
    }
  }
  *local_res8 = *local_res8 & 0xfffe001f;
  *local_res8 = *local_res8 | (param_4 & 0xfff) << 5;
  local_res8[8] = local_res8[8] | 1;
  if (param_7 == 0) {
    local_res8[8] = local_res8[8] & 0xffffffe3 | 2;
    *(undefined8 *)(local_res8 + 4) = *param_5;
    local_res8[0x18] = local_res8[0x18] | 1;
    local_res8[0x18] = local_res8[0x18] & 0xffffffe3 | 2;
    *(undefined8 *)(local_res8 + 0x14) = *param_6;
  }
  else {
    local_res8[8] = local_res8[8] & 0xffffffe1;
    local_res8[4] = *(uint *)param_5;
    local_res8[0x18] = local_res8[0x18] | 1;
    local_res8[0x18] = local_res8[0x18] & 0xffffffe1;
    local_res8[0x14] = *(uint *)param_6;
  }
  _clrfp();
  RaiseException(dwExceptionCode,0,1,(ULONG_PTR *)&local_res8);
  if ((*(byte *)(local_res8 + 2) & 0x10) != 0) {
    *param_2 = *param_2 & 0xffffffffffffff7f;
  }
  if ((*(byte *)(local_res8 + 2) & 8) != 0) {
    *param_2 = *param_2 & 0xfffffffffffffdff;
  }
  if ((*(byte *)(local_res8 + 2) & 4) != 0) {
    *param_2 = *param_2 & 0xfffffffffffffbff;
  }
  if ((*(byte *)(local_res8 + 2) & 2) != 0) {
    *param_2 = *param_2 & 0xfffffffffffff7ff;
  }
  if ((*(byte *)(local_res8 + 2) & 1) != 0) {
    *param_2 = *param_2 & 0xffffffffffffefff;
  }
  uVar2 = *local_res8 & 3;
  if (uVar2 == 0) {
    *param_2 = *param_2 & 0xffffffffffff9fff;
  }
  else {
    if (uVar2 == 1) {
      *param_2 = *param_2 & 0xffffffffffffbfff;
      *param_2 = *param_2 | 0x2000;
    }
    else {
      if (uVar2 == 2) {
        *param_2 = *param_2 & 0xffffffffffffdfff;
        *param_2 = *param_2 | 0x4000;
      }
      else {
        if (uVar2 == 3) {
          *param_2 = *param_2 | 0x6000;
        }
      }
    }
  }
  if (param_7 == 0) {
    *puVar1 = *(undefined8 *)(local_res8 + 0x14);
  }
  else {
    *(uint *)puVar1 = local_res8[0x14];
  }
  return;
}



// Library Function - Single Match
//  _set_errno_from_matherr
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

void _set_errno_from_matherr(int param_1)

{
  int *piVar1;
  
  if (param_1 == 1) {
    piVar1 = _errno();
    *piVar1 = 0x21;
  }
  else {
    if (param_1 - 2U < 2) {
      piVar1 = _errno();
      *piVar1 = 0x22;
    }
  }
  return;
}



// Library Function - Single Match
//  _clrfp
// 
// Library: Visual Studio

uint _clrfp(void)

{
  uint uVar1;
  
  uVar1 = _get_fpsr();
  _fclrf();
  return uVar1 & 0x3f;
}



// Library Function - Single Match
//  _ctrlfp
// 
// Libraries: Visual Studio 2012 Release, Visual Studio 2019 Release

uint _ctrlfp(uint param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = _get_fpsr();
  if ((DAT_180054bb0 == '\0') ||
     ((((~param_2 | 0xffff807f) & uVar1 | param_1 & param_2) & 0x40) == 0)) {
    FUN_180030c50();
  }
  else {
    FUN_180030c50();
  }
  return uVar1;
}



// Library Function - Single Match
//  _set_statfp
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release, Visual Studio 2019 Release

void _set_statfp(void)

{
  _get_fpsr();
  FUN_180030c50();
  return;
}



uint FUN_18002e600(void)

{
  uint uVar1;
  
  uVar1 = _get_fpsr();
  return uVar1 & 0x3f;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  isdigit
// 
// Library: Visual Studio 2012 Release

int isdigit(int _C)

{
  uint uVar1;
  localeinfo_struct local_28;
  longlong local_18;
  char local_10;
  
  if (_DAT_180056634 == 0) {
    uVar1 = *(ushort *)(PTR_DAT_180054358 + (longlong)_C * 2) & 4;
  }
  else {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(localeinfo_struct *)0x0);
    if ((local_28.locinfo)->mb_cur_max < 2) {
      uVar1 = (local_28.locinfo)->pctype[_C] & 4;
    }
    else {
      uVar1 = _isctype_l(_C,4,(_locale_t)&local_28);
    }
    if (local_10 != '\0') {
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    }
  }
  return (int)uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_18002e7e4(uint param_1)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  CHAR local_res8;
  CHAR local_res9;
  undefined local_resa;
  byte local_res18;
  undefined local_res19;
  localeinfo_struct local_28;
  longlong local_18;
  char local_10;
  
  if (_DAT_180056634 == 0) {
    if (param_1 - 0x41 < 0x1a) {
      param_1 = param_1 + 0x20;
    }
    return param_1;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(localeinfo_struct *)0x0);
  if (param_1 < 0x100) {
    if ((local_28.locinfo)->mb_cur_max < 2) {
      uVar1 = (local_28.locinfo)->pctype[(int)param_1] & 1;
    }
    else {
      uVar1 = _isctype_l(param_1,1,(_locale_t)&local_28);
    }
    if (uVar1 == 0) goto LAB_18002e6fb;
    uVar1 = (uint)(local_28.locinfo)->pclmap[(int)param_1];
    goto LAB_18002e7bf;
  }
  if ((local_28.locinfo)->mb_cur_max < 2) {
LAB_18002e74b:
    piVar3 = _errno();
    iVar2 = 1;
    *piVar3 = 0x2a;
    local_res9 = '\0';
    local_res8 = (CHAR)param_1;
  }
  else {
    iVar2 = _isleadbyte_l((int)param_1 >> 8 & 0xff,(_locale_t)&local_28);
    if (iVar2 == 0) goto LAB_18002e74b;
    local_resa = 0;
    iVar2 = 2;
    local_res8 = (CHAR)(param_1 >> 8);
    local_res9 = (CHAR)param_1;
  }
  iVar2 = __crtLCMapStringA((_locale_t)&local_28,(local_28.locinfo)->locale_name[2],0x100,
                            &local_res8,iVar2,(LPSTR)&local_res18,3,(local_28.locinfo)->lc_codepage,
                            1);
  if (iVar2 == 0) {
LAB_18002e6fb:
    if (local_10 == '\0') {
      return param_1;
    }
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    return param_1;
  }
  uVar1 = (uint)local_res18;
  if (iVar2 != 1) {
    uVar1 = (uint)CONCAT11(local_res18,local_res19);
  }
LAB_18002e7bf:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1;
}



// Library Function - Single Match
//  _fptostr
// 
// Library: Visual Studio 2012 Release

errno_t _fptostr(char *_Buf,size_t _SizeInBytes,int _Digits,STRFLT _PtFlt)

{
  undefined8 *_Str;
  int iVar1;
  errno_t *peVar2;
  undefined8 *puVar3;
  size_t sVar4;
  char *pcVar5;
  char cVar6;
  errno_t eVar7;
  
  pcVar5 = _PtFlt->mantissa;
  if ((_Buf == (char *)0x0) || (_SizeInBytes == 0)) {
    peVar2 = _errno();
    eVar7 = 0x16;
  }
  else {
    *_Buf = '\0';
    iVar1 = 0;
    if (0 < _Digits) {
      iVar1 = _Digits;
    }
    if ((ulonglong)(longlong)(iVar1 + 1) < _SizeInBytes) {
      _Str = (undefined8 *)(_Buf + 1);
      *_Buf = '0';
      puVar3 = _Str;
      for (; 0 < _Digits; _Digits = _Digits + -1) {
        if (*pcVar5 == '\0') {
          cVar6 = '0';
        }
        else {
          cVar6 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        }
        *(char *)puVar3 = cVar6;
        puVar3 = (undefined8 *)((longlong)puVar3 + 1);
      }
      *(undefined *)puVar3 = 0;
      if ((-1 < _Digits) && ('4' < *pcVar5)) {
        while (puVar3 = (undefined8 *)((longlong)puVar3 + -1), *(char *)puVar3 == '9') {
          *(undefined *)puVar3 = 0x30;
        }
        *(char *)puVar3 = *(char *)puVar3 + '\x01';
      }
      if (*_Buf == '1') {
        _PtFlt->decpt = _PtFlt->decpt + 1;
      }
      else {
        sVar4 = strlen((char *)_Str);
        FUN_180023f20((undefined8 *)_Buf,_Str,sVar4 + 1);
      }
      return 0;
    }
    peVar2 = _errno();
    eVar7 = 0x22;
  }
  *peVar2 = eVar7;
  FUN_18002add8();
  return eVar7;
}



// Library Function - Multiple Matches With Different Base Names
//  _atodbl_l
//  _atoflt_l
// 
// Library: Visual Studio 2012 Release

int FID_conflict__atoflt_l(_CRT_FLOAT *_Result,char *_Str,_locale_t _Locale)

{
  int iVar1;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  byte *local_28;
  ushort local_20 [8];
  ulonglong local_10;
  
  local_10 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff78;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_48,(localeinfo_struct *)_Locale);
  FUN_180031800(local_20,&local_28,(byte *)_Str,0,0,0,0,local_48);
  FUN_180030c90(local_20,(uint *)_Result);
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  iVar1 = FUN_180023ef0(local_10 ^ (ulonglong)&stack0xffffffffffffff78);
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00018002e935)

void FUN_18002ea68(uint *param_1,byte *param_2,localeinfo_struct *param_3)

{
  byte *local_58;
  longlong local_50 [2];
  longlong local_40;
  char local_38;
  ushort local_30 [8];
  ulonglong local_20;
  
  local_20 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff68;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_50,param_3);
  FUN_180031800(local_30,&local_58,param_2,0,0,0,0,local_50);
  FUN_180031248(local_30,param_1);
  if (local_38 != '\0') {
    *(uint *)(local_40 + 200) = *(uint *)(local_40 + 200) & 0xfffffffd;
  }
  FUN_180023ef0(local_20 ^ (ulonglong)&stack0xffffffffffffff68);
  return;
}



// Library Function - Single Match
//  __dtold
// 
// Library: Visual Studio 2012 Release

void __dtold(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  ushort uVar3;
  uint uVar4;
  ushort uVar5;
  
  uVar4 = param_2[1];
  uVar5 = *(ushort *)((longlong)param_2 + 6) & 0x8000;
  uVar1 = *param_2;
  uVar3 = *(ushort *)((longlong)param_2 + 6) >> 4 & 0x7ff;
  uVar2 = 0x80000000;
  if (uVar3 == 0) {
    if (((uVar4 & 0xfffff) == 0) && (uVar1 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      goto LAB_18002eb32;
    }
    uVar3 = 0x3c01;
    uVar2 = 0;
  }
  else {
    if (uVar3 == 0x7ff) {
      uVar3 = 0x7fff;
    }
    else {
      uVar3 = uVar3 + 0x3c00;
    }
  }
  *param_1 = uVar1 << 0xb;
  uVar4 = uVar1 >> 0x15 | (uVar4 & 0xfffff) << 0xb | uVar2;
  param_1[1] = uVar4;
  if (uVar2 == 0) {
    do {
      uVar4 = *param_1 >> 0x1f | uVar4 * 2;
      *param_1 = *param_1 * 2;
      uVar3 = uVar3 - 1;
    } while (-1 < (int)uVar4);
    param_1[1] = uVar4;
  }
  uVar5 = uVar5 | uVar3;
LAB_18002eb32:
  *(ushort *)(param_1 + 2) = uVar5;
  return;
}



void FUN_18002eb40(undefined8 param_1,int *param_2,char *param_3,rsize_t param_4)

{
  code *pcVar1;
  int iVar2;
  errno_t eVar3;
  undefined8 local_78;
  undefined2 local_70;
  undefined8 local_68;
  undefined2 local_60;
  short local_58;
  char local_56;
  char local_54 [28];
  ulonglong local_38;
  
  local_38 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff58;
  local_78 = param_1;
  __dtold((uint *)&local_68,(uint *)&local_78);
  local_78 = local_68;
  local_70 = local_60;
  iVar2 = FUN_180032064((int *)&local_78,0x11,0,&local_58);
  *param_2 = (int)local_56;
  param_2[1] = (int)local_58;
  param_2[2] = iVar2;
  eVar3 = strcpy_s(param_3,param_4,local_54);
  if (eVar3 == 0) {
    *(char **)(param_2 + 4) = param_3;
    FUN_180023ef0(local_38 ^ (ulonglong)&stack0xffffffffffffff58);
    return;
  }
  _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



undefined4 FUN_18002ec04(wchar_t *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0xe3;
  do {
    iVar1 = (iVar3 + iVar4) / 2;
    iVar2 = _wcsnicmp(param_1,(wchar_t *)(&PTR_DAT_180049c50)[(longlong)iVar1 * 2],0x55);
    if (iVar2 == 0) {
      return *(undefined4 *)(&UNK_180049c58 + (longlong)iVar1 * 0x10);
    }
    if (iVar2 < 0) {
      iVar3 = iVar1 + -1;
    }
    else {
      iVar4 = iVar1 + 1;
    }
  } while (iVar4 <= iVar3);
  return 0xffffffff;
}



undefined4 FUN_18002ec90(wchar_t *param_1)

{
  int iVar1;
  
  if (((param_1 != (wchar_t *)0x0) && (iVar1 = FUN_18002ec04(param_1), -1 < iVar1)) &&
     ((ulonglong)(longlong)iVar1 < 0xe4)) {
    return *(undefined4 *)(&DAT_180048e10 + (longlong)iVar1 * 0x10);
  }
  return 0;
}



void FUN_18002ecc4(wchar_t *param_1,DWORD param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
                  int param_6)

{
  LCID Locale;
  
  if ((code *)(DAT_180057b80 ^ DAT_1800537e8) == (code *)0x0) {
    Locale = FUN_18002ec90(param_1);
    LCMapStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*(code *)(DAT_180057b80 ^ DAT_1800537e8))();
  }
  return;
}



// Library Function - Single Match
//  _wcsnicmp
// 
// Library: Visual Studio 2019 Release

int _wcsnicmp(wchar_t *_Str1,wchar_t *_Str2,size_t _MaxCount)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  wchar_t *pwVar4;
  
  iVar3 = 0;
  if (_MaxCount != 0) {
    pwVar4 = (wchar_t *)((longlong)_Str1 - (longlong)_Str2);
    do {
      uVar1 = *(ushort *)((longlong)pwVar4 + (longlong)_Str2);
      if ((ushort)(uVar1 - 0x41) < 0x1a) {
        uVar1 = uVar1 + 0x20;
      }
      uVar2 = *_Str2;
      if ((ushort)(uVar2 - 0x41) < 0x1a) {
        uVar2 = uVar2 + 0x20;
      }
      _Str2 = (wchar_t *)((ushort *)_Str2 + 1);
      _MaxCount = _MaxCount - 1;
    } while (((_MaxCount != 0) && (uVar1 != 0)) && (uVar1 == uVar2));
    iVar3 = (uint)uVar1 - (uint)uVar2;
  }
  return iVar3;
}



// Library Function - Single Match
//  int __cdecl _ValidateRead(void const * __ptr64,unsigned int)
// 
// Library: Visual Studio 2012 Release

int _ValidateRead(void *param_1,unsigned_int param_2)

{
  return (int)(-(uint)(param_1 != (void *)0x0) & 1);
}



// Library Function - Single Match
//  _CallSettingFrame
// 
// Library: Visual Studio 2012 Release

void _CallSettingFrame(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)FUN_18002d990();
  (*pcVar1)();
  FUN_18002d9c0();
  FUN_18002d990();
  return;
}



// Library Function - Single Match
//  _fileno
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _fileno(FILE *_File)

{
  int iVar1;
  int *piVar2;
  
  if (_File == (FILE *)0x0) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18002add8();
    iVar1 = -1;
  }
  else {
    iVar1 = _File->_file;
  }
  return iVar1;
}



// Library Function - Single Match
//  _isatty
// 
// Library: Visual Studio 2010 Release

int _isatty(int _FileHandle)

{
  int *piVar1;
  
  if (_FileHandle == -2) {
    piVar1 = _errno();
    *piVar1 = 9;
  }
  else {
    if ((-1 < _FileHandle) && ((uint)_FileHandle < DAT_180057ba8)) {
      return (int)*(char *)(*(longlong *)
                             ((longlong)&DAT_180055c80 + ((longlong)_FileHandle >> 5) * 8) + 8 +
                           (ulonglong)(_FileHandle & 0x1f) * 0x58) & 0x40;
    }
    piVar1 = _errno();
    *piVar1 = 9;
    FUN_18002add8();
  }
  return (int)0;
}



undefined4 FUN_18002eea0(uint param_1,wint_t *param_2,uint param_3)

{
  undefined4 uVar1;
  ulong *puVar2;
  int *piVar3;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    puVar2 = __doserrno();
    *puVar2 = 0;
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_180057ba8)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar4) & 1) != 0) {
        FUN_180032b3c(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar4) & 1) == 0) {
          piVar3 = _errno();
          *piVar3 = 9;
          puVar2 = __doserrno();
          *puVar2 = 0;
          uVar1 = 0xffffffff;
        }
        else {
          uVar1 = FUN_18002ef84(param_1,param_2,param_3);
        }
        FUN_180032cf4(param_1);
        return uVar1;
      }
    }
    puVar2 = __doserrno();
    *puVar2 = 0;
    piVar3 = _errno();
    *piVar3 = 9;
    FUN_18002add8();
  }
  return 0xffffffff;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_18002ef84(uint param_1,wint_t *param_2,uint param_3)

{
  char cVar1;
  wchar_t *pwVar2;
  uint uVar3;
  wint_t wVar4;
  int iVar5;
  BOOL BVar6;
  int iVar7;
  DWORD nNumberOfBytesToWrite;
  DWORD DVar8;
  ulong *puVar9;
  int *piVar10;
  _ptiddata p_Var11;
  ulonglong uVar12;
  uint uVar13;
  ulong uVar14;
  int iVar15;
  wint_t *pwVar16;
  longlong lVar17;
  wint_t *pwVar18;
  size_t sVar19;
  char cVar20;
  longlong lVar21;
  int iVar22;
  bool bVar23;
  int local_1b40;
  wint_t local_1b3c [2];
  longlong local_1b38;
  uint local_1b30 [2];
  longlong local_1b28;
  DWORD local_1b20;
  uint local_1b1c;
  UINT local_1b18;
  undefined local_1b14;
  char local_1b13;
  wint_t local_1af8 [856];
  wint_t local_1448 [2560];
  ulonglong local_48;
  undefined8 uStack64;
  
  iVar7 = (int)register0x00000020;
  uStack64 = 0x18002efa6;
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffe480;
  uVar13 = 0;
  local_1b40 = 0;
  uVar14 = 0;
  if (param_3 == 0) goto LAB_18002f74b;
  if (param_2 == (wint_t *)0x0) {
    puVar9 = __doserrno();
    *puVar9 = 0;
LAB_18002efea:
    piVar10 = _errno();
    *piVar10 = 0x16;
    FUN_18002add8();
    goto LAB_18002f74b;
  }
  local_1b38 = (longlong)(int)param_1 >> 5;
  lVar21 = (ulonglong)(param_1 & 0x1f) * 0x58;
  cVar20 = (char)(*(char *)(lVar21 + 0x38 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)
                           ) * '\x02') >> 1;
  local_1b28 = lVar21;
  if (((byte)(cVar20 - 1U) < 2) && ((~param_3 & 1) == 0)) {
    puVar9 = __doserrno();
    *puVar9 = 0;
    goto LAB_18002efea;
  }
  if ((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)) & 0x20) != 0
     ) {
    _lseeki64_nolock(param_1,0,2);
  }
  iVar5 = _isatty(param_1);
  iVar22 = (int)param_2;
  if ((iVar5 != 0) &&
     ((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)) & 0x80) != 0
     )) {
    p_Var11 = _getptd();
    pwVar2 = p_Var11->ptlocinfo->locale_name[2];
    BVar6 = GetConsoleMode(*(HANDLE *)
                            (lVar21 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)),
                           &local_1b1c);
    if ((BVar6 == 0) || ((pwVar2 == (wchar_t *)0x0 && (cVar20 == '\0')))) goto LAB_18002f3bb;
    local_1b18 = GetConsoleCP();
    wVar4 = 0;
    local_1b3c[0] = 0;
    local_1b20 = 0;
    pwVar16 = param_2;
    lVar17 = local_1b38;
    if (param_3 != 0) {
      do {
        lVar21 = local_1b28;
        bVar23 = false;
        uVar3 = uVar13;
        if (cVar20 == '\0') {
          cVar1 = *(char *)pwVar16;
          local_1b1c = (uint)(cVar1 == '\n');
          lVar17 = *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8);
          if (*(int *)(local_1b28 + 0x50 + lVar17) == 0) {
            iVar7 = isleadbyte((int)cVar1);
            if (iVar7 == 0) {
              sVar19 = 1;
              pwVar18 = pwVar16;
              goto LAB_18002f1a7;
            }
            if ((longlong)(((ulonglong)param_3 - (longlong)pwVar16) + (longlong)param_2) < 2) {
              uVar13 = uVar13 + 1;
              *(undefined *)
               (lVar21 + 0x4c + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)) =
                   *(undefined *)pwVar16;
              *(undefined4 *)
               (lVar21 + 0x50 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)) = 1;
              lVar17 = local_1b38;
              DVar8 = 0;
              break;
            }
            iVar7 = FUN_18002fd34((wchar_t *)local_1b3c,(char *)pwVar16,2);
            lVar17 = local_1b38;
            DVar8 = uVar14;
            if (iVar7 == -1) break;
            pwVar16 = (wint_t *)((longlong)pwVar16 + 1);
          }
          else {
            local_1b14 = *(undefined *)(local_1b28 + 0x4c + lVar17);
            *(undefined4 *)(local_1b28 + 0x50 + lVar17) = 0;
            sVar19 = 2;
            pwVar18 = (wint_t *)&local_1b14;
            local_1b13 = cVar1;
LAB_18002f1a7:
            iVar7 = FUN_18002fd34((wchar_t *)local_1b3c,(char *)pwVar18,sVar19);
            lVar17 = local_1b38;
            DVar8 = 0;
            if (iVar7 == -1) break;
          }
          pwVar16 = (wint_t *)((longlong)pwVar16 + 1);
          nNumberOfBytesToWrite =
               WideCharToMultiByte(local_1b18,0,(LPCWSTR)local_1b3c,1,&local_1b14,5,(LPCSTR)0x0,
                                   (LPBOOL)0x0);
          lVar17 = local_1b38;
          lVar21 = local_1b28;
          DVar8 = 0;
          if (nNumberOfBytesToWrite == 0) break;
          BVar6 = WriteFile(*(HANDLE *)
                             (local_1b28 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8))
                            ,&local_1b14,nNumberOfBytesToWrite,&local_1b20,(LPOVERLAPPED)0x0);
          lVar21 = local_1b28;
          if (BVar6 == 0) goto LAB_18002f365;
          uVar13 = ((int)pwVar16 - iVar22) + local_1b40;
          lVar17 = local_1b38;
          DVar8 = 0;
          if ((int)local_1b20 < (int)nNumberOfBytesToWrite) break;
          wVar4 = local_1b3c[0];
          uVar3 = uVar13;
          if (local_1b1c != 0) {
            local_1b14 = 0xd;
            BVar6 = WriteFile(*(HANDLE *)
                               (local_1b28 +
                               *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)),&local_1b14
                              ,1,&local_1b20,(LPOVERLAPPED)0x0);
            if (BVar6 == 0) goto LAB_18002f35b;
            lVar17 = local_1b38;
            DVar8 = uVar14;
            if ((int)local_1b20 < 1) break;
            local_1b40 = local_1b40 + 1;
            wVar4 = local_1b3c[0];
            uVar3 = uVar13 + 1;
          }
        }
        else {
          if ((byte)(cVar20 - 1U) < 2) {
            wVar4 = *pwVar16;
            bVar23 = wVar4 == 10;
            pwVar16 = pwVar16 + 1;
            local_1b3c[0] = wVar4;
          }
          if ((byte)(cVar20 - 1U) < 2) {
            wVar4 = _putwch_nolock(wVar4);
            if (wVar4 != local_1b3c[0]) goto LAB_18002f365;
            lVar21 = local_1b28;
            wVar4 = local_1b3c[0];
            uVar3 = uVar13 + 2;
            if (bVar23) {
              local_1b3c[0] = 0xd;
              wVar4 = _putwch_nolock(L'\r');
              if (wVar4 != local_1b3c[0]) goto LAB_18002f365;
              local_1b40 = local_1b40 + 1;
              lVar21 = local_1b28;
              wVar4 = local_1b3c[0];
              uVar3 = uVar13 + 3;
            }
          }
        }
        uVar13 = uVar3;
        lVar17 = local_1b38;
        DVar8 = uVar14;
      } while ((uint)((int)pwVar16 - iVar22) < param_3);
      goto LAB_18002f37b;
    }
    goto LAB_18002f713;
  }
LAB_18002f3bb:
  lVar17 = local_1b38;
  DVar8 = 0;
  if ((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)) & 0x80) == 0
     ) {
    BVar6 = WriteFile(*(HANDLE *)(lVar21 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8))
                      ,param_2,param_3,local_1b30,(LPOVERLAPPED)0x0);
    uVar13 = local_1b30[0];
    DVar8 = 0;
    if (BVar6 == 0) {
      DVar8 = GetLastError();
      uVar13 = 0;
    }
    goto LAB_18002f37b;
  }
  uVar14 = 0;
  if (cVar20 == '\0') {
    pwVar16 = param_2;
    if (param_3 == 0) goto LAB_18002f713;
    do {
      lVar21 = local_1b28;
      uVar12 = 0;
      pwVar18 = local_1448;
      do {
        if (param_3 <= (uint)((int)pwVar16 - iVar22)) break;
        cVar20 = *(char *)pwVar16;
        pwVar16 = (wint_t *)((longlong)pwVar16 + 1);
        if (cVar20 == '\n') {
          *(char *)pwVar18 = '\r';
          local_1b40 = local_1b40 + 1;
          pwVar18 = (wint_t *)((longlong)pwVar18 + 1);
          uVar12 = uVar12 + 1;
        }
        uVar12 = uVar12 + 1;
        *(char *)pwVar18 = cVar20;
        pwVar18 = (wint_t *)((longlong)pwVar18 + 1);
      } while (uVar12 < 0x13ff);
      BVar6 = WriteFile(*(HANDLE *)
                         (local_1b28 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)),
                        local_1448,(int)pwVar18 - (iVar7 + -0x1448),local_1b30,(LPOVERLAPPED)0x0);
      if (BVar6 == 0) goto LAB_18002f35b;
      uVar13 = uVar13 + local_1b30[0];
      lVar17 = local_1b38;
      DVar8 = uVar14;
    } while (((longlong)((longlong)pwVar18 - (longlong)local_1448) <= (longlong)(int)local_1b30[0])
            && ((uint)((int)pwVar16 - iVar22) < param_3));
    goto LAB_18002f37b;
  }
  if (cVar20 == '\x02') {
    pwVar16 = param_2;
    if (param_3 != 0) {
      do {
        lVar21 = local_1b28;
        uVar12 = 0;
        pwVar18 = local_1448;
        do {
          if (param_3 <= (uint)((int)pwVar16 - iVar22)) break;
          wVar4 = *pwVar16;
          pwVar16 = pwVar16 + 1;
          if (wVar4 == 10) {
            *pwVar18 = 0xd;
            local_1b40 = local_1b40 + 2;
            pwVar18 = pwVar18 + 1;
            uVar12 = uVar12 + 2;
          }
          uVar12 = uVar12 + 2;
          *pwVar18 = wVar4;
          pwVar18 = pwVar18 + 1;
        } while (uVar12 < 0x13fe);
        BVar6 = WriteFile(*(HANDLE *)
                           (local_1b28 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8)),
                          local_1448,(int)pwVar18 - (iVar7 + -0x1448),local_1b30,(LPOVERLAPPED)0x0);
        if (BVar6 == 0) goto LAB_18002f35b;
        uVar13 = uVar13 + local_1b30[0];
        lVar17 = local_1b38;
        DVar8 = uVar14;
      } while (((longlong)((longlong)pwVar18 - (longlong)local_1448) <= (longlong)(int)local_1b30[0]
               ) && ((uint)((int)pwVar16 - iVar22) < param_3));
      goto LAB_18002f37b;
    }
  }
  else {
    pwVar16 = param_2;
    if (param_3 != 0) {
      do {
        uVar12 = 0;
        pwVar18 = local_1af8;
        do {
          if (param_3 <= (uint)((int)pwVar16 - iVar22)) break;
          wVar4 = *pwVar16;
          pwVar16 = pwVar16 + 1;
          if (wVar4 == 10) {
            *pwVar18 = 0xd;
            pwVar18 = pwVar18 + 1;
            uVar12 = uVar12 + 2;
          }
          uVar12 = uVar12 + 2;
          *pwVar18 = wVar4;
          pwVar18 = pwVar18 + 1;
        } while (uVar12 < 0x6a8);
        iVar15 = 0;
        iVar5 = WideCharToMultiByte(0xfde9,0,(LPCWSTR)local_1af8,
                                    ((int)pwVar18 - (iVar7 + -0x1af8)) / 2,(LPSTR)local_1448,0xd55,
                                    (LPCSTR)0x0,(LPBOOL)0x0);
        uVar3 = uVar13;
        if (iVar5 == 0) goto LAB_18002f365;
        do {
          BVar6 = WriteFile(*(HANDLE *)
                             (local_1b28 + *(longlong *)((longlong)&DAT_180055c80 + local_1b38 * 8))
                            ,(LPCVOID)((longlong)local_1448 + (longlong)iVar15),iVar5 - iVar15,
                            local_1b30,(LPOVERLAPPED)0x0);
          if (BVar6 == 0) {
            DVar8 = GetLastError();
            break;
          }
          iVar15 = iVar15 + local_1b30[0];
        } while (iVar15 < iVar5);
        lVar17 = local_1b38;
        lVar21 = local_1b28;
      } while ((iVar5 <= iVar15) && (uVar13 = (int)pwVar16 - iVar22, uVar13 < param_3));
      goto LAB_18002f37b;
    }
  }
  goto LAB_18002f713;
LAB_18002f365:
  uVar13 = uVar3;
  DVar8 = GetLastError();
  lVar17 = local_1b38;
  lVar21 = local_1b28;
  goto LAB_18002f37b;
LAB_18002f35b:
  DVar8 = GetLastError();
  lVar17 = local_1b38;
LAB_18002f37b:
  if (uVar13 == 0) {
    if (DVar8 == 0) {
LAB_18002f713:
      if (((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_180055c80 + lVar17 * 8)) & 0x40) ==
           0) || (*(char *)param_2 != '\x1a')) {
        piVar10 = _errno();
        *piVar10 = 0x1c;
        puVar9 = __doserrno();
        *puVar9 = 0;
      }
    }
    else {
      if (DVar8 == 5) {
        piVar10 = _errno();
        *piVar10 = 9;
        puVar9 = __doserrno();
        *puVar9 = 5;
      }
      else {
        _dosmaperr(DVar8);
      }
    }
  }
LAB_18002f74b:
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xffffffffffffe480);
  return;
}



longlong FUN_18002f778(uint param_1,longlong param_2,int param_3)

{
  ulong *puVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_180057ba8)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar3) & 1) != 0) {
        FUN_180032b3c(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar3) & 1) == 0) {
          piVar2 = _errno();
          *piVar2 = 9;
          puVar1 = __doserrno();
          *puVar1 = 0;
          lVar3 = -1;
        }
        else {
          lVar3 = _lseeki64_nolock(param_1,param_2,param_3);
        }
        FUN_180032cf4(param_1);
        return lVar3;
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
    FUN_18002add8();
  }
  return -1;
}



// Library Function - Single Match
//  _lseeki64_nolock
// 
// Library: Visual Studio 2012 Release

longlong _lseeki64_nolock(int _FileHandle,longlong _Offset,int _Origin)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  int *piVar4;
  longlong local_res20;
  
  hFile = (HANDLE)FUN_180032c80(_FileHandle);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    piVar4 = _errno();
    *piVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,_Offset,&local_res20,_Origin);
    if (BVar2 != 0) {
      pbVar1 = (byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)_FileHandle >> 5) * 8) +
                        8 + (ulonglong)(_FileHandle & 0x1f) * 0x58);
      *pbVar1 = *pbVar1 & 0xfd;
      return local_res20;
    }
    DVar3 = GetLastError();
    _dosmaperr(DVar3);
  }
  return -1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _getbuf
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

void _getbuf(FILE *_File)

{
  char *pcVar1;
  
  _DAT_1800568b0 = _DAT_1800568b0 + 1;
  pcVar1 = (char *)FUN_180027ce8(0x1000);
  _File->_base = pcVar1;
  if (pcVar1 == (char *)0x0) {
    _File->_flag = _File->_flag | 4;
    _File->_bufsiz = 2;
    _File->_base = (char *)&_File->_charbuf;
  }
  else {
    _File->_flag = _File->_flag | 8;
    _File->_bufsiz = 0x1000;
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return;
}



// Library Function - Single Match
//  _isleadbyte_l
// 
// Library: Visual Studio 2012 Release

int _isleadbyte_l(int _C,_locale_t _Locale)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(_C & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return (int)(uVar1 & 0x8000);
}



// Library Function - Single Match
//  isleadbyte
// 
// Library: Visual Studio 2012 Release

int isleadbyte(int _C)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)0x0);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(_C & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return (int)(uVar1 & 0x8000);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FUN_18002f9d4(void)

{
  return _DAT_180056960 == (DAT_1800537e8 | 1);
}



void FUN_18002f9ec(wint_t param_1,FILE *param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  errno_t eVar4;
  ulonglong uVar5;
  undefined *puVar6;
  undefined *puVar7;
  char *pcVar8;
  undefined auStack88 [32];
  int local_38;
  char local_34 [12];
  ulonglong local_28;
  
  local_28 = DAT_1800537e8 ^ (ulonglong)auStack88;
  if ((*(byte *)&param_2->_flag & 0x40) == 0) {
    iVar2 = _fileno(param_2);
    puVar7 = &DAT_180053810;
    if ((iVar2 == -1) || (iVar2 = _fileno(param_2), iVar2 == -2)) {
      puVar6 = &DAT_180053810;
    }
    else {
      iVar2 = _fileno(param_2);
      uVar3 = _fileno(param_2);
      puVar6 = (undefined *)
               ((ulonglong)(uVar3 & 0x1f) * 0x58 +
               *(longlong *)((longlong)&DAT_180055c80 + ((longlong)iVar2 >> 5) * 8));
    }
    if ((puVar6[0x38] & 0x7f) != 2) {
      iVar2 = _fileno(param_2);
      if ((iVar2 == -1) || (iVar2 = _fileno(param_2), iVar2 == -2)) {
        puVar6 = &DAT_180053810;
      }
      else {
        iVar2 = _fileno(param_2);
        uVar3 = _fileno(param_2);
        puVar6 = (undefined *)
                 ((ulonglong)(uVar3 & 0x1f) * 0x58 +
                 *(longlong *)((longlong)&DAT_180055c80 + ((longlong)iVar2 >> 5) * 8));
      }
      if ((puVar6[0x38] & 0x7f) != 1) {
        iVar2 = _fileno(param_2);
        if ((iVar2 != -1) && (iVar2 = _fileno(param_2), iVar2 != -2)) {
          iVar2 = _fileno(param_2);
          uVar3 = _fileno(param_2);
          puVar7 = (undefined *)
                   ((ulonglong)(uVar3 & 0x1f) * 0x58 +
                   *(longlong *)((longlong)&DAT_180055c80 + ((longlong)iVar2 >> 5) * 8));
        }
        if ((puVar7[8] & 0x80) != 0) {
          eVar4 = wctomb_s(&local_38,local_34,5,param_1);
          iVar2 = 0;
          if ((eVar4 == 0) && (0 < local_38)) {
            pcVar8 = local_34;
            do {
              piVar1 = &param_2->_cnt;
              *piVar1 = *piVar1 + -1;
              if (*piVar1 < 0) {
                uVar5 = FUN_18002ae34((int)*pcVar8,param_2);
                uVar3 = (uint)uVar5;
              }
              else {
                *param_2->_ptr = *pcVar8;
                uVar3 = (uint)(byte)*param_2->_ptr;
                param_2->_ptr = param_2->_ptr + 1;
              }
              if (uVar3 == 0xffffffff) break;
              iVar2 = iVar2 + 1;
              pcVar8 = pcVar8 + 1;
            } while (iVar2 < local_38);
          }
          goto LAB_18002fbbf;
        }
        goto LAB_18002fb96;
      }
    }
    iVar2 = param_2->_cnt + -2;
    param_2->_cnt = iVar2;
    if (iVar2 < 0) {
LAB_18002fbb4:
      FUN_180032d7c(param_1,param_2);
      goto LAB_18002fbbf;
    }
    *(wint_t *)param_2->_ptr = param_1;
  }
  else {
LAB_18002fb96:
    iVar2 = param_2->_cnt + -2;
    param_2->_cnt = iVar2;
    if (iVar2 < 0) goto LAB_18002fbb4;
    *(wint_t *)param_2->_ptr = param_1;
  }
  param_2->_ptr = param_2->_ptr + 2;
LAB_18002fbbf:
  FUN_180023ef0(local_28 ^ (ulonglong)auStack88);
  return;
}



// Library Function - Single Match
//  _mbtowc_l
// 
// Library: Visual Studio 2012 Release

int _mbtowc_l(wchar_t *_DstCh,char *_SrcCh,size_t _SrcSizeInBytes,_locale_t _Locale)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  localeinfo_struct local_28;
  longlong local_18;
  char local_10;
  
  if ((_SrcCh != (char *)0x0) && (_SrcSizeInBytes != 0)) {
    if (*_SrcCh != '\0') {
      _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(localeinfo_struct *)_Locale);
      if ((local_28.locinfo)->locale_name[2] == (wchar_t *)0x0) {
        if (_DstCh != (wchar_t *)0x0) {
          *_DstCh = (ushort)(byte)*_SrcCh;
        }
        iVar2 = 1;
      }
      else {
        iVar1 = _isleadbyte_l((uint)(byte)*_SrcCh,(_locale_t)&local_28);
        iVar2 = 1;
        if (iVar1 == 0) {
          iVar1 = MultiByteToWideChar((local_28.locinfo)->lc_codepage,9,_SrcCh,1,_DstCh,
                                      (uint)(_DstCh != (wchar_t *)0x0));
          if (iVar1 != 0) goto LAB_18002fd17;
        }
        else {
          iVar2 = (local_28.locinfo)->mb_cur_max;
          if ((((1 < iVar2) && (iVar2 <= (int)_SrcSizeInBytes)) &&
              (iVar2 = MultiByteToWideChar((local_28.locinfo)->lc_codepage,9,_SrcCh,iVar2,_DstCh,
                                           (uint)(_DstCh != (wchar_t *)0x0)), iVar2 != 0)) ||
             (((ulonglong)(longlong)(local_28.locinfo)->mb_cur_max <= _SrcSizeInBytes &&
              (_SrcCh[1] != '\0')))) {
            iVar2 = (local_28.locinfo)->mb_cur_max;
            goto LAB_18002fd17;
          }
        }
        piVar3 = _errno();
        iVar2 = -1;
        *piVar3 = 0x2a;
      }
LAB_18002fd17:
      if (local_10 == '\0') {
        return iVar2;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return iVar2;
    }
    if (_DstCh != (wchar_t *)0x0) {
      *_DstCh = L'\0';
    }
  }
  return 0;
}



void FUN_18002fd34(wchar_t *param_1,char *param_2,size_t param_3)

{
  _mbtowc_l(param_1,param_2,param_3,(_locale_t)0x0);
  return;
}



// Library Function - Single Match
//  __free_lconv_mon
// 
// Library: Visual Studio 2012 Release

void __free_lconv_mon(longlong param_1)

{
  if (param_1 != 0) {
    if (*(undefined **)(param_1 + 0x18) != PTR_DAT_180054bd8) {
      free(*(undefined **)(param_1 + 0x18));
    }
    if (*(undefined **)(param_1 + 0x20) != PTR_DAT_180054be0) {
      free(*(undefined **)(param_1 + 0x20));
    }
    if (*(undefined **)(param_1 + 0x28) != PTR_DAT_180054be8) {
      free(*(undefined **)(param_1 + 0x28));
    }
    if (*(undefined **)(param_1 + 0x30) != PTR_DAT_180054bf0) {
      free(*(undefined **)(param_1 + 0x30));
    }
    if (*(undefined **)(param_1 + 0x38) != PTR_DAT_180054bf8) {
      free(*(undefined **)(param_1 + 0x38));
    }
    if (*(undefined **)(param_1 + 0x40) != PTR_DAT_180054c00) {
      free(*(undefined **)(param_1 + 0x40));
    }
    if (*(undefined **)(param_1 + 0x48) != PTR_DAT_180054c08) {
      free(*(undefined **)(param_1 + 0x48));
    }
    if (*(undefined **)(param_1 + 0x68) != PTR_DAT_180054c28) {
      free(*(undefined **)(param_1 + 0x68));
    }
    if (*(undefined **)(param_1 + 0x70) != PTR_DAT_180054c30) {
      free(*(undefined **)(param_1 + 0x70));
    }
    if (*(undefined **)(param_1 + 0x78) != PTR_DAT_180054c38) {
      free(*(undefined **)(param_1 + 0x78));
    }
    if (*(undefined **)(param_1 + 0x80) != PTR_DAT_180054c40) {
      free(*(undefined **)(param_1 + 0x80));
    }
    if (*(undefined **)(param_1 + 0x88) != PTR_DAT_180054c48) {
      free(*(undefined **)(param_1 + 0x88));
    }
    if (*(undefined **)(param_1 + 0x90) != PTR_DAT_180054c50) {
      free(*(undefined **)(param_1 + 0x90));
    }
  }
  return;
}



// Library Function - Single Match
//  __free_lconv_num
// 
// Library: Visual Studio 2012 Release

void __free_lconv_num(void **param_1)

{
  if (param_1 != (void **)0x0) {
    if ((undefined *)*param_1 != PTR_DAT_180054bc0) {
      free(*param_1);
    }
    if ((undefined *)param_1[1] != PTR_DAT_180054bc8) {
      free(param_1[1]);
    }
    if ((undefined *)param_1[2] != PTR_DAT_180054bd0) {
      free(param_1[2]);
    }
    if ((undefined *)param_1[0xb] != PTR_DAT_180054c18) {
      free(param_1[0xb]);
    }
    if ((undefined *)param_1[0xc] != PTR_DAT_180054c20) {
      free(param_1[0xc]);
    }
  }
  return;
}



// Library Function - Single Match
//  __free_lc_time
// 
// Library: Visual Studio 2012 Release

void __free_lc_time(void **param_1)

{
  if (param_1 != (void **)0x0) {
    free(param_1[1]);
    free(param_1[2]);
    free(param_1[3]);
    free(param_1[4]);
    free(param_1[5]);
    free(param_1[6]);
    free(*param_1);
    free(param_1[8]);
    free(param_1[9]);
    free(param_1[10]);
    free(param_1[0xb]);
    free(param_1[0xc]);
    free(param_1[0xd]);
    free(param_1[7]);
    free(param_1[0xe]);
    free(param_1[0xf]);
    free(param_1[0x10]);
    free(param_1[0x11]);
    free(param_1[0x12]);
    free(param_1[0x13]);
    free(param_1[0x14]);
    free(param_1[0x15]);
    free(param_1[0x16]);
    free(param_1[0x17]);
    free(param_1[0x18]);
    free(param_1[0x19]);
    free(param_1[0x1a]);
    free(param_1[0x1b]);
    free(param_1[0x1c]);
    free(param_1[0x1d]);
    free(param_1[0x1e]);
    free(param_1[0x1f]);
    free(param_1[0x20]);
    free(param_1[0x21]);
    free(param_1[0x22]);
    free(param_1[0x23]);
    free(param_1[0x24]);
    free(param_1[0x25]);
    free(param_1[0x26]);
    free(param_1[0x27]);
    free(param_1[0x28]);
    free(param_1[0x29]);
    free(param_1[0x2a]);
    free(param_1[0x2d]);
    free(param_1[0x2e]);
    free(param_1[0x2f]);
    free(param_1[0x30]);
    free(param_1[0x31]);
    free(param_1[0x32]);
    free(param_1[0x2c]);
    free(param_1[0x34]);
    free(param_1[0x35]);
    free(param_1[0x36]);
    free(param_1[0x37]);
    free(param_1[0x38]);
    free(param_1[0x39]);
    free(param_1[0x33]);
    free(param_1[0x3a]);
    free(param_1[0x3b]);
    free(param_1[0x3c]);
    free(param_1[0x3d]);
    free(param_1[0x3e]);
    free(param_1[0x3f]);
    free(param_1[0x40]);
    free(param_1[0x41]);
    free(param_1[0x42]);
    free(param_1[0x43]);
    free(param_1[0x44]);
    free(param_1[0x45]);
    free(param_1[0x46]);
    free(param_1[0x47]);
    free(param_1[0x48]);
    free(param_1[0x49]);
    free(param_1[0x4a]);
    free(param_1[0x4b]);
    free(param_1[0x4c]);
    free(param_1[0x4d]);
    free(param_1[0x4e]);
    free(param_1[0x4f]);
    free(param_1[0x50]);
    free(param_1[0x51]);
    free(param_1[0x52]);
    free(param_1[0x53]);
    free(param_1[0x54]);
    free(param_1[0x55]);
    free(param_1[0x56]);
    free(param_1[0x57]);
  }
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_1800302b0(longlong *param_1,wchar_t *param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  ulonglong _Size;
  size_t _Size_00;
  longlong lVar1;
  wchar_t *pwVar2;
  int iVar3;
  char *pcVar4;
  undefined4 *puVar5;
  undefined4 *lpWideCharStr;
  undefined *puVar6;
  undefined *puVar7;
  undefined *puVar8;
  int iVar9;
  ulonglong uVar10;
  undefined4 auStack64 [2];
  wchar_t *local_38;
  ulonglong local_30;
  
  puVar7 = &stack0xffffffffffffff88;
  puVar6 = &stack0xffffffffffffff88;
  local_30 = DAT_1800537e8 ^ (ulonglong)&local_38;
  puVar5 = (undefined4 *)0x0;
  pcVar4 = param_4;
  iVar9 = param_5;
  if (0 < param_5) {
    do {
      iVar9 = iVar9 + -1;
      if (*pcVar4 == '\0') goto LAB_18003030a;
      pcVar4 = pcVar4 + 1;
    } while (iVar9 != 0);
    iVar9 = -1;
LAB_18003030a:
    iVar3 = (param_5 - iVar9) + -1;
    iVar9 = param_5 - iVar9;
    if (param_5 <= iVar3) {
      iVar9 = iVar3;
    }
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*param_1 + 4);
  }
  local_38 = param_2;
  iVar3 = MultiByteToWideChar(param_8,(-(uint)(param_9 != 0) & 8) + 1,param_4,iVar9,(LPWSTR)0x0,0);
  uVar10 = SEXT48(iVar3);
  if (iVar3 == 0) goto LAB_180030576;
  puVar7 = &stack0xffffffffffffff88;
  if (((0 < iVar3) && (puVar7 = &stack0xffffffffffffff88, 1 < 0xffffffffffffffe0 / uVar10)) &&
     (puVar7 = &stack0xffffffffffffff88, uVar10 * 2 < uVar10 * 2 + 0x10)) {
    _Size = uVar10 * 2 + 0x10;
    if (_Size < 0x401) {
      uVar10 = uVar10 * 2 + 0x1f;
      if (uVar10 <= _Size) {
        uVar10 = 0xffffffffffffff0;
      }
      lVar1 = -(uVar10 & 0xfffffffffffffff0);
      puVar7 = &stack0xffffffffffffff80 + lVar1;
      puVar6 = &stack0xffffffffffffff80 + lVar1;
      puVar5 = (undefined4 *)((longlong)auStack64 + lVar1);
      if (puVar5 == (undefined4 *)0x0) goto LAB_180030576;
      *puVar5 = 0xcccc;
    }
    else {
      puVar5 = (undefined4 *)malloc(_Size);
      puVar7 = &stack0xffffffffffffff88;
      if (puVar5 == (undefined4 *)0x0) goto LAB_1800303db;
      *puVar5 = 0xdddd;
    }
    puVar5 = puVar5 + 4;
    puVar7 = puVar6;
  }
LAB_1800303db:
  if (puVar5 == (undefined4 *)0x0) goto LAB_180030576;
  *(int *)(puVar7 + 0x28) = iVar3;
  *(undefined4 **)(puVar7 + 0x20) = puVar5;
  *(undefined8 *)(puVar7 + -8) = 0x180030402;
  iVar9 = MultiByteToWideChar(param_8,1,param_4,iVar9,*(LPWSTR *)(puVar7 + 0x20),
                              *(int *)(puVar7 + 0x28));
  pwVar2 = local_38;
  puVar8 = puVar7;
  if (iVar9 != 0) {
    *(undefined4 *)(puVar7 + 0x28) = 0;
    *(undefined8 *)(puVar7 + 0x20) = 0;
    *(undefined8 *)(puVar7 + -8) = 0x180030428;
    iVar9 = FUN_18002ecc4(pwVar2,param_3,(LPCWSTR)puVar5,iVar3,*(LPWSTR *)(puVar7 + 0x20),
                          *(int *)(puVar7 + 0x28));
    uVar10 = SEXT48(iVar9);
    if (iVar9 != 0) {
      if ((param_3 & 0x400) == 0) {
        if (((iVar9 < 1) || (0xffffffffffffffe0 / uVar10 < 2)) || (uVar10 * 2 + 0x10 <= uVar10 * 2))
        {
          lpWideCharStr = (undefined4 *)0x0;
        }
        else {
          _Size_00 = uVar10 * 2 + 0x10;
          if (_Size_00 < 0x401) {
            uVar10 = uVar10 * 2 + 0x1f;
            if (uVar10 <= _Size_00) {
              uVar10 = 0xffffffffffffff0;
            }
            *(undefined8 *)(puVar7 + -8) = 0x1800304bd;
            lVar1 = -(uVar10 & 0xfffffffffffffff0);
            puVar8 = puVar7 + lVar1 + -8;
            lpWideCharStr = (undefined4 *)(puVar7 + lVar1 + 0x38);
            if (lpWideCharStr == (undefined4 *)0x0) goto LAB_180030563;
            *lpWideCharStr = 0xcccc;
            puVar7 = puVar7 + lVar1 + -8;
          }
          else {
            *(undefined8 *)(puVar7 + -8) = 0x1800304db;
            lpWideCharStr = (undefined4 *)malloc(_Size_00);
            if (lpWideCharStr == (undefined4 *)0x0) goto LAB_1800304f1;
            *lpWideCharStr = 0xdddd;
          }
          lpWideCharStr = lpWideCharStr + 4;
          puVar8 = puVar7;
        }
LAB_1800304f1:
        if (lpWideCharStr != (undefined4 *)0x0) {
          *(int *)(puVar8 + 0x28) = iVar9;
          *(undefined4 **)(puVar8 + 0x20) = lpWideCharStr;
          *(undefined8 *)(puVar8 + -8) = 0x180030510;
          iVar3 = FUN_18002ecc4(pwVar2,param_3,(LPCWSTR)puVar5,iVar3,*(LPWSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28));
          if (iVar3 != 0) {
            *(undefined8 *)(puVar8 + 0x38) = 0;
            *(undefined8 *)(puVar8 + 0x30) = 0;
            if (param_7 == 0) {
              *(undefined4 *)(puVar8 + 0x28) = 0;
              *(undefined8 *)(puVar8 + 0x20) = 0;
            }
            else {
              *(int *)(puVar8 + 0x28) = param_7;
              *(undefined8 *)(puVar8 + 0x20) = param_6;
            }
            *(undefined8 *)(puVar8 + -8) = 0x180030550;
            WideCharToMultiByte(param_8,0,(LPCWSTR)lpWideCharStr,iVar9,*(LPSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28),*(LPCSTR *)(puVar8 + 0x30),
                                *(LPBOOL *)(puVar8 + 0x38));
          }
          if (lpWideCharStr[-4] == 0xdddd) {
            *(undefined8 *)(puVar8 + -8) = 0x180030563;
            free(lpWideCharStr + -4);
          }
        }
      }
      else {
        if ((param_7 != 0) && (iVar9 <= param_7)) {
          *(int *)(puVar7 + 0x28) = param_7;
          *(undefined8 *)(puVar7 + 0x20) = param_6;
          *(undefined8 *)(puVar7 + -8) = 0x18003046f;
          FUN_18002ecc4(pwVar2,param_3,(LPCWSTR)puVar5,iVar3,*(LPWSTR *)(puVar7 + 0x20),
                        *(int *)(puVar7 + 0x28));
        }
      }
    }
  }
LAB_180030563:
  puVar7 = puVar8;
  if (puVar5[-4] == 0xdddd) {
    *(undefined8 *)(puVar8 + -8) = 0x180030574;
    free(puVar5 + -4);
  }
LAB_180030576:
  uVar10 = local_30 ^ (ulonglong)&local_38;
  *(undefined8 *)(puVar7 + -8) = 0x180030582;
  FUN_180023ef0(uVar10);
  return;
}



// Library Function - Single Match
//  __crtLCMapStringA
// 
// Library: Visual Studio 2012 Release

int __crtLCMapStringA(_locale_t _Plocinfo,LPCWSTR _LocaleName,DWORD _DwMapFlag,LPCSTR _LpSrcStr,
                     int _CchSrc,LPSTR _LpDestStr,int _CchDest,int _Code_page,BOOL _BError)

{
  int iVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Plocinfo);
  iVar1 = FUN_1800302b0(local_28,_LocaleName,_DwMapFlag,_LpSrcStr,_CchSrc,_LpDestStr,_CchDest,
                        _Code_page,_BError);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return iVar1;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_180030634(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  ulonglong _Size;
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined (*lpSrcStr) [16];
  undefined *puVar4;
  undefined *puVar5;
  ulonglong uVar6;
  ulonglong local_38 [2];
  
  puVar5 = &stack0xffffffffffffff98;
  puVar4 = &stack0xffffffffffffff98;
  local_38[0] = DAT_1800537e8 ^ (ulonglong)local_38;
  lpSrcStr = (undefined (*) [16])0x0;
  if (param_6 == 0) {
    param_6 = *(UINT *)(*param_1 + 4);
  }
  iVar2 = MultiByteToWideChar(param_6,(-(uint)(param_7 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,0)
  ;
  uVar6 = SEXT48(iVar2);
  if (iVar2 == 0) goto LAB_180030784;
  puVar5 = &stack0xffffffffffffff98;
  if (((0 < iVar2) && (puVar5 = &stack0xffffffffffffff98, uVar6 < 0x7ffffffffffffff1)) &&
     (puVar5 = &stack0xffffffffffffff98, uVar6 * 2 < uVar6 * 2 + 0x10)) {
    _Size = uVar6 * 2 + 0x10;
    if (_Size < 0x401) {
      uVar3 = uVar6 * 2 + 0x1f;
      if (uVar3 <= _Size) {
        uVar3 = 0xffffffffffffff0;
      }
      lVar1 = -(uVar3 & 0xfffffffffffffff0);
      puVar5 = &stack0xffffffffffffff90 + lVar1;
      puVar4 = &stack0xffffffffffffff90 + lVar1;
      lpSrcStr = (undefined (*) [16])(&stack0xffffffffffffffc0 + lVar1);
      if (lpSrcStr == (undefined (*) [16])0x0) goto LAB_180030784;
      *(undefined4 *)*lpSrcStr = 0xcccc;
    }
    else {
      lpSrcStr = (undefined (*) [16])malloc(_Size);
      puVar5 = &stack0xffffffffffffff98;
      if (lpSrcStr == (undefined (*) [16])0x0) goto LAB_180030722;
      *(undefined4 *)*lpSrcStr = 0xdddd;
    }
    lpSrcStr = lpSrcStr[1];
    puVar5 = puVar4;
  }
LAB_180030722:
  if (lpSrcStr != (undefined (*) [16])0x0) {
    *(undefined8 *)(puVar5 + -8) = 0x18003073b;
    FUN_1800244a0(lpSrcStr,0,uVar6 * 2);
    *(int *)(puVar5 + 0x28) = iVar2;
    *(undefined (**) [16])(puVar5 + 0x20) = lpSrcStr;
    *(undefined8 *)(puVar5 + -8) = 0x180030758;
    iVar2 = MultiByteToWideChar(param_6,1,param_3,param_4,*(LPWSTR *)(puVar5 + 0x20),
                                *(int *)(puVar5 + 0x28));
    if (iVar2 != 0) {
      *(undefined8 *)(puVar5 + -8) = 0x18003076f;
      GetStringTypeW(param_2,(LPCWSTR)lpSrcStr,iVar2,param_5);
    }
    if (*(int *)lpSrcStr[-1] == 0xdddd) {
      *(undefined8 *)(puVar5 + -8) = 0x180030782;
      free(lpSrcStr[-1]);
    }
  }
LAB_180030784:
  uVar6 = local_38[0] ^ (ulonglong)local_38;
  *(undefined8 *)(puVar5 + -8) = 0x180030790;
  FUN_180023ef0(uVar6);
  return;
}



// Library Function - Single Match
//  __crtGetStringTypeA
// 
// Library: Visual Studio 2012 Release

BOOL __crtGetStringTypeA(_locale_t _Plocinfo,DWORD _DWInfoType,LPCSTR _LpSrcStr,int _CchSrc,
                        LPWORD _LpCharType,int _Code_page,BOOL _BError)

{
  BOOL BVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Plocinfo);
  BVar1 = FUN_180030634(local_28,_DWInfoType,_LpSrcStr,_CchSrc,_LpCharType,_Code_page,_BError);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return BVar1;
}



// Library Function - Single Match
//  _wctomb_s_l
// 
// Library: Visual Studio 2012 Release

errno_t _wctomb_s_l(int *_SizeConverted,char *_MbCh,size_t _SizeInBytes,wchar_t _WCh,
                   _locale_t _Locale)

{
  int iVar1;
  DWORD DVar2;
  int *piVar3;
  errno_t eVar4;
  int local_res10 [2];
  ushort local_res20 [4];
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((_MbCh == (char *)0x0) && (_SizeInBytes != 0)) {
    if (_SizeConverted != (int *)0x0) {
      *_SizeConverted = 0;
    }
    return 0;
  }
  if (_SizeConverted != (int *)0x0) {
    *_SizeConverted = -1;
  }
  local_res20[0] = _WCh;
  if (0x7fffffff < _SizeInBytes) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18002add8();
    return 0x16;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  if (*(longlong *)(local_28[0] + 0x138) == 0) {
    if (local_res20[0] < 0x100) {
      if (_MbCh != (char *)0x0) {
        if (_SizeInBytes == 0) goto LAB_18003099c;
        *_MbCh = (char)local_res20[0];
      }
      if (_SizeConverted != (int *)0x0) {
        *_SizeConverted = 1;
      }
LAB_18003096f:
      eVar4 = 0;
      goto LAB_1800308de;
    }
    if ((_MbCh != (char *)0x0) && (_SizeInBytes != 0)) {
      FUN_1800244a0((undefined (*) [16])_MbCh,0,_SizeInBytes);
    }
  }
  else {
    local_res10[0] = 0;
    iVar1 = WideCharToMultiByte(*(UINT *)(local_28[0] + 4),0,(LPCWSTR)local_res20,1,_MbCh,
                                (int)_SizeInBytes,(LPCSTR)0x0,local_res10);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        if ((_MbCh != (char *)0x0) && (_SizeInBytes != 0)) {
          FUN_1800244a0((undefined (*) [16])_MbCh,0,_SizeInBytes);
        }
LAB_18003099c:
        piVar3 = _errno();
        eVar4 = 0x22;
        *piVar3 = 0x22;
        FUN_18002add8();
        goto LAB_1800308de;
      }
    }
    else {
      if (local_res10[0] == 0) {
        if (_SizeConverted != (int *)0x0) {
          *_SizeConverted = iVar1;
        }
        goto LAB_18003096f;
      }
    }
  }
  piVar3 = _errno();
  *piVar3 = 0x2a;
  piVar3 = _errno();
  eVar4 = *piVar3;
LAB_1800308de:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return eVar4;
}



// Library Function - Single Match
//  wctomb_s
// 
// Library: Visual Studio 2012 Release

errno_t wctomb_s(int *_SizeConverted,char *_MbCh,rsize_t _SizeInBytes,wchar_t _WCh)

{
  errno_t eVar1;
  
  eVar1 = _wctomb_s_l(_SizeConverted,_MbCh,_SizeInBytes,_WCh,(_locale_t)0x0);
  return eVar1;
}



// WARNING: Removing unreachable block (ram,0x000180030b63)
// WARNING: Removing unreachable block (ram,0x000180030b0f)
// WARNING: Removing unreachable block (ram,0x000180030b19)

int FUN_1800309c8(FILE *param_1)

{
  void *_File;
  FILE *pFVar1;
  uint uVar2;
  DWORD DVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  
  if (param_1 != (FILE *)0x0) {
    iVar5 = _flush(param_1);
    if (iVar5 == 0) {
      if ((param_1->_flag & 0x4000U) == 0) {
        iVar5 = 0;
      }
      else {
        uVar2 = _fileno(param_1);
        DVar3 = FUN_180032f0c(uVar2);
        iVar5 = -(uint)(DVar3 != 0);
      }
    }
    else {
      iVar5 = -1;
    }
    return iVar5;
  }
  iVar6 = 0;
  _lock(1);
  for (iVar5 = 0; iVar5 < DAT_180056a60; iVar5 = iVar5 + 1) {
    lVar7 = (longlong)iVar5;
    _File = *(void **)(DAT_180056a58 + lVar7 * 8);
    if ((_File != (void *)0x0) && ((*(byte *)((longlong)_File + 0x18) & 0x83) != 0)) {
      _lock_file2(iVar5,_File);
      pFVar1 = *(FILE **)(DAT_180056a58 + lVar7 * 8);
      if (((*(byte *)&pFVar1->_flag & 0x83) != 0) &&
         (((*(byte *)&pFVar1->_flag & 2) != 0 && (iVar4 = FUN_1800309c8(pFVar1), iVar4 == -1)))) {
        iVar6 = -1;
      }
      FUN_18002db80(iVar5,*(longlong *)(DAT_180056a58 + lVar7 * 8));
    }
  }
  FUN_18002d5f0(1);
  return iVar6;
}



// Library Function - Single Match
//  _flush
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _flush(FILE *_File)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  
  iVar2 = 0;
  iVar3 = 0;
  if (((((byte)_File->_flag & 3) == 2) && (iVar3 = iVar2, (_File->_flag & 0x108U) != 0)) &&
     (uVar4 = *(int *)&_File->_ptr - *(int *)&_File->_base, 0 < (int)uVar4)) {
    uVar1 = _fileno(_File);
    uVar1 = FUN_18002eea0(uVar1,(wint_t *)_File->_base,uVar4);
    if (uVar1 == uVar4) {
      if ((char)_File->_flag < '\0') {
        _File->_flag = _File->_flag & 0xfffffffd;
      }
    }
    else {
      _File->_flag = _File->_flag | 0x20;
      iVar3 = -1;
    }
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return iVar3;
}



// WARNING: Removing unreachable block (ram,0x000180030b21)
// WARNING: Removing unreachable block (ram,0x000180030b26)
// WARNING: Removing unreachable block (ram,0x000180030b2c)
// WARNING: Removing unreachable block (ram,0x000180030b34)
// WARNING: Removing unreachable block (ram,0x000180030b38)

int FUN_180030a90(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  void *_File;
  FILE *pFVar1;
  int iVar2;
  int _Index;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  _lock(1);
  for (_Index = 0; _Index < DAT_180056a60; _Index = _Index + 1) {
    lVar4 = (longlong)_Index;
    _File = *(void **)(DAT_180056a58 + lVar4 * 8);
    if ((_File != (void *)0x0) && ((*(byte *)((longlong)_File + 0x18) & 0x83) != 0)) {
      _lock_file2(_Index,_File);
      pFVar1 = *(FILE **)(DAT_180056a58 + lVar4 * 8);
      if (((*(byte *)&pFVar1->_flag & 0x83) != 0) && (iVar2 = FUN_1800309c8(pFVar1), iVar2 != -1)) {
        iVar3 = iVar3 + 1;
      }
      FUN_18002db80(_Index,*(longlong *)(DAT_180056a58 + lVar4 * 8));
    }
  }
  FUN_18002d5f0(1);
  return iVar3;
}



// Library Function - Single Match
//  _fcloseall
// 
// Library: Visual Studio 2012 Release

int _fcloseall(void)

{
  FILE *_File;
  int iVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  
  iVar4 = 0;
  _lock(1);
  for (iVar2 = 3; iVar2 < DAT_180056a60; iVar2 = iVar2 + 1) {
    lVar3 = (longlong)iVar2;
    _File = *(FILE **)(DAT_180056a58 + lVar3 * 8);
    if (_File != (FILE *)0x0) {
      if ((*(byte *)&_File->_flag & 0x83) != 0) {
        iVar1 = fclose(_File);
        if (iVar1 != -1) {
          iVar4 = iVar4 + 1;
        }
      }
      if (0x13 < iVar2) {
        DeleteCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(DAT_180056a58 + lVar3 * 8) + 0x30))
        ;
        free(*(void **)(DAT_180056a58 + lVar3 * 8));
        *(undefined8 *)(DAT_180056a58 + lVar3 * 8) = 0;
      }
    }
  }
  FUN_18002d5f0(1);
  return iVar4;
}



// Library Function - Single Match
//  _get_fpsr
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release, Visual Studio 2015 Release,
// Visual Studio 2019 Release

undefined4 _get_fpsr(void)

{
  undefined4 in_MXCSR;
  
  return in_MXCSR;
}



void FUN_180030c50(void)

{
  return;
}



// Library Function - Single Match
//  _fclrf
// 
// Library: Visual Studio

void _fclrf(void)

{
  return;
}



void FUN_180030c90(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  undefined8 *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined auStack136 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800537e8 ^ (ulonglong)auStack136;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_180054ca8 + -1;
    uVar7 = DAT_180054ca8 >> 0x1f & 0x1f;
    uVar1 = DAT_180054ca8 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180030db1;
        }
      }
      else {
LAB_180030db1:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *(uint *)puVar13 = *(uint *)puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_1800244a0((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_180054ca4 - DAT_180054ca8) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else {
      if (DAT_180054ca4 < iVar11) {
        uVar10 = DAT_180054cac >> 0x1f & 0x1f;
        iVar15 = DAT_180054cac + uVar10;
        bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
        iVar15 = iVar15 >> 5;
        uVar10 = ~(-1 << (bVar4 & 0x1f));
        if (iVar11 < DAT_180054ca0) {
          local_40 = local_40 & 0xffffffff7fffffff;
          iVar2 = DAT_180054cb4 + iVar11;
          puVar13 = &local_40;
          do {
            uVar1 = *(uint *)puVar13;
            *(uint *)puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
        }
        else {
          local_40 = 0x80000000;
          local_38 = 0;
          puVar13 = &local_40;
          do {
            uVar1 = (uint)uVar3;
            uVar3 = (ulonglong)((uVar10 & *(uint *)puVar13) << (0x20 - bVar4 & 0x1f));
            *(uint *)puVar13 = *(uint *)puVar13 >> (bVar4 & 0x1f) | uVar1;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
          iVar2 = DAT_180054cb4 + DAT_180054ca0;
        }
      }
      else {
        local_40 = local_48;
        local_38 = local_50;
        uVar10 = DAT_180054ca4 - local_68 >> 0x1f & 0x1f;
        puVar13 = &local_40;
        iVar2 = (DAT_180054ca4 - local_68) + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        uVar6 = uVar3;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar16 = (longlong)(iVar2 >> 5);
        lVar17 = 2;
        lVar18 = 3;
        lVar5 = 2;
        do {
          if (lVar5 < lVar16) {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
          }
          lVar5 = lVar5 + -1;
        } while (-1 < lVar5);
        uVar1 = local_60 + 1 >> 0x1f & 0x1f;
        uVar10 = local_60 + 1 + uVar1;
        iVar2 = (int)uVar10 >> 5;
        uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
        bVar4 = (byte)uVar10;
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
          if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0)
          {
            for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
              if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180030f8b;
            }
          }
          else {
LAB_180030f8b:
            uVar10 = local_60 >> 0x1f & 0x1f;
            iVar11 = local_60 + uVar10;
            iVar15 = iVar11 >> 5;
            uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
            uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
            uVar10 = uVar1 + uVar7;
            if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
            lVar5 = (longlong)(iVar15 + -1);
            if (-1 < iVar15 + -1) {
              do {
                if ((int)uVar6 == 0) break;
                uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
                uVar10 = uVar1 + 1;
                if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                  uVar6 = uVar9;
                }
                *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
                lVar5 = lVar5 + -1;
              } while (-1 < lVar5);
            }
          }
        }
        puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar2 * 4);
        *(uint *)puVar13 = *(uint *)puVar13 & -1 << (bVar4 & 0x1f);
        lVar5 = (longlong)(iVar2 + 1);
        if (lVar5 < 3) {
          FUN_1800244a0((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
        }
        puVar13 = &local_40;
        uVar10 = DAT_180054cac + 1 >> 0x1f & 0x1f;
        iVar2 = DAT_180054cac + 1 + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar18 = lVar18 + -1;
        } while (lVar18 != 0);
        lVar5 = (longlong)(iVar2 >> 5);
        do {
          if (lVar17 < lVar5) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = 0;
      }
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  local_40._0_4_ =
       iVar2 << (0x1fU - (char)DAT_180054cac & 0x1f) | -(uint)bVar19 & 0x80000000 | (uint)local_40;
  if (DAT_180054cb0 == 0x40) {
    local_58[1] = (uint)local_40;
    *local_58 = local_40._4_4_;
  }
  else {
    if (DAT_180054cb0 == 0x20) {
      *local_58 = (uint)local_40;
    }
  }
  FUN_180023ef0(local_30 ^ (ulonglong)auStack136);
  return;
}



void FUN_180031248(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  undefined8 *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined auStack136 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_1800537e8 ^ (ulonglong)auStack136;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_180054cc0 + -1;
    uVar7 = DAT_180054cc0 >> 0x1f & 0x1f;
    uVar1 = DAT_180054cc0 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180031369;
        }
      }
      else {
LAB_180031369:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *(uint *)puVar13 = *(uint *)puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_1800244a0((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_180054cbc - DAT_180054cc0) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else {
      if (DAT_180054cbc < iVar11) {
        uVar10 = DAT_180054cc4 >> 0x1f & 0x1f;
        iVar15 = DAT_180054cc4 + uVar10;
        bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
        iVar15 = iVar15 >> 5;
        uVar10 = ~(-1 << (bVar4 & 0x1f));
        if (iVar11 < DAT_180054cb8) {
          local_40 = local_40 & 0xffffffff7fffffff;
          iVar2 = DAT_180054ccc + iVar11;
          puVar13 = &local_40;
          do {
            uVar1 = *(uint *)puVar13;
            *(uint *)puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
        }
        else {
          local_40 = 0x80000000;
          local_38 = 0;
          puVar13 = &local_40;
          do {
            uVar1 = (uint)uVar3;
            uVar3 = (ulonglong)((uVar10 & *(uint *)puVar13) << (0x20 - bVar4 & 0x1f));
            *(uint *)puVar13 = *(uint *)puVar13 >> (bVar4 & 0x1f) | uVar1;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
          iVar2 = DAT_180054ccc + DAT_180054cb8;
        }
      }
      else {
        local_40 = local_48;
        local_38 = local_50;
        uVar10 = DAT_180054cbc - local_68 >> 0x1f & 0x1f;
        puVar13 = &local_40;
        iVar2 = (DAT_180054cbc - local_68) + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        uVar6 = uVar3;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar16 = (longlong)(iVar2 >> 5);
        lVar17 = 2;
        lVar18 = 3;
        lVar5 = 2;
        do {
          if (lVar5 < lVar16) {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
          }
          lVar5 = lVar5 + -1;
        } while (-1 < lVar5);
        uVar1 = local_60 + 1 >> 0x1f & 0x1f;
        uVar10 = local_60 + 1 + uVar1;
        iVar2 = (int)uVar10 >> 5;
        uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
        bVar4 = (byte)uVar10;
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
          if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0)
          {
            for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
              if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180031543;
            }
          }
          else {
LAB_180031543:
            uVar10 = local_60 >> 0x1f & 0x1f;
            iVar11 = local_60 + uVar10;
            iVar15 = iVar11 >> 5;
            uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
            uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
            uVar10 = uVar1 + uVar7;
            if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
            lVar5 = (longlong)(iVar15 + -1);
            if (-1 < iVar15 + -1) {
              do {
                if ((int)uVar6 == 0) break;
                uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
                uVar10 = uVar1 + 1;
                if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                  uVar6 = uVar9;
                }
                *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
                lVar5 = lVar5 + -1;
              } while (-1 < lVar5);
            }
          }
        }
        puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar2 * 4);
        *(uint *)puVar13 = *(uint *)puVar13 & -1 << (bVar4 & 0x1f);
        lVar5 = (longlong)(iVar2 + 1);
        if (lVar5 < 3) {
          FUN_1800244a0((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
        }
        puVar13 = &local_40;
        uVar10 = DAT_180054cc4 + 1 >> 0x1f & 0x1f;
        iVar2 = DAT_180054cc4 + 1 + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar18 = lVar18 + -1;
        } while (lVar18 != 0);
        lVar5 = (longlong)(iVar2 >> 5);
        do {
          if (lVar17 < lVar5) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = 0;
      }
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  local_40._0_4_ =
       iVar2 << (0x1fU - (char)DAT_180054cc4 & 0x1f) | -(uint)bVar19 & 0x80000000 | (uint)local_40;
  if (DAT_180054cc8 == 0x40) {
    local_58[1] = (uint)local_40;
    *local_58 = local_40._4_4_;
  }
  else {
    if (DAT_180054cc8 == 0x20) {
      *local_58 = (uint)local_40;
    }
  }
  FUN_180023ef0(local_30 ^ (ulonglong)auStack136);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180031800(undefined2 *param_1,byte **param_2,byte *param_3,int param_4,int param_5,
                  int param_6,int param_7,longlong *param_8)

{
  ushort uVar1;
  uint uVar2;
  int *piVar3;
  ushort uVar4;
  uint uVar5;
  byte bVar6;
  ulonglong uVar7;
  undefined2 uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  undefined **ppuVar12;
  byte **ppbVar13;
  uint uVar14;
  byte *pbVar15;
  ushort *puVar16;
  ushort uVar17;
  byte *pbVar18;
  uint uVar19;
  uint *puVar20;
  int iVar21;
  char *pcVar22;
  int iVar23;
  ushort uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  undefined auStack216 [32];
  int local_b8;
  int local_b4;
  uint local_b0;
  int local_ac;
  byte **local_a8;
  undefined **local_a0;
  undefined2 *local_98;
  byte local_90;
  undefined uStack143;
  undefined2 uStack142;
  ushort auStack140 [6];
  undefined8 local_80;
  undefined2 uStack120;
  ushort uStack118;
  byte *local_70;
  undefined4 local_68;
  char local_60 [23];
  char local_49;
  ulonglong local_40;
  
  local_40 = DAT_1800537e8 ^ (ulonglong)auStack216;
  uVar9 = 0;
  uVar2 = 0;
  pcVar22 = local_60;
  uVar8 = 0;
  local_b0 = local_b0 & 0xffff0000;
  iVar10 = 0;
  local_b4 = 1;
  local_b8 = 0;
  uVar27 = 0;
  pbVar15 = param_3;
  local_ac = param_4;
  local_a8 = param_2;
  local_98 = param_1;
  if (param_8 == (longlong *)0x0) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18002add8();
    goto LAB_18003203a;
  }
  while ((uVar14 = uVar9, uVar5 = uVar9, uVar11 = uVar9, uVar19 = uVar9, uVar25 = uVar9,
         *pbVar15 < 0x21 &&
         (uVar14 = 0, uVar5 = 0, uVar11 = 0, uVar19 = 0, uVar25 = 0,
         (0x100002600U >> ((longlong)(char)*pbVar15 & 0x3fU) & 1) != 0))) {
    pbVar15 = pbVar15 + 1;
  }
LAB_18003189d:
  do {
    bVar6 = *pbVar15;
    pbVar18 = pbVar15 + 1;
    uVar26 = uVar2;
    if (uVar5 < 6) {
      if (uVar5 == 5) {
        local_b8 = 1;
        pbVar15 = param_3;
        uVar26 = 0;
        if (9 < (byte)(bVar6 - 0x30)) break;
        uVar5 = 4;
      }
      else {
        if (uVar5 != 0) {
          if (uVar5 == 1) {
            uVar14 = 1;
            if ((byte)(bVar6 - 0x31) < 9) {
              uVar5 = 3;
              pbVar15 = param_3;
              goto LAB_1800319c0;
            }
            if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) {
LAB_1800319a4:
              uVar14 = 1;
              uVar5 = 4;
              pbVar15 = pbVar18;
              goto LAB_18003189d;
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) goto LAB_180031954;
            if (bVar6 == 0x30) goto LAB_1800319f8;
          }
          else {
            if (uVar5 == 2) {
              if ((byte)(bVar6 - 0x31) < 9) goto LAB_1800319b5;
              if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) goto LAB_1800319d9;
              pbVar15 = param_3;
              if (bVar6 == 0x30) goto LAB_1800319f8;
              break;
            }
            if (uVar5 == 3) {
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {  // '0' to '9'
                if (uVar19 < 0x19) {
                  uVar19 = uVar19 + 1;
                  *pcVar22 = bVar6 - 0x30;
                  pcVar22 = pcVar22 + 1;
                }
                else {
                  uVar11 = uVar11 + 1;
                }
                bVar6 = *pbVar18;
                pbVar18 = pbVar18 + 1;
              }
              if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) goto LAB_1800319a4;
            }
            else {
              if (uVar5 != 4) goto LAB_180031b7b;
              local_b8 = 1;
              if (uVar19 == 0) {
                while (bVar6 == 0x30) {
                  uVar11 = uVar11 - 1;
                  bVar6 = *pbVar18;
                  pbVar18 = pbVar18 + 1;
                }
              }
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar19 < 0x19) {
                  uVar19 = uVar19 + 1;
                  *pcVar22 = bVar6 - 0x30;
                  pcVar22 = pcVar22 + 1;
                  uVar11 = uVar11 - 1;
                }
                bVar6 = *pbVar18;
                pbVar18 = pbVar18 + 1;
              }
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) {
LAB_180031954:
              uVar14 = 1;
              uVar5 = 0xb;
              pbVar15 = pbVar18 + -1;
              goto LAB_18003189d;
            }
          }
          uVar14 = 1;
          uVar26 = 0;
          if (((char)bVar6 < 'D') ||
             (('E' < (char)bVar6 && (uVar26 = uVar27, bVar6 != 100 && bVar6 != 0x65))))
          goto LAB_180031a75;
          uVar5 = 6;
          pbVar15 = pbVar18;
          uVar14 = 1;
          goto LAB_18003189d;
        }
        if (8 < (byte)(bVar6 - 0x31)) {
          if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) {
LAB_1800319d9:
            uVar5 = 5;
            pbVar15 = pbVar18;
          }
          else {
            if (bVar6 == 0x2b) {
              uVar5 = 2;
              local_b0 = local_b0 & 0xffff0000;
              pbVar15 = pbVar18;
            }
            else {
              if (bVar6 == 0x2d) {
                uVar5 = 2;
                local_b0 = 0x8000;
                pbVar15 = pbVar18;
              }
              else {
                uVar26 = uVar27;
                if (bVar6 != 0x30) goto LAB_180031a75;
LAB_1800319f8:
                uVar5 = 1;
                pbVar15 = pbVar18;
              }
            }
          }
          goto LAB_18003189d;
        }
LAB_1800319b5:
        uVar5 = 3;
        pbVar15 = param_3;
      }
LAB_1800319c0:
      param_3 = pbVar15;
      pbVar15 = pbVar18 + -1;
      goto LAB_18003189d;
    }
    if (uVar5 == 6) {
      pbVar15 = pbVar15 + -1;
      if ((byte)(bVar6 - 0x31) < 9) goto LAB_180031b42;
      if (bVar6 != 0x2b) {
        if (bVar6 != 0x2d) goto LAB_180031b4c;
LAB_180031af7:
        local_b4 = -1;
        uVar5 = 7;
        param_3 = pbVar15;
        pbVar15 = pbVar18;
        goto LAB_18003189d;
      }
      uVar5 = 7;
      param_3 = pbVar15;
    }
    else {
      if (uVar5 == 7) {
        pbVar15 = param_3;
        if ((byte)(bVar6 - 0x31) < 9) {
LAB_180031b42:
          uVar5 = 9;
          goto LAB_1800319c0;
        }
LAB_180031b4c:
        if (bVar6 != 0x30) break;
        uVar5 = 8;
        param_3 = pbVar15;
        pbVar15 = pbVar18;
        goto LAB_18003189d;
      }
      if (uVar5 == 8) {
        uVar25 = 1;
        while (bVar6 == 0x30) {
          bVar6 = *pbVar18;
          pbVar18 = pbVar18 + 1;
        }
        uVar26 = uVar27;
        if ((byte)(bVar6 - 0x31) < 9) {
          uVar5 = 9;
          pbVar15 = param_3;
          uVar25 = 1;
          goto LAB_1800319c0;
        }
        goto LAB_180031a75;
      }
      if (uVar5 == 9) {
        uVar25 = 1;
        uVar26 = uVar9;
        goto LAB_180031bbc;
      }
      if (uVar5 == 0xb) {
        uVar26 = uVar27;
        if (param_7 == 0) goto LAB_180031a75;
        if (bVar6 != 0x2b) {
          uVar26 = uVar2;
          if (bVar6 == 0x2d) goto LAB_180031af7;
          break;
        }
        uVar5 = 7;
        param_3 = pbVar15;
        pbVar15 = pbVar18;
        goto LAB_18003189d;
      }
    }
LAB_180031b7b:
    pbVar15 = pbVar18;
  } while (uVar5 != 10);
  goto LAB_180031bed;
LAB_180031bbc:
  if (((char)bVar6 < '0') || ('9' < (char)bVar6)) goto LAB_180031bda;
  uVar26 = (int)(char)bVar6 + (uVar26 * 5 + -0x18) * 2;
  if ((int)uVar26 < 0x1451) {
    bVar6 = *pbVar18;
    pbVar18 = pbVar18 + 1;
    goto LAB_180031bbc;
  }
  uVar26 = 0x1451;
LAB_180031bda:
  while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
    bVar6 = *pbVar18;
    pbVar18 = pbVar18 + 1;
  }
LAB_180031a75:
  pbVar15 = pbVar18 + -1;
LAB_180031bed:
  *param_2 = pbVar15;
  iVar21 = iVar10;
  if (uVar14 == 0) {
    uVar8 = 0;
    uVar1 = 0;
  }
  else {
    if (0x18 < uVar19) {
      if ('\x04' < local_49) {
        local_49 = local_49 + '\x01';
      }
      pcVar22 = pcVar22 + -1;
      uVar19 = 0x18;
      uVar11 = uVar11 + 1;
    }
    if (uVar19 == 0) {
      uVar1 = 0;
      uVar8 = 0;
    }
    else {
      while (pcVar22 = pcVar22 + -1, *pcVar22 == '\0') {
        uVar19 = uVar19 - 1;
        uVar11 = uVar11 + 1;
      }
      FUN_1800330c8(local_60,uVar19,&local_80);
      if (local_b4 < 0) {
        uVar26 = -uVar26;
      }
      uVar26 = uVar26 + uVar11;
      if (uVar25 == 0) {
        uVar26 = uVar26 + param_5;
      }
      if (local_b8 == 0) {
        uVar26 = uVar26 - param_6;
      }
      if ((int)uVar26 < 0x1451) {
        if ((int)uVar26 < -0x1450) {
          uVar1 = 0;
        }
        else {
          ppuVar12 = &PTR_DAT_180054c70;
          if (uVar26 != 0) {
            if ((int)uVar26 < 0) {
              uVar26 = -uVar26;
              ppuVar12 = (undefined **)0x180054dd0;
            }
            if (local_ac == 0) {
              local_80._0_2_ = 0;
            }
joined_r0x000180031cb5:
            do {
              if (uVar26 == 0) break;
              ppuVar12 = (undefined **)((longlong)ppuVar12 + 0x54);
              uVar27 = (int)uVar26 >> 3;
              uVar2 = uVar26 & 7;
              uVar26 = uVar27;
              local_a0 = ppuVar12;
              if (uVar2 != 0) {
                local_a8 = (byte **)((longlong)ppuVar12 + (longlong)(int)uVar2 * 0xc);
                if (0x7fff < *(ushort *)local_a8) {
                  ppbVar13 = local_a8 + 1;
                  pbVar15 = *local_a8;
                  local_a8 = &local_70;
                  local_68 = *(undefined4 *)ppbVar13;
                  local_70._0_6_ = CONCAT42((int)((ulonglong)pbVar15 >> 0x10) + -1,(short)pbVar15);
                  local_70 = (byte *)((ulonglong)pbVar15 & 0xffff000000000000 |
                                     (ulonglong)(uint6)local_70);
                }
                local_90 = 0;
                uStack143 = 0;
                uStack142 = 0;
                auStack140[0] = 0;
                auStack140[1] = 0;
                uVar1 = *(ushort *)((longlong)local_a8 + 10) & 0x7fff;
                auStack140[2] = 0;
                auStack140[3] = 0;
                uVar4 = uStack118 & 0x7fff;
                uVar24 = (*(ushort *)((longlong)local_a8 + 10) ^ uStack118) & 0x8000;
                uVar17 = uVar4 + uVar1;
                if (((0x7ffe < uVar4) || (0x7ffe < uVar1)) || (0xbffd < uVar17)) {
LAB_180031fbb:
                  local_80._0_2_ = 0;
                  local_80._2_2_ = 0;
                  local_80._4_2_ = 0;
                  local_80._6_2_ = 0;
                  iVar21 = (-(uint)(uVar24 != 0) & 0x80000000) + 0x7fff8000;
                  uStack120 = (undefined2)iVar21;
                  uStack118 = (ushort)((uint)iVar21 >> 0x10);
                  goto joined_r0x000180031cb5;
                }
                if (0x3fbf < uVar17) {
                  if (((uVar4 == 0) &&
                      (uVar17 = uVar17 + 1, (CONCAT22(uStack118,uStack120) & 0x7fffffff) == 0)) &&
                     ((CONCAT22(local_80._6_2_,local_80._4_2_) == 0 &&
                      (CONCAT22(local_80._2_2_,(undefined2)local_80) == 0)))) {
                    uStack118 = 0;
                    goto joined_r0x000180031cb5;
                  }
                  if (((uVar1 != 0) ||
                      (uVar17 = uVar17 + 1, (*(uint *)(local_a8 + 1) & 0x7fffffff) != 0)) ||
                     ((*(int *)((longlong)local_a8 + 4) != 0 || (*(int *)local_a8 != 0)))) {
                    puVar20 = (uint *)&local_90;
                    iVar21 = 5;
                    uVar2 = uVar9;
                    do {
                      local_b8 = iVar21;
                      if (0 < iVar21) {
                        ppbVar13 = local_a8 + 1;
                        puVar16 = (ushort *)((longlong)&local_80 + (longlong)(int)(uVar2 * 2));
                        do {
                          uVar27 = *puVar20 + (uint)*(ushort *)ppbVar13 * (uint)*puVar16;
                          if ((uVar27 < *puVar20) ||
                             (iVar23 = iVar10, uVar27 < (uint)*(ushort *)ppbVar13 * (uint)*puVar16))
                          {
                            iVar23 = 1;
                          }
                          *puVar20 = uVar27;
                          if (iVar23 != 0) {
                            *(short *)(puVar20 + 1) = *(short *)(puVar20 + 1) + 1;
                          }
                          puVar16 = puVar16 + 1;
                          ppbVar13 = (byte **)((longlong)ppbVar13 + -2);
                          local_b8 = local_b8 + -1;
                        } while (0 < local_b8);
                      }
                      iVar21 = iVar21 + -1;
                      puVar20 = (uint *)((longlong)puVar20 + 2);
                      uVar2 = uVar2 + 1;
                    } while (0 < iVar21);
                    uVar27 = CONCAT22(auStack140[3],auStack140[2]);
                    uVar2 = CONCAT22(uStack142,CONCAT11(uStack143,local_90));
                    uVar17 = uVar17 + 0xc002;
                    uVar14 = uVar2;
                    if ((short)uVar17 < 1) {
LAB_180031ebc:
                      uVar17 = uVar17 - 1;
                      if (-1 < (short)uVar17) goto LAB_180031f26;
                      uVar7 = (ulonglong)(ushort)-uVar17;
                      uVar17 = 0;
                      uVar14 = uVar9;
                      do {
                        uVar5 = uVar27;
                        if ((local_90 & 1) != 0) {
                          uVar14 = uVar14 + 1;
                        }
                        uVar11 = CONCAT22(auStack140[1],auStack140[0]);
                        uVar19 = uVar2 >> 1;
                        auStack140[1] = auStack140[1] >> 1 | (ushort)((uVar5 << 0x1f) >> 0x10);
                        uVar27 = uVar5 >> 1;
                        uVar2 = uVar19 | uVar11 << 0x1f;
                        auStack140[0] = (ushort)(uVar11 >> 1);
                        local_90 = (byte)uVar19;
                        uStack143 = (undefined)(uVar19 >> 8);
                        uStack142 = (undefined2)(uVar2 >> 0x10);
                        uVar7 = uVar7 - 1;
                      } while (uVar7 != 0);
                      auStack140[2] = (ushort)uVar27;
                      auStack140[3] = (ushort)(uVar5 >> 0x11);
                      if (uVar14 == 0) goto LAB_180031f26;
                      uVar1 = (ushort)uVar19 | 1;
                      local_90 = (byte)uVar1;
                      uVar2 = uVar19 | 1;
                    }
                    else {
                      do {
                        uVar2 = uVar14;
                        if ((uVar27 & 0x80000000) != 0) break;
                        uVar5 = uVar27 * 2;
                        uVar2 = uVar14 * 2;
                        iVar21 = CONCAT22(auStack140[1],auStack140[0]) * 2;
                        uVar17 = uVar17 - 1;
                        auStack140[0] = (ushort)iVar21 | (ushort)(uVar14 >> 0x1f);
                        uVar27 = uVar5 | auStack140[1] >> 0xf;
                        local_90 = (byte)uVar2;
                        uStack143 = (undefined)(uVar2 >> 8);
                        uStack142 = (undefined2)(uVar2 >> 0x10);
                        auStack140[1] = (ushort)((uint)iVar21 >> 0x10);
                        auStack140[2] = (ushort)uVar27;
                        auStack140[3] = (ushort)(uVar5 >> 0x10);
                        uVar14 = uVar2;
                      } while (0 < (short)uVar17);
                      if ((short)uVar17 < 1) goto LAB_180031ebc;
LAB_180031f26:
                      uVar1 = CONCAT11(uStack143,local_90);
                    }
                    if ((0x8000 < uVar1) || ((uVar2 & 0x1ffff) == 0x18000)) {
                      if (CONCAT22(auStack140[0],uStack142) == -1) {
                        uStack142 = 0;
                        auStack140[0] = 0;
                        if (CONCAT22(auStack140[2],auStack140[1]) == -1) {
                          auStack140[1] = 0;
                          auStack140[2] = 0;
                          if (auStack140[3] == 0xffff) {
                            auStack140[3] = 0x8000;
                            uVar17 = uVar17 + 1;
                          }
                          else {
                            auStack140[3] = auStack140[3] + 1;
                          }
                        }
                        else {
                          iVar21 = CONCAT22(auStack140[2],auStack140[1]) + 1;
                          auStack140[1] = (ushort)iVar21;
                          auStack140[2] = (ushort)((uint)iVar21 >> 0x10);
                        }
                        uVar27 = CONCAT22(auStack140[3],auStack140[2]);
                      }
                      else {
                        iVar21 = CONCAT22(auStack140[0],uStack142) + 1;
                        uStack142 = (undefined2)iVar21;
                        auStack140[0] = (ushort)((uint)iVar21 >> 0x10);
                      }
                    }
                    if (0x7ffe < uVar17) goto LAB_180031fbb;
                    local_80._6_2_ = (undefined2)uVar27;
                    uStack120 = (undefined2)(uVar27 >> 0x10);
                    local_80._0_2_ = uStack142;
                    uStack118 = uVar17 | uVar24;
                    local_80._2_2_ = auStack140[0];
                    local_80._4_2_ = auStack140[1];
                    goto joined_r0x000180031cb5;
                  }
                }
                local_80._4_2_ = 0;
                local_80._6_2_ = 0;
                uStack120 = 0;
                uStack118 = 0;
                local_80._0_2_ = 0;
                local_80._2_2_ = 0;
              }
            } while( true );
          }
          iVar10 = CONCAT22(local_80._4_2_,local_80._2_2_);
          uVar1 = uStack118;
          uVar8 = (undefined2)local_80;
          iVar21 = CONCAT22(uStack120,local_80._6_2_);
        }
      }
      else {
        uVar8 = 0;
        uVar1 = 0x7fff;
        iVar21 = -0x80000000;
      }
    }
  }
  local_98[5] = uVar1 | (ushort)local_b0;
  *local_98 = uVar8;
  *(int *)(local_98 + 1) = iVar10;
  *(int *)(local_98 + 3) = iVar21;
LAB_18003203a:
  FUN_180023ef0(local_40 ^ (ulonglong)auStack216);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180032064(int *param_1,int param_2,uint param_3,short *param_4)

{
  short *psVar1;
  undefined *puVar2;
  code *pcVar3;
  undefined3 uVar4;
  bool bVar5;
  undefined uVar6;
  ushort uVar7;
  errno_t eVar8;
  short sVar9;
  ushort uVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint *puVar14;
  ulonglong uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  undefined **ppuVar19;
  char cVar20;
  ushort uVar21;
  uint uVar22;
  uint uVar23;
  longlong lVar24;
  short *psVar25;
  short *psVar26;
  int iVar27;
  int iVar28;
  ushort *puVar29;
  undefined4 *puVar30;
  undefined **ppuVar31;
  ushort local_c8;
  ushort local_c6;
  int local_c4;
  uint local_c0;
  undefined2 local_bc;
  undefined **local_b8;
  uint local_b0;
  int local_ac;
  int local_a8;
  short *local_a0;
  uint local_98;
  undefined **local_90;
  byte local_88;
  undefined uStack135;
  ushort uStack134;
  ushort auStack132 [6];
  ushort local_78 [4];
  ushort uStack112;
  undefined uStack110;
  byte bStack109;
  int local_68;
  int local_64;
  undefined4 local_60;
  undefined *local_58;
  undefined4 local_50;
  ulonglong local_48;
  
  local_48 = DAT_1800537e8 ^ (ulonglong)&stack0xffffffffffffff08;
  iVar28 = *param_1;
  uVar22 = param_1[1];
  local_c6 = *(ushort *)(param_1 + 2) & 0x8000;
  uVar21 = *(ushort *)(param_1 + 2) & 0x7fff;
  local_68 = -0x33333334;
  local_64 = -0x33333334;
  local_60 = 0x3ffbcccc;
  if (local_c6 == 0) {
    *(undefined *)(param_4 + 1) = 0x20;
  }
  else {
    *(undefined *)(param_4 + 1) = 0x2d;
  }
  local_ac = param_2;
  local_a0 = param_4;
  local_98 = param_3;
  if (uVar21 == 0) {
    if ((uVar22 != 0) || (iVar28 != 0)) goto LAB_1800321f6;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
LAB_180032111:
    *param_4 = 0;
    *(undefined *)(param_4 + 1) = uVar6;
    *(undefined2 *)((longlong)param_4 + 3) = 0x3001;
  }
  else {
    if (uVar21 == 0x7fff) {
      *param_4 = 1;
      if (((uVar22 == 0x80000000) && (iVar28 == 0)) || ((uVar22 >> 0x1e & 1) != 0)) {
        if ((local_c6 == 0) || (uVar22 != 0xc0000000)) {
          if ((uVar22 != 0x80000000) || (iVar28 != 0)) goto LAB_1800321cd;
          eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#INF");
          if (eVar8 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        else {
          if (iVar28 != 0) {
LAB_1800321cd:
            eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#QNAN");
            if (eVar8 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar3 = (code *)swi(3);
              (*pcVar3)();
              return;
            }
            goto LAB_1800321ea;
          }
          eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#IND");
          if (eVar8 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        *(undefined *)((longlong)param_4 + 3) = 5;
      }
      else {
        eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#SNAN");
        if (eVar8 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar3 = (code *)swi(3);
          (*pcVar3)();
          return;
        }
LAB_1800321ea:
        *(undefined *)((longlong)param_4 + 3) = 6;
      }
      goto LAB_180032a82;
    }
LAB_1800321f6:
    local_78[1] = (ushort)iVar28;
    local_78[2] = (ushort)((uint)iVar28 >> 0x10);
    uStack110 = (undefined)uVar21;
    bStack109 = (byte)(uVar21 >> 8);
    ppuVar19 = &PTR_DAT_180054c70;
    local_78[3] = (ushort)uVar22;
    uStack112 = (ushort)(uVar22 >> 0x10);
    local_78[0] = 0;
    local_a8 = 5;
    iVar11 = ((uint)(uVar21 >> 8) + (uVar22 >> 0x18) * 2) * 0x4d +
             (uint)uVar21 * 0x4d10 + -0x134312f4;
    local_c0 = iVar11 >> 0x10;
    sVar9 = (short)((uint)iVar11 >> 0x10);
    uVar22 = SEXT24(sVar9);
    if (-uVar22 == 0) {
LAB_1800325d0:
      uVar23 = CONCAT22(local_78[3],local_78[2]);
      uVar22 = iVar28 << 0x10;
    }
    else {
      uVar16 = -uVar22;
      if (0 < (int)uVar22) {
        ppuVar19 = (undefined **)0x180054dd0;
        uVar16 = uVar22;
      }
      if (uVar16 == 0) goto LAB_1800325d0;
      uVar23 = CONCAT22(local_78[3],local_78[2]);
      uVar22 = iVar28 << 0x10;
      do {
        iVar28 = 0;
        ppuVar19 = (undefined **)((longlong)ppuVar19 + 0x54);
        local_b0 = (int)uVar16 >> 3;
        if ((uVar16 & 7) != 0) {
          local_90 = (undefined **)((longlong)ppuVar19 + (longlong)(int)(uVar16 & 7) * 0xc);
          if (0x7fff < *(ushort *)local_90) {
            ppuVar31 = local_90 + 1;
            puVar2 = *local_90;
            local_90 = &local_58;
            local_50 = *(undefined4 *)ppuVar31;
            local_58._0_6_ = CONCAT42((int)((ulonglong)puVar2 >> 0x10) + -1,(short)puVar2);
            local_58 = (undefined *)
                       ((ulonglong)puVar2 & 0xffff000000000000 | (ulonglong)(uint6)local_58);
          }
          local_c4 = 0;
          uVar10 = *(ushort *)((longlong)local_90 + 10) & 0x7fff;
          local_88 = 0;
          uStack135 = 0;
          uStack134 = 0;
          auStack132[0] = 0;
          auStack132[1] = 0;
          uVar7 = CONCAT11(bStack109,uStack110) & 0x7fff;
          auStack132[2] = 0;
          auStack132[3] = 0;
          local_c8 = (*(ushort *)((longlong)local_90 + 10) ^ CONCAT11(bStack109,uStack110)) & 0x8000
          ;
          uVar21 = uVar7 + uVar10;
          if (((uVar7 < 0x7fff) && (uVar10 < 0x7fff)) && (uVar21 < 0xbffe)) {
            if (0x3fbf < uVar21) {
              if (((uVar7 == 0) &&
                  (uVar21 = uVar21 + 1,
                  (CONCAT13(bStack109,CONCAT12(uStack110,uStack112)) & 0x7fffffff) == 0)) &&
                 ((uVar23 == 0 && (uVar22 == 0)))) {
                uStack110 = 0;
                bStack109 = 0;
                goto LAB_1800325b9;
              }
              if (((uVar10 == 0) &&
                  (uVar21 = uVar21 + 1, (*(uint *)(local_90 + 1) & 0x7fffffff) == 0)) &&
                 ((*(int *)((longlong)local_90 + 4) == 0 && (*(int *)local_90 == 0))))
              goto LAB_180032340;
              iVar11 = 5;
              puVar14 = (uint *)&local_88;
              do {
                if (0 < iVar11) {
                  ppuVar31 = local_90 + 1;
                  puVar29 = (ushort *)((longlong)local_78 + (longlong)(iVar28 * 2));
                  iVar27 = iVar11;
                  do {
                    uVar22 = *puVar14 + (uint)*puVar29 * (uint)*(ushort *)ppuVar31;
                    if ((uVar22 < *puVar14) ||
                       (bVar5 = false, uVar22 < (uint)*puVar29 * (uint)*(ushort *)ppuVar31)) {
                      bVar5 = true;
                    }
                    *puVar14 = uVar22;
                    if (bVar5) {
                      *(short *)(puVar14 + 1) = *(short *)(puVar14 + 1) + 1;
                    }
                    iVar27 = iVar27 + -1;
                    puVar29 = puVar29 + 1;
                    ppuVar31 = (undefined **)((longlong)ppuVar31 + -2);
                  } while (0 < iVar27);
                }
                iVar11 = iVar11 + -1;
                puVar14 = (uint *)((longlong)puVar14 + 2);
                iVar28 = iVar28 + 1;
              } while (0 < iVar11);
              uVar16 = CONCAT22(auStack132[3],auStack132[2]);
              uVar22 = CONCAT22(uStack134,CONCAT11(uStack135,local_88));
              uVar21 = uVar21 + 0xc002;
              uVar23 = uVar22;
              if ((short)uVar21 < 1) {
LAB_180032472:
                uVar21 = uVar21 - 1;
                if (-1 < (short)uVar21) goto LAB_1800324df;
                uVar15 = (ulonglong)(ushort)-uVar21;
                local_bc = 0;
                iVar28 = local_c4;
                do {
                  uVar23 = uVar16;
                  if ((local_88 & 1) != 0) {
                    iVar28 = iVar28 + 1;
                  }
                  uVar17 = CONCAT22(auStack132[1],auStack132[0]);
                  uVar12 = uVar22 >> 1;
                  auStack132[1] = auStack132[1] >> 1 | (ushort)((uVar23 << 0x1f) >> 0x10);
                  uVar16 = uVar23 >> 1;
                  uVar22 = uVar12 | uVar17 << 0x1f;
                  auStack132[0] = (ushort)(uVar17 >> 1);
                  local_88 = (byte)uVar12;
                  uStack135 = (undefined)(uVar12 >> 8);
                  uStack134 = (ushort)(uVar22 >> 0x10);
                  uVar15 = uVar15 - 1;
                } while (uVar15 != 0);
                uVar21 = 0;
                auStack132[2] = (ushort)uVar16;
                auStack132[3] = (ushort)(uVar23 >> 0x11);
                if (iVar28 == 0) goto LAB_1800324df;
                uVar7 = (ushort)uVar12 | 1;
                local_88 = (byte)uVar7;
                uVar22 = uVar12 | 1;
              }
              else {
                do {
                  uVar22 = uVar23;
                  if ((uVar16 & 0x80000000) != 0) break;
                  uVar17 = uVar16 * 2;
                  uVar22 = uVar23 * 2;
                  iVar28 = CONCAT22(auStack132[1],auStack132[0]) * 2;
                  uVar21 = uVar21 - 1;
                  auStack132[0] = (ushort)iVar28 | (ushort)(uVar23 >> 0x1f);
                  uVar16 = uVar17 | auStack132[1] >> 0xf;
                  local_88 = (byte)uVar22;
                  uStack135 = (undefined)(uVar22 >> 8);
                  uStack134 = (ushort)(uVar22 >> 0x10);
                  auStack132[1] = (ushort)((uint)iVar28 >> 0x10);
                  auStack132[2] = (ushort)uVar16;
                  auStack132[3] = (ushort)(uVar17 >> 0x10);
                  uVar23 = uVar22;
                } while (0 < (short)uVar21);
                if ((short)uVar21 < 1) goto LAB_180032472;
LAB_1800324df:
                uVar7 = CONCAT11(uStack135,local_88);
              }
              if ((0x8000 < uVar7) || ((uVar22 & 0x1ffff) == 0x18000)) {
                if (CONCAT22(auStack132[0],uStack134) == -1) {
                  uStack134 = 0;
                  auStack132[0] = 0;
                  if (CONCAT22(auStack132[2],auStack132[1]) == -1) {
                    auStack132[1] = 0;
                    auStack132[2] = 0;
                    if (auStack132[3] == 0xffff) {
                      auStack132[3] = 0x8000;
                      uVar21 = uVar21 + 1;
                    }
                    else {
                      auStack132[3] = auStack132[3] + 1;
                    }
                  }
                  else {
                    iVar28 = CONCAT22(auStack132[2],auStack132[1]) + 1;
                    auStack132[1] = (ushort)iVar28;
                    auStack132[2] = (ushort)((uint)iVar28 >> 0x10);
                  }
                  uVar16 = CONCAT22(auStack132[3],auStack132[2]);
                }
                else {
                  iVar28 = CONCAT22(auStack132[0],uStack134) + 1;
                  uStack134 = (ushort)iVar28;
                  auStack132[0] = (ushort)((uint)iVar28 >> 0x10);
                }
              }
              if (uVar21 < 0x7fff) {
                bStack109 = (byte)(uVar21 >> 8) | (byte)(local_c8 >> 8);
                local_78[3] = (ushort)uVar16;
                uStack112 = (ushort)(uVar16 >> 0x10);
                local_78[0] = uStack134;
                local_78[1] = auStack132[0];
                local_78[2] = auStack132[1];
                uVar23 = CONCAT22(local_78[3],auStack132[1]);
                uVar22 = CONCAT22(auStack132[0],uStack134);
                uStack110 = (undefined)uVar21;
                goto LAB_1800325b9;
              }
              goto LAB_18003259b;
            }
LAB_180032340:
            local_78[2] = 0;
            local_78[3] = 0;
            uStack112 = 0;
            uStack110 = 0;
            bStack109 = 0;
          }
          else {
LAB_18003259b:
            local_78[2] = 0;
            local_78[3] = 0;
            iVar28 = (-(uint)(local_c8 != 0) & 0x80000000) + 0x7fff8000;
            uStack112 = (ushort)iVar28;
            uStack110 = (undefined)((uint)iVar28 >> 0x10);
            bStack109 = (byte)((uint)iVar28 >> 0x18);
          }
          local_78[3] = 0;
          local_78[2] = 0;
          uVar23 = 0;
          local_78[0] = 0;
          local_78[1] = 0;
          uVar22 = uVar23;
        }
LAB_1800325b9:
        uVar16 = local_b0;
        local_b8 = ppuVar19;
      } while (local_b0 != 0);
    }
    iVar28 = 0;
    uVar16 = CONCAT13(bStack109,CONCAT12(uStack110,uStack112));
    uVar21 = (ushort)(uVar16 >> 0x10);
    uVar17 = uVar23;
    if (0x3ffe < uVar21) {
      local_c0 = local_c0 & 0xffff0000 | (uint)(ushort)(sVar9 + 1);
      uVar17 = 0;
      local_c4 = 0;
      local_88 = 0;
      uStack135 = 0;
      uStack134 = 0;
      auStack132[0] = 0;
      auStack132[1] = 0;
      auStack132[2] = 0;
      auStack132[3] = 0;
      uVar10 = (local_60._2_2_ ^ uVar21) & 0x8000;
      uVar7 = (uVar21 & 0x7fff) + (local_60._2_2_ & 0x7fff);
      if ((((uVar21 & 0x7fff) < 0x7fff) && ((local_60._2_2_ & 0x7fff) < 0x7fff)) && (uVar7 < 0xbffe)
         ) {
        if (uVar7 < 0x3fc0) {
LAB_180032654:
          uStack112 = 0;
          uStack110 = 0;
          bStack109 = 0;
          uVar22 = uVar17;
        }
        else {
          if ((((uVar16 & 0x7fff0000) == 0) &&
              (uVar7 = uVar7 + 1,
              (CONCAT13(bStack109,CONCAT12(uStack110,uStack112)) & 0x7fffffff) == 0)) &&
             ((uVar23 == 0 && (uVar22 == 0)))) {
            uStack110 = 0;
            bStack109 = 0;
            uVar17 = uVar23;
          }
          else {
            if ((((local_60 & 0x7fff0000) == 0) && (uVar7 = uVar7 + 1, (local_60 & 0x7fffffff) == 0)
                ) && ((local_64 == 0 && (local_68 == 0)))) goto LAB_180032654;
            puVar14 = (uint *)&local_88;
            do {
              if (0 < local_a8) {
                puVar30 = &local_60;
                puVar29 = (ushort *)((longlong)local_78 + (longlong)(iVar28 * 2));
                iVar11 = local_a8;
                do {
                  bVar5 = false;
                  uVar22 = *puVar14 + (uint)*(ushort *)puVar30 * (uint)*puVar29;
                  if ((uVar22 < *puVar14) || (uVar22 < (uint)*(ushort *)puVar30 * (uint)*puVar29)) {
                    bVar5 = true;
                  }
                  *puVar14 = uVar22;
                  if (bVar5) {
                    *(short *)(puVar14 + 1) = *(short *)(puVar14 + 1) + 1;
                  }
                  iVar11 = iVar11 + -1;
                  puVar29 = puVar29 + 1;
                  puVar30 = (undefined4 *)((longlong)puVar30 + -2);
                } while (0 < iVar11);
              }
              local_a8 = local_a8 + -1;
              puVar14 = (uint *)((longlong)puVar14 + 2);
              iVar28 = iVar28 + 1;
            } while (0 < local_a8);
            uVar16 = CONCAT22(auStack132[3],auStack132[2]);
            uVar22 = CONCAT22(uStack134,CONCAT11(uStack135,local_88));
            uVar7 = uVar7 + 0xc002;
            uVar23 = uVar22;
            if ((short)uVar7 < 1) {
LAB_180032779:
              uVar7 = uVar7 - 1;
              if (-1 < (short)uVar7) goto LAB_1800327de;
              uVar15 = (ulonglong)(ushort)-uVar7;
              uVar7 = 0;
              iVar28 = local_c4;
              do {
                uVar23 = uVar16;
                if ((local_88 & 1) != 0) {
                  iVar28 = iVar28 + 1;
                }
                uVar17 = CONCAT22(auStack132[1],auStack132[0]);
                uVar12 = uVar22 >> 1;
                auStack132[1] = auStack132[1] >> 1 | (ushort)((uVar23 << 0x1f) >> 0x10);
                uVar16 = uVar23 >> 1;
                uVar22 = uVar12 | uVar17 << 0x1f;
                auStack132[0] = (ushort)(uVar17 >> 1);
                local_88 = (byte)uVar12;
                uStack135 = (undefined)(uVar12 >> 8);
                uStack134 = (ushort)(uVar22 >> 0x10);
                uVar15 = uVar15 - 1;
              } while (uVar15 != 0);
              auStack132[2] = (ushort)uVar16;
              auStack132[3] = (ushort)(uVar23 >> 0x11);
              if (iVar28 == 0) goto LAB_1800327de;
              uVar21 = (ushort)uVar12 | 1;
              local_88 = (byte)uVar21;
              uVar22 = uVar12 | 1;
            }
            else {
              do {
                uVar22 = uVar23;
                if ((uVar16 & 0x80000000) != 0) break;
                uVar17 = uVar16 * 2;
                uVar22 = uVar23 * 2;
                iVar28 = CONCAT22(auStack132[1],auStack132[0]) * 2;
                uVar7 = uVar7 - 1;
                auStack132[0] = (ushort)iVar28 | (ushort)(uVar23 >> 0x1f);
                uVar16 = uVar17 | auStack132[1] >> 0xf;
                local_88 = (byte)uVar22;
                uStack135 = (undefined)(uVar22 >> 8);
                uStack134 = (ushort)(uVar22 >> 0x10);
                auStack132[1] = (ushort)((uint)iVar28 >> 0x10);
                auStack132[2] = (ushort)uVar16;
                auStack132[3] = (ushort)(uVar17 >> 0x10);
                uVar23 = uVar22;
              } while (0 < (short)uVar7);
              if ((short)uVar7 < 1) goto LAB_180032779;
LAB_1800327de:
              uVar21 = CONCAT11(uStack135,local_88);
            }
            if ((0x8000 < uVar21) || ((uVar22 & 0x1ffff) == 0x18000)) {
              if (CONCAT22(auStack132[0],uStack134) == -1) {
                uStack134 = 0;
                auStack132[0] = 0;
                if (CONCAT22(auStack132[2],auStack132[1]) == -1) {
                  auStack132[1] = 0;
                  auStack132[2] = 0;
                  if (auStack132[3] == 0xffff) {
                    auStack132[3] = 0x8000;
                    uVar7 = uVar7 + 1;
                  }
                  else {
                    auStack132[3] = auStack132[3] + 1;
                  }
                }
                else {
                  iVar28 = CONCAT22(auStack132[2],auStack132[1]) + 1;
                  auStack132[1] = (ushort)iVar28;
                  auStack132[2] = (ushort)((uint)iVar28 >> 0x10);
                }
                uVar16 = CONCAT22(auStack132[3],auStack132[2]);
              }
              else {
                iVar28 = CONCAT22(auStack132[0],uStack134) + 1;
                uStack134 = (ushort)iVar28;
                auStack132[0] = (ushort)((uint)iVar28 >> 0x10);
              }
            }
            if (uVar7 < 0x7fff) {
              bStack109 = (byte)(uVar7 >> 8) | (byte)(uVar10 >> 8);
              local_78[3] = (ushort)uVar16;
              uStack112 = (ushort)(uVar16 >> 0x10);
              local_78[0] = uStack134;
              uStack110 = (undefined)uVar7;
              local_78[1] = auStack132[0];
              local_78[2] = auStack132[1];
              uVar17 = CONCAT22(local_78[3],auStack132[1]);
              uVar22 = CONCAT22(auStack132[0],uStack134);
            }
            else {
              iVar28 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
              uStack112 = (ushort)iVar28;
              uStack110 = (undefined)((uint)iVar28 >> 0x10);
              bStack109 = (byte)((uint)iVar28 >> 0x18);
              uVar17 = 0;
              uVar22 = 0;
            }
          }
        }
      }
      else {
        iVar28 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
        uStack112 = (ushort)iVar28;
        uStack110 = (undefined)((uint)iVar28 >> 0x10);
        bStack109 = (byte)((uint)iVar28 >> 0x18);
        uVar22 = uVar17;
      }
    }
    *param_4 = (short)local_c0;
    iVar28 = param_2;
    if (((param_3 & 1) != 0) && (iVar28 = param_2 + (short)local_c0, iVar28 < 1)) {
      uVar6 = 0x20;
      if (local_c6 == 0x8000) {
        uVar6 = 0x2d;
      }
      goto LAB_180032111;
    }
    uVar4 = CONCAT12(uStack110,uStack112);
    uStack110 = 0;
    uVar16 = (uint)uStack112;
    lVar24 = 8;
    if (0x15 < iVar28) {
      iVar28 = 0x15;
    }
    iVar11 = (CONCAT13(bStack109,uVar4) >> 0x10) - 0x3ffe;
    do {
      uVar23 = uVar17 * 2;
      uVar12 = uVar17 >> 0x1f;
      uVar17 = uVar23 | uVar22 >> 0x1f;
      uVar16 = uVar16 * 2 | uVar12;
      uVar22 = uVar22 * 2;
      lVar24 = lVar24 + -1;
    } while (lVar24 != 0);
    local_78[2] = (ushort)uVar17;
    local_78[3] = (ushort)(uVar23 >> 0x10);
    local_78[0] = (ushort)uVar22;
    local_78[1] = (ushort)(uVar22 >> 0x10);
    if ((iVar11 < 0) && (uVar23 = -iVar11 & 0xff, uVar23 != 0)) {
      do {
        uVar13 = uVar22 >> 1;
        uVar18 = uVar17 >> 1;
        uVar12 = uVar16 << 0x1f;
        uVar22 = uVar17 << 0x1f;
        uVar23 = uVar23 - 1;
        uVar16 = uVar16 >> 1;
        uVar17 = uVar18 | uVar12;
        uVar22 = uVar13 | uVar22;
      } while (0 < (int)uVar23);
      local_78[2] = (ushort)uVar18;
      local_78[3] = (ushort)(uVar17 >> 0x10);
      local_78[0] = (ushort)uVar13;
      local_78[1] = (ushort)(uVar22 >> 0x10);
    }
    iVar28 = iVar28 + 1;
    psVar1 = param_4 + 2;
    psVar25 = psVar1;
    if (0 < iVar28) {
      while( true ) {
        uVar12 = CONCAT22(local_78[1],local_78[0]);
        local_58 = (undefined *)CONCAT26(local_78[3],CONCAT24(local_78[2],uVar12));
        uVar13 = (uVar17 * 2 | uVar22 >> 0x1f) * 2 | uVar22 * 2 >> 0x1f;
        uVar23 = uVar12 + uVar22 * 4;
        uVar18 = (uVar16 * 2 | uVar17 >> 0x1f) * 2 | uVar17 * 2 >> 0x1f;
        if ((uVar23 < uVar22 * 4) || (uVar22 = uVar13, uVar23 < uVar12)) {
          uVar22 = uVar13 + 1;
          if ((uVar22 < uVar13) || (bVar5 = false, uVar22 == 0)) {
            bVar5 = true;
          }
          if (bVar5) {
            uVar18 = uVar18 + 1;
          }
        }
        uVar17 = (uint)((ulonglong)local_58 >> 0x20);
        uVar12 = uVar22 + uVar17;
        if ((uVar12 < uVar22) || (uVar12 < uVar17)) {
          uVar18 = uVar18 + 1;
        }
        uVar22 = uVar23 * 2;
        uVar17 = uVar12 * 2 | uVar23 >> 0x1f;
        uVar16 = (uVar18 + uVar16) * 2;
        iVar28 = iVar28 + -1;
        local_78[0] = (ushort)uVar22;
        local_78[1] = (ushort)(uVar22 >> 0x10);
        uStack112 = (ushort)uVar16 | (ushort)(uVar12 >> 0x1f);
        local_78[2] = (ushort)uVar17;
        local_78[3] = (ushort)(uVar12 * 2 >> 0x10);
        uStack110 = (undefined)(uVar16 >> 0x10);
        *(char *)psVar25 = (char)(uVar16 >> 0x18) + '0';
        psVar25 = (short *)((longlong)psVar25 + 1);
        if (iVar28 < 1) break;
        uVar16 = uVar16 & 0xffffff | uVar12 >> 0x1f;
      }
    }
    bStack109 = 0;
    psVar26 = psVar25 + -1;
    if ('4' < *(char *)((longlong)psVar25 + -1)) {
      for (; (psVar1 <= psVar26 && (*(char *)psVar26 == '9'));
          psVar26 = (short *)((longlong)psVar26 + -1)) {
        *(char *)psVar26 = '0';
      }
      if (psVar26 < psVar1) {
        psVar26 = (short *)((longlong)psVar26 + 1);
        *param_4 = *param_4 + 1;
      }
      *(char *)psVar26 = *(char *)psVar26 + '\x01';
LAB_180032a6e:
      cVar20 = ((char)psVar26 - (char)param_4) + -3;
      *(char *)((longlong)param_4 + 3) = cVar20;
      *(undefined *)((longlong)cVar20 + 4 + (longlong)param_4) = 0;
      goto LAB_180032a82;
    }
    for (; (psVar1 <= psVar26 && (*(char *)psVar26 == '0'));
        psVar26 = (short *)((longlong)psVar26 + -1)) {
    }
    if (psVar1 <= psVar26) goto LAB_180032a6e;
    *param_4 = 0;
    *(undefined *)((longlong)param_4 + 3) = 1;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
    *(undefined *)(param_4 + 1) = uVar6;
    *(char *)psVar1 = '0';
  }
  *(undefined *)((longlong)param_4 + 5) = 0;
LAB_180032a82:
  FUN_180023ef0(local_48 ^ (ulonglong)&stack0xffffffffffffff08);
  return;
}



undefined8 FUN_180032b3c(uint param_1)

{
  int *piVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
  lVar2 = *(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8);
  if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
    _lock(10);
    if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
      FUN_180027794((LPCRITICAL_SECTION)(lVar3 + 0x10 + lVar2),4000);
      piVar1 = (int *)(lVar3 + 0xc + lVar2);
      *piVar1 = *piVar1 + 1;
    }
    FUN_18002d5f0(10);
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)
             (*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 0x10 +
             lVar3));
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180032bd4(uint param_1)

{
  int *piVar1;
  ulong *puVar2;
  DWORD nStdHandle;
  longlong lVar3;
  
  if ((-1 < (int)param_1) && (param_1 < DAT_180057ba8)) {
    lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
    if (((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8
                   + lVar3) & 1) != 0) &&
       (*(longlong *)
         (*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + lVar3) != -1
       )) {
      if (_DAT_180055fa0 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else {
          if (param_1 == 1) {
            nStdHandle = 0xfffffff5;
          }
          else {
            if (param_1 != 2) goto LAB_180032c4a;
            nStdHandle = 0xfffffff4;
          }
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_180032c4a:
      *(undefined8 *)
       (lVar3 + *(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8)) =
           0xffffffffffffffff;
      return 0;
    }
  }
  piVar1 = _errno();
  *piVar1 = 9;
  puVar2 = __doserrno();
  *puVar2 = 0;
  return 0xffffffff;
}



undefined8 FUN_180032c80(uint param_1)

{
  ulong *puVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_180057ba8)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar3) & 1) != 0) {
        return *(undefined8 *)
                (*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + lVar3
                );
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
    FUN_18002add8();
  }
  return 0xffffffffffffffff;
}



void FUN_180032cf4(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x000180032d17. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x1f) * 0x58 + 0x10 +
             *(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8)));
  return;
}



// Library Function - Single Match
//  _putwch_nolock
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

wint_t _putwch_nolock(wchar_t _WCh)

{
  BOOL BVar1;
  wint_t local_res8 [4];
  DWORD local_res10 [6];
  
  local_res8[0] = _WCh;
  if (DAT_180054f90 == (HANDLE)0xfffffffffffffffe) {
    __initconout();
  }
  if ((DAT_180054f90 == (HANDLE)0xffffffffffffffff) ||
     (BVar1 = WriteConsoleW(DAT_180054f90,local_res8,1,local_res10,(LPVOID)0x0), BVar1 == 0)) {
    local_res8[0] = 0xffff;
  }
  return local_res8[0];
}



wint_t FUN_180032d7c(wint_t param_1,FILE *param_2)

{
  uint _FileHandle;
  int iVar1;
  uint uVar2;
  int *piVar3;
  undefined **ppuVar4;
  longlong lVar5;
  undefined *puVar6;
  uint uVar7;
  wint_t local_res10 [4];
  
  _FileHandle = _fileno(param_2);
  uVar7 = param_2->_flag;
  if ((uVar7 & 0x82) == 0) {
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((uVar7 & 0x40) == 0) {
      uVar2 = 0;
      if ((uVar7 & 1) != 0) {
        param_2->_cnt = 0;
        if ((uVar7 & 0x10) == 0) {
          param_2->_flag = uVar7 | 0x20;
          return 0xffff;
        }
        param_2->_ptr = param_2->_base;
        param_2->_flag = uVar7 & 0xfffffffe;
      }
      uVar7 = param_2->_flag;
      param_2->_cnt = 0;
      param_2->_flag = uVar7 & 0xffffffef | 2;
      if (((uVar7 & 0x10c) == 0) &&
         (((ppuVar4 = FUN_18002da8c(), param_2 != (FILE *)(ppuVar4 + 6) &&
           (ppuVar4 = FUN_18002da8c(), param_2 != (FILE *)(ppuVar4 + 0xc))) ||
          (iVar1 = _isatty(_FileHandle), iVar1 == 0)))) {
        _getbuf(param_2);
      }
      if ((param_2->_flag & 0x108U) == 0) {
        uVar7 = 2;
        local_res10[0] = param_1;
        uVar2 = FUN_18002eea0(_FileHandle,local_res10,2);
      }
      else {
        uVar7 = *(int *)&param_2->_ptr - *(int *)&param_2->_base;
        param_2->_ptr = (char *)((longlong)param_2->_base + 2);
        param_2->_cnt = param_2->_bufsiz + -2;
        if ((int)uVar7 < 1) {
          if (_FileHandle + 2 < 2) {
            puVar6 = &DAT_180053810;
          }
          else {
            puVar6 = (undefined *)
                     ((ulonglong)(_FileHandle & 0x1f) * 0x58 +
                     *(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)_FileHandle >> 5) * 8)
                     );
          }
          if (((puVar6[8] & 0x20) != 0) && (lVar5 = FUN_18002f778(_FileHandle,0,2), lVar5 == -1))
          goto LAB_180032db2;
        }
        else {
          uVar2 = FUN_18002eea0(_FileHandle,(wint_t *)param_2->_base,uVar7);
        }
        *(wint_t *)param_2->_base = param_1;
      }
      if (uVar2 == uVar7) {
        return param_1;
      }
    }
    else {
      piVar3 = _errno();
      *piVar3 = 0x22;
    }
  }
LAB_180032db2:
  param_2->_flag = param_2->_flag | 0x20;
  return 0xffff;
}



DWORD FUN_180032f0c(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  int *piVar3;
  HANDLE hFile;
  ulong *puVar4;
  longlong lVar5;
  
  if (param_1 == 0xfffffffe) {
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_180057ba8)) {
      lVar5 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar5) & 1) != 0) {
        FUN_180032b3c(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar5) & 1) != 0) {
          hFile = (HANDLE)FUN_180032c80(param_1);
          BVar1 = FlushFileBuffers(hFile);
          if (BVar1 == 0) {
            DVar2 = GetLastError();
          }
          else {
            DVar2 = 0;
          }
          if (DVar2 == 0) goto LAB_180032fb7;
          puVar4 = __doserrno();
          *puVar4 = DVar2;
        }
        piVar3 = _errno();
        *piVar3 = 9;
        DVar2 = 0xffffffff;
LAB_180032fb7:
        FUN_180032cf4(param_1);
        return DVar2;
      }
    }
    piVar3 = _errno();
    *piVar3 = 9;
    FUN_18002add8();
  }
  return 0xffffffff;
}



// Library Function - Single Match
//  _fclose_nolock
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _fclose_nolock(FILE *_File)

{
  int iVar1;
  uint uVar2;
  int *piVar3;
  ulonglong uVar4;
  
  iVar1 = -1;
  if (_File == (FILE *)0x0) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18002add8();
    iVar1 = -1;
  }
  else {
    if ((*(byte *)&_File->_flag & 0x83) != 0) {
      iVar1 = _flush(_File);
      _freebuf(_File);
      uVar2 = _fileno(_File);
      uVar4 = FUN_180033348(uVar2);
      if ((int)uVar4 < 0) {
        iVar1 = -1;
      }
      else {
        if (_File->_tmpfname != (char *)0x0) {
          free(_File->_tmpfname);
          _File->_tmpfname = (char *)0x0;
        }
      }
    }
    _File->_flag = 0;
  }
  return iVar1;
}



// Library Function - Single Match
//  fclose
// 
// Library: Visual Studio 2012 Release

int fclose(FILE *_File)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = -1;
  if (_File == (FILE *)0x0) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18002add8();
    iVar1 = -1;
  }
  else {
    if ((*(byte *)&_File->_flag & 0x40) == 0) {
      _lock_file(_File);
      iVar1 = _fclose_nolock(_File);
      _unlock_file(_File);
    }
    else {
      _File->_flag = 0;
    }
  }
  return iVar1;
}



void FUN_1800330c8(char *param_1,int param_2,undefined8 *param_3)

{
  undefined8 uVar1;
  int iVar2;
  bool bVar3;
  bool bVar4;
  uint uVar5;
  short sVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_28;
  
  *(undefined4 *)param_3 = 0;
  *(undefined4 *)((longlong)param_3 + 4) = 0;
  *(undefined4 *)(param_3 + 1) = 0;
  sVar6 = 0x404e;
  if (param_2 != 0) {
    uVar5 = 0;
    uVar9 = 0;
    uVar8 = 0;
    bVar4 = true;
    do {
      uVar1 = *param_3;
      iVar2 = *(int *)(param_3 + 1);
      uVar10 = uVar5 * 4;
      uVar7 = (uVar9 * 2 | uVar5 >> 0x1f) * 2 | uVar5 * 2 >> 0x1f;
      uVar9 = (uVar8 * 2 | uVar9 >> 0x1f) * 2 | uVar9 * 2 >> 0x1f;
      local_28 = (uint)uVar1;
      *(uint *)param_3 = uVar10;
      uVar5 = uVar10 + local_28;
      *(uint *)((longlong)param_3 + 4) = uVar7;
      *(uint *)(param_3 + 1) = uVar9;
      if ((uVar5 < uVar10) || (bVar3 = false, uVar5 < local_28)) {
        bVar3 = bVar4;
      }
      *(uint *)param_3 = uVar5;
      uVar8 = uVar7;
      if (bVar3) {
        uVar8 = uVar7 + 1;
        if ((uVar8 < uVar7) || (bVar3 = false, uVar8 == 0)) {
          bVar3 = bVar4;
        }
        *(uint *)((longlong)param_3 + 4) = uVar8;
        if (bVar3) {
          uVar9 = uVar9 + 1;
          *(uint *)(param_3 + 1) = uVar9;
        }
      }
      uVar10 = (uint)((ulonglong)uVar1 >> 0x20);
      uVar7 = uVar8 + uVar10;
      if ((uVar7 < uVar8) || (bVar3 = false, uVar7 < uVar10)) {
        bVar3 = bVar4;
      }
      *(uint *)((longlong)param_3 + 4) = uVar7;
      if (bVar3) {
        uVar9 = uVar9 + 1;
        *(uint *)(param_3 + 1) = uVar9;
      }
      uVar10 = uVar5 * 2;
      uVar8 = (uVar9 + iVar2) * 2 | uVar7 >> 0x1f;
      *(uint *)param_3 = uVar10;
      *(uint *)(param_3 + 1) = uVar8;
      uVar7 = uVar7 * 2 | uVar5 >> 0x1f;
      *(uint *)((longlong)param_3 + 4) = uVar7;
      uVar5 = uVar10 + (int)*param_1;
      if ((uVar5 < uVar10) || (bVar3 = false, uVar5 < (uint)(int)*param_1)) {
        bVar3 = bVar4;
      }
      *(uint *)param_3 = uVar5;
      uVar9 = uVar7;
      if (bVar3) {
        uVar9 = uVar7 + 1;
        if ((uVar9 < uVar7) || (bVar3 = false, uVar9 == 0)) {
          bVar3 = bVar4;
        }
        *(uint *)((longlong)param_3 + 4) = uVar9;
        if (bVar3) {
          uVar8 = uVar8 + 1;
          *(uint *)(param_3 + 1) = uVar8;
        }
      }
      param_1 = param_1 + 1;
      *(uint *)((longlong)param_3 + 4) = uVar9;
      *(uint *)(param_3 + 1) = uVar8;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  if (*(int *)(param_3 + 1) == 0) {
    uVar5 = *(uint *)((longlong)param_3 + 4);
    do {
      uVar9 = *(uint *)param_3;
      uVar10 = uVar5 >> 0x10;
      *(uint *)param_3 = uVar9 << 0x10;
      uVar8 = uVar9 >> 0x10 | uVar5 << 0x10;
      sVar6 = sVar6 + -0x10;
      uVar9 = uVar5 >> 0x10;
      uVar5 = uVar8;
    } while (uVar9 == 0);
    *(uint *)((longlong)param_3 + 4) = uVar8;
    *(uint *)(param_3 + 1) = uVar10;
  }
  uVar5 = *(uint *)(param_3 + 1);
  if ((uVar5 & 0x8000) == 0) {
    uVar9 = *(uint *)param_3;
    uVar8 = *(uint *)((longlong)param_3 + 4);
    do {
      uVar10 = uVar5 * 2;
      uVar5 = uVar8 >> 0x1f;
      uVar8 = uVar8 * 2 | uVar9 >> 0x1f;
      uVar5 = uVar10 | uVar5;
      sVar6 = sVar6 + -1;
      uVar9 = uVar9 * 2;
    } while ((uVar10 & 0x8000) == 0);
    *(uint *)param_3 = uVar9;
    *(uint *)((longlong)param_3 + 4) = uVar8;
    *(uint *)(param_3 + 1) = uVar5;
  }
  *(short *)((longlong)param_3 + 10) = sVar6;
  return;
}



// Library Function - Single Match
//  __initconout
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void __initconout(void)

{
  DAT_180054f90 = CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  return;
}



ulonglong FUN_180033348(uint param_1)

{
  ulong *puVar1;
  int *piVar2;
  ulonglong uVar3;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_180057ba8)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar4) & 1) != 0) {
        FUN_180032b3c(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar4) & 1) == 0) {
          piVar2 = _errno();
          *piVar2 = 9;
          uVar3 = 0xffffffff;
        }
        else {
          uVar3 = FUN_18003340c(param_1);
          uVar3 = uVar3 & 0xffffffff;
        }
        FUN_180032cf4(param_1);
        return uVar3;
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
    FUN_18002add8();
  }
  return 0xffffffff;
}



undefined8 FUN_18003340c(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  longlong lVar3;
  longlong lVar4;
  HANDLE hObject;
  undefined8 uVar5;
  
  lVar3 = FUN_180032c80(param_1);
  if (lVar3 != -1) {
    if (((param_1 == 1) && ((*(byte *)(DAT_180055c80 + 0xb8) & 1) != 0)) ||
       ((param_1 == 2 && ((*(byte *)(DAT_180055c80 + 0x60) & 1) != 0)))) {
      lVar3 = FUN_180032c80(2);
      lVar4 = FUN_180032c80(1);
      if (lVar4 == lVar3) goto LAB_18003347f;
    }
    hObject = (HANDLE)FUN_180032c80(param_1);
    BVar1 = CloseHandle(hObject);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      goto LAB_180033481;
    }
  }
LAB_18003347f:
  DVar2 = 0;
LAB_180033481:
  FUN_180032bd4(param_1);
  *(undefined *)
   (*(longlong *)((longlong)&DAT_180055c80 + ((longlong)(int)param_1 >> 5) * 8) + 8 +
   (ulonglong)(param_1 & 0x1f) * 0x58) = 0;
  if (DVar2 == 0) {
    uVar5 = 0;
  }
  else {
    _dosmaperr(DVar2);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



// Library Function - Single Match
//  _freebuf
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void _freebuf(FILE *_File)

{
  if (((*(byte *)&_File->_flag & 0x83) != 0) && ((*(byte *)&_File->_flag & 8) != 0)) {
    free(_File->_base);
    _File->_flag = _File->_flag & 0xfffffbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



undefined4 * FUN_180033500(undefined4 *param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  DWORD DVar3;
  
  FUN_1800244a0((undefined (*) [16])(param_1 + 10),0,0x28);
  *(undefined8 *)(param_1 + 0x14) = 0;
  param_1[0x16] = 0;
  param_1[0x17] = 0;
  *(undefined8 *)(param_1 + 4) = 0x180000000;
  *(undefined8 *)(param_1 + 2) = 0x180000000;
  *param_1 = 0x60;
  *(undefined **)(param_1 + 8) = &DAT_18004d320;
  param_1[6] = 0xc00;
  BVar2 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(param_1 + 10),0,0);
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    DVar1 = DVar3 & 0xffff | 0x80070000;
    if ((int)DVar3 < 1) {
      DVar1 = DVar3;
    }
    if ((int)DVar1 < 0) {
      BVar2 = IsDebuggerPresent();
      if (BVar2 != 0) {
        OutputDebugStringW(L"ERROR : Unable to initialize critical section in CAtlBaseModule\n");
      }
      DAT_1800569f9 = 1;
    }
  }
  return param_1;
}



// Library Function - Single Match
//  public: __cdecl ATL::CAtlBaseModule::~CAtlBaseModule(void) __ptr64
// 
// Library: Visual Studio

void __thiscall ATL::CAtlBaseModule::_CAtlBaseModule(CAtlBaseModule *this)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)(this + 0x28));
  if (*(void **)(this + 0x50) != (void *)0x0) {
    free(*(void **)(this + 0x50));
    *(undefined8 *)(this + 0x50) = 0;
  }
  *(undefined4 *)(this + 0x58) = 0;
  *(undefined4 *)(this + 0x5c) = 0;
  return;
}



void GdiplusShutdown(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800335dc. Too many branches
                    // WARNING: Treating indirect jump as call
  GdiplusShutdown();
  return;
}



void GdipAlloc(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800335e2. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipAlloc();
  return;
}



void GdipFree(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800335e8. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipFree();
  return;
}



void GdiplusStartup(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800335ee. Too many branches
                    // WARNING: Treating indirect jump as call
  GdiplusStartup();
  return;
}



void GdipCloneImage(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800335f4. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipCloneImage();
  return;
}



void GdipDisposeImage(void)

{
                    // WARNING: Could not recover jumptable at 0x0001800335fa. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipDisposeImage();
  return;
}



void GdipGetImageGraphicsContext(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033600. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipGetImageGraphicsContext();
  return;
}



void GdipGetImageWidth(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033606. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipGetImageWidth();
  return;
}



void GdipGetImageHeight(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003360c. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipGetImageHeight();
  return;
}



void GdipGetImagePixelFormat(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033612. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipGetImagePixelFormat();
  return;
}



void GdipGetImagePalette(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033618. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipGetImagePalette();
  return;
}



void GdipGetImagePaletteSize(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003361e. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipGetImagePaletteSize();
  return;
}



void GdipCreateBitmapFromFile(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033624. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipCreateBitmapFromFile();
  return;
}



void GdipCreateBitmapFromScan0(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003362a. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipCreateBitmapFromScan0();
  return;
}



void GdipBitmapLockBits(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033630. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipBitmapLockBits();
  return;
}



void GdipBitmapUnlockBits(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033636. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipBitmapUnlockBits();
  return;
}



void GdipDeleteGraphics(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003363c. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipDeleteGraphics();
  return;
}



void GdipDrawImageI(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033642. Too many branches
                    // WARNING: Treating indirect jump as call
  GdipDrawImageI();
  return;
}



void WTSQuerySessionInformationW(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033648. Too many branches
                    // WARNING: Treating indirect jump as call
  WTSQuerySessionInformationW();
  return;
}



void WTSFreeMemory(void)

{
                    // WARNING: Could not recover jumptable at 0x00018003364e. Too many branches
                    // WARNING: Treating indirect jump as call
  WTSFreeMemory();
  return;
}



BOOL IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x000180033654. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



void RtlUnwindEx(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,
                PVOID ReturnValue,PCONTEXT ContextRecord,PUNWIND_HISTORY_TABLE HistoryTable)

{
                    // WARNING: Could not recover jumptable at 0x00018003365a. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwindEx(TargetFrame,TargetIp,ExceptionRecord,ReturnValue,ContextRecord,HistoryTable);
  return;
}



void Unwind_180033660(undefined8 param_1,longlong param_2)

{
  longlong lVar1;
  
  lVar1 = *(longlong *)(param_2 + 0x40);
  if (*(char *)(lVar1 + 0x38) != '\0') {
    *(undefined *)(lVar1 + 0x38) = 0;
                    // WARNING: Could not recover jumptable at 0x00018000d54e. Too many branches
                    // WARNING: Treating indirect jump as call
    DeleteCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x10));
    return;
  }
  return;
}



void Unwind_180033670(undefined8 param_1,longlong param_2)

{
  FUN_1800251e0(*(void **)(param_2 + 0x30));
  return;
}



undefined * Catch_All_18003368f(void)

{
  return &LAB_18000da96;
}



undefined * Catch_All_1800336b0(void)

{
  return &LAB_18000d369;
}



void Unwind_1800336d0(undefined8 param_1,longlong param_2)

{
  FUN_18000e140(*(undefined ***)(param_2 + 0x40));
  return;
}



void Unwind_1800336e0(undefined8 param_1,longlong param_2)

{
  longlong lVar1;
  
  lVar1 = *(longlong *)(param_2 + 0x40);
  if (*(char *)(lVar1 + 0x48) != '\0') {
    *(undefined *)(lVar1 + 0x48) = 0;
                    // WARNING: Could not recover jumptable at 0x00018000d52e. Too many branches
                    // WARNING: Treating indirect jump as call
    DeleteCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x20));
    return;
  }
  return;
}



void Unwind_1800336f0(undefined8 param_1,longlong param_2)

{
  FUN_1800251e0(*(void **)(param_2 + 0x78));
  return;
}



undefined * Catch_All_18003370f(void)

{
  return &DAT_18000e565;
}



void Unwind_180033730(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x48));
  return;
}



void Unwind_18003373c(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x48));
  return;
}



void Unwind_180033750(undefined8 param_1,longlong param_2)

{
  FUN_18001f5b0(*(undefined ***)(param_2 + 0x40));
  return;
}



bool FUN_180033760(int **param_1)

{
  return **param_1 == -0x3fffff03;
}



void Unwind_180033790(undefined8 param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_1800102d0(*(undefined ***)(param_2 + 0x60),param_2,param_3,param_4);
  return;
}



void Unwind_18003379c(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x78));
  return;
}



void Unwind_1800337b0(undefined8 param_1,longlong param_2)

{
  longlong lVar1;
  
  lVar1 = *(longlong *)(param_2 + 0x40);
  if (*(char *)(lVar1 + 0x38) != '\0') {
    *(undefined *)(lVar1 + 0x38) = 0;
                    // WARNING: Could not recover jumptable at 0x00018000d52e. Too many branches
                    // WARNING: Treating indirect jump as call
    DeleteCriticalSection((LPCRITICAL_SECTION)(lVar1 + 0x10));
    return;
  }
  return;
}



void Unwind_1800337c0(undefined8 param_1,longlong param_2)

{
  FUN_18001cd80(*(undefined ***)(param_2 + 0x40));
  return;
}



void Unwind_1800337d0(undefined8 param_1,longlong param_2)

{
  FUN_1800251e0(*(void **)(param_2 + 0x78));
  return;
}



void Unwind_1800337ef(undefined8 param_1,longlong param_2)

{
  FUN_18001cd80(*(undefined ***)(param_2 + 0x78));
  return;
}



undefined * Catch_All_1800337fb(void)

{
  return &DAT_18001cfcc;
}



void Unwind_180033820(undefined8 param_1,longlong param_2)

{
  FUN_180020cd0(*(undefined ***)(param_2 + 0x40));
  return;
}



void Unwind_180033830(undefined8 param_1,longlong param_2)

{
  FUN_1800251e0(*(void **)(param_2 + 0x78));
  return;
}



void Unwind_18003384f(undefined8 param_1,longlong param_2)

{
  FUN_180020cd0(*(undefined ***)(param_2 + 0x78));
  return;
}



undefined * Catch_All_18003385b(void)

{
  return &DAT_18002171c;
}



void Unwind_180033880(undefined8 param_1,longlong param_2)

{
                    // WARNING: Could not recover jumptable at 0x000180020cc9. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(longlong **)(param_2 + 0x50) + 0x50))
            (*(longlong **)(param_2 + 0x50),*(undefined4 *)(param_2 + 0x58));
  return;
}



void Unwind_180033890(undefined8 param_1,longlong param_2)

{
  if (*(longlong **)(param_2 + 0x48) != (longlong *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180020cbb. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(**(longlong **)(param_2 + 0x48) + 0x10))();
    return;
  }
  return;
}



void Unwind_1800338a0(undefined8 param_1,longlong param_2)

{
                    // WARNING: Could not recover jumptable at 0x000180020cc9. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(longlong **)(param_2 + 0x58) + 0x50))
            (*(longlong **)(param_2 + 0x58),*(undefined4 *)(param_2 + 0x60));
  return;
}



void Unwind_1800338b0(undefined8 param_1,longlong param_2)

{
                    // WARNING: Could not recover jumptable at 0x000180020cc9. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(longlong **)(param_2 + 0x48) + 0x50))
            (*(longlong **)(param_2 + 0x48),*(undefined4 *)(param_2 + 0x50));
  return;
}



void Unwind_1800338c0(undefined8 param_1,longlong param_2)

{
                    // WARNING: Could not recover jumptable at 0x000180020cc9. Too many branches
                    // WARNING: Treating indirect jump as call
  (**(code **)(**(longlong **)(param_2 + 0x60) + 0x50))
            (*(longlong **)(param_2 + 0x60),*(undefined4 *)(param_2 + 0x68));
  return;
}



void FUN_1800338f2(undefined8 *param_1,longlong param_2)

{
  undefined4 uVar1;
  
  *(undefined8 **)(param_2 + 0x40) = param_1;
  uVar1 = *(undefined4 *)*param_1;
  *(undefined4 *)(param_2 + 0x30) = uVar1;
  *(undefined8 **)(param_2 + 0x38) = param_1;
  *(undefined4 *)(param_2 + 0x28) = uVar1;
  if (*(int *)(param_2 + 0x78) == 1) {
    FUN_180023a9c(*(undefined8 *)(param_2 + 0x70),0,*(longlong *)(param_2 + 0x80));
  }
  FUN_180026434(*(int *)(param_2 + 0x28),*(void **)(param_2 + 0x38));
  return;
}



void FUN_18003393b(void)

{
  FUN_180026b3c();
  return;
}



undefined * Catch_All_18003394f(undefined8 param_1,longlong param_2)

{
  *(undefined8 *)(param_2 + 0x50) = 0;
  return &DAT_1800251d5;
}



// Library Function - Single Match
//  _CallSETranslator$filt$0
// 
// Library: Visual Studio 2005 Release

void _CallSETranslator_filt_0(_EXCEPTION_POINTERS *param_1,longlong param_2)

{
  __SehTransFilter(param_1,*(EHExceptionRecord **)(param_2 + 0x70),
                   *(unsigned___int64 **)(param_2 + 0x78),*(_CONTEXT **)(param_2 + 0x80),
                   *(_xDISPATCHER_CONTEXT **)(param_2 + 0x88),*(_s_FuncInfo **)(param_2 + 0x90),
                   (int *)(param_2 + 0x40));
  return;
}



void FUN_1800339b5(void)

{
  FUN_18002d5f0(0xd);
  return;
}



void FUN_1800339ce(void)

{
  FUN_18002d5f0(0xc);
  return;
}



void FUN_1800339e7(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x80) != 0) {
    FUN_18002d5f0(8);
  }
  return;
}



void FUN_180033a0b(void)

{
  FUN_18002d5f0(0xb);
  return;
}



undefined4 FUN_180033a26(undefined8 param_1,longlong param_2)

{
  _ptiddata p_Var1;
  
  *(undefined8 *)(param_2 + 0x70) = param_1;
  *(undefined8 *)(param_2 + 0x68) = param_1;
  *(undefined8 *)(param_2 + 0x28) = **(undefined8 **)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if ((((**(int **)(param_2 + 0x28) == -0x1f928c9d) &&
       (*(int *)(*(longlong *)(param_2 + 0x28) + 0x18) == 4)) &&
      ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930520 ||
       ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930521 ||
        (*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930522)))))) &&
     (*(longlong *)(*(longlong *)(param_2 + 0x28) + 0x28) ==
      *(longlong *)(*(longlong *)(param_2 + 0xd8) + 0x28))) {
    *(undefined4 *)(param_2 + 0x20) = 1;
  }
  if (((**(int **)(param_2 + 0x28) == -0x1f928c9d) &&
      (*(int *)(*(longlong *)(param_2 + 0x28) + 0x18) == 4)) &&
     (((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930520 ||
       ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930521 ||
        (*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930522)))) &&
      (*(longlong *)(*(longlong *)(param_2 + 0x28) + 0x30) == 0)))) {
    p_Var1 = _getptd();
    *(undefined4 *)&p_Var1->_reserved4 = 1;
    *(undefined4 *)(param_2 + 0x20) = 1;
    *(undefined4 *)(param_2 + 0x30) = 1;
  }
  else {
    *(undefined4 *)(param_2 + 0x30) = 0;
  }
  return *(undefined4 *)(param_2 + 0x30);
}



bool FUN_180033b98(undefined8 param_1,longlong param_2)

{
  return *(char *)(param_2 + 0x38) != '\0';
}



void FUN_180033bb0(int **param_1)

{
  __FrameUnwindFilter(param_1);
  return;
}



void FUN_180033bc6(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  if (0 < p_Var1->_ProcessingThrow) {
    p_Var1 = _getptd();
    p_Var1->_ProcessingThrow = p_Var1->_ProcessingThrow + -1;
  }
  return;
}



void FUN_180033bef(void)

{
  FUN_18002d5f0(0xe);
  return;
}



void FUN_180033c08(void)

{
  FUN_18002d5f0(0xd);
  return;
}



void FUN_180033c21(void)

{
  FUN_18002d5f0(0xc);
  return;
}



void FUN_180033c3a(void)

{
                    // WARNING: Could not recover jumptable at 0x000180033c4f. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(DAT_180054480);
  return;
}



bool FUN_180033c60(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



void FUN_180033c80(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x60) != 0) {
    FUN_18002d5f0(0);
  }
  return;
}



undefined8 FUN_180033c9e(int **param_1)

{
  undefined8 uVar1;
  
  if ((**param_1 == -0x3ffffffb) || (**param_1 == -0x3fffffe3)) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



void FUN_180033cca(undefined8 param_1,longlong param_2)

{
  FUN_180032cf4(*(uint *)(param_2 + 0x50));
  return;
}



void FUN_180033ce1(undefined8 param_1,longlong param_2)

{
  FUN_18002db80(*(int *)(param_2 + 0x20),
                *(longlong *)(DAT_180056a58 + (longlong)*(int *)(param_2 + 0x20) * 8));
  return;
}



void FUN_180033d09(void)

{
  FUN_18002d5f0(1);
  return;
}



void FUN_180033d22(void)

{
  FUN_18002d5f0(1);
  return;
}



void FUN_180033d3b(void)

{
  FUN_18002d5f0(10);
  return;
}



void FUN_180033d54(undefined8 param_1,longlong param_2)

{
  _unlock_file(*(FILE **)(param_2 + 0x30));
  return;
}



void FUN_180033d6c(undefined8 param_1,longlong param_2)

{
  FUN_180032cf4(*(uint *)(param_2 + 0x40));
  return;
}



void FUN_180033d90(void)

{
  PVOID *ppvVar1;
  PVOID Ptr;
  longlong *plVar2;
  longlong *plVar3;
  
  if (DAT_180056a10 != 0) {
    plVar2 = DAT_180056a28;
    plVar3 = DAT_180056a20;
    if (DAT_180056a20 < DAT_180056a28) {
      do {
        if (*plVar3 != 0) {
          ppvVar1 = *(PVOID **)(*plVar3 + 0x20);
          Ptr = *ppvVar1;
          if (Ptr != (PVOID)0x0) {
            plVar2 = (longlong *)DecodePointer(Ptr);
            (**(code **)(*plVar2 + 0x10))(plVar2);
            *ppvVar1 = (PVOID)0x0;
            plVar2 = DAT_180056a28;
          }
        }
        plVar3 = plVar3 + 1;
      } while (plVar3 < plVar2);
    }
    DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_180056a30);
    DAT_180056a10 = 0;
  }
  FUN_180004810();
  return;
}



void FUN_180033e50(void)

{
  HDC *ppHVar1;
  longlong lVar2;
  
  ppHVar1 = (HDC *)&DAT_1800551c8;
  lVar2 = 4;
  do {
    if (*ppHVar1 != (HDC)0x0) {
      DeleteDC(*ppHVar1);
    }
    ppHVar1 = ppHVar1 + 1;
    lVar2 = lVar2 + -1;
  } while (lVar2 != 0);
  return;
}



void FUN_180033e90(void)

{
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
  if (DAT_180055188 != 0) {
    GdiplusShutdown();
  }
  DAT_180055188 = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
                    // WARNING: Could not recover jumptable at 0x000180033ed5. Too many branches
                    // WARNING: Treating indirect jump as call
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_180055190);
  return;
}


