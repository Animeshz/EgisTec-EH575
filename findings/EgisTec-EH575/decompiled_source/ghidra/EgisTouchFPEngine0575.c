typedef unsigned char   undefined;

typedef unsigned long long    GUID;
typedef unsigned int    ImageBaseOffset32;
typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned long long    qword;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef short    wchar_t;
typedef unsigned short    word;
typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion;

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct {
    dword OffsetToDirectory;
    dword DataIsDirectory;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion {
    dword OffsetToData;
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryStruct;
};

typedef struct _s__RTTIClassHierarchyDescriptor _s__RTTIClassHierarchyDescriptor, *P_s__RTTIClassHierarchyDescriptor;

struct _s__RTTIClassHierarchyDescriptor {
    dword signature;
    dword attributes; // bit flags
    dword numBaseClasses; // number of base classes (i.e. rtti1Count)
    ImageBaseOffset32 pBaseClassArray; // ref to BaseClassArray (RTTI 2)
};

typedef struct type_info type_info, *Ptype_info;

struct type_info { // PlaceHolder Class Structure
};

typedef struct _s_FuncInfo _s_FuncInfo, *P_s_FuncInfo;

typedef int __ehstate_t;

struct _s_FuncInfo {
    uint magicNumber_and_bbtFlags;
    __ehstate_t maxState;
    ImageBaseOffset32 dispUnwindMap;
    uint nTryBlocks;
    ImageBaseOffset32 dispTryBlockMap;
    uint nIPMapEntries;
    ImageBaseOffset32 dispIPToStateMap;
    int dispUnwindHelp;
    ImageBaseOffset32 dispESTypeList;
    int EHFlags;
};

typedef struct _s__RTTIBaseClassDescriptor _s__RTTIBaseClassDescriptor, *P_s__RTTIBaseClassDescriptor;

typedef struct PMD PMD, *PPMD;

struct PMD {
    int mdisp;
    int pdisp;
    int vdisp;
};

struct _s__RTTIBaseClassDescriptor {
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    dword numContainedBases; // count of extended classes in BaseClassArray (RTTI 2)
    struct PMD where; // member displacement structure
    dword attributes; // bit flags
    ImageBaseOffset32 pClassHierarchyDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3) for class
};

typedef struct _s_UnwindMapEntry _s_UnwindMapEntry, *P_s_UnwindMapEntry;

struct _s_UnwindMapEntry {
    __ehstate_t toState;
    ImageBaseOffset32 action;
};

typedef struct _s__RTTICompleteObjectLocator _s__RTTICompleteObjectLocator, *P_s__RTTICompleteObjectLocator;

struct _s__RTTICompleteObjectLocator {
    dword signature;
    dword offset; // offset of vbtable within class
    dword cdOffset; // constructor displacement offset
    ImageBaseOffset32 pTypeDescriptor; // ref to TypeDescriptor (RTTI 0) for class
    ImageBaseOffset32 pClassDescriptor; // ref to ClassHierarchyDescriptor (RTTI 3)
};

typedef unsigned short    wchar16;
typedef struct _IMAGE_RUNTIME_FUNCTION_ENTRY _IMAGE_RUNTIME_FUNCTION_ENTRY, *P_IMAGE_RUNTIME_FUNCTION_ENTRY;

struct _IMAGE_RUNTIME_FUNCTION_ENTRY {
    ImageBaseOffset32 BeginAddress;
    ImageBaseOffset32 EndAddress;
    ImageBaseOffset32 UnwindInfoAddressOrData;
};

typedef struct _s_IPToStateMapEntry _s_IPToStateMapEntry, *P_s_IPToStateMapEntry;

struct _s_IPToStateMapEntry {
    ImageBaseOffset32 Ip;
    __ehstate_t state;
};

typedef struct _s_UnwindMapEntry UnwindMapEntry;

typedef struct _s_IPToStateMapEntry IPToStateMapEntry;

typedef struct _s__RTTIClassHierarchyDescriptor RTTIClassHierarchyDescriptor;

typedef struct _s_FuncInfo FuncInfo;

typedef struct _s__RTTIBaseClassDescriptor RTTIBaseClassDescriptor;

typedef struct TypeDescriptor TypeDescriptor, *PTypeDescriptor;

struct TypeDescriptor {
    void * pVFTable;
    void * spare;
    char[0] name;
};

typedef struct _s__RTTICompleteObjectLocator RTTICompleteObjectLocator;

typedef struct exception exception, *Pexception;

struct exception { // PlaceHolder Class Structure
};

typedef struct _cpinfo _cpinfo, *P_cpinfo;

typedef uint UINT;

typedef uchar BYTE;

struct _cpinfo {
    UINT MaxCharSize;
    BYTE DefaultChar[2];
    BYTE LeadByte[12];
};

typedef struct _cpinfo * LPCPINFO;


// WARNING! conflicting data type names: /guiddef.h/GUID - /GUID

typedef struct _GUID _GUID, *P_GUID;

struct _GUID {
    ulong Data1;
    ushort Data2;
    ushort Data3;
    uchar Data4[8];
};

typedef struct _BCryptBufferDesc _BCryptBufferDesc, *P_BCryptBufferDesc;

typedef struct _BCryptBufferDesc BCryptBufferDesc;

typedef ulong ULONG;

typedef struct _BCryptBuffer _BCryptBuffer, *P_BCryptBuffer;

typedef struct _BCryptBuffer * PBCryptBuffer;

typedef void * PVOID;

struct _BCryptBuffer {
    ULONG cbBuffer;
    ULONG BufferType;
    PVOID pvBuffer;
};

struct _BCryptBufferDesc {
    ULONG ulVersion;
    ULONG cBuffers;
    PBCryptBuffer pBuffers;
};

typedef PVOID BCRYPT_SECRET_HANDLE;

typedef PVOID BCRYPT_KEY_HANDLE;

typedef PVOID BCRYPT_HANDLE;

typedef PVOID BCRYPT_HASH_HANDLE;

typedef PVOID BCRYPT_ALG_HANDLE;

typedef long LONG;

typedef LONG NTSTATUS;

typedef struct _SECURITY_ATTRIBUTES _SECURITY_ATTRIBUTES, *P_SECURITY_ATTRIBUTES;

typedef ulong DWORD;

typedef void * LPVOID;

typedef int BOOL;

struct _SECURITY_ATTRIBUTES {
    DWORD nLength;
    LPVOID lpSecurityDescriptor;
    BOOL bInheritHandle;
};

typedef struct _OVERLAPPED _OVERLAPPED, *P_OVERLAPPED;

typedef ulonglong ULONG_PTR;

typedef union _union_538 _union_538, *P_union_538;

typedef void * HANDLE;

typedef struct _struct_539 _struct_539, *P_struct_539;

struct _struct_539 {
    DWORD Offset;
    DWORD OffsetHigh;
};

union _union_538 {
    struct _struct_539 s;
    PVOID Pointer;
};

struct _OVERLAPPED {
    ULONG_PTR Internal;
    ULONG_PTR InternalHigh;
    union _union_538 u;
    HANDLE hEvent;
};

typedef struct _STARTUPINFOW _STARTUPINFOW, *P_STARTUPINFOW;

typedef wchar_t WCHAR;

typedef WCHAR * LPWSTR;

typedef ushort WORD;

typedef BYTE * LPBYTE;

struct _STARTUPINFOW {
    DWORD cb;
    LPWSTR lpReserved;
    LPWSTR lpDesktop;
    LPWSTR lpTitle;
    DWORD dwX;
    DWORD dwY;
    DWORD dwXSize;
    DWORD dwYSize;
    DWORD dwXCountChars;
    DWORD dwYCountChars;
    DWORD dwFillAttribute;
    DWORD dwFlags;
    WORD wShowWindow;
    WORD cbReserved2;
    LPBYTE lpReserved2;
    HANDLE hStdInput;
    HANDLE hStdOutput;
    HANDLE hStdError;
};

typedef struct _SYSTEMTIME _SYSTEMTIME, *P_SYSTEMTIME;

struct _SYSTEMTIME {
    WORD wYear;
    WORD wMonth;
    WORD wDayOfWeek;
    WORD wDay;
    WORD wHour;
    WORD wMinute;
    WORD wSecond;
    WORD wMilliseconds;
};

typedef struct _STARTUPINFOW * LPSTARTUPINFOW;

typedef struct _RTL_CRITICAL_SECTION _RTL_CRITICAL_SECTION, *P_RTL_CRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION * PRTL_CRITICAL_SECTION;

typedef PRTL_CRITICAL_SECTION LPCRITICAL_SECTION;

typedef struct _RTL_CRITICAL_SECTION_DEBUG _RTL_CRITICAL_SECTION_DEBUG, *P_RTL_CRITICAL_SECTION_DEBUG;

typedef struct _RTL_CRITICAL_SECTION_DEBUG * PRTL_CRITICAL_SECTION_DEBUG;

typedef struct _LIST_ENTRY _LIST_ENTRY, *P_LIST_ENTRY;

typedef struct _LIST_ENTRY LIST_ENTRY;

struct _RTL_CRITICAL_SECTION {
    PRTL_CRITICAL_SECTION_DEBUG DebugInfo;
    LONG LockCount;
    LONG RecursionCount;
    HANDLE OwningThread;
    HANDLE LockSemaphore;
    ULONG_PTR SpinCount;
};

struct _LIST_ENTRY {
    struct _LIST_ENTRY * Flink;
    struct _LIST_ENTRY * Blink;
};

struct _RTL_CRITICAL_SECTION_DEBUG {
    WORD Type;
    WORD CreatorBackTraceIndex;
    struct _RTL_CRITICAL_SECTION * CriticalSection;
    LIST_ENTRY ProcessLocksList;
    DWORD EntryCount;
    DWORD ContentionCount;
    DWORD Flags;
    WORD CreatorBackTraceIndexHigh;
    WORD SpareWORD;
};

typedef struct _OVERLAPPED * LPOVERLAPPED;

typedef DWORD (* PTHREAD_START_ROUTINE)(LPVOID);

typedef PTHREAD_START_ROUTINE LPTHREAD_START_ROUTINE;

typedef struct _EXCEPTION_POINTERS _EXCEPTION_POINTERS, *P_EXCEPTION_POINTERS;

typedef LONG (* PTOP_LEVEL_EXCEPTION_FILTER)(struct _EXCEPTION_POINTERS *);

typedef struct _EXCEPTION_RECORD _EXCEPTION_RECORD, *P_EXCEPTION_RECORD;

typedef struct _EXCEPTION_RECORD EXCEPTION_RECORD;

typedef EXCEPTION_RECORD * PEXCEPTION_RECORD;

typedef struct _CONTEXT _CONTEXT, *P_CONTEXT;

typedef struct _CONTEXT * PCONTEXT;

typedef ulonglong DWORD64;

typedef union _union_52 _union_52, *P_union_52;

typedef struct _M128A _M128A, *P_M128A;

typedef struct _M128A M128A;

typedef struct _XSAVE_FORMAT _XSAVE_FORMAT, *P_XSAVE_FORMAT;

typedef struct _XSAVE_FORMAT XSAVE_FORMAT;

typedef XSAVE_FORMAT XMM_SAVE_AREA32;

typedef struct _struct_53 _struct_53, *P_struct_53;

typedef ulonglong ULONGLONG;

typedef longlong LONGLONG;

struct _M128A {
    ULONGLONG Low;
    LONGLONG High;
};

struct _XSAVE_FORMAT {
    WORD ControlWord;
    WORD StatusWord;
    BYTE TagWord;
    BYTE Reserved1;
    WORD ErrorOpcode;
    DWORD ErrorOffset;
    WORD ErrorSelector;
    WORD Reserved2;
    DWORD DataOffset;
    WORD DataSelector;
    WORD Reserved3;
    DWORD MxCsr;
    DWORD MxCsr_Mask;
    M128A FloatRegisters[8];
    M128A XmmRegisters[16];
    BYTE Reserved4[96];
};

struct _struct_53 {
    M128A Header[2];
    M128A Legacy[8];
    M128A Xmm0;
    M128A Xmm1;
    M128A Xmm2;
    M128A Xmm3;
    M128A Xmm4;
    M128A Xmm5;
    M128A Xmm6;
    M128A Xmm7;
    M128A Xmm8;
    M128A Xmm9;
    M128A Xmm10;
    M128A Xmm11;
    M128A Xmm12;
    M128A Xmm13;
    M128A Xmm14;
    M128A Xmm15;
};

union _union_52 {
    XMM_SAVE_AREA32 FltSave;
    struct _struct_53 s;
};

struct _CONTEXT {
    DWORD64 P1Home;
    DWORD64 P2Home;
    DWORD64 P3Home;
    DWORD64 P4Home;
    DWORD64 P5Home;
    DWORD64 P6Home;
    DWORD ContextFlags;
    DWORD MxCsr;
    WORD SegCs;
    WORD SegDs;
    WORD SegEs;
    WORD SegFs;
    WORD SegGs;
    WORD SegSs;
    DWORD EFlags;
    DWORD64 Dr0;
    DWORD64 Dr1;
    DWORD64 Dr2;
    DWORD64 Dr3;
    DWORD64 Dr6;
    DWORD64 Dr7;
    DWORD64 Rax;
    DWORD64 Rcx;
    DWORD64 Rdx;
    DWORD64 Rbx;
    DWORD64 Rsp;
    DWORD64 Rbp;
    DWORD64 Rsi;
    DWORD64 Rdi;
    DWORD64 R8;
    DWORD64 R9;
    DWORD64 R10;
    DWORD64 R11;
    DWORD64 R12;
    DWORD64 R13;
    DWORD64 R14;
    DWORD64 R15;
    DWORD64 Rip;
    union _union_52 u;
    M128A VectorRegister[26];
    DWORD64 VectorControl;
    DWORD64 DebugControl;
    DWORD64 LastBranchToRip;
    DWORD64 LastBranchFromRip;
    DWORD64 LastExceptionToRip;
    DWORD64 LastExceptionFromRip;
};

struct _EXCEPTION_RECORD {
    DWORD ExceptionCode;
    DWORD ExceptionFlags;
    struct _EXCEPTION_RECORD * ExceptionRecord;
    PVOID ExceptionAddress;
    DWORD NumberParameters;
    ULONG_PTR ExceptionInformation[15];
};

struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;
    PCONTEXT ContextRecord;
};

typedef struct _SECURITY_ATTRIBUTES * LPSECURITY_ATTRIBUTES;

typedef struct _SYSTEMTIME * LPSYSTEMTIME;

typedef PTOP_LEVEL_EXCEPTION_FILTER LPTOP_LEVEL_EXCEPTION_FILTER;

typedef struct _CONTEXT CONTEXT;

typedef char CHAR;

typedef union _LARGE_INTEGER _LARGE_INTEGER, *P_LARGE_INTEGER;

typedef struct _struct_19 _struct_19, *P_struct_19;

typedef struct _struct_20 _struct_20, *P_struct_20;

struct _struct_20 {
    DWORD LowPart;
    LONG HighPart;
};

struct _struct_19 {
    DWORD LowPart;
    LONG HighPart;
};

union _LARGE_INTEGER {
    struct _struct_19 s;
    struct _struct_20 u;
    LONGLONG QuadPart;
};

typedef union _LARGE_INTEGER LARGE_INTEGER;

typedef WCHAR * PCWSTR;

typedef struct _RUNTIME_FUNCTION _RUNTIME_FUNCTION, *P_RUNTIME_FUNCTION;

struct _RUNTIME_FUNCTION {
    DWORD BeginAddress;
    DWORD EndAddress;
    DWORD UnwindData;
};

typedef struct _IMAGE_SECTION_HEADER _IMAGE_SECTION_HEADER, *P_IMAGE_SECTION_HEADER;

typedef union _union_236 _union_236, *P_union_236;

union _union_236 {
    DWORD PhysicalAddress;
    DWORD VirtualSize;
};

struct _IMAGE_SECTION_HEADER {
    BYTE Name[8];
    union _union_236 Misc;
    DWORD VirtualAddress;
    DWORD SizeOfRawData;
    DWORD PointerToRawData;
    DWORD PointerToRelocations;
    DWORD PointerToLinenumbers;
    WORD NumberOfRelocations;
    WORD NumberOfLinenumbers;
    DWORD Characteristics;
};

typedef struct _RUNTIME_FUNCTION * PRUNTIME_FUNCTION;

typedef enum _EXCEPTION_DISPOSITION {
    ExceptionCollidedUnwind=3,
    ExceptionContinueExecution=0,
    ExceptionContinueSearch=1,
    ExceptionNestedException=2
} _EXCEPTION_DISPOSITION;

typedef enum _EXCEPTION_DISPOSITION EXCEPTION_DISPOSITION;

typedef EXCEPTION_DISPOSITION (EXCEPTION_ROUTINE)(struct _EXCEPTION_RECORD *, PVOID, struct _CONTEXT *, PVOID);

typedef struct _IMAGE_SECTION_HEADER * PIMAGE_SECTION_HEADER;

typedef struct _EXCEPTION_POINTERS EXCEPTION_POINTERS;

typedef WCHAR * LPWCH;

typedef WCHAR * LPCWSTR;

typedef struct _M128A * PM128A;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY _UNWIND_HISTORY_TABLE_ENTRY, *P_UNWIND_HISTORY_TABLE_ENTRY;

typedef struct _UNWIND_HISTORY_TABLE_ENTRY UNWIND_HISTORY_TABLE_ENTRY;

struct _UNWIND_HISTORY_TABLE_ENTRY {
    DWORD64 ImageBase;
    PRUNTIME_FUNCTION FunctionEntry;
};

typedef union _union_61 _union_61, *P_union_61;

typedef ulonglong * PDWORD64;

typedef struct _struct_62 _struct_62, *P_struct_62;

struct _struct_62 {
    PDWORD64 Rax;
    PDWORD64 Rcx;
    PDWORD64 Rdx;
    PDWORD64 Rbx;
    PDWORD64 Rsp;
    PDWORD64 Rbp;
    PDWORD64 Rsi;
    PDWORD64 Rdi;
    PDWORD64 R8;
    PDWORD64 R9;
    PDWORD64 R10;
    PDWORD64 R11;
    PDWORD64 R12;
    PDWORD64 R13;
    PDWORD64 R14;
    PDWORD64 R15;
};

union _union_61 {
    PDWORD64 IntegerContext[16];
    struct _struct_62 s;
};

typedef struct _UNWIND_HISTORY_TABLE _UNWIND_HISTORY_TABLE, *P_UNWIND_HISTORY_TABLE;

typedef struct _UNWIND_HISTORY_TABLE * PUNWIND_HISTORY_TABLE;

struct _UNWIND_HISTORY_TABLE {
    DWORD Count;
    BYTE LocalHint;
    BYTE GlobalHint;
    BYTE Search;
    BYTE Once;
    DWORD64 LowAddress;
    DWORD64 HighAddress;
    UNWIND_HISTORY_TABLE_ENTRY Entry[12];
};

typedef struct _struct_60 _struct_60, *P_struct_60;

struct _struct_60 {
    PM128A Xmm0;
    PM128A Xmm1;
    PM128A Xmm2;
    PM128A Xmm3;
    PM128A Xmm4;
    PM128A Xmm5;
    PM128A Xmm6;
    PM128A Xmm7;
    PM128A Xmm8;
    PM128A Xmm9;
    PM128A Xmm10;
    PM128A Xmm11;
    PM128A Xmm12;
    PM128A Xmm13;
    PM128A Xmm14;
    PM128A Xmm15;
};

typedef CHAR * LPCSTR;

typedef LONG * PLONG;

typedef enum _SID_NAME_USE {
    SidTypeAlias=4,
    SidTypeComputer=9,
    SidTypeDeletedAccount=6,
    SidTypeDomain=3,
    SidTypeGroup=2,
    SidTypeInvalid=7,
    SidTypeLabel=10,
    SidTypeUnknown=8,
    SidTypeUser=1,
    SidTypeWellKnownGroup=5
} _SID_NAME_USE;

typedef union _union_59 _union_59, *P_union_59;

union _union_59 {
    PM128A FloatingContext[16];
    struct _struct_60 s;
};

typedef LARGE_INTEGER * PLARGE_INTEGER;

typedef CHAR * LPSTR;

typedef enum _SID_NAME_USE * PSID_NAME_USE;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS _KNONVOLATILE_CONTEXT_POINTERS, *P_KNONVOLATILE_CONTEXT_POINTERS;

typedef struct _KNONVOLATILE_CONTEXT_POINTERS * PKNONVOLATILE_CONTEXT_POINTERS;

struct _KNONVOLATILE_CONTEXT_POINTERS {
    union _union_59 u;
    union _union_61 u2;
};

typedef EXCEPTION_ROUTINE * PEXCEPTION_ROUTINE;

typedef DWORD ACCESS_MASK;

typedef DWORD LCID;

typedef PVOID PSID;

typedef struct IMAGE_DOS_HEADER IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;

struct IMAGE_DOS_HEADER {
    char e_magic[2]; // Magic number
    word e_cblp; // Bytes of last page
    word e_cp; // Pages in file
    word e_crlc; // Relocations
    word e_cparhdr; // Size of header in paragraphs
    word e_minalloc; // Minimum extra paragraphs needed
    word e_maxalloc; // Maximum extra paragraphs needed
    word e_ss; // Initial (relative) SS value
    word e_sp; // Initial SP value
    word e_csum; // Checksum
    word e_ip; // Initial IP value
    word e_cs; // Initial (relative) CS value
    word e_lfarlc; // File address of relocation table
    word e_ovno; // Overlay number
    word e_res[4][4]; // Reserved words
    word e_oemid; // OEM identifier (for e_oeminfo)
    word e_oeminfo; // OEM information; e_oemid specific
    word e_res2[10][10]; // Reserved words
    dword e_lfanew; // File address of new exe header
    byte e_program[64]; // Actual DOS program
};

typedef longlong INT_PTR;

typedef ULONG_PTR DWORD_PTR;

typedef ULONG_PTR SIZE_T;

typedef struct DotNetPdbInfo DotNetPdbInfo, *PDotNetPdbInfo;

struct DotNetPdbInfo {
    char signature[4];
    GUID guid;
    dword age;
    char pdbname[25];
};

typedef struct _strflt _strflt, *P_strflt;

struct _strflt {
    int sign;
    int decpt;
    int flag;
    char * mantissa;
};

typedef struct _strflt * STRFLT;

typedef struct _FILETIME _FILETIME, *P_FILETIME;

typedef struct _FILETIME * LPFILETIME;

struct _FILETIME {
    DWORD dwLowDateTime;
    DWORD dwHighDateTime;
};

typedef INT_PTR (* FARPROC)(void);

typedef struct HKEY__ HKEY__, *PHKEY__;

struct HKEY__ {
    int unused;
};

typedef uchar UCHAR;

typedef UCHAR * PUCHAR;

typedef DWORD * LPDWORD;

typedef WORD * LPWORD;

typedef struct HKEY__ * HKEY;

typedef HKEY * PHKEY;

typedef struct HINSTANCE__ HINSTANCE__, *PHINSTANCE__;

struct HINSTANCE__ {
    int unused;
};

typedef DWORD * PDWORD;

typedef BOOL * LPBOOL;

typedef BYTE * PBYTE;

typedef struct HINSTANCE__ * HINSTANCE;

typedef HINSTANCE HMODULE;

typedef struct _FILETIME * PFILETIME;

typedef void * LPCVOID;

typedef struct HWND__ HWND__, *PHWND__;

typedef struct HWND__ * HWND;

struct HWND__ {
    int unused;
};

typedef HANDLE HLOCAL;

typedef struct Var Var, *PVar;

struct Var {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;

struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct {
    dword NameOffset;
    dword NameIsString;
};

typedef struct IMAGE_DEBUG_DIRECTORY IMAGE_DEBUG_DIRECTORY, *PIMAGE_DEBUG_DIRECTORY;

struct IMAGE_DEBUG_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Type;
    dword SizeOfData;
    dword AddressOfRawData;
    dword PointerToRawData;
};

typedef struct IMAGE_FILE_HEADER IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;

struct IMAGE_FILE_HEADER {
    word Machine; // 34404
    word NumberOfSections;
    dword TimeDateStamp;
    dword PointerToSymbolTable;
    dword NumberOfSymbols;
    word SizeOfOptionalHeader;
    word Characteristics;
};

typedef struct IMAGE_LOAD_CONFIG_DIRECTORY64 IMAGE_LOAD_CONFIG_DIRECTORY64, *PIMAGE_LOAD_CONFIG_DIRECTORY64;

struct IMAGE_LOAD_CONFIG_DIRECTORY64 {
    dword Size;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword GlobalFlagsClear;
    dword GlobalFlagsSet;
    dword CriticalSectionDefaultTimeout;
    qword DeCommitFreeBlockThreshold;
    qword DeCommitTotalFreeThreshold;
    pointer64 LockPrefixTable;
    qword MaximumAllocationSize;
    qword VirtualMemoryThreshold;
    qword ProcessAffinityMask;
    dword ProcessHeapFlags;
    word CsdVersion;
    word DependentLoadFlags;
    pointer64 EditList;
    pointer64 SecurityCookie;
    pointer64 SEHandlerTable;
    qword SEHandlerCount;
};

typedef struct StringFileInfo StringFileInfo, *PStringFileInfo;

struct StringFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY IMAGE_RESOURCE_DIRECTORY_ENTRY, *PIMAGE_RESOURCE_DIRECTORY_ENTRY;

typedef union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion, *PIMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion;

union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion {
    struct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct IMAGE_RESOURCE_DIRECTORY_ENTRY_NameStruct;
    dword Name;
    word Id;
};

union IMAGE_RESOURCE_DIRECTORY_ENTRY {
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_NameUnion NameUnion;
    union IMAGE_RESOURCE_DIRECTORY_ENTRY_DirectoryUnion DirectoryUnion;
};

typedef struct IMAGE_OPTIONAL_HEADER64 IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;

typedef struct IMAGE_DATA_DIRECTORY IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;

struct IMAGE_DATA_DIRECTORY {
    ImageBaseOffset32 VirtualAddress;
    dword Size;
};

struct IMAGE_OPTIONAL_HEADER64 {
    word Magic;
    byte MajorLinkerVersion;
    byte MinorLinkerVersion;
    dword SizeOfCode;
    dword SizeOfInitializedData;
    dword SizeOfUninitializedData;
    ImageBaseOffset32 AddressOfEntryPoint;
    ImageBaseOffset32 BaseOfCode;
    pointer64 ImageBase;
    dword SectionAlignment;
    dword FileAlignment;
    word MajorOperatingSystemVersion;
    word MinorOperatingSystemVersion;
    word MajorImageVersion;
    word MinorImageVersion;
    word MajorSubsystemVersion;
    word MinorSubsystemVersion;
    dword Win32VersionValue;
    dword SizeOfImage;
    dword SizeOfHeaders;
    dword CheckSum;
    word Subsystem;
    word DllCharacteristics;
    qword SizeOfStackReserve;
    qword SizeOfStackCommit;
    qword SizeOfHeapReserve;
    qword SizeOfHeapCommit;
    dword LoaderFlags;
    dword NumberOfRvaAndSizes;
    struct IMAGE_DATA_DIRECTORY DataDirectory[16];
};

typedef struct StringTable StringTable, *PStringTable;

struct StringTable {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_SECTION_HEADER IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;

typedef union Misc Misc, *PMisc;

typedef enum SectionFlags {
    IMAGE_SCN_ALIGN_1024BYTES=11534336,
    IMAGE_SCN_ALIGN_128BYTES=8388608,
    IMAGE_SCN_ALIGN_16BYTES=5242880,
    IMAGE_SCN_ALIGN_1BYTES=1048576,
    IMAGE_SCN_ALIGN_2048BYTES=12582912,
    IMAGE_SCN_ALIGN_256BYTES=9437184,
    IMAGE_SCN_ALIGN_2BYTES=2097152,
    IMAGE_SCN_ALIGN_32BYTES=6291456,
    IMAGE_SCN_ALIGN_4096BYTES=13631488,
    IMAGE_SCN_ALIGN_4BYTES=3145728,
    IMAGE_SCN_ALIGN_512BYTES=10485760,
    IMAGE_SCN_ALIGN_64BYTES=7340032,
    IMAGE_SCN_ALIGN_8192BYTES=14680064,
    IMAGE_SCN_ALIGN_8BYTES=4194304,
    IMAGE_SCN_CNT_CODE=32,
    IMAGE_SCN_CNT_INITIALIZED_DATA=64,
    IMAGE_SCN_CNT_UNINITIALIZED_DATA=128,
    IMAGE_SCN_GPREL=32768,
    IMAGE_SCN_LNK_COMDAT=4096,
    IMAGE_SCN_LNK_INFO=512,
    IMAGE_SCN_LNK_NRELOC_OVFL=16777216,
    IMAGE_SCN_LNK_OTHER=256,
    IMAGE_SCN_LNK_REMOVE=2048,
    IMAGE_SCN_MEM_16BIT=131072,
    IMAGE_SCN_MEM_DISCARDABLE=33554432,
    IMAGE_SCN_MEM_EXECUTE=536870912,
    IMAGE_SCN_MEM_LOCKED=262144,
    IMAGE_SCN_MEM_NOT_CACHED=67108864,
    IMAGE_SCN_MEM_NOT_PAGED=134217728,
    IMAGE_SCN_MEM_PRELOAD=524288,
    IMAGE_SCN_MEM_PURGEABLE=131072,
    IMAGE_SCN_MEM_READ=1073741824,
    IMAGE_SCN_MEM_SHARED=268435456,
    IMAGE_SCN_MEM_WRITE=2147483648,
    IMAGE_SCN_RESERVED_0001=16,
    IMAGE_SCN_RESERVED_0040=1024,
    IMAGE_SCN_TYPE_NO_PAD=8
} SectionFlags;

union Misc {
    dword PhysicalAddress;
    dword VirtualSize;
};

struct IMAGE_SECTION_HEADER {
    char Name[8];
    union Misc Misc;
    ImageBaseOffset32 VirtualAddress;
    dword SizeOfRawData;
    dword PointerToRawData;
    dword PointerToRelocations;
    dword PointerToLinenumbers;
    word NumberOfRelocations;
    word NumberOfLinenumbers;
    enum SectionFlags Characteristics;
};

typedef struct IMAGE_NT_HEADERS64 IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;

struct IMAGE_NT_HEADERS64 {
    char Signature[4];
    struct IMAGE_FILE_HEADER FileHeader;
    struct IMAGE_OPTIONAL_HEADER64 OptionalHeader;
};

typedef struct VS_VERSION_INFO VS_VERSION_INFO, *PVS_VERSION_INFO;

struct VS_VERSION_INFO {
    word StructLength;
    word ValueLength;
    word StructType;
    wchar16 Info[16];
    byte Padding[2];
    dword Signature;
    word StructVersion[2];
    word FileVersion[4];
    word ProductVersion[4];
    dword FileFlagsMask[2];
    dword FileFlags;
    dword FileOS;
    dword FileType;
    dword FileSubtype;
    dword FileTimestamp;
};

typedef struct IMAGE_RESOURCE_DATA_ENTRY IMAGE_RESOURCE_DATA_ENTRY, *PIMAGE_RESOURCE_DATA_ENTRY;

struct IMAGE_RESOURCE_DATA_ENTRY {
    dword OffsetToData;
    dword Size;
    dword CodePage;
    dword Reserved;
};

typedef struct VarFileInfo VarFileInfo, *PVarFileInfo;

struct VarFileInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct IMAGE_RESOURCE_DIRECTORY IMAGE_RESOURCE_DIRECTORY, *PIMAGE_RESOURCE_DIRECTORY;

struct IMAGE_RESOURCE_DIRECTORY {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    word NumberOfNamedEntries;
    word NumberOfIdEntries;
};

typedef struct IMAGE_DIRECTORY_ENTRY_EXPORT IMAGE_DIRECTORY_ENTRY_EXPORT, *PIMAGE_DIRECTORY_ENTRY_EXPORT;

struct IMAGE_DIRECTORY_ENTRY_EXPORT {
    dword Characteristics;
    dword TimeDateStamp;
    word MajorVersion;
    word MinorVersion;
    dword Name;
    dword Base;
    dword NumberOfFunctions;
    dword NumberOfNames;
    dword AddressOfFunctions;
    dword AddressOfNames;
    dword AddressOfNameOrdinals;
};

typedef struct StringInfo StringInfo, *PStringInfo;

struct StringInfo {
    word wLength;
    word wValueLength;
    word wType;
};

typedef struct _iobuf _iobuf, *P_iobuf;

struct _iobuf {
    char * _ptr;
    int _cnt;
    char * _base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char * _tmpfname;
};

typedef struct _iobuf FILE;

typedef LONG LSTATUS;

typedef ACCESS_MASK REGSAM;

typedef char * va_list;

typedef ulonglong uintptr_t;

typedef struct _tiddata _tiddata, *P_tiddata;

typedef struct _tiddata * _ptiddata;

typedef struct threadmbcinfostruct threadmbcinfostruct, *Pthreadmbcinfostruct;

typedef struct threadmbcinfostruct * pthreadmbcinfo;

typedef struct threadlocaleinfostruct threadlocaleinfostruct, *Pthreadlocaleinfostruct;

typedef struct threadlocaleinfostruct * pthreadlocinfo;

typedef struct setloc_struct setloc_struct, *Psetloc_struct;

typedef struct setloc_struct _setloc_struct;

typedef struct localerefcount localerefcount, *Plocalerefcount;

typedef struct localerefcount locrefcount;

typedef struct lconv lconv, *Plconv;

typedef struct __lc_time_data __lc_time_data, *P__lc_time_data;

typedef struct _is_ctype_compatible _is_ctype_compatible, *P_is_ctype_compatible;

struct lconv {
    char * decimal_point;
    char * thousands_sep;
    char * grouping;
    char * int_curr_symbol;
    char * currency_symbol;
    char * mon_decimal_point;
    char * mon_thousands_sep;
    char * mon_grouping;
    char * positive_sign;
    char * negative_sign;
    char int_frac_digits;
    char frac_digits;
    char p_cs_precedes;
    char p_sep_by_space;
    char n_cs_precedes;
    char n_sep_by_space;
    char p_sign_posn;
    char n_sign_posn;
    wchar_t * _W_decimal_point;
    wchar_t * _W_thousands_sep;
    wchar_t * _W_int_curr_symbol;
    wchar_t * _W_currency_symbol;
    wchar_t * _W_mon_decimal_point;
    wchar_t * _W_mon_thousands_sep;
    wchar_t * _W_positive_sign;
    wchar_t * _W_negative_sign;
};

struct _is_ctype_compatible {
    ulong id;
    int is_clike;
};

struct setloc_struct {
    wchar_t * pchLanguage;
    wchar_t * pchCountry;
    int iLocState;
    int iPrimaryLen;
    BOOL bAbbrevLanguage;
    BOOL bAbbrevCountry;
    UINT _cachecp;
    wchar_t _cachein[131];
    wchar_t _cacheout[131];
    struct _is_ctype_compatible _Loc_c[5];
    wchar_t _cacheLocaleName[85];
};

struct threadmbcinfostruct {
    int refcount;
    int mbcodepage;
    int ismbcodepage;
    ushort mbulinfo[6];
    uchar mbctype[257];
    uchar mbcasemap[256];
    wchar_t * mblocalename;
};

struct localerefcount {
    char * locale;
    wchar_t * wlocale;
    int * refcount;
    int * wrefcount;
};

struct threadlocaleinfostruct {
    int refcount;
    uint lc_codepage;
    uint lc_collate_cp;
    uint lc_time_cp;
    locrefcount lc_category[6];
    int lc_clike;
    int mb_cur_max;
    int * lconv_intl_refcount;
    int * lconv_num_refcount;
    int * lconv_mon_refcount;
    struct lconv * lconv;
    int * ctype1_refcount;
    ushort * ctype1;
    ushort * pctype;
    uchar * pclmap;
    uchar * pcumap;
    struct __lc_time_data * lc_time_curr;
    wchar_t * locale_name[6];
};

struct _tiddata {
    ulong _tid;
    uintptr_t _thandle;
    int _terrno;
    ulong _tdoserrno;
    uint _fpds;
    ulong _holdrand;
    char * _token;
    wchar_t * _wtoken;
    uchar * _mtoken;
    char * _errmsg;
    wchar_t * _werrmsg;
    char * _namebuf0;
    wchar_t * _wnamebuf0;
    char * _namebuf1;
    wchar_t * _wnamebuf1;
    char * _asctimebuf;
    wchar_t * _wasctimebuf;
    void * _gmtimebuf;
    char * _cvtbuf;
    uchar _con_ch_buf[5];
    ushort _ch_buf_used;
    void * _initaddr;
    void * _initarg;
    void * _pxcptacttab;
    void * _tpxcptinfoptrs;
    int _tfpecode;
    pthreadmbcinfo ptmbcinfo;
    pthreadlocinfo ptlocinfo;
    int _ownlocale;
    ulong _NLG_dwCode;
    void * _terminate;
    void * _unexpected;
    void * _translator;
    void * _purecall;
    void * _curexception;
    void * _curcontext;
    int _ProcessingThrow;
    void * _curexcspec;
    void * _pExitContext;
    void * _pUnwindContext;
    void * _pFrameInfoChain;
    ulonglong _ImageBase;
    ulonglong _ThrowImageBase;
    void * _pForeignException;
    _setloc_struct _setloc_data;
    void * _reserved1;
    void * _reserved2;
    void * _reserved3;
    void * _reserved4;
    void * _reserved5;
    int _cxxReThrow;
    ulong __initDomain;
    int _initapartment;
};

struct __lc_time_data {
    char * wday_abbr[7];
    char * wday[7];
    char * month_abbr[12];
    char * month[12];
    char * ampm[2];
    char * ww_sdatefmt;
    char * ww_ldatefmt;
    char * ww_timefmt;
    int ww_caltype;
    int refcount;
    wchar_t * _W_wday_abbr[7];
    wchar_t * _W_wday[7];
    wchar_t * _W_month_abbr[12];
    wchar_t * _W_month[12];
    wchar_t * _W_ampm[2];
    wchar_t * _W_ww_sdatefmt;
    wchar_t * _W_ww_ldatefmt;
    wchar_t * _W_ww_timefmt;
    wchar_t * _W_ww_locale_name;
};

typedef struct _s_CatchableType _s_CatchableType, *P_s_CatchableType;

struct _s_CatchableType { // PlaceHolder Structure
};

typedef struct _xDISPATCHER_CONTEXT _xDISPATCHER_CONTEXT, *P_xDISPATCHER_CONTEXT;

struct _xDISPATCHER_CONTEXT { // PlaceHolder Structure
};

typedef struct EHExceptionRecord EHExceptionRecord, *PEHExceptionRecord;

struct EHExceptionRecord { // PlaceHolder Structure
};

typedef struct _s_HandlerType _s_HandlerType, *P_s_HandlerType;

struct _s_HandlerType { // PlaceHolder Structure
};

typedef dword unsigned___int64;

typedef struct _LocaleUpdate _LocaleUpdate, *P_LocaleUpdate;

struct _LocaleUpdate { // PlaceHolder Structure
};

typedef struct _s_ESTypeList _s_ESTypeList, *P_s_ESTypeList;

struct _s_ESTypeList { // PlaceHolder Structure
};

typedef dword unsigned_int;

typedef struct _s_TryBlockMapEntry _s_TryBlockMapEntry, *P_s_TryBlockMapEntry;

struct _s_TryBlockMapEntry { // PlaceHolder Structure
};

typedef dword unsigned_char;

typedef struct CAtlBaseModule CAtlBaseModule, *PCAtlBaseModule;

struct CAtlBaseModule { // PlaceHolder Structure
};

typedef int (* _onexit_t)(void);

typedef struct _CRT_FLOAT _CRT_FLOAT, *P_CRT_FLOAT;

struct _CRT_FLOAT {
    float f;
};

typedef ushort wint_t;

typedef ulonglong size_t;

typedef int errno_t;

typedef struct localeinfo_struct localeinfo_struct, *Plocaleinfo_struct;

struct localeinfo_struct {
    pthreadlocinfo locinfo;
    pthreadmbcinfo mbcinfo;
};

typedef size_t rsize_t;

typedef struct localeinfo_struct * _locale_t;

typedef ushort wctype_t;

typedef struct _SP_DEVICE_INTERFACE_DETAIL_DATA_W _SP_DEVICE_INTERFACE_DETAIL_DATA_W, *P_SP_DEVICE_INTERFACE_DETAIL_DATA_W;

struct _SP_DEVICE_INTERFACE_DETAIL_DATA_W {
    DWORD cbSize;
    WCHAR DevicePath[1];
};

typedef PVOID HDEVINFO;

typedef struct _SP_DEVICE_INTERFACE_DATA _SP_DEVICE_INTERFACE_DATA, *P_SP_DEVICE_INTERFACE_DATA;

struct _SP_DEVICE_INTERFACE_DATA {
    DWORD cbSize;
    GUID InterfaceClassGuid;
    DWORD Flags;
    ULONG_PTR Reserved;
};

typedef struct _SP_DEVICE_INTERFACE_DETAIL_DATA_W * PSP_DEVICE_INTERFACE_DETAIL_DATA_W;

typedef struct _SP_DEVINFO_DATA _SP_DEVINFO_DATA, *P_SP_DEVINFO_DATA;

struct _SP_DEVINFO_DATA {
    DWORD cbSize;
    GUID ClassGuid;
    DWORD DevInst;
    ULONG_PTR Reserved;
};

typedef struct _SP_DEVICE_INTERFACE_DATA * PSP_DEVICE_INTERFACE_DATA;

typedef struct _SP_DEVINFO_DATA * PSP_DEVINFO_DATA;




bool FUN_180001020(PUCHAR param_1,ULONG param_2)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_res18 [2];
  
  NVar1 = BCryptOpenAlgorithmProvider(local_res18,L"RNG",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenRandom(local_res18[0],param_1,param_2,0);
    BCryptCloseAlgorithmProvider(local_res18[0],0);
  }
  return -1 < NVar1;
}



bool FUN_180001090(PUCHAR *param_1,ULONG *param_2,uint param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28;
  BCRYPT_ALG_HANDLE local_20;
  
  uVar2 = 0;
  local_20 = (BCRYPT_ALG_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_20,L"SHA256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_20,&local_28,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
    if (-1 < NVar1) {
      if (param_3 != 0) {
        do {
          if ((*param_1 != (PUCHAR)0x0) && (*param_2 != 0)) {
            NVar1 = BCryptHashData(local_28,*param_1,*param_2,0);
            if (NVar1 < 0) goto LAB_180001165;
          }
          uVar2 = uVar2 + 1;
          param_1 = param_1 + 1;
          param_2 = param_2 + 1;
        } while (uVar2 < param_3);
      }
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_28,param_4,0x20,0);
      }
LAB_180001165:
      BCryptDestroyHash(local_28);
    }
    BCryptCloseAlgorithmProvider(local_20,0);
  }
  return -1 < NVar1;
}



void FUN_1800011b0(PUCHAR param_1,ULONG param_2,PUCHAR param_3)

{
  PUCHAR local_res8;
  ULONG local_res10 [6];
  
  local_res8 = param_1;
  local_res10[0] = param_2;
  FUN_180001090(&local_res8,local_res10,1,param_3);
  return;
}



bool FUN_1800011e0(PUCHAR param_1,ULONG param_2,PUCHAR *param_3,ULONG *param_4,uint param_5,
                  PUCHAR param_6,BCRYPT_ALG_HANDLE *param_7)

{
  NTSTATUS NVar1;
  uint uVar2;
  BCRYPT_HASH_HANDLE local_28 [2];
  
  NVar1 = BCryptCreateHash(*param_7,local_28,(PUCHAR)0x0,0,param_1,param_2,0);
  if (-1 < NVar1) {
    uVar2 = 0;
    if (param_5 != 0) {
      do {
        if (((*param_3 != (PUCHAR)0x0) && (*param_4 != 0)) &&
           (NVar1 = BCryptHashData(local_28[0],*param_3,*param_4,0), NVar1 < 0)) goto LAB_1800012a3;
        uVar2 = uVar2 + 1;
        param_3 = param_3 + 1;
        param_4 = param_4 + 1;
      } while (uVar2 < param_5);
    }
    if (-1 < NVar1) {
      NVar1 = BCryptFinishHash(local_28[0],param_6,0x20,0);
    }
LAB_1800012a3:
    BCryptDestroyHash(local_28[0]);
  }
  BCryptCloseAlgorithmProvider(*param_7,0);
  return -1 < NVar1;
}



undefined FUN_1800012f0(PUCHAR param_1,ULONG param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  PUCHAR local_res18;
  ULONG local_res20 [2];
  BCRYPT_ALG_HANDLE local_18 [2];
  
  local_res18 = param_3;
  local_res20[0] = param_4;
  NVar2 = BCryptOpenAlgorithmProvider(local_18,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar2) {
    bVar1 = FUN_1800011e0(param_1,param_2,&local_res18,local_res20,1,param_5,local_18);
    return bVar1;
  }
  return 0;
}



NTSTATUS FUN_180001380(PUCHAR *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pszAlgId;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_ALG_HANDLE local_38;
  UCHAR local_30 [40];
  
  local_48[0] = 0x40;
  local_38 = (BCRYPT_ALG_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_180001090(param_1,param_2,1,local_30);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pszAlgId = L"ECDSA_P256";
    if (*param_4 == 0x324b4345) {
      pszAlgId = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_38,pszAlgId,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      NVar2 = BCryptImportKeyPair(local_38,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_40,
                                  (PUCHAR)param_4,0x68,0);
      if (-1 < NVar2) {
        NVar2 = BCryptSignHash(local_40,(void *)0x0,local_30,0x20,param_6,local_48[0],local_48,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return NVar2;
}



NTSTATUS FUN_1800014b0(PUCHAR *param_1,ULONG *param_2,undefined8 param_3,int *param_4,
                      undefined8 param_5,PUCHAR param_6)

{
  bool bVar1;
  NTSTATUS NVar2;
  undefined7 extraout_var;
  wchar_t *pwVar3;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_ALG_HANDLE local_30;
  UCHAR local_28 [32];
  
  local_30 = (BCRYPT_ALG_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  bVar1 = FUN_180001090(param_1,param_2,1,local_28);
  if ((int)CONCAT71(extraout_var,bVar1) == 0) {
    NVar2 = -0x3fffffff;
  }
  else {
    pwVar3 = L"ECDSA_P256";
    if (*param_4 == 0x314b4345) {
      pwVar3 = L"ECDH_P256";
    }
    NVar2 = BCryptOpenAlgorithmProvider(&local_30,pwVar3,(LPCWSTR)0x0,0);
    if (-1 < NVar2) {
      pwVar3 = L"ECCPUBLICBLOB";
      if (*param_4 == 0x32534345) {
        pwVar3 = L"ECCPRIVATEBLOB";
      }
      NVar2 = BCryptImportKeyPair(local_30,(BCRYPT_KEY_HANDLE)0x0,pwVar3,&local_38,(PUCHAR)param_4,
                                  0x48,0);
      if (-1 < NVar2) {
        NVar2 = BCryptVerifySignature(local_38,(void *)0x0,local_28,0x20,param_6,0x40,0);
        if (-1 < NVar2) {
          NVar2 = 0;
        }
      }
    }
  }
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return NVar2;
}



NTSTATUS FUN_1800015d0(PUCHAR param_1,PUCHAR param_2,PVOID param_3,ULONG param_4,PUCHAR param_5,
                      ULONG param_6)

{
  NTSTATUS NVar1;
  BCRYPT_ALG_HANDLE local_68;
  BCRYPT_SECRET_HANDLE local_60;
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_KEY_HANDLE local_50;
  BCryptBufferDesc local_48;
  _BCryptBuffer local_38;
  undefined8 local_28;
  wchar_t *local_20;
  
  local_68 = (BCRYPT_ALG_HANDLE)0x0;
  local_50 = (BCRYPT_KEY_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_60 = (BCRYPT_SECRET_HANDLE)0x0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"ECDH_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_50,param_1,
                                0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptImportKeyPair(local_68,(BCRYPT_KEY_HANDLE)0x0,L"ECCPUBLICBLOB",&local_58,param_2
                                  ,0x48,0);
      if (-1 < NVar1) {
        NVar1 = BCryptSecretAgreement(local_50,local_58,&local_60,0);
        if (-1 < NVar1) {
          local_20 = L"SHA256";
          local_48.pBuffers = (PBCryptBuffer)&local_38;
          local_38.BufferType = 3;
          local_28 = 0xe;
          local_48.cBuffers = 2;
          local_48.ulVersion = 0;
          local_38.cbBuffer = param_4;
          local_38.pvBuffer = param_3;
          NVar1 = BCryptDeriveKey(local_60,L"HMAC",&local_48,param_5,param_6,&param_6,0);
          if (-1 < NVar1) {
            NVar1 = 0;
          }
        }
      }
    }
  }
  if (local_60 != (BCRYPT_SECRET_HANDLE)0x0) {
    BCryptDestroySecret(local_60);
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
  }
  if (local_50 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_50);
  }
  if (local_68 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_68,0);
  }
  return NVar1;
}



bool FUN_180001790(undefined4 *param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4)

{
  NTSTATUS NVar1;
  undefined8 uVar2;
  PUCHAR local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff68;
  int local_78;
  undefined4 local_74;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;
  
  uVar2 = 0x68;
  local_res10 = param_2;
  local_res18[0] = param_3;
  FUN_18001d980((undefined (*) [16])&local_78,0,0x68);
  local_30 = *param_1;
  uStack44 = param_1[1];
  uStack40 = param_1[2];
  uStack36 = param_1[3];
  local_20 = param_1[4];
  uStack28 = param_1[5];
  uStack24 = param_1[6];
  uStack20 = param_1[7];
  local_78 = 0x32534345;
  local_74 = 0x20;
  NVar1 = FUN_180001380(&local_res10,local_res18,uVar2,&local_78,in_stack_ffffffffffffff68,param_4);
  return -1 < NVar1;
}



bool FUN_180001820(undefined8 *param_1,PUCHAR param_2,undefined8 param_3,PUCHAR param_4,
                  undefined4 *param_5)

{
  NTSTATUS NVar1;
  PUCHAR local_res10;
  ULONG local_res18 [4];
  undefined8 in_stack_ffffffffffffff88;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 uStack72;
  undefined8 local_40;
  undefined8 uStack56;
  undefined8 local_30;
  undefined8 uStack40;
  undefined8 local_20;
  undefined8 uStack24;
  
  local_res18[0] = (ULONG)param_3;
  local_50 = *param_1;
  uStack72 = param_1[1];
  local_40 = param_1[2];
  uStack56 = param_1[3];
  local_30 = param_1[4];
  uStack40 = param_1[5];
  local_20 = param_1[6];
  uStack24 = param_1[7];
  local_58 = 0x2031534345;
  local_res10 = param_2;
  NVar1 = FUN_1800014b0(&local_res10,local_res18,param_3,(int *)&local_58,in_stack_ffffffffffffff88,
                        param_4);
  if (-1 < NVar1) {
    *param_5 = 1;
    return true;
  }
  *param_5 = 0;
  return NVar1 == -0x3fff6000;
}



bool FUN_1800018e0(PUCHAR param_1)

{
  NTSTATUS NVar1;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"ECDSA_P256",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptImportKeyPair(local_res20,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",&local_res18,
                                param_1,0x68,0);
    if (-1 < NVar1) {
      NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                              local_res10,0);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



bool FUN_1800019c0(PUCHAR param_1,int param_2)

{
  NTSTATUS NVar1;
  wchar_t *pszAlgId;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  
  pszAlgId = L"ECDSA_P256";
  if (param_2 != 0) {
    pszAlgId = L"ECDH_P256";
  }
  local_res20 = (BCRYPT_ALG_HANDLE)0x0;
  local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  local_res10[0] = 0;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,pszAlgId,(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    NVar1 = BCryptGenerateKeyPair(local_res20,&local_res18,0x100,0);
    if (-1 < NVar1) {
      NVar1 = BCryptFinalizeKeyPair(local_res18,0);
      if (-1 < NVar1) {
        NVar1 = BCryptExportKey(local_res18,(BCRYPT_KEY_HANDLE)0x0,L"ECCPRIVATEBLOB",param_1,0x68,
                                local_res10,0);
        if (-1 < NVar1) {
          NVar1 = 0;
        }
      }
    }
  }
  if (local_res18 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_res18);
    local_res18 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_res20 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_res20,0);
  }
  return -1 < NVar1;
}



undefined4 *
FUN_180001ab0(uint param_1,uint param_2,undefined8 *param_3,undefined8 *param_4,undefined8 *param_5,
             uint *param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  
  uVar2 = param_2 + 0x18 + param_1;
  puVar1 = (undefined4 *)LocalAlloc(0,(ulonglong)uVar2);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0x31415352;
    puVar1[1] = param_1 * 8;
    *(undefined8 *)(puVar1 + 4) = 0;
    puVar1[2] = param_2;
    puVar1[3] = param_1;
    FUN_18001d320((undefined8 *)(puVar1 + 6),param_3,(ulonglong)param_2);
    FUN_18001d320((undefined8 *)((ulonglong)param_2 + (longlong)(puVar1 + 6)),param_4,
                  (ulonglong)param_1);
    *param_5 = puVar1;
    *param_6 = uVar2;
    puVar1 = (undefined4 *)0x1;
  }
  return puVar1;
}



undefined4 FUN_180001b70(longlong param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



void FUN_180001b80(HLOCAL param_1)

{
  if (param_1 != (HLOCAL)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180001b85. Too many branches
                    // WARNING: Treating indirect jump as call
    LocalFree(param_1);
    return;
  }
  return;
}



bool FUN_180001b90(int *param_1,ULONG param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5,
                  ULONG param_6,ULONG *param_7)

{
  NTSTATUS NVar1;
  wchar_t *pszBlobType;
  ULONG *pcbResult;
  ULONG local_res10 [2];
  BCRYPT_KEY_HANDLE local_58;
  BCRYPT_ALG_HANDLE local_50;
  wchar_t *local_48;
  undefined8 local_40;
  undefined4 local_38;
  
  local_48 = L"SHA256";
  local_40 = 0;
  pcbResult = local_res10;
  if (param_7 != (ULONG *)0x0) {
    pcbResult = param_7;
  }
  local_50 = (BCRYPT_ALG_HANDLE)0x0;
  local_58 = (BCRYPT_KEY_HANDLE)0x0;
  local_38 = 0;
  local_res10[0] = 0;
  if (param_2 == 0) {
    if (*param_1 == 0x31415352) {
      param_2 = param_1[2] + 0x18 + param_1[3];
    }
    else {
      if (*param_1 == 0x33415352) {
        param_2 = (param_1[4] + 8) * 3 + (param_1[5] + param_1[3]) * 2 + param_1[2];
      }
    }
  }
  NVar1 = BCryptOpenAlgorithmProvider(&local_50,L"RSA",(LPCWSTR)0x0,0);
  if (-1 < NVar1) {
    pszBlobType = L"RSAFULLPRIVATEBLOB";
    if (*param_1 == 0x31415352) {
      pszBlobType = L"RSAPUBLICBLOB";
    }
    NVar1 = BCryptImportKeyPair(local_50,(BCRYPT_KEY_HANDLE)0x0,pszBlobType,&local_58,
                                (PUCHAR)param_1,param_2,0);
    if (-1 < NVar1) {
      NVar1 = BCryptEncrypt(local_58,param_3,param_4,&local_48,(PUCHAR)0x0,0,param_5,param_6,
                            pcbResult,4);
      if (-1 < NVar1) {
        NVar1 = 0;
      }
    }
  }
  if (local_58 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_58);
    local_58 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_50 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_50,0);
  }
  return -1 < NVar1;
}



bool FUN_180001d20(undefined4 *param_1,int param_2,undefined4 *param_3,int param_4,PVOID param_5,
                  ULONG param_6,PUCHAR param_7,ULONG param_8)

{
  NTSTATUS NVar1;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 uStack188;
  undefined4 uStack184;
  undefined4 uStack180;
  undefined4 local_b0;
  undefined4 uStack172;
  undefined4 uStack168;
  undefined4 uStack164;
  undefined4 local_a0;
  undefined4 uStack156;
  undefined4 uStack152;
  undefined4 uStack148;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;
  
  if ((param_2 == 0x20) && (param_4 == 0x40)) {
    FUN_18001d980((undefined (*) [16])&local_78,0,0x68);
    local_30 = *param_1;
    uStack44 = param_1[1];
    uStack40 = param_1[2];
    uStack36 = param_1[3];
    local_20 = param_1[4];
    uStack28 = param_1[5];
    uStack24 = param_1[6];
    uStack20 = param_1[7];
    local_c0 = *param_3;
    uStack188 = param_3[1];
    uStack184 = param_3[2];
    uStack180 = param_3[3];
    local_78 = 0x324b4345;
    local_b0 = param_3[4];
    uStack172 = param_3[5];
    uStack168 = param_3[6];
    uStack164 = param_3[7];
    local_a0 = param_3[8];
    uStack156 = param_3[9];
    uStack152 = param_3[10];
    uStack148 = param_3[0xb];
    local_74 = 0x20;
    local_c8 = 0x314b4345;
    local_c4 = 0x20;
    local_90 = param_3[0xc];
    uStack140 = param_3[0xd];
    uStack136 = param_3[0xe];
    uStack132 = param_3[0xf];
    NVar1 = FUN_1800015d0((PUCHAR)&local_78,(PUCHAR)&local_c8,param_5,param_6,param_7,param_8);
    return -1 < NVar1;
  }
  return false;
}



bool FUN_180001e20(PUCHAR param_1,uint param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7,ULONG *param_8)

{
  uint uVar1;
  PUCHAR pUVar2;
  NTSTATUS NVar3;
  uint cbInput;
  uint *pcbResult;
  BCRYPT_KEY_HANDLE local_38;
  BCRYPT_HANDLE local_30;
  
  uVar1 = param_5;
  cbInput = (param_5 / param_2) * param_2;
  pcbResult = &param_5;
  if (param_8 != (ULONG *)0x0) {
    pcbResult = param_8;
  }
  local_30 = (BCRYPT_HANDLE)0x0;
  local_38 = (BCRYPT_KEY_HANDLE)0x0;
  param_5 = 0;
  NVar3 = BCryptOpenAlgorithmProvider(&local_30,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar3) &&
     (NVar3 = BCryptSetProperty(local_30,L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar3)) {
    NVar3 = BCryptGenerateSymmetricKey(local_30,&local_38,(PUCHAR)0x0,0,param_1,param_2,0);
    pUVar2 = param_6;
    if (-1 < NVar3) {
      if (cbInput != 0) {
        NVar3 = BCryptEncrypt(local_38,param_4,cbInput,(void *)0x0,param_3,0x10,param_6,param_7,
                              pcbResult,0);
        if (NVar3 < 0) goto LAB_180001f79;
        if (cbInput != *pcbResult) {
          NVar3 = -0x3fffffff;
          goto LAB_180001f79;
        }
      }
      NVar3 = 0;
      if (cbInput < uVar1) {
        if (param_4 != pUVar2) {
          FUN_18001d320((undefined8 *)(pUVar2 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(uVar1 - cbInput));
        }
        *pcbResult = uVar1;
      }
    }
  }
LAB_180001f79:
  if (local_38 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_38);
    local_38 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_30 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_30,0);
  }
  return -1 < NVar3;
}



bool FUN_180001fd0(PUCHAR param_1,undefined8 param_2,PUCHAR param_3,PUCHAR param_4,uint param_5,
                  PUCHAR param_6,ULONG param_7)

{
  uint uVar1;
  PUCHAR pUVar2;
  NTSTATUS NVar3;
  uint cbInput;
  uint local_res10 [2];
  BCRYPT_KEY_HANDLE pvStack0000000000000040;
  BCRYPT_HANDLE local_38 [2];
  
  uVar1 = param_5;
  local_38[0] = (BCRYPT_HANDLE)0x0;
  pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  cbInput = param_5 & 0xffffffe0;
  local_res10[0] = 0;
  NVar3 = BCryptOpenAlgorithmProvider(local_38,L"AES",(LPCWSTR)0x0,0);
  if ((-1 < NVar3) &&
     (NVar3 = BCryptSetProperty(local_38[0],L"ChainingMode",(PUCHAR)L"ChainingModeCBC",0x20,0),
     -1 < NVar3)) {
    NVar3 = BCryptGenerateSymmetricKey
                      (local_38[0],(BCRYPT_KEY_HANDLE *)&stack0x00000040,(PUCHAR)0x0,0,param_1,0x20,
                       0);
    pUVar2 = param_6;
    if (-1 < NVar3) {
      if (cbInput != 0) {
        NVar3 = BCryptDecrypt(pvStack0000000000000040,param_4,cbInput,(void *)0x0,param_3,0x10,
                              param_6,param_7,local_res10,0);
        if (NVar3 < 0) goto LAB_18000211d;
        if (cbInput != local_res10[0]) {
          NVar3 = -0x3fffffff;
          goto LAB_18000211d;
        }
      }
      NVar3 = 0;
      if (cbInput < uVar1) {
        if (param_4 != pUVar2) {
          FUN_18001d320((undefined8 *)(pUVar2 + cbInput),(undefined8 *)(param_4 + cbInput),
                        (ulonglong)(uVar1 - cbInput));
        }
        local_res10[0] = uVar1;
      }
    }
  }
LAB_18000211d:
  if (pvStack0000000000000040 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack0000000000000040);
    pvStack0000000000000040 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38[0] != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38[0],0);
  }
  return -1 < NVar3;
}



bool FUN_180002170(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  NTSTATUS NVar4;
  PUCHAR pUVar5;
  ulonglong uVar6;
  uint uVar7;
  uint *puVar8;
  ULONG local_48 [2];
  BCRYPT_KEY_HANDLE local_40;
  BCRYPT_HANDLE local_38;
  uint local_30 [6];
  
  uVar7 = 0;
  local_38 = (BCRYPT_HANDLE)0x0;
  local_40 = (BCRYPT_KEY_HANDLE)0x0;
  local_48[0] = 0;
  NVar4 = BCryptOpenAlgorithmProvider(&local_38,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar4) &&
       (NVar4 = BCryptSetProperty(local_38,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar4)) &&
      (NVar4 = BCryptGenerateSymmetricKey(local_38,&local_40,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar4)) && (NVar4 = 0, param_5 != 0)) {
    do {
      if (uVar7 == 0) {
        NVar4 = BCryptEncrypt(local_40,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)local_30,0x10,
                              local_48,0);
        if (NVar4 < 0) break;
        pUVar5 = param_2 + 0xf;
        do {
          *pUVar5 = *pUVar5 + '\x01';
          if (*pUVar5 != '\0') break;
          pUVar5 = pUVar5 + -1;
        } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar6 = SEXT48((int)uVar7), 0xb < uVar6)) {
        if ((param_5 < 2) || (uVar6 = SEXT48((int)uVar7), 0xd < uVar6)) {
          bVar1 = *(byte *)param_3;
          puVar8 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)local_30 + (longlong)(int)uVar7) ^ bVar1;
          uVar7 = uVar7 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar8 = (uint *)((longlong)param_4 + 2);
          uVar2 = *(ushort *)param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar7 = uVar7 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)local_30 + uVar6) ^ uVar2;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar8 = param_4 + 1;
        uVar3 = *param_3;
        param_3 = param_3 + 1;
        uVar7 = uVar7 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)local_30 + uVar6) ^ uVar3;
        param_5 = param_5 - 4;
      }
      param_4 = puVar8;
      NVar4 = 0;
    } while (param_5 != 0);
  }
  if (local_40 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(local_40);
    local_40 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (local_38 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(local_38,0);
  }
  return -1 < NVar4;
}



bool thunk_FUN_180002170(PUCHAR param_1,PUCHAR param_2,uint *param_3,uint *param_4,uint param_5)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  NTSTATUS NVar4;
  PUCHAR pUVar5;
  ulonglong uVar6;
  uint uVar7;
  uint *puVar8;
  ULONG aUStack72 [2];
  BCRYPT_KEY_HANDLE pvStack64;
  BCRYPT_HANDLE pvStack56;
  uint auStack48 [6];
  
  uVar7 = 0;
  pvStack56 = (BCRYPT_HANDLE)0x0;
  pvStack64 = (BCRYPT_KEY_HANDLE)0x0;
  aUStack72[0] = 0;
  NVar4 = BCryptOpenAlgorithmProvider(&pvStack56,L"AES",(LPCWSTR)0x0,0);
  if ((((-1 < NVar4) &&
       (NVar4 = BCryptSetProperty(pvStack56,L"ChainingMode",(PUCHAR)L"ChainingModeECB",0x20,0),
       -1 < NVar4)) &&
      (NVar4 = BCryptGenerateSymmetricKey(pvStack56,&pvStack64,(PUCHAR)0x0,0,param_1,0x10,0),
      -1 < NVar4)) && (NVar4 = 0, param_5 != 0)) {
    do {
      if (uVar7 == 0) {
        NVar4 = BCryptEncrypt(pvStack64,param_2,0x10,(void *)0x0,(PUCHAR)0x0,0,(PUCHAR)auStack48,
                              0x10,aUStack72,0);
        if (NVar4 < 0) break;
        pUVar5 = param_2 + 0xf;
        do {
          *pUVar5 = *pUVar5 + '\x01';
          if (*pUVar5 != '\0') break;
          pUVar5 = pUVar5 + -1;
        } while (0 < (longlong)(pUVar5 + (1 - (longlong)param_2)));
      }
      if ((param_5 < 4) || (uVar6 = SEXT48((int)uVar7), 0xb < uVar6)) {
        if ((param_5 < 2) || (uVar6 = SEXT48((int)uVar7), 0xd < uVar6)) {
          bVar1 = *(byte *)param_3;
          puVar8 = (uint *)((longlong)param_4 + 1);
          param_3 = (uint *)((longlong)param_3 + 1);
          *(byte *)param_4 = *(byte *)((longlong)auStack48 + (longlong)(int)uVar7) ^ bVar1;
          uVar7 = uVar7 + 1 & 0xf;
          param_5 = param_5 - 1;
        }
        else {
          puVar8 = (uint *)((longlong)param_4 + 2);
          uVar2 = *(ushort *)param_3;
          param_3 = (uint *)((longlong)param_3 + 2);
          uVar7 = uVar7 + 2 & 0xf;
          *(ushort *)param_4 = *(ushort *)((longlong)auStack48 + uVar6) ^ uVar2;
          param_5 = param_5 - 2;
        }
      }
      else {
        puVar8 = param_4 + 1;
        uVar3 = *param_3;
        param_3 = param_3 + 1;
        uVar7 = uVar7 + 4 & 0xf;
        *param_4 = *(uint *)((longlong)auStack48 + uVar6) ^ uVar3;
        param_5 = param_5 - 4;
      }
      param_4 = puVar8;
      NVar4 = 0;
    } while (param_5 != 0);
  }
  if (pvStack64 != (BCRYPT_KEY_HANDLE)0x0) {
    BCryptDestroyKey(pvStack64);
    pvStack64 = (BCRYPT_KEY_HANDLE)0x0;
  }
  if (pvStack56 != (BCRYPT_ALG_HANDLE)0x0) {
    BCryptCloseAlgorithmProvider(pvStack56,0);
  }
  return -1 < NVar4;
}



undefined8
FUN_1800023b0(PUCHAR param_1,undefined8 param_2,ulonglong param_3,undefined *param_4,
             undefined8 param_5,undefined8 *param_6)

{
  NTSTATUS NVar1;
  ulonglong **ppuVar2;
  ULONG *pUVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  undefined8 *puVar7;
  ulonglong local_res18;
  BCRYPT_HASH_HANDLE local_res20;
  uint uStack0000000000000038;
  BCRYPT_ALG_HANDLE local_a8;
  ULONG local_a0 [2];
  uint local_98;
  undefined4 local_94;
  ulonglong *local_90 [4];
  undefined8 local_70 [6];
  
  local_90[0] = &local_res18;
  local_90[1] = (ulonglong *)0x1800380a0;
  local_90[2] = &param_5;
  if (param_4 != (undefined *)0x0) {
    local_90[2] = (ulonglong *)param_4;
  }
  uVar6 = 0x20;
  local_90[3] = &param_5;
  local_a0[0] = 4;
  local_98 = 4;
  if (param_4 != (undefined *)0x0) {
    local_98 = uVar6;
  }
  local_a0[1] = 7;
  local_94 = 4;
  param_5._0_4_ = 0x10000;
  uStack0000000000000038 = 1;
  puVar7 = param_6;
  local_res18 = param_3;
  do {
    uVar4 = uStack0000000000000038;
    local_res18 = local_res18 & 0xffffffff00000000 |
                  (ulonglong)
                  (((uint)(ushort)((short)uStack0000000000000038 << 8) |
                   uStack0000000000000038 >> 8 & 0xff) << 0x10 |
                   (uint)(ushort)((short)((ulonglong)(longlong)(int)uStack0000000000000038 >> 0x10)
                                 << 8) |
                  (uint)((ulonglong)(longlong)(int)uStack0000000000000038 >> 0x18) & 0xff);
    NVar1 = BCryptOpenAlgorithmProvider(&local_a8,L"SHA256",(LPCWSTR)0x0,8);
    if (NVar1 < 0) {
      return 0;
    }
    NVar1 = BCryptCreateHash(local_a8,&local_res20,(PUCHAR)0x0,0,param_1,0x20,0);
    if (-1 < NVar1) {
      uVar4 = 0;
      if ((param_4 != (undefined *)0x0) != 0xfffffffd) {
        pUVar3 = local_a0;
        ppuVar2 = local_90;
        do {
          if (((*ppuVar2 != (ulonglong *)0x0) && (*pUVar3 != 0)) &&
             (NVar1 = BCryptHashData(local_res20,(PUCHAR)*ppuVar2,*pUVar3,0), NVar1 < 0))
          goto LAB_18000254b;
          uVar4 = uVar4 + 1;
          ppuVar2 = ppuVar2 + 1;
          pUVar3 = pUVar3 + 1;
        } while (uVar4 < (param_4 != (undefined *)0x0) + 3);
      }
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res20,(PUCHAR)local_70,0x20,0);
      }
LAB_18000254b:
      BCryptDestroyHash(local_res20);
      uVar4 = uStack0000000000000038;
    }
    BCryptCloseAlgorithmProvider(local_a8,0);
    if (NVar1 < 0) {
      return 0;
    }
    uVar5 = 0x20;
    if (uVar6 < 0x20) {
      uVar5 = uVar6;
    }
    FUN_18001d320(puVar7,local_70,(ulonglong)uVar5);
    uStack0000000000000038 = uVar4 + 1;
    puVar7 = (undefined8 *)((longlong)puVar7 + (ulonglong)uVar5);
    uVar6 = uVar6 - uVar5;
    if (uVar6 == 0) {
      return 1;
    }
  } while( true );
}



// WARNING: Could not reconcile some variable overlaps

UINT FUN_1800025c0(void)

{
  char cVar1;
  short sVar2;
  bool bVar3;
  UINT BufferSize;
  UINT UVar4;
  NTSTATUS NVar5;
  HANDLE pvVar6;
  LPVOID pFirmwareTableBuffer;
  short *psVar7;
  short *psVar8;
  LPVOID pvVar9;
  int iVar10;
  short *psVar11;
  uint uVar12;
  undefined8 *puVar14;
  PUCHAR *ppUVar15;
  undefined8 local_res8;
  BCRYPT_HASH_HANDLE local_res10;
  BCRYPT_ALG_HANDLE local_res18;
  undefined local_38 [16];
  LPVOID pvVar13;
  
  pvVar13 = (LPVOID)0x0;
  bVar3 = false;
  local_res8 = 0;
  uVar12 = 0;
  local_38 = ZEXT816(0);
  BufferSize = GetSystemFirmwareTable(0x52534d42,0,(PVOID)0x0,0);
  if (BufferSize == 0) {
    return BufferSize;
  }
  pvVar6 = GetProcessHeap();
  pFirmwareTableBuffer = HeapAlloc(pvVar6,0,(ulonglong)BufferSize);
  pvVar9 = pFirmwareTableBuffer;
  if (pFirmwareTableBuffer == (LPVOID)0x0) goto LAB_180002853;
  UVar4 = GetSystemFirmwareTable(0x52534d42,0,pFirmwareTableBuffer,BufferSize);
  if (BufferSize == UVar4) {
    psVar7 = (short *)((longlong)pFirmwareTableBuffer + 8);
    psVar11 = (short *)((ulonglong)*(uint *)((longlong)pFirmwareTableBuffer + 4) +
                       (longlong)pFirmwareTableBuffer);
    if (psVar7 < psVar11) {
      while (*(char *)psVar7 != '\x01') {
        psVar7 = (short *)((longlong)psVar7 + (ulonglong)*(byte *)((longlong)psVar7 + 1));
        if (psVar11 <= psVar7) goto LAB_180002740;
        sVar2 = *psVar7;
        while (sVar2 != 0) {
          if (psVar11 <= psVar7) goto LAB_180002740;
          psVar7 = (short *)((longlong)psVar7 + 1);
          sVar2 = *psVar7;
        }
        if ((psVar11 <= psVar7) || (psVar7 = psVar7 + 1, psVar11 <= psVar7)) goto LAB_180002740;
      }
      if ((*(longlong *)(psVar7 + 4) != *(longlong *)(psVar7 + 8)) ||
         (*(longlong *)(psVar7 + 4) - 1U < 0xfffffffffffffffe)) {
        bVar3 = true;
        local_38 = CONCAT88(local_38._8_8_,psVar7 + 4);
        local_res8 = CONCAT44(local_res8._4_4_,0x10);
      }
      if ((*(char *)((longlong)psVar7 + 7) != '\0') &&
         (psVar8 = (short *)((longlong)psVar7 + (ulonglong)*(byte *)((longlong)psVar7 + 1)),
         psVar8 < psVar11)) {
        iVar10 = *(byte *)((longlong)psVar7 + 7) - 1;
        if (iVar10 != 0) goto LAB_1800026f0;
        goto LAB_180002714;
      }
    }
  }
  goto LAB_180002740;
  while( true ) {
    psVar8 = (short *)((longlong)psVar8 + 1);
    iVar10 = iVar10 + -1;
    if (iVar10 == 0) break;
LAB_1800026f0:
    cVar1 = *(char *)psVar8;
    while (cVar1 != '\0') {
      if (psVar11 <= psVar8) goto LAB_180002710;
      psVar8 = (short *)((longlong)psVar8 + 1);
      cVar1 = *(char *)psVar8;
    }
    if (psVar11 <= psVar8) {
LAB_180002710:
      if (iVar10 != 0) goto LAB_180002740;
      break;
    }
  }
LAB_180002714:
  local_38 = CONCAT88(psVar8,local_38._0_8_);
  cVar1 = *(char *)psVar8;
  psVar7 = psVar8;
  while (cVar1 != '\0') {
    if (psVar11 <= psVar7) goto LAB_180002740;
    psVar7 = (short *)((longlong)psVar7 + 1);
    cVar1 = *(char *)psVar7;
  }
  if (psVar7 < psVar11) {
    uVar12 = ((int)psVar7 - (int)psVar8) + 1;
    local_res8 = local_res8 & 0xffffffff | (ulonglong)uVar12 << 0x20;
  }
LAB_180002740:
  if ((bVar3) || (pvVar9 = pvVar13, uVar12 != 0)) {
    local_res18 = (BCRYPT_ALG_HANDLE)0x0;
    NVar5 = BCryptOpenAlgorithmProvider(&local_res18,L"SHA256",(LPCWSTR)0x0,0);
    if (-1 < NVar5) {
      NVar5 = BCryptCreateHash(local_res18,&local_res10,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
      if (-1 < NVar5) {
        puVar14 = &local_res8;
        ppUVar15 = (PUCHAR *)local_38;
        do {
          if (((*ppUVar15 != (PUCHAR)0x0) && (*(ULONG *)puVar14 != 0)) &&
             (NVar5 = BCryptHashData(local_res10,*ppUVar15,*(ULONG *)puVar14,0), NVar5 < 0))
          goto LAB_180002818;
          uVar12 = (int)pvVar13 + 1;
          pvVar13 = (LPVOID)(ulonglong)uVar12;
          ppUVar15 = ppUVar15 + 1;
          puVar14 = (undefined8 *)((longlong)puVar14 + 4);
        } while (uVar12 < 2);
        if (-1 < NVar5) {
          NVar5 = BCryptFinishHash(local_res10,&DAT_18004cf98,0x20,0);
        }
LAB_180002818:
        BCryptDestroyHash(local_res10);
      }
      BCryptCloseAlgorithmProvider(local_res18,0);
    }
    pvVar9 = (LPVOID)(ulonglong)(-1 < NVar5);
  }
  pvVar6 = GetProcessHeap();
  HeapFree(pvVar6,0,pFirmwareTableBuffer);
LAB_180002853:
  return (UINT)pvVar9;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined * FUN_180002870(void)

{
  UINT UVar1;
  
  if (DAT_18004cfb8 == '\0') {
    UVar1 = FUN_1800025c0();
    if (UVar1 == 0) {
      _DAT_18004cf98 = 0;
      _DAT_18004cfa0 = 0;
      _DAT_18004cfa8 = 0;
      _DAT_18004cfb0 = 0;
    }
    DAT_18004cfb8 = '\x01';
  }
  return &DAT_18004cf98;
}



int FUN_1800028c0(int *param_1,int *param_2)

{
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  if (param_2 != (int *)0x0) {
    *param_2 = param_1[2];
  }
  return param_1[3];
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_1800028e0(int *param_1,uint *param_2,uint *param_3,uint *param_4,uint *param_5,longlong param_6)

{
  uint *puVar1;
  bool bVar2;
  UINT UVar3;
  NTSTATUS NVar4;
  int iVar5;
  PUCHAR pbSecret;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  int **ppiVar6;
  uint uVar7;
  ULONG *pUVar8;
  uint *puVar9;
  uint uVar10;
  ULONG local_res8;
  uint local_resc;
  uint *local_res10;
  uint *local_res20;
  BCRYPT_HASH_HANDLE local_b8;
  BCRYPT_ALG_HANDLE local_b0;
  longlong local_a8;
  longlong local_a0;
  UCHAR local_98 [16];
  int *local_88;
  longlong local_80;
  uint local_78 [16];
  
  if (*param_1 != 0x5366616b) {
    return 0;
  }
  local_res8 = param_1[1] - 0x10;
  local_80 = param_6;
  local_resc = -(uint)(param_6 != 0) & 0x20;
  local_res10 = param_2;
  local_res20 = param_4;
  local_88 = param_1;
  if (DAT_18004cfb8 == '\0') {
    UVar3 = FUN_1800025c0();
    if (UVar3 == 0) {
      _DAT_18004cf98 = 0;
      _DAT_18004cfa0 = 0;
      _DAT_18004cfa8 = 0;
      _DAT_18004cfb0 = 0;
    }
    DAT_18004cfb8 = '\x01';
  }
  NVar4 = BCryptOpenAlgorithmProvider(&local_b0,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar4) {
    uVar10 = 0;
    NVar4 = BCryptCreateHash(local_b0,&local_b8,(PUCHAR)0x0,0,&DAT_18004cf98,0x20,0);
    if (-1 < NVar4) {
      uVar7 = 0;
      pUVar8 = &local_res8;
      ppiVar6 = &local_88;
      do {
        if (((*ppiVar6 != (int *)0x0) && (*pUVar8 != 0)) &&
           (NVar4 = BCryptHashData(local_b8,(PUCHAR)*ppiVar6,*pUVar8,0), NVar4 < 0))
        goto LAB_180002a43;
        uVar7 = uVar7 + 1;
        ppiVar6 = ppiVar6 + 1;
        pUVar8 = pUVar8 + 1;
      } while (uVar7 < 2);
      if (-1 < NVar4) {
        NVar4 = BCryptFinishHash(local_b8,(PUCHAR)&local_a8,0x20,0);
      }
LAB_180002a43:
      BCryptDestroyHash(local_b8);
      param_2 = local_res10;
      param_4 = local_res20;
    }
    BCryptCloseAlgorithmProvider(local_b0,0);
    puVar1 = param_5;
    if (((((-1 < NVar4) &&
          (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + (longlong)param_1) == local_a8)) &&
         (*(longlong *)((ulonglong)(param_1[1] - 0x10U) + 8 + (longlong)param_1) == local_a0)) &&
        ((param_3 == (uint *)0x0 || ((param_2 != (uint *)0x0 && ((uint)param_1[2] <= *param_3))))))
       && ((param_5 == (uint *)0x0 || ((param_4 != (uint *)0x0 && ((uint)param_1[3] <= *param_5)))))
       ) {
      local_88 = param_1 + 4;
      local_res8 = 0x10;
      pbSecret = FUN_180002870();
      NVar4 = BCryptOpenAlgorithmProvider(&local_b0,L"SHA256",(LPCWSTR)0x0,8);
      if (-1 < NVar4) {
        NVar4 = BCryptCreateHash(local_b0,&local_b8,(PUCHAR)0x0,0,pbSecret,0x20,0);
        if (-1 < NVar4) {
          pUVar8 = &local_res8;
          ppiVar6 = &local_88;
          do {
            if (((*ppiVar6 != (int *)0x0) && (*pUVar8 != 0)) &&
               (NVar4 = BCryptHashData(local_b8,(PUCHAR)*ppiVar6,*pUVar8,0), NVar4 < 0))
            goto LAB_180002b89;
            uVar10 = uVar10 + 1;
            ppiVar6 = ppiVar6 + 1;
            pUVar8 = pUVar8 + 1;
          } while (uVar10 < 2);
          if (-1 < NVar4) {
            NVar4 = BCryptFinishHash(local_b8,(PUCHAR)&local_a8,0x20,0);
          }
LAB_180002b89:
          BCryptDestroyHash(local_b8);
        }
        BCryptCloseAlgorithmProvider(local_b0,0);
        if ((-1 < NVar4) &&
           (bVar2 = FUN_180002170((PUCHAR)&local_a8,local_98,(uint *)(param_1 + 8),local_78,0x10),
           (int)CONCAT71(extraout_var,bVar2) != 0)) {
          uVar10 = param_1[2];
          if (uVar10 != 0) {
            if (local_res10 == (uint *)0x0) {
              do {
                puVar9 = (uint *)((longlong)param_1 +
                                 ((ulonglong)(uint)param_1[2] - (ulonglong)uVar10) + 0x30);
                if (uVar10 < 0x40) {
                  bVar2 = FUN_180002170((PUCHAR)&local_a8,local_98,puVar9,local_78,uVar10);
                  iVar5 = (int)CONCAT71(extraout_var_02,bVar2);
                  goto joined_r0x000180002c63;
                }
                bVar2 = FUN_180002170((PUCHAR)&local_a8,local_98,puVar9,local_78,0x40);
                if ((int)CONCAT71(extraout_var_01,bVar2) == 0) {
                  return 0;
                }
                uVar10 = uVar10 - 0x40;
              } while (uVar10 != 0);
            }
            else {
              bVar2 = FUN_180002170((PUCHAR)&local_a8,local_98,(uint *)(param_1 + 0xc),local_res10,
                                    uVar10);
              iVar5 = (int)CONCAT71(extraout_var_00,bVar2);
joined_r0x000180002c63:
              if (iVar5 == 0) {
                return 0;
              }
            }
          }
          if (param_3 != (uint *)0x0) {
            *param_3 = param_1[2];
          }
          if (((param_1[3] == 0) || (local_res20 == (uint *)0x0)) ||
             (bVar2 = FUN_180002170((PUCHAR)&local_a8,local_98,
                                    (uint *)((longlong)param_1 + (ulonglong)(uint)param_1[2] + 0x30)
                                    ,local_res20,param_1[3]),
             (int)CONCAT71(extraout_var_03,bVar2) != 0)) {
            if (puVar1 != (uint *)0x0) {
              *puVar1 = param_1[3];
            }
            return 1;
          }
        }
      }
    }
  }
  return 0;
}



undefined8 FUN_180002cc0(PUCHAR param_1,PUCHAR param_2)

{
  NTSTATUS NVar1;
  int iVar2;
  ULONG *pUVar3;
  PUCHAR *ppUVar4;
  ULONG local_res8 [4];
  BCRYPT_HASH_HANDLE local_res18;
  BCRYPT_ALG_HANDLE local_res20;
  PUCHAR local_38 [2];
  
  local_res8[0] = 0x20;
  local_38[0] = param_1;
  NVar1 = BCryptOpenAlgorithmProvider(&local_res20,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    iVar2 = 0;
    NVar1 = BCryptCreateHash(local_res20,&local_res18,(PUCHAR)0x0,0,"Mzg0",0x13,0);
    if (-1 < NVar1) {
      ppUVar4 = local_38;
      pUVar3 = local_res8;
      do {
        if ((*ppUVar4 != (PUCHAR)0x0) && (*pUVar3 != 0)) {
          NVar1 = BCryptHashData(local_res18,*ppUVar4,*pUVar3,0);
          if (NVar1 < 0) goto LAB_180002db4;
        }
        iVar2 = iVar2 + 1;
        ppUVar4 = ppUVar4 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar2 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_res18,param_2,0x20,0);
      }
LAB_180002db4:
      BCryptDestroyHash(local_res18);
    }
    BCryptCloseAlgorithmProvider(local_res20,0);
    if (-1 < NVar1) {
      return 0;
    }
  }
  return 1;
}



void FUN_180002e00(PUCHAR param_1,uint *param_2,int param_3,undefined4 *param_4,longlong param_5)

{
  bool bVar1;
  NTSTATUS NVar2;
  uint *_Memory;
  undefined7 extraout_var;
  undefined8 uVar3;
  int iVar4;
  ULONG *pUVar5;
  PUCHAR *ppUVar6;
  ULONG local_f8 [2];
  BCRYPT_HASH_HANDLE local_f0;
  BCRYPT_ALG_HANDLE local_e8;
  PUCHAR local_e0;
  longlong local_d8;
  uint *local_d0;
  UCHAR local_c8 [16];
  UCHAR local_b8 [16];
  uint local_a8 [8];
  undefined local_88 [32];
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffec8;
  local_d8 = param_5;
  local_d0 = param_2;
  if ((param_3 == 0xa0) && (_Memory = (uint *)malloc(0xa0), _Memory != (uint *)0x0)) {
    local_f8[0] = 0x20;
    local_e0 = param_1;
    NVar2 = BCryptOpenAlgorithmProvider(&local_e8,L"SHA256",(LPCWSTR)0x0,8);
    if (-1 < NVar2) {
      iVar4 = 0;
      NVar2 = BCryptCreateHash(local_e8,&local_f0,(PUCHAR)0x0,0,"MTI4",0x1a,0);
      if (-1 < NVar2) {
        pUVar5 = local_f8;
        ppUVar6 = &local_e0;
        do {
          if (((*ppUVar6 != (PUCHAR)0x0) && (*pUVar5 != 0)) &&
             (NVar2 = BCryptHashData(local_f0,*ppUVar6,*pUVar5,0), NVar2 < 0)) goto LAB_180002f3b;
          iVar4 = iVar4 + 1;
          ppUVar6 = ppUVar6 + 1;
          pUVar5 = pUVar5 + 1;
        } while (iVar4 == 0);
        if (-1 < NVar2) {
          NVar2 = BCryptFinishHash(local_f0,local_c8,0x20,0);
        }
LAB_180002f3b:
        BCryptDestroyHash(local_f0);
        param_5 = local_d8;
        param_2 = local_d0;
      }
      BCryptCloseAlgorithmProvider(local_e8,0);
      if ((-1 < NVar2) &&
         (bVar1 = FUN_180002170(local_b8,local_c8,param_2,_Memory,0xa0),
         (int)CONCAT71(extraout_var,bVar1) != 0)) {
        local_f8[0] = 0x60;
        uVar3 = FUN_1800028e0((int *)_Memory,(uint *)0x0,(uint *)0x0,local_a8,local_f8,param_5);
        if ((((int)uVar3 != 0) &&
            ((local_f8[0] == 0x60 &&
             (uVar3 = FUN_180002cc0(param_1,(PUCHAR)local_a8), (int)uVar3 == 0)))) &&
           (iVar4 = memcmp(local_a8,local_88,0x20), iVar4 == 0)) {
          *param_4 = local_68;
          param_4[1] = uStack100;
          param_4[2] = uStack96;
          param_4[3] = uStack92;
          param_4[4] = local_58;
          param_4[5] = uStack84;
          param_4[6] = uStack80;
          param_4[7] = uStack76;
        }
      }
    }
    free(_Memory);
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xfffffffffffffec8);
  return;
}



// WARNING: Removing unreachable block (ram,0x000180003152)

void FUN_180003040(PUCHAR param_1,uint param_2,undefined4 *param_3,undefined4 *param_4,
                  undefined4 *param_5)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  bool bVar4;
  NTSTATUS NVar5;
  undefined7 extraout_var;
  undefined4 *puVar6;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 uStack284;
  undefined4 uStack280;
  undefined4 uStack276;
  undefined4 local_110;
  undefined4 uStack268;
  undefined4 uStack264;
  undefined4 uStack260;
  undefined4 local_100;
  undefined4 uStack252;
  undefined4 uStack248;
  undefined4 uStack244;
  undefined4 local_f0;
  undefined4 uStack236;
  undefined4 uStack232;
  undefined4 uStack228;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_80;
  undefined4 uStack124;
  undefined4 uStack120;
  undefined4 uStack116;
  uint local_68;
  uint uStack100;
  uint uStack96;
  uint uStack92;
  uint local_58;
  uint uStack84;
  uint uStack80;
  uint uStack76;
  uint local_48;
  uint uStack68;
  uint uStack64;
  uint uStack60;
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffe98;
  FUN_18001d980((undefined (*) [16])&local_d8,0,0x68);
  local_90 = *param_3;
  uStack140 = param_3[1];
  uStack136 = param_3[2];
  uStack132 = param_3[3];
  local_80 = param_3[4];
  uStack124 = param_3[5];
  uStack120 = param_3[6];
  uStack116 = param_3[7];
  puVar6 = &local_128;
  local_120 = *param_4;
  uStack284 = param_4[1];
  uStack280 = param_4[2];
  uStack276 = param_4[3];
  local_d8 = 0x324b4345;
  local_d4 = 0x20;
  local_128 = 0x314b4345;
  local_124 = 0x20;
  local_110 = param_4[4];
  uStack268 = param_4[5];
  uStack264 = param_4[6];
  uStack260 = param_4[7];
  local_100 = param_4[8];
  uStack252 = param_4[9];
  uStack248 = param_4[10];
  uStack244 = param_4[0xb];
  local_f0 = param_4[0xc];
  uStack236 = param_4[0xd];
  uStack232 = param_4[0xe];
  uStack228 = param_4[0xf];
  NVar5 = FUN_1800015d0((PUCHAR)&local_d8,(PUCHAR)puVar6,"SecureShare",0xb,(PUCHAR)&local_68,0x20);
  if (-1 < NVar5) {
    local_48 = local_58 ^ local_68;
    uStack68 = uStack84 ^ uStack100;
    uStack64 = uStack80 ^ uStack96;
    uStack60 = uStack76 ^ uStack92;
    bVar4 = FUN_180001fd0((PUCHAR)&local_68,puVar6,(PUCHAR)&local_48,param_1,param_2,param_1,param_2
                         );
    if ((int)CONCAT71(extraout_var,bVar4) != 0) {
      uVar1 = *(undefined4 *)(param_1 + 0x24);
      uVar2 = *(undefined4 *)(param_1 + 0x28);
      uVar3 = *(undefined4 *)(param_1 + 0x2c);
      *param_5 = *(undefined4 *)(param_1 + 0x20);
      param_5[1] = uVar1;
      param_5[2] = uVar2;
      param_5[3] = uVar3;
      if (((((*(int *)(param_1 + 0x30) + 0xcebeacaeU & 0xfdffffff) == 0) &&
           (*(char *)param_5 == 'R')) && (*(char *)((longlong)param_5 + 2) == 'P')) &&
         (((*(uint *)(param_1 + 0x34) ==
            (uint)(*(byte *)((longlong)param_5 + 1) >> 4) <<
            (*(byte *)((longlong)param_5 + 1) & 0xf) && (*(char *)((longlong)param_5 + 3) == 'B'))
          && (0x50f < (*(uint *)(param_1 + 0x34) & 0xfffffff8))))) {
        FUN_180001ab0(*(uint *)(param_1 + 0x3c),*(uint *)(param_1 + 0x38),
                      (undefined8 *)(param_1 + 0x48),
                      (undefined8 *)
                      ((longlong)(param_1 + 0x48) + (ulonglong)*(uint *)(param_1 + 0x38)),
                      (undefined8 *)(param_5 + 6),param_5 + 4);
      }
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffe98);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180003250(uint **param_1,int *param_2,ulonglong param_3,undefined4 *param_4)

{
  PUCHAR pUVar1;
  uint *puVar2;
  UINT UVar3;
  int iVar4;
  undefined8 uVar5;
  int *piVar6;
  undefined8 in_stack_ffffffffffffff38;
  uint local_a8;
  uint uStack164;
  uint uStack160;
  uint uStack156;
  uint local_98;
  uint uStack148;
  uint uStack144;
  uint uStack140;
  uint local_88;
  uint uStack132;
  uint uStack128;
  uint uStack124;
  uint local_78;
  uint uStack116;
  uint uStack112;
  uint uStack108;
  undefined4 local_68 [8];
  undefined8 local_48 [4];
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff18;
  if (2 < (uint)param_3) {
    pUVar1 = *(PUCHAR *)(param_4 + 8);
    piVar6 = param_2;
    if (DAT_18004cfb8 == '\0') {
      UVar3 = FUN_1800025c0();
      if (UVar3 == 0) {
        _DAT_18004cf98 = 0;
        _DAT_18004cfa0 = 0;
        _DAT_18004cfa8 = 0;
        _DAT_18004cfb0 = 0;
      }
      DAT_18004cfb8 = '\x01';
    }
    uVar5 = FUN_1800023b0(pUVar1,piVar6,param_3,&DAT_18004cf98,in_stack_ffffffffffffff38,local_48);
    if ((((int)uVar5 != 0) &&
        (iVar4 = FUN_180002e00((PUCHAR)local_48,*param_1,*param_2,local_68,
                               *(longlong *)(param_4 + 8)), iVar4 == 0)) && (param_2[1] == 0x40)) {
      puVar2 = param_1[1];
      local_a8 = *puVar2;
      uStack164 = puVar2[1];
      uStack160 = puVar2[2];
      uStack156 = puVar2[3];
      local_98 = puVar2[4];
      uStack148 = puVar2[5];
      uStack144 = puVar2[6];
      uStack140 = puVar2[7];
      local_88 = puVar2[8];
      uStack132 = puVar2[9];
      uStack128 = puVar2[10];
      uStack124 = puVar2[0xb];
      local_78 = puVar2[0xc];
      uStack116 = puVar2[0xd];
      uStack112 = puVar2[0xe];
      uStack108 = puVar2[0xf];
      FUN_180003040((PUCHAR)param_1[2],param_2[2],local_68,&local_a8,param_4);
    }
  }
  FUN_18001d2f0(local_28 ^ (ulonglong)&stack0xffffffffffffff18);
  return;
}



void FUN_1800033a0(undefined8 param_1,uint param_2)

{
  undefined8 in_R8;
  undefined in_R9B;
  undefined in_stack_ffffffffffffffd8;
  undefined in_stack_ffffffffffffffe0;
  
  FUN_180003b30(param_1,(uint *)param_1,param_2,in_R9B,in_stack_ffffffffffffffd8,
                in_stack_ffffffffffffffe0,in_R8);
  return;
}



void FUN_1800033c0(uint *param_1,uint param_2)

{
  NTSTATUS NVar1;
  PUCHAR *ppUVar2;
  ULONG *pUVar3;
  int iVar4;
  ULONG local_78 [2];
  BCRYPT_HASH_HANDLE local_70;
  BCRYPT_ALG_HANDLE local_68;
  PUCHAR local_60;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff48;
  local_60 = &DAT_1800434c8;
  local_78[0] = 0x20;
  NVar1 = BCryptOpenAlgorithmProvider(&local_68,L"SHA256",(LPCWSTR)0x0,8);
  if (-1 < NVar1) {
    NVar1 = BCryptCreateHash(local_68,&local_70,(PUCHAR)0x0,0,"QWNj",0x15,0);
    if (-1 < NVar1) {
      iVar4 = 0;
      pUVar3 = local_78;
      ppUVar2 = &local_60;
      do {
        if (((*ppUVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
           (NVar1 = BCryptHashData(local_70,*ppUVar2,*pUVar3,0), NVar1 < 0)) goto LAB_1800034d5;
        iVar4 = iVar4 + 1;
        ppUVar2 = ppUVar2 + 1;
        pUVar3 = pUVar3 + 1;
      } while (iVar4 == 0);
      if (-1 < NVar1) {
        NVar1 = BCryptFinishHash(local_70,local_58,0x20,0);
      }
LAB_1800034d5:
      BCryptDestroyHash(local_70);
    }
    BCryptCloseAlgorithmProvider(local_68,0);
    if (-1 < NVar1) {
      FUN_180002170(local_48,local_58,param_1,param_1,param_2);
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff48);
  return;
}



void FUN_180003560(PUCHAR param_1,uint param_2,void *param_3,int param_4,longlong param_5)

{
  NTSTATUS NVar1;
  PUCHAR *ppUVar2;
  ULONG *pUVar3;
  int iVar4;
  undefined8 uVar5;
  undefined8 in_stack_fffffffffffffef8;
  uint local_e8 [2];
  int local_e0 [2];
  BCRYPT_HASH_HANDLE local_d8;
  PUCHAR local_d0;
  ULONG local_c8 [2];
  BCRYPT_ALG_HANDLE local_c0;
  undefined8 local_b8;
  undefined8 local_b0;
  undefined8 uStack168;
  undefined8 local_a0;
  undefined8 uStack152;
  undefined8 local_90;
  undefined8 uStack136;
  undefined8 local_80;
  undefined8 uStack120;
  UCHAR local_68 [32];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffed8;
  iVar4 = 0;
  local_e0[0] = 0;
  local_e8[0] = param_2;
  if (param_4 == 0x60) {
    if (*(PUCHAR *)(param_5 + 0x28) == (PUCHAR)0x0) {
      uVar5 = 0x20;
      iVar4 = memcmp(param_3,&DAT_180043530,0x20);
      if (iVar4 == 0) {
        local_b0 = 0x6450e3f7e5af32e;
        uStack168 = 0xab12166ef3d1097d;
        local_a0 = 0xef5f7480a5682828;
        uStack152 = 0xc861b7094b1d13af;
        local_90 = 0xe203d1e68295d926;
        uStack136 = 0x207022928f017fe6;
        local_80 = 0x13c294b29e9829e7;
        uStack120 = 0x127d49e52ad9c944;
        local_b8 = 0x2031534345;
        local_e8[0] = param_2;
        local_d0 = param_1;
        FUN_1800014b0(&local_d0,local_e8,uVar5,(int *)&local_b8,in_stack_fffffffffffffef8,
                      (PUCHAR)((longlong)param_3 + 0x20));
      }
    }
    else {
      local_c8[0] = 0x40;
      local_c0 = (BCRYPT_ALG_HANDLE)0x0;
      local_d0 = *(PUCHAR *)(param_5 + 0x28);
      NVar1 = BCryptOpenAlgorithmProvider(&local_c0,L"SHA256",(LPCWSTR)0x0,0);
      if (-1 < NVar1) {
        NVar1 = BCryptCreateHash(local_c0,&local_d8,(PUCHAR)0x0,0,(PUCHAR)0x0,0,0);
        if (-1 < NVar1) {
          ppUVar2 = &local_d0;
          pUVar3 = local_c8;
          do {
            if (((*ppUVar2 != (PUCHAR)0x0) && (*pUVar3 != 0)) &&
               (NVar1 = BCryptHashData(local_d8,*ppUVar2,*pUVar3,0), NVar1 < 0)) goto LAB_180003682;
            iVar4 = iVar4 + 1;
            ppUVar2 = ppUVar2 + 1;
            pUVar3 = pUVar3 + 1;
          } while (iVar4 == 0);
          if (-1 < NVar1) {
            NVar1 = BCryptFinishHash(local_d8,local_68,0x20,0);
          }
LAB_180003682:
          BCryptDestroyHash(local_d8);
          param_2 = local_e8[0];
        }
        BCryptCloseAlgorithmProvider(local_c0,0);
        if ((-1 < NVar1) && (iVar4 = memcmp(param_3,local_68,0x20), iVar4 == 0)) {
          FUN_180001820(*(undefined8 **)(param_5 + 0x28),param_1,(ulonglong)param_2,
                        (PUCHAR)((longlong)param_3 + 0x20),local_e0);
        }
      }
    }
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xfffffffffffffed8);
  return;
}



BOOL InitializeCriticalSectionEx(LPCRITICAL_SECTION lpCriticalSection,DWORD dwSpinCount,DWORD Flags)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x0001800037f0. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = InitializeCriticalSectionEx(lpCriticalSection,dwSpinCount,Flags);
  return BVar1;
}



void FUN_180003800(undefined **param_1,undefined8 param_2,undefined8 param_3,undefined8 *param_4,
                  int *param_5)

{
  undefined8 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  code **ppcVar6;
  int iVar7;
  NTSTATUS NVar8;
  undefined8 *_Memory;
  int iVar9;
  longlong lVar10;
  PUCHAR pUVar11;
  uint uVar12;
  uint local_88;
  BCRYPT_ALG_HANDLE local_80;
  int local_78;
  undefined8 local_70;
  code **local_68;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 uStack84;
  undefined4 uStack80;
  undefined4 uStack76;
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff38;
  iVar9 = 0;
  uVar12 = param_5[1] + *param_5;
  local_70 = param_2;
  local_68 = (code **)param_1;
  iVar7 = (*(code *)*param_1)(param_1[3],0,0x50,0);
  if (iVar7 != 0) {
    lVar10 = (longlong)(int)local_88;
    local_78 = local_88 + 0x40 + uVar12;
    _Memory = (undefined8 *)malloc((longlong)local_78);
    if (_Memory != (undefined8 *)0x0) {
      puVar1 = _Memory + 8;
      pUVar11 = (PUCHAR)(lVar10 + (longlong)puVar1);
      NVar8 = BCryptOpenAlgorithmProvider(&local_80,L"RNG",(LPCWSTR)0x0,0);
      if (-1 < NVar8) {
        BCryptGenRandom(local_80,(PUCHAR)puVar1,0x50,0);
        BCryptCloseAlgorithmProvider(local_80,0);
      }
      *(undefined4 *)(_Memory + 4) = 0x80000003;
      *(undefined4 *)((longlong)_Memory + 0x24) = 0;
      *(int *)(_Memory + 5) = (int)puVar1 - (int)_Memory;
      *(uint *)((longlong)_Memory + 0x2c) = local_88;
      if (0 < (int)uVar12) {
        do {
          FUN_18001d320((undefined8 *)(pUVar11 + iVar9),(undefined8 *)*param_4,(longlong)*param_5);
          iVar9 = iVar9 + *param_5;
          param_4 = param_4 + 1;
          param_5 = param_5 + 1;
        } while (iVar9 < (int)uVar12);
      }
      _Memory[6] = 0x7d3;
      *(uint *)((longlong)_Memory + 0x3c) = uVar12;
      puVar1 = _Memory + 8;
      *(int *)(_Memory + 7) = (int)pUVar11 - (int)_Memory;
      local_58 = *(undefined4 *)(_Memory + 0x10);
      uStack84 = *(undefined4 *)((longlong)_Memory + 0x84);
      uStack80 = *(undefined4 *)(_Memory + 0x11);
      uStack76 = *(undefined4 *)((longlong)_Memory + 0x8c);
      FUN_180001e20((PUCHAR)puVar1,0x40,(PUCHAR)&local_58,pUVar11,uVar12,pUVar11,uVar12,(ULONG *)0x0
                   );
      ppcVar6 = local_68;
      iVar7 = (**local_68)(local_68[3],puVar1,0x50,puVar1);
      if (iVar7 != 0) {
        local_68 = (code **)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180001e20(&DAT_180038130,0x20,(PUCHAR)&local_68,(PUCHAR)puVar1,local_88,(PUCHAR)puVar1,
                      local_88,(ULONG *)&local_80);
        *_Memory = 0x4545464c;
        GetSystemTimeAsFileTime((LPFILETIME)(_Memory + 1));
        puVar2 = (undefined4 *)ppcVar6[2];
        uVar3 = puVar2[1];
        uVar4 = puVar2[2];
        uVar5 = puVar2[3];
        *(undefined4 *)(_Memory + 2) = *puVar2;
        *(undefined4 *)((longlong)_Memory + 0x14) = uVar3;
        *(undefined4 *)(_Memory + 3) = uVar4;
        *(undefined4 *)((longlong)_Memory + 0x1c) = uVar5;
        local_68 = (code **)0xeeccaa8866442200;
        local_60 = 0x99bbddff;
        local_5c = 0x11335577;
        FUN_180001e20(&DAT_180038120,0x10,(PUCHAR)&local_68,(PUCHAR)(_Memory + 4),0x20,
                      (PUCHAR)(_Memory + 4),0x20,(ULONG *)&local_80);
        (*ppcVar6[1])(ppcVar6[3],local_70,_Memory,local_78);
      }
      free(_Memory);
    }
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xffffffffffffff38);
  return;
}



void FUN_180003ab0(undefined **param_1,undefined8 param_2,undefined8 param_3,int param_4,int param_5
                  )

{
  int local_38;
  int local_34;
  undefined4 *local_30;
  undefined8 local_28;
  undefined4 local_20;
  undefined2 local_1c;
  undefined2 local_1a;
  undefined4 local_18;
  ulonglong local_10;
  
  local_10 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff98;
  local_20 = 0xc;
  local_1c = (undefined2)param_4;
  local_38 = 0xc;
  local_1a = (undefined2)param_5;
  local_30 = &local_20;
  local_34 = param_4 * param_5;
  local_18 = 0x80001;
  local_28 = param_3;
  FUN_180003800(param_1,param_2,param_3,&local_30,&local_38);
  FUN_18001d2f0(local_10 ^ (ulonglong)&stack0xffffffffffffff98);
  return;
}



void FUN_180003b30(undefined8 param_1,uint *param_2,uint param_3,undefined param_4,undefined param_5
                  ,undefined param_6,undefined4 *param_7)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint **ppuVar9;
  uint *puVar10;
  int local_78 [8];
  uint *local_58 [8];
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff58;
  if ((((0xf < param_3) && (*param_2 <= param_3)) && (param_2[1] == 2)) &&
     ((param_2[2] == 1 && (iVar4 = FUN_1800033c0(param_2 + 3,*param_2 - 0xc), iVar4 == 0)))) {
    uVar1 = param_2[3];
    uVar2 = *param_2;
    uVar6 = 0;
    if (((ulonglong)uVar1 * 4 + 0x10 <= (ulonglong)uVar2) && (uVar1 < 9)) {
      puVar10 = param_2 + (ulonglong)uVar1 + 4;
      if (uVar1 != 0) {
        puVar5 = param_2 + 4;
        ppuVar9 = local_58;
        uVar8 = 0;
        do {
          uVar7 = uVar8;
          uVar3 = *puVar5;
          uVar6 = uVar6 + uVar3;
          if (uVar2 - 4 < uVar6) goto LAB_180003c6f;
          *ppuVar9 = puVar10;
          uVar8 = uVar7 + 1;
          *(uint *)((longlong)register0x00000020 + (-0x88 - (longlong)param_2) + (longlong)puVar5) =
               uVar3;
          puVar10 = (uint *)((longlong)puVar10 + (ulonglong)uVar3);
          ppuVar9 = ppuVar9 + 1;
          puVar5 = puVar5 + 1;
        } while (uVar8 < uVar1);
        if ((1 < uVar8) &&
           (iVar4 = FUN_180003560((PUCHAR)local_58[0],uVar6 - local_78[uVar7],local_58[uVar7],
                                  local_78[uVar7],(longlong)param_7), iVar4 == 0)) {
          FUN_180003250(local_58 + 1,local_78 + 1,(ulonglong)(uVar7 - 1),param_7);
        }
      }
    }
  }
LAB_180003c6f:
  FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xffffffffffffff58);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8
FUN_180003c90(undefined4 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  char *pcVar1;
  int iVar2;
  
  iVar2 = (int)param_3;
  if (iVar2 == 5) {
    _DAT_18004a77c = 0x67;
    _DAT_18004a778 = 0x34;
    DAT_18004a734 = 0xb0;
    DAT_18004a774 = 0x58;
  }
  else {
    if (iVar2 == 7) {
      _DAT_18004a77c = 0x46;
      _DAT_18004a778 = 0x39;
      DAT_18004a734 = 0x80;
      DAT_18004a774 = 0x68;
    }
    else {
      if (iVar2 == 9) {
        _DAT_18004a77c = 0x89;
        _DAT_18004a778 = 0x28;
        DAT_18004a734 = 0xf0;
        DAT_18004a774 = 0x46;
      }
      else {
        if (iVar2 == 0x13) {
          _DAT_18004a77c = 0x39;
          _DAT_18004a778 = 0x2e;
          DAT_18004a734 = 0x6b;
          DAT_18004a774 = 0x56;
        }
        else {
          if (iVar2 == 0x15) {
            _DAT_18004a77c = 0x78;
            _DAT_18004a778 = 0x1c;
            DAT_18004a734 = 0xd2;
            DAT_18004a774 = 0x31;
          }
        }
      }
    }
  }
  FUN_180004440(2,"990701==>non-neon",param_3,param_4);
  if (DAT_18004ad5c == 0x7fffffff) {
    if (DAT_18004cfd0 == 0) {
      DAT_18004cfd0 = FUN_18000df70();
    }
    DAT_18004ad5c = 7000;
    FUN_180004440(3,"990601==>",param_3,param_4);
    DAT_18004e1fc = iVar2;
    FUN_180012b50(iVar2);
    pcVar1 = "9906FF==>";
    FUN_180004440(3,"9906FF==>",param_3,param_4);
    FUN_180004750(param_1,pcVar1,param_3,param_4);
    FUN_180004440(3,"9907FF==>%d %d %d %d",(ulonglong)DAT_18004e1f6,(ulonglong)DAT_18004e1f4);
    return 0;
  }
  return 0xfffffc02;
}



void thunk_FUN_180004d50(undefined8 *param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180004440(3,"990801==>",param_3,param_4);
  if (DAT_18004cfd0 != (void *)0x0) {
    free(DAT_18004cfd0);
    DAT_18004cfd0 = (void *)0x0;
  }
  DAT_18004ad5c = 0x7fffffff;
  FUN_1800045c0(param_1,param_2,param_3,param_4);
  FUN_180004440(3,"9908FF==>%d %d %d %d",(ulonglong)DAT_18004e1f6,(ulonglong)DAT_18004e1f4);
  return;
}



undefined2 *
thunk_FUN_180004df0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  longlong lVar2;
  undefined2 *puVar3;
  void *pvVar4;
  void *pvVar5;
  void *pvVar6;
  
  FUN_180004440(3,"990901==>",param_3,param_4);
  lVar2 = DAT_18004cfd0;
  DAT_18004cfc8 = 0;
  if (DAT_18004ad5c != 7000) {
    DAT_18004cfc8 = 0;
    return (undefined2 *)0x0;
  }
  *(undefined4 *)(DAT_18004cfd0 + 0x70) = 100;
  puVar3 = (undefined2 *)malloc(0x40);
  if (puVar3 != (undefined2 *)0x0) {
    pvVar4 = calloc(1,0x20);
    if (pvVar4 == (void *)0x0) {
      FUN_180004440(1,"990903==>Fail",param_3,param_4);
      puVar3 = (undefined2 *)0x0;
    }
    else {
      pvVar5 = calloc(1,0x3c);
      if (pvVar5 == (void *)0x0) {
        FUN_180004440(1,"990904==>Fail",param_3,param_4);
        puVar3 = (undefined2 *)0x0;
      }
      else {
        *puVar3 = 0x4452;
        uVar1 = *(undefined4 *)(lVar2 + 0x70);
        *(undefined8 *)(puVar3 + 4) = 0;
        *(undefined4 *)(puVar3 + 8) = 0;
        *(undefined4 *)(puVar3 + 0x10) = 100;
        *(undefined4 *)(puVar3 + 2) = uVar1;
        pvVar6 = FUN_18000ba50();
        *(void **)(puVar3 + 0x1c) = pvVar5;
        *(void **)(puVar3 + 0x18) = pvVar4;
        *(void **)(puVar3 + 0xc) = pvVar6;
        *(undefined4 *)(puVar3 + 0x12) = 0xd;
        *(undefined4 *)(puVar3 + 0x14) = 0x9c;
        DAT_18004e1e0 = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x18) = 0xffffffff;
        **(undefined **)(puVar3 + 0x1c) = 1;
        DAT_18004ad5c = 0x1b59;
        *(undefined *)(*(longlong *)(puVar3 + 0x1c) + 1) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x1c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x20) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x24) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x28) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x2c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x30) = 0;
        FUN_180004440(3,"9909FF==>",param_3,param_4);
      }
    }
    return puVar3;
  }
  FUN_180004440(1,"990902==>Fail",param_3,param_4);
  return (undefined2 *)0x0;
}



undefined8
thunk_FUN_180004fa0(char *param_1,undefined4 param_2,ulonglong param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined uVar2;
  ulonglong uVar4;
  uint uVar3;
  
  uVar4 = param_3 & 0xffffffff;
  FUN_180004440(3,"991001==>",param_3,param_4);
  lVar1 = DAT_18004cfd0;
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c == 0x1b59) {
    if ((*param_1 != 'R') || (param_1[1] != 'D')) {
      return 0xfffffc0e;
    }
    uVar2 = (undefined)uVar4;
    uVar3 = (uint)uVar4;
    switch(param_2) {
    case 0x4b0:
      *(uint *)(param_1 + 0xc) = uVar3;
      if (uVar3 == 2) {
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        uVar3 = DAT_18004e1fc;
        *(undefined4 *)(lVar1 + 0x8c) = 1;
        if ((uVar3 < 0x14) && ((0x84180U >> (uVar3 & 0x1f) & 1) != 0)) {
          *(undefined4 *)(lVar1 + 100) = 1;
          *(undefined4 *)(lVar1 + 0x70) = 0x1e;
          *(undefined4 *)(param_1 + 4) = 0x1e;
          *(undefined4 *)(param_1 + 0x24) = 0x12;
          *(undefined4 *)(param_1 + 0x28) = 0x9c;
        }
        else {
          if (uVar3 == 0x12) {
            *(undefined4 *)(lVar1 + 0x70) = 0xd;
            *(undefined4 *)(param_1 + 4) = 0xd;
            *(undefined4 *)(param_1 + 0x24) = 8;
            *(undefined4 *)(param_1 + 0x28) = 200;
          }
          else {
            if ((uVar3 == 9) || (uVar3 == 0x15)) {
              *(undefined4 *)(lVar1 + 0x70) = 0xf;
              *(undefined4 *)(param_1 + 4) = 0xf;
              *(undefined4 *)(param_1 + 0x24) = 0x11;
              *(undefined4 *)(param_1 + 0x28) = 0x9c;
            }
            else {
              *(undefined4 *)(lVar1 + 0x70) = 0xc;
              *(undefined4 *)(param_1 + 4) = 0xc;
              *(undefined4 *)(param_1 + 0x24) = 0xd;
              *(undefined4 *)(param_1 + 0x28) = 0x9c;
            }
          }
        }
      }
      else {
        if (uVar3 == 3) {
          *(undefined4 *)(lVar1 + 0x8c) = 2;
          *(undefined4 *)(lVar1 + 0x90) = 1;
          *(undefined4 *)(lVar1 + 0x6c) = 0;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 1;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 1;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 5;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
        }
        else {
          if (uVar3 == 4) {
            *(undefined4 *)(lVar1 + 0x8c) = 2;
            *(undefined4 *)(lVar1 + 0x90) = 1;
            *(undefined4 *)(lVar1 + 0x6c) = 0;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 0;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 0;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 100;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
          }
          else {
            *(undefined8 *)(lVar1 + 0x8c) = 0;
          }
        }
      }
      break;
    default:
      return 0xfffff89f;
    case 0x4bc:
    case 0x4bd:
    case 0x4bf:
      *(uint *)(DAT_18004cfd0 + 0x70) = uVar3;
      *(uint *)(param_1 + 4) = uVar3;
      break;
    case 0x4be:
      if (*(int *)(param_1 + 0xc) - 2U < 3) {
        return 0xfffff89f;
      }
      *(uint *)(DAT_18004cfd0 + 0x6c) = uVar3;
      break;
    case 0x4cd:
      *(uint *)(param_1 + 0x20) = uVar3;
      break;
    case 0x4ce:
      *(uint *)(DAT_18004cfd0 + 0x74) = uVar3;
      break;
    case 0x4cf:
      *(uint *)(DAT_18004cfd0 + 0x7c) = uVar3;
      break;
    case 0x4d0:
      *(uint *)(DAT_18004cfd0 + 0x80) = uVar3;
      break;
    case 0x4d1:
      DAT_18004e1e0 = uVar2;
      break;
    case 0x4d2:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      FUN_180004440(3,"991002==>%d",uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else {
        if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
          return 0xfffff89f;
        }
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      param_3 = uVar4;
      break;
    case 0x4d3:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      FUN_180004440(3,"991003==>%d",uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else {
        if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
          return 0xfffff89f;
        }
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      param_3 = uVar4;
      break;
    case 0x4d4:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x14) = uVar3;
      FUN_180004440(3,"991004==>%d",uVar4,param_4);
      param_3 = uVar4;
      break;
    case 0x4d5:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x18) = uVar3;
      FUN_180004440(3,"991005==>%d",uVar4,param_4);
      param_3 = uVar4;
      break;
    case 0x4d6:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 4) = uVar3;
      FUN_180004440(3,"991006==>%d",uVar4,param_4);
      param_3 = uVar4;
      break;
    case 0x4d7:
      **(undefined **)(param_1 + 0x30) = uVar2;
      break;
    case 0x4d8:
      *(undefined *)(*(longlong *)(param_1 + 0x30) + 1) = uVar2;
      break;
    case 0x4d9:
      *(undefined *)(*(longlong *)(param_1 + 0x30) + 2) = uVar2;
      break;
    case 0x4da:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x1c) = uVar3;
    }
    FUN_180004440(3,"9910FF==>",param_3,param_4);
    return 0;
  }
  return 0xfffffc02;
}



undefined4
thunk_FUN_1800055a0(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5)

{
  uint *puVar1;
  uint uVar2;
  longlong *_Memory;
  undefined8 uVar3;
  int *piVar4;
  int *piVar5;
  char *pcVar6;
  ulonglong uVar7;
  int iVar8;
  longlong lVar9;
  ulonglong uVar10;
  uint **ppuVar11;
  uint *_Memory_00;
  uint *puStackX8;
  
  uVar7 = param_3 & 0xffffffff;
  puStackX8 = (uint *)0x0;
  ppuVar11 = param_4;
  FUN_180004440(3,"991201==>",param_3,param_4);
  puVar1 = param_5;
  if (((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c != 0x1b59) {
    return 0xfffffc02;
  }
  if ((*(char *)param_4 != 'R') || (*(char *)((longlong)param_4 + 1) != 'D')) {
    return 0xfffffc0e;
  }
  if (*(int *)((longlong)param_4 + 4) == 0) {
    return 0xfffffffd;
  }
  uVar2 = (uint)uVar7;
  _Memory = (longlong *)FUN_180007180(param_2,uVar2);
  if (_Memory == (longlong *)0x0) {
    return 0xfffffc18;
  }
  uVar10 = SEXT48((int)(param_2 * uVar2));
  FUN_18001d320((undefined8 *)*_Memory,param_1,uVar10);
  if (DAT_18004cfd0 == (int *)0x0) {
    iVar8 = -0x3ea;
    uVar7 = uVar10;
    _Memory_00 = (uint *)0x0;
  }
  else {
    ppuVar11 = &puStackX8;
    uVar3 = FUN_180015cf0(_Memory,param_2,uVar2,(int **)ppuVar11,DAT_18004cfd0);
    iVar8 = (int)uVar3;
    _Memory_00 = puStackX8;
  }
  free(_Memory);
  if (iVar8 != 0) {
    FUN_180004440(1,"991202==>Fail",uVar7,ppuVar11);
    return 0xfffffc05;
  }
  piVar5 = (int *)(ulonglong)*_Memory_00;
  FUN_180004440(3,"991203==>%d",piVar5,ppuVar11);
  iVar8 = DAT_18004e164;
  if ((int)*_Memory_00 < 0xb) {
    FUN_180004440(3,"991204==>bad image",piVar5,ppuVar11);
    *puVar1 = DAT_18004cfc8;
    free(*(void **)(_Memory_00 + 4));
    free(_Memory_00);
    return 0xffffffff;
  }
  if (*(int *)(param_4 + 2) != 0) {
    uVar7 = SEXT48(DAT_18004e164);
    piVar5 = (int *)(uVar7 & 0xffffffff);
    FUN_180004440(3,"991205==>%d",piVar5,ppuVar11);
    lVar9 = 0;
    if (0 < iVar8) {
      do {
        if (*(uint **)((longlong)&DAT_18004e170 +
                      (longlong)*(int *)((longlong)&DAT_18004b200 + lVar9 * 4) * 0x18) ==
            (uint *)0x0) {
          FUN_180004440(1,"991206==>Fail",piVar5,ppuVar11);
        }
        else {
          uVar2 = FUN_180006250((int *)_Memory_00,
                                *(uint **)((longlong)&DAT_18004e170 +
                                          (longlong)*(int *)((longlong)&DAT_18004b200 + lVar9 * 4) *
                                          0x18),(undefined4 *)&puStackX8,ppuVar11);
          piVar5 = (int *)(ulonglong)uVar2;
          FUN_180004440(3,"99127==>%d",piVar5,ppuVar11);
          if (DAT_18004cfd0[0x15] <= (int)uVar2) {
            FUN_180004440(3,"991208==>%d %d",(ulonglong)uVar2,(ulonglong)(uint)DAT_18004cfd0[0x15]);
            free(*(void **)(_Memory_00 + 4));
            free(_Memory_00);
            return 0xfffffc14;
          }
        }
        lVar9 = lVar9 + 1;
      } while (lVar9 < (longlong)uVar7);
    }
  }
  piVar4 = FUN_18000cf90(_Memory_00,(longlong)param_4[3]);
  iVar8 = (int)piVar4;
  free(*(void **)(_Memory_00 + 4));
  free(_Memory_00);
  if (*(int *)((longlong)param_4 + 0xc) == 0) {
    if (iVar8 == 3) {
      FUN_180004440(3,"991209==>redundant %d",(ulonglong)*(uint *)(param_4 + 4),ppuVar11);
      piVar5 = DAT_18004cfd0;
      *puVar1 = ((DAT_18004cfd0[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                DAT_18004cfd0[0x1c];
      if (*(int *)(param_4 + 4) != 1) {
        return 0xfffffff8;
      }
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      if (0 < *(int *)((longlong)param_4 + 4)) {
        return 4;
      }
    }
    else {
      FUN_180004440(3,"991210==>accept",piVar5,ppuVar11);
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      piVar5 = DAT_18004cfd0;
    }
    if (*(int *)((longlong)param_4 + 4) != 0) {
      piVar5 = (int *)((longlong)((piVar5[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                       (longlong)piVar5[0x1c] & 0xffffffff);
      pcVar6 = "991212==>%d";
      *puVar1 = (uint)piVar5;
LAB_180005988:
      FUN_180004440(3,pcVar6,piVar5,ppuVar11);
      return 1;
    }
    pcVar6 = "991211==>done";
  }
  else {
    if (*(int *)((longlong)param_4 + 0xc) != 2) {
      FUN_180004440(3,"9912FF==>",piVar5,ppuVar11);
      return 0xfffffffd;
    }
    if (*(longlong *)(param_4[3] + 0x1e) == 0) {
      if (iVar8 == 3) {
        piVar5 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        FUN_180004440(3,"991218==>redundant %d",piVar5,ppuVar11);
        *puVar1 = 0;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        if (0 < *(int *)((longlong)param_4 + 4)) {
          return 4;
        }
      }
      else {
        FUN_180004440(3,"991219==>accept",piVar5,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      }
      if (*(int *)((longlong)param_4 + 4) != 0) {
        piVar5 = (int *)((longlong)((DAT_18004cfd0[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                         (longlong)DAT_18004cfd0[0x1c] & 0xffffffff);
        pcVar6 = "991221==>%d";
        DAT_18004cfc8 = (uint)piVar5;
        *puVar1 = DAT_18004cfc8;
        goto LAB_180005988;
      }
      pcVar6 = "991220==>done";
    }
    else {
      if (iVar8 == 3) {
        piVar5 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        pcVar6 = "991213==>redundant %d";
        FUN_180004440(3,"991213==>redundant %d",piVar5,ppuVar11);
        *puVar1 = DAT_18004cfc8;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar8 = *(int *)((longlong)param_4 + 4);
        if (0 < iVar8) {
          return 4;
        }
      }
      else {
        pcVar6 = "991214==>accept";
        FUN_180004440(3,"991214==>accept",piVar5,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar8 = *(int *)((longlong)param_4 + 4);
      }
      if (iVar8 == 0) {
        pcVar6 = "991215==>done";
      }
      else {
        uVar2 = FUN_180005410((longlong)param_4,pcVar6,piVar5,ppuVar11);
        if ((int)DAT_18004cfc8 < (int)uVar2) {
          if ((int)(uVar2 - DAT_18004cfc8) < 0x1a) {
            *puVar1 = uVar2;
            DAT_18004cfc8 = uVar2;
          }
          else {
            *puVar1 = DAT_18004cfc8 + 0x19;
            DAT_18004cfc8 = DAT_18004cfc8 + 0x19;
          }
        }
        else {
          *puVar1 = DAT_18004cfc8 + 3;
          DAT_18004cfc8 = DAT_18004cfc8 + 3;
        }
        piVar5 = (int *)(ulonglong)*puVar1;
        if (((int)*puVar1 < 100) && (*(int *)((longlong)param_4 + 4) != 0)) {
          pcVar6 = "991217==>%d";
          goto LAB_180005988;
        }
        pcVar6 = "991216==>done";
      }
    }
  }
  FUN_180004440(3,pcVar6,piVar5,ppuVar11);
  *puVar1 = 100;
  DAT_18004ad5c = 0x1b5a;
  return 2;
}



uint thunk_FUN_180005aa0(undefined8 *param_1,undefined8 *param_2,ulonglong param_3,ulonglong param_4
                        ,int *param_5)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  ulonglong uVar4;
  int **ppiVar5;
  uint *puVar6;
  int **ppiVar7;
  int iVar8;
  uint *puStackX8;
  uint *apuStack40 [2];
  
  ppiVar5 = (int **)(param_4 & 0xffffffff);
  uVar4 = param_3 & 0xffffffff;
  apuStack40[0] = (uint *)0x0;
  puStackX8 = (uint *)0x0;
  if (param_5 == (int *)0x0) {
    iVar8 = *(int *)((longlong)DAT_18004cfd0 + 0x54);
  }
  else {
    iVar8 = *param_5;
  }
  FUN_180004440(3,"991401==>",param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_2 == (undefined8 *)0x0)) || (0x3c000 < (int)uVar4))
     || (0x3c000 < (int)ppiVar5)) {
    FUN_180004440(1,"991402==>%d,%d",uVar4,ppiVar5);
    uVar2 = 0xfffffc11;
  }
  else {
    ppiVar7 = &param_5;
    uVar2 = FUN_180006d40(apuStack40,param_1,uVar4,(byte *)ppiVar7);
    puVar1 = apuStack40[0];
    if (uVar2 == 0) {
      ppiVar7 = &param_5;
      uVar2 = FUN_180006d40(&puStackX8,param_2,(ulonglong)ppiVar5,(byte *)ppiVar7);
      puVar6 = puStackX8;
      if (uVar2 == 0) {
        ppiVar7 = DAT_18004cfd0;
        iVar3 = FUN_18000db50((int *)puStackX8,(int *)puVar1,ppiVar5,(longlong)DAT_18004cfd0);
        uVar2 = 0x68;
        ppiVar5 = ppiVar7;
        if (iVar8 <= iVar3) {
          uVar2 = 0x65;
        }
      }
      else {
        FUN_180004440(1,"991404==>Fail %d",(ulonglong)uVar2,ppiVar7);
        puVar6 = puStackX8;
        ppiVar5 = ppiVar7;
      }
    }
    else {
      FUN_180004440(1,"991403==>Fail %d",(ulonglong)uVar2,ppiVar7);
      puVar6 = (uint *)0x0;
      ppiVar5 = ppiVar7;
    }
    if (puVar1 != (uint *)0x0) {
      FUN_18000e4c0((int *)puVar1);
    }
    if (puVar6 != (uint *)0x0) {
      FUN_18000e4c0((int *)puVar6);
    }
  }
  FUN_180004440(3,"9914FF==>%d",(ulonglong)uVar2,ppiVar5);
  return uVar2;
}



undefined8
thunk_FUN_180005d00(char *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  char *pcVar2;
  
  DAT_18004cfc8 = 0;
  FUN_180004440(3,"991701==>",param_3,param_4);
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (1 < DAT_18004ad5c - 0x1b59U) {
    return 0xfffffc02;
  }
  if ((*param_1 == 'R') && (param_1[1] == 'D')) {
    if (DAT_18004cfe0 != (void *)0x0) {
      free(DAT_18004cfe0);
      DAT_18004cfe0 = (void *)0x0;
    }
    DAT_18004ad5c = 7000;
    if (*(int *)(param_1 + 8) == 0) {
      FUN_180004440(3,"991702==>",param_3,param_4);
      if (*(int **)(*(longlong *)(param_1 + 0x18) + 0x78) != (int *)0x0) {
        FUN_18000e4c0(*(int **)(*(longlong *)(param_1 + 0x18) + 0x78));
      }
      if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
        FUN_180004440(3,"991703==>",param_3,param_4);
        if (*(void **)(*(longlong *)(param_1 + 0x18) + 0x80) != (void *)0x0) {
          free(*(void **)(*(longlong *)(param_1 + 0x18) + 0x80));
        }
        *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
      }
      FUN_18000bce0(*(longlong *)(param_1 + 0x18));
      FUN_18000bf90(*(void **)(param_1 + 0x18));
    }
    if (*(int *)(param_1 + 0x10) != 0) {
      pcVar2 = "991703==>";
      uVar1 = 3;
      FUN_180004440(3,"991703==>",param_3,param_4);
      FUN_180005c20(uVar1,pcVar2,param_3,param_4);
      *(undefined4 *)(param_1 + 0x10) = 0;
    }
    free(*(void **)(param_1 + 0x30));
    free(*(void **)(param_1 + 0x38));
    free(param_1);
    FUN_180004440(3,"9917FF==>",param_3,param_4);
    return 0;
  }
  return 0xfffffc0e;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 thunk_FUN_180006070(longlong *param_1,undefined8 param_2,ulonglong param_3,byte *param_4)

{
  uint uVar1;
  undefined8 uVar2;
  char *pcVar3;
  ulonglong uVar4;
  int **ppiVar5;
  int iVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  
  pcVar3 = "991801==>";
  uVar2 = 3;
  FUN_180004440(3,"991801==>",param_3,param_4);
  if (param_1 == (longlong *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c == 7000) {
    if (5 < *(int *)(param_1 + 2)) {
      return 0xfffffc00;
    }
    FUN_180005c20(uVar2,pcVar3,param_3,param_4);
    if (_DAT_18004e160 != *(int *)(param_1 + 2)) {
      DAT_18004b210 = 4;
      DAT_18004b200 = 0;
      DAT_18004b204 = 1;
      uRam000000018004b208 = 2;
      uRam000000018004b20c = 3;
      _DAT_18004e160 = *(int *)(param_1 + 2);
    }
    uVar4 = 0;
    if (0 < *(int *)(param_1 + 2)) {
      ppiVar5 = (int **)&DAT_18004e170;
      uVar8 = uVar4;
      uVar9 = uVar4;
      do {
        iVar6 = (int)uVar4;
        if ((*(undefined8 **)(uVar9 + *param_1) == (undefined8 *)0x0) ||
           (param_3 = (ulonglong)*(uint *)(uVar8 + param_1[1]),
           0x3c000 < *(uint *)(uVar8 + param_1[1]))) {
          param_4 = (byte *)(ulonglong)*(uint *)(param_1[1] + uVar8);
          FUN_180004440(1,"991802==>%d,%d",uVar4,param_4);
          param_3 = uVar4;
        }
        else {
          param_4 = &DAT_18004e178 + (longlong)iVar6 * 0x18;
          uVar1 = FUN_180006d40((uint **)(&DAT_18004e160 + ((longlong)iVar6 * 3 + 2) * 8),
                                *(undefined8 **)(uVar9 + *param_1),param_3,param_4);
          if (uVar1 == 0xfffffc0f) {
            pcVar3 = "991803==>Fail %d";
            uVar7 = 0xfffffc0f;
            uVar2 = 1;
            FUN_180004440(1,"991803==>Fail %d",0xfffffc0f,param_4);
            FUN_180005c20(uVar2,pcVar3,uVar7,param_4);
            DAT_18004ad5c = 7000;
            FUN_180004440(3,"9918FE==>%d",0xfffffc0f,param_4);
            return 0xfffffc0f;
          }
          if ((uVar1 != 0) && (*ppiVar5 != (int *)0x0)) {
            FUN_18000e4c0(*ppiVar5);
            *ppiVar5 = (int *)0x0;
          }
        }
        uVar4 = (ulonglong)(iVar6 + 1U);
        uVar9 = uVar9 + 8;
        ppiVar5 = ppiVar5 + 3;
        uVar8 = uVar8 + 4;
      } while ((int)(iVar6 + 1U) < *(int *)(param_1 + 2));
    }
    DAT_18004e164 = *(undefined4 *)(param_1 + 2);
    DAT_18004ad5c = 0x1b5b;
    FUN_180004440(3,"9918FF==>",param_3,param_4);
    return 0;
  }
  return 0xfffffc02;
}



ulonglong thunk_FUN_1800064e0(undefined8 *param_1,undefined8 param_2,undefined8 param_3,
                             ulonglong param_4)

{
  longlong lVar1;
  bool bVar2;
  longlong lVar3;
  int *_Memory;
  IMAGE_DOS_HEADER *pIVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  longlong lVar8;
  ulonglong uVar9;
  longlong lVar10;
  uint uVar11;
  IMAGE_DOS_HEADER *pIVar12;
  IMAGE_DOS_HEADER *pIVar13;
  ulonglong uVar14;
  IMAGE_DOS_HEADER *_Memory_00;
  IMAGE_DOS_HEADER *pIVar15;
  int iVar16;
  uint uStackX8;
  uint auStackX24 [2];
  int iStackX32;
  uint uStack100;
  IMAGE_DOS_HEADER *pIStack96;
  undefined8 *apuStack88 [3];
  
  pIVar13 = (IMAGE_DOS_HEADER *)0x0;
  pIVar15 = (IMAGE_DOS_HEADER *)0x0;
  uStack100 = 0;
  bVar2 = false;
  _Memory_00 = (IMAGE_DOS_HEADER *)0x0;
  auStackX24[0] = 0;
  pIStack96 = (IMAGE_DOS_HEADER *)0x0;
  apuStack88[0] = (undefined8 *)0x0;
  FUN_180004440(3,"992001==>",param_3,param_4);
  if (param_1 == (undefined8 *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c != 0x1b5b) {
    return 0xfffffc02;
  }
  uStackX8 = 0xffffffff;
  uVar14 = 0x68;
  if ((undefined8 *)*param_1 == (undefined8 *)0x0) {
    FUN_180004440(1,"992002==>NULL",param_3,param_4);
    uVar5 = 0xffffffff;
    uVar14 = 0xfffffc05;
    _Memory_00 = pIVar13;
    pIVar15 = pIVar13;
    uVar11 = 0xffffffff;
  }
  else {
    uVar11 = 0xffffffff;
    if (*(uint *)((longlong)param_1 + 0x2c) + 1 < 6) {
      pIVar12 = (IMAGE_DOS_HEADER *)(ulonglong)*(uint *)(param_1 + 1);
      iStackX32 = DAT_18004e164;
      uVar5 = FUN_180006f30((uint **)&pIStack96,(undefined8 *)*param_1,(ulonglong)pIVar12,param_4);
      _Memory_00 = pIStack96;
      if (uVar5 == 0) {
        piVar7 = DAT_18004cfd8;
        if ((DAT_18004cfc6 != '\0') &&
           (piVar7 = FUN_18000e240((int *)pIStack96), DAT_18004cfd8 != (int *)0x0)) {
          FUN_18000ddf0(DAT_18004cfd8,(int *)_Memory_00,(int *)auStackX24);
          pIVar12 = (IMAGE_DOS_HEADER *)(ulonglong)auStackX24[0];
          FUN_180004440(3,"992004==>%d",pIVar12,param_4);
          _Memory = DAT_18004cfd8;
          if (DAT_18004cfd8 != (int *)0x0) {
            free(*(void **)(DAT_18004cfd8 + 4));
            free(_Memory);
          }
        }
        DAT_18004cfd8 = piVar7;
        lVar8 = (longlong)iStackX32;
        lVar10 = 0;
        pIVar4 = pIVar13;
        uVar11 = 0xffffffff;
        if (0 < lVar8) {
          do {
            pIVar15 = pIVar4;
            auStackX24[0] = 0;
            uVar11 = *(uint *)((longlong)&DAT_18004b200 + lVar10 * 4);
            lVar1 = (longlong)(int)uVar11 * 0x18;
            pIStack96 = *(IMAGE_DOS_HEADER **)
                         ((longlong)&DAT_18004e170 + (longlong)(int)uVar11 * 0x18);
            iVar16 = (int)pIVar13;
            if (pIStack96 == (IMAGE_DOS_HEADER *)0x0) {
              uVar9 = 1;
              FUN_180004440(1,"992005==>Fail",pIVar12,param_4);
              pIVar13 = pIVar12;
            }
            else {
              uVar6 = *(uint *)((longlong)param_1 + 0x2c);
              param_4 = (ulonglong)uVar6;
              if ((uVar6 == 0xffffffff) || (uVar6 == uVar11)) {
                if ((&DAT_18004e178)[lVar1] == '\0') {
                  FUN_180012b50(DAT_18004e1fc);
                }
                else {
                  FUN_180012b50(DAT_18004e1fc + 0x80);
                  DAT_18004e1f8 = *(undefined2 *)(DAT_18004cfd0 + 0x84);
                }
                pIVar13 = (IMAGE_DOS_HEADER *)auStackX24;
                uVar6 = FUN_180006250((int *)_Memory_00,(uint *)pIStack96,(undefined4 *)pIVar13,
                                      param_4);
                lVar3 = DAT_18004cfd0;
                if (auStackX24[0] != 0) {
                  bVar2 = true;
                }
                if (*(int *)(DAT_18004cfd0 + 0x54) <= (int)uVar6) {
                  pIVar13 = &IMAGE_DOS_HEADER_180000000;
                  uStackX8 = uVar11;
                  if ((&DAT_18004e178)[lVar1] == '\0') {
                    (&DAT_18004e178)[lVar1] = 0;
                  }
                  else {
                    (&DAT_18004e178)[lVar1] = (&DAT_18004e178)[lVar1] + -1;
                  }
                }
                uVar11 = *(int *)(lVar3 + 0x54) * 3;
                uVar9 = (ulonglong)uVar11;
                if ((int)pIVar15 < (int)uVar6) {
                  pIVar15 = (IMAGE_DOS_HEADER *)(ulonglong)uVar6;
                }
                if (SBORROW4(uVar6,uVar11) == (int)(uVar6 + *(int *)(lVar3 + 0x54) * -3) < 0) break;
              }
              else {
                uVar9 = 3;
                FUN_180004440(3,"992009==>%d %d",pIVar13,param_4);
              }
            }
            lVar10 = lVar10 + 1;
            pIVar12 = pIVar13;
            pIVar4 = pIVar15;
            pIVar13 = (IMAGE_DOS_HEADER *)(ulonglong)(iVar16 + 1);
          } while (lVar10 < lVar8);
          uVar14 = 0x68;
          uVar11 = uStackX8;
          if (uStackX8 != 0xffffffff) {
            uVar14 = 0;
            FUN_180004bc0(uVar9,iStackX32,(ulonglong)uStackX8,param_4);
          }
        }
      }
      else {
        FUN_180004440(1,"992003==>%d, Fail",(ulonglong)uVar5,param_4);
        _Memory_00 = pIStack96;
      }
    }
    else {
      FUN_180004440(1,"992003==>%d",(ulonglong)*(uint *)((longlong)param_1 + 0x2c),param_4);
      uVar5 = 0xffffffff;
      uVar14 = 0xfffffbfb;
    }
  }
  *(uint *)(param_1 + 4) = uVar11;
  *(uint *)((longlong)param_1 + 0x24) = (uint)bVar2;
  *(int *)((longlong)param_1 + 0x1c) = (int)pIVar15;
  FUN_180004440(3,"992006==>%d %d",(ulonglong)uVar11,pIVar15);
  if (_Memory_00 != (IMAGE_DOS_HEADER *)0x0) {
    free(*(void **)&_Memory_00->e_sp);
    free(_Memory_00);
  }
  if ((bVar2) && (uVar11 != 0xffffffff)) {
    pIVar15 = (IMAGE_DOS_HEADER *)(&DAT_18004e178 + (longlong)(int)uVar11 * 0x18);
    uVar9 = FUN_180007070(*(int **)((longlong)&DAT_18004e170 + (longlong)(int)uVar11 * 0x18),
                          (char **)apuStack88,&uStack100,(byte *)pIVar15);
    uVar11 = uStack100;
    uVar5 = (uint)uVar9;
    if (uVar5 != 0) {
      FUN_180004440(1,"992007==>%d ,Fail",uVar9 & 0xffffffff,pIVar15);
      if (apuStack88[0] != (undefined8 *)0x0) {
        free(apuStack88[0]);
      }
      *(undefined4 *)((longlong)param_1 + 0x24) = 0;
      *(undefined4 *)(param_1 + 4) = 0xffffffff;
      param_1[3] = 0;
      FUN_180004440(3,"9920FE==>%d",uVar14,pIVar15);
      return uVar14;
    }
    uVar9 = SEXT48((int)uStack100);
    FUN_180004440(3,"992008==>%d",(ulonglong)uStack100,pIVar15);
    FUN_18001d320((undefined8 *)param_1[2],apuStack88[0],uVar9);
    *(uint *)(param_1 + 3) = uVar11;
    free(apuStack88[0]);
  }
  FUN_180004440(3,"9920FF==>%d",uVar14,pIVar15);
  if (uVar5 != 0) {
    uVar14 = (ulonglong)uVar5;
  }
  return uVar14;
}



undefined8
FUN_180003e20(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  char *pcVar2;
  
  pcVar2 = "992101==>";
  uVar1 = 3;
  FUN_180004440(3,"992101==>",param_3,param_4);
  if (DAT_18004ad5c != 0x1b5b) {
    return 0xfffffc02;
  }
  FUN_180005c20(uVar1,pcVar2,param_3,param_4);
  DAT_18004ad5c = 7000;
  FUN_180004440(3,"9921FF==>",param_3,param_4);
  return 0;
}



void * thunk_FUN_180006960(char *param_1,uint *param_2,ulonglong param_3,undefined *param_4)

{
  int *piVar1;
  ulonglong uVar2;
  uint *puVar3;
  
  FUN_180004440(3,"992201==>",param_3,param_4);
  if (DAT_18004cfe0 != (void *)0x0) {
    return DAT_18004cfe0;
  }
  if ((((param_1 != (char *)0x0) && (param_2 != (uint *)0x0)) && (DAT_18004ad5c == 0x1b5a)) &&
     ((*param_1 == 'R' && (param_1[1] == 'D')))) {
    if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
      FUN_180004440(3,"992202==>",param_3,param_4);
      if (*(void **)(*(longlong *)(param_1 + 0x18) + 0x80) != (void *)0x0) {
        free(*(void **)(*(longlong *)(param_1 + 0x18) + 0x80));
      }
      *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
    }
    piVar1 = FUN_18000c000(*(void **)(param_1 + 0x18));
    if (piVar1 == (int *)0x0) {
      FUN_180004440(1,"992202==>Fail",param_3,param_4);
    }
    else {
      param_4 = &DAT_18004e1e0;
      puVar3 = param_2;
      uVar2 = FUN_180007070(piVar1,(char **)&DAT_18004cfe0,param_2,&DAT_18004e1e0);
      if ((int)uVar2 == 0) {
        FUN_18000e4c0(piVar1);
        *(undefined4 *)(param_1 + 8) = 1;
        FUN_180004440(3,"9922FF==>",puVar3,param_4);
        return DAT_18004cfe0;
      }
      param_3 = uVar2 & 0xffffffff;
      FUN_180004440(1,"992203==>Fail %d",param_3,param_4);
    }
    if (DAT_18004cfe0 != (void *)0x0) {
      free(DAT_18004cfe0);
      DAT_18004cfe0 = (void *)0x0;
    }
    if (piVar1 != (int *)0x0) {
      FUN_18000e4c0(piVar1);
    }
    *param_2 = 0;
    FUN_180004440(3,"9922FE==>NULL",param_3,param_4);
    return (void *)0x0;
  }
  return (void *)0x0;
}



undefined8
thunk_FUN_180006af0(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5,
                   longlong param_6)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  longlong *_Memory;
  undefined8 uVar4;
  undefined8 *_Memory_00;
  uint *_Memory_01;
  ulonglong uVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  uint **ppuVar8;
  uint *puStackX8;
  
  uVar7 = param_3 & 0xffffffff;
  puStackX8 = (uint *)0x0;
  ppuVar8 = param_4;
  FUN_180004440(3,"992301==>",param_3,param_4);
  puVar1 = param_5;
  if ((((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) ||
     (param_6 == 0)) {
    uVar4 = 0xfffffc11;
  }
  else {
    uVar2 = (uint)uVar7;
    _Memory = (longlong *)FUN_180007180(param_2,uVar2);
    if (_Memory == (longlong *)0x0) {
      uVar4 = 0xfffffc18;
    }
    else {
      uVar5 = SEXT48((int)(param_2 * uVar2));
      FUN_18001d320((undefined8 *)*_Memory,param_1,uVar5);
      if (DAT_18004cfd0 == (int *)0x0) {
        iVar3 = -0x3ea;
        _Memory_01 = (uint *)0x0;
        uVar7 = uVar5;
      }
      else {
        ppuVar8 = &puStackX8;
        uVar4 = FUN_180015cf0(_Memory,param_2,uVar2,(int **)ppuVar8,DAT_18004cfd0);
        iVar3 = (int)uVar4;
        _Memory_01 = puStackX8;
      }
      free(_Memory);
      if (iVar3 == 0) {
        if (_Memory_01 != (uint *)0x0) {
          uVar2 = FUN_18000e540(_Memory_01);
          _Memory_00 = (undefined8 *)malloc((longlong)(int)(uVar2 + 8));
          if ((_Memory_00 != (undefined8 *)0x0) &&
             (iVar3 = FUN_18000e700(_Memory_01,(undefined2 *)_Memory_00), -1 < iVar3)) {
            free(*(void **)(_Memory_01 + 4));
            free(_Memory_01);
            if ((int)*puVar1 < (int)uVar2) {
              FUN_180004440(1,"992304=>Fail!",uVar7,ppuVar8);
              *puVar1 = 0;
              free(_Memory_00);
              return 0xfffffbfc;
            }
            *puVar1 = uVar2;
            if (uVar2 - 1 < 0xa000) {
              uVar6 = 0;
              uVar4 = FUN_180004950(_Memory_00,puVar1,0,ppuVar8);
              if ((int)uVar4 != 0) {
                FUN_180004440(1,"992306==>Fail",uVar6,ppuVar8);
                free(_Memory_00);
                *puVar1 = 0;
                return 0xfffffc0f;
              }
              uVar7 = SEXT48((int)*puVar1);
              FUN_18001d320(param_4,_Memory_00,uVar7);
              free(_Memory_00);
              FUN_180004440(3,"9923FF==>",uVar7,ppuVar8);
              return 0;
            }
            FUN_180004440(3,"992305==>Fail",uVar7,ppuVar8);
            *puVar1 = 0;
            free(_Memory_00);
            return 0xfffffc10;
          }
        }
        FUN_180004440(1,"992303==>Fail",uVar7,ppuVar8);
        *puVar1 = 0;
        uVar4 = 0xfffffc0e;
      }
      else {
        FUN_180004440(1,"992302==>Fail",uVar7,ppuVar8);
        uVar4 = 0xfffffc05;
      }
    }
  }
  return uVar4;
}



int FUN_180003ea0(undefined8 *param_1,uint param_2,int param_3,int *param_4,int *param_5,int param_6
                 )

{
  uint uVar1;
  int iVar2;
  undefined8 *_Memory;
  undefined *puVar3;
  undefined *puVar4;
  
  uVar1 = DAT_18004a774;
  if (param_6 == 5) {
    puVar3 = &DAT_18004ad60;
    puVar4 = &DAT_18004b1c0;
  }
  else {
    if ((param_6 - 7U & 0xfffffffd) == 0) {
      puVar3 = &DAT_18004ab40;
      puVar4 = &DAT_18004b180;
    }
    else {
      if (param_6 == 0x13) {
        puVar3 = &DAT_18004afa0;
        puVar4 = &DAT_18004ad20;
      }
      else {
        if (param_6 == 0x15) {
          puVar3 = &DAT_18004a780;
          puVar4 = &DAT_18004a738;
        }
        else {
          puVar3 = (undefined *)0x0;
          puVar4 = puVar3;
        }
      }
    }
  }
  _Memory = (undefined8 *)malloc((longlong)(int)(DAT_18004a774 * DAT_18004a734));
  if (_Memory == (undefined8 *)0x0) {
    iVar2 = -0x3f1;
  }
  else {
    FUN_18001d320(_Memory,param_1,(longlong)(int)(param_2 * param_3));
    FUN_180003fd0((longlong)_Memory,param_2,param_3,DAT_18004a734,uVar1);
    iVar2 = FUN_1800086d0(_Memory,param_2,param_3,param_4,param_5,puVar3,puVar4);
    free(_Memory);
  }
  return iVar2;
}



void FUN_180003fd0(longlong param_1,uint param_2,int param_3,int param_4,uint param_5)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  longlong lVar4;
  longlong lVar5;
  uint uVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  byte *pbVar10;
  byte *pbVar11;
  undefined8 *puVar12;
  longlong lVar13;
  ulonglong uVar14;
  undefined *puVar15;
  int iVar16;
  uint uVar17;
  longlong lVar18;
  int iVar19;
  int iVar20;
  undefined8 *puVar21;
  ulonglong uVar22;
  int iVar23;
  int iVar25;
  int iVar26;
  int iVar27;
  int iVar28;
  undefined in_XMM2 [16];
  undefined auVar24 [16];
  int iVar29;
  int iVar30;
  undefined auVar31 [16];
  undefined in_XMM4 [16];
  undefined auStack184 [32];
  longlong local_98;
  int local_90;
  ulonglong local_88;
  int local_80;
  uint local_7c;
  undefined *local_70;
  undefined *local_68;
  undefined8 local_60;
  undefined8 local_58;
  undefined8 local_50;
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)auStack184;
  uVar22 = (ulonglong)param_5;
  uVar14 = SEXT48((int)param_2);
  local_7c = param_5;
  uVar3 = uVar22 * (uVar14 & 0xffffffff);
  uVar7 = uVar3 & 0xffffffff;
  if ((int)(uVar3 >> 0x20) != 0) {
    uVar7 = 0xffffffffffffffff;
  }
  local_98 = param_1;
  local_80 = param_4;
  local_68 = (undefined *)malloc(uVar7);
  if (local_68 != (undefined *)0x0) {
    local_90 = 0;
    uVar7 = (longlong)(param_3 << 10) / (longlong)(int)param_5 & 0xffffffff;
    iVar1 = (int)uVar7;
    uVar3 = uVar14;
    local_70 = local_68;
    uVar17 = param_2;
    if (0 < (int)param_5) {
      do {
        local_88 = uVar22;
        iVar16 = 0;
        iVar2 = (int)(local_90 + (local_90 >> 0x1f & 0x3ffU)) >> 10;
        iVar9 = (iVar2 + 1) * 0x400 - local_90;
        local_58 = 0;
        local_50 = 0;
        if (0 < iVar1) {
          uVar22 = uVar7;
          puVar21 = &local_58;
          do {
            iVar19 = (int)uVar22;
            iVar20 = iVar9;
            if (iVar19 < iVar9) {
              iVar20 = iVar19;
            }
            iVar16 = iVar16 + 1;
            uVar22 = (ulonglong)(uint)(iVar19 - iVar20);
            *(int *)puVar21 = iVar20;
            iVar9 = 0x400;
            puVar21 = (undefined8 *)((longlong)puVar21 + 4);
          } while (0 < iVar19 - iVar20);
        }
        lVar13 = (longlong)iVar16;
        if (0 < (longlong)uVar14) {
          puVar15 = local_70;
          uVar22 = uVar14;
          do {
            iVar9 = 0;
            iVar16 = 0;
            lVar18 = 0;
            pbVar11 = puVar15 + (((int)uVar3 * iVar2 + param_1) - (longlong)local_70);
            if (1 < lVar13) {
              do {
                lVar8 = lVar18 * 4;
                pbVar10 = pbVar11 + uVar14;
                lVar18 = lVar18 + 2;
                iVar9 = iVar9 + *(int *)((longlong)&local_58 + lVar8) * (uint)*pbVar11;
                pbVar11 = pbVar10 + uVar14;
                iVar16 = iVar16 + *(int *)((longlong)&local_60 + lVar18 * 4 + 4) * (uint)*pbVar10;
              } while (lVar18 < lVar13 + -1);
            }
            iVar20 = iVar1 / 2;
            if (lVar18 < lVar13) {
              iVar20 = *(int *)((longlong)&local_58 + lVar18 * 4) * (uint)*pbVar11 + iVar1 / 2;
            }
            *puVar15 = (char)((iVar16 + iVar9 + iVar20) / iVar1);
            uVar22 = uVar22 - 1;
            puVar15 = puVar15 + 1;
          } while (uVar22 != 0);
          uVar3 = (ulonglong)param_2;
          param_1 = local_98;
        }
        uVar17 = (uint)uVar3;
        local_70 = local_70 + uVar14;
        local_90 = local_90 + iVar1;
        local_88 = local_88 - 1;
        uVar22 = local_88;
      } while (local_88 != 0);
      uVar22 = (ulonglong)local_7c;
      param_4 = local_80;
    }
    uVar3 = (longlong)(int)(uVar17 << 10) / (longlong)param_4 & 0xffffffff;
    lVar13 = (longlong)param_4;
    iVar1 = (int)uVar3;
    iVar2 = iVar1 / 2;
    puVar15 = local_68;
    if (0 < (int)uVar22) {
      do {
        iVar9 = DAT_180049300;
        iVar16 = 0;
        lVar18 = 0;
        if (0 < lVar13) {
          do {
            uVar17 = 0;
            iVar20 = (int)(iVar16 + (iVar16 >> 0x1f & 0x3ffU)) >> 10;
            local_58 = 0;
            local_50 = 0;
            puVar21 = (undefined8 *)(puVar15 + iVar20);
            iVar20 = (iVar20 + 1) * 0x400 - iVar16;
            if (0 < iVar1) {
              uVar7 = uVar3;
              puVar12 = &local_58;
              do {
                iVar23 = (int)uVar7;
                iVar19 = iVar20;
                if (iVar23 < iVar20) {
                  iVar19 = iVar23;
                }
                uVar17 = uVar17 + 1;
                uVar7 = (ulonglong)(uint)(iVar23 - iVar19);
                *(int *)puVar12 = iVar19;
                iVar20 = 0x400;
                puVar12 = (undefined8 *)((longlong)puVar12 + 4);
              } while (0 < iVar23 - iVar19);
            }
            lVar4 = 0;
            lVar8 = lVar4;
            iVar20 = iVar2;
            if (((0 < (int)uVar17) && (7 < uVar17)) && (1 < iVar9)) {
              iVar19 = 0;
              if (((undefined8 *)((longlong)puVar21 + (longlong)(int)(uVar17 - 1)) < &local_58) ||
                 (lVar8 = 0,
                 (undefined8 *)((longlong)&local_58 + (longlong)(int)(uVar17 - 1) * 4) < puVar21)) {
                uVar6 = uVar17 & 0x80000007;
                if ((int)uVar6 < 0) {
                  uVar6 = (uVar6 - 1 | 0xfffffff8) + 1;
                }
                in_XMM4 = in_XMM4 & (undefined  [16])0x0;
                auVar31 = in_XMM4;
                do {
                  lVar8 = (longlong)iVar19;
                  lVar4 = lVar4 + 8;
                  iVar20 = iVar19 + 4;
                  iVar19 = iVar19 + 8;
                  auVar24 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)((longlong)puVar21 + lVar8)));
                  auVar24 = pmulld(auVar24,*(undefined (*) [16])((longlong)&local_58 + lVar8 * 4));
                  iVar23 = SUB164(auVar24,0) + SUB164(in_XMM4,0);
                  iVar25 = SUB164(auVar24 >> 0x20,0) + SUB164(in_XMM4 >> 0x20,0);
                  iVar27 = SUB164(auVar24 >> 0x40,0) + SUB164(in_XMM4 >> 0x40,0);
                  iVar29 = SUB164(auVar24 >> 0x60,0) + SUB164(in_XMM4 >> 0x60,0);
                  in_XMM4 = CONCAT412(iVar29,CONCAT48(iVar27,CONCAT44(iVar25,iVar23)));
                  auVar24 = pmovzxbd(in_XMM4,ZEXT416(*(uint *)((longlong)puVar21 + (longlong)iVar20)
                                                    ));
                  auVar24 = pmulld(auVar24,*(undefined (*) [16])
                                            ((longlong)&local_58 + (longlong)iVar20 * 4));
                  iVar20 = SUB164(auVar24,0) + SUB164(auVar31,0);
                  iVar26 = SUB164(auVar24 >> 0x20,0) + SUB164(auVar31 >> 0x20,0);
                  iVar28 = SUB164(auVar24 >> 0x40,0) + SUB164(auVar31 >> 0x40,0);
                  iVar30 = SUB164(auVar24 >> 0x60,0) + SUB164(auVar31 >> 0x60,0);
                  in_XMM2 = CONCAT412(iVar30,CONCAT48(iVar28,CONCAT44(iVar26,iVar20)));
                  auVar31 = in_XMM2;
                } while (iVar19 < (int)(uVar17 - uVar6));
                iVar20 = iVar20 + iVar23 + iVar28 + iVar27 + iVar26 + iVar25 + iVar30 + iVar29 +
                         iVar2;
                lVar8 = lVar4;
              }
            }
            lVar4 = (longlong)(int)uVar17;
            iVar19 = 0;
            iVar23 = 0;
            if (lVar8 < lVar4) {
              if (1 < lVar4 - lVar8) {
                lVar5 = lVar8;
                do {
                  lVar8 = lVar5 + 2;
                  iVar19 = iVar19 + (uint)*(byte *)((longlong)puVar21 + lVar5) *
                                    *(int *)((longlong)&local_60 + lVar8 * 4);
                  iVar23 = iVar23 + (uint)*(byte *)((longlong)puVar21 + lVar5 + 1) *
                                    *(int *)((longlong)&local_60 + lVar8 * 4 + 4);
                  lVar5 = lVar8;
                } while (lVar8 < lVar4 + -1);
              }
              if (lVar8 < lVar4) {
                iVar20 = iVar20 + (uint)*(byte *)((longlong)puVar21 + lVar8) *
                                  *(int *)((longlong)&local_58 + lVar8 * 4);
              }
              iVar20 = iVar20 + iVar23 + iVar19;
            }
            lVar8 = lVar18 + 1;
            iVar16 = iVar16 + iVar1;
            *(char *)(lVar18 + local_98) = (char)(iVar20 / iVar1);
            lVar18 = lVar8;
          } while (lVar8 < lVar13);
        }
        local_98 = local_98 + lVar13;
        uVar22 = uVar22 - 1;
        puVar15 = puVar15 + uVar14;
        local_88 = uVar22;
      } while (uVar22 != 0);
    }
    local_60 = uVar14;
    free(local_68);
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)auStack184);
  return;
}



void FUN_180004440(undefined8 param_1,char *param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStack1096 [32];
  undefined8 local_428;
  char local_418 [1024];
  ulonglong local_18;
  
  if (param_2 != (char *)0x0) {
    local_18 = DAT_180049180 ^ (ulonglong)auStack1096;
    local_428 = 0;
    local_res18 = param_3;
    local_res20 = param_4;
    vsprintf_s(local_418,0x400,param_2,(va_list)&local_res18);
    strcat_s(local_418,0x400,"\r\n");
    OutputDebugStringA(local_418);
    FUN_18001d2f0(local_18 ^ (ulonglong)auStack1096);
  }
  return;
}



undefined8 FUN_1800044d0(char *param_1,byte param_2,undefined8 param_3,undefined8 param_4)

{
  ulonglong uVar1;
  
  uVar1 = (ulonglong)param_2;
  FUN_180004440(3,"993501==>%d",uVar1,param_4);
  if (param_1 == (char *)0x0) {
    return 0xfffffbfc;
  }
  if (((*param_1 == 'E') && (param_1[1] == '\x01')) && (*(ushort *)(param_1 + 2) - 1 < 0x28)) {
    param_1[0xc] = param_2;
    FUN_180004440(3,"9935FF==>",uVar1,param_4);
    return 0;
  }
  return 0xfffffc0e;
}



undefined8 FUN_180004560(longlong param_1,byte *param_2,undefined8 param_3,undefined8 param_4)

{
  byte bVar1;
  
  FUN_180004440(3,"993601==>",param_3,param_4);
  if (param_1 == 0) {
    return 0xfffffbfc;
  }
  bVar1 = *(byte *)(param_1 + 0xc);
  *param_2 = bVar1;
  FUN_180004440(3,"9936FF==>%d",(ulonglong)bVar1,param_4);
  return 0;
}



void FUN_1800045c0(undefined8 *param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  byte *pbVar1;
  byte **ppbVar2;
  longlong lVar3;
  ulonglong uVar4;
  undefined8 uVar5;
  undefined8 uVar6;
  undefined8 in_stack_fffffffffffffc98;
  undefined4 local_358;
  undefined4 uStack852;
  undefined4 uStack848;
  undefined4 uStack844;
  undefined4 uStack840;
  undefined4 uStack836;
  undefined4 uStack832;
  undefined4 uStack828;
  byte *local_338 [60];
  undefined8 local_158;
  undefined4 uStack336;
  undefined4 uStack332;
  undefined4 local_148;
  undefined4 uStack324;
  undefined4 uStack320;
  undefined4 uStack316;
  byte local_118 [240];
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffc78;
  uVar4 = SEXT48((int)param_2);
  FUN_180004440(3,"990101==>",param_3,param_4);
  FUN_18001d980((undefined (*) [16])&local_158,0,uVar4);
  local_358 = CONCAT22(DAT_18004e1f0,0x4541);
  uStack844 = DAT_18004b200;
  uStack840 = DAT_18004b204;
  uStack836 = uRam000000018004b208;
  uStack832 = uRam000000018004b20c;
  uStack852 = CONCAT22(DAT_18004e1f4,DAT_18004e1f2);
  uVar5 = 0;
  uStack848 = CONCAT22(DAT_18004e1f8,DAT_18004e1f6);
  uStack828 = DAT_18004b210;
  local_158._0_4_ = local_358;
  local_158._4_4_ = uStack852;
  uStack336 = uStack848;
  uStack332 = DAT_18004b200;
  local_148 = DAT_18004b204;
  uStack324 = uRam000000018004b208;
  uStack320 = uRam000000018004b20c;
  uStack316 = DAT_18004b210;
  FUN_18001d980((undefined (*) [16])local_118,0,0xf0);
  ppbVar2 = local_338;
  pbVar1 = local_118;
  lVar3 = 0x34;
  do {
    *ppbVar2 = pbVar1;
    pbVar1 = pbVar1 + 4;
    ppbVar2 = ppbVar2 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  uVar6 = 0;
  FUN_180008ae0((longlong)&DAT_180038248,local_338,
                (uint)CONCAT71((int7)((ulonglong)uVar5 >> 8),0x18),0);
  if ((uVar4 & 0xf) != 0) {
    param_2 = param_2 & 0xfffffff0;
  }
  FUN_180008d20((byte *)&local_158,(longlong *)local_338,param_2,uVar6,in_stack_fffffffffffffc98,0xc
               );
  FUN_18001d320(param_1,&local_158,uVar4);
  FUN_180004440(3,"9901FF==>",uVar4,uVar6);
  FUN_18001d2f0(local_28 ^ (ulonglong)&stack0xfffffffffffffc78);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180004750(undefined4 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  byte **ppbVar1;
  byte *pbVar2;
  longlong lVar3;
  undefined8 uVar4;
  undefined8 uVar5;
  undefined8 in_stack_fffffffffffffcc8;
  byte *local_328 [60];
  undefined4 local_148;
  undefined4 uStack324;
  undefined4 uStack320;
  undefined4 uStack316;
  undefined4 local_138;
  undefined4 uStack308;
  undefined4 uStack304;
  undefined4 uStack300;
  undefined4 local_128;
  undefined4 uStack292;
  undefined4 uStack288;
  undefined4 uStack284;
  undefined4 local_118;
  undefined4 uStack276;
  undefined4 uStack272;
  undefined4 uStack268;
  byte local_108 [240];
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffca8;
  FUN_180004440(3,"990201==>",param_3,param_4);
  local_148 = *param_1;
  uStack324 = param_1[1];
  uStack320 = param_1[2];
  uStack316 = param_1[3];
  local_138 = param_1[4];
  uStack308 = param_1[5];
  uStack304 = param_1[6];
  uStack300 = param_1[7];
  uVar4 = 0;
  local_128 = param_1[8];
  uStack292 = param_1[9];
  uStack288 = param_1[10];
  uStack284 = param_1[0xb];
  local_118 = param_1[0xc];
  uStack276 = param_1[0xd];
  uStack272 = param_1[0xe];
  uStack268 = param_1[0xf];
  FUN_18001d980((undefined (*) [16])local_108,0,0xf0);
  ppbVar1 = local_328;
  pbVar2 = local_108;
  lVar3 = 0x34;
  do {
    *ppbVar1 = pbVar2;
    pbVar2 = pbVar2 + 4;
    ppbVar1 = ppbVar1 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  uVar5 = 1;
  FUN_180008ae0((longlong)&DAT_180038248,local_328,
                (uint)CONCAT71((int7)((ulonglong)uVar4 >> 8),0x18),1);
  uVar4 = 0x40;
  FUN_180009050((byte *)&local_148,(longlong *)local_328,0x40,uVar5,in_stack_fffffffffffffcc8,0xc);
  if (((char)local_148 == 'A') && (local_148._1_1_ == 'E')) {
    DAT_18004e1f0 = local_148._2_2_;
    DAT_18004b200 = uStack316;
    DAT_18004b204 = local_138;
    uRam000000018004b208 = uStack308;
    uRam000000018004b20c = uStack304;
    DAT_18004e1f2 = (undefined2)uStack324;
    _DAT_18004e1f4 = CONCAT22((undefined2)uStack320,uStack324._2_2_);
    DAT_18004e1f8 = uStack320._2_2_;
    DAT_18004b210 = uStack300;
    FUN_180004440(3,"990202==>good",uVar4,uVar5);
    if (DAT_18004e1f8 == 0) {
      DAT_18004e1f8 = *(short *)(DAT_18004cfd0 + 0x84);
    }
    if (DAT_18004e1f0 == 0) {
      DAT_18004e1f0 = *(short *)(DAT_18004cfd0 + 0x54);
    }
    FUN_180004440(3,"9902FF==>",uVar4,uVar5);
  }
  else {
    DAT_18004e1f0 = *(short *)(DAT_18004cfd0 + 0x54);
    _DAT_18004e1f4 = 0;
    DAT_18004e1f8 = *(short *)(DAT_18004cfd0 + 0x84);
  }
  FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xfffffffffffffca8);
  return;
}



undefined8 FUN_180004950(undefined8 *param_1,uint *param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  undefined8 uVar2;
  undefined8 *_Memory;
  undefined *puVar3;
  ulonglong uVar4;
  undefined uVar5;
  undefined7 uVar6;
  
  uVar5 = (undefined)param_4;
  uVar6 = (undefined7)((ulonglong)param_4 >> 8);
  FUN_180004440(3,"990301==>",param_3,param_4);
  if ((param_1 != (undefined8 *)0x0) && (param_2 != (uint *)0x0)) {
    uVar1 = *param_2;
    if ((int)uVar1 < 1) {
      uVar2 = 0xfffffc10;
    }
    else {
      _Memory = (undefined8 *)malloc((longlong)(int)(uVar1 + 5));
      if (_Memory == (undefined8 *)0x0) {
        FUN_180004440(1,"990302==>%d Fail",(ulonglong)uVar1,CONCAT71(uVar6,uVar5));
        uVar2 = 0xfffffc0f;
      }
      else {
        FUN_18001d320((undefined8 *)((longlong)_Memory + 5),param_1,(longlong)(int)uVar1);
        *(undefined *)((longlong)_Memory + 4) = 0x45;
        *param_2 = *param_2 + 1;
        puVar3 = &DAT_180038280;
        uVar5 = 0x20;
        if ((int)param_3 != 0) {
          puVar3 = &DAT_180038260;
        }
        FUN_180009390((byte *)((longlong)_Memory + 4),(longlong)puVar3,*param_2,CONCAT71(uVar6,0x20)
                     );
        *(undefined *)_Memory = 0x44;
        *(undefined *)((longlong)_Memory + 1) = *(undefined *)((longlong)param_2 + 2);
        *(char *)((longlong)_Memory + 2) = (char)(*param_2 >> 8);
        *(undefined *)((longlong)_Memory + 3) = *(undefined *)param_2;
        *param_2 = *param_2 + 4;
        FUN_180004440(3,"990305==>%d",(ulonglong)*param_2,CONCAT71(uVar6,uVar5));
        uVar4 = SEXT48((int)*param_2);
        FUN_18001d320(param_1,_Memory,uVar4);
        free(_Memory);
        FUN_180004440(3,"9903FF==>",uVar4,CONCAT71(uVar6,uVar5));
        uVar2 = 0;
      }
    }
    return uVar2;
  }
  return 0xfffffc11;
}



undefined8 FUN_180004aa0(undefined8 *param_1,int *param_2,int param_3,undefined8 param_4)

{
  undefined8 uVar1;
  uint uVar2;
  ulonglong uVar3;
  undefined uVar4;
  undefined7 uVar5;
  undefined *puVar6;
  
  uVar5 = (undefined7)((ulonglong)param_4 >> 8);
  puVar6 = &DAT_180038280;
  if (param_3 != 0) {
    puVar6 = &DAT_180038260;
  }
  if (param_2 == (int *)0x0) {
    return 0xfffffc11;
  }
  if (0x3c004 < *param_2 - 1U) {
    return 0xfffffc10;
  }
  if ((*(char *)param_1 != 'D') && (*(char *)param_1 != 'E')) {
    return 0xfffffc0e;
  }
  uVar2 = (uint)CONCAT21(CONCAT11(*(undefined *)((longlong)param_1 + 1),
                                  *(undefined *)((longlong)param_1 + 2)),
                         *(undefined *)((longlong)param_1 + 3));
  if (uVar2 + 4 != *param_2) {
    return 0xfffffc0e;
  }
  uVar4 = 0x20;
  FUN_180009470((byte *)((longlong)param_1 + 4),(longlong)puVar6,uVar2,0x20);
  if (*(char *)((longlong)param_1 + 4) == 'E') {
    uVar3 = SEXT48((int)(uVar2 - 1));
    FUN_18001d320(param_1,(undefined8 *)((longlong)param_1 + 5),uVar3);
    *param_2 = uVar2 - 1;
    FUN_180004440(3,"9904FF==>",uVar3,CONCAT71(uVar5,uVar4));
    uVar1 = 0;
  }
  else {
    uVar1 = 0xfffffc0e;
  }
  return uVar1;
}



void FUN_180004bc0(undefined8 param_1,int param_2,ulonglong param_3,ulonglong param_4)

{
  int iVar1;
  ulonglong uVar2;
  undefined auStack72 [32];
  ulonglong local_28 [4];
  
  local_28[3] = DAT_180049180 ^ (ulonglong)auStack72;
  iVar1 = (int)param_3;
  FUN_180004440(3,"990501==>",param_3,param_4);
  if (iVar1 <= param_2) {
    if (iVar1 != DAT_18004b200) {
      uVar2 = 0;
      param_4 = uVar2;
      if (0 < param_2) {
        do {
          if (*(int *)((longlong)&DAT_18004b200 + uVar2 * 4) == iVar1) break;
          *(int *)((longlong)local_28 + uVar2 * 4) = *(int *)((longlong)&DAT_18004b200 + uVar2 * 4);
          uVar2 = uVar2 + 1;
          param_4 = (ulonglong)((int)param_4 + 1);
        } while ((longlong)uVar2 < (longlong)param_2);
      }
      param_3 = (longlong)(int)param_4 << 2;
      FUN_18001d320((undefined8 *)&DAT_18004b204,local_28,param_3);
      DAT_18004b200 = iVar1;
    }
    FUN_180004440(3,"9905FF==>",param_3,param_4);
  }
  FUN_18001d2f0(local_28[3] ^ (ulonglong)auStack72);
  return;
}



void FUN_180004d50(undefined8 *param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180004440(3,"990801==>",param_3,param_4);
  if (DAT_18004cfd0 != (void *)0x0) {
    free(DAT_18004cfd0);
    DAT_18004cfd0 = (void *)0x0;
  }
  DAT_18004ad5c = 0x7fffffff;
  FUN_1800045c0(param_1,param_2,param_3,param_4);
  FUN_180004440(3,"9908FF==>%d %d %d %d",(ulonglong)DAT_18004e1f6,(ulonglong)DAT_18004e1f4);
  return;
}



undefined2 *
FUN_180004df0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  longlong lVar2;
  undefined2 *puVar3;
  void *pvVar4;
  void *pvVar5;
  void *pvVar6;
  
  FUN_180004440(3,"990901==>",param_3,param_4);
  lVar2 = DAT_18004cfd0;
  DAT_18004cfc8 = 0;
  if (DAT_18004ad5c != 7000) {
    DAT_18004cfc8 = 0;
    return (undefined2 *)0x0;
  }
  *(undefined4 *)(DAT_18004cfd0 + 0x70) = 100;
  puVar3 = (undefined2 *)malloc(0x40);
  if (puVar3 != (undefined2 *)0x0) {
    pvVar4 = calloc(1,0x20);
    if (pvVar4 == (void *)0x0) {
      FUN_180004440(1,"990903==>Fail",param_3,param_4);
      puVar3 = (undefined2 *)0x0;
    }
    else {
      pvVar5 = calloc(1,0x3c);
      if (pvVar5 == (void *)0x0) {
        FUN_180004440(1,"990904==>Fail",param_3,param_4);
        puVar3 = (undefined2 *)0x0;
      }
      else {
        *puVar3 = 0x4452;
        uVar1 = *(undefined4 *)(lVar2 + 0x70);
        *(undefined8 *)(puVar3 + 4) = 0;
        *(undefined4 *)(puVar3 + 8) = 0;
        *(undefined4 *)(puVar3 + 0x10) = 100;
        *(undefined4 *)(puVar3 + 2) = uVar1;
        pvVar6 = FUN_18000ba50();
        *(void **)(puVar3 + 0x1c) = pvVar5;
        *(void **)(puVar3 + 0x18) = pvVar4;
        *(void **)(puVar3 + 0xc) = pvVar6;
        *(undefined4 *)(puVar3 + 0x12) = 0xd;
        *(undefined4 *)(puVar3 + 0x14) = 0x9c;
        DAT_18004e1e0 = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x18) = 0xffffffff;
        **(undefined **)(puVar3 + 0x1c) = 1;
        DAT_18004ad5c = 0x1b59;
        *(undefined *)(*(longlong *)(puVar3 + 0x1c) + 1) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x1c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x20) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x24) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x28) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x2c) = 0;
        *(undefined4 *)(*(longlong *)(puVar3 + 0x1c) + 0x30) = 0;
        FUN_180004440(3,"9909FF==>",param_3,param_4);
      }
    }
    return puVar3;
  }
  FUN_180004440(1,"990902==>Fail",param_3,param_4);
  return (undefined2 *)0x0;
}



undefined8 FUN_180004fa0(char *param_1,undefined4 param_2,ulonglong param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined uVar2;
  ulonglong uVar4;
  uint uVar3;
  
  uVar4 = param_3 & 0xffffffff;
  FUN_180004440(3,"991001==>",param_3,param_4);
  lVar1 = DAT_18004cfd0;
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c == 0x1b59) {
    if ((*param_1 != 'R') || (param_1[1] != 'D')) {
      return 0xfffffc0e;
    }
    uVar2 = (undefined)uVar4;
    uVar3 = (uint)uVar4;
    switch(param_2) {
    case 0x4b0:
      *(uint *)(param_1 + 0xc) = uVar3;
      if (uVar3 == 2) {
        *(undefined4 *)(lVar1 + 0x6c) = 0;
        uVar3 = DAT_18004e1fc;
        *(undefined4 *)(lVar1 + 0x8c) = 1;
        if ((uVar3 < 0x14) && ((0x84180U >> (uVar3 & 0x1f) & 1) != 0)) {
          *(undefined4 *)(lVar1 + 100) = 1;
          *(undefined4 *)(lVar1 + 0x70) = 0x1e;
          *(undefined4 *)(param_1 + 4) = 0x1e;
          *(undefined4 *)(param_1 + 0x24) = 0x12;
          *(undefined4 *)(param_1 + 0x28) = 0x9c;
        }
        else {
          if (uVar3 == 0x12) {
            *(undefined4 *)(lVar1 + 0x70) = 0xd;
            *(undefined4 *)(param_1 + 4) = 0xd;
            *(undefined4 *)(param_1 + 0x24) = 8;
            *(undefined4 *)(param_1 + 0x28) = 200;
          }
          else {
            if ((uVar3 == 9) || (uVar3 == 0x15)) {
              *(undefined4 *)(lVar1 + 0x70) = 0xf;
              *(undefined4 *)(param_1 + 4) = 0xf;
              *(undefined4 *)(param_1 + 0x24) = 0x11;
              *(undefined4 *)(param_1 + 0x28) = 0x9c;
            }
            else {
              *(undefined4 *)(lVar1 + 0x70) = 0xc;
              *(undefined4 *)(param_1 + 4) = 0xc;
              *(undefined4 *)(param_1 + 0x24) = 0xd;
              *(undefined4 *)(param_1 + 0x28) = 0x9c;
            }
          }
        }
      }
      else {
        if (uVar3 == 3) {
          *(undefined4 *)(lVar1 + 0x8c) = 2;
          *(undefined4 *)(lVar1 + 0x90) = 1;
          *(undefined4 *)(lVar1 + 0x6c) = 0;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 1;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 1;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 5;
          *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
        }
        else {
          if (uVar3 == 4) {
            *(undefined4 *)(lVar1 + 0x8c) = 2;
            *(undefined4 *)(lVar1 + 0x90) = 1;
            *(undefined4 *)(lVar1 + 0x6c) = 0;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0xc) = 0;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x10) = 0;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x14) = 8;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x18) = 100;
            *(undefined4 *)(*(longlong *)(param_1 + 0x30) + 0x1c) = 0;
          }
          else {
            *(undefined8 *)(lVar1 + 0x8c) = 0;
          }
        }
      }
      break;
    default:
      return 0xfffff89f;
    case 0x4bc:
    case 0x4bd:
    case 0x4bf:
      *(uint *)(DAT_18004cfd0 + 0x70) = uVar3;
      *(uint *)(param_1 + 4) = uVar3;
      break;
    case 0x4be:
      if (*(int *)(param_1 + 0xc) - 2U < 3) {
        return 0xfffff89f;
      }
      *(uint *)(DAT_18004cfd0 + 0x6c) = uVar3;
      break;
    case 0x4cd:
      *(uint *)(param_1 + 0x20) = uVar3;
      break;
    case 0x4ce:
      *(uint *)(DAT_18004cfd0 + 0x74) = uVar3;
      break;
    case 0x4cf:
      *(uint *)(DAT_18004cfd0 + 0x7c) = uVar3;
      break;
    case 0x4d0:
      *(uint *)(DAT_18004cfd0 + 0x80) = uVar3;
      break;
    case 0x4d1:
      DAT_18004e1e0 = uVar2;
      break;
    case 0x4d2:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      FUN_180004440(3,"991002==>%d",uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else {
        if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
          return 0xfffff89f;
        }
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0xc) = uVar3;
      param_3 = uVar4;
      break;
    case 0x4d3:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      FUN_180004440(3,"991003==>%d",uVar4,param_4);
      if (*(int *)(param_1 + 0xc) == 3) {
        if (0x7fffffff < uVar3) {
          return 0xfffff89f;
        }
      }
      else {
        if ((*(int *)(param_1 + 0xc) != 4) && (uVar3 != 0)) {
          return 0xfffff89f;
        }
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x10) = uVar3;
      param_3 = uVar4;
      break;
    case 0x4d4:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x14) = uVar3;
      FUN_180004440(3,"991004==>%d",uVar4,param_4);
      param_3 = uVar4;
      break;
    case 0x4d5:
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x18) = uVar3;
      FUN_180004440(3,"991005==>%d",uVar4,param_4);
      param_3 = uVar4;
      break;
    case 0x4d6:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 4) = uVar3;
      FUN_180004440(3,"991006==>%d",uVar4,param_4);
      param_3 = uVar4;
      break;
    case 0x4d7:
      **(undefined **)(param_1 + 0x30) = uVar2;
      break;
    case 0x4d8:
      *(undefined *)(*(longlong *)(param_1 + 0x30) + 1) = uVar2;
      break;
    case 0x4d9:
      *(undefined *)(*(longlong *)(param_1 + 0x30) + 2) = uVar2;
      break;
    case 0x4da:
      if (1 < uVar3) {
        return 0xfffff89f;
      }
      *(uint *)(*(longlong *)(param_1 + 0x30) + 0x1c) = uVar3;
    }
    FUN_180004440(3,"9910FF==>",param_3,param_4);
    return 0;
  }
  return 0xfffffc02;
}



uint FUN_180005410(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  int *piVar2;
  uint *puVar3;
  longlong lVar4;
  ulonglong uVar5;
  uint uVar6;
  int iVar7;
  ulonglong uVar9;
  uint uVar10;
  int iVar12;
  int iVar13;
  int iVar14;
  ulonglong uVar15;
  ulonglong uVar8;
  ulonglong uVar11;
  
  uVar15 = 0;
  FUN_180004440(3,"991291==>",param_3,param_4);
  lVar4 = DAT_18004cfd0;
  piVar2 = *(int **)(*(longlong *)(param_1 + 0x18) + 0x78);
  uVar10 = 0;
  if (0 < *piVar2) {
    uVar5 = uVar15;
    uVar8 = uVar15;
    uVar9 = uVar15;
    uVar11 = uVar15;
    do {
      if ((int)uVar9 < (int)**(uint **)(uVar5 + *(longlong *)(piVar2 + 2))) {
        uVar9 = (ulonglong)**(uint **)(uVar5 + *(longlong *)(piVar2 + 2));
        uVar11 = uVar8;
      }
      uVar10 = (uint)uVar11;
      uVar6 = (int)uVar8 + 1;
      uVar8 = (ulonglong)uVar6;
      uVar5 = uVar5 + 8;
    } while ((int)uVar6 < *piVar2);
  }
  iVar12 = -0x400;
  puVar3 = *(uint **)(*(longlong *)(piVar2 + 2) + (longlong)(int)uVar10 * 8);
  iVar14 = 0x400;
  iVar7 = -0x400;
  uVar10 = *puVar3;
  iVar13 = 0x400;
  if (0 < (int)uVar10) {
    uVar5 = (ulonglong)uVar10;
    do {
      piVar2 = *(int **)(uVar15 + *(longlong *)(puVar3 + 6));
      uVar15 = uVar15 + 8;
      iVar1 = *piVar2;
      if (iVar1 < iVar14) {
        iVar14 = iVar1;
      }
      if (iVar12 < iVar1) {
        iVar12 = iVar1;
      }
      iVar1 = piVar2[1];
      if (iVar1 < iVar13) {
        iVar13 = iVar1;
      }
      if (iVar7 < iVar1) {
        iVar7 = iVar1;
      }
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  if (*(int *)(DAT_18004cfd0 + 0x70) - *(int *)(param_1 + 4) == *(int *)(DAT_18004cfd0 + 0x6c) + 2)
  {
    *(int *)(*(longlong *)(param_1 + 0x18) + 0x18) = iVar7 - iVar13;
  }
  uVar10 = (((iVar7 - iVar13) - *(int *)(*(longlong *)(param_1 + 0x18) + 0x18)) * 10) /
           *(int *)(param_1 + 0x24);
  if (iVar12 - iVar14 < *(int *)(param_1 + 0x28)) {
    if ((int)uVar10 < 100) {
      uVar10 = (int)(uVar10 * 9) / 10;
    }
    else {
      uVar10 = 0x5a;
    }
  }
  uVar5 = (longlong)((*(int *)(lVar4 + 0x70) - *(int *)(param_1 + 4)) * 100) /
          (longlong)*(int *)(lVar4 + 0x70) & 0xffffffff;
  uVar15 = uVar5;
  FUN_180004440(3,"991292==>%d %d",(ulonglong)uVar10,uVar5);
  uVar6 = (uint)uVar5;
  if ((int)(uint)uVar5 < (int)uVar10) {
    uVar6 = uVar10;
  }
  if ((int)uVar6 < 0) {
    uVar6 = 0;
  }
  FUN_180004440(3,"991293==>%d",(ulonglong)uVar6,uVar15);
  return uVar6;
}



undefined4
FUN_1800055a0(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5)

{
  uint *puVar1;
  uint uVar2;
  longlong *_Memory;
  undefined8 uVar3;
  int *piVar4;
  int *piVar5;
  char *pcVar6;
  ulonglong uVar7;
  int iVar8;
  longlong lVar9;
  ulonglong uVar10;
  uint **ppuVar11;
  uint *_Memory_00;
  uint *local_res8;
  
  uVar7 = param_3 & 0xffffffff;
  local_res8 = (uint *)0x0;
  ppuVar11 = param_4;
  FUN_180004440(3,"991201==>",param_3,param_4);
  puVar1 = param_5;
  if (((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c != 0x1b59) {
    return 0xfffffc02;
  }
  if ((*(char *)param_4 != 'R') || (*(char *)((longlong)param_4 + 1) != 'D')) {
    return 0xfffffc0e;
  }
  if (*(int *)((longlong)param_4 + 4) == 0) {
    return 0xfffffffd;
  }
  uVar2 = (uint)uVar7;
  _Memory = (longlong *)FUN_180007180(param_2,uVar2);
  if (_Memory == (longlong *)0x0) {
    return 0xfffffc18;
  }
  uVar10 = SEXT48((int)(param_2 * uVar2));
  FUN_18001d320((undefined8 *)*_Memory,param_1,uVar10);
  if (DAT_18004cfd0 == (int *)0x0) {
    iVar8 = -0x3ea;
    uVar7 = uVar10;
    _Memory_00 = (uint *)0x0;
  }
  else {
    ppuVar11 = &local_res8;
    uVar3 = FUN_180015cf0(_Memory,param_2,uVar2,(int **)ppuVar11,DAT_18004cfd0);
    iVar8 = (int)uVar3;
    _Memory_00 = local_res8;
  }
  free(_Memory);
  if (iVar8 != 0) {
    FUN_180004440(1,"991202==>Fail",uVar7,ppuVar11);
    return 0xfffffc05;
  }
  piVar5 = (int *)(ulonglong)*_Memory_00;
  FUN_180004440(3,"991203==>%d",piVar5,ppuVar11);
  iVar8 = DAT_18004e164;
  if ((int)*_Memory_00 < 0xb) {
    FUN_180004440(3,"991204==>bad image",piVar5,ppuVar11);
    *puVar1 = DAT_18004cfc8;
    free(*(void **)(_Memory_00 + 4));
    free(_Memory_00);
    return 0xffffffff;
  }
  if (*(int *)(param_4 + 2) != 0) {
    uVar7 = SEXT48(DAT_18004e164);
    piVar5 = (int *)(uVar7 & 0xffffffff);
    FUN_180004440(3,"991205==>%d",piVar5,ppuVar11);
    lVar9 = 0;
    if (0 < iVar8) {
      do {
        if (*(uint **)((longlong)&DAT_18004e170 +
                      (longlong)*(int *)((longlong)&DAT_18004b200 + lVar9 * 4) * 0x18) ==
            (uint *)0x0) {
          FUN_180004440(1,"991206==>Fail",piVar5,ppuVar11);
        }
        else {
          uVar2 = FUN_180006250((int *)_Memory_00,
                                *(uint **)((longlong)&DAT_18004e170 +
                                          (longlong)*(int *)((longlong)&DAT_18004b200 + lVar9 * 4) *
                                          0x18),(undefined4 *)&local_res8,ppuVar11);
          piVar5 = (int *)(ulonglong)uVar2;
          FUN_180004440(3,"99127==>%d",piVar5,ppuVar11);
          if (DAT_18004cfd0[0x15] <= (int)uVar2) {
            FUN_180004440(3,"991208==>%d %d",(ulonglong)uVar2,(ulonglong)(uint)DAT_18004cfd0[0x15]);
            free(*(void **)(_Memory_00 + 4));
            free(_Memory_00);
            return 0xfffffc14;
          }
        }
        lVar9 = lVar9 + 1;
      } while (lVar9 < (longlong)uVar7);
    }
  }
  piVar4 = FUN_18000cf90(_Memory_00,(longlong)param_4[3]);
  iVar8 = (int)piVar4;
  free(*(void **)(_Memory_00 + 4));
  free(_Memory_00);
  if (*(int *)((longlong)param_4 + 0xc) == 0) {
    if (iVar8 == 3) {
      FUN_180004440(3,"991209==>redundant %d",(ulonglong)*(uint *)(param_4 + 4),ppuVar11);
      piVar5 = DAT_18004cfd0;
      *puVar1 = ((DAT_18004cfd0[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                DAT_18004cfd0[0x1c];
      if (*(int *)(param_4 + 4) != 1) {
        return 0xfffffff8;
      }
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      if (0 < *(int *)((longlong)param_4 + 4)) {
        return 4;
      }
    }
    else {
      FUN_180004440(3,"991210==>accept",piVar5,ppuVar11);
      *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      piVar5 = DAT_18004cfd0;
    }
    if (*(int *)((longlong)param_4 + 4) != 0) {
      piVar5 = (int *)((longlong)((piVar5[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                       (longlong)piVar5[0x1c] & 0xffffffff);
      pcVar6 = "991212==>%d";
      *puVar1 = (uint)piVar5;
LAB_180005988:
      FUN_180004440(3,pcVar6,piVar5,ppuVar11);
      return 1;
    }
    pcVar6 = "991211==>done";
  }
  else {
    if (*(int *)((longlong)param_4 + 0xc) != 2) {
      FUN_180004440(3,"9912FF==>",piVar5,ppuVar11);
      return 0xfffffffd;
    }
    if (*(longlong *)(param_4[3] + 0x1e) == 0) {
      if (iVar8 == 3) {
        piVar5 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        FUN_180004440(3,"991218==>redundant %d",piVar5,ppuVar11);
        *puVar1 = 0;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        if (0 < *(int *)((longlong)param_4 + 4)) {
          return 4;
        }
      }
      else {
        FUN_180004440(3,"991219==>accept",piVar5,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
      }
      if (*(int *)((longlong)param_4 + 4) != 0) {
        piVar5 = (int *)((longlong)((DAT_18004cfd0[0x1c] - *(int *)((longlong)param_4 + 4)) * 100) /
                         (longlong)DAT_18004cfd0[0x1c] & 0xffffffff);
        pcVar6 = "991221==>%d";
        DAT_18004cfc8 = (uint)piVar5;
        *puVar1 = DAT_18004cfc8;
        goto LAB_180005988;
      }
      pcVar6 = "991220==>done";
    }
    else {
      if (iVar8 == 3) {
        piVar5 = (int *)(ulonglong)*(uint *)(param_4 + 4);
        pcVar6 = "991213==>redundant %d";
        FUN_180004440(3,"991213==>redundant %d",piVar5,ppuVar11);
        *puVar1 = DAT_18004cfc8;
        if (*(int *)(param_4 + 4) != 1) {
          return 0xfffffff8;
        }
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar8 = *(int *)((longlong)param_4 + 4);
        if (0 < iVar8) {
          return 4;
        }
      }
      else {
        pcVar6 = "991214==>accept";
        FUN_180004440(3,"991214==>accept",piVar5,ppuVar11);
        *(int *)((longlong)param_4 + 4) = *(int *)((longlong)param_4 + 4) + -1;
        iVar8 = *(int *)((longlong)param_4 + 4);
      }
      if (iVar8 == 0) {
        pcVar6 = "991215==>done";
      }
      else {
        uVar2 = FUN_180005410((longlong)param_4,pcVar6,piVar5,ppuVar11);
        if ((int)DAT_18004cfc8 < (int)uVar2) {
          if ((int)(uVar2 - DAT_18004cfc8) < 0x1a) {
            *puVar1 = uVar2;
            DAT_18004cfc8 = uVar2;
          }
          else {
            *puVar1 = DAT_18004cfc8 + 0x19;
            DAT_18004cfc8 = DAT_18004cfc8 + 0x19;
          }
        }
        else {
          *puVar1 = DAT_18004cfc8 + 3;
          DAT_18004cfc8 = DAT_18004cfc8 + 3;
        }
        piVar5 = (int *)(ulonglong)*puVar1;
        if (((int)*puVar1 < 100) && (*(int *)((longlong)param_4 + 4) != 0)) {
          pcVar6 = "991217==>%d";
          goto LAB_180005988;
        }
        pcVar6 = "991216==>done";
      }
    }
  }
  FUN_180004440(3,pcVar6,piVar5,ppuVar11);
  *puVar1 = 100;
  DAT_18004ad5c = 0x1b5a;
  return 2;
}



uint FUN_180005aa0(undefined8 *param_1,undefined8 *param_2,ulonglong param_3,ulonglong param_4,
                  int *param_5)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  ulonglong uVar4;
  int **ppiVar5;
  uint *puVar6;
  int **ppiVar7;
  int iVar8;
  uint *local_res8;
  uint *local_28 [2];
  
  ppiVar5 = (int **)(param_4 & 0xffffffff);
  uVar4 = param_3 & 0xffffffff;
  local_28[0] = (uint *)0x0;
  local_res8 = (uint *)0x0;
  if (param_5 == (int *)0x0) {
    iVar8 = *(int *)((longlong)DAT_18004cfd0 + 0x54);
  }
  else {
    iVar8 = *param_5;
  }
  FUN_180004440(3,"991401==>",param_3,param_4);
  if ((((param_1 == (undefined8 *)0x0) || (param_2 == (undefined8 *)0x0)) || (0x3c000 < (int)uVar4))
     || (0x3c000 < (int)ppiVar5)) {
    FUN_180004440(1,"991402==>%d,%d",uVar4,ppiVar5);
    uVar2 = 0xfffffc11;
  }
  else {
    ppiVar7 = &param_5;
    uVar2 = FUN_180006d40(local_28,param_1,uVar4,(byte *)ppiVar7);
    puVar1 = local_28[0];
    if (uVar2 == 0) {
      ppiVar7 = &param_5;
      uVar2 = FUN_180006d40(&local_res8,param_2,(ulonglong)ppiVar5,(byte *)ppiVar7);
      puVar6 = local_res8;
      if (uVar2 == 0) {
        ppiVar7 = DAT_18004cfd0;
        iVar3 = FUN_18000db50((int *)local_res8,(int *)puVar1,ppiVar5,(longlong)DAT_18004cfd0);
        uVar2 = 0x68;
        ppiVar5 = ppiVar7;
        if (iVar8 <= iVar3) {
          uVar2 = 0x65;
        }
      }
      else {
        FUN_180004440(1,"991404==>Fail %d",(ulonglong)uVar2,ppiVar7);
        puVar6 = local_res8;
        ppiVar5 = ppiVar7;
      }
    }
    else {
      FUN_180004440(1,"991403==>Fail %d",(ulonglong)uVar2,ppiVar7);
      puVar6 = (uint *)0x0;
      ppiVar5 = ppiVar7;
    }
    if (puVar1 != (uint *)0x0) {
      FUN_18000e4c0((int *)puVar1);
    }
    if (puVar6 != (uint *)0x0) {
      FUN_18000e4c0((int *)puVar6);
    }
  }
  FUN_180004440(3,"9914FF==>%d",(ulonglong)uVar2,ppiVar5);
  return uVar2;
}



void FUN_180005c20(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  int *_Memory;
  void *_Memory_00;
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  int **ppiVar5;
  ulonglong uVar6;
  
  FUN_180004440(3,"991501==>",param_3,param_4);
  uVar4 = 0;
  if (0 < DAT_18004e164) {
    ppiVar5 = (int **)&DAT_18004e170;
    uVar6 = uVar4;
    do {
      _Memory = *ppiVar5;
      if (_Memory != (int *)0x0) {
        uVar2 = uVar4;
        uVar3 = uVar4;
        if (0 < *_Memory) {
          do {
            _Memory_00 = *(void **)(uVar3 + *(longlong *)(_Memory + 2));
            if (_Memory_00 != (void *)0x0) {
              free(*(void **)((longlong)_Memory_00 + 0x10));
              free(_Memory_00);
            }
            uVar1 = (int)uVar2 + 1;
            uVar2 = (ulonglong)uVar1;
            uVar3 = uVar3 + 8;
          } while ((int)uVar1 < *_Memory);
        }
        free(_Memory);
        *ppiVar5 = (int *)0x0;
      }
      *(undefined4 *)(ppiVar5 + -1) = 0;
      *(undefined *)(ppiVar5 + 1) = 0;
      uVar1 = (int)uVar6 + 1;
      uVar6 = (ulonglong)uVar1;
      ppiVar5 = ppiVar5 + 3;
    } while ((int)uVar1 < DAT_18004e164);
  }
  FUN_180004440(3,"9915FF==>",param_3,param_4);
  return;
}



undefined8 FUN_180005d00(char *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  char *pcVar2;
  
  DAT_18004cfc8 = 0;
  FUN_180004440(3,"991701==>",param_3,param_4);
  if (param_1 == (char *)0x0) {
    return 0xfffffc11;
  }
  if (1 < DAT_18004ad5c - 0x1b59U) {
    return 0xfffffc02;
  }
  if ((*param_1 == 'R') && (param_1[1] == 'D')) {
    if (DAT_18004cfe0 != (void *)0x0) {
      free(DAT_18004cfe0);
      DAT_18004cfe0 = (void *)0x0;
    }
    DAT_18004ad5c = 7000;
    if (*(int *)(param_1 + 8) == 0) {
      FUN_180004440(3,"991702==>",param_3,param_4);
      if (*(int **)(*(longlong *)(param_1 + 0x18) + 0x78) != (int *)0x0) {
        FUN_18000e4c0(*(int **)(*(longlong *)(param_1 + 0x18) + 0x78));
      }
      if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
        FUN_180004440(3,"991703==>",param_3,param_4);
        if (*(void **)(*(longlong *)(param_1 + 0x18) + 0x80) != (void *)0x0) {
          free(*(void **)(*(longlong *)(param_1 + 0x18) + 0x80));
        }
        *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
      }
      FUN_18000bce0(*(longlong *)(param_1 + 0x18));
      FUN_18000bf90(*(void **)(param_1 + 0x18));
    }
    if (*(int *)(param_1 + 0x10) != 0) {
      pcVar2 = "991703==>";
      uVar1 = 3;
      FUN_180004440(3,"991703==>",param_3,param_4);
      FUN_180005c20(uVar1,pcVar2,param_3,param_4);
      *(undefined4 *)(param_1 + 0x10) = 0;
    }
    free(*(void **)(param_1 + 0x30));
    free(*(void **)(param_1 + 0x38));
    free(param_1);
    FUN_180004440(3,"9917FF==>",param_3,param_4);
    return 0;
  }
  return 0xfffffc0e;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180005e70(int *param_1,void **param_2,int *param_3)

{
  void *pvVar1;
  int iVar2;
  byte *pbVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  undefined auStack88 [32];
  byte local_38;
  byte bStack55;
  byte bStack54;
  byte bStack53;
  byte bStack52;
  byte bStack51;
  byte bStack50;
  byte bStack49;
  undefined4 local_30;
  undefined4 uStack44;
  undefined4 uStack40;
  undefined4 uStack36;
  ulonglong local_20;
  
  local_20 = DAT_180049180 ^ (ulonglong)auStack88;
  if ((param_1 != (int *)0x0) &&
     (iVar2 = FUN_18000eb80(param_1,param_2,param_3,DAT_18004cfd0), iVar2 == 0)) {
    iVar2 = *param_3;
    pvVar1 = *param_2;
    uVar7 = 0;
    local_30 = 0xcdfc1978;
    uStack44 = 0x9a3bab45;
    uStack40 = 0x695caa15;
    uStack36 = 0xcd8d7196;
    uVar4 = uVar7;
    if (0 < iVar2 + -0x20) {
      do {
        uVar6 = (uint)uVar7;
        uVar5 = uVar4 + 1;
        uVar7 = (ulonglong)(uVar6 + 1);
        pbVar3 = (byte *)((longlong)&local_30 + (ulonglong)(uVar6 & 0xf));
        *pbVar3 = *pbVar3 ^ *(byte *)(uVar4 + 0x20 + (longlong)pvVar1);
        uVar4 = uVar5;
      } while ((longlong)uVar5 < (longlong)(iVar2 + -0x20));
    }
    local_38 = (byte)local_30 ^ (byte)uStack40;
    bStack55 = uStack40._1_1_ ^ local_30._1_1_;
    bStack54 = uStack40._2_1_ ^ local_30._2_1_;
    bStack53 = uStack40._3_1_ ^ local_30._3_1_;
    bStack52 = (byte)uStack36 ^ (byte)uStack44;
    bStack51 = uStack36._1_1_ ^ uStack44._1_1_;
    bStack50 = uStack36._2_1_ ^ uStack44._2_1_;
    bStack49 = uStack36._3_1_ ^ uStack44._3_1_;
    *(ulonglong *)((longlong)pvVar1 + 4) =
         CONCAT17(bStack49,CONCAT16(bStack50,CONCAT15(bStack51,CONCAT14(bStack52,CONCAT13(bStack53,
                                                  CONCAT12(bStack54,CONCAT11(bStack55,local_38))))))
                 );
  }
  FUN_18001d2f0(local_20 ^ (ulonglong)auStack88);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180005f70(longlong param_1,int param_2)

{
  ulonglong uVar1;
  byte *pbVar2;
  ulonglong uVar3;
  uint uVar4;
  byte local_28;
  byte bStack39;
  byte bStack38;
  byte bStack37;
  byte bStack36;
  byte bStack35;
  byte bStack34;
  byte bStack33;
  undefined4 local_20;
  undefined4 uStack28;
  undefined4 uStack24;
  undefined4 uStack20;
  ulonglong local_10;
  
  local_10 = DAT_180049180 ^ (ulonglong)&local_28;
  uVar3 = 0;
  uVar1 = uVar3;
  while (*(char *)(param_1 + 4 + uVar1) == '\0') {
    uVar1 = uVar1 + 1;
    if (7 < (longlong)uVar1) goto LAB_180005fa3;
  }
  local_20 = 0xcdfc1978;
  uStack28 = 0x9a3bab45;
  uStack24 = 0x695caa15;
  uStack20 = 0xcd8d7196;
  uVar1 = uVar3;
  if (0 < param_2 + -0x20) {
    do {
      uVar4 = (uint)uVar1;
      uVar3 = uVar3 + 1;
      uVar1 = (ulonglong)(uVar4 + 1);
      pbVar2 = (byte *)((longlong)&local_20 + (ulonglong)(uVar4 & 0xf));
      *pbVar2 = *pbVar2 ^ *(byte *)(param_1 + 0x1f + uVar3);
    } while ((longlong)uVar3 < (longlong)(param_2 + -0x20));
  }
  local_28 = (byte)local_20 ^ (byte)uStack24;
  bStack39 = uStack24._1_1_ ^ local_20._1_1_;
  bStack38 = uStack24._2_1_ ^ local_20._2_1_;
  bStack37 = uStack24._3_1_ ^ local_20._3_1_;
  bStack36 = (byte)uStack20 ^ (byte)uStack28;
  bStack35 = uStack20._1_1_ ^ uStack28._1_1_;
  bStack34 = uStack20._2_1_ ^ uStack28._2_1_;
  bStack33 = uStack20._3_1_ ^ uStack28._3_1_;
  if (CONCAT17(bStack33,CONCAT16(bStack34,CONCAT15(bStack35,CONCAT14(bStack36,CONCAT13(bStack37,
                                                  CONCAT12(bStack38,CONCAT11(bStack39,local_28))))))
              ) != *(longlong *)(param_1 + 4)) {
    FUN_18001d2f0(local_10 ^ (ulonglong)&local_28);
    return;
  }
LAB_180005fa3:
  FUN_18001d2f0(local_10 ^ (ulonglong)&local_28);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180006070(longlong *param_1,undefined8 param_2,ulonglong param_3,byte *param_4)

{
  uint uVar1;
  undefined8 uVar2;
  char *pcVar3;
  ulonglong uVar4;
  int **ppiVar5;
  int iVar6;
  undefined8 uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  
  pcVar3 = "991801==>";
  uVar2 = 3;
  FUN_180004440(3,"991801==>",param_3,param_4);
  if (param_1 == (longlong *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c == 7000) {
    if (5 < *(int *)(param_1 + 2)) {
      return 0xfffffc00;
    }
    FUN_180005c20(uVar2,pcVar3,param_3,param_4);
    if (_DAT_18004e160 != *(int *)(param_1 + 2)) {
      DAT_18004b210 = 4;
      DAT_18004b200 = 0;
      DAT_18004b204 = 1;
      uRam000000018004b208 = 2;
      uRam000000018004b20c = 3;
      _DAT_18004e160 = *(int *)(param_1 + 2);
    }
    uVar4 = 0;
    if (0 < *(int *)(param_1 + 2)) {
      ppiVar5 = (int **)&DAT_18004e170;
      uVar8 = uVar4;
      uVar9 = uVar4;
      do {
        iVar6 = (int)uVar4;
        if ((*(undefined8 **)(uVar9 + *param_1) == (undefined8 *)0x0) ||
           (param_3 = (ulonglong)*(uint *)(uVar8 + param_1[1]),
           0x3c000 < *(uint *)(uVar8 + param_1[1]))) {
          param_4 = (byte *)(ulonglong)*(uint *)(param_1[1] + uVar8);
          FUN_180004440(1,"991802==>%d,%d",uVar4,param_4);
          param_3 = uVar4;
        }
        else {
          param_4 = &DAT_18004e178 + (longlong)iVar6 * 0x18;
          uVar1 = FUN_180006d40((uint **)(&DAT_18004e160 + ((longlong)iVar6 * 3 + 2) * 8),
                                *(undefined8 **)(uVar9 + *param_1),param_3,param_4);
          if (uVar1 == 0xfffffc0f) {
            pcVar3 = "991803==>Fail %d";
            uVar7 = 0xfffffc0f;
            uVar2 = 1;
            FUN_180004440(1,"991803==>Fail %d",0xfffffc0f,param_4);
            FUN_180005c20(uVar2,pcVar3,uVar7,param_4);
            DAT_18004ad5c = 7000;
            FUN_180004440(3,"9918FE==>%d",0xfffffc0f,param_4);
            return 0xfffffc0f;
          }
          if ((uVar1 != 0) && (*ppiVar5 != (int *)0x0)) {
            FUN_18000e4c0(*ppiVar5);
            *ppiVar5 = (int *)0x0;
          }
        }
        uVar4 = (ulonglong)(iVar6 + 1U);
        uVar9 = uVar9 + 8;
        ppiVar5 = ppiVar5 + 3;
        uVar8 = uVar8 + 4;
      } while ((int)(iVar6 + 1U) < *(int *)(param_1 + 2));
    }
    DAT_18004e164 = *(undefined4 *)(param_1 + 2);
    DAT_18004ad5c = 0x1b5b;
    FUN_180004440(3,"9918FF==>",param_3,param_4);
    return 0;
  }
  return 0xfffffc02;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_180006250(int *param_1,uint *param_2,undefined4 *param_3,undefined8 param_4)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  uint uVar6;
  uint *puVar7;
  ulonglong uVar8;
  short local_res8 [4];
  
  FUN_180004440(3,"991901==>",param_3,param_4);
  uVar1 = *param_2;
  puVar7 = (uint *)0x0;
  *param_3 = 0;
  puVar3 = (uint *)calloc(1,((longlong)(int)uVar1 + 2) * 0x10);
  if (puVar3 != (uint *)0x0) {
    *puVar3 = uVar1;
    *(uint **)(puVar3 + 4) = puVar3 + 8;
    *(uint **)(puVar3 + 6) = puVar3 + 8 + (longlong)(int)uVar1 * 2;
    puVar7 = puVar3;
  }
  FUN_180004440(3,"991902==>%d %d %d",(ulonglong)*param_2,(longlong)*param_1);
  uVar8 = DAT_18004cfd0;
  uVar1 = FUN_18000b560((int *)param_2,param_1,(longlong)puVar7,DAT_18004cfd0,0);
  FUN_180004440(3,"991903==>%d",(ulonglong)uVar1,uVar8);
  uVar2 = (uint)DAT_18004e1f0;
  if ((DAT_18004e1f6 == 1) && ((int)uVar2 < (int)uVar1)) {
    _DAT_18004e1f4 = 1;
  }
  if ((int)uVar2 < (int)uVar1) {
    uVar8 = (ulonglong)*(uint *)(DAT_18004cfd0 + 0x84);
    DAT_18004e1f8 = DAT_18004e1f8 - 0x50;
    uVar6 = (uint)DAT_18004e1f8;
    _DAT_18004e1f4 = CONCAT22(1,DAT_18004e1f4);
    if ((int)(uint)DAT_18004e1f8 < (int)*(uint *)(DAT_18004cfd0 + 0x84)) {
      FUN_180004440(3,"991904==>%d < %d",(ulonglong)DAT_18004e1f8,uVar8);
      DAT_18004e1f8 = *(ushort *)(DAT_18004cfd0 + 0x84);
      uVar6 = (uint)DAT_18004e1f8;
    }
  }
  else {
    uVar6 = (uint)DAT_18004e1f8;
    _DAT_18004e1f4 = 0;
    uVar2 = (DAT_18004e1f0 >> 1) + uVar2;
    if (uVar6 <= uVar2) {
      uVar6 = (uint)(ushort)(DAT_18004e1f8 + 0x3c);
    }
    if (uVar2 < uVar6) {
      uVar6 = uVar2 & 0xffff;
    }
    DAT_18004e1f8 = (ushort)uVar6;
    if (puVar7 != (uint *)0x0) {
      uVar8 = (ulonglong)puVar7[2];
      FUN_180004440(3,"991905==>%d %d",(ulonglong)uVar2,uVar8);
      uVar6 = (uint)DAT_18004e1f8;
    }
  }
  uVar5 = DAT_18004cfd0;
  if (((int)uVar6 < (int)uVar1) && ((int)puVar7[2] < *(int *)(DAT_18004cfd0 + 0x68))) {
    if ((0x27 < *param_2 - 1) || (*(longlong *)(param_2 + 2) == 0)) goto LAB_180006497;
    uVar4 = FUN_18000ea60((int *)param_2,local_res8,*(int *)(DAT_18004cfd0 + 0x58));
    if (((int)uVar4 < 0) || (*(int *)(uVar5 + 0x88) <= (int)uVar4 + 0x20)) goto LAB_180006497;
    uVar8 = (ulonglong)(_DAT_18004e1f4 & 0xffff);
    FUN_180004440(3,"991906==>%d %d %d %d",3,uVar8);
    uVar5 = FUN_18000d310((int *)param_2,(int *)puVar7,DAT_18004cfd0);
    if ((int)uVar5 == 0) {
      *param_3 = 1;
      goto LAB_180006497;
    }
    FUN_180004440(1,"991907==>%d ,Fail",uVar5 & 0xffffffff,uVar8);
  }
  *param_3 = 0;
LAB_180006497:
  FUN_18000e3f0((int *)puVar7);
  FUN_180004440(3,"9919FF==>%d",(ulonglong)uVar1,uVar8);
  return uVar1;
}



ulonglong FUN_1800064e0(undefined8 *param_1,undefined8 param_2,undefined8 param_3,ulonglong param_4)

{
  longlong lVar1;
  bool bVar2;
  longlong lVar3;
  int *_Memory;
  IMAGE_DOS_HEADER *pIVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  longlong lVar8;
  ulonglong uVar9;
  longlong lVar10;
  uint uVar11;
  IMAGE_DOS_HEADER *pIVar12;
  IMAGE_DOS_HEADER *pIVar13;
  ulonglong uVar14;
  IMAGE_DOS_HEADER *_Memory_00;
  IMAGE_DOS_HEADER *pIVar15;
  int iVar16;
  uint local_res8;
  uint local_res18 [2];
  int local_res20;
  uint local_64;
  IMAGE_DOS_HEADER *local_60;
  undefined8 *local_58 [3];
  
  pIVar13 = (IMAGE_DOS_HEADER *)0x0;
  pIVar15 = (IMAGE_DOS_HEADER *)0x0;
  local_64 = 0;
  bVar2 = false;
  _Memory_00 = (IMAGE_DOS_HEADER *)0x0;
  local_res18[0] = 0;
  local_60 = (IMAGE_DOS_HEADER *)0x0;
  local_58[0] = (undefined8 *)0x0;
  FUN_180004440(3,"992001==>",param_3,param_4);
  if (param_1 == (undefined8 *)0x0) {
    return 0xfffffc11;
  }
  if (DAT_18004ad5c != 0x1b5b) {
    return 0xfffffc02;
  }
  local_res8 = 0xffffffff;
  uVar14 = 0x68;
  if ((undefined8 *)*param_1 == (undefined8 *)0x0) {
    FUN_180004440(1,"992002==>NULL",param_3,param_4);
    uVar5 = 0xffffffff;
    uVar14 = 0xfffffc05;
    _Memory_00 = pIVar13;
    pIVar15 = pIVar13;
    uVar11 = 0xffffffff;
  }
  else {
    uVar11 = 0xffffffff;
    if (*(uint *)((longlong)param_1 + 0x2c) + 1 < 6) {
      pIVar12 = (IMAGE_DOS_HEADER *)(ulonglong)*(uint *)(param_1 + 1);
      local_res20 = DAT_18004e164;
      uVar5 = FUN_180006f30((uint **)&local_60,(undefined8 *)*param_1,(ulonglong)pIVar12,param_4);
      _Memory_00 = local_60;
      if (uVar5 == 0) {
        piVar7 = DAT_18004cfd8;
        if ((DAT_18004cfc6 != '\0') &&
           (piVar7 = FUN_18000e240((int *)local_60), DAT_18004cfd8 != (int *)0x0)) {
          FUN_18000ddf0(DAT_18004cfd8,(int *)_Memory_00,(int *)local_res18);
          pIVar12 = (IMAGE_DOS_HEADER *)(ulonglong)local_res18[0];
          FUN_180004440(3,"992004==>%d",pIVar12,param_4);
          _Memory = DAT_18004cfd8;
          if (DAT_18004cfd8 != (int *)0x0) {
            free(*(void **)(DAT_18004cfd8 + 4));
            free(_Memory);
          }
        }
        DAT_18004cfd8 = piVar7;
        lVar8 = (longlong)local_res20;
        lVar10 = 0;
        pIVar4 = pIVar13;
        uVar11 = 0xffffffff;
        if (0 < lVar8) {
          do {
            pIVar15 = pIVar4;
            local_res18[0] = 0;
            uVar11 = *(uint *)((longlong)&DAT_18004b200 + lVar10 * 4);
            lVar1 = (longlong)(int)uVar11 * 0x18;
            local_60 = *(IMAGE_DOS_HEADER **)
                        ((longlong)&DAT_18004e170 + (longlong)(int)uVar11 * 0x18);
            iVar16 = (int)pIVar13;
            if (local_60 == (IMAGE_DOS_HEADER *)0x0) {
              uVar9 = 1;
              FUN_180004440(1,"992005==>Fail",pIVar12,param_4);
              pIVar13 = pIVar12;
            }
            else {
              uVar6 = *(uint *)((longlong)param_1 + 0x2c);
              param_4 = (ulonglong)uVar6;
              if ((uVar6 == 0xffffffff) || (uVar6 == uVar11)) {
                if ((&DAT_18004e178)[lVar1] == '\0') {
                  FUN_180012b50(DAT_18004e1fc);
                }
                else {
                  FUN_180012b50(DAT_18004e1fc + 0x80);
                  DAT_18004e1f8 = *(undefined2 *)(DAT_18004cfd0 + 0x84);
                }
                pIVar13 = (IMAGE_DOS_HEADER *)local_res18;
                uVar6 = FUN_180006250((int *)_Memory_00,(uint *)local_60,(undefined4 *)pIVar13,
                                      param_4);
                lVar3 = DAT_18004cfd0;
                if (local_res18[0] != 0) {
                  bVar2 = true;
                }
                if (*(int *)(DAT_18004cfd0 + 0x54) <= (int)uVar6) {
                  pIVar13 = &IMAGE_DOS_HEADER_180000000;
                  local_res8 = uVar11;
                  if ((&DAT_18004e178)[lVar1] == '\0') {
                    (&DAT_18004e178)[lVar1] = 0;
                  }
                  else {
                    (&DAT_18004e178)[lVar1] = (&DAT_18004e178)[lVar1] + -1;
                  }
                }
                uVar11 = *(int *)(lVar3 + 0x54) * 3;
                uVar9 = (ulonglong)uVar11;
                if ((int)pIVar15 < (int)uVar6) {
                  pIVar15 = (IMAGE_DOS_HEADER *)(ulonglong)uVar6;
                }
                if (SBORROW4(uVar6,uVar11) == (int)(uVar6 + *(int *)(lVar3 + 0x54) * -3) < 0) break;
              }
              else {
                uVar9 = 3;
                FUN_180004440(3,"992009==>%d %d",pIVar13,param_4);
              }
            }
            lVar10 = lVar10 + 1;
            pIVar12 = pIVar13;
            pIVar4 = pIVar15;
            pIVar13 = (IMAGE_DOS_HEADER *)(ulonglong)(iVar16 + 1);
          } while (lVar10 < lVar8);
          uVar14 = 0x68;
          uVar11 = local_res8;
          if (local_res8 != 0xffffffff) {
            uVar14 = 0;
            FUN_180004bc0(uVar9,local_res20,(ulonglong)local_res8,param_4);
          }
        }
      }
      else {
        FUN_180004440(1,"992003==>%d, Fail",(ulonglong)uVar5,param_4);
        _Memory_00 = local_60;
      }
    }
    else {
      FUN_180004440(1,"992003==>%d",(ulonglong)*(uint *)((longlong)param_1 + 0x2c),param_4);
      uVar5 = 0xffffffff;
      uVar14 = 0xfffffbfb;
    }
  }
  *(uint *)(param_1 + 4) = uVar11;
  *(uint *)((longlong)param_1 + 0x24) = (uint)bVar2;
  *(int *)((longlong)param_1 + 0x1c) = (int)pIVar15;
  FUN_180004440(3,"992006==>%d %d",(ulonglong)uVar11,pIVar15);
  if (_Memory_00 != (IMAGE_DOS_HEADER *)0x0) {
    free(*(void **)&_Memory_00->e_sp);
    free(_Memory_00);
  }
  if ((bVar2) && (uVar11 != 0xffffffff)) {
    pIVar15 = (IMAGE_DOS_HEADER *)(&DAT_18004e178 + (longlong)(int)uVar11 * 0x18);
    uVar9 = FUN_180007070(*(int **)((longlong)&DAT_18004e170 + (longlong)(int)uVar11 * 0x18),
                          (char **)local_58,&local_64,(byte *)pIVar15);
    uVar11 = local_64;
    uVar5 = (uint)uVar9;
    if (uVar5 != 0) {
      FUN_180004440(1,"992007==>%d ,Fail",uVar9 & 0xffffffff,pIVar15);
      if (local_58[0] != (undefined8 *)0x0) {
        free(local_58[0]);
      }
      *(undefined4 *)((longlong)param_1 + 0x24) = 0;
      *(undefined4 *)(param_1 + 4) = 0xffffffff;
      param_1[3] = 0;
      FUN_180004440(3,"9920FE==>%d",uVar14,pIVar15);
      return uVar14;
    }
    uVar9 = SEXT48((int)local_64);
    FUN_180004440(3,"992008==>%d",(ulonglong)local_64,pIVar15);
    FUN_18001d320((undefined8 *)param_1[2],local_58[0],uVar9);
    *(uint *)(param_1 + 3) = uVar11;
    free(local_58[0]);
  }
  FUN_180004440(3,"9920FF==>%d",uVar14,pIVar15);
  if (uVar5 != 0) {
    uVar14 = (ulonglong)uVar5;
  }
  return uVar14;
}



void * FUN_180006960(char *param_1,uint *param_2,ulonglong param_3,undefined *param_4)

{
  int *piVar1;
  ulonglong uVar2;
  uint *puVar3;
  
  FUN_180004440(3,"992201==>",param_3,param_4);
  if (DAT_18004cfe0 != (void *)0x0) {
    return DAT_18004cfe0;
  }
  if ((((param_1 != (char *)0x0) && (param_2 != (uint *)0x0)) && (DAT_18004ad5c == 0x1b5a)) &&
     ((*param_1 == 'R' && (param_1[1] == 'D')))) {
    if (*(longlong *)(*(longlong *)(param_1 + 0x18) + 0x80) != 0) {
      FUN_180004440(3,"992202==>",param_3,param_4);
      if (*(void **)(*(longlong *)(param_1 + 0x18) + 0x80) != (void *)0x0) {
        free(*(void **)(*(longlong *)(param_1 + 0x18) + 0x80));
      }
      *(undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x80) = 0;
    }
    piVar1 = FUN_18000c000(*(void **)(param_1 + 0x18));
    if (piVar1 == (int *)0x0) {
      FUN_180004440(1,"992202==>Fail",param_3,param_4);
    }
    else {
      param_4 = &DAT_18004e1e0;
      puVar3 = param_2;
      uVar2 = FUN_180007070(piVar1,(char **)&DAT_18004cfe0,param_2,&DAT_18004e1e0);
      if ((int)uVar2 == 0) {
        FUN_18000e4c0(piVar1);
        *(undefined4 *)(param_1 + 8) = 1;
        FUN_180004440(3,"9922FF==>",puVar3,param_4);
        return DAT_18004cfe0;
      }
      param_3 = uVar2 & 0xffffffff;
      FUN_180004440(1,"992203==>Fail %d",param_3,param_4);
    }
    if (DAT_18004cfe0 != (void *)0x0) {
      free(DAT_18004cfe0);
      DAT_18004cfe0 = (void *)0x0;
    }
    if (piVar1 != (int *)0x0) {
      FUN_18000e4c0(piVar1);
    }
    *param_2 = 0;
    FUN_180004440(3,"9922FE==>NULL",param_3,param_4);
    return (void *)0x0;
  }
  return (void *)0x0;
}



undefined8
FUN_180006af0(undefined8 *param_1,int param_2,ulonglong param_3,uint **param_4,uint *param_5,
             longlong param_6)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  longlong *_Memory;
  undefined8 uVar4;
  undefined8 *_Memory_00;
  uint *_Memory_01;
  ulonglong uVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  uint **ppuVar8;
  uint *local_res8;
  
  uVar7 = param_3 & 0xffffffff;
  local_res8 = (uint *)0x0;
  ppuVar8 = param_4;
  FUN_180004440(3,"992301==>",param_3,param_4);
  puVar1 = param_5;
  if ((((param_1 == (undefined8 *)0x0) || (param_4 == (uint **)0x0)) || (param_5 == (uint *)0x0)) ||
     (param_6 == 0)) {
    uVar4 = 0xfffffc11;
  }
  else {
    uVar2 = (uint)uVar7;
    _Memory = (longlong *)FUN_180007180(param_2,uVar2);
    if (_Memory == (longlong *)0x0) {
      uVar4 = 0xfffffc18;
    }
    else {
      uVar5 = SEXT48((int)(param_2 * uVar2));
      FUN_18001d320((undefined8 *)*_Memory,param_1,uVar5);
      if (DAT_18004cfd0 == (int *)0x0) {
        iVar3 = -0x3ea;
        _Memory_01 = (uint *)0x0;
        uVar7 = uVar5;
      }
      else {
        ppuVar8 = &local_res8;
        uVar4 = FUN_180015cf0(_Memory,param_2,uVar2,(int **)ppuVar8,DAT_18004cfd0);
        iVar3 = (int)uVar4;
        _Memory_01 = local_res8;
      }
      free(_Memory);
      if (iVar3 == 0) {
        if (_Memory_01 != (uint *)0x0) {
          uVar2 = FUN_18000e540(_Memory_01);
          _Memory_00 = (undefined8 *)malloc((longlong)(int)(uVar2 + 8));
          if ((_Memory_00 != (undefined8 *)0x0) &&
             (iVar3 = FUN_18000e700(_Memory_01,(undefined2 *)_Memory_00), -1 < iVar3)) {
            free(*(void **)(_Memory_01 + 4));
            free(_Memory_01);
            if ((int)*puVar1 < (int)uVar2) {
              FUN_180004440(1,"992304=>Fail!",uVar7,ppuVar8);
              *puVar1 = 0;
              free(_Memory_00);
              return 0xfffffbfc;
            }
            *puVar1 = uVar2;
            if (uVar2 - 1 < 0xa000) {
              uVar6 = 0;
              uVar4 = FUN_180004950(_Memory_00,puVar1,0,ppuVar8);
              if ((int)uVar4 != 0) {
                FUN_180004440(1,"992306==>Fail",uVar6,ppuVar8);
                free(_Memory_00);
                *puVar1 = 0;
                return 0xfffffc0f;
              }
              uVar7 = SEXT48((int)*puVar1);
              FUN_18001d320(param_4,_Memory_00,uVar7);
              free(_Memory_00);
              FUN_180004440(3,"9923FF==>",uVar7,ppuVar8);
              return 0;
            }
            FUN_180004440(3,"992305==>Fail",uVar7,ppuVar8);
            *puVar1 = 0;
            free(_Memory_00);
            return 0xfffffc10;
          }
        }
        FUN_180004440(1,"992303==>Fail",uVar7,ppuVar8);
        *puVar1 = 0;
        uVar4 = 0xfffffc0e;
      }
      else {
        FUN_180004440(1,"992302==>Fail",uVar7,ppuVar8);
        uVar4 = 0xfffffc05;
      }
    }
  }
  return uVar4;
}



uint FUN_180006d40(uint **param_1,undefined8 *param_2,ulonglong param_3,byte *param_4)

{
  ushort uVar1;
  uint uVar2;
  undefined8 *_Memory;
  ulonglong uVar3;
  uint *puVar4;
  size_t _Size;
  byte *pbVar5;
  int local_res18 [2];
  
  local_res18[0] = (int)param_3;
  _Size = SEXT48(local_res18[0]);
  uVar3 = param_3;
  pbVar5 = param_4;
  FUN_180004440(3,"994101==>",param_3,param_4);
  FUN_180004440(3,"994001==>",uVar3,pbVar5);
  _Memory = (undefined8 *)malloc(_Size);
  if (_Memory == (undefined8 *)0x0) {
    uVar2 = 0xfffffc0f;
    FUN_180004440(1,"994102==>Fail %d",0xfffffc0f,pbVar5);
  }
  else {
    FUN_180004440(3,"994002==>%d",param_3 & 0xffffffff,pbVar5);
    FUN_18001d320(_Memory,param_2,_Size);
    FUN_180004440(3,"9940FF==>",_Size,pbVar5);
    FUN_180004440(3,"990401==>",_Size,pbVar5);
    uVar3 = FUN_180004aa0(_Memory,local_res18,1,pbVar5);
    uVar2 = (uint)uVar3;
    if (uVar2 == 0) {
      uVar1 = *(ushort *)((longlong)_Memory + 2);
      uVar3 = (ulonglong)uVar1;
      if (uVar1 - 1 < 0x28) {
        puVar4 = (uint *)FUN_18000e2e0((uint)uVar1);
        *param_1 = puVar4;
        uVar2 = FUN_180005f70((longlong)_Memory,local_res18[0]);
        if (uVar2 == 0) {
          uVar3 = FUN_180004560((longlong)_Memory,param_4,uVar3,pbVar5);
          FUN_180004440(3,"994106==>%d",(ulonglong)*param_4,pbVar5);
          uVar2 = (uint)(uVar3 & 0xffffffff);
          if (uVar2 == 0) {
            uVar2 = FUN_18000ed10(*param_1,(char *)_Memory);
            if (uVar2 != 0) {
              FUN_180004440(1,"994108==>Fail %d",(ulonglong)uVar2,pbVar5);
            }
          }
          else {
            FUN_180004440(1,"994107==>Fail %d",uVar3 & 0xffffffff,pbVar5);
          }
        }
        else {
          FUN_180004440(1,"994105==>Fail %d",(ulonglong)uVar2,pbVar5);
        }
      }
      else {
        FUN_180004440(1,"994104==>Fail %d",uVar3,pbVar5);
        uVar2 = 0xfffffc17;
      }
    }
    else {
      FUN_180004440(1,"994103==>Fail %d",uVar3 & 0xffffffff,pbVar5);
    }
    free(_Memory);
  }
  FUN_180004440(3,"9941FF==>%d",(ulonglong)uVar2,pbVar5);
  return uVar2;
}



uint FUN_180006f30(uint **param_1,undefined8 *param_2,ulonglong param_3,undefined8 param_4)

{
  uint uVar1;
  int iVar2;
  undefined8 *_Memory;
  ulonglong uVar3;
  uint *puVar4;
  size_t _Size;
  undefined8 uVar5;
  int local_res18 [4];
  
  local_res18[0] = (int)param_3;
  _Size = SEXT48(local_res18[0]);
  uVar3 = param_3;
  FUN_180004440(3,"994201==>",param_3,param_4);
  FUN_180004440(3,"994001==>",uVar3,param_4);
  _Memory = (undefined8 *)malloc(_Size);
  if (_Memory == (undefined8 *)0x0) {
    uVar1 = 0xfffffc0f;
    FUN_180004440(1,"994202==>Fail %d",0xfffffc0f,param_4);
  }
  else {
    FUN_180004440(3,"994002==>%d",param_3 & 0xffffffff,param_4);
    FUN_18001d320(_Memory,param_2,_Size);
    FUN_180004440(3,"9940FF==>",_Size,param_4);
    FUN_180004440(3,"990401==>",_Size,param_4);
    uVar5 = 0;
    uVar3 = FUN_180004aa0(_Memory,local_res18,0,param_4);
    uVar1 = (uint)uVar3;
    if (uVar1 == 0) {
      puVar4 = (uint *)FUN_18000e090((uint)*(ushort *)((longlong)_Memory + 2));
      *param_1 = puVar4;
      iVar2 = FUN_18000e7e0(puVar4,(char *)_Memory);
      if (iVar2 < 0) {
        FUN_180004440(1,"994204==>Fail",uVar5,param_4);
        uVar1 = 0xfffffbfd;
      }
    }
    else {
      FUN_180004440(1,"994203==>Fail %d",uVar3 & 0xffffffff,param_4);
    }
    free(_Memory);
  }
  FUN_180004440(3,"9942FF==>%d",(ulonglong)uVar1,param_4);
  return uVar1;
}



ulonglong FUN_180007070(int *param_1,char **param_2,uint *param_3,byte *param_4)

{
  uint uVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined8 uVar4;
  byte *pbVar5;
  
  pbVar5 = param_4;
  FUN_180004440(3,"994301==>",param_3,param_4);
  uVar1 = FUN_180005e70(param_1,param_2,(int *)param_3);
  uVar3 = (ulonglong)uVar1;
  if (uVar1 == 0) {
    uVar1 = *param_3;
    if (uVar1 < 0x3c001) {
      uVar2 = FUN_1800044d0(*param_2,*param_4,(ulonglong)uVar1,pbVar5);
      uVar3 = uVar2 & 0xffffffff;
      if ((int)uVar2 == 0) {
        uVar4 = 1;
        uVar2 = FUN_180004950((undefined8 *)*param_2,param_3,1,pbVar5);
        uVar3 = uVar2 & 0xffffffff;
        if ((int)uVar2 == 0) {
          FUN_180004440(3,"9943FF==>",uVar4,pbVar5);
          uVar3 = 0;
        }
        else {
          FUN_180004440(1,"994305==>%d, Fail",uVar2 & 0xffffffff,pbVar5);
        }
      }
      else {
        FUN_180004440(1,"994304==>%d, Fail",uVar2 & 0xffffffff,pbVar5);
      }
    }
    else {
      FUN_180004440(1,"994303==>%d, Fail",(ulonglong)uVar1,pbVar5);
      uVar3 = 0xfffffc10;
    }
  }
  else {
    FUN_180004440(1,"994302==>%d, Fail",(ulonglong)uVar1,pbVar5);
  }
  return uVar3;
}



void * FUN_180007180(int param_1,int param_2)

{
  void *pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = malloc((longlong)(param_1 * param_2 + param_2 * 8));
  if (pvVar1 != (void *)0x0) {
    lVar2 = 0;
    lVar3 = (longlong)pvVar1 + (longlong)(param_2 * 8);
    if (0 < param_2) {
      do {
        *(longlong *)((longlong)pvVar1 + lVar2 * 8) = lVar3;
        lVar2 = lVar2 + 1;
        lVar3 = lVar3 + param_1;
      } while (lVar2 < param_2);
    }
    return pvVar1;
  }
  return (void *)0x0;
}



void FUN_180007210(int param_1,int param_2,longlong param_3,int param_4)

{
  int iVar1;
  longlong lVar2;
  void *_Memory;
  int *_Memory_00;
  void *pvVar3;
  longlong lVar4;
  longlong lVar5;
  size_t _Count;
  longlong lVar6;
  int iVar7;
  longlong lVar8;
  longlong *plVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  int *piVar14;
  longlong lVar15;
  int iVar16;
  
  lVar2 = (longlong)param_2;
  _Count = SEXT48(param_1);
  iVar16 = param_4 * 2 + 1;
  iVar1 = param_2;
  if (iVar16 < param_2) {
    iVar1 = iVar16;
  }
  iVar7 = 0;
  _Memory = malloc(lVar2 * 8);
  _Memory_00 = (int *)calloc(_Count,4);
  lVar8 = 0;
  if (0 < (longlong)iVar1) {
    do {
      pvVar3 = malloc(_Count);
      lVar8 = lVar8 + 1;
      *(void **)((longlong)_Memory + lVar8 * 8 + -8) = pvVar3;
    } while (lVar8 < iVar1);
  }
  lVar8 = (longlong)-param_4;
  if (lVar8 < lVar2) {
    lVar11 = (longlong)-iVar16;
    plVar9 = (longlong *)(lVar11 * 8 + (longlong)_Memory);
    lVar6 = lVar8;
    do {
      lVar12 = (lVar11 - lVar8) + lVar6;
      if (-1 < lVar12) {
        lVar15 = *plVar9;
        lVar4 = 0;
        if (0 < (longlong)_Count) {
          do {
            lVar5 = lVar4 + 1;
            _Memory_00[lVar4] = _Memory_00[lVar4] - (uint)*(byte *)(lVar4 + lVar15);
            lVar4 = lVar5;
          } while (lVar5 < (longlong)_Count);
        }
        iVar7 = iVar7 + -1;
      }
      if (lVar6 - lVar8 < lVar2) {
        if (-1 < lVar12) {
          plVar9[-lVar11] = *plVar9;
        }
        FUN_18001d320((undefined8 *)plVar9[-lVar11],
                      *(undefined8 **)
                       (((param_3 + lVar11 * -8) - (longlong)_Memory) + (longlong)plVar9),_Count);
        lVar12 = plVar9[-lVar11];
        lVar15 = 0;
        if (0 < (longlong)_Count) {
          do {
            lVar4 = lVar15 + 1;
            _Memory_00[lVar15] = _Memory_00[lVar15] + (uint)*(byte *)(lVar15 + lVar12);
            lVar15 = lVar4;
          } while (lVar4 < (longlong)_Count);
        }
        iVar7 = iVar7 + 1;
      }
      if (-1 < lVar6) {
        lVar12 = *(longlong *)
                  (((lVar8 - lVar11) * 8 - (longlong)_Memory) + param_3 + (longlong)plVar9);
        iVar10 = 0;
        lVar15 = -(longlong)param_4;
        iVar13 = 0;
        if (lVar15 < (longlong)_Count) {
          lVar4 = 0;
          piVar14 = _Memory_00;
          do {
            if (-1 < lVar4 - iVar16) {
              iVar10 = iVar10 - piVar14[-(longlong)iVar16];
              iVar13 = iVar13 - iVar7;
            }
            if (lVar4 < (longlong)_Count) {
              iVar10 = iVar10 + *piVar14;
              iVar13 = iVar13 + iVar7;
            }
            if (-1 < lVar4 + lVar15) {
              *(char *)((lVar12 - param_4) + lVar4) = (char)(iVar10 / iVar13);
            }
            lVar4 = lVar4 + 1;
            piVar14 = piVar14 + 1;
          } while (lVar4 + lVar15 < (longlong)_Count);
        }
      }
      lVar6 = lVar6 + 1;
      plVar9 = plVar9 + 1;
    } while (lVar6 < lVar2);
  }
  for (lVar8 = (longlong)(param_2 - iVar1); lVar8 < lVar2; lVar8 = lVar8 + 1) {
    free(*(void **)((longlong)_Memory + lVar8 * 8));
  }
  free(_Memory);
  free(_Memory_00);
  return;
}



void FUN_1800074c0(int param_1,int param_2,longlong param_3,longlong param_4)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  byte bVar4;
  int iVar5;
  void *_Memory;
  int *_Memory_00;
  void *pvVar6;
  byte *pbVar7;
  byte bVar8;
  int *piVar9;
  size_t _Count;
  longlong lVar10;
  int iVar11;
  longlong lVar12;
  uint uVar13;
  byte bVar14;
  size_t sVar15;
  int iVar16;
  longlong lVar17;
  longlong lVar18;
  longlong *plVar19;
  int iVar20;
  longlong local_70;
  
  lVar18 = (longlong)param_2;
  _Count = SEXT48(param_1);
  iVar11 = param_2;
  if (0x11 < param_2) {
    iVar11 = 0x11;
  }
  iVar20 = 0;
  _Memory = malloc(lVar18 * 8);
  _Memory_00 = (int *)calloc(_Count,4);
  lVar10 = 0;
  if (0 < (longlong)iVar11) {
    do {
      pvVar6 = malloc(_Count);
      lVar10 = lVar10 + 1;
      *(void **)((longlong)_Memory + lVar10 * 8 + -8) = pvVar6;
    } while (lVar10 < iVar11);
  }
  if (-8 < lVar18) {
    plVar19 = (longlong *)((longlong)_Memory + -0x88);
    local_70 = -8;
    lVar10 = param_3 - (longlong)_Memory;
    do {
      if (-1 < local_70 + -9) {
        pbVar7 = *(byte **)(lVar10 + (longlong)plVar19);
        if (0 < (longlong)_Count) {
          lVar17 = *plVar19 - (longlong)pbVar7;
          piVar9 = _Memory_00;
          sVar15 = _Count;
          do {
            iVar5 = (uint)pbVar7[lVar17] - (uint)*pbVar7;
            if (iVar5 < 0) {
              iVar5 = (uint)*pbVar7 - (uint)pbVar7[lVar17];
            }
            *piVar9 = *piVar9 - iVar5;
            piVar9 = piVar9 + 1;
            pbVar7 = pbVar7 + 1;
            sVar15 = sVar15 - 1;
          } while (sVar15 != 0);
        }
        iVar20 = iVar20 + -1;
      }
      if (local_70 + 8 < lVar18) {
        if (-1 < local_70 + -9) {
          plVar19[0x11] = *plVar19;
        }
        FUN_18001d320((undefined8 *)plVar19[0x11],
                      *(undefined8 **)((param_4 - (longlong)_Memory) + 0x88 + (longlong)plVar19),
                      _Count);
        pbVar7 = *(byte **)(lVar10 + 0x88 + (longlong)plVar19);
        if (0 < (longlong)_Count) {
          lVar17 = plVar19[0x11] - (longlong)pbVar7;
          piVar9 = _Memory_00;
          sVar15 = _Count;
          do {
            iVar5 = (uint)pbVar7[lVar17] - (uint)*pbVar7;
            if (iVar5 < 0) {
              iVar5 = (uint)*pbVar7 - (uint)pbVar7[lVar17];
            }
            *piVar9 = *piVar9 + iVar5;
            piVar9 = piVar9 + 1;
            pbVar7 = pbVar7 + 1;
            sVar15 = sVar15 - 1;
          } while (sVar15 != 0);
        }
        iVar20 = iVar20 + 1;
      }
      if (-1 < local_70) {
        lVar17 = *(longlong *)(lVar10 + 0x48 + (longlong)plVar19);
        lVar2 = plVar19[9];
        lVar3 = *(longlong *)((param_4 - (longlong)_Memory) + 0x48 + (longlong)plVar19);
        iVar16 = 0;
        iVar5 = 0;
        if (-8 < (longlong)_Count) {
          piVar9 = _Memory_00;
          lVar12 = 0;
          do {
            if (-1 < lVar12 + -0x11) {
              iVar16 = iVar16 - piVar9[-0x11];
              iVar5 = iVar5 - iVar20;
            }
            if (lVar12 < (longlong)_Count) {
              iVar16 = iVar16 + *piVar9;
              iVar5 = iVar5 + iVar20;
            }
            if (-1 < lVar12 + -8) {
              bVar4 = (byte)((longlong)iVar16 / (longlong)iVar5);
              bVar8 = *(byte *)(lVar12 + lVar2 + -8);
              if (bVar8 < bVar4) {
                uVar13 = 0;
              }
              else {
                uVar13 = (uint)(byte)(bVar8 - bVar4);
              }
              if ((int)(0xff - ((uint)((longlong)iVar16 / (longlong)iVar5) & 0xff)) <
                  (int)(uint)bVar8) {
                bVar8 = 0xff;
              }
              else {
                bVar8 = bVar8 + bVar4;
              }
              bVar4 = *(byte *)(lVar12 + lVar17 + -8);
              bVar14 = bVar8 - (byte)uVar13;
              if (bVar14 != 0) {
                if ((byte)uVar13 < bVar4) {
                  if (bVar4 < bVar8) {
                    bVar4 = (byte)((int)((bVar4 - uVar13) * 0xff) / (int)(uint)bVar14);
                  }
                  else {
                    bVar4 = 0xff;
                  }
                }
                else {
                  bVar4 = 0;
                }
              }
              *(byte *)(lVar12 + lVar3 + -8) = bVar4;
            }
            piVar9 = piVar9 + 1;
            lVar1 = lVar12 + -7;
            lVar12 = lVar12 + 1;
          } while (lVar1 < (longlong)_Count);
        }
      }
      local_70 = local_70 + 1;
      plVar19 = plVar19 + 1;
    } while (local_70 < lVar18);
  }
  for (lVar10 = (longlong)(param_2 - iVar11); lVar10 < lVar18; lVar10 = lVar10 + 1) {
    free(*(void **)((longlong)_Memory + lVar10 * 8));
  }
  free(_Memory);
  free(_Memory_00);
  return;
}



void FUN_180007820(byte *param_1,int param_2,int param_3,undefined *param_4,undefined *param_5)

{
  byte bVar1;
  uint uVar2;
  longlong lVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  longlong lVar7;
  uint uVar8;
  int *piVar9;
  ulonglong uVar10;
  undefined auStack1176 [32];
  uint local_478;
  int local_474;
  uint local_470;
  int local_46c;
  int local_468;
  ulonglong local_460;
  undefined *local_458;
  undefined *local_450;
  int local_448 [256];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)auStack1176;
  uVar2 = 0;
  local_450 = param_5;
  local_468 = param_2 * param_3;
  local_470 = 1;
  local_46c = 1;
  uVar6 = 0;
  local_460 = 0;
  local_478 = 0;
  local_474 = 0;
  local_458 = param_4;
  FUN_18001d980((undefined (*) [16])local_448,0,0x400);
  lVar3 = (longlong)local_468;
  uVar5 = uVar2;
  uVar8 = uVar2;
  if (0 < local_468) {
    do {
      bVar1 = *param_1;
      if (bVar1 < 0xf0) {
        uVar8 = uVar8 + bVar1;
        local_448[bVar1] = local_448[bVar1] + 1;
        uVar6 = uVar5;
      }
      else {
        uVar6 = uVar5 + 1;
      }
      param_1 = param_1 + 1;
      lVar3 = lVar3 + -1;
      uVar5 = uVar6;
    } while (lVar3 != 0);
  }
  local_468 = local_468 - uVar6;
  piVar9 = local_448;
  uVar5 = uVar2;
  uVar6 = uVar2;
  do {
    iVar4 = *piVar9;
    if (iVar4 != 0) {
      uVar6 = uVar6 + iVar4;
      uVar5 = uVar5 + iVar4 * uVar2;
      iVar4 = local_468 - uVar6;
      if ((uVar6 != 0) && (iVar4 != 0)) {
        lVar7 = (longlong)(int)uVar5;
        lVar3 = (longlong)(int)(uVar8 - uVar5);
        uVar10 = (ulonglong)(lVar7 * lVar7 * (longlong)iVar4) / (ulonglong)(longlong)(int)uVar6 +
                 (ulonglong)((int)uVar6 * lVar3 * lVar3) / (ulonglong)(longlong)iVar4 +
                 lVar7 * lVar3 * -2;
        if (local_460 < uVar10) {
          local_478 = uVar5;
          local_474 = uVar8 - uVar5;
          local_470 = uVar6;
          local_46c = iVar4;
          local_460 = uVar10;
        }
      }
    }
    uVar2 = uVar2 + 1;
    piVar9 = piVar9 + 1;
  } while (uVar2 < 0x100);
  if (local_458 != (undefined *)0x0) {
    *local_458 = (char)(local_474 / local_46c);
  }
  if (local_450 != (undefined *)0x0) {
    *local_450 = (char)((int)local_478 / (int)local_470);
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)auStack1176);
  return;
}



void FUN_1800079f0(byte *param_1,int param_2,int param_3)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  ulonglong uVar7;
  int iVar8;
  int *piVar9;
  longlong lVar10;
  int iVar11;
  ulonglong uVar12;
  int iVar13;
  undefined auStack1112 [32];
  int local_438 [256];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)auStack1112;
  iVar13 = 0;
  iVar11 = param_2 * param_3;
  uVar12 = 0;
  iVar6 = 0;
  iVar5 = 0;
  iVar8 = 0;
  FUN_18001d980((undefined (*) [16])local_438,0,0x400);
  lVar4 = (longlong)iVar11;
  if (0 < iVar11) {
    do {
      bVar1 = *param_1;
      if (bVar1 < 0xf0) {
        iVar13 = iVar13 + (uint)bVar1;
        local_438[bVar1] = local_438[bVar1] + 1;
      }
      else {
        iVar6 = iVar6 + 1;
      }
      param_1 = param_1 + 1;
      lVar4 = lVar4 + -1;
    } while (lVar4 != 0);
  }
  uVar3 = 0;
  piVar9 = local_438;
  do {
    iVar2 = *piVar9;
    if (iVar2 != 0) {
      iVar5 = iVar5 + iVar2;
      iVar8 = iVar8 + iVar2 * uVar3;
      iVar2 = (iVar11 - iVar6) - iVar5;
      if ((iVar5 != 0) && (iVar2 != 0)) {
        lVar4 = (longlong)(iVar13 - iVar8);
        lVar10 = (longlong)iVar8;
        uVar7 = (ulonglong)(lVar10 * lVar10 * (longlong)iVar2) / (ulonglong)(longlong)iVar5 +
                (ulonglong)(iVar5 * lVar4 * lVar4) / (ulonglong)(longlong)iVar2 +
                lVar10 * lVar4 * -2;
        if (uVar12 < uVar7) {
          uVar12 = uVar7;
        }
      }
    }
    uVar3 = uVar3 + 1;
    piVar9 = piVar9 + 1;
  } while (uVar3 < 0x100);
  FUN_18001d2f0(local_38 ^ (ulonglong)auStack1112);
  return;
}



undefined8 FUN_180007b30(byte *param_1,int param_2,int param_3,byte param_4,byte param_5)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  uint uVar7;
  byte local_res20 [8];
  
  local_res20[0] = param_4;
  bVar2 = FUN_180007820(param_1,param_2,param_3,&param_5,local_res20);
  if ((((local_res20[0] != 0) && (param_5 != 0)) && (bVar2 != local_res20[0])) && (param_5 != bVar2)
     ) {
    uVar7 = (uint)bVar2;
    iVar5 = uVar7 - local_res20[0];
    bVar3 = (char)((iVar5 * 0x96) / (int)((uint)param_5 - (uint)local_res20[0])) + 0x46;
    lVar6 = (longlong)(param_2 * param_3);
    if (0 < param_2 * param_3) {
      do {
        bVar1 = *param_1;
        if (bVar1 < bVar2) {
          iVar4 = (uVar7 - bVar1) * ((int)((bVar3 - 0x46) * 0x10) / iVar5);
          iVar4 = (uint)bVar3 - ((int)((iVar4 >> 0x1f & 0xfU) + iVar4) >> 4);
        }
        else {
          iVar4 = (bVar1 - uVar7) *
                  ((int)((0xdc - (uint)bVar3) * 0x10) / (int)((uint)param_5 - (uint)bVar2));
          iVar4 = ((int)(iVar4 + (iVar4 >> 0x1f & 0xfU)) >> 4) + (uint)bVar3;
        }
        if (iVar4 < 0) {
          iVar4 = 0;
        }
        else {
          if (0xff < iVar4) {
            iVar4 = 0xff;
          }
        }
        *param_1 = (byte)iVar4;
        param_1 = param_1 + 1;
        lVar6 = lVar6 + -1;
      } while (lVar6 != 0);
    }
    return 1;
  }
  return 0;
}



void FUN_180007c60(byte **param_1,int param_2,int param_3,int *param_4,int *param_5)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  int iVar5;
  ulonglong uVar6;
  byte *pbVar7;
  longlong lVar8;
  byte *pbVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  longlong lVar13;
  
  iVar11 = 0;
  iVar5 = 0;
  iVar12 = 0;
  bVar1 = FUN_1800079f0(*param_1,param_2,param_3);
  lVar13 = 0;
  if (-1 < param_3 + -0xc) {
    do {
      pbVar7 = param_1[lVar13];
      if (-1 < param_2 + -0xc) {
        uVar6 = (ulonglong)(param_2 - 6) / 6;
        iVar11 = iVar11 + (int)uVar6;
        do {
          iVar2 = 0;
          iVar3 = 0;
          lVar10 = 0xc;
          pbVar9 = pbVar7;
          do {
            pbVar4 = pbVar9 + 1;
            lVar8 = 2;
            do {
              if (pbVar4[-1] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (*pbVar4 < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[1] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[2] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[3] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              if (pbVar4[4] < bVar1) {
                iVar2 = iVar2 + 1;
              }
              else {
                iVar3 = iVar3 + 1;
              }
              pbVar4 = pbVar4 + 6;
              lVar8 = lVar8 + -1;
            } while (lVar8 != 0);
            pbVar9 = pbVar9 + param_2;
            lVar10 = lVar10 + -1;
          } while (lVar10 != 0);
          if (iVar2 < 0x87) {
            if (0x86 < iVar3) {
              iVar12 = iVar12 + 1;
            }
          }
          else {
            iVar5 = iVar5 + 1;
          }
          pbVar7 = pbVar7 + 6;
          uVar6 = uVar6 - 1;
        } while (uVar6 != 0);
      }
      lVar13 = lVar13 + 6;
    } while (lVar13 <= param_3 + -0xc);
    if (0 < iVar11) {
      if (param_5 != (int *)0x0) {
        *param_5 = (iVar12 * 100) / iVar11;
      }
      if (param_4 != (int *)0x0) {
        *param_4 = (iVar5 * 100) / iVar11;
      }
    }
  }
  return;
}



ulonglong FUN_180007df0(longlong param_1,int param_2,uint param_3,int param_4)

{
  byte *pbVar1;
  longlong lVar2;
  int iVar3;
  ulonglong uVar4;
  int iVar5;
  uint uVar6;
  longlong lVar7;
  
  lVar7 = (longlong)param_4;
  uVar6 = 0;
  uVar4 = (ulonglong)param_3;
  if (0 < (int)param_3) {
    do {
      iVar3 = 0;
      iVar5 = 0;
      lVar2 = 0;
      if (1 < lVar7) {
        do {
          pbVar1 = (byte *)(param_1 + lVar2);
          lVar2 = lVar2 + 2;
          iVar3 = iVar3 + (uint)*pbVar1;
          iVar5 = iVar5 + (uint)*(byte *)(param_1 + -1 + lVar2);
        } while (lVar2 < lVar7 + -1);
      }
      if (lVar2 < lVar7) {
        uVar6 = uVar6 + *(byte *)(lVar2 + param_1);
      }
      param_1 = param_1 + param_2;
      uVar6 = uVar6 + iVar5 + iVar3;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  return (ulonglong)uVar6 / (ulonglong)(param_3 * param_4);
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180007e90(undefined8 *param_1,uint param_2,uint param_3,int *param_4,int *param_5,
                  undefined4 *param_6,int *param_7,int *param_8,uint *param_9)

{
  bool bVar1;
  undefined8 *puVar2;
  undefined4 *puVar3;
  int *piVar4;
  uint uVar5;
  ulonglong uVar6;
  byte **ppbVar7;
  byte **ppbVar8;
  ulonglong uVar9;
  uint uVar10;
  ulonglong uVar11;
  uint uVar12;
  longlong lVar13;
  byte *pbVar14;
  int iVar15;
  int iVar16;
  ulonglong uVar17;
  longlong lVar18;
  int *in_stack_fffffffffffffd58;
  undefined8 in_stack_fffffffffffffd60;
  uint local_288;
  byte **local_280;
  undefined8 *local_278;
  longlong *local_270;
  byte **local_268;
  int *local_260;
  uint *local_258;
  undefined4 *local_250;
  int *local_248;
  byte **local_240;
  int local_238 [120];
  ulonglong local_58;
  
  local_58 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd38;
  local_250 = param_6;
  local_260 = param_8;
  local_248 = param_7;
  local_258 = param_9;
  local_280 = (byte **)((ulonglong)local_280 & 0xffffffff00000000 | (ulonglong)param_3);
  local_278 = (undefined8 *)FUN_18000fa20(param_2,param_3);
  local_268 = (byte **)FUN_18000fa20(param_2,param_3);
  local_270 = (longlong *)FUN_18000fa20(param_2,param_3);
  uVar9 = 0;
  uVar5 = (int)(param_2 + ((int)param_2 >> 0x1f & 0xfU)) >> 4;
  lVar18 = (longlong)(int)uVar5;
  local_288 = (int)(param_3 + ((int)param_3 >> 0x1f & 0xfU)) >> 4;
  uVar6 = FUN_180007df0((longlong)param_1,param_2,param_3,param_2);
  puVar2 = local_278;
  iVar15 = 0;
  if ((int)uVar6 < 0xf5) {
    FUN_18001d320((undefined8 *)*local_278,param_1,(longlong)(int)(param_3 * param_2));
    FUN_18000fab0(param_2,(int)local_280,(longlong)puVar2);
    ppbVar8 = local_268;
    FUN_18001d320((undefined8 *)*local_268,(undefined8 *)*local_278,
                  (longlong)(int)(param_3 * param_2));
    if ((param_4 != (int *)0x0) && (param_5 != (int *)0x0)) {
      FUN_180007c60(ppbVar8,param_2,(int)local_280,param_4,param_5);
      in_stack_fffffffffffffd58 = param_5;
    }
    FUN_18000fca0(param_2,(int)local_280,(longlong)ppbVar8);
    FUN_18000fe70(param_2,(int)local_280,(longlong)local_278,ppbVar8,in_stack_fffffffffffffd58,
                  in_stack_fffffffffffffd60,(longlong)local_270);
    FUN_18000fab0(param_2,(int)local_280,(longlong)ppbVar8);
    uVar12 = local_288;
    lVar13 = (longlong)(int)local_288;
    ppbVar7 = (byte **)FUN_18000fa20(uVar5,local_288);
    local_280 = ppbVar7;
    ppbVar8 = (byte **)FUN_18000fa20(uVar5,uVar12);
    local_240 = ppbVar8;
    uVar10 = uVar12;
    FUN_180010690(param_2,(int)local_280,(longlong)local_268,uVar5,uVar12,(longlong)ppbVar7,
                  (longlong)ppbVar8);
    FUN_180011040(uVar5,uVar12,(longlong)ppbVar7,(longlong)ppbVar8,uVar10);
    puVar3 = local_250;
    if (local_260 != (int *)0x0) {
      if (0 < lVar13) {
        ppbVar7 = (byte **)((longlong)local_280 - (longlong)ppbVar8);
        uVar6 = uVar9;
        uVar17 = uVar9;
        do {
          if (0 < (int)uVar5) {
            uVar11 = uVar9;
            do {
              if (*(char *)(*(longlong *)((longlong)ppbVar7 + (longlong)ppbVar8) + uVar11) != -1) {
                uVar6 = (ulonglong)((int)uVar6 + (uint)(*ppbVar8)[uVar11]);
                uVar17 = (ulonglong)((int)uVar17 + 1);
              }
              uVar11 = uVar11 + 1;
            } while ((longlong)uVar11 < lVar18);
          }
          ppbVar8 = ppbVar8 + 1;
          lVar13 = lVar13 + -1;
        } while (lVar13 != 0);
        if ((int)uVar17 != 0) {
          iVar15 = (int)uVar6 / (int)uVar17;
        }
      }
      *local_260 = iVar15;
      ppbVar8 = local_240;
      uVar12 = local_288;
    }
    if (local_258 != (uint *)0x0) {
      bVar1 = 0x50 < (*ppbVar8)[lVar18 + -1];
      uVar10 = (uint)bVar1;
      if (0x50 < **ppbVar8) {
        uVar10 = bVar1 + 1;
      }
      if (0x50 < *ppbVar8[(longlong)(int)uVar12 + -1]) {
        uVar10 = uVar10 + 1;
      }
      if (0x50 < ppbVar8[(longlong)(int)uVar12 + -1][lVar18 + -1]) {
        uVar10 = uVar10 + 1;
      }
      *local_258 = uVar10;
    }
    if (local_250 != (undefined4 *)0x0) {
      uVar6 = FUN_1800111d0(local_270,param_2,(int)local_280,(longlong)ppbVar8);
      *puVar3 = (int)uVar6;
    }
    piVar4 = local_248;
    if (local_248 != (int *)0x0) {
      pbVar14 = *local_280;
      iVar15 = 0;
      FUN_18001d980((undefined (*) [16])local_238,0,0x1e0);
      lVar18 = (longlong)(int)(uVar5 * local_288);
      uVar6 = uVar9;
      if (0 < (int)(uVar5 * local_288)) {
        do {
          if (*pbVar14 != 0xff) {
            local_238[*pbVar14] = local_238[*pbVar14] + 1;
            uVar6 = (ulonglong)((int)uVar6 + 1);
          }
          iVar15 = (int)uVar6;
          pbVar14 = pbVar14 + 1;
          lVar18 = lVar18 + -1;
        } while (lVar18 != 0);
      }
      lVar18 = -10;
      lVar13 = 0x82;
      uVar6 = uVar9;
      uVar17 = uVar9;
      do {
        iVar16 = (int)uVar17;
        if (-1 < lVar18) {
          if ((int)uVar6 < iVar16) {
            uVar6 = uVar17;
          }
          iVar16 = iVar16 - local_238[lVar18];
        }
        if (0x77 < (longlong)uVar9) {
          uVar9 = uVar9 - 0x78;
        }
        uVar17 = (ulonglong)(uint)(iVar16 + local_238[uVar9]);
        uVar9 = uVar9 + 1;
        lVar18 = lVar18 + 1;
        lVar13 = lVar13 + -1;
      } while (lVar13 != 0);
      if (iVar15 < 1) {
        *piVar4 = -1;
      }
      else {
        *piVar4 = ((int)uVar6 * 100) / iVar15;
      }
    }
    free(ppbVar8);
    free(local_280);
  }
  else {
    if (param_4 != (int *)0x0) {
      *param_4 = 0;
    }
    if (param_5 != (int *)0x0) {
      *param_5 = 0;
    }
    if (local_250 != (undefined4 *)0x0) {
      *local_250 = 0;
    }
    if (local_248 != (int *)0x0) {
      *local_248 = 0;
    }
    if (local_260 != (int *)0x0) {
      *local_260 = 0;
    }
    if (local_258 != (uint *)0x0) {
      *local_258 = 0;
    }
  }
  free(local_268);
  free(local_270);
  free(local_278);
  FUN_18001d2f0(local_58 ^ (ulonglong)&stack0xfffffffffffffd38);
  return;
}



int FUN_1800082c0(int param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint *puVar9;
  int iVar10;
  uint uVar11;
  
  if (((param_2 != (int *)0x0) && (param_2[1] == 6)) && (*param_2 == 8)) {
    puVar9 = *(uint **)(param_2 + 6);
    uVar1 = *puVar9;
    uVar2 = puVar9[2];
    uVar3 = puVar9[3];
    uVar4 = puVar9[6];
    uVar5 = puVar9[7];
    uVar6 = puVar9[5];
    uVar7 = puVar9[4];
    uVar8 = puVar9[1];
    if (-1 < param_1) {
      uVar11 = uVar1;
      if ((int)uVar2 < 100) {
        uVar11 = (int)(uVar1 * 100) / (int)(100 - uVar2);
      }
      if ((int)(uVar2 + uVar8) < 100) {
        iVar10 = ((int)(uVar3 + ((int)uVar3 >> 0x1f & 0x7fU)) >> 7) * (0x100 - uVar5) * uVar1;
        iVar10 = (((int)(iVar10 + (iVar10 >> 0x1f & 0xffffU)) >> 0x10) * 100) /
                 (int)((100 - uVar2) - uVar8);
      }
      else {
        iVar10 = 0;
      }
      if (param_1 == 0) {
        if (((((0xdf < (int)uVar1) && (0x3e1c < (int)uVar3)) &&
             ((0x87 < (int)uVar6 && (1 < (int)uVar4)))) ||
            (((200 < (int)uVar1 && (0x2e18 < (int)uVar3)) && ((0xab < (int)uVar6 && (uVar4 == 2)))))
            ) || ((((0x10 < iVar10 && (12000 < (int)uVar3)) ||
                   ((0xdc < (int)uVar1 &&
                    ((((9000 < (int)uVar3 && (0x14 < (int)uVar8)) && (0x77 < (int)uVar6)) &&
                     ((int)uVar5 < 0x78)))))) ||
                  (((0xfa < (int)uVar1 && (0x32 < (int)uVar2)) &&
                   ((0x2cec < (int)uVar3 && (0x96 < (int)uVar6)))))))) {
          param_1 = 3;
        }
        if (((((0xcc < (int)uVar1) && (0xe < (int)uVar2)) &&
             ((0x2cec < (int)uVar3 && ((0x50 < (int)uVar7 && (0x99 < (int)uVar6)))))) ||
            (((0x7d < (int)uVar1 &&
              (((0x1b < (int)uVar2 && (0x283c < (int)uVar3)) && ((int)uVar7 < 0x25)))) &&
             ((int)uVar4 < 3)))) ||
           ((((9000 < (int)uVar3 && (uVar7 == 100)) && ((0x77 < (int)uVar6 && ((int)uVar5 < 0xa0))))
            || ((((0xaa < (int)uVar1 && (0x2008 < (int)uVar3)) && (0x19 < (int)uVar2)) &&
                ((0x81 < (int)uVar6 && (uVar4 == 2)))))))) {
          param_1 = 4;
        }
        if ((((100 < (int)uVar1) && (0x32 < (int)uVar2)) && (7000 < (int)uVar3)) &&
           ((0x87 < (int)uVar6 && (uVar4 == 2)))) {
          param_1 = 5;
        }
        if (((iVar10 - 0x1cU < 0x13) && ((int)uVar1 < 0x8c)) && ((int)uVar5 < 0x82)) {
          param_1 = 2;
        }
      }
      else {
        if (param_1 == 2) {
          if (((((0xe8 < (int)uVar1) && (0x31 < (int)uVar8)) && (0x206c < (int)uVar3)) &&
              ((0x8a < (int)uVar6 && (2 < (int)uVar4)))) ||
             (((0xdc < (int)uVar1 && ((15000 < (int)uVar3 && (0x96 < (int)uVar6)))) &&
              (1 < (int)uVar4)))) {
            param_1 = 3;
          }
          if (((((((((0xa1 < (int)uVar11) && (0x1b < (int)uVar2)) && (0x1af4 < (int)uVar3)) &&
                  ((0x6b < (int)uVar6 && (uVar4 == 2)))) && (0x8f < (int)uVar5)) ||
                (((0xac < (int)uVar1 && (0x1d < (int)uVar2)) &&
                 ((10000 < (int)uVar3 && (0x9a < (int)uVar5)))))) ||
               ((((0x94 < (int)uVar1 && (0x36 < (int)uVar2)) && (0x238c < (int)uVar3)) &&
                ((0x7d < (int)uVar6 && (0xd0 < (int)uVar5)))))) ||
              (((0xb4 < (int)uVar1 &&
                (((0xf < (int)uVar2 && (13000 < (int)uVar3)) &&
                 ((200 < (int)uVar6 && ((int)uVar4 < 3)))))) ||
               ((((200 < (int)uVar1 && (0x10 < (int)uVar2)) && (0xa9 < (int)uVar6)) && (uVar4 == 2))
               )))) || ((((0x9f < (int)uVar1 && (0x1d < (int)uVar2)) && (0x96 < (int)uVar6)) &&
                        (uVar4 == 2)))) {
            param_1 = 4;
          }
          if (((uVar4 | uVar6 | uVar7 | uVar3 | uVar2 | uVar8 | uVar1) == 0) && (uVar5 == 0xfe)) {
            param_1 = 1;
          }
        }
        else {
          if ((param_1 == 4) &&
             ((((0xf0 < (int)uVar1 && (15000 < (int)uVar3)) && ((int)uVar2 < 0xf)) ||
              (((0xf9 < (int)uVar1 && (15000 < (int)uVar3)) && (uVar4 == 4)))))) {
            param_1 = 3;
          }
        }
      }
    }
  }
  return param_1;
}



int FUN_1800086d0(undefined8 *param_1,int param_2,int param_3,int *param_4,int *param_5,
                 undefined *param_6,undefined *param_7)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  undefined8 *_Memory;
  undefined8 uVar4;
  longlong lVar5;
  longlong lVar6;
  uint *_Memory_00;
  ulonglong uVar7;
  undefined *puVar8;
  int iVar9;
  uint uVar10;
  size_t _Size;
  int iVar11;
  byte bVar12;
  int iVar14;
  int local_res10 [2];
  int local_res18 [4];
  byte in_stack_ffffffffffffff98;
  int local_38;
  int local_34;
  int local_30;
  uint local_2c;
  int *piVar13;
  
  uVar10 = 0;
  iVar14 = 0;
  iVar3 = 0;
  iVar2 = DAT_18004a734 * DAT_18004a774;
  _Size = SEXT48(iVar2);
  piVar13 = param_4;
  local_res10[0] = param_2;
  local_res18[0] = param_3;
  _Memory = (undefined8 *)malloc(_Size);
  bVar12 = (byte)piVar13;
  if (_Memory == (undefined8 *)0x0) {
    iVar3 = -1;
  }
  else {
    FUN_18001d320(_Memory,param_1,_Size);
    uVar4 = FUN_180007b30((byte *)_Memory,DAT_18004a734,DAT_18004a774,bVar12,
                          in_stack_ffffffffffffff98);
    if ((int)uVar4 < 1) {
      iVar3 = -2;
      iVar2 = local_res18[0];
    }
    else {
      iVar9 = 0;
      iVar11 = 0;
      iVar14 = 0;
      lVar6 = 0;
      if (1 < (longlong)_Size) {
        iVar14 = (iVar2 - 2U & 0xfffffffe) + 2;
        lVar5 = lVar6;
        iVar11 = 0;
        do {
          lVar6 = lVar5 + 2;
          iVar9 = iVar9 + (uint)*(byte *)((longlong)_Memory + lVar5);
          iVar11 = iVar11 + (uint)*(byte *)((longlong)_Memory + lVar5 + 1);
          lVar5 = lVar6;
        } while (lVar6 < (longlong)(_Size - 1));
      }
      if (lVar6 < (longlong)_Size) {
        uVar10 = (uint)*(byte *)(lVar6 + (longlong)_Memory);
        iVar14 = iVar14 + 1;
      }
      iVar14 = (int)(iVar11 + iVar9 + uVar10) / iVar14;
      iVar2 = FUN_180007e90(_Memory,DAT_18004a734,DAT_18004a774,local_res18,local_res10,&local_38,
                            &local_34,&local_30,&local_2c);
    }
    free(_Memory);
    if (-1 < iVar3) {
      _Memory_00 = FUN_1800162e0();
      piVar13 = *(int **)(_Memory_00 + 6);
      puVar1 = *(undefined4 **)(_Memory_00 + 8);
      *piVar13 = iVar2;
      piVar13[1] = local_res18[0];
      piVar13[2] = local_res10[0];
      piVar13[3] = local_38;
      piVar13[4] = local_34;
      piVar13[5] = local_30;
      piVar13[6] = local_2c;
      piVar13[7] = iVar14;
      *puVar1 = 2;
      puVar1[1] = 3;
      puVar1[2] = 3;
      puVar1[3] = 0xfffffffb;
      puVar1[4] = 3;
      puVar1[5] = 2;
      puVar1[6] = 8;
      puVar1[7] = 2;
      puVar8 = &DAT_18004b620;
      if (param_6 != (undefined *)0x0) {
        puVar8 = param_6;
      }
      *(undefined **)(_Memory_00 + 10) = puVar8;
      puVar8 = &DAT_18004b810;
      if (param_7 != (undefined *)0x0) {
        puVar8 = param_7;
      }
      *(undefined **)(_Memory_00 + 0xc) = puVar8;
      uVar7 = FUN_180016110(_Memory_00);
      iVar3 = FUN_1800082c0((int)uVar7,(int *)_Memory_00);
      if (param_4 != (int *)0x0) {
        *param_4 = local_38;
      }
      if (param_5 != (int *)0x0) {
        *param_5 = iVar2;
      }
      if (*(void **)(_Memory_00 + 2) != (void *)0x0) {
        free(*(void **)(_Memory_00 + 2));
      }
      if (*(void **)(_Memory_00 + 6) != (void *)0x0) {
        free(*(void **)(_Memory_00 + 6));
      }
      if (*(void **)(_Memory_00 + 8) != (void *)0x0) {
        free(*(void **)(_Memory_00 + 8));
      }
      free(_Memory_00);
    }
  }
  return iVar3;
}



void FUN_180008940(longlong param_1,undefined8 param_2,char param_3)

{
  byte bVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  ulonglong uVar6;
  longlong lVar7;
  byte *pbVar8;
  longlong lVar9;
  byte bVar10;
  longlong lVar11;
  ulonglong uVar12;
  byte **ppbVar13;
  byte local_res20 [8];
  byte local_38 [4];
  byte local_34;
  byte local_33;
  byte local_32;
  byte local_31;
  byte local_30;
  byte local_2f;
  byte local_2e;
  byte local_2d;
  byte local_2c;
  byte local_2b;
  byte local_2a;
  byte local_29;
  
  if (4 < (byte)(param_3 << 2)) {
    ppbVar13 = (byte **)(param_1 + 0x20);
    uVar12 = (ulonglong)(((byte)(param_3 << 2) - 5 >> 2) + 1);
    do {
      lVar7 = 4;
      do {
        pbVar2 = *ppbVar13;
        lVar11 = 0;
        pbVar8 = pbVar2;
        do {
          local_res20[0] = *pbVar8;
          lVar9 = 4;
          do {
            bVar1 = (&DAT_1800397b0)[lVar11];
            bVar10 = 0;
            bVar3 = bVar1;
            if ((local_res20[0] != 1) && (bVar3 = local_res20[0], bVar1 != 1)) {
              pbVar4 = local_res20;
              uVar6 = 7;
              do {
                bVar3 = *pbVar4;
                pbVar4 = pbVar4 + 1;
                if (bVar3 < 0x80) {
                  bVar3 = bVar3 * '\x02';
                }
                else {
                  bVar3 = bVar3 * '\x02' ^ 0x1b;
                }
                *pbVar4 = bVar3;
                uVar6 = uVar6 - 1;
              } while (uVar6 != 0);
              pbVar4 = local_res20;
              do {
                if ((bVar1 >> ((byte)uVar6 & 0x1f) & 1) != 0) {
                  bVar10 = bVar10 ^ *pbVar4;
                }
                uVar5 = (int)uVar6 + 1;
                uVar6 = (ulonglong)uVar5;
                pbVar4 = pbVar4 + 1;
                bVar3 = bVar10;
              } while ((int)uVar5 < 8);
            }
            local_38[lVar11] = bVar3;
            lVar11 = lVar11 + 1;
            lVar9 = lVar9 + -1;
          } while (lVar9 != 0);
          pbVar8 = pbVar8 + 1;
        } while (lVar11 < 0x10);
        ppbVar13 = ppbVar13 + 1;
        *pbVar2 = local_38[0] ^ local_2c ^ local_30 ^ local_34;
        pbVar2[1] = local_33 ^ local_2f ^ local_2b ^ local_38[1];
        pbVar2[2] = local_32 ^ local_2e ^ local_2a ^ local_38[2];
        pbVar2[3] = local_31 ^ local_2d ^ local_29 ^ local_38[3];
        lVar7 = lVar7 + -1;
      } while (lVar7 != 0);
      uVar12 = uVar12 - 1;
    } while (uVar12 != 0);
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180008ae0(longlong param_1,byte **param_2,uint param_3,int param_4)

{
  byte *pbVar1;
  byte bVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong uVar5;
  IMAGE_DOS_HEADER *pIVar6;
  uint uVar7;
  int iVar8;
  ulonglong uVar9;
  longlong lVar10;
  longlong lVar11;
  byte **ppbVar12;
  byte **ppbVar13;
  undefined auStack104 [32];
  int local_48;
  undefined4 local_44;
  ulonglong local_40;
  
  local_40 = DAT_180049180 ^ (ulonglong)auStack104;
  uVar3 = ((ulonglong)param_3 & 0xff) >> 2;
  uVar7 = (uint)uVar3;
  pIVar6 = &IMAGE_DOS_HEADER_180000000;
  bVar2 = (&DAT_18003a7c0)[((longlong)(int)(uVar7 / 2) + -2) * 3];
  if (uVar7 != 0) {
    pbVar4 = (byte *)(param_1 + 2);
    lVar10 = 0;
    do {
      lVar11 = lVar10 + 1;
      *param_2[lVar10] = pbVar4[-2];
      param_2[lVar10][1] = pbVar4[-1];
      param_2[lVar10][2] = *pbVar4;
      pIVar6 = (IMAGE_DOS_HEADER *)param_2[lVar10];
      pbVar1 = pbVar4 + 1;
      pbVar4 = pbVar4 + 4;
      *(byte *)((longlong)&pIVar6->e_cblp + 1) = *pbVar1;
      lVar10 = lVar11;
    } while (lVar11 < (longlong)uVar3);
  }
  uVar9 = SEXT48((int)((uint)bVar2 * 4 + 4));
  if (uVar3 < uVar9) {
    lVar10 = uVar9 - uVar3;
    uVar9 = uVar3;
    ppbVar12 = param_2;
    do {
      local_44 = *(undefined4 *)ppbVar12[uVar3 - 1];
      iVar8 = (int)uVar9;
      local_44._2_1_ = (byte)((uint)local_44 >> 0x10);
      local_44._3_1_ = (byte)((uint)local_44 >> 0x18);
      local_44._1_1_ = (byte)((uint)local_44 >> 8);
      if (iVar8 % (int)uVar7 == 0) {
        uVar5 = (ulonglong)local_44._1_1_;
        uVar9 = (ulonglong)(byte)local_44;
        local_44._1_1_ = (&DAT_18003a7d0)[local_44._2_1_];
        local_44._0_1_ =
             (&DAT_18003a7d0)[uVar5] ^ (&DAT_18003866c)[(longlong)(iVar8 / (int)uVar7) * 4];
        local_44._2_1_ = (&DAT_18003a7d0)[local_44._3_1_];
        local_44._3_1_ = (&DAT_18003a7d0)[uVar9];
      }
      else {
        if ((6 < uVar7) && (iVar8 % (int)uVar7 == 4)) {
          local_44._0_1_ = (&DAT_18003a7d0)[(byte)local_44];
          local_44._1_1_ = (&DAT_18003a7d0)[local_44._1_1_];
          local_44._2_1_ = (&DAT_18003a7d0)[local_44._2_1_];
          local_44._3_1_ = (&DAT_18003a7d0)[local_44._3_1_];
        }
      }
      uVar9 = (ulonglong)(iVar8 + 1);
      ppbVar13 = ppbVar12 + 1;
      *ppbVar13[uVar3 - 1] = **ppbVar12 ^ (byte)local_44;
      ppbVar13[uVar3 - 1][1] = (*ppbVar12)[1] ^ local_44._1_1_;
      ppbVar13[uVar3 - 1][2] = (*ppbVar12)[2] ^ local_44._2_1_;
      pIVar6 = (IMAGE_DOS_HEADER *)(ulonglong)((*ppbVar12)[3] ^ local_44._3_1_);
      ppbVar13[uVar3 - 1][3] = (*ppbVar12)[3] ^ local_44._3_1_;
      lVar10 = lVar10 + -1;
      ppbVar12 = ppbVar13;
    } while (lVar10 != 0);
  }
  local_48 = param_4;
  if (param_4 != 0) {
    FUN_180008940((longlong)param_2,pIVar6,bVar2);
  }
  FUN_18001d2f0(local_40 ^ (ulonglong)auStack104);
  return;
}



void FUN_180008d20(byte *param_1,longlong *param_2,int param_3,undefined8 param_4,undefined8 param_5
                  ,int param_6)

{
  char cVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  byte *pbVar8;
  int iVar9;
  longlong lVar10;
  char *pcVar11;
  byte *pbVar12;
  byte *pbVar13;
  byte **ppbVar14;
  byte bVar15;
  longlong *plVar16;
  byte *pbVar17;
  ulonglong uVar18;
  byte **ppbVar19;
  byte local_88 [8];
  ulonglong local_80;
  longlong *local_78;
  longlong local_70;
  byte *local_68 [4];
  byte local_48 [16];
  ulonglong local_38;
  
  if (param_3 != 0) {
    local_38 = DAT_180049180 ^ (ulonglong)local_88;
    local_70 = -(longlong)local_48;
    local_88[0] = (char)param_6 << 2;
    local_80 = (ulonglong)((param_3 - 1U >> 4) + 1);
    do {
      uVar5 = 4;
      pbVar13 = &DAT_1800382a8;
      lVar10 = 4;
      plVar16 = param_2;
      do {
        bVar15 = *pbVar13;
        lVar7 = *plVar16;
        lVar6 = 4;
        pbVar12 = local_48 + bVar15;
        do {
          *pbVar12 = pbVar12[(lVar7 - (ulonglong)bVar15) - (longlong)local_48] ^
                     pbVar12[(longlong)(param_1 + local_70)];
          lVar6 = lVar6 + -1;
          pbVar12 = pbVar12 + 1;
        } while (lVar6 != 0);
        pbVar13 = pbVar13 + 1;
        plVar16 = plVar16 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      if (1 < param_6) {
        uVar18 = (ulonglong)(param_6 - 1);
        pbVar13 = local_48;
        pbVar12 = param_1;
        do {
          pbVar8 = pbVar13;
          iVar9 = 0;
          ppbVar19 = (byte **)(param_2 + uVar5);
          do {
            iVar3 = 0;
            pcVar11 = "";
            bVar15 = (char)iVar9 * '\x04';
            lVar10 = 0;
            ppbVar14 = local_68;
            do {
              cVar1 = *pcVar11;
              pcVar11 = pcVar11 + 1;
              cVar2 = (char)iVar3;
              iVar3 = iVar3 + 1;
              lVar7 = (ulonglong)pbVar8[(byte)(&DAT_180038710)[(byte)(cVar1 + cVar2 + bVar15)]] +
                      lVar10;
              lVar10 = lVar10 + 0x100;
              *ppbVar14 = &DAT_180038790 + lVar7 * 4;
              ppbVar14 = ppbVar14 + 1;
            } while (iVar3 < 4);
            pbVar13 = *ppbVar19;
            iVar9 = iVar9 + 1;
            pbVar17 = pbVar12 + bVar15;
            ppbVar19 = ppbVar19 + 1;
            *pbVar17 = *local_68[0] ^ *local_68[1] ^ *local_68[2] ^ *pbVar13 ^ *local_68[3];
            pbVar17[1] = pbVar13[1] ^ local_68[0][1] ^ local_68[1][1] ^ local_68[2][1] ^
                         local_68[3][1];
            pbVar17[2] = pbVar13[2] ^ local_68[0][2] ^ local_68[1][2] ^ local_68[2][2] ^
                         local_68[3][2];
            pbVar17[3] = pbVar13[3] ^ local_68[0][3] ^ local_68[1][3] ^ local_68[2][3] ^
                         local_68[3][3];
          } while (iVar9 < 4);
          uVar5 = (ulonglong)(byte)((char)uVar5 + 4);
          uVar18 = uVar18 - 1;
          pbVar13 = pbVar12;
          pbVar12 = pbVar8;
        } while (uVar18 != 0);
      }
      pbVar13 = &DAT_1800382a8;
      lVar10 = 4;
      pbVar12 = &DAT_1800382a8;
      do {
        bVar15 = *pbVar12;
        iVar9 = 0;
        do {
          uVar4 = (uint)bVar15 + iVar9;
          iVar9 = iVar9 + 1;
          uVar5 = (ulonglong)(uVar4 & 0xff);
          local_48[uVar5] = (&DAT_18003a7d0)[param_1[uVar5]];
        } while (iVar9 < 4);
        pbVar12 = pbVar12 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      iVar9 = 0;
      lVar10 = 0;
      do {
        uVar5 = (ulonglong)*pbVar13;
        lVar6 = 4;
        lVar7 = param_2[iVar9 + (uint)local_88[0] & 0xff];
        pbVar12 = param_1 + uVar5;
        do {
          *pbVar12 = local_48[pbVar12[(longlong)
                                      (&DAT_180038730 + ((lVar10 - uVar5) - (longlong)param_1))]] ^
                     pbVar12[(lVar7 - uVar5) - (longlong)param_1];
          lVar6 = lVar6 + -1;
          pbVar12 = pbVar12 + 1;
        } while (lVar6 != 0);
        iVar9 = iVar9 + 1;
        pbVar13 = pbVar13 + 1;
        lVar10 = lVar10 + 4;
      } while (iVar9 < 4);
      param_1 = param_1 + 0x10;
      local_80 = local_80 - 1;
    } while (local_80 != 0);
    local_78 = param_2;
    FUN_18001d2f0(local_38 ^ (ulonglong)local_88);
  }
  return;
}



void FUN_180009050(byte *param_1,longlong *param_2,int param_3,undefined8 param_4,undefined8 param_5
                  ,int param_6)

{
  char cVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  longlong lVar5;
  longlong lVar6;
  byte *pbVar7;
  byte **ppbVar8;
  int iVar9;
  longlong lVar10;
  longlong *plVar11;
  longlong lVar12;
  char *pcVar13;
  byte *pbVar14;
  byte *pbVar15;
  byte **ppbVar16;
  byte bVar17;
  byte *pbVar18;
  ulonglong uVar19;
  byte bVar20;
  byte local_88;
  byte local_87;
  ulonglong local_80;
  longlong *local_78;
  longlong local_70;
  byte *local_68 [4];
  byte local_48 [16];
  ulonglong local_38;
  
  if (param_3 != 0) {
    local_38 = DAT_180049180 ^ (ulonglong)&local_88;
    local_87 = ((char)param_6 + -1) * '\x04';
    local_70 = -(longlong)local_48;
    local_88 = (char)param_6 << 2;
    local_80 = (ulonglong)((param_3 - 1U >> 4) + 1);
    do {
      pbVar15 = &DAT_1800382a8;
      lVar10 = 4;
      plVar11 = param_2 + local_88;
      do {
        bVar20 = *pbVar15;
        lVar6 = *plVar11;
        lVar5 = 4;
        pbVar14 = local_48 + bVar20;
        do {
          *pbVar14 = pbVar14[(lVar6 - (ulonglong)bVar20) - (longlong)local_48] ^
                     (pbVar14 + 1)[(longlong)(param_1 + local_70 + -1)];
          lVar5 = lVar5 + -1;
          pbVar14 = pbVar14 + 1;
        } while (lVar5 != 0);
        plVar11 = plVar11 + 1;
        pbVar15 = pbVar15 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      if (1 < param_6) {
        uVar19 = (ulonglong)(param_6 - 1);
        pbVar15 = local_48;
        pbVar14 = param_1;
        bVar20 = local_87;
        do {
          pbVar7 = pbVar15;
          iVar9 = 0;
          ppbVar8 = (byte **)(param_2 + bVar20);
          do {
            iVar3 = 0;
            pcVar13 = "";
            bVar17 = (char)iVar9 * '\x04';
            lVar10 = 0;
            ppbVar16 = local_68;
            do {
              cVar2 = (char)iVar3;
              iVar3 = iVar3 + 1;
              cVar1 = *pcVar13;
              pcVar13 = pcVar13 + 1;
              lVar6 = (ulonglong)pbVar7[(byte)(&DAT_180038710)[(byte)(bVar17 + cVar2 + cVar1)]] +
                      lVar10;
              lVar10 = lVar10 + 0x100;
              *ppbVar16 = &DAT_1800397c0 + lVar6 * 4;
              ppbVar16 = ppbVar16 + 1;
            } while (iVar3 < 4);
            pbVar15 = *ppbVar8;
            iVar9 = iVar9 + 1;
            pbVar18 = pbVar14 + bVar17;
            ppbVar8 = ppbVar8 + 1;
            *pbVar18 = *local_68[0] ^ *local_68[1] ^ *local_68[2] ^ *local_68[3] ^ *pbVar15;
            pbVar18[1] = pbVar15[1] ^ local_68[0][1] ^ local_68[1][1] ^ local_68[2][1] ^
                         local_68[3][1];
            pbVar18[2] = pbVar15[2] ^ local_68[0][2] ^ local_68[1][2] ^ local_68[2][2] ^
                         local_68[3][2];
            pbVar18[3] = pbVar15[3] ^ local_68[0][3] ^ local_68[1][3] ^ local_68[2][3] ^
                         local_68[3][3];
          } while (iVar9 < 4);
          bVar20 = bVar20 - 4;
          uVar19 = uVar19 - 1;
          pbVar15 = pbVar14;
          pbVar14 = pbVar7;
        } while (uVar19 != 0);
      }
      pbVar15 = &DAT_1800382a8;
      lVar10 = 4;
      pbVar14 = &DAT_1800382a8;
      do {
        bVar20 = *pbVar14;
        iVar9 = 0;
        do {
          uVar4 = (uint)bVar20 + iVar9;
          iVar9 = iVar9 + 1;
          uVar19 = (ulonglong)(uVar4 & 0xff);
          local_48[uVar19] = (&DAT_18003a8d0)[param_1[uVar19]];
        } while (iVar9 < 4);
        pbVar14 = pbVar14 + 1;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      lVar6 = 0;
      lVar10 = 4;
      plVar11 = param_2;
      do {
        uVar19 = (ulonglong)*pbVar15;
        lVar5 = *plVar11;
        lVar12 = 4;
        pbVar14 = param_1 + uVar19;
        do {
          *pbVar14 = local_48[pbVar14[(longlong)
                                      (&DAT_1800386b0 + ((lVar6 - uVar19) - (longlong)param_1))]] ^
                     pbVar14[(lVar5 - uVar19) - (longlong)param_1];
          lVar12 = lVar12 + -1;
          pbVar14 = pbVar14 + 1;
        } while (lVar12 != 0);
        pbVar15 = pbVar15 + 1;
        plVar11 = plVar11 + 1;
        lVar6 = lVar6 + 4;
        lVar10 = lVar10 + -1;
      } while (lVar10 != 0);
      param_1 = param_1 + 0x10;
      local_80 = local_80 - 1;
    } while (local_80 != 0);
    local_78 = param_2;
    FUN_18001d2f0(local_38 ^ (ulonglong)&local_88);
  }
  return;
}



void FUN_180009390(byte *param_1,longlong param_2,uint param_3,ulonglong param_4)

{
  byte bVar1;
  byte *pbVar2;
  byte **ppbVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  undefined8 in_stack_fffffffffffffce8;
  byte *local_308 [60];
  byte local_128 [240];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffcc8;
  bVar1 = (&DAT_18003a7c0)[(((param_4 & 0xff) >> 3) - 2) * 3];
  FUN_18001d980((undefined (*) [16])local_128,0,0xf0);
  uVar4 = (uint)bVar1 * 4 + 4;
  uVar5 = (ulonglong)uVar4;
  if (uVar4 != 0) {
    ppbVar3 = local_308;
    pbVar2 = local_128;
    do {
      *ppbVar3 = pbVar2;
      pbVar2 = pbVar2 + 4;
      ppbVar3 = ppbVar3 + 1;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  uVar6 = 0;
  FUN_180008ae0(param_2,local_308,(uint)(param_4 & 0xff),0);
  if ((param_3 & 0xf) != 0) {
    param_3 = param_3 & 0xfffffff0;
  }
  FUN_180008d20(param_1,(longlong *)local_308,param_3,uVar6,in_stack_fffffffffffffce8,(uint)bVar1);
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffcc8);
  return;
}



void FUN_180009470(byte *param_1,longlong param_2,uint param_3,byte param_4)

{
  byte bVar1;
  byte *pbVar2;
  byte **ppbVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  undefined8 in_stack_fffffffffffffce8;
  byte *local_308 [60];
  byte local_128 [240];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffcc8;
  bVar1 = (&DAT_18003a7c0)[((ulonglong)(param_4 >> 3) - 2) * 3];
  FUN_18001d980((undefined (*) [16])local_128,0,0xf0);
  uVar4 = (uint)bVar1 * 4 + 4;
  uVar5 = (ulonglong)uVar4;
  if (uVar4 != 0) {
    ppbVar3 = local_308;
    pbVar2 = local_128;
    do {
      *ppbVar3 = pbVar2;
      pbVar2 = pbVar2 + 4;
      ppbVar3 = ppbVar3 + 1;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  if ((param_3 & 0xf) != 0) {
    param_3 = param_3 & 0xfffffff0;
  }
  uVar6 = 1;
  FUN_180008ae0(param_2,local_308,(uint)param_4,1);
  FUN_180009050(param_1,(longlong *)local_308,param_3,uVar6,in_stack_fffffffffffffce8,(uint)bVar1);
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffcc8);
  return;
}



void FUN_180009560(int *param_1,int param_2,int param_3)

{
  int *piVar1;
  longlong lVar2;
  int iVar3;
  
  iVar3 = 0;
  if (0 < *param_1) {
    lVar2 = 0;
    do {
      iVar3 = iVar3 + 1;
      **(int **)(lVar2 + *(longlong *)(param_1 + 6)) =
           **(int **)(lVar2 + *(longlong *)(param_1 + 6)) - param_2;
      piVar1 = (int *)(*(longlong *)(lVar2 + *(longlong *)(param_1 + 6)) + 4);
      *piVar1 = *piVar1 - param_3;
      lVar2 = lVar2 + 8;
    } while (iVar3 < *param_1);
  }
  return;
}



ulonglong FUN_1800095b0(int *param_1,int param_2)

{
  undefined4 *puVar1;
  short sVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  void *_Memory;
  ulonglong uVar6;
  short sVar7;
  undefined4 *puVar8;
  int *piVar9;
  int *piVar10;
  longlong lVar11;
  int iVar12;
  longlong *plVar13;
  undefined4 *puVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  longlong lVar19;
  longlong lVar20;
  int local_res10;
  
  iVar18 = param_2 + 0x168;
  _Memory = calloc((longlong)iVar18,4);
  lVar20 = (longlong)*param_1;
  lVar11 = (longlong)(param_2 / 2);
  iVar4 = 0;
  puVar1 = (undefined4 *)((longlong)_Memory + lVar11 * 4);
  local_res10 = 0;
  if (0 < lVar20) {
    plVar13 = *(longlong **)(param_1 + 10);
    lVar19 = *(longlong *)(param_1 + 8) - (longlong)plVar13;
    piVar10 = *(int **)(param_1 + 2);
    do {
      sVar2 = *(short *)(*(longlong *)(lVar19 + (longlong)plVar13) + 0xe);
      sVar7 = *(short *)(*plVar13 + 0xe);
      if (sVar7 < sVar2) {
        sVar7 = (sVar7 - sVar2) + 0x168;
      }
      else {
        sVar7 = sVar7 - sVar2;
      }
      plVar13 = plVar13 + 1;
      puVar1[sVar7] =
           puVar1[sVar7] + ((int)((0x80 - *piVar10) + (0x80 - *piVar10 >> 0x1f & 0xfU)) >> 4) + 1;
      lVar20 = lVar20 + -1;
      piVar10 = piVar10 + 1;
    } while (lVar20 != 0);
  }
  if (0 < lVar11) {
    puVar14 = puVar1 + 0x167;
    lVar20 = 0;
    puVar8 = puVar1;
    do {
      puVar8 = puVar8 + -1;
      lVar19 = lVar20 + 1;
      puVar1[lVar20 + 0x168] = puVar1[lVar20];
      uVar3 = *puVar14;
      puVar14 = puVar14 + -1;
      *puVar8 = uVar3;
      lVar20 = lVar19;
    } while (lVar19 < lVar11);
  }
  iVar12 = 0;
  iVar5 = -(param_2 / 2);
  iVar16 = iVar5 - param_2;
  if (0 < iVar18) {
    piVar10 = puVar1 + iVar5;
    piVar9 = puVar1 + iVar16;
    iVar15 = iVar4;
    iVar17 = iVar4;
    do {
      if (param_2 <= iVar12) {
        iVar15 = iVar15 - *piVar9;
        iVar17 = iVar17 - *piVar9 * iVar16;
      }
      iVar15 = iVar15 + *piVar10;
      iVar17 = iVar17 + (iVar5 + iVar12) * *piVar10;
      if (iVar4 < iVar15) {
        iVar4 = iVar15;
        local_res10 = iVar17;
      }
      iVar12 = iVar12 + 1;
      piVar10 = piVar10 + 1;
      iVar16 = iVar16 + 1;
      piVar9 = piVar9 + 1;
    } while (iVar12 < iVar18);
  }
  free(_Memory);
  if (iVar4 == 0) {
    uVar6 = 0;
  }
  else {
    uVar6 = (longlong)(iVar4 / 2 + local_res10) / (longlong)iVar4 & 0xffffffff;
    if (0x167 < (int)uVar6) {
      uVar6 = (ulonglong)((int)uVar6 - 0x168);
    }
    if ((int)uVar6 < 0) {
      uVar6 = (ulonglong)((int)uVar6 + 0x168);
    }
  }
  return uVar6;
}



int FUN_180009760(uint *param_1,int param_2,int param_3)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  short sVar4;
  int iVar5;
  int iVar6;
  int *_Memory;
  void *_Memory_00;
  longlong lVar7;
  int iVar8;
  int iVar9;
  size_t _Count;
  int iVar10;
  int *piVar11;
  longlong lVar12;
  ulonglong uVar13;
  int iVar14;
  uint uVar15;
  int local_res8;
  int local_res18;
  
  uVar15 = *param_1;
  _Memory = (int *)malloc((longlong)(int)uVar15 << 2);
  iVar10 = 0x1000;
  iVar6 = -0x1000;
  iVar14 = 0;
  iVar9 = 0;
  local_res8 = 0;
  iVar8 = 0;
  local_res18 = 0x1000;
  if (0 < (int)uVar15) {
    lVar7 = *(longlong *)(param_1 + 2);
    uVar13 = (ulonglong)uVar15;
    lVar12 = 0;
    piVar11 = _Memory;
    iVar10 = 0x1000;
    do {
      if ((*(uint *)((lVar7 - (longlong)_Memory) + (longlong)piVar11) & 0x8000) == 0) {
        psVar2 = *(short **)(lVar12 + *(longlong *)(param_1 + 8));
        psVar3 = *(short **)(lVar12 + *(longlong *)(param_1 + 10));
        if (param_2 == 0xe) {
          sVar1 = psVar2[7];
          sVar4 = psVar3[7];
          if (sVar4 < sVar1) {
            sVar4 = (sVar4 - sVar1) + 0x168;
          }
          else {
            sVar4 = sVar4 - sVar1;
          }
        }
        else {
          if (param_2 == 0) {
            sVar4 = *psVar3 - *psVar2;
          }
          else {
            sVar4 = psVar3[2] - psVar2[2];
          }
        }
        iVar5 = (int)sVar4;
        *piVar11 = iVar5;
        if (iVar6 < iVar5) {
          iVar6 = iVar5;
        }
        iVar10 = local_res18;
        if (iVar5 < local_res18) {
          local_res18 = iVar5;
          iVar10 = iVar5;
        }
      }
      lVar12 = lVar12 + 8;
      piVar11 = piVar11 + 1;
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
    uVar15 = *param_1;
  }
  _Count = SEXT48((iVar6 - iVar10) + 1);
  _Memory_00 = calloc(_Count,4);
  if (0 < (int)uVar15) {
    lVar7 = *(longlong *)(param_1 + 2);
    uVar13 = (ulonglong)uVar15;
    lVar12 = 0;
    do {
      if ((*(uint *)(lVar12 + lVar7) >> 0xf & 1) == 0) {
        piVar11 = (int *)((longlong)_Memory_00 +
                         ((longlong)*(int *)(lVar12 + (longlong)_Memory) - (longlong)local_res18) *
                         4);
        iVar6 = 0x80 - *(uint *)(lVar12 + lVar7);
        *piVar11 = *piVar11 + ((int)(iVar6 + (iVar6 >> 0x1f & 0xfU)) >> 4) + 1;
      }
      lVar12 = lVar12 + 4;
      uVar13 = uVar13 - 1;
    } while (uVar13 != 0);
  }
  iVar6 = -param_3;
  iVar10 = 0;
  lVar7 = 0;
  if (0 < (longlong)_Count) {
    lVar12 = (longlong)iVar6;
    do {
      if (-1 < iVar6) {
        iVar5 = *(int *)((longlong)_Memory_00 + lVar12 * 4);
        iVar9 = iVar9 - iVar5;
        iVar8 = iVar8 - iVar5 * iVar6;
        if ((iVar9 == 0) && (*(int *)((longlong)_Memory_00 + lVar7 * 4) == 0)) {
          for (; (lVar7 < (longlong)_Count && (*(int *)((longlong)_Memory_00 + lVar7 * 4) < 1));
              lVar7 = lVar7 + 1) {
            iVar10 = iVar10 + 1;
            iVar6 = iVar6 + 1;
            lVar12 = lVar12 + 1;
          }
        }
      }
      iVar5 = *(int *)((longlong)_Memory_00 + lVar7 * 4);
      iVar9 = iVar9 + iVar5;
      iVar8 = iVar8 + iVar5 * iVar10;
      if (iVar14 < iVar9) {
        iVar14 = iVar9;
        local_res8 = iVar8;
      }
      lVar7 = lVar7 + 1;
      iVar10 = iVar10 + 1;
      iVar6 = iVar6 + 1;
      lVar12 = lVar12 + 1;
    } while (lVar7 < (longlong)_Count);
  }
  free(_Memory_00);
  free(_Memory);
  if (iVar14 == 0) {
    return 0;
  }
  return (iVar14 / 2 + local_res8) / iVar14 + local_res18;
}



int FUN_1800099a0(uint *param_1,int param_2)

{
  uint uVar1;
  ushort uVar2;
  short sVar3;
  short sVar4;
  int iVar5;
  ulonglong uVar6;
  int iVar7;
  longlong *plVar8;
  longlong lVar9;
  ulonglong uVar10;
  longlong lVar11;
  
  iVar7 = 0;
  uVar6 = FUN_1800095b0((int *)param_1,param_2);
  uVar1 = *param_1;
  if (0 < (int)uVar1) {
    plVar8 = *(longlong **)(param_1 + 10);
    lVar9 = 0;
    uVar10 = (ulonglong)uVar1;
    lVar11 = *(longlong *)(param_1 + 8) - (longlong)plVar8;
    do {
      sVar4 = *(short *)(*(longlong *)(lVar11 + (longlong)plVar8) + 0xe);
      sVar3 = *(short *)(*plVar8 + 0xe);
      if (sVar3 < sVar4) {
        sVar3 = (sVar3 - sVar4) + 0x168;
      }
      else {
        sVar3 = sVar3 - sVar4;
      }
      iVar5 = (int)(short)uVar6 - (int)sVar3;
      uVar2 = (ushort)(iVar5 >> 0x1f);
      sVar4 = ((ushort)iVar5 ^ uVar2) - uVar2;
      if (0xb4 < sVar4) {
        sVar4 = 0x168 - sVar4;
      }
      if (param_2 < sVar4) {
        *(uint *)(lVar9 + *(longlong *)(param_1 + 2)) =
             *(uint *)(lVar9 + *(longlong *)(param_1 + 2)) | 0x8000;
        iVar7 = iVar7 + 1;
      }
      plVar8 = plVar8 + 1;
      lVar9 = lVar9 + 4;
      uVar10 = uVar10 - 1;
    } while (uVar10 != 0);
  }
  *(short *)(param_1 + 5) = (short)uVar6;
  return (int)(uVar1 - iVar7);
}



void FUN_180009a80(int *param_1,longlong param_2,int param_3,longlong param_4,int param_5,
                  int param_6)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  longlong *plVar4;
  longlong lVar5;
  longlong lVar6;
  
  iVar2 = *param_1;
  lVar5 = (longlong)iVar2;
  iVar3 = 0;
  if (0 < iVar2) {
    plVar4 = *(longlong **)(param_1 + 10);
    do {
      if (*plVar4 == *(longlong *)(*(longlong *)(param_4 + 0x18) + (longlong)param_5 * 8)) {
        if (-1 < iVar3) {
          lVar6 = (longlong)iVar3;
          lVar5 = *(longlong *)(param_1 + 2);
          piVar1 = (int *)(lVar5 + lVar6 * 4);
          if (*piVar1 == param_6 || *piVar1 < param_6) {
            return;
          }
          *(undefined8 *)(*(longlong *)(param_1 + 8) + lVar6 * 8) =
               *(undefined8 *)(*(longlong *)(param_2 + 0x18) + (longlong)param_3 * 8);
          *(int *)(lVar5 + lVar6 * 4) = param_6;
          return;
        }
        break;
      }
      iVar3 = iVar3 + 1;
      plVar4 = plVar4 + 1;
    } while (iVar3 < iVar2);
  }
  *(undefined8 *)(*(longlong *)(param_1 + 8) + lVar5 * 8) =
       *(undefined8 *)(*(longlong *)(param_2 + 0x18) + (longlong)param_3 * 8);
  *(undefined8 *)(*(longlong *)(param_1 + 10) + lVar5 * 8) =
       *(undefined8 *)(*(longlong *)(param_4 + 0x18) + (longlong)param_5 * 8);
  *(int *)(*(longlong *)(param_1 + 2) + lVar5 * 4) = param_6;
  *param_1 = iVar2 + 1;
  return;
}



int * FUN_180009b40(int *param_1,int *param_2,int param_3,int *param_4)

{
  int *piVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  short sVar6;
  int *piVar7;
  short sVar8;
  
  piVar5 = (int *)0x0;
  sVar8 = 0x168;
  piVar7 = piVar5;
  if (0 < (longlong)*param_1) {
    do {
      piVar1 = *(int **)(*(longlong *)(param_1 + 6) + (longlong)piVar7 * 8);
      if (((-1 < *(short *)((longlong)piVar1 + 0xe)) &&
          (iVar3 = (piVar1[1] - param_2[1]) * (piVar1[1] - param_2[1]), iVar3 < param_3)) &&
         (iVar3 = iVar3 + (*piVar1 - *param_2) * (*piVar1 - *param_2), iVar3 <= param_3)) {
        iVar4 = (int)*(short *)((longlong)piVar1 + 0xe) - (int)*(short *)((longlong)param_2 + 0xe);
        uVar2 = (ushort)(iVar4 >> 0x1f);
        sVar6 = ((ushort)iVar4 ^ uVar2) - uVar2;
        if (0xb4 < sVar6) {
          sVar6 = 0x168 - sVar6;
        }
        if ((iVar3 != param_3) || (sVar6 <= sVar8)) {
          piVar5 = piVar1;
          param_3 = iVar3;
          sVar8 = sVar6;
        }
      }
      piVar7 = (int *)((longlong)piVar7 + 1);
    } while ((longlong)piVar7 < (longlong)*param_1);
  }
  if (param_4 != (int *)0x0) {
    *param_4 = param_3;
  }
  return piVar5;
}



void FUN_180009c40(int *param_1,short param_2)

{
  ushort uVar1;
  ushort uVar2;
  int *piVar3;
  short sVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int **ppiVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  int iVar16;
  uint uVar17;
  
  uVar1 = *(ushort *)(param_1 + 1);
  uVar2 = *(ushort *)((longlong)param_1 + 6);
  iVar9 = 0;
  uVar5 = ((uint)uVar1 * 0x400) / 2;
  uVar6 = ((uint)uVar2 * 0x400) / 2;
  if (param_2 == 0) {
    sVar4 = 0;
  }
  else {
    sVar4 = param_2;
    if (param_2 < 1) {
      sVar4 = param_2 + 0x168;
    }
    sVar4 = 0x168 - sVar4;
  }
  ppiVar10 = *(int ***)(param_1 + 6);
  iVar14 = (uint)(0 < *(int *)((longlong)&DAT_180042100 + (longlong)sVar4 * 4)) +
           *(int *)((longlong)&DAT_180042100 + (longlong)sVar4 * 4) + 0x1f;
  uVar15 = iVar14 >> 6;
  iVar16 = (uint)(0 < *(int *)((longlong)&DAT_180041b60 + (longlong)sVar4 * 4)) +
           *(int *)((longlong)&DAT_180041b60 + (longlong)sVar4 * 4) + 0x1f;
  uVar7 = iVar14 >> 0x1f;
  uVar17 = iVar16 >> 6;
  iVar14 = ((uVar15 ^ uVar7) - uVar7) + -0x400;
  uVar7 = iVar16 >> 0x1f;
  iVar11 = (uVar17 ^ uVar7) - uVar7;
  iVar16 = (int)(iVar11 * (uint)uVar2 + iVar14 * (uint)uVar1) / 2;
  iVar14 = (int)(iVar11 * (uint)uVar1 + iVar14 * (uint)uVar2) / 2;
  if ((param_2 != 0) && (0 < *param_1)) {
    do {
      piVar3 = *ppiVar10;
      iVar12 = piVar3[1] * 0x400 - uVar6;
      iVar13 = *piVar3 * 0x400 - uVar5;
      iVar11 = iVar13 * uVar15;
      iVar8 = iVar12 * uVar17;
      iVar12 = iVar12 * uVar15;
      iVar13 = iVar13 * uVar17;
      iVar8 = ((int)((((0 < iVar11 - iVar8) + 0x1ff) - iVar8) + iVar11) >> 10) + uVar5;
      iVar11 = ((int)((0 < iVar13 + iVar12) + 0x1ff + iVar13 + iVar12) >> 10) + uVar6;
      *piVar3 = (int)((uint)(0 < iVar8 + iVar16) + iVar8 + 0x1ff + iVar16) >> 10;
      (*ppiVar10)[1] = (int)((0 < iVar11 + iVar14) + 0x1ff + iVar11 + iVar14) >> 10;
      sVar4 = *(short *)((longlong)*ppiVar10 + 0xe) - param_2;
      if (sVar4 < 0) {
        sVar4 = sVar4 + 0x168;
      }
      else {
        if (0x167 < sVar4) {
          sVar4 = sVar4 + -0x168;
        }
      }
      iVar9 = iVar9 + 1;
      *(short *)((longlong)*ppiVar10 + 0xe) = sVar4;
      ppiVar10 = ppiVar10 + 1;
    } while (iVar9 < *param_1);
  }
  return;
}



void FUN_180009e50(uint **param_1,ulonglong param_2,int param_3,int param_4,longlong param_5)

{
  uint *puVar1;
  
  if (*param_1 == (uint *)0x0) {
    puVar1 = (uint *)FUN_18000ee50(param_3,param_4);
    *param_1 = puVar1;
    puVar1 = (uint *)FUN_18000ee50(param_3,param_4);
    param_1[1] = puVar1;
    puVar1 = (uint *)FUN_18000ee50(param_3,param_4);
    param_1[2] = puVar1;
    FUN_180013120(**(ulonglong **)(*param_1 + 2),param_2,param_3 * param_4);
    if (*(int *)(param_5 + 0x28) == 1) {
      FUN_18000f6b0((int *)*param_1,(longlong)param_1[1],(longlong)param_1[2]);
    }
    else {
      if (*(int *)(param_5 + 0x28) == 2) {
        FUN_18000f870(*param_1,(longlong)param_1[1],(longlong)param_1[2]);
      }
    }
  }
  return;
}



void FUN_180009f00(int param_1,int param_2,int *param_3,int *param_4,int param_5,int param_6,
                  int param_7,int param_8,int param_9)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  short sVar6;
  int iVar7;
  uint uVar8;
  
  if (param_7 == 0) {
    sVar6 = 0;
  }
  else {
    if (param_7 < 1) {
      param_7 = param_7 + 0x168;
    }
    sVar6 = 0x168 - (short)param_7;
  }
  iVar7 = (uint)(0 < *(int *)((longlong)&DAT_180042100 + (longlong)sVar6 * 4)) +
          *(int *)((longlong)&DAT_180042100 + (longlong)sVar6 * 4) + 0x1f;
  uVar8 = iVar7 >> 6;
  iVar3 = (uint)(0 < *(int *)((longlong)&DAT_180041b60 + (longlong)sVar6 * 4)) +
          *(int *)((longlong)&DAT_180041b60 + (longlong)sVar6 * 4) + 0x1f;
  uVar4 = iVar3 >> 6;
  uVar1 = iVar7 >> 0x1f;
  iVar7 = ((uVar8 ^ uVar1) - uVar1) + -0x400;
  uVar1 = iVar3 >> 0x1f;
  iVar5 = (uVar4 ^ uVar1) - uVar1;
  iVar2 = ((param_1 + param_5) * 0x400 - (iVar5 * param_9 + iVar7 * param_8) / 2) + param_8 * -0x200
  ;
  iVar3 = iVar2 * uVar8;
  iVar5 = ((param_2 + param_6) * 0x400 - (iVar7 * param_9 + iVar5 * param_8) / 2) + param_9 * -0x200
  ;
  iVar7 = iVar5 * uVar4;
  iVar7 = (int)((uint)(0 < iVar3 + iVar7) + iVar3 + 0x1ff + iVar7) >> 10;
  iVar5 = iVar5 * uVar8;
  iVar2 = iVar2 * uVar4;
  *param_3 = (int)((0 < iVar7 + param_8 * 0x200) + 0x1ff + iVar7 + param_8 * 0x200) >> 10;
  iVar7 = (int)((((0 < iVar5 - iVar2) + 0x1ff) - iVar2) + iVar5) >> 10;
  *param_4 = (int)((0 < iVar7 + param_9 * 0x200) + 0x1ff + iVar7 + param_9 * 0x200) >> 10;
  return;
}



longlong FUN_18000a0a0(uint *param_1,int *param_2,char *param_3)

{
  longlong lVar1;
  longlong *plVar2;
  longlong lVar3;
  int iVar4;
  ulonglong uVar5;
  longlong lVar6;
  uint uVar7;
  char *pcVar8;
  longlong *plVar9;
  
  plVar9 = *(longlong **)(param_1 + 6);
  lVar6 = 0;
  uVar7 = 0x2000;
  if (0 < (int)*param_1) {
    uVar5 = (ulonglong)*param_1;
    pcVar8 = param_3;
    do {
      lVar1 = *plVar9;
      if ((-1 < *(short *)(lVar1 + 0xe)) && ((param_3 == (char *)0x0 || (*pcVar8 == '\0')))) {
        iVar4 = 0;
        lVar3 = 0;
        if (0 < *param_2) {
          plVar2 = *(longlong **)(param_2 + 10);
          do {
            if (*plVar2 == lVar1) {
              if (-1 < iVar4) goto LAB_18000a11e;
              break;
            }
            lVar3 = lVar3 + 1;
            iVar4 = iVar4 + 1;
            plVar2 = plVar2 + 1;
          } while (lVar3 < *param_2);
        }
        if (*(uint *)(lVar1 + 8) < uVar7) {
          lVar6 = lVar1;
          uVar7 = *(uint *)(lVar1 + 8);
        }
      }
LAB_18000a11e:
      pcVar8 = pcVar8 + 1;
      plVar9 = plVar9 + 1;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  return lVar6;
}



undefined8
FUN_18000a150(int *param_1,uint *param_2,int **param_3,int *param_4,int param_5,int param_6,
             char *param_7,longlong param_8)

{
  char cVar1;
  ushort uVar2;
  ushort uVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  char *_Memory;
  int *piVar8;
  undefined8 uVar9;
  int *piVar10;
  short sVar11;
  int **ppiVar12;
  ulonglong *puVar13;
  int iVar14;
  char *pcVar15;
  longlong lVar16;
  longlong lVar17;
  char cVar18;
  char local_78;
  int local_74;
  longlong local_68;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  char *local_40;
  
  uVar2 = *(ushort *)(param_2 + 1);
  iVar14 = *param_1;
  uVar3 = *(ushort *)((longlong)param_2 + 6);
  iVar6 = *(int *)(param_8 + 0x10) * 0x16a0a;
  piVar10 = (int *)0x0;
  local_4c = (int)((uint)(0 < iVar6) + iVar6 + 0x7fff) >> 0x10;
  local_48 = (int)((uint)*(byte *)(param_2 + 2) * 0xa2 + 7) >> 3;
  _Memory = (char *)calloc((longlong)iVar14,1);
  cVar18 = '\0';
  iVar6 = 0;
  local_78 = '\0';
  local_40 = _Memory;
  if (0 < iVar14) {
    lVar16 = 0;
    pcVar15 = _Memory;
    do {
      if (*(short *)(*(longlong *)(lVar16 + *(longlong *)(param_1 + 6)) + 0xe) < 0) {
        *pcVar15 = '\x01';
      }
      else {
        cVar1 = *(char *)(*(longlong *)(lVar16 + *(longlong *)(param_1 + 6)) + 0xd);
        if (cVar18 < cVar1) {
          cVar18 = cVar1;
        }
      }
      iVar6 = iVar6 + 1;
      pcVar15 = pcVar15 + 1;
      lVar16 = lVar16 + 8;
      local_78 = cVar18;
    } while (iVar6 < *param_1);
  }
  do {
    if (local_78 < '\0') {
      free(_Memory);
      return 0;
    }
    local_74 = 0;
    pcVar15 = _Memory;
    if (0 < *param_1) {
      local_68 = 0;
      do {
        lVar16 = (longlong)param_6;
        piVar5 = *(int **)(local_68 + *(longlong *)(param_1 + 6));
        if ((*_Memory == '\0') && (local_78 <= *(char *)((longlong)piVar5 + 0xd))) {
          iVar14 = *param_4;
          iVar6 = 0;
          *_Memory = '\x01';
          if (0 < iVar14) {
            lVar17 = 0;
            do {
              iVar4 = **(int **)(lVar17 + *(longlong *)(param_4 + 8));
              iVar7 = iVar4 - *piVar5;
              if (iVar7 < 0) {
                iVar7 = *piVar5 - iVar4;
              }
              if (iVar7 < 10) {
                iVar4 = (*(int **)(lVar17 + *(longlong *)(param_4 + 8)))[1];
                iVar7 = iVar4 - piVar5[1];
                if (iVar7 < 0) {
                  iVar7 = piVar5[1] - iVar4;
                }
                if (iVar7 < 10) {
                  if (-1 < iVar6) goto LAB_18000a57e;
                  break;
                }
              }
              iVar6 = iVar6 + 1;
              lVar17 = lVar17 + 8;
            } while (iVar6 < iVar14);
          }
          piVar8 = FUN_180009b40((int *)param_2,piVar5,0x24,&local_54);
          iVar14 = 0;
          if (0 < *param_4) {
            ppiVar12 = *(int ***)(param_4 + 10);
            do {
              if (*ppiVar12 == piVar8) {
                if (-1 < iVar14) goto LAB_18000a57e;
                break;
              }
              iVar14 = iVar14 + 1;
              ppiVar12 = ppiVar12 + 1;
            } while (iVar14 < *param_4);
          }
          if (local_54 < 10) {
            iVar14 = 0;
            if (0 < lVar16) {
              puVar13 = (ulonglong *)(piVar5 + 4);
              do {
                uVar9 = popcnt(*(ulonglong *)
                                ((longlong)piVar8 + (0x10 - (longlong)(piVar5 + 4)) +
                                (longlong)puVar13) ^ *puVar13);
                iVar14 = iVar14 + (int)uVar9;
                lVar16 = lVar16 + -1;
                puVar13 = puVar13 + 1;
              } while (lVar16 != 0);
            }
            if (param_5 < iVar14) goto LAB_18000a3a7;
LAB_18000a523:
            iVar6 = *param_4;
            lVar16 = (longlong)iVar6;
            piVar10 = (int *)0x0;
            *(int **)(*(longlong *)(param_4 + 8) + lVar16 * 8) = piVar5;
            *(int **)(*(longlong *)(param_4 + 10) + lVar16 * 8) = piVar8;
            *(int *)(*(longlong *)(param_4 + 2) + lVar16 * 4) = iVar14;
            iVar6 = iVar6 + 1;
            *param_4 = iVar6;
            pcVar15 = local_40;
            if ((int)*param_2 <= iVar6) break;
          }
          else {
LAB_18000a3a7:
            sVar11 = *(short *)(param_4 + 5);
            FUN_180009f00(*piVar5,piVar5[1],&local_58,&local_50,
                          (int)*(short *)((longlong)param_4 + 0x16),(int)*(short *)(param_4 + 6),
                          (int)sVar11,(uint)uVar2,(uint)uVar3);
            iVar6 = local_50;
            iVar14 = local_58;
            if ((((local_4c <= local_58) && (local_4c <= local_50)) &&
                (local_58 <= (int)((uint)uVar2 - local_4c))) &&
               (local_50 <= (int)((uint)uVar3 - local_4c))) {
              if ((piVar10 == (int *)0x0) &&
                 (piVar10 = (int *)FUN_18000a0a0(param_2,param_4,param_7), pcVar15 = local_40,
                 piVar10 == (int *)0x0)) break;
              FUN_18001d980((undefined (*) [16])(piVar10 + 4),0,(longlong)local_48);
              sVar11 = *(short *)((longlong)piVar5 + 0xe) + sVar11;
              if (sVar11 < 0) {
                sVar11 = sVar11 + 0x168;
              }
              else {
                if (0x167 < sVar11) {
                  sVar11 = sVar11 + -0x168;
                }
              }
              *(short *)((longlong)piVar10 + 0xe) = sVar11;
              FUN_180015600((longlong)piVar10,param_3,iVar14 << 0x10,iVar6 << 0x10,param_8);
              lVar16 = (longlong)param_6;
              iVar14 = 0;
              if (0 < lVar16) {
                puVar13 = (ulonglong *)(piVar5 + 4);
                do {
                  uVar9 = popcnt(*(ulonglong *)
                                  (*(undefined (*) [16])
                                    ((longlong)(undefined (*) [16])(piVar10 + 4) -
                                    (longlong)(piVar5 + 4)) + (longlong)puVar13) ^ *puVar13);
                  iVar14 = iVar14 + (int)uVar9;
                  lVar16 = lVar16 + -1;
                  puVar13 = puVar13 + 1;
                } while (lVar16 != 0);
              }
              if (iVar14 <= param_5) {
                *piVar10 = *piVar5;
                piVar10[1] = piVar5[1];
                piVar10[2] = piVar5[2];
                piVar8 = piVar10;
                goto LAB_18000a523;
              }
            }
          }
        }
LAB_18000a57e:
        local_74 = local_74 + 1;
        local_68 = local_68 + 8;
        _Memory = _Memory + 1;
        pcVar15 = local_40;
      } while (local_74 < *param_1);
    }
    _Memory = pcVar15;
    local_78 = local_78 + -1;
  } while( true );
}



// WARNING: Could not reconcile some variable overlaps

int FUN_18000a610(uint *param_1,uint *param_2,longlong param_3,uint *param_4,int param_5,
                 char *param_6,uint **param_7)

{
  int iVar1;
  short *psVar2;
  ushort uVar3;
  bool bVar4;
  ulonglong uVar5;
  short sVar6;
  int iVar7;
  uint uVar8;
  undefined8 uVar9;
  longlong *plVar10;
  int *piVar11;
  int **ppiVar12;
  int *piVar13;
  longlong lVar14;
  void *pvVar15;
  uint uVar16;
  uint uVar17;
  char *pcVar18;
  ulonglong *puVar19;
  uint uVar20;
  longlong lVar21;
  int *piVar22;
  uint uVar23;
  int iVar24;
  ulonglong uVar25;
  ulonglong uVar26;
  ulonglong uVar27;
  longlong lVar28;
  ulonglong uVar29;
  uint *puVar30;
  uint *puVar31;
  int **ppiVar32;
  longlong *plVar33;
  ulonglong *puVar34;
  ulonglong uVar35;
  ulonglong uVar36;
  int local_118;
  uint local_114;
  uint local_108;
  uint local_104;
  uint local_100;
  uint uStack252;
  undefined8 uStack248;
  uint local_f0;
  uint uStack236;
  undefined4 uStack232;
  uint uStack228;
  undefined8 local_e0;
  undefined8 uStack216;
  short local_d0;
  short sStack206;
  undefined4 uStack204;
  int local_c8;
  int local_c4;
  int local_c0;
  longlong local_b8;
  int local_b0;
  longlong local_a8;
  ulonglong local_a0;
  int local_98;
  uint local_90 [2];
  uint *local_88;
  void *local_70;
  int **local_68;
  longlong *local_58;
  
  uVar23 = *param_2;
  uVar16 = *param_1;
  local_98 = *(int *)(param_3 + 0x40);
  uVar17 = uVar16;
  if ((int)uVar23 < (int)uVar16) {
    uVar17 = uVar23;
  }
  local_118 = 0;
  if (((int)uVar23 < 1) || ((int)uVar16 < 1)) {
    if (param_4 != (uint *)0x0) {
      *param_4 = 0;
    }
    return 0;
  }
  if (param_5 == 0) {
    local_b0 = *(int *)(param_3 + 0x48);
    if (*(byte *)(param_2 + 2) < 3) {
      iVar24 = 3;
      if (1 < *(byte *)(param_2 + 2)) {
        iVar24 = 6;
      }
    }
    else {
      iVar24 = 8;
    }
    local_c0 = 0x80;
  }
  else {
    local_c0 = 0x20;
    local_b0 = (int)((*(int *)(param_3 + 0x48) >> 0x1f & 3U) + *(int *)(param_3 + 0x48)) >> 2;
    iVar24 = (1 < *(byte *)(param_2 + 2)) + 1;
  }
  iVar7 = *(int *)(param_3 + 0x44) * local_b0 + 0x200;
  local_c8 = (int)(iVar7 + (iVar7 >> 0x1f & 0x3ffU)) >> 10;
  local_c4 = iVar24;
  uVar9 = FUN_18000e320(&local_100,uVar17);
  if ((int)uVar9 != 0) {
    return -1000;
  }
  if ((*(int *)(param_3 + 100) == 1) && (uVar9 = FUN_18000e320(local_90,uVar17), (int)uVar9 != 0)) {
    if (uStack248 != (uint *)0x0) {
      free(uStack248);
    }
    if (local_e0 != (int **)0x0) {
      free(local_e0);
    }
    if (uStack216 == (longlong *)0x0) {
      return -1000;
    }
    free(uStack216);
    return -1000;
  }
  local_b8 = (longlong)iVar24;
  local_114 = 0;
  uVar23 = local_100;
  if ((int)*param_1 < 1) {
    local_108 = local_90[0];
  }
  else {
    pcVar18 = (char *)(**(longlong **)(param_1 + 6) + 0xc);
    local_a8 = 0;
    local_104 = local_100;
    local_108 = local_90[0];
    do {
      uVar27 = 0xffffffffffffffff;
      uVar16 = 0x1e8;
      iVar24 = -1;
      local_a0 = 0xffffffffffffffff;
      uVar17 = 0x1e8;
      if (-1 < *(short *)(pcVar18 + 2)) {
        if (param_5 != 0) {
          uVar8 = local_114 & 0x80000003;
          if ((int)uVar8 < 0) {
            uVar8 = (uVar8 - 1 | 0xfffffffc) + 1;
          }
          if (uVar8 == 0) goto LAB_18000aa4e;
        }
        uVar26 = 0;
        local_58 = *(longlong **)(param_2 + 6);
        if (0 < (int)*param_2) {
          puVar34 = (ulonglong *)(*local_58 + 0x10);
          uVar25 = uVar26;
          uVar35 = 0xffffffff;
          uVar8 = uVar16;
          do {
            uVar36 = uVar35;
            uVar23 = uVar17;
            uVar5 = local_a0;
            uVar16 = uVar8;
            if ((*pcVar18 == *(char *)((longlong)puVar34 + -4)) &&
               (-1 < *(short *)((longlong)puVar34 + -2))) {
              uVar20 = 0;
              uVar29 = uVar27;
              if (0 < local_b8) {
                puVar19 = puVar34;
                lVar28 = local_b8;
                do {
                  uVar9 = popcnt(*(ulonglong *)
                                  (pcVar18 + (4 - (longlong)puVar34) + (longlong)puVar19) ^ *puVar19
                                );
                  uVar20 = uVar20 + (int)uVar9;
                  lVar28 = lVar28 + -1;
                  puVar19 = puVar19 + 1;
                  uVar29 = local_a0;
                } while (lVar28 != 0);
              }
              uVar27 = uVar25;
              uVar36 = uVar26;
              uVar23 = uVar20;
              uVar5 = uVar25;
              uVar16 = uVar17;
              if (((int)uVar17 <= (int)uVar20) &&
                 (uVar27 = uVar29, uVar36 = uVar35, uVar23 = uVar17, uVar5 = local_a0,
                 uVar16 = uVar8, (int)uVar20 < (int)uVar8)) {
                uVar16 = uVar20;
              }
            }
            local_a0 = uVar5;
            uVar17 = uVar23;
            iVar24 = (int)uVar36;
            uVar20 = (int)uVar26 + 1;
            uVar26 = (ulonglong)uVar20;
            uVar25 = uVar25 + 1;
            puVar34 = puVar34 + 10;
            uVar35 = uVar36;
            uVar23 = local_104;
            local_90[0] = local_108;
            uVar8 = uVar16;
          } while ((int)uVar20 < (int)*param_2);
        }
        if ((int)uVar17 <= local_b0) {
          if ((local_98 == 0) || ((int)(uVar17 * 0x400) < (int)(uVar16 * local_98))) {
            FUN_180009a80((int *)&local_100,(longlong)param_1,local_114,(longlong)param_2,iVar24,
                          uVar17);
            uVar27 = 0;
            uVar23 = local_100;
            if ((*(int *)(param_3 + 100) == 1) && (0 < (int)local_90[0])) {
              uVar26 = uVar27;
              do {
                if (local_68[uVar27] == *(int **)(*(longlong *)(param_2 + 6) + local_a0 * 8)) {
                  if (-1 < (int)uVar26) {
                    local_68[uVar27] = (int *)0x0;
                    local_104 = local_100;
                    goto LAB_18000aa4e;
                  }
                  break;
                }
                uVar16 = (int)uVar26 + 1;
                uVar26 = (ulonglong)uVar16;
                uVar27 = uVar27 + 1;
              } while ((int)uVar16 < (int)local_90[0]);
            }
            local_104 = local_100;
          }
          else {
            uVar26 = 0;
            if (((int)uVar17 < local_c8) && (*(int *)(param_3 + 100) != 0)) {
              if (0 < (int)uVar23) {
                plVar10 = uStack216;
                uVar25 = uVar26;
                do {
                  if (*plVar10 == local_58[uVar27]) {
                    if (-1 < (int)uVar25) goto LAB_18000aa4e;
                    break;
                  }
                  uVar16 = (int)uVar25 + 1;
                  uVar25 = (ulonglong)uVar16;
                  plVar10 = plVar10 + 1;
                } while ((int)uVar16 < (int)uVar23);
              }
              if (0 < (int)local_90[0]) {
                uVar25 = uVar26;
                do {
                  if (local_68[uVar25] == (int *)local_58[uVar27]) {
                    if (-1 < (longlong)uVar25) {
                      if (local_88[uVar25] != uVar17 && (int)uVar17 <= (int)local_88[uVar25]) {
                        *(undefined8 *)((longlong)local_70 + uVar25 * 8) =
                             *(undefined8 *)(local_a8 + *(longlong *)(param_1 + 6));
                        local_88[uVar25] = uVar17;
                      }
                      goto LAB_18000aa4e;
                    }
                    break;
                  }
                  uVar16 = (int)uVar26 + 1;
                  uVar26 = (ulonglong)uVar16;
                  uVar25 = uVar25 + 1;
                } while ((int)uVar16 < (int)local_90[0]);
              }
              lVar28 = (longlong)(int)local_90[0];
              local_90[0] = local_90[0] + 1;
              *(undefined8 *)((longlong)local_70 + lVar28 * 8) =
                   *(undefined8 *)(local_a8 + *(longlong *)(param_1 + 6));
              local_68[lVar28] = *(int **)(*(longlong *)(param_2 + 6) + uVar27 * 8);
              local_88[lVar28] = uVar17;
              local_108 = local_90[0];
            }
          }
        }
      }
LAB_18000aa4e:
      local_a8 = local_a8 + 8;
      local_114 = local_114 + 1;
      pcVar18 = pcVar18 + 0x50;
    } while ((int)local_114 < (int)*param_1);
  }
  lVar28 = 0;
  if (0 < (int)uVar23) {
    iVar24 = FUN_1800099a0(&local_100,*(int *)(param_3 + 0x4c));
    if (iVar24 < 2) {
      uVar23 = 0;
      if (0 < (int)local_100) {
        uVar27 = (ulonglong)local_100;
        lVar21 = lVar28;
        plVar10 = uStack216;
        plVar33 = uStack216;
        do {
          if ((uStack248[lVar28] >> 0xf & 1) == 0) {
            if (lVar28 != lVar21) {
              *(undefined8 *)
               ((longlong)(int **)((longlong)local_e0 - (longlong)uStack216) + (longlong)plVar10) =
                   *(undefined8 *)
                    ((longlong)(int **)((longlong)local_e0 - (longlong)uStack216) +
                    (longlong)plVar33);
              *plVar10 = *plVar33;
              uStack248[lVar21] = uStack248[lVar28];
            }
            uVar23 = uVar23 + 1;
            lVar21 = lVar21 + 1;
            plVar10 = plVar10 + 1;
          }
          else {
            uStack248[lVar28] = uStack248[lVar28] & 0xffff7fff;
          }
          lVar28 = lVar28 + 1;
          plVar33 = plVar33 + 1;
          uVar27 = uVar27 - 1;
        } while (uVar27 != 0);
      }
      iVar24 = 0;
      local_100 = uVar23;
      goto LAB_18000ae4c;
    }
    FUN_180009c40((int *)param_2,(short)uStack236);
    iVar24 = *(int *)(param_3 + 0x50);
    iVar7 = FUN_180009760(&local_100,0,iVar24);
    uVar27 = (ulonglong)local_100;
    sVar6 = (short)iVar7;
    if (0 < (int)local_100) {
      uVar26 = (ulonglong)local_100;
      puVar30 = uStack248;
      ppiVar32 = local_e0;
      do {
        if ((*puVar30 >> 0xf & 1) == 0) {
          psVar2 = *(short **)
                    ((longlong)((longlong)uStack216 - (longlong)local_e0) + (longlong)ppiVar32);
          piVar22 = *ppiVar32;
          iVar7 = (int)sVar6;
          if (((int)*(short *)piVar22 - (int)*psVar2) + iVar7 < 0) {
            iVar7 = ((int)*psVar2 - (int)*(short *)piVar22) - iVar7;
          }
          else {
            iVar7 = ((int)*(short *)piVar22 - (int)*psVar2) + iVar7;
          }
          if (iVar24 < iVar7) {
            *puVar30 = *puVar30 | 0x8000;
          }
        }
        ppiVar32 = ppiVar32 + 1;
        puVar30 = puVar30 + 1;
        uVar26 = uVar26 - 1;
      } while (uVar26 != 0);
    }
    iVar24 = *(int *)(param_3 + 0x50);
    uStack236 = CONCAT22(sVar6,(short)uStack236);
    uVar16 = FUN_180009760(&local_100,4,iVar24);
    ppiVar32 = local_e0;
    puVar30 = uStack248;
    if (0 < (int)local_100) {
      uVar26 = uVar27;
      puVar31 = uStack248;
      ppiVar12 = local_e0;
      do {
        if ((*puVar31 >> 0xf & 1) == 0) {
          lVar28 = *(longlong *)
                    ((longlong)ppiVar12 + (longlong)((longlong)uStack216 - (longlong)local_e0));
          piVar22 = *ppiVar12;
          iVar7 = (int)(short)uVar16;
          if (((int)*(short *)(piVar22 + 1) - (int)*(short *)(lVar28 + 4)) + iVar7 < 0) {
            iVar7 = ((int)*(short *)(lVar28 + 4) - (int)*(short *)(piVar22 + 1)) - iVar7;
          }
          else {
            iVar7 = ((int)*(short *)(piVar22 + 1) - (int)*(short *)(lVar28 + 4)) + iVar7;
          }
          if (iVar24 < iVar7) {
            *puVar31 = *puVar31 | 0x8000;
          }
        }
        ppiVar12 = ppiVar12 + 1;
        puVar31 = puVar31 + 1;
        uVar26 = uVar26 - 1;
      } while (uVar26 != 0);
    }
    uVar23 = 0;
    uStack232 = uVar16 & 0xffff | (uint)uStack232._2_2_ << 0x10;
    if (0 < (int)local_100) {
      lVar28 = 0;
      lVar21 = 0;
      plVar10 = uStack216;
      plVar33 = uStack216;
      do {
        if ((uStack248[lVar28] >> 0xf & 1) == 0) {
          if (lVar28 != lVar21) {
            *(undefined8 *)
             ((longlong)(int **)((longlong)local_e0 - (longlong)uStack216) + (longlong)plVar10) =
                 *(undefined8 *)
                  ((longlong)(int **)((longlong)local_e0 - (longlong)uStack216) + (longlong)plVar33)
            ;
            *plVar10 = *plVar33;
            uStack248[lVar21] = uStack248[lVar28];
          }
          uVar23 = uVar23 + 1;
          lVar21 = lVar21 + 1;
          plVar10 = plVar10 + 1;
        }
        else {
          uStack248[lVar28] = uStack248[lVar28] & 0xffff7fff;
        }
        lVar28 = lVar28 + 1;
        plVar33 = plVar33 + 1;
        uVar27 = uVar27 - 1;
      } while (uVar27 != 0);
    }
    local_100 = uVar23;
    FUN_180009560((int *)param_2,(int)sVar6,(int)(short)uVar16);
    if (((1 < (int)uVar23) && (*(int *)(param_3 + 100) == 1)) && (0 < (int)local_108)) {
      uVar27 = (ulonglong)local_108;
      ppiVar12 = local_68;
      puVar31 = local_88;
      do {
        piVar22 = *ppiVar12;
        if (piVar22 != (int *)0x0) {
          piVar11 = *(int **)((longlong)((longlong)local_70 - (longlong)local_68) +
                             (longlong)ppiVar12);
          uVar16 = piVar22[1] - piVar11[1] >> 0x1f;
          if (((int)((piVar22[1] - piVar11[1] ^ uVar16) - uVar16) <= *(int *)(param_3 + 0x50)) &&
             (uVar16 = *piVar22 - *piVar11 >> 0x1f,
             (int)((*piVar22 - *piVar11 ^ uVar16) - uVar16) <= *(int *)(param_3 + 0x50))) {
            iVar24 = (int)*(short *)((longlong)piVar22 + 0xe) -
                     (int)*(short *)((longlong)piVar11 + 0xe);
            uVar3 = (ushort)(iVar24 >> 0x1f);
            sVar6 = ((ushort)iVar24 ^ uVar3) - uVar3;
            if (0xb4 < sVar6) {
              sVar6 = 0x168 - sVar6;
            }
            if ((int)sVar6 <= *(int *)(param_3 + 0x4c)) {
              lVar28 = (longlong)(int)uVar23;
              uVar23 = uVar23 + 1;
              ppiVar32[lVar28] = piVar11;
              uStack216[lVar28] = (longlong)*ppiVar12;
              puVar30[lVar28] = *puVar31;
              local_100 = uVar23;
            }
          }
        }
        ppiVar12 = ppiVar12 + 1;
        puVar31 = puVar31 + 1;
        uVar27 = uVar27 - 1;
      } while (uVar27 != 0);
    }
  }
  iVar24 = local_118;
  if (*(int *)(param_3 + 0x58) <= (int)uVar23) {
    if (param_7 == (uint **)0x0) {
      iVar7 = 0;
      iVar24 = 0;
      piVar22 = **(int ***)(param_1 + 6);
      if (0 < (int)*param_1) {
        do {
          plVar10 = uStack216;
          ppiVar32 = local_e0;
          uVar27 = 0;
          if (-1 < *(short *)((longlong)piVar22 + 0xe)) {
            if (0 < (int)uVar23) {
              ppiVar12 = local_e0;
              uVar26 = uVar27;
              do {
                if (*(int **)((longlong)((longlong)uStack216 - (longlong)local_e0) +
                             (longlong)ppiVar12) == piVar22) {
                  piVar11 = local_e0[uVar26];
LAB_18000af04:
                  if (piVar11 != (int *)0x0) goto LAB_18000b054;
                  break;
                }
                if (*ppiVar12 == piVar22) {
                  piVar11 = (int *)uStack216[uVar26];
                  goto LAB_18000af04;
                }
                uVar16 = (int)uVar27 + 1;
                uVar27 = (ulonglong)uVar16;
                uVar26 = uVar26 + 1;
                ppiVar12 = ppiVar12 + 1;
              } while ((int)uVar16 < (int)uVar23);
            }
            piVar11 = FUN_180009b40((int *)param_2,piVar22,9,(int *)0x0);
            if (piVar11 != (int *)0x0) {
              if (*(char *)(piVar11 + 3) == *(char *)(piVar22 + 3)) {
                iVar24 = (int)*(short *)((longlong)piVar22 + 0xe) -
                         (int)*(short *)((longlong)piVar11 + 0xe);
                uVar3 = (ushort)(iVar24 >> 0x1f);
                sVar6 = ((ushort)iVar24 ^ uVar3) - uVar3;
                if (0xb4 < sVar6) {
                  sVar6 = 0x168 - sVar6;
                }
                uVar27 = 0;
                if ((int)sVar6 <= *(int *)(param_3 + 0x4c)) {
                  uVar16 = 0;
                  if (0 < local_b8) {
                    puVar34 = (ulonglong *)(piVar22 + 4);
                    uVar26 = uVar27;
                    lVar28 = local_b8;
                    do {
                      uVar9 = popcnt(*(ulonglong *)
                                      ((longlong)piVar11 + (0x10 - (longlong)(piVar22 + 4)) +
                                      (longlong)puVar34) ^ *puVar34);
                      uVar16 = (int)uVar26 + (int)uVar9;
                      uVar26 = (ulonglong)uVar16;
                      lVar28 = lVar28 + -1;
                      puVar34 = puVar34 + 1;
                    } while (lVar28 != 0);
                  }
                  if ((int)uVar16 < local_c8) {
                    if (0 < (int)uVar23) {
                      ppiVar12 = ppiVar32;
                      uVar26 = uVar27;
                      do {
                        if (*(int **)((longlong)((longlong)plVar10 - (longlong)ppiVar32) +
                                     (longlong)ppiVar12) == piVar11) {
                          piVar13 = ppiVar32[uVar26];
LAB_18000aff4:
                          if (piVar13 != (int *)0x0) goto LAB_18000b054;
                          break;
                        }
                        if (*ppiVar12 == piVar11) {
                          piVar13 = (int *)plVar10[uVar26];
                          goto LAB_18000aff4;
                        }
                        uVar17 = (int)uVar27 + 1;
                        uVar27 = (ulonglong)uVar17;
                        uVar26 = uVar26 + 1;
                        ppiVar12 = ppiVar12 + 1;
                      } while ((int)uVar17 < (int)uVar23);
                    }
                    lVar28 = (longlong)(int)uVar23;
                    uVar23 = uVar23 + 1;
                    ppiVar32[lVar28] = piVar22;
                    plVar10[lVar28] = (longlong)piVar11;
                    uStack248[lVar28] = uVar16;
                    local_100 = uVar23;
                  }
                  if (0x100 < (int)uVar16) {
                    if (*(char *)((longlong)piVar22 + 0xd) == -5) {
                      local_118 = local_118 - ((int)(uVar16 + ((int)uVar16 >> 0x1f & 3U)) >> 2);
                    }
                    else {
                      local_118 = local_118 - (int)uVar16 / 2;
                    }
                  }
                }
              }
              else {
                local_118 = local_118 + -2;
              }
            }
          }
LAB_18000b054:
          iVar7 = iVar7 + 1;
          piVar22 = piVar22 + 0x14;
          iVar24 = local_118;
        } while (iVar7 < (int)*param_1);
      }
    }
    else {
      FUN_180009e50(param_7,*(ulonglong *)(param_2 + 4),(uint)*(ushort *)(param_2 + 1),
                    (uint)*(ushort *)((longlong)param_2 + 6),param_3);
      uVar9 = FUN_18000a150((int *)param_1,param_2,(int **)param_7,(int *)&local_100,local_c8,
                            local_c4,param_6,param_3);
      uVar23 = local_100;
      iVar24 = (int)uVar9;
    }
  }
LAB_18000ae4c:
  ppiVar32 = local_e0;
  if (*(int *)(param_3 + 100) == 1) {
    if (local_88 != (uint *)0x0) {
      free(local_88);
    }
    if (local_70 != (void *)0x0) {
      free(local_70);
    }
    if (local_68 != (int **)0x0) {
      free(local_68);
    }
  }
  if ((param_6 == (char *)0x0) || ((int)uVar23 < *(int *)(param_3 + 0x58))) {
    bVar4 = false;
  }
  else {
    bVar4 = true;
  }
  lVar21 = 0;
  lVar28 = (longlong)(int)uVar23;
  if (0 < (int)uVar23) {
    do {
      iVar7 = local_c0 - uStack248[lVar21];
      if (param_5 != 0) {
        iVar7 = iVar7 * 4;
      }
      iVar1 = *(int *)(param_3 + 0x94);
      if ((0 < iVar1) && (iVar7 < iVar1 * 2)) {
        iVar7 = iVar1 + iVar7 / 2;
      }
      iVar24 = iVar24 + iVar7;
      if (bVar4) {
        lVar14 = (longlong)(int)((uStack216[lVar21] - **(longlong **)(param_2 + 6)) / 0x50);
        if (param_6[lVar14] == '\x01') {
          local_d0 = local_d0 + (short)iVar7;
          sStack206 = sStack206 + 1;
        }
        else {
          param_6[lVar14] = '\x01';
        }
      }
      lVar21 = lVar21 + 1;
      ppiVar32 = local_e0;
    } while (lVar21 < lVar28);
  }
  if (iVar24 < 0) {
    iVar24 = 0;
  }
  if (param_4 == (uint *)0x0) {
    if (uStack248 != (uint *)0x0) {
      free(uStack248);
    }
    if (local_e0 != (int **)0x0) {
      free(local_e0);
    }
    if (uStack216 != (longlong *)0x0) {
      free(uStack216);
      return iVar24;
    }
    return iVar24;
  }
  uStack248 = (uint *)realloc(uStack248,lVar28 * 4);
  local_e0 = (int **)realloc(ppiVar32,lVar28 * 8);
  pvVar15 = realloc(uStack216,lVar28 * 8);
  *param_4 = local_100;
  param_4[1] = uStack252;
  param_4[2] = (uint)uStack248;
  param_4[3] = uStack248._4_4_;
  uStack216._0_4_ = (uint)pvVar15;
  uStack216._4_4_ = (uint)((ulonglong)pvVar15 >> 0x20);
  param_4[4] = local_f0;
  param_4[5] = uStack236;
  param_4[6] = uStack232;
  param_4[7] = uStack228;
  param_4[8] = (uint)local_e0;
  param_4[9] = local_e0._4_4_;
  param_4[10] = (uint)uStack216;
  param_4[0xb] = uStack216._4_4_;
  *(ulonglong *)(param_4 + 0xc) = CONCAT44(uStack204,CONCAT22(sStack206,local_d0));
  return iVar24;
}



int FUN_18000b240(uint *param_1,uint *param_2,longlong param_3,uint *param_4)

{
  int iVar1;
  uint **_Memory;
  
  _Memory = (uint **)0x0;
  if (*(longlong *)(param_2 + 4) != 0) {
    _Memory = (uint **)calloc(1,0x18);
  }
  iVar1 = FUN_18000a610(param_1,param_2,param_3,param_4,0,(char *)0x0,_Memory);
  if (_Memory != (uint **)0x0) {
    if (*_Memory != (uint *)0x0) {
      free(*_Memory);
    }
    if (_Memory[1] != (uint *)0x0) {
      free(_Memory[1]);
    }
    if (_Memory[2] != (uint *)0x0) {
      free(_Memory[2]);
    }
    free(_Memory);
  }
  return iVar1;
}



void FUN_18000b300(int *param_1)

{
  char cVar1;
  int iVar2;
  longlong lVar3;
  
  iVar2 = 0;
  if (0 < *param_1) {
    lVar3 = 0;
    do {
      cVar1 = *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 8)) + 0xd);
      if (cVar1 < '\x7f') {
        *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 8)) + 0xd) = cVar1 + '\x01';
      }
      cVar1 = *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 10)) + 0xd);
      if (cVar1 < '\x7f') {
        *(char *)(*(longlong *)(lVar3 + *(longlong *)(param_1 + 10)) + 0xd) = cVar1 + '\x01';
      }
      iVar2 = iVar2 + 1;
      lVar3 = lVar3 + 8;
    } while (iVar2 < *param_1);
  }
  return;
}



ulonglong FUN_18000b350(int *param_1,char *param_2)

{
  undefined (*pauVar1) [16];
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined (**_Memory) [16];
  ulonglong uVar5;
  ulonglong uVar6;
  uint uVar7;
  longlong lVar8;
  undefined (**ppauVar9) [16];
  uint uVar10;
  longlong lVar11;
  ulonglong uVar12;
  longlong lVar13;
  char *pcVar14;
  ulonglong uVar15;
  uint local_res20 [2];
  longlong local_58;
  
  uVar7 = (uint)(*(ushort *)((longlong)param_1 + 6) >> 2);
  uVar2 = (uint)(*(ushort *)(param_1 + 1) >> 2);
  _Memory = (undefined (**) [16])FUN_180007180(uVar2,uVar7);
  if (_Memory != (undefined (**) [16])0x0) {
    uVar15 = SEXT48((int)(uVar7 * uVar2));
    lVar11 = 0;
    local_58 = 2;
    do {
      uVar12 = 0;
      FUN_18001d980(*_Memory,0,uVar15);
      iVar4 = *param_1;
      local_res20[lVar11] = 0;
      uVar6 = uVar12;
      uVar5 = uVar12;
      pcVar14 = param_2;
      if (0 < iVar4) {
        do {
          if ((lVar11 != 1) || (*pcVar14 != '\0')) {
            iVar4 = **(int **)(uVar5 + *(longlong *)(param_1 + 6));
            iVar3 = (int)(iVar4 + (iVar4 >> 0x1f & 3U)) >> 2;
            iVar4 = (*(int **)(uVar5 + *(longlong *)(param_1 + 6)))[1];
            iVar4 = (int)(iVar4 + (iVar4 >> 0x1f & 3U)) >> 2;
            if ((0 < iVar3) &&
               (((iVar3 < (int)(uVar2 - 1) && (0 < iVar4)) && (iVar4 < (int)(uVar7 - 1))))) {
              lVar8 = (longlong)(iVar4 + -1);
              if (lVar8 <= iVar4 + 1) {
                ppauVar9 = _Memory + lVar8;
                lVar13 = ((iVar4 + 1) - lVar8) + 1;
                lVar8 = (longlong)iVar3 + -1;
                do {
                  for (; lVar8 <= iVar3 + 1; lVar8 = lVar8 + 1) {
                    (**ppauVar9)[lVar8] = 1;
                  }
                  ppauVar9 = ppauVar9 + 1;
                  lVar13 = lVar13 + -1;
                  lVar8 = (longlong)iVar3 + -1;
                } while (lVar13 != 0);
              }
            }
          }
          uVar10 = (int)uVar6 + 1;
          uVar6 = (ulonglong)uVar10;
          uVar5 = uVar5 + 8;
          pcVar14 = pcVar14 + 1;
        } while ((int)uVar10 < *param_1);
      }
      uVar6 = 0;
      if (uVar15 != 0) {
        pauVar1 = *_Memory;
        uVar5 = uVar6;
        do {
          if ((*pauVar1)[uVar5] == '\x01') {
            uVar10 = (int)uVar12 + 1;
            uVar12 = (ulonglong)uVar10;
            local_res20[lVar11] = uVar10;
          }
          uVar5 = uVar5 + 1;
        } while ((longlong)uVar5 < (longlong)uVar15);
      }
      lVar11 = lVar11 + 1;
      local_58 = local_58 + -1;
    } while (local_58 != 0);
    free(_Memory);
    if (local_res20[0] != 0) {
      uVar6 = (longlong)(int)(local_res20[1] * 100) / (longlong)(int)local_res20[0] & 0xffffffff;
    }
    return uVar6;
  }
  return 0;
}



int FUN_18000b560(int *param_1,int *param_2,longlong param_3,longlong param_4,int param_5)

{
  uint uVar1;
  char *_Memory;
  uint **_Memory_00;
  uint *_Memory_01;
  uint *_Memory_02;
  ulonglong uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  int local_res10;
  
  iVar5 = 0;
  _Memory_00 = (uint **)0x0;
  local_res10 = 0;
  if (*param_2 < 1) {
    return 0;
  }
  _Memory = (char *)calloc((longlong)*param_2,1);
  if (_Memory == (char *)0x0) {
    iVar3 = -1000;
  }
  else {
    if (*(longlong *)(param_2 + 4) != 0) {
      _Memory_00 = (uint **)calloc(1,0x18);
    }
    iVar4 = 0;
    iVar3 = 0;
    if (0 < *param_1) {
      lVar6 = 0;
      do {
        _Memory_01 = (uint *)FUN_18000e240(param_2);
        _Memory_02 = (uint *)calloc(1,0x38);
        if (_Memory_01 == (uint *)0x0) goto LAB_18000b6e0;
        if (_Memory_02 == (uint *)0x0) {
LAB_18000b725:
          if (_Memory_01 != (uint *)0x0) {
            free(*(void **)(_Memory_01 + 4));
            free(_Memory_01);
          }
        }
        else {
          *(undefined8 *)(_Memory_01 + 4) = *(undefined8 *)(param_2 + 4);
          uVar1 = FUN_18000a610(*(uint **)(*(longlong *)(param_1 + 2) + lVar6),_Memory_01,param_4,
                                _Memory_02,param_5,_Memory,_Memory_00);
          *(undefined8 *)(_Memory_01 + 4) = 0;
          _Memory_02[4] = uVar1;
          if ((int)*_Memory_02 < *(int *)(param_4 + 0x58)) {
            if (param_3 != 0) {
              *(undefined8 *)(lVar6 + *(longlong *)(param_3 + 0x10)) = 0;
            }
LAB_18000b6e0:
            if (_Memory_02 != (uint *)0x0) {
              if (*(void **)(_Memory_02 + 2) != (void *)0x0) {
                free(*(void **)(_Memory_02 + 2));
              }
              if (*(void **)(_Memory_02 + 8) != (void *)0x0) {
                free(*(void **)(_Memory_02 + 8));
              }
              if (*(void **)(_Memory_02 + 10) != (void *)0x0) {
                free(*(void **)(_Memory_02 + 10));
              }
              *(undefined8 *)(_Memory_02 + 2) = 0;
              *(undefined8 *)(_Memory_02 + 8) = 0;
              *(undefined8 *)(_Memory_02 + 10) = 0;
              free(_Memory_02);
            }
            goto LAB_18000b725;
          }
          if (param_5 == 0) {
            FUN_18000b300((int *)_Memory_02);
          }
          iVar5 = iVar5 + (*_Memory_02 - (int)*(short *)((longlong)_Memory_02 + 0x32));
          local_res10 = local_res10 + (uVar1 - (int)*(short *)(_Memory_02 + 0xc));
          if (param_3 == 0) goto LAB_18000b6e0;
          *(uint **)(lVar6 + *(longlong *)(param_3 + 0x18)) = _Memory_01;
          *(uint **)(lVar6 + *(longlong *)(param_3 + 0x10)) = _Memory_02;
          *(int *)(param_3 + 4) = iVar5;
        }
        iVar4 = iVar4 + 1;
        lVar6 = lVar6 + 8;
        iVar3 = local_res10;
      } while (iVar4 < *param_1);
    }
    if (_Memory_00 != (uint **)0x0) {
      if (*_Memory_00 != (uint *)0x0) {
        free(*_Memory_00);
      }
      if (_Memory_00[1] != (uint *)0x0) {
        free(_Memory_00[1]);
      }
      if (_Memory_00[2] != (uint *)0x0) {
        free(_Memory_00[2]);
      }
      free(_Memory_00);
    }
    if ((0 < iVar3) && (param_3 != 0)) {
      uVar2 = FUN_18000b350(param_2,_Memory);
      *(int *)(param_3 + 8) = (int)uVar2;
    }
    free(_Memory);
  }
  return iVar3;
}



void FUN_18000b7d0(int *param_1,short param_2)

{
  short *psVar1;
  ushort uVar2;
  ushort uVar3;
  uint uVar4;
  uint uVar5;
  int *piVar6;
  short sVar7;
  int iVar8;
  int iVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  
  uVar2 = *(ushort *)(param_1 + 1);
  uVar3 = *(ushort *)((longlong)param_1 + 6);
  iVar11 = 0;
  if (param_2 == 0) {
    sVar7 = 0;
  }
  else {
    sVar7 = param_2;
    if (param_2 < 1) {
      sVar7 = param_2 + 0x168;
    }
    sVar7 = 0x168 - sVar7;
  }
  uVar4 = *(uint *)((longlong)&DAT_180041b60 + (longlong)sVar7 * 4);
  uVar5 = *(uint *)((longlong)&DAT_180042100 + (longlong)sVar7 * 4);
  iVar15 = (uVar4 ^ (int)uVar4 >> 0x1f) - ((int)uVar4 >> 0x1f);
  iVar14 = (uVar5 ^ (int)uVar5 >> 0x1f) - ((int)uVar5 >> 0x1f);
  iVar12 = iVar15 * (uint)uVar3;
  iVar9 = iVar14 * (uint)uVar2;
  iVar15 = iVar15 * (uint)uVar2;
  iVar14 = iVar14 * (uint)uVar3;
  if ((param_2 != 0) && (0 < *param_1)) {
    lVar10 = 0;
    do {
      piVar6 = *(int **)(lVar10 + *(longlong *)(param_1 + 6));
      iVar16 = *piVar6 - (uint)(uVar2 >> 1);
      iVar17 = piVar6[1] - (uint)(uVar3 >> 1);
      iVar8 = iVar16 * uVar5;
      iVar13 = iVar17 * uVar4;
      iVar17 = iVar17 * uVar5;
      iVar16 = iVar16 * uVar4;
      *piVar6 = ((int)((((0 < iVar8 - iVar13) + 0x7fff) - iVar13) + iVar8) >> 0x10) +
                (int)(((int)((uint)(0 < iVar9 + iVar12) + iVar9 + 0x7fff + iVar12) >> 0x10) -
                     (uint)uVar2) / 2 + (uint)(uVar2 >> 1);
      *(uint *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 4) =
           ((int)((0 < iVar16 + iVar17) + 0x7fff + iVar16 + iVar17) >> 0x10) +
           (int)(((int)((0 < iVar14 + iVar15) + 0x7fff + iVar14 + iVar15) >> 0x10) - (uint)uVar3) /
           2 + (uint)(uVar3 >> 1);
      psVar1 = (short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe);
      *psVar1 = *psVar1 - param_2;
      sVar7 = *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe);
      if (sVar7 < 0) {
        *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe) = sVar7 + 0x168;
      }
      sVar7 = *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe);
      if (0x167 < sVar7) {
        *(short *)(*(longlong *)(lVar10 + *(longlong *)(param_1 + 6)) + 0xe) = sVar7 + -0x168;
      }
      iVar11 = iVar11 + 1;
      lVar10 = lVar10 + 8;
    } while (iVar11 < *param_1);
  }
  return;
}



void * FUN_18000b9c0(int param_1,int param_2)

{
  void *pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = calloc(1,(longlong)(param_2 * 8) + (longlong)(param_1 * param_2) * 8);
  if (pvVar1 == (void *)0x0) {
    return (void *)0x0;
  }
  lVar2 = (longlong)pvVar1 + (longlong)(param_2 * 8);
  lVar3 = 0;
  if (0 < param_2) {
    do {
      *(longlong *)((longlong)pvVar1 + lVar3 * 8) = lVar2;
      lVar3 = lVar3 + 1;
      lVar2 = lVar2 + (longlong)param_1 * 8;
    } while (lVar3 < param_2);
  }
  return pvVar1;
}



// WARNING: Type propagation algorithm not settling

void * FUN_18000ba50(void)

{
  int iVar1;
  void *pvVar2;
  undefined (*pauVar3) [16];
  void *pvVar4;
  size_t _Count;
  
  iVar1 = *(int *)(DAT_18004cfd0 + 0x70);
  _Count = SEXT48(iVar1);
  pvVar2 = calloc(1,0x90);
  if (pvVar2 == (void *)0x0) {
    return (void *)0x0;
  }
  *(int *)((longlong)pvVar2 + 0x10) = iVar1;
  pauVar3 = (undefined (*) [16])FUN_180007180(iVar1,iVar1);
  if (pauVar3 != (undefined (*) [16])0x0) {
    FUN_18001d980(*(undefined (**) [16])*pauVar3,0,(longlong)(iVar1 * iVar1));
  }
  *(undefined (**) [16])((longlong)pvVar2 + 0x40) = pauVar3;
  pvVar4 = FUN_18000b9c0(iVar1,iVar1);
  *(void **)((longlong)pvVar2 + 0x88) = pvVar4;
  pvVar4 = FUN_18000b9c0(iVar1,iVar1);
  *(void **)((longlong)pvVar2 + 0x50) = pvVar4;
  pvVar4 = calloc(_Count,8);
  *(void **)((longlong)pvVar2 + 0x48) = pvVar4;
  pvVar4 = calloc(_Count,8);
  *(void **)((longlong)pvVar2 + 0x58) = pvVar4;
  pvVar4 = calloc(_Count,1);
  *(void **)((longlong)pvVar2 + 0x38) = pvVar4;
  pvVar4 = calloc(_Count,8);
  *(void **)((longlong)pvVar2 + 0x68) = pvVar4;
  return pvVar2;
}



uint FUN_18000bb30(int *param_1)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  ulonglong uVar4;
  uint **ppuVar5;
  longlong lVar6;
  
  lVar6 = (longlong)*param_1;
  uVar3 = 0x2000;
  if (0 < lVar6) {
    ppuVar5 = *(uint ***)(param_1 + 2);
    do {
      uVar1 = **ppuVar5;
      if (0 < (int)uVar1) {
        puVar2 = (uint *)(**(longlong **)(*ppuVar5 + 6) + 8);
        uVar4 = (ulonglong)uVar1;
        do {
          if ((-1 < *(short *)((longlong)puVar2 + 6)) && (*puVar2 < uVar3)) {
            uVar3 = *puVar2;
          }
          puVar2 = puVar2 + 0x14;
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
      }
      ppuVar5 = ppuVar5 + 1;
      lVar6 = lVar6 + -1;
    } while (lVar6 != 0);
  }
  return uVar3;
}



undefined8 FUN_18000bb80(int *param_1,longlong param_2)

{
  byte bVar1;
  int *piVar2;
  ulonglong uVar3;
  short *psVar4;
  int iVar5;
  char cVar6;
  longlong lVar7;
  uint uVar8;
  uint uVar9;
  short local_res8 [4];
  
  cVar6 = '\0';
  bVar1 = *(byte *)(**(longlong **)(param_1 + 2) + 8);
  if ((*param_1 - 1U < 0x28) && (*(longlong **)(param_1 + 2) != (longlong *)0x0)) {
    uVar3 = FUN_18000ea60(param_1,local_res8,*(int *)(param_2 + 0x58));
    if (-1 < (int)uVar3) {
      iVar5 = *(int *)(param_2 + 0x88);
      uVar8 = (int)uVar3 + 0x20;
      uVar3 = (ulonglong)uVar8;
      if (iVar5 < (int)uVar8) {
        do {
          uVar8 = FUN_18000bb30(param_1);
          if (iVar5 < (int)uVar3) {
            do {
              uVar8 = uVar8 + 10;
              if (0x1ffe < uVar8) break;
              lVar7 = (longlong)(*param_1 + -1);
              if (-1 < *param_1 + -1) {
                do {
                  iVar5 = 0;
                  piVar2 = *(int **)(*(longlong *)(param_1 + 2) + lVar7 * 8);
                  if (0 < *piVar2) {
                    psVar4 = (short *)(**(longlong **)(piVar2 + 6) + 0xe);
                    do {
                      if (((-1 < *psVar4) && (*(uint *)(psVar4 + -3) < uVar8)) &&
                         (*(char *)((longlong)psVar4 + -1) == cVar6 ||
                          *(char *)((longlong)psVar4 + -1) < cVar6)) {
                        uVar9 = (int)uVar3 - (((int)((uint)bVar1 * 0xa2 + 7) >> 3) + 8);
                        uVar3 = (ulonglong)uVar9;
                        *psVar4 = -1;
                        if ((int)uVar9 <= *(int *)(param_2 + 0x88)) {
                          return 0;
                        }
                      }
                      iVar5 = iVar5 + 1;
                      psVar4 = psVar4 + 0x28;
                    } while (iVar5 < *piVar2);
                  }
                  lVar7 = lVar7 + -1;
                } while (-1 < lVar7);
              }
              iVar5 = *(int *)(param_2 + 0x88);
            } while (iVar5 < (int)uVar3);
          }
          cVar6 = cVar6 + '\x01';
        } while (cVar6 < '\x7f');
      }
      return 0;
    }
  }
  return 0xfffffc17;
}



void FUN_18000bce0(longlong param_1)

{
  void *pvVar1;
  longlong lVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  uint uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  
  uVar8 = 0;
  if (*(void **)(param_1 + 0x38) != (void *)0x0) {
    free(*(void **)(param_1 + 0x38));
    *(undefined8 *)(param_1 + 0x38) = 0;
  }
  if (*(longlong *)(param_1 + 0x48) != 0) {
    uVar3 = uVar8;
    uVar7 = uVar8;
    if (0 < *(int *)(param_1 + 4)) {
      do {
        pvVar1 = *(void **)(uVar7 + *(longlong *)(param_1 + 0x48));
        if (pvVar1 != (void *)0x0) {
          free(*(void **)((longlong)pvVar1 + 0x10));
          free(pvVar1);
          *(undefined8 *)(uVar7 + *(longlong *)(param_1 + 0x48)) = 0;
        }
        uVar5 = (int)uVar3 + 1;
        uVar3 = (ulonglong)uVar5;
        uVar7 = uVar7 + 8;
      } while ((int)uVar5 < *(int *)(param_1 + 4));
    }
    free(*(void **)(param_1 + 0x48));
    *(undefined8 *)(param_1 + 0x48) = 0;
  }
  if (*(longlong *)(param_1 + 0x50) != 0) {
    uVar3 = uVar8;
    uVar7 = uVar8;
    if (0 < *(int *)(param_1 + 4)) {
      do {
        uVar4 = uVar8;
        uVar6 = uVar8;
        if (0 < *(int *)(param_1 + 4)) {
          do {
            pvVar1 = *(void **)(uVar6 + *(longlong *)(uVar7 + *(longlong *)(param_1 + 0x50)));
            if (pvVar1 != (void *)0x0) {
              free(pvVar1);
              *(undefined8 *)(uVar6 + *(longlong *)(uVar7 + *(longlong *)(param_1 + 0x50))) = 0;
            }
            uVar5 = (int)uVar4 + 1;
            uVar4 = (ulonglong)uVar5;
            uVar6 = uVar6 + 8;
          } while ((int)uVar5 < *(int *)(param_1 + 4));
        }
        uVar5 = (int)uVar3 + 1;
        uVar3 = (ulonglong)uVar5;
        uVar7 = uVar7 + 8;
      } while ((int)uVar5 < *(int *)(param_1 + 4));
    }
    free(*(void **)(param_1 + 0x50));
    *(undefined8 *)(param_1 + 0x50) = 0;
  }
  if (*(longlong *)(param_1 + 0x88) != 0) {
    uVar3 = uVar8;
    uVar7 = uVar8;
    if (0 < *(int *)(param_1 + 4)) {
      do {
        uVar4 = uVar8;
        uVar6 = uVar8;
        if (0 < *(int *)(param_1 + 4)) {
          do {
            lVar2 = *(longlong *)(uVar6 + *(longlong *)(*(longlong *)(param_1 + 0x88) + uVar3));
            if (lVar2 != 0) {
              if (*(void **)(lVar2 + 8) != (void *)0x0) {
                free(*(void **)(lVar2 + 8));
              }
              if (*(void **)(lVar2 + 0x20) != (void *)0x0) {
                free(*(void **)(lVar2 + 0x20));
              }
              if (*(void **)(lVar2 + 0x28) != (void *)0x0) {
                free(*(void **)(lVar2 + 0x28));
              }
              *(undefined8 *)(lVar2 + 8) = 0;
              *(undefined8 *)(lVar2 + 0x20) = 0;
              *(undefined8 *)(lVar2 + 0x28) = 0;
              free(*(void **)(*(longlong *)(*(longlong *)(param_1 + 0x88) + uVar3) + uVar6));
              *(undefined8 *)(uVar6 + *(longlong *)(*(longlong *)(param_1 + 0x88) + uVar3)) = 0;
            }
            uVar5 = (int)uVar4 + 1;
            uVar4 = (ulonglong)uVar5;
            uVar6 = uVar6 + 8;
          } while ((int)uVar5 < *(int *)(param_1 + 4));
        }
        uVar5 = (int)uVar7 + 1;
        uVar3 = uVar3 + 8;
        uVar7 = (ulonglong)uVar5;
      } while ((int)uVar5 < *(int *)(param_1 + 4));
    }
    free(*(void **)(param_1 + 0x88));
    *(undefined8 *)(param_1 + 0x88) = 0;
  }
  if (*(void **)(param_1 + 0x40) != (void *)0x0) {
    free(*(void **)(param_1 + 0x40));
    *(undefined8 *)(param_1 + 0x40) = 0;
  }
  return;
}



void FUN_18000bee0(longlong param_1)

{
  void *pvVar1;
  ulonglong uVar2;
  uint uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  
  uVar2 = 0;
  if (*(longlong *)(param_1 + 0x58) != 0) {
    uVar4 = uVar2;
    uVar5 = uVar2;
    if (0 < *(int *)(param_1 + 0x1c)) {
      do {
        pvVar1 = *(void **)(uVar5 + *(longlong *)(param_1 + 0x58));
        if (pvVar1 != (void *)0x0) {
          free(pvVar1);
          *(undefined8 *)(uVar5 + *(longlong *)(param_1 + 0x58)) = 0;
        }
        uVar3 = (int)uVar4 + 1;
        uVar4 = (ulonglong)uVar3;
        uVar5 = uVar5 + 8;
      } while ((int)uVar3 < *(int *)(param_1 + 0x1c));
    }
    *(undefined4 *)(param_1 + 0x1c) = 0;
  }
  if (*(longlong *)(param_1 + 0x68) != 0) {
    uVar4 = uVar2;
    if (0 < *(int *)(param_1 + 0x28)) {
      do {
        pvVar1 = *(void **)(uVar4 + *(longlong *)(param_1 + 0x68));
        if (pvVar1 != (void *)0x0) {
          free(pvVar1);
          *(undefined8 *)(uVar4 + *(longlong *)(param_1 + 0x68)) = 0;
        }
        uVar3 = (int)uVar2 + 1;
        uVar2 = (ulonglong)uVar3;
        uVar4 = uVar4 + 8;
      } while ((int)uVar3 < *(int *)(param_1 + 0x28));
    }
    *(undefined4 *)(param_1 + 0x28) = 0;
  }
  return;
}



void FUN_18000bf90(void *param_1)

{
  void *_Memory;
  
  FUN_18000bee0((longlong)param_1);
  free(*(void **)((longlong)param_1 + 0x58));
  free(*(void **)((longlong)param_1 + 0x68));
  if (*(void **)((longlong)param_1 + 0x70) != (void *)0x0) {
    free(*(void **)((longlong)param_1 + 0x70));
    *(undefined8 *)((longlong)param_1 + 0x70) = 0;
  }
  _Memory = *(void **)((longlong)param_1 + 0x60);
  if (_Memory != (void *)0x0) {
    free(*(void **)((longlong)_Memory + 0x10));
    free(_Memory);
    *(undefined8 *)((longlong)param_1 + 0x60) = 0;
  }
  free(param_1);
  return;
}



int * FUN_18000c000(void *param_1)

{
  int *piVar1;
  longlong lVar2;
  ulonglong uVar3;
  void *pvVar4;
  longlong lVar5;
  undefined8 uVar6;
  int *_Memory;
  int iVar7;
  int iVar8;
  longlong lVar9;
  
  uVar3 = DAT_18004cfd0;
  _Memory = *(int **)((longlong)param_1 + 0x78);
  if (_Memory == (int *)0x0) {
    pvVar4 = calloc(1,0x150);
    if (pvVar4 != (void *)0x0) {
      *(longlong *)((longlong)pvVar4 + 8) = (longlong)pvVar4 + 0x10;
    }
    *(void **)((longlong)param_1 + 0x78) = pvVar4;
    FUN_18000cd50((longlong)param_1,uVar3);
    FUN_18000bce0((longlong)param_1);
    _Memory = *(int **)((longlong)param_1 + 0x78);
  }
  FUN_18000bee0((longlong)param_1);
  free(*(void **)((longlong)param_1 + 0x58));
  free(*(void **)((longlong)param_1 + 0x68));
  if (*(void **)((longlong)param_1 + 0x70) != (void *)0x0) {
    free(*(void **)((longlong)param_1 + 0x70));
    *(undefined8 *)((longlong)param_1 + 0x70) = 0;
  }
  pvVar4 = *(void **)((longlong)param_1 + 0x60);
  if (pvVar4 != (void *)0x0) {
    free(*(void **)((longlong)pvVar4 + 0x10));
    free(pvVar4);
    *(undefined8 *)((longlong)param_1 + 0x60) = 0;
  }
  free(param_1);
  if (_Memory != (int *)0x0) {
    iVar8 = 0;
    if (0 < *_Memory) {
      lVar9 = 0;
      do {
        iVar7 = 0;
        piVar1 = *(int **)(lVar9 + *(longlong *)(_Memory + 2));
        if (0 < *piVar1) {
          lVar5 = 0;
          do {
            lVar2 = *(longlong *)(*(longlong *)(piVar1 + 6) + lVar5);
            if (*(int *)(uVar3 + 0x8c) == 0) {
              *(char *)(lVar2 + 0xd) = *(char *)(lVar2 + 0xd) << 2;
            }
            else {
              *(undefined *)(lVar2 + 0xd) = 0xfb;
            }
            iVar7 = iVar7 + 1;
            lVar5 = lVar5 + 8;
          } while (iVar7 < *piVar1);
        }
        iVar8 = iVar8 + 1;
        lVar9 = lVar9 + 8;
      } while (iVar8 < *_Memory);
    }
    if ((*_Memory == 0) || (uVar6 = FUN_18000bb80(_Memory,uVar3), (int)uVar6 < 0)) {
      iVar8 = 0;
      if (0 < *_Memory) {
        lVar9 = 0;
        do {
          pvVar4 = *(void **)(lVar9 + *(longlong *)(_Memory + 2));
          if (pvVar4 != (void *)0x0) {
            free(*(void **)((longlong)pvVar4 + 0x10));
            free(pvVar4);
          }
          iVar8 = iVar8 + 1;
          lVar9 = lVar9 + 8;
        } while (iVar8 < *_Memory);
      }
      free(_Memory);
      return (int *)0x0;
    }
  }
  return _Memory;
}



int FUN_18000c1c0(longlong *param_1,longlong param_2,uint param_3)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar1 = *(int *)(param_2 + 4);
  iVar5 = 0;
  iVar6 = 0;
  iVar4 = -1;
  if (0 < iVar1) {
    do {
      iVar3 = 0;
      lVar2 = 0;
      if (0 < iVar1) {
        do {
          if ((*(byte *)(*(longlong *)(param_2 + 0x38) + lVar2) == param_3) &&
             (*(char *)(lVar2 + *param_1) != '\0')) {
            iVar3 = iVar3 + 1;
          }
          lVar2 = lVar2 + 1;
        } while (lVar2 < iVar1);
      }
      if (iVar5 < iVar3) {
        iVar4 = iVar6;
        iVar5 = iVar3;
      }
      iVar6 = iVar6 + 1;
      param_1 = param_1 + 1;
    } while (iVar6 < iVar1);
  }
  iVar6 = -1;
  if ((int)((5 < iVar1) + 2) <= iVar5) {
    iVar6 = iVar4;
  }
  return iVar6;
}



void FUN_18000c270(int *param_1,int *param_2,int *param_3,int param_4,longlong param_5)

{
  char cVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int iVar8;
  int iVar9;
  int *piVar10;
  longlong lVar11;
  int iVar12;
  longlong lVar13;
  longlong lVar14;
  int *piVar15;
  int iVar16;
  int **ppiVar17;
  int iVar18;
  
  iVar12 = -1;
  iVar18 = 0;
  if (param_5 == 0) {
    param_5._0_4_ = 0;
  }
  else {
    param_5._0_4_ = *(int *)(param_5 + 0x60);
    iVar12 = *(int *)(param_5 + 0x5c);
  }
  iVar2 = *param_2;
  lVar14 = 0;
  if ((longlong)iVar2 < 1) {
    *param_2 = 0;
    return;
  }
  lVar13 = 0;
  do {
    lVar11 = 0;
    piVar10 = *(int **)(*(longlong *)(param_2 + 6) + lVar14 * 8);
    if (0 < *param_3) {
      do {
        if (*(int **)(*(longlong *)(param_3 + 10) + lVar11 * 8) == piVar10) {
          piVar15 = *(int **)(*(longlong *)(param_3 + 8) + lVar11 * 8);
LAB_18000c3ae:
          if (piVar15 != (int *)0x0) {
            if ((0 < (int)*(char *)((longlong)piVar10 + 0xd) -
                     (int)*(char *)((longlong)piVar15 + 0xd)) ||
               (((int)*(char *)((longlong)piVar10 + 0xd) == (int)*(char *)((longlong)piVar15 + 0xd)
                && ((uint)piVar15[2] <= (uint)piVar10[2] && piVar10[2] != piVar15[2])))) {
              iVar16 = piVar10[1];
              iVar9 = piVar10[2];
              iVar8 = piVar10[3];
              *piVar15 = *piVar10;
              piVar15[1] = iVar16;
              piVar15[2] = iVar9;
              piVar15[3] = iVar8;
              iVar16 = piVar10[5];
              iVar9 = piVar10[6];
              iVar8 = piVar10[7];
              piVar15[4] = piVar10[4];
              piVar15[5] = iVar16;
              piVar15[6] = iVar9;
              piVar15[7] = iVar8;
              iVar16 = piVar10[9];
              iVar9 = piVar10[10];
              iVar8 = piVar10[0xb];
              piVar15[8] = piVar10[8];
              piVar15[9] = iVar16;
              piVar15[10] = iVar9;
              piVar15[0xb] = iVar8;
              iVar16 = piVar10[0xd];
              iVar9 = piVar10[0xe];
              iVar8 = piVar10[0xf];
              piVar15[0xc] = piVar10[0xc];
              piVar15[0xd] = iVar16;
              piVar15[0xe] = iVar9;
              piVar15[0xf] = iVar8;
              iVar16 = piVar10[0x11];
              iVar9 = piVar10[0x12];
              iVar8 = piVar10[0x13];
              piVar15[0x10] = piVar10[0x10];
              piVar15[0x11] = iVar16;
              piVar15[0x12] = iVar9;
              piVar15[0x13] = iVar8;
            }
            if (0 < iVar12) {
              ppiVar17 = *(int ***)(param_1 + 6);
              iVar16 = 0;
              if (0 < *param_1) {
                do {
                  piVar10 = *ppiVar17;
                  iVar9 = *piVar10 - *piVar15;
                  if (iVar9 < 0) {
                    iVar9 = *piVar15 - *piVar10;
                  }
                  if (iVar9 < iVar12) {
                    iVar9 = piVar10[1] - piVar15[1];
                    if (iVar9 < 0) {
                      iVar9 = piVar15[1] - piVar10[1];
                    }
                    if ((iVar9 < iVar12) &&
                       ((int)param_5 <
                        (int)*(char *)((longlong)piVar15 + 0xd) -
                        (int)*(char *)((longlong)piVar10 + 0xd))) {
                      *(undefined2 *)((longlong)piVar10 + 0xe) = 0xffff;
                    }
                  }
                  iVar16 = iVar16 + 1;
                  ppiVar17 = ppiVar17 + 1;
                } while (iVar16 < *param_1);
              }
            }
            goto LAB_18000c37b;
          }
          break;
        }
        if (*(int **)(*(longlong *)(param_3 + 8) + lVar11 * 8) == piVar10) {
          piVar15 = *(int **)(*(longlong *)(param_3 + 10) + lVar11 * 8);
          goto LAB_18000c3ae;
        }
        lVar11 = lVar11 + 1;
      } while (lVar11 < *param_3);
    }
    piVar10 = FUN_180009b40(param_1,piVar10,9,(int *)0x0);
    if (piVar10 == (int *)0x0) {
      if (lVar13 != lVar14) {
        puVar3 = *(undefined4 **)(*(longlong *)(param_2 + 6) + lVar14 * 8);
        puVar4 = *(undefined4 **)(*(longlong *)(param_2 + 6) + lVar13 * 8);
        uVar5 = puVar3[1];
        uVar6 = puVar3[2];
        uVar7 = puVar3[3];
        *puVar4 = *puVar3;
        puVar4[1] = uVar5;
        puVar4[2] = uVar6;
        puVar4[3] = uVar7;
        uVar5 = puVar3[5];
        uVar6 = puVar3[6];
        uVar7 = puVar3[7];
        puVar4[4] = puVar3[4];
        puVar4[5] = uVar5;
        puVar4[6] = uVar6;
        puVar4[7] = uVar7;
        uVar5 = puVar3[9];
        uVar6 = puVar3[10];
        uVar7 = puVar3[0xb];
        puVar4[8] = puVar3[8];
        puVar4[9] = uVar5;
        puVar4[10] = uVar6;
        puVar4[0xb] = uVar7;
        uVar5 = puVar3[0xd];
        uVar6 = puVar3[0xe];
        uVar7 = puVar3[0xf];
        puVar4[0xc] = puVar3[0xc];
        puVar4[0xd] = uVar5;
        puVar4[0xe] = uVar6;
        puVar4[0xf] = uVar7;
        uVar5 = puVar3[0x11];
        uVar6 = puVar3[0x12];
        uVar7 = puVar3[0x13];
        puVar4[0x10] = puVar3[0x10];
        puVar4[0x11] = uVar5;
        puVar4[0x12] = uVar6;
        puVar4[0x13] = uVar7;
      }
      iVar18 = iVar18 + 1;
      lVar13 = lVar13 + 1;
    }
    else {
      if (param_4 != 0) {
        cVar1 = *(char *)((longlong)piVar10 + 0xd);
        piVar15 = *(int **)(*(longlong *)(param_2 + 6) + lVar14 * 8);
        if ((*(char *)((longlong)piVar15 + 0xd) == cVar1 ||
             *(char *)((longlong)piVar15 + 0xd) < cVar1) || (cVar1 < '\0')) {
          if ((((uint)piVar10[2] <= (uint)piVar15[2] && piVar15[2] != piVar10[2]) ||
              (*(char *)(piVar15 + 3) != *(char *)(piVar10 + 3))) &&
             (*(char *)((longlong)piVar10 + 0xd) = cVar1 + -1, (char)(cVar1 + -1) < -3)) {
            *(undefined2 *)((longlong)piVar10 + 0xe) = 0xffff;
            piVar15 = *(int **)(*(longlong *)(param_2 + 6) + lVar14 * 8);
            iVar16 = piVar15[1];
            iVar9 = piVar15[2];
            iVar8 = piVar15[3];
            *piVar10 = *piVar15;
            piVar10[1] = iVar16;
            piVar10[2] = iVar9;
            piVar10[3] = iVar8;
            iVar16 = piVar15[5];
            iVar9 = piVar15[6];
            iVar8 = piVar15[7];
            piVar10[4] = piVar15[4];
            piVar10[5] = iVar16;
            piVar10[6] = iVar9;
            piVar10[7] = iVar8;
            iVar16 = piVar15[9];
            iVar9 = piVar15[10];
            iVar8 = piVar15[0xb];
            piVar10[8] = piVar15[8];
            piVar10[9] = iVar16;
            piVar10[10] = iVar9;
            piVar10[0xb] = iVar8;
            iVar16 = piVar15[0xd];
            iVar9 = piVar15[0xe];
            iVar8 = piVar15[0xf];
            piVar10[0xc] = piVar15[0xc];
            piVar10[0xd] = iVar16;
            piVar10[0xe] = iVar9;
            piVar10[0xf] = iVar8;
            iVar16 = piVar15[0x11];
            iVar9 = piVar15[0x12];
            iVar8 = piVar15[0x13];
            piVar10[0x10] = piVar15[0x10];
            piVar10[0x11] = iVar16;
            piVar10[0x12] = iVar9;
            piVar10[0x13] = iVar8;
          }
        }
        else {
          iVar16 = piVar15[1];
          iVar9 = piVar15[2];
          iVar8 = piVar15[3];
          *piVar10 = *piVar15;
          piVar10[1] = iVar16;
          piVar10[2] = iVar9;
          piVar10[3] = iVar8;
          iVar16 = piVar15[5];
          iVar9 = piVar15[6];
          iVar8 = piVar15[7];
          piVar10[4] = piVar15[4];
          piVar10[5] = iVar16;
          piVar10[6] = iVar9;
          piVar10[7] = iVar8;
          iVar16 = piVar15[9];
          iVar9 = piVar15[10];
          iVar8 = piVar15[0xb];
          piVar10[8] = piVar15[8];
          piVar10[9] = iVar16;
          piVar10[10] = iVar9;
          piVar10[0xb] = iVar8;
          iVar16 = piVar15[0xd];
          iVar9 = piVar15[0xe];
          iVar8 = piVar15[0xf];
          piVar10[0xc] = piVar15[0xc];
          piVar10[0xd] = iVar16;
          piVar10[0xe] = iVar9;
          piVar10[0xf] = iVar8;
          iVar16 = piVar15[0x11];
          iVar9 = piVar15[0x12];
          iVar8 = piVar15[0x13];
          piVar10[0x10] = piVar15[0x10];
          piVar10[0x11] = iVar16;
          piVar10[0x12] = iVar9;
          piVar10[0x13] = iVar8;
        }
      }
    }
LAB_18000c37b:
    lVar14 = lVar14 + 1;
    if (iVar2 <= lVar14) {
      *param_2 = iVar18;
      return;
    }
  } while( true );
}



int * FUN_18000c540(int *param_1,int param_2,longlong *param_3,longlong param_4,int param_5,
                   int param_6,short param_7,int param_8,ulonglong param_9)

{
  int *piVar1;
  short sVar2;
  short sVar3;
  int *_Memory;
  int *piVar4;
  longlong lVar5;
  int iVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  longlong *plVar12;
  int *local_res8;
  int local_48;
  longlong local_40;
  
  local_48 = 0;
  local_res8 = param_1;
  if (0 < *(int *)(param_4 + 4)) {
    local_40 = 0;
    do {
      if ((*(char *)(*(longlong *)(param_4 + 0x38) + local_40) == '\0') &&
         (lVar5 = (longlong)param_2 * 8, *(char *)(param_3[param_2] + local_40) != '\0')) {
        _Memory = *(int **)(*(longlong *)(param_4 + 0x48) + local_40 * 8);
        piVar4 = *(int **)(*(longlong *)(*(longlong *)(param_4 + 0x88) + lVar5) + local_40 * 8);
        FUN_18000b7d0(_Memory,*(short *)(piVar4 + 5));
        sVar2 = *(short *)(piVar4 + 6);
        sVar3 = *(short *)((longlong)piVar4 + 0x16);
        iVar11 = 0;
        if (0 < *_Memory) {
          lVar7 = 0;
          do {
            iVar11 = iVar11 + 1;
            **(int **)(lVar7 + *(longlong *)(_Memory + 6)) =
                 **(int **)(lVar7 + *(longlong *)(_Memory + 6)) - (int)sVar3;
            piVar1 = (int *)(*(longlong *)(lVar7 + *(longlong *)(_Memory + 6)) + 4);
            *piVar1 = *piVar1 - (int)sVar2;
            lVar7 = lVar7 + 8;
          } while (iVar11 < *_Memory);
        }
        lVar7 = 0;
        iVar11 = 0;
        if (0 < *_Memory) {
          do {
            iVar11 = iVar11 + 1;
            *(undefined *)(*(longlong *)(*(longlong *)(_Memory + 6) + -8 + (lVar7 + 1) * 8) + 0xd) =
                 *(undefined *)
                  (lVar7 + *(longlong *)
                            (*(longlong *)(lVar5 + *(longlong *)(param_4 + 0x50)) + local_40 * 8));
            lVar7 = lVar7 + 1;
          } while (iVar11 < *_Memory);
        }
        iVar11 = 0;
        if (0 < *piVar4) {
          lVar5 = 0;
          do {
            plVar12 = (longlong *)(*(longlong *)(piVar4 + 10) + lVar5);
            iVar11 = iVar11 + 1;
            lVar5 = lVar5 + 8;
            *(longlong *)(*(longlong *)(piVar4 + 10) + -8 + lVar5) =
                 (*(longlong **)(_Memory + 6))
                 [(int)((*plVar12 - **(longlong **)(_Memory + 6)) / 0x50)];
          } while (iVar11 < *piVar4);
        }
        FUN_18000b7d0(_Memory,param_7);
        iVar11 = 0;
        if (0 < *_Memory) {
          lVar5 = 0;
          do {
            iVar11 = iVar11 + 1;
            **(int **)(lVar5 + *(longlong *)(_Memory + 6)) =
                 **(int **)(lVar5 + *(longlong *)(_Memory + 6)) - param_5;
            piVar1 = (int *)(*(longlong *)(*(longlong *)(_Memory + 6) + -8 + lVar5 + 8) + 4);
            *piVar1 = *piVar1 - param_6;
            lVar5 = lVar5 + 8;
          } while (iVar11 < *_Memory);
        }
        iVar11 = *local_res8;
        FUN_18000c270(local_res8,_Memory,piVar4,0,param_9);
        iVar10 = *_Memory;
        piVar4 = local_res8;
        if (iVar10 != 0) {
          iVar9 = iVar10 + iVar11;
          if (0x1000 < iVar9) {
            iVar9 = 0x1000;
            iVar10 = 0x1000 - iVar11;
            *_Memory = iVar10;
          }
          piVar4 = FUN_18000e180(local_res8,iVar9);
          if (piVar4 == (int *)0x0) goto LAB_18000c82a;
          FUN_18001d320(*(undefined8 **)(*(longlong *)(piVar4 + 6) + (longlong)iVar11 * 8),
                        (undefined8 *)**(undefined8 **)(_Memory + 6),(longlong)iVar10 * 0x50);
          *piVar4 = iVar9;
        }
        if (piVar4 != (int *)0x0) {
          free(*(void **)(_Memory + 4));
          free(_Memory);
          *(undefined8 *)(*(longlong *)(param_4 + 0x48) + local_40 * 8) = 0;
          iVar11 = 0;
          *(char *)(*(longlong *)(param_4 + 0x38) + local_40) = (char)param_8 + '\x01';
          lVar5 = 0;
          local_res8 = piVar4;
          if (0 < *(int *)(param_4 + 4)) {
            do {
              iVar11 = iVar11 + 1;
              *(undefined *)(param_3[lVar5] + local_40) = 0;
              *(undefined *)(lVar5 + param_3[local_40]) = 0;
              lVar5 = lVar5 + 1;
            } while (iVar11 < *(int *)(param_4 + 4));
          }
        }
      }
LAB_18000c82a:
      local_40 = local_40 + 1;
      local_48 = local_48 + 1;
    } while (local_48 < *(int *)(param_4 + 4));
  }
  while( true ) {
    iVar11 = *(int *)(param_4 + 4);
    iVar10 = -1;
    iVar9 = 0;
    iVar8 = 0;
    plVar12 = param_3;
    iVar6 = -1;
    if (0 < iVar11) {
      do {
        iVar10 = iVar6;
        iVar6 = 0;
        lVar5 = 0;
        if (0 < iVar11) {
          do {
            if (((uint)*(byte *)(*(longlong *)(param_4 + 0x38) + lVar5) == param_8 + 1U) &&
               (*(char *)(lVar5 + *plVar12) != '\0')) {
              iVar6 = iVar6 + 1;
            }
            lVar5 = lVar5 + 1;
          } while (lVar5 < iVar11);
        }
        if (iVar9 < iVar6) {
          iVar10 = iVar8;
          iVar9 = iVar6;
        }
        iVar8 = iVar8 + 1;
        plVar12 = plVar12 + 1;
        iVar6 = iVar10;
      } while (iVar8 < iVar11);
    }
    iVar6 = -1;
    if ((int)((5 < iVar11) + 2) <= iVar9) {
      iVar6 = iVar10;
    }
    if (iVar6 < 0) break;
    lVar5 = *(longlong *)
             (*(longlong *)(*(longlong *)(param_4 + 0x88) + (longlong)param_2 * 8) +
             (longlong)iVar6 * 8);
    local_res8 = FUN_18000c540(local_res8,iVar6,param_3,param_4,(int)*(short *)(lVar5 + 0x16),
                               (int)*(short *)(lVar5 + 0x18),*(short *)(lVar5 + 0x14),param_8 + 1,
                               param_9);
  }
  return local_res8;
}



void FUN_18000c970(longlong param_1,int param_2,int param_3,int *param_4,longlong param_5)

{
  longlong lVar1;
  char cVar2;
  int iVar3;
  uint *_Memory;
  uint *_Memory_00;
  void *pvVar4;
  ulonglong uVar5;
  undefined uVar6;
  uint uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  longlong lVar10;
  
  lVar10 = (longlong)param_3;
  _Memory = (uint *)calloc(1,0x38);
  if (_Memory != (uint *)0x0) {
    _Memory_00 = (uint *)FUN_18000e240(param_4);
    lVar1 = (longlong)param_2 * 8;
    iVar3 = FUN_18000b240(*(uint **)(lVar1 + *(longlong *)(param_1 + 0x48)),_Memory_00,param_5,
                          _Memory);
    uVar7 = *_Memory;
    uVar9 = 0;
    if (((int)uVar7 < 2) || (iVar3 < *(int *)(param_5 + 0x78))) {
      uVar6 = 0;
    }
    else {
      if (0xff < (int)uVar7) {
        uVar7 = 0xff;
      }
      uVar6 = (undefined)uVar7;
    }
    *(undefined *)(lVar10 + *(longlong *)(lVar1 + *(longlong *)(param_1 + 0x40))) = uVar6;
    if (*(byte *)(lVar10 + *(longlong *)(lVar1 + *(longlong *)(param_1 + 0x40))) < 2) {
      if (*(void **)(_Memory + 2) != (void *)0x0) {
        free(*(void **)(_Memory + 2));
      }
      if (*(void **)(_Memory + 8) != (void *)0x0) {
        free(*(void **)(_Memory + 8));
      }
      if (*(void **)(_Memory + 10) != (void *)0x0) {
        free(*(void **)(_Memory + 10));
      }
      *(undefined8 *)(_Memory + 2) = 0;
      *(undefined8 *)(_Memory + 8) = 0;
      *(undefined8 *)(_Memory + 10) = 0;
      free(_Memory);
    }
    else {
      uVar5 = uVar9;
      uVar8 = uVar9;
      if (0 < (int)*_Memory) {
        do {
          cVar2 = *(char *)(*(longlong *)(uVar5 + *(longlong *)(_Memory + 8)) + 0xd);
          if (cVar2 < '\x7f') {
            *(char *)(*(longlong *)(uVar5 + *(longlong *)(_Memory + 8)) + 0xd) = cVar2 + '\x01';
          }
          cVar2 = *(char *)(*(longlong *)(*(longlong *)(_Memory + 10) + uVar5) + 0xd);
          if (cVar2 < '\x7f') {
            *(char *)(*(longlong *)(*(longlong *)(_Memory + 10) + uVar5) + 0xd) = cVar2 + '\x01';
          }
          uVar7 = (int)uVar8 + 1;
          uVar5 = uVar5 + 8;
          uVar8 = (ulonglong)uVar7;
        } while ((int)uVar7 < (int)*_Memory);
      }
      uVar5 = uVar9;
      uVar8 = uVar9;
      if (0 < (int)*_Memory) {
        do {
          uVar7 = (int)uVar5 + 1;
          *(longlong *)(*(longlong *)(_Memory + 10) + -8 + uVar8 + 8) =
               ((*(longlong *)(*(longlong *)(_Memory + 10) + uVar8) -
                **(longlong **)(_Memory_00 + 6)) / 0x50) * 0x50 +
               **(longlong **)(*(longlong *)(*(longlong *)(param_1 + 0x48) + lVar10 * 8) + 0x18);
          uVar5 = (ulonglong)uVar7;
          uVar8 = uVar8 + 8;
        } while ((int)uVar7 < (int)*_Memory);
      }
      *(uint **)(*(longlong *)(*(longlong *)(param_1 + 0x88) + lVar1) + lVar10 * 8) = _Memory;
      pvVar4 = malloc((longlong)(int)*_Memory_00);
      *(void **)(*(longlong *)(*(longlong *)(param_1 + 0x50) + lVar1) + lVar10 * 8) = pvVar4;
      uVar5 = uVar9;
      if (0 < (int)*_Memory_00) {
        do {
          uVar7 = (int)uVar9 + 1;
          uVar9 = (ulonglong)uVar7;
          *(undefined *)
           (uVar5 + *(longlong *)(*(longlong *)(*(longlong *)(param_1 + 0x50) + lVar1) + lVar10 * 8)
           ) = *(undefined *)
                (*(longlong *)(*(longlong *)(_Memory_00 + 6) + -8 + (uVar5 + 1) * 8) + 0xd);
          uVar5 = uVar5 + 1;
        } while ((int)uVar7 < (int)*_Memory_00);
      }
    }
    if (_Memory_00 != (uint *)0x0) {
      free(*(void **)(_Memory_00 + 4));
      free(_Memory_00);
    }
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void * FUN_18000cba0(uint *param_1,uint *param_2,longlong param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  void *_Memory;
  undefined2 *puVar4;
  undefined4 *puVar5;
  void *pvVar6;
  void *pvVar7;
  void *pvVar8;
  uint uVar9;
  undefined8 local_58;
  void *local_50;
  undefined8 local_48;
  undefined8 local_40;
  void *local_38;
  void *local_30;
  undefined8 local_28;
  
  pvVar6 = (void *)0x0;
  pvVar7 = (void *)0x0;
  _Memory = malloc((longlong)(int)*param_2 * 0xc);
  pvVar8 = _Memory;
  if (_Memory != (void *)0x0) {
    if (0 < (int)*param_2) {
      puVar4 = (undefined2 *)((longlong)_Memory + 8);
      puVar5 = (undefined4 *)**(undefined8 **)(param_2 + 6);
      pvVar8 = pvVar6;
      do {
        uVar9 = (int)pvVar8 + 1;
        pvVar8 = (void *)(ulonglong)uVar9;
        *(undefined4 *)(puVar4 + -4) = *puVar5;
        *(undefined4 *)(puVar4 + -2) = puVar5[1];
        *puVar4 = *(undefined2 *)((longlong)puVar5 + 0xe);
        puVar4 = puVar4 + 6;
        puVar5 = puVar5 + 0x14;
      } while ((int)uVar9 < (int)*param_2);
    }
    local_58 = 0;
    local_50 = (void *)0x0;
    local_48 = 0;
    local_40 = 0;
    local_38 = (void *)0x0;
    local_30 = (void *)0x0;
    local_28 = 0;
    iVar2 = FUN_18000a610(param_1,param_2,param_3,(uint *)&local_58,0,(char *)0x0,(uint **)0x0);
    pvVar8 = pvVar6;
    if ((1 < (int)local_58) && (pvVar8 = pvVar7, *(int *)(param_3 + 0x78) <= iVar2)) {
      iVar1 = *(int *)(param_3 + 0x74);
      iVar2 = iVar1 * 2 + 10;
      if (iVar1 != 0) {
        iVar3 = (int)local_48._6_2_;
        if (local_48 < 0) {
          iVar3 = -iVar3;
        }
        if (SBORROW4(iVar3,iVar1 * 4) != iVar3 + iVar1 * -4 < 0) {
          iVar3 = (int)(short)local_40;
          if ((short)local_40 < 0) {
            iVar3 = -iVar3;
          }
          if ((SBORROW4(iVar3,iVar1 * 4) != iVar3 + iVar1 * -4 < 0) &&
             ((local_48._4_2_ < iVar2 || (0x168 - iVar2 < (int)local_48._4_2_)))) {
            pvVar8 = (void *)0x1;
          }
        }
      }
    }
    if (local_50 != (void *)0x0) {
      free(local_50);
    }
    if (local_38 != (void *)0x0) {
      free(local_38);
    }
    if (local_30 != (void *)0x0) {
      free(local_30);
    }
    if (0 < (int)*param_2) {
      puVar4 = (undefined2 *)((longlong)_Memory + 8);
      puVar5 = (undefined4 *)**(undefined8 **)(param_2 + 6);
      do {
        uVar9 = (int)pvVar6 + 1;
        pvVar6 = (void *)(ulonglong)uVar9;
        *puVar5 = *(undefined4 *)(puVar4 + -4);
        puVar5[1] = *(undefined4 *)(puVar4 + -2);
        *(undefined2 *)((longlong)puVar5 + 0xe) = *puVar4;
        puVar4 = puVar4 + 6;
        puVar5 = puVar5 + 0x14;
      } while ((int)uVar9 < (int)*param_2);
    }
    free(_Memory);
  }
  return pvVar8;
}



undefined8 FUN_18000cd50(longlong param_1,ulonglong param_2)

{
  int iVar1;
  undefined8 *puVar2;
  int iVar3;
  longlong *plVar4;
  int *piVar5;
  longlong lVar6;
  int *piVar7;
  int *piVar8;
  longlong *_Memory;
  longlong lVar9;
  ulonglong uVar10;
  uint uVar11;
  ulonglong uVar12;
  
  iVar3 = *(int *)(param_1 + 0x10);
  puVar2 = *(undefined8 **)(param_1 + 0x40);
  plVar4 = (longlong *)FUN_180007180(iVar3,iVar3);
  _Memory = (longlong *)0x0;
  if (plVar4 != (longlong *)0x0) {
    FUN_18001d320((undefined8 *)*plVar4,(undefined8 *)*puVar2,(longlong)(iVar3 * iVar3));
    _Memory = plVar4;
  }
  FUN_18001d980(*(undefined (**) [16])(param_1 + 0x38),0,(longlong)*(int *)(param_2 + 0x70));
  do {
    iVar3 = FUN_18000c1c0(_Memory,param_1,0);
    if (iVar3 < 0) break;
    piVar7 = *(int **)(*(longlong *)(param_1 + 0x48) + (longlong)iVar3 * 8);
    lVar9 = (longlong)*piVar7;
    piVar5 = (int *)calloc(1,(longlong)(*piVar7 * 0x58 + 0x20));
    if (piVar5 == (int *)0x0) {
      piVar5 = (int *)0x0;
    }
    else {
      piVar8 = piVar5 + 8 + lVar9 * 2;
      lVar6 = 0;
      *(int **)(piVar5 + 6) = piVar5 + 8;
      if (0 < lVar9) {
        do {
          lVar6 = lVar6 + 1;
          *(int **)(*(longlong *)(piVar5 + 6) + -8 + lVar6 * 8) = piVar8;
          piVar8 = piVar8 + 0x14;
        } while (lVar6 < lVar9);
      }
      *piVar5 = *piVar7;
      *(undefined2 *)(piVar5 + 1) = *(undefined2 *)(piVar7 + 1);
      *(undefined2 *)((longlong)piVar5 + 6) = *(undefined2 *)((longlong)piVar7 + 6);
      *(undefined *)(piVar5 + 2) = *(undefined *)(piVar7 + 2);
      *(undefined *)((longlong)piVar5 + 9) = *(undefined *)((longlong)piVar7 + 9);
      *(undefined *)((longlong)piVar5 + 10) = *(undefined *)((longlong)piVar7 + 10);
      if ((*(undefined8 **)(piVar5 + 4) != (undefined8 *)0x0) &&
         (*(undefined8 **)(piVar7 + 4) != (undefined8 *)0x0)) {
        FUN_18001d320(*(undefined8 **)(piVar5 + 4),*(undefined8 **)(piVar7 + 4),
                      (longlong)
                      (int)((uint)*(ushort *)(piVar7 + 1) * (uint)*(ushort *)((longlong)piVar7 + 6))
                     );
      }
      FUN_18001d320((undefined8 *)**(undefined8 **)(piVar5 + 6),
                    (undefined8 *)**(undefined8 **)(piVar7 + 6),(longlong)*piVar7 * 0x50);
    }
    iVar1 = *piVar5;
    *(undefined *)((longlong)iVar3 + *(longlong *)(param_1 + 0x38)) = 1;
    piVar7 = FUN_18000c540(piVar5,iVar3,_Memory,param_1,0,0,0,1,param_2);
    *(int **)(*(longlong *)(*(int **)(param_1 + 0x78) + 2) +
             (longlong)**(int **)(param_1 + 0x78) * 8) = piVar7;
    **(int **)(param_1 + 0x78) = **(int **)(param_1 + 0x78) + 1;
  } while (*piVar7 != iVar1 && iVar1 <= *piVar7);
  uVar10 = 0;
  free(_Memory);
  uVar12 = uVar10;
  if (0 < *(int *)(param_1 + 4)) {
    do {
      if (*(char *)(uVar10 + *(longlong *)(param_1 + 0x38)) == '\0') {
        *(undefined8 *)
         (*(longlong *)(*(int **)(param_1 + 0x78) + 2) + (longlong)**(int **)(param_1 + 0x78) * 8) =
             *(undefined8 *)(*(longlong *)(param_1 + 0x48) + uVar10 * 8);
        **(int **)(param_1 + 0x78) = **(int **)(param_1 + 0x78) + 1;
        *(undefined8 *)(*(longlong *)(param_1 + 0x48) + uVar10 * 8) = 0;
      }
      uVar11 = (int)uVar12 + 1;
      uVar10 = uVar10 + 1;
      uVar12 = (ulonglong)uVar11;
    } while ((int)uVar11 < *(int *)(param_1 + 4));
  }
  return 0;
}



int * FUN_18000cf90(uint *param_1,longlong param_2)

{
  ulonglong uVar1;
  int iVar2;
  int iVar3;
  void *pvVar4;
  int *piVar5;
  undefined8 uVar6;
  int *piVar7;
  int *piVar8;
  int *piVar9;
  bool bVar10;
  
  uVar1 = DAT_18004cfd0;
  piVar9 = (int *)0x0;
  bVar10 = *(int *)(DAT_18004cfd0 + 0x90) != 0;
  piVar8 = piVar9;
  if ((!bVar10) && (piVar8 = (int *)0x0, *(int *)(DAT_18004cfd0 + 0x7c) == 1)) {
    if (*(uint **)(param_2 + 0x60) != (uint *)0x0) {
      pvVar4 = FUN_18000cba0(*(uint **)(param_2 + 0x60),param_1,DAT_18004cfd0);
      if (0 < (int)pvVar4) {
        piVar8 = (int *)0x3;
        goto LAB_18000d019;
      }
      pvVar4 = *(void **)(param_2 + 0x60);
      if (pvVar4 != (void *)0x0) {
        free(*(void **)((longlong)pvVar4 + 0x10));
        free(pvVar4);
      }
    }
    piVar7 = FUN_18000e240((int *)param_1);
    *(int **)(param_2 + 0x60) = piVar7;
  }
LAB_18000d019:
  iVar2 = *(int *)(param_2 + 4);
  if (*(int *)(uVar1 + 0x6c) < iVar2) {
    piVar7 = *(int **)(param_2 + 0x78);
    if (piVar7 == (int *)0x0) {
      piVar5 = (int *)calloc(1,0x150);
      piVar7 = piVar9;
      if (piVar5 != (int *)0x0) {
        *(int **)(piVar5 + 2) = piVar5 + 4;
        piVar7 = piVar5;
      }
      *(int **)(param_2 + 0x78) = piVar7;
      FUN_18000cd50(param_2,uVar1);
      FUN_18000bce0(param_2);
      piVar7 = *(int **)(param_2 + 0x78);
      if ((!bVar10) && (*(int *)(uVar1 + 0x7c) == 2)) {
        iVar2 = FUN_18000d8e0(piVar7);
        *(int *)(param_2 + 0x14) = iVar2;
      }
    }
    iVar2 = *piVar7;
    piVar5 = (int *)calloc(1,((longlong)iVar2 + 2) * 0x10);
    if (piVar5 != (int *)0x0) {
      *piVar5 = iVar2;
      *(int **)(piVar5 + 4) = piVar5 + 8;
      *(int **)(piVar5 + 6) = piVar5 + 8 + (longlong)iVar2 * 2;
      piVar9 = piVar5;
    }
    iVar2 = FUN_18000b560(piVar7,(int *)param_1,(longlong)piVar9,uVar1,(uint)bVar10);
    if (iVar2 < *(int *)(uVar1 + 0x78)) {
      piVar7 = FUN_18000d850(piVar7,(int *)param_1,uVar1);
      if ((!bVar10) && (*(int *)(uVar1 + 0x7c) == 2)) {
        iVar2 = FUN_18000d8e0(piVar7);
        *(int *)(param_2 + 0x14) = iVar2;
      }
    }
    else {
      uVar6 = FUN_18000d310(piVar7,piVar9,uVar1);
      if ((int)uVar6 == -0x3eb) {
        piVar7 = FUN_18000d850(piVar7,(int *)param_1,uVar1);
      }
      if ((!bVar10) && (*(int *)(uVar1 + 0x7c) == 2)) {
        iVar2 = *(int *)(param_2 + 0x14);
        iVar3 = FUN_18000d8e0(piVar7);
        iVar3 = iVar3 - iVar2;
        *(int *)(param_2 + 0x14) = iVar2 + iVar3;
        if ((-1 < iVar3) && (iVar3 < *(int *)(uVar1 + 0x80))) {
          FUN_18000e3f0(piVar9);
          return (int *)0x3;
        }
      }
    }
    FUN_18000e3f0(piVar9);
  }
  else {
    piVar7 = FUN_18000e240((int *)param_1);
    *(int **)(*(longlong *)(param_2 + 0x48) + (longlong)*(int *)(param_2 + 4) * 8) = piVar7;
    if (*(longlong *)(*(longlong *)(param_2 + 0x48) + (longlong)*(int *)(param_2 + 4) * 8) == 0) {
      piVar8 = (int *)0xfffffc18;
    }
    else {
      iVar3 = *(int *)(param_2 + 4) + 1;
      *(int *)(param_2 + 4) = iVar3;
      if (!bVar10) {
        piVar7 = piVar9;
        piVar5 = piVar9;
        if (0 < iVar3) {
          do {
            iVar3 = (int)piVar7;
            if (iVar3 != iVar2) {
              FUN_18000c970(param_2,iVar3,iVar2,(int *)param_1,uVar1);
              FUN_18000c970(param_2,iVar2,iVar3,
                            *(int **)((longlong)piVar5 + *(longlong *)(param_2 + 0x48)),uVar1);
            }
            piVar7 = (int *)(ulonglong)(iVar3 + 1U);
            piVar5 = piVar5 + 2;
          } while ((int)(iVar3 + 1U) < *(int *)(param_2 + 4));
        }
        if ((*(int *)(uVar1 + 0x7c) == 2) && (0 < iVar2)) {
          do {
            pvVar4 = FUN_18000cba0(*(uint **)(*(longlong *)(param_2 + 0x48) + (longlong)piVar9 * 8),
                                   param_1,uVar1);
            if (0 < (int)pvVar4) {
              piVar8 = (int *)0x3;
            }
            piVar9 = (int *)((longlong)piVar9 + 1);
          } while ((longlong)piVar9 < (longlong)iVar2);
        }
      }
    }
  }
  return piVar8;
}



int * FUN_18000d260(int *param_1,int *param_2,int *param_3,int param_4,longlong param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = *param_1;
  FUN_18000c270(param_1,param_2,param_3,param_4,param_5);
  iVar2 = *param_2;
  if (iVar2 != 0) {
    iVar3 = iVar2 + iVar1;
    if (0x1000 < iVar3) {
      iVar3 = 0x1000;
      iVar2 = 0x1000 - iVar1;
      *param_2 = iVar2;
    }
    param_1 = FUN_18000e180(param_1,iVar3);
    if (param_1 != (int *)0x0) {
      FUN_18001d320(*(undefined8 **)(*(longlong *)(param_1 + 6) + (longlong)iVar1 * 8),
                    (undefined8 *)**(undefined8 **)(param_2 + 6),(longlong)iVar2 * 0x50);
      *param_1 = iVar3;
    }
  }
  return param_1;
}



undefined8 FUN_18000d310(int *param_1,int *param_2,longlong param_3)

{
  char cVar1;
  uint *puVar2;
  uint *puVar3;
  longlong lVar4;
  int *piVar5;
  void *_Memory;
  void *_Memory_00;
  int iVar6;
  int *piVar7;
  undefined8 uVar8;
  void *pvVar9;
  uint **_Memory_01;
  undefined2 *puVar10;
  longlong *plVar11;
  longlong *plVar12;
  undefined4 *puVar13;
  ulonglong uVar14;
  longlong lVar15;
  int iVar16;
  ulonglong uVar17;
  uint uVar18;
  ulonglong uVar20;
  int iVar21;
  int local_res20;
  int local_98;
  longlong local_80;
  ulonglong local_78;
  void *local_70;
  undefined8 local_68;
  undefined8 local_60;
  void *local_58;
  longlong *local_50;
  undefined8 local_48;
  uint **ppuVar19;
  
  iVar6 = *(int *)(param_3 + 0x78);
  local_98 = 0;
  if (param_2 == (int *)0x0) {
    return 0xfffffc16;
  }
  iVar16 = 0;
  iVar21 = 0;
  if (0 < *param_1) {
    lVar15 = 0;
    do {
      piVar7 = *(int **)(lVar15 + *(longlong *)(param_2 + 4));
      if ((piVar7 != (int *)0x0) && (iVar6 * 2 <= piVar7[4])) {
        iVar21 = iVar21 + 1;
        piVar7 = FUN_18000d260(*(int **)(*(longlong *)(param_1 + 2) + lVar15),
                               *(int **)(lVar15 + *(longlong *)(param_2 + 6)),piVar7,1,param_3);
        if (piVar7 != (int *)0x0) {
          *(int **)(lVar15 + *(longlong *)(param_1 + 2)) = piVar7;
          pvVar9 = *(void **)(lVar15 + *(longlong *)(param_2 + 6));
          if (pvVar9 != (void *)0x0) {
            free(*(void **)((longlong)pvVar9 + 0x10));
            free(pvVar9);
          }
          *(undefined8 *)(lVar15 + *(longlong *)(param_2 + 6)) = 0;
        }
      }
      iVar16 = iVar16 + 1;
      lVar15 = lVar15 + 8;
    } while (iVar16 < *param_1);
    if (iVar21 != 0) {
      iVar6 = 0;
      if (0 < *param_1) {
        lVar15 = 0;
        do {
          if ((*(int **)(*(longlong *)(param_2 + 4) + lVar15) != (int *)0x0) &&
             (3 < **(int **)(*(longlong *)(param_2 + 4) + lVar15))) {
            if (-1 < iVar6) {
              if (*param_2 < 2) goto LAB_18000d804;
              lVar15 = (longlong)iVar6;
              local_80 = 0;
              local_res20 = 0;
              goto LAB_18000d480;
            }
            break;
          }
          iVar6 = iVar6 + 1;
          lVar15 = lVar15 + 8;
        } while (iVar6 < *param_1);
      }
      uVar8 = FUN_18000bb80(param_1,param_3);
      return uVar8;
    }
  }
  return 0xfffffc15;
LAB_18000d480:
  if ((local_80 != lVar15) && (*(longlong *)(*(longlong *)(param_2 + 4) + local_80 * 8) != 0)) {
    piVar7 = *(int **)(*(longlong *)(param_1 + 2) + local_80 * 8);
    iVar6 = *piVar7;
    pvVar9 = malloc((longlong)iVar6 * 0xc);
    if (pvVar9 != (void *)0x0) {
      _Memory_01 = (uint **)0x0;
      if (0 < iVar6) {
        puVar10 = (undefined2 *)((longlong)pvVar9 + 8);
        puVar13 = (undefined4 *)**(undefined8 **)(piVar7 + 6);
        ppuVar19 = _Memory_01;
        do {
          uVar18 = (int)ppuVar19 + 1;
          ppuVar19 = (uint **)(ulonglong)uVar18;
          *(undefined4 *)(puVar10 + -4) = *puVar13;
          *(undefined4 *)(puVar10 + -2) = puVar13[1];
          *puVar10 = *(undefined2 *)((longlong)puVar13 + 0xe);
          puVar10 = puVar10 + 6;
          puVar13 = puVar13 + 0x14;
        } while ((int)uVar18 < *piVar7);
      }
      local_78 = 0;
      local_70 = (void *)0x0;
      local_68 = 0;
      local_60 = 0;
      local_58 = (void *)0x0;
      local_50 = (longlong *)0x0;
      local_48 = 0;
      puVar2 = *(uint **)(*(longlong *)(param_1 + 2) + local_80 * 8);
      puVar3 = *(uint **)(*(longlong *)(param_1 + 2) + lVar15 * 8);
      if (*(longlong *)(puVar2 + 4) != 0) {
        _Memory_01 = (uint **)calloc(1,0x18);
      }
      iVar6 = FUN_18000a610(puVar3,puVar2,param_3,(uint *)&local_78,0,(char *)0x0,_Memory_01);
      if (_Memory_01 != (uint **)0x0) {
        if (*_Memory_01 != (uint *)0x0) {
          free(*_Memory_01);
        }
        if (_Memory_01[1] != (uint *)0x0) {
          free(_Memory_01[1]);
        }
        if (_Memory_01[2] != (uint *)0x0) {
          free(_Memory_01[2]);
        }
        free(_Memory_01);
      }
      plVar11 = local_50;
      _Memory_00 = local_58;
      if (iVar6 < *(int *)(param_3 + 0x78)) {
        iVar6 = 0;
        piVar7 = *(int **)(*(longlong *)(param_1 + 2) + local_80 * 8);
        if (0 < *piVar7) {
          puVar10 = (undefined2 *)((longlong)pvVar9 + 8);
          puVar13 = (undefined4 *)**(undefined8 **)(piVar7 + 6);
          do {
            iVar6 = iVar6 + 1;
            *puVar13 = *(undefined4 *)(puVar10 + -4);
            puVar13[1] = *(undefined4 *)(puVar10 + -2);
            *(undefined2 *)((longlong)puVar13 + 0xe) = *puVar10;
            puVar10 = puVar10 + 6;
            puVar13 = puVar13 + 0x14;
          } while (iVar6 < *piVar7);
        }
      }
      else {
        if (0 < (int)local_78) {
          uVar17 = local_78 & 0xffffffff;
          plVar12 = local_50;
          do {
            lVar4 = *(longlong *)
                     ((longlong)((longlong)local_58 - (longlong)local_50) + (longlong)plVar12);
            cVar1 = *(char *)(lVar4 + 0xd);
            if (cVar1 < '\x7f') {
              *(char *)(lVar4 + 0xd) = cVar1 + '\x01';
            }
            cVar1 = *(char *)(*plVar12 + 0xd);
            if (cVar1 < '{') {
              *(char *)(*plVar12 + 0xd) = cVar1 + '\x04';
            }
            plVar12 = plVar12 + 1;
            uVar17 = uVar17 - 1;
          } while (uVar17 != 0);
        }
        piVar7 = *(int **)(*(longlong *)(param_1 + 2) + lVar15 * 8);
        piVar5 = *(int **)(*(longlong *)(param_1 + 2) + local_80 * 8);
        iVar6 = *piVar7;
        FUN_18000c270(piVar7,piVar5,(int *)&local_78,1,param_3);
        iVar16 = *piVar5;
        if (iVar16 != 0) {
          iVar21 = iVar16 + iVar6;
          if (0x1000 < iVar21) {
            iVar21 = 0x1000;
            iVar16 = 0x1000 - iVar6;
            *piVar5 = iVar16;
          }
          piVar7 = FUN_18000e180(piVar7,iVar21);
          if (piVar7 == (int *)0x0) goto LAB_18000d737;
          FUN_18001d320(*(undefined8 **)(*(longlong *)(piVar7 + 6) + (longlong)iVar6 * 8),
                        (undefined8 *)**(undefined8 **)(piVar5 + 6),(longlong)iVar16 * 0x50);
          *piVar7 = iVar21;
        }
        if (piVar7 != (int *)0x0) {
          local_98 = local_98 + 1;
          *(int **)(*(longlong *)(param_1 + 2) + lVar15 * 8) = piVar7;
          _Memory = *(void **)(*(longlong *)(param_1 + 2) + local_80 * 8);
          if (_Memory != (void *)0x0) {
            free(*(void **)((longlong)_Memory + 0x10));
            free(_Memory);
          }
          *(undefined8 *)(*(longlong *)(param_1 + 2) + local_80 * 8) = 0;
        }
      }
LAB_18000d737:
      free(pvVar9);
      if (local_70 != (void *)0x0) {
        free(local_70);
      }
      if (_Memory_00 != (void *)0x0) {
        free(_Memory_00);
      }
      if (plVar11 != (longlong *)0x0) {
        free(plVar11);
      }
    }
  }
  uVar17 = 1;
  local_res20 = local_res20 + 1;
  local_80 = local_80 + 1;
  if (*param_1 <= local_res20) {
    if (0 < *param_1) {
      lVar15 = 0;
      uVar20 = uVar17;
      do {
        lVar4 = *(longlong *)(param_1 + 2);
        iVar6 = (int)uVar17;
        if ((*(longlong *)(lVar4 + lVar15) == 0) && (iVar6 < *param_1)) {
          plVar11 = (longlong *)(lVar4 + 8 + lVar15);
          uVar14 = uVar20;
          do {
            if (*plVar11 != 0) {
              *(undefined8 *)(lVar4 + lVar15) = *(undefined8 *)(lVar4 + uVar14 * 8);
              *(undefined8 *)(*(longlong *)(param_1 + 2) + uVar14 * 8) = 0;
              break;
            }
            uVar18 = (int)uVar17 + 1;
            uVar17 = (ulonglong)uVar18;
            uVar14 = uVar14 + 1;
            plVar11 = plVar11 + 1;
          } while ((int)uVar18 < *param_1);
        }
        uVar17 = (ulonglong)(iVar6 + 1);
        uVar20 = uVar20 + 1;
        lVar15 = lVar15 + 8;
      } while (iVar6 < *param_1);
    }
    *param_1 = *param_1 - local_98;
LAB_18000d804:
    uVar8 = FUN_18000bb80(param_1,param_3);
    return uVar8;
  }
  goto LAB_18000d480;
}



int * FUN_18000d850(int *param_1,int *param_2,longlong param_3)

{
  int *piVar1;
  int *piVar2;
  undefined8 uVar3;
  
  piVar1 = param_1;
  if (param_1 == (int *)0x0) {
    piVar1 = (int *)calloc(1,0x150);
    if (piVar1 == (int *)0x0) {
      return (int *)0x0;
    }
    *(int **)(piVar1 + 2) = piVar1 + 4;
  }
  if ((*piVar1 < 0x28) && (piVar2 = FUN_18000e240(param_2), piVar2 != (int *)0x0)) {
    *(int **)(*(longlong *)(piVar1 + 2) + (longlong)*piVar1 * 8) = piVar2;
    *piVar1 = *piVar1 + 1;
  }
  uVar3 = FUN_18000bb80(param_1,param_3);
  if ((int)uVar3 < 0) {
    piVar1 = (int *)0x0;
  }
  return piVar1;
}



int FUN_18000d8e0(int *param_1)

{
  int **ppiVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  undefined (**_Memory) [16];
  longlong lVar5;
  longlong lVar6;
  undefined (*pauVar7) [16];
  int iVar8;
  int iVar9;
  longlong lVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  ulonglong uVar14;
  int iVar15;
  int local_res10;
  int local_res18;
  longlong local_50;
  
  iVar8 = 0;
  local_res10 = 0;
  local_res18 = 0;
  if (0 < *param_1) {
    local_50 = 0;
    do {
      iVar12 = 0x400;
      iVar15 = -0x400;
      puVar2 = *(uint **)(local_50 + *(longlong *)(param_1 + 2));
      iVar8 = 0;
      iVar11 = 0x400;
      iVar9 = -0x400;
      if (0 < (int)*puVar2) {
        lVar10 = 0;
        uVar14 = (ulonglong)*puVar2;
        do {
          ppiVar1 = (int **)(lVar10 + *(longlong *)(puVar2 + 6));
          lVar10 = lVar10 + 8;
          iVar13 = **ppiVar1;
          iVar3 = (*ppiVar1)[1];
          if (iVar13 < iVar12) {
            iVar12 = iVar13;
          }
          if (iVar3 < iVar11) {
            iVar11 = iVar3;
          }
          if (iVar15 < iVar13) {
            iVar15 = iVar13;
          }
          if (iVar9 < iVar3) {
            iVar9 = iVar3;
          }
          uVar14 = uVar14 - 1;
        } while (uVar14 != 0);
      }
      iVar15 = ((int)((iVar15 - iVar12 >> 0x1f & 3U) + (iVar15 - iVar12)) >> 2) + 1;
      iVar9 = ((int)((iVar9 - iVar11 >> 0x1f & 3U) + (iVar9 - iVar11)) >> 2) + 1;
      _Memory = (undefined (**) [16])malloc((longlong)(iVar9 * iVar15 + iVar9 * 8));
      lVar10 = (longlong)iVar9;
      if (_Memory == (undefined (**) [16])0x0) {
        _Memory = (undefined (**) [16])0x0;
      }
      else {
        pauVar7 = (undefined (*) [16])((longlong)_Memory + (longlong)(iVar9 * 8));
        lVar5 = 0;
        if (0 < lVar10) {
          do {
            _Memory[lVar5] = pauVar7;
            lVar5 = lVar5 + 1;
            pauVar7 = (undefined (*) [16])(*pauVar7 + iVar15);
          } while (lVar5 < lVar10);
        }
        FUN_18001d980(*_Memory,0,(longlong)(iVar9 * iVar15));
      }
      iVar13 = 0;
      if (0 < (int)*puVar2) {
        lVar5 = 0;
        do {
          iVar13 = iVar13 + 1;
          iVar3 = (*(int **)(lVar5 + *(longlong *)(puVar2 + 6)))[1] - iVar11;
          iVar4 = **(int **)(lVar5 + *(longlong *)(puVar2 + 6)) - iVar12;
          (*_Memory[(int)(iVar3 + (iVar3 >> 0x1f & 3U)) >> 2])
          [(int)(iVar4 + (iVar4 >> 0x1f & 3U)) >> 2] = 0xff;
          lVar5 = lVar5 + 8;
        } while (iVar13 < (int)*puVar2);
      }
      FUN_180012380((char **)_Memory,iVar15,iVar9);
      lVar5 = 0;
      if (0 < lVar10) {
        do {
          lVar6 = 0;
          if (0 < iVar15) {
            do {
              if ((*_Memory[lVar5])[lVar6] == -1) {
                iVar8 = iVar8 + 1;
              }
              lVar6 = lVar6 + 1;
            } while (lVar6 < iVar15);
          }
          lVar5 = lVar5 + 1;
        } while (lVar5 < lVar10);
      }
      free(_Memory);
      local_res18 = local_res18 + 1;
      iVar8 = local_res10 + iVar8;
      local_50 = local_50 + 8;
      local_res10 = iVar8;
    } while (local_res18 < *param_1);
  }
  return iVar8;
}



int FUN_18000db50(int *param_1,int *param_2,undefined8 param_3,longlong param_4)

{
  int *piVar1;
  uint uVar2;
  char *_Memory;
  uint **_Memory_00;
  uint *_Memory_01;
  uint *_Memory_02;
  longlong lVar3;
  int iVar4;
  int iVar5;
  int local_res8;
  int local_68;
  longlong local_58;
  
  iVar5 = 0;
  local_res8 = 0;
  if ((*param_1 < 1) || (*param_2 < 1)) {
    return 0;
  }
  local_68 = 0;
  if (0 < *param_2) {
    local_58 = 0;
    do {
      iVar5 = 0;
      _Memory_00 = (uint **)0x0;
      piVar1 = *(int **)(*(longlong *)(param_2 + 2) + local_58);
      if (0 < *piVar1) {
        _Memory = (char *)calloc((longlong)*piVar1,1);
        if (_Memory == (char *)0x0) {
          iVar5 = -1000;
        }
        else {
          if (*(longlong *)(piVar1 + 4) != 0) {
            _Memory_00 = (uint **)calloc(1,0x18);
          }
          iVar4 = 0;
          if (0 < *param_1) {
            lVar3 = 0;
            do {
              _Memory_01 = (uint *)FUN_18000e240(piVar1);
              _Memory_02 = (uint *)calloc(1,0x38);
              if (_Memory_01 == (uint *)0x0) {
LAB_18000dcd6:
                if (_Memory_02 != (uint *)0x0) {
                  if (*(void **)(_Memory_02 + 2) != (void *)0x0) {
                    free(*(void **)(_Memory_02 + 2));
                  }
                  if (*(void **)(_Memory_02 + 8) != (void *)0x0) {
                    free(*(void **)(_Memory_02 + 8));
                  }
                  if (*(void **)(_Memory_02 + 10) != (void *)0x0) {
                    free(*(void **)(_Memory_02 + 10));
                  }
                  *(undefined8 *)(_Memory_02 + 2) = 0;
                  *(undefined8 *)(_Memory_02 + 8) = 0;
                  *(undefined8 *)(_Memory_02 + 10) = 0;
                  free(_Memory_02);
                }
              }
              else {
                if (_Memory_02 != (uint *)0x0) {
                  *(undefined8 *)(_Memory_01 + 4) = *(undefined8 *)(piVar1 + 4);
                  uVar2 = FUN_18000a610(*(uint **)(*(longlong *)(param_1 + 2) + lVar3),_Memory_01,
                                        param_4,_Memory_02,1,_Memory,_Memory_00);
                  *(undefined8 *)(_Memory_01 + 4) = 0;
                  _Memory_02[4] = uVar2;
                  if (*(int *)(param_4 + 0x58) <= (int)*_Memory_02) {
                    iVar5 = iVar5 + (uVar2 - (int)*(short *)(_Memory_02 + 0xc));
                  }
                  goto LAB_18000dcd6;
                }
              }
              if (_Memory_01 != (uint *)0x0) {
                free(*(void **)(_Memory_01 + 4));
                free(_Memory_01);
              }
              iVar4 = iVar4 + 1;
              lVar3 = lVar3 + 8;
            } while (iVar4 < *param_1);
          }
          if (_Memory_00 != (uint **)0x0) {
            if (*_Memory_00 != (uint *)0x0) {
              free(*_Memory_00);
            }
            if (_Memory_00[1] != (uint *)0x0) {
              free(_Memory_00[1]);
            }
            if (_Memory_00[2] != (uint *)0x0) {
              free(_Memory_00[2]);
            }
            free(_Memory_00);
          }
          free(_Memory);
        }
      }
      local_68 = local_68 + 1;
      iVar5 = local_res8 + iVar5;
      local_58 = local_58 + 8;
      local_res8 = iVar5;
    } while (local_68 < *param_2);
  }
  return iVar5;
}



void FUN_18000ddf0(int *param_1,int *param_2,int *param_3)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  ulonglong *puVar4;
  int iVar5;
  undefined8 uVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  longlong lVar10;
  int *piVar11;
  int iVar12;
  
  lVar2 = DAT_18004cfd0;
  if ((param_2 != (int *)0x0) && (iVar8 = 0, DAT_18004cfd0 != 0)) {
    if (*(byte *)(param_2 + 2) < 3) {
      iVar5 = 3;
      if (1 < *(byte *)(param_2 + 2)) {
        iVar5 = 6;
      }
    }
    else {
      iVar5 = 8;
    }
    iVar1 = *(int *)(DAT_18004cfd0 + 0x48);
    iVar12 = 0;
    piVar11 = **(int ***)(param_1 + 6);
    if (0 < *param_1) {
      do {
        if (-1 < *(short *)((longlong)piVar11 + 0xe)) {
          iVar7 = 0;
          piVar9 = **(int ***)(param_2 + 6);
          if (0 < *param_2) {
            do {
              if ((*(char *)(piVar11 + 3) == *(char *)(piVar9 + 3)) &&
                 (-1 < *(short *)((longlong)piVar9 + 0xe))) {
                iVar3 = *piVar11 - *piVar9;
                if (iVar3 < 0) {
                  iVar3 = *piVar9 - *piVar11;
                }
                if (iVar3 <= *(int *)(lVar2 + 0x98)) {
                  iVar3 = piVar11[1] - piVar9[1];
                  if (iVar3 < 0) {
                    iVar3 = piVar9[1] - piVar11[1];
                  }
                  if (iVar3 <= *(int *)(lVar2 + 0x98)) {
                    iVar3 = 0;
                    if ((longlong)iVar5 != 0) {
                      puVar4 = (ulonglong *)(piVar11 + 4);
                      lVar10 = (longlong)iVar5;
                      do {
                        uVar6 = popcnt(*(ulonglong *)
                                        ((longlong)piVar9 + (0x10 - (longlong)(piVar11 + 4)) +
                                        (longlong)puVar4) ^ *puVar4);
                        iVar3 = iVar3 + (int)uVar6;
                        lVar10 = lVar10 + -1;
                        puVar4 = puVar4 + 1;
                      } while (lVar10 != 0);
                    }
                    if (iVar3 <= iVar1) {
                      *(undefined2 *)((longlong)piVar9 + 0xe) = 0xffff;
                      iVar8 = iVar8 + 1;
                    }
                  }
                }
              }
              iVar7 = iVar7 + 1;
              piVar9 = piVar9 + 0x14;
            } while (iVar7 < *param_2);
          }
        }
        iVar12 = iVar12 + 1;
        piVar11 = piVar11 + 0x14;
      } while (iVar12 < *param_1);
    }
    *param_3 = (iVar8 << 7) / *param_2;
  }
  return;
}



void FUN_18000df70(void)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)malloc(0xa8);
  if (puVar1 == (undefined4 *)0x0) {
    return;
  }
  *puVar1 = 0x10;
  *(undefined8 *)(puVar1 + 1) = 1000;
  *(undefined8 *)(puVar1 + 10) = 1;
  puVar1[3] = 3;
  puVar1[4] = 9;
  puVar1[9] = 0;
  *(undefined8 *)(puVar1 + 0x24) = 0;
  *(undefined8 *)(puVar1 + 0x28) = 0;
  *(undefined8 *)(puVar1 + 0xc) = 0;
  puVar1[0xe] = 0;
  puVar1[6] = 1;
  puVar1[8] = 1;
  puVar1[7] = 2;
  puVar1[0x10] = 700;
  puVar1[0x11] = 0x400;
  puVar1[0x12] = 0x73;
  puVar1[0x13] = 7;
  puVar1[0x14] = 8;
  puVar1[5] = 0x700;
  puVar1[0x15] = 0x294;
  puVar1[0x16] = 5;
  puVar1[0x17] = 0xffffffff;
  *(undefined8 *)(puVar1 + 0x18) = 0x18;
  puVar1[0x1a] = 100;
  puVar1[0x1b] = 10;
  puVar1[0x1c] = 0x14;
  puVar1[0x1d] = 5;
  puVar1[0x1e] = 0xf0;
  puVar1[0x1f] = 1;
  puVar1[0x20] = 0x14;
  puVar1[0x21] = 0x2df;
  *(undefined8 *)(puVar1 + 0x22) = 170000;
  *(undefined8 *)(puVar1 + 0x26) = 2;
  puVar1[0xf] = 0x288;
  return;
}



void * FUN_18000e090(int param_1)

{
  void *pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = calloc(1,(longlong)(param_1 * 0x58 + 0x20));
  if (pvVar1 == (void *)0x0) {
    return (void *)0x0;
  }
  lVar2 = 0;
  lVar3 = (longlong)pvVar1 + 0x20 + (longlong)param_1 * 8;
  *(longlong *)((longlong)pvVar1 + 0x18) = (longlong)pvVar1 + 0x20;
  if (0 < param_1) {
    do {
      lVar2 = lVar2 + 1;
      *(longlong *)(*(longlong *)((longlong)pvVar1 + 0x18) + -8 + lVar2 * 8) = lVar3;
      lVar3 = lVar3 + 0x50;
    } while (lVar2 < param_1);
  }
  return pvVar1;
}



void FUN_18000e0f0(int *param_1,int *param_2)

{
  *param_1 = *param_2;
  *(undefined2 *)(param_1 + 1) = *(undefined2 *)(param_2 + 1);
  *(undefined2 *)((longlong)param_1 + 6) = *(undefined2 *)((longlong)param_2 + 6);
  *(undefined *)(param_1 + 2) = *(undefined *)(param_2 + 2);
  *(undefined *)((longlong)param_1 + 9) = *(undefined *)((longlong)param_2 + 9);
  *(undefined *)((longlong)param_1 + 10) = *(undefined *)((longlong)param_2 + 10);
  if ((*(undefined8 **)(param_1 + 4) != (undefined8 *)0x0) &&
     (*(undefined8 **)(param_2 + 4) != (undefined8 *)0x0)) {
    FUN_18001d320(*(undefined8 **)(param_1 + 4),*(undefined8 **)(param_2 + 4),
                  (longlong)
                  (int)((uint)*(ushort *)(param_2 + 1) * (uint)*(ushort *)((longlong)param_2 + 6)));
  }
  FUN_18001d320((undefined8 *)**(undefined8 **)(param_1 + 6),
                (undefined8 *)**(undefined8 **)(param_2 + 6),(longlong)*param_2 * 0x50);
  return;
}



int * FUN_18000e180(int *param_1,int param_2)

{
  int *piVar1;
  longlong lVar2;
  int *piVar3;
  
  piVar1 = param_1;
  if ((int)((ulonglong)(**(longlong **)(param_1 + 6) - (longlong)*(longlong **)(param_1 + 6)) >> 3)
      != param_2) {
    piVar1 = (int *)calloc(1,(longlong)(param_2 * 0x58 + 0x20));
    if (piVar1 == (int *)0x0) {
      return (int *)0x0;
    }
    lVar2 = 0;
    piVar3 = piVar1 + 8 + (longlong)param_2 * 2;
    *(int **)(piVar1 + 6) = piVar1 + 8;
    if (0 < param_2) {
      do {
        lVar2 = lVar2 + 1;
        *(int **)(*(longlong *)(piVar1 + 6) + -8 + lVar2 * 8) = piVar3;
        piVar3 = piVar3 + 0x14;
      } while (lVar2 < param_2);
    }
    FUN_18000e0f0(piVar1,param_1);
    free(*(void **)(param_1 + 4));
    free(param_1);
  }
  return piVar1;
}



int * FUN_18000e240(int *param_1)

{
  int iVar1;
  int *piVar2;
  longlong lVar3;
  int *piVar4;
  
  iVar1 = *param_1;
  piVar2 = (int *)calloc(1,(longlong)(iVar1 * 0x58 + 0x20));
  if (piVar2 == (int *)0x0) {
    return (int *)0x0;
  }
  lVar3 = 0;
  piVar4 = piVar2 + 8 + (longlong)iVar1 * 2;
  *(int **)(piVar2 + 6) = piVar2 + 8;
  if (0 < iVar1) {
    do {
      lVar3 = lVar3 + 1;
      *(int **)(*(longlong *)(piVar2 + 6) + -8 + lVar3 * 8) = piVar4;
      piVar4 = piVar4 + 0x14;
    } while (lVar3 < iVar1);
  }
  FUN_18000e0f0(piVar2,param_1);
  return piVar2;
}



void * FUN_18000e2e0(int param_1)

{
  void *pvVar1;
  
  pvVar1 = calloc(1,(longlong)param_1 * 8 + 0x10);
  if (pvVar1 == (void *)0x0) {
    return (void *)0x0;
  }
  *(longlong *)((longlong)pvVar1 + 8) = (longlong)pvVar1 + 0x10;
  return pvVar1;
}



undefined8 FUN_18000e320(undefined4 *param_1,int param_2)

{
  size_t _Size;
  void *_Memory;
  void *_Memory_00;
  void *_Memory_01;
  
  *param_1 = 0;
  *(undefined8 *)(param_1 + 4) = 0;
  *(undefined2 *)(param_1 + 6) = 0;
  param_1[0xc] = 0;
  _Memory = malloc((longlong)param_2 * 4);
  _Size = (longlong)param_2 * 8;
  *(void **)(param_1 + 2) = _Memory;
  _Memory_00 = malloc(_Size);
  *(void **)(param_1 + 8) = _Memory_00;
  _Memory_01 = malloc(_Size);
  *(void **)(param_1 + 10) = _Memory_01;
  if (_Memory != (void *)0x0) {
    if ((_Memory_00 != (void *)0x0) && (_Memory_01 != (void *)0x0)) {
      return 0;
    }
    free(_Memory);
  }
  if (_Memory_00 != (void *)0x0) {
    free(_Memory_00);
  }
  if (_Memory_01 != (void *)0x0) {
    free(_Memory_01);
  }
  *(undefined8 *)(param_1 + 2) = 0;
  *(undefined8 *)(param_1 + 8) = 0;
  *(undefined8 *)(param_1 + 10) = 0;
  return 0xfffffc18;
}



void FUN_18000e3f0(int *param_1)

{
  void *_Memory;
  longlong lVar1;
  uint uVar2;
  ulonglong uVar4;
  ulonglong uVar3;
  
  uVar3 = 0;
  uVar4 = uVar3;
  if (0 < *param_1) {
    do {
      _Memory = *(void **)(uVar4 + *(longlong *)(param_1 + 6));
      if (_Memory != (void *)0x0) {
        free(*(void **)((longlong)_Memory + 0x10));
        free(_Memory);
      }
      lVar1 = *(longlong *)(uVar4 + *(longlong *)(param_1 + 4));
      if (lVar1 != 0) {
        if (*(void **)(lVar1 + 8) != (void *)0x0) {
          free(*(void **)(lVar1 + 8));
        }
        if (*(void **)(lVar1 + 0x20) != (void *)0x0) {
          free(*(void **)(lVar1 + 0x20));
        }
        if (*(void **)(lVar1 + 0x28) != (void *)0x0) {
          free(*(void **)(lVar1 + 0x28));
        }
        *(undefined8 *)(lVar1 + 8) = 0;
        *(undefined8 *)(lVar1 + 0x20) = 0;
        *(undefined8 *)(lVar1 + 0x28) = 0;
        free(*(void **)(*(longlong *)(param_1 + 4) + uVar4));
      }
      uVar2 = (int)uVar3 + 1;
      uVar3 = (ulonglong)uVar2;
      uVar4 = uVar4 + 8;
    } while ((int)uVar2 < *param_1);
  }
  free(param_1);
  return;
}



void FUN_18000e4c0(int *param_1)

{
  void *_Memory;
  int iVar1;
  longlong lVar2;
  
  if (param_1 != (int *)0x0) {
    iVar1 = 0;
    if (0 < *param_1) {
      lVar2 = 0;
      do {
        _Memory = *(void **)(lVar2 + *(longlong *)(param_1 + 2));
        if (_Memory != (void *)0x0) {
          free(*(void **)((longlong)_Memory + 0x10));
          free(_Memory);
        }
        iVar1 = iVar1 + 1;
        lVar2 = lVar2 + 8;
      } while (iVar1 < *param_1);
    }
    free(param_1);
  }
  return;
}



int FUN_18000e540(uint *param_1)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if (param_1 == (uint *)0x0) {
    return 0;
  }
  uVar3 = *param_1;
  if (0 < (int)uVar3) {
    psVar2 = (short *)(**(longlong **)(param_1 + 6) + 0xe);
    uVar4 = (ulonglong)uVar3;
    do {
      if (*psVar2 < 0) {
        uVar3 = uVar3 - 1;
      }
      psVar2 = psVar2 + 0x28;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  iVar1 = (((int)((uint)*(byte *)(param_1 + 2) * 0xa2 + 7) >> 3) + 8) * uVar3 + 0xb;
  if (*(longlong *)(param_1 + 4) != 0) {
    iVar1 = iVar1 + (uint)*(ushort *)((longlong)param_1 + 6) * (uint)*(ushort *)(param_1 + 1);
  }
  return iVar1;
}



undefined8 FUN_18000e5b0(uint *param_1,undefined2 *param_2)

{
  undefined uVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if ((*(byte *)(param_1 + 2) < 4) && (*(byte *)((longlong)param_1 + 9) < 0x81)) {
    *param_2 = 0x147;
    uVar1 = *(undefined *)((longlong)param_2 + 1);
    if (*(longlong *)(param_1 + 4) != 0) {
      uVar1 = 3;
    }
    *(undefined *)((longlong)param_2 + 1) = uVar1;
    uVar3 = *param_1;
    if (0 < (int)uVar3) {
      psVar2 = (short *)(**(longlong **)(param_1 + 6) + 0xe);
      uVar4 = (ulonglong)uVar3;
      do {
        if (*psVar2 < 0) {
          uVar3 = uVar3 - 1;
        }
        psVar2 = psVar2 + 0x28;
        uVar4 = uVar4 - 1;
      } while (uVar4 != 0);
    }
    param_2[1] = (short)uVar3;
    param_2[2] = *(undefined2 *)(param_1 + 1);
    param_2[3] = *(undefined2 *)((longlong)param_1 + 6);
    *(undefined *)(param_2 + 4) = *(undefined *)(param_1 + 2);
    *(undefined *)((longlong)param_2 + 9) = *(undefined *)((longlong)param_1 + 9);
    *(undefined *)(param_2 + 5) = *(undefined *)((longlong)param_1 + 10);
    return 0;
  }
  return 0xfffffc17;
}



undefined8 FUN_18000e640(uint *param_1,undefined *param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  
  if ((*(byte *)(param_1 + 3) < 2) && (*(short *)((longlong)param_1 + 0xe) < 0x169)) {
    uVar1 = *param_1;
    uVar2 = param_1[1];
    param_2[1] = (char)uVar2;
    *param_2 = (char)uVar1;
    param_2[2] = *(undefined *)((longlong)param_1 + 0xe);
    *(uint *)(param_2 + 3) =
         ((((*(byte *)(param_1 + 3) & 1) << 0xc | uVar1 & 0x700) << 4 | uVar2 & 0x700) * 2 |
         (int)*(short *)((longlong)param_1 + 0xe) & 0x100U) << 5 |
         (uVar2 >> 4 & 0x8000000 | uVar1 & 0x800003ff) >> 10 | param_1[2] & 0x1fff;
    param_2[7] = *(undefined *)((longlong)param_1 + 0xd);
    FUN_18001d320((undefined8 *)(param_2 + 8),(undefined8 *)(param_1 + 4),(longlong)param_3);
    return 0;
  }
  return 0xfffffc17;
}



int FUN_18000e700(uint *param_1,undefined2 *param_2)

{
  int iVar1;
  undefined8 uVar2;
  int iVar3;
  uint **ppuVar4;
  int iVar5;
  
  ppuVar4 = *(uint ***)(param_1 + 6);
  iVar1 = (int)((uint)*(byte *)(param_1 + 2) * 0xa2 + 7) >> 3;
  uVar2 = FUN_18000e5b0(param_1,param_2);
  if ((int)uVar2 == 0) {
    iVar5 = 0;
    iVar3 = 0xb;
    if (0 < (int)*param_1) {
      do {
        if (-1 < *(short *)((longlong)*ppuVar4 + 0xe)) {
          uVar2 = FUN_18000e640(*ppuVar4,(undefined *)((longlong)iVar3 + (longlong)param_2),iVar1);
          if ((int)uVar2 < 0) {
            return -0x3e9;
          }
          iVar3 = iVar3 + iVar1 + 8;
        }
        iVar5 = iVar5 + 1;
        ppuVar4 = ppuVar4 + 1;
      } while (iVar5 < (int)*param_1);
    }
    if (*(undefined8 **)(param_1 + 4) != (undefined8 *)0x0) {
      iVar1 = (uint)*(ushort *)((longlong)param_1 + 6) * (uint)*(ushort *)(param_1 + 1);
      FUN_18001d320((undefined8 *)((longlong)iVar3 + (longlong)param_2),
                    *(undefined8 **)(param_1 + 4),(longlong)iVar1);
      iVar3 = iVar3 + iVar1;
    }
  }
  else {
    iVar3 = -0x3e9;
  }
  return iVar3;
}



int FUN_18000e7e0(uint *param_1,char *param_2)

{
  ushort *puVar1;
  byte bVar2;
  byte bVar3;
  ushort uVar4;
  uint uVar5;
  undefined8 *puVar6;
  int iVar7;
  uint uVar8;
  int iVar10;
  uint uVar11;
  uint uVar12;
  ulonglong uVar13;
  ulonglong uVar9;
  
  if ((param_2 == (char *)0x0) || (param_1 == (uint *)0x0)) {
    return -0x3ea;
  }
  if ((*param_2 == 'G') && (uVar4 = *(ushort *)(param_2 + 2), uVar4 < 0x1001)) {
    *param_1 = (uint)uVar4;
    *(undefined2 *)(param_1 + 1) = *(undefined2 *)(param_2 + 4);
    iVar10 = 0xb;
    *(undefined2 *)((longlong)param_1 + 6) = *(undefined2 *)(param_2 + 6);
    bVar2 = param_2[8];
    *(byte *)(param_1 + 2) = bVar2;
    bVar3 = param_2[9];
    *(byte *)((longlong)param_1 + 9) = bVar3;
    *(char *)((longlong)param_1 + 10) = param_2[10];
    if ((3 < bVar2) || (0x80 < bVar3)) {
      return -0x3e9;
    }
    uVar9 = 0;
    iVar7 = 0;
    uVar5 = (int)((uint)bVar2 * 0xa2 + 7) >> 3;
    uVar13 = uVar9;
    if (uVar4 != 0) {
      do {
        bVar2 = param_2[iVar10];
        bVar3 = param_2[iVar10 + 1];
        *(ushort *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xe) =
             (ushort)(byte)param_2[iVar10 + 2];
        uVar8 = *(uint *)(param_2 + (iVar10 + 3));
        uVar11 = (uint)bVar2 | (int)uVar8 >> 10 & 0x700U;
        *(byte *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xc) =
             (byte)((int)uVar8 >> 0x16) & 1;
        uVar12 = (uint)bVar3 | (int)uVar8 >> 6 & 0x700U;
        if ((uVar8 >> 0x15 & 1) != 0) {
          uVar11 = uVar11 | 0xfffff800;
        }
        if ((uVar8 >> 0x11 & 1) != 0) {
          uVar12 = uVar12 | 0xfffff800;
        }
        **(uint **)(uVar13 + *(longlong *)(param_1 + 6)) = uVar11;
        *(uint *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 4) = uVar12;
        puVar1 = (ushort *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xe);
        *puVar1 = *puVar1 | (ushort)((int)uVar8 >> 5) & 0x100;
        if (0x169 < (ushort)(*(short *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xe) +
                            1U)) {
          return -0x3e9;
        }
        *(uint *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 8) = uVar8 & 0x1fff;
        *(char *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0xd) = param_2[iVar10 + 7];
        FUN_18001d320((undefined8 *)(*(longlong *)(uVar13 + *(longlong *)(param_1 + 6)) + 0x10),
                      (undefined8 *)(param_2 + (iVar10 + 8)),(ulonglong)uVar5);
        uVar8 = (int)uVar9 + 1;
        uVar9 = (ulonglong)uVar8;
        iVar10 = iVar10 + 8 + uVar5;
        uVar13 = uVar13 + 8;
      } while ((int)uVar8 < (int)*param_1);
    }
    if ((param_2[1] & 2U) != 0) {
      iVar7 = (uint)*(ushort *)((longlong)param_1 + 6) * (uint)*(ushort *)(param_1 + 1);
      puVar6 = (undefined8 *)malloc((longlong)iVar7);
      *(undefined8 **)(param_1 + 4) = puVar6;
      if (puVar6 != (undefined8 *)0x0) {
        FUN_18001d320(puVar6,(undefined8 *)(param_2 + iVar10),(longlong)iVar7);
      }
    }
    return (int)((uVar5 + 8) * *param_1 + 0xb + iVar7);
  }
  return -0x3e9;
}



ulonglong FUN_18000ea60(int *param_1,short *param_2,int param_3)

{
  uint *puVar1;
  short *psVar2;
  uint uVar3;
  ulonglong uVar4;
  uint uVar5;
  int iVar6;
  ulonglong uVar7;
  short sVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  uint **ppuVar11;
  
  sVar8 = *(short *)param_1;
  uVar7 = 0;
  uVar9 = uVar7;
  if (0 < *param_1) {
    ppuVar11 = *(uint ***)(param_1 + 2);
    do {
      puVar1 = *ppuVar11;
      if (puVar1 == (uint *)0x0) {
        return 0xfffffc17;
      }
      uVar3 = *puVar1;
      uVar4 = (ulonglong)uVar3;
      if (0x1000 < uVar3) {
        return 0xfffffc17;
      }
      uVar5 = uVar3;
      if (0 < (int)uVar3) {
        psVar2 = (short *)(**(longlong **)(puVar1 + 6) + 0xe);
        uVar10 = (ulonglong)uVar3;
        do {
          if (*psVar2 < 0) {
            uVar5 = uVar5 - 1;
          }
          psVar2 = psVar2 + 0x28;
          uVar10 = uVar10 - 1;
        } while (uVar10 != 0);
      }
      if ((int)uVar5 < param_3) {
        sVar8 = sVar8 + -1;
      }
      else {
        if (0 < (int)uVar3) {
          psVar2 = (short *)(**(longlong **)(puVar1 + 6) + 0xe);
          uVar10 = uVar4;
          do {
            if (*psVar2 < 0) {
              uVar4 = (ulonglong)((int)uVar4 - 1);
            }
            uVar3 = (uint)uVar4;
            psVar2 = psVar2 + 0x28;
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
        }
        iVar6 = (((int)((uint)*(byte *)(puVar1 + 2) * 0xa2 + 7) >> 3) + 8) * uVar3 + 0xb;
        if (*(longlong *)(puVar1 + 4) != 0) {
          iVar6 = iVar6 + (uint)*(ushort *)((longlong)puVar1 + 6) * (uint)*(ushort *)(puVar1 + 1);
        }
        uVar9 = (ulonglong)(uint)((int)uVar9 + iVar6);
      }
      uVar7 = uVar7 + 1;
      ppuVar11 = ppuVar11 + 1;
    } while ((longlong)uVar7 < (longlong)*param_1);
  }
  *param_2 = sVar8;
  return uVar9;
}



int FUN_18000eb80(int *param_1,void **param_2,int *param_3,longlong param_4)

{
  uint *puVar1;
  int iVar2;
  ulonglong uVar3;
  undefined8 *puVar4;
  short *psVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  longlong lVar9;
  short local_res18 [4];
  
  if (param_3 == (int *)0x0) {
    return -0x3ea;
  }
  if ((*param_1 - 1U < 0x28) && (*(longlong *)(param_1 + 2) != 0)) {
    uVar3 = FUN_18000ea60(param_1,local_res18,*(int *)(param_4 + 0x58));
    iVar7 = (int)uVar3;
    if (-1 < iVar7) {
      *param_3 = iVar7 + 0x20;
      if (param_2 == (void **)0x0) {
        return 0;
      }
      puVar4 = (undefined8 *)malloc((longlong)(iVar7 + 0x28));
      *param_2 = puVar4;
      if (puVar4 == (undefined8 *)0x0) {
        iVar2 = -1000;
LAB_18000ec25:
        if (*param_2 != (void *)0x0) {
          free(*param_2);
          *param_2 = (void *)0x0;
        }
      }
      else {
        iVar8 = 0;
        iVar7 = 0x20;
        *puVar4 = 0;
        puVar4[1] = 0;
        puVar4[2] = 0;
        puVar4[3] = 0;
        *(undefined2 *)puVar4 = 0x145;
        *(short *)((longlong)puVar4 + 2) = local_res18[0];
        if (0 < *param_1) {
          lVar9 = 0;
          do {
            puVar1 = *(uint **)(lVar9 + *(longlong *)(param_1 + 2));
            uVar6 = *puVar1;
            if (0 < (int)uVar6) {
              psVar5 = (short *)(**(longlong **)(puVar1 + 6) + 0xe);
              uVar3 = (ulonglong)uVar6;
              do {
                if (*psVar5 < 0) {
                  uVar6 = uVar6 - 1;
                }
                psVar5 = psVar5 + 0x28;
                uVar3 = uVar3 - 1;
              } while (uVar3 != 0);
            }
            if (*(int *)(param_4 + 0x58) <= (int)uVar6) {
              iVar2 = FUN_18000e700(puVar1,(undefined2 *)((longlong)iVar7 + (longlong)puVar4));
              if (iVar2 < 0) goto LAB_18000ec25;
              iVar7 = iVar7 + iVar2;
            }
            iVar8 = iVar8 + 1;
            lVar9 = lVar9 + 8;
          } while (iVar8 < *param_1);
        }
        iVar2 = 0;
      }
      return iVar2;
    }
  }
  return -0x3e9;
}



int FUN_18000ed10(uint *param_1,char *param_2)

{
  ushort uVar1;
  int iVar2;
  void *pvVar3;
  ulonglong uVar4;
  longlong lVar5;
  int iVar6;
  ulonglong uVar7;
  int iVar8;
  
  if ((param_2 == (char *)0x0) || (param_1 == (uint *)0x0)) {
    return -0x3ea;
  }
  if ((*param_2 != 'E') || (uVar1 = *(ushort *)(param_2 + 2), 0x27 < uVar1 - 1)) {
    return -0x3e9;
  }
  uVar4 = 0;
  iVar8 = 0x20;
  *param_1 = (uint)uVar1;
  uVar7 = uVar4;
  if (uVar1 != 0) {
    do {
      iVar6 = (int)uVar7;
      uVar1 = *(ushort *)(param_2 + iVar8 + 2);
      if (0x1000 < uVar1) {
        return -0x3e9;
      }
      pvVar3 = FUN_18000e090((uint)uVar1);
      *(void **)(uVar4 + *(longlong *)(param_1 + 2)) = pvVar3;
      if (*(uint **)(uVar4 + *(longlong *)(param_1 + 2)) == (uint *)0x0) {
        iVar2 = -1000;
        iVar6 = iVar6 + -1;
LAB_18000edf5:
        lVar5 = (longlong)iVar6;
        if (iVar6 < 0) {
          return iVar2;
        }
        do {
          pvVar3 = *(void **)(*(longlong *)(param_1 + 2) + lVar5 * 8);
          if (pvVar3 != (void *)0x0) {
            free(*(void **)((longlong)pvVar3 + 0x10));
            free(pvVar3);
          }
          lVar5 = lVar5 + -1;
          *(undefined8 *)(*(longlong *)(param_1 + 2) + 8 + lVar5 * 8) = 0;
        } while (-1 < lVar5);
        return iVar2;
      }
      iVar2 = FUN_18000e7e0(*(uint **)(uVar4 + *(longlong *)(param_1 + 2)),param_2 + iVar8);
      if (iVar2 < 0) goto LAB_18000edf5;
      iVar8 = iVar8 + iVar2;
      uVar4 = uVar4 + 8;
      uVar7 = (ulonglong)(iVar6 + 1U);
    } while ((int)(iVar6 + 1U) < (int)*param_1);
  }
  return 0;
}



int * FUN_18000ee50(int param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  piVar1 = (int *)calloc((longlong)(param_2 * 8) + ((longlong)(param_1 * param_2) + 4) * 4,1);
  if (piVar1 == (int *)0x0) {
    return (int *)0x0;
  }
  *piVar1 = param_1;
  piVar1[1] = param_2;
  piVar2 = piVar1 + 4;
  *(int **)(piVar1 + 2) = piVar2;
  lVar3 = (longlong)piVar2 + (longlong)(param_2 * 8);
  lVar4 = 0;
  if (0 < param_2) {
    do {
      *(longlong *)(piVar2 + lVar4 * 2) = lVar3;
      lVar4 = lVar4 + 1;
      lVar3 = lVar3 + (longlong)param_1 * 4;
    } while (lVar4 < param_2);
  }
  return piVar1;
}



void FUN_18000eef0(longlong param_1,int param_2,int param_3,uint *param_4)

{
  uint uVar1;
  longlong lVar2;
  int iVar3;
  
  uVar1 = *param_4;
  if (((uVar1 & 0x3fffffff) != 0) && (iVar3 = 0, 0 < (int)param_4[1])) {
    lVar2 = 0;
    do {
      FUN_18001d320(*(undefined8 **)(*(longlong *)(param_4 + 2) + lVar2),
                    (undefined8 *)
                    (*(longlong *)(*(longlong *)(param_1 + 8) + (longlong)param_3 * 8 + lVar2) +
                    (longlong)param_2 * 4),(longlong)(int)(uVar1 << 2));
      iVar3 = iVar3 + 1;
      lVar2 = lVar2 + 8;
    } while (iVar3 < (int)param_4[1]);
  }
  return;
}



void FUN_18000ef90(int *param_1)

{
  undefined8 *_Memory;
  longlong lVar1;
  longlong lVar2;
  int iVar3;
  ulonglong uVar4;
  
  iVar3 = *param_1 * 4;
  if ((iVar3 != 0) &&
     (_Memory = (undefined8 *)malloc((longlong)*param_1 << 2), _Memory != (undefined8 *)0x0)) {
    lVar1 = 0;
    lVar2 = (longlong)(param_1[1] + -1);
    if (0 < param_1[1] + -1) {
      uVar4 = SEXT48(iVar3);
      do {
        FUN_18001d320(_Memory,*(undefined8 **)(*(longlong *)(param_1 + 2) + lVar1 * 8),uVar4);
        FUN_18001d320(*(undefined8 **)(*(longlong *)(param_1 + 2) + lVar1 * 8),
                      *(undefined8 **)(*(longlong *)(param_1 + 2) + lVar2 * 8),uVar4);
        FUN_18001d320(*(undefined8 **)(*(longlong *)(param_1 + 2) + lVar2 * 8),_Memory,uVar4);
        lVar1 = lVar1 + 1;
        lVar2 = lVar2 + -1;
      } while (lVar1 < lVar2);
    }
    free(_Memory);
  }
  return;
}



void FUN_18000f060(longlong param_1,int param_2,int param_3,int *param_4)

{
  int iVar1;
  longlong lVar2;
  int iVar3;
  
  iVar1 = *param_4;
  iVar3 = 0;
  if (0 < param_4[1]) {
    lVar2 = 0;
    do {
      FUN_18001d320((undefined8 *)
                    (*(longlong *)(*(longlong *)(param_1 + 8) + (longlong)param_3 * 8 + lVar2) +
                    (longlong)param_2 * 4),*(undefined8 **)(*(longlong *)(param_4 + 2) + lVar2),
                    (longlong)(iVar1 << 2));
      iVar3 = iVar3 + 1;
      lVar2 = lVar2 + 8;
    } while (iVar3 < param_4[1]);
  }
  return;
}



int * FUN_18000f100(int *param_1)

{
  int *piVar1;
  
  piVar1 = FUN_18000ee50(*param_1,param_1[1]);
  if (piVar1 == (int *)0x0) {
    return (int *)0x0;
  }
  FUN_18001d320((undefined8 *)**(undefined8 **)(piVar1 + 2),
                (undefined8 *)**(undefined8 **)(param_1 + 2),(longlong)(*param_1 * param_1[1]) << 2)
  ;
  return piVar1;
}



void FUN_18000f160(uint *param_1,longlong param_2)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  void **_Memory;
  void *_Memory_00;
  void *pvVar12;
  longlong lVar13;
  longlong lVar14;
  longlong lVar15;
  int *piVar16;
  int iVar17;
  longlong lVar18;
  longlong lVar19;
  int iVar20;
  void **ppvVar21;
  size_t _Count;
  
  uVar3 = *param_1;
  _Count = SEXT48((int)uVar3);
  uVar4 = param_1[1];
  lVar15 = (longlong)(int)uVar4;
  iVar20 = 0;
  _Memory = (void **)malloc(lVar15 * 8);
  _Memory_00 = calloc(_Count,4);
  lVar19 = 0;
  do {
    pvVar12 = malloc(_Count * 4);
    lVar18 = lVar19 + 1;
    _Memory[lVar19] = pvVar12;
    lVar19 = lVar18;
  } while (lVar18 < 3);
  if (-1 < lVar15) {
    lVar19 = -1;
    ppvVar21 = _Memory;
    do {
      if (-1 < lVar19 + -2) {
        pvVar12 = ppvVar21[-3];
        lVar18 = 0;
        if ((0 < (int)uVar3) && (7 < uVar3)) {
          iVar17 = 0;
          if (((void *)((longlong)pvVar12 + (longlong)(int)(uVar3 - 1) * 4) < _Memory_00) ||
             ((void *)((longlong)_Memory_00 + (longlong)(int)(uVar3 - 1) * 4) < pvVar12)) {
            uVar10 = uVar3 & 0x80000007;
            if ((int)uVar10 < 0) {
              uVar10 = (uVar10 - 1 | 0xfffffff8) + 1;
            }
            do {
              lVar13 = (longlong)iVar17;
              lVar18 = lVar18 + 8;
              piVar16 = (int *)((longlong)pvVar12 + lVar13 * 4);
              iVar11 = piVar16[1];
              iVar5 = piVar16[2];
              iVar6 = piVar16[3];
              piVar1 = (int *)((longlong)_Memory_00 + lVar13 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)_Memory_00 + lVar13 * 4);
              *piVar2 = *piVar1 - *piVar16;
              piVar2[1] = iVar7 - iVar11;
              piVar2[2] = iVar8 - iVar5;
              piVar2[3] = iVar9 - iVar6;
              iVar11 = iVar17 + 4;
              iVar17 = iVar17 + 8;
              lVar13 = (longlong)iVar11;
              piVar16 = (int *)((longlong)_Memory_00 + lVar13 * 4);
              iVar11 = piVar16[1];
              iVar5 = piVar16[2];
              iVar6 = piVar16[3];
              piVar1 = (int *)((longlong)pvVar12 + lVar13 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)_Memory_00 + lVar13 * 4);
              *piVar2 = *piVar16 - *piVar1;
              piVar2[1] = iVar11 - iVar7;
              piVar2[2] = iVar5 - iVar8;
              piVar2[3] = iVar6 - iVar9;
            } while (iVar17 < (int)(uVar3 - uVar10));
          }
        }
        if (lVar18 < (longlong)_Count) {
          lVar13 = _Count - lVar18;
          piVar16 = (int *)((longlong)_Memory_00 + lVar18 * 4);
          do {
            *piVar16 = *piVar16 -
                       *(int *)((longlong)((longlong)pvVar12 - (longlong)_Memory_00) +
                               (longlong)piVar16);
            lVar13 = lVar13 + -1;
            piVar16 = piVar16 + 1;
          } while (lVar13 != 0);
        }
        iVar20 = iVar20 + -1;
      }
      lVar18 = lVar19 + 1;
      if (lVar18 < lVar15) {
        if (-1 < lVar19 + -2) {
          *ppvVar21 = ppvVar21[-3];
        }
        FUN_18001d320((undefined8 *)*ppvVar21,
                      *(undefined8 **)
                       ((*(longlong *)(param_1 + 2) - (longlong)_Memory) + (longlong)ppvVar21),
                      _Count * 4);
        pvVar12 = *ppvVar21;
        lVar13 = 0;
        if ((0 < (int)uVar3) && (7 < uVar3)) {
          iVar17 = 0;
          if (((void *)((longlong)pvVar12 + (longlong)(int)(uVar3 - 1) * 4) < _Memory_00) ||
             ((void *)((longlong)_Memory_00 + (longlong)(int)(uVar3 - 1) * 4) < pvVar12)) {
            uVar10 = uVar3 & 0x80000007;
            if ((int)uVar10 < 0) {
              uVar10 = (uVar10 - 1 | 0xfffffff8) + 1;
            }
            do {
              lVar14 = (longlong)iVar17;
              lVar13 = lVar13 + 8;
              piVar16 = (int *)((longlong)_Memory_00 + lVar14 * 4);
              iVar11 = piVar16[1];
              iVar5 = piVar16[2];
              iVar6 = piVar16[3];
              piVar1 = (int *)((longlong)pvVar12 + lVar14 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)_Memory_00 + lVar14 * 4);
              *piVar2 = *piVar1 + *piVar16;
              piVar2[1] = iVar7 + iVar11;
              piVar2[2] = iVar8 + iVar5;
              piVar2[3] = iVar9 + iVar6;
              iVar11 = iVar17 + 4;
              iVar17 = iVar17 + 8;
              lVar14 = (longlong)iVar11;
              piVar16 = (int *)((longlong)pvVar12 + lVar14 * 4);
              iVar11 = piVar16[1];
              iVar5 = piVar16[2];
              iVar6 = piVar16[3];
              piVar1 = (int *)((longlong)_Memory_00 + lVar14 * 4);
              iVar7 = piVar1[1];
              iVar8 = piVar1[2];
              iVar9 = piVar1[3];
              piVar2 = (int *)((longlong)_Memory_00 + lVar14 * 4);
              *piVar2 = *piVar16 + *piVar1;
              piVar2[1] = iVar11 + iVar7;
              piVar2[2] = iVar5 + iVar8;
              piVar2[3] = iVar6 + iVar9;
            } while (iVar17 < (int)(uVar3 - uVar10));
          }
        }
        if (lVar13 < (longlong)_Count) {
          lVar14 = _Count - lVar13;
          piVar16 = (int *)((longlong)_Memory_00 + lVar13 * 4);
          do {
            *piVar16 = *piVar16 +
                       *(int *)((longlong)piVar16 +
                               (longlong)((longlong)pvVar12 - (longlong)_Memory_00));
            lVar14 = lVar14 + -1;
            piVar16 = piVar16 + 1;
          } while (lVar14 != 0);
        }
        iVar20 = iVar20 + 1;
      }
      if (-1 < lVar19) {
        lVar14 = -1;
        lVar13 = (-8 - (longlong)_Memory) + (longlong)ppvVar21;
        iVar11 = 0;
        iVar17 = 0;
        lVar19 = *(longlong *)(lVar13 + *(longlong *)(param_1 + 2));
        if (-1 < (longlong)_Count) {
          piVar16 = (int *)((longlong)_Memory_00 + -0xc);
          lVar13 = (*(longlong *)(lVar13 + *(longlong *)(param_2 + 8)) - (longlong)_Memory_00) + 8;
          do {
            if (-1 < lVar14 + -2) {
              iVar11 = iVar11 - *piVar16;
              iVar17 = iVar17 - iVar20;
            }
            if (lVar14 + 1 < (longlong)_Count) {
              iVar11 = iVar11 + piVar16[3];
              iVar17 = iVar17 + iVar20;
            }
            if (-1 < lVar14) {
              if (iVar17 == 9) {
                *(int *)(lVar13 + (longlong)piVar16) =
                     ((*(int *)((lVar19 - (longlong)_Memory_00) + 8 + (longlong)piVar16) +
                      iVar11 * 4) * 2 + 0x25) / 0x4a;
              }
              else {
                *(int *)(lVar13 + (longlong)piVar16) = iVar11 / iVar17;
              }
            }
            lVar14 = lVar14 + 1;
            piVar16 = piVar16 + 1;
          } while (lVar14 < (longlong)_Count);
        }
      }
      ppvVar21 = ppvVar21 + 1;
      lVar19 = lVar18;
    } while (lVar18 < lVar15);
  }
  for (lVar19 = (longlong)(int)(uVar4 - 3); lVar19 < lVar15; lVar19 = lVar19 + 1) {
    free(_Memory[lVar19]);
  }
  free(_Memory);
  free(_Memory_00);
  return;
}



void FUN_18000f510(int *param_1,longlong param_2,longlong param_3,int param_4)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  int iVar4;
  longlong lVar5;
  longlong *plVar6;
  longlong lVar7;
  longlong lVar8;
  int iVar9;
  longlong *plVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  
  lVar8 = 1;
  if (param_4 < 2) {
    iVar9 = 1 - param_4;
  }
  else {
    iVar9 = param_4 + -2;
  }
  iVar4 = param_1[1] + -2;
  if (param_4 < iVar4) {
    iVar4 = param_4 + 2;
  }
  else {
    if (param_4 == iVar4) {
      iVar4 = param_1[1] + -1;
    }
  }
  lVar1 = *(longlong *)(param_1 + 2);
  iVar13 = 0;
  if (0 < *param_1) {
    lVar5 = 0;
    plVar6 = (longlong *)((longlong)iVar4 * 8 + lVar1);
    plVar10 = (longlong *)((longlong)iVar9 * 8 + lVar1);
    lVar11 = (longlong)(*param_1 + -2);
    do {
      lVar7 = lVar8;
      if (1 < lVar5) {
        lVar7 = lVar5 + -2;
      }
      if (lVar5 < lVar11) {
        lVar12 = lVar5 + 2;
      }
      else {
        lVar12 = lVar11 + 1;
        if (lVar5 != lVar11) {
          lVar12 = lVar11;
        }
      }
      if (param_2 != 0) {
        lVar2 = *plVar6;
        lVar3 = *plVar10;
        iVar9 = (((*(int *)(lVar3 + lVar12 * 4) - *(int *)(lVar3 + lVar7 * 4)) -
                 *(int *)(lVar2 + lVar7 * 4)) + *(int *)(lVar2 + lVar12 * 4)) * 3;
        lVar2 = *(longlong *)(lVar1 + (longlong)param_4 * 8);
        iVar4 = (*(int *)(lVar2 + lVar12 * 4) - *(int *)(lVar2 + lVar7 * 4)) * 10;
        *(int *)(param_2 + lVar5 * 4) = (int)((uint)(0 < iVar4 + iVar9) + iVar4 + 0x1f + iVar9) >> 6
        ;
      }
      lVar2 = *plVar6;
      lVar3 = *plVar10;
      iVar9 = (((*(int *)(lVar2 + lVar7 * 4) - *(int *)(lVar3 + lVar7 * 4)) -
               *(int *)(lVar3 + lVar12 * 4)) + *(int *)(lVar2 + lVar12 * 4)) * 3;
      iVar4 = (*(int *)(lVar2 + lVar5 * 4) - *(int *)(lVar3 + lVar5 * 4)) * 10;
      iVar13 = iVar13 + 1;
      lVar5 = lVar5 + 1;
      lVar8 = lVar8 + -1;
      *(int *)(param_3 + -4 + lVar5 * 4) = (int)((0 < iVar4 + iVar9) + 0x1f + iVar4 + iVar9) >> 6;
    } while (iVar13 < *param_1);
  }
  return;
}



void FUN_18000f6b0(int *param_1,longlong param_2,longlong param_3)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  ulonglong uVar5;
  int iVar6;
  int iVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  int iVar10;
  longlong lVar11;
  int iVar12;
  longlong lVar13;
  ulonglong uVar14;
  ulonglong uVar15;
  longlong lVar16;
  uint uVar17;
  longlong local_res10;
  ulonglong uVar18;
  
  uVar8 = 0;
  if (param_2 == 0) {
    iVar7 = param_1[1];
    if (0 < iVar7) {
      iVar12 = *param_1;
      local_res10 = 1;
      uVar9 = uVar8;
      uVar5 = uVar8;
      do {
        lVar1 = *(longlong *)(*(longlong *)(param_3 + 8) + uVar9 * 8);
        lVar13 = local_res10;
        if (1 < (longlong)uVar9) {
          lVar13 = uVar9 - 2;
        }
        iVar6 = iVar7 + -2;
        iVar10 = (int)uVar5;
        if (iVar10 < iVar6) {
          iVar6 = iVar10 + 2;
        }
        else {
          if (iVar10 == iVar6) {
            iVar6 = iVar7 + -1;
          }
        }
        lVar2 = *(longlong *)(param_1 + 2);
        if (0 < iVar12) {
          uVar15 = SEXT48(iVar12 + -2);
          lVar11 = 1;
          uVar5 = uVar8;
          uVar18 = uVar8;
          do {
            lVar16 = lVar11;
            if (1 < (longlong)uVar5) {
              lVar16 = uVar5 - 2;
            }
            if ((longlong)uVar5 < (longlong)uVar15) {
              uVar14 = uVar5 + 2;
            }
            else {
              uVar14 = uVar15 + 1;
              if (uVar5 != uVar15) {
                uVar14 = uVar15;
              }
            }
            lVar3 = *(longlong *)(lVar2 + (longlong)iVar6 * 8);
            lVar4 = *(longlong *)(lVar2 + lVar13 * 8);
            iVar7 = (((*(int *)(lVar3 + lVar16 * 4) - *(int *)(lVar4 + lVar16 * 4)) -
                     *(int *)(lVar4 + uVar14 * 4)) + *(int *)(lVar3 + uVar14 * 4)) * 3;
            iVar12 = (*(int *)(lVar3 + uVar5 * 4) - *(int *)(lVar4 + uVar5 * 4)) * 10;
            uVar17 = (int)uVar18 + 1;
            uVar18 = (ulonglong)uVar17;
            uVar5 = uVar5 + 1;
            lVar11 = lVar11 + -1;
            *(int *)(lVar1 + -4 + uVar5 * 4) =
                 (int)((0 < iVar12 + iVar7) + 0x1f + iVar12 + iVar7) >> 6;
            iVar12 = *param_1;
          } while ((int)uVar17 < iVar12);
        }
        iVar7 = param_1[1];
        local_res10 = local_res10 + -1;
        uVar5 = (ulonglong)(iVar10 + 1U);
        uVar9 = uVar9 + 1;
      } while ((int)(iVar10 + 1U) < iVar7);
      return;
    }
  }
  else {
    uVar9 = uVar8;
    if (0 < param_1[1]) {
      do {
        FUN_18000f510(param_1,*(longlong *)(*(longlong *)(param_2 + 8) + uVar9),
                      *(longlong *)(*(longlong *)(param_3 + 8) + uVar9),(int)uVar8);
        uVar17 = (int)uVar8 + 1;
        uVar8 = (ulonglong)uVar17;
        uVar9 = uVar9 + 8;
      } while ((int)uVar17 < param_1[1]);
    }
  }
  return;
}



void FUN_18000f870(uint *param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  uint uVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  longlong lVar9;
  int iVar10;
  ulonglong uVar11;
  longlong lVar12;
  ulonglong uVar13;
  longlong lVar14;
  int local_res20;
  
  uVar1 = param_1[1];
  uVar2 = *param_1;
  uVar11 = SEXT48((int)uVar2);
  lVar9 = 0;
  local_res20 = 0;
  if (0 < (int)uVar1) {
    uVar13 = uVar11;
    do {
      if (lVar9 == 0) {
        lVar6 = 0;
      }
      else {
        lVar6 = lVar9 + -1;
      }
      lVar7 = *(longlong *)(param_1 + 2);
      lVar3 = *(longlong *)(lVar7 + lVar6 * 8);
      lVar4 = *(longlong *)(lVar7 + lVar9 * 8);
      lVar6 = (longlong)(int)uVar1 + -1;
      if (local_res20 != uVar1 - 1) {
        lVar6 = lVar9 + 1;
      }
      lVar6 = *(longlong *)(lVar7 + lVar6 * 8);
      iVar10 = 0;
      lVar7 = 0;
      if (0 < (longlong)uVar11) {
        do {
          if (lVar7 == 0) {
            lVar14 = 0;
          }
          else {
            lVar14 = lVar7 + -1;
          }
          lVar12 = uVar11 - 1;
          if (iVar10 != (int)uVar13 + -1) {
            lVar12 = lVar7 + 1;
          }
          if (param_2 != 0) {
            iVar8 = (((*(int *)(lVar4 + lVar12 * 4) - *(int *)(lVar4 + lVar14 * 4)) * 2 -
                     *(int *)(lVar6 + lVar14 * 4)) - *(int *)(lVar3 + lVar14 * 4)) +
                    *(int *)(lVar6 + lVar12 * 4) + *(int *)(lVar3 + lVar12 * 4);
            iVar5 = -4;
            if (0 < iVar8) {
              iVar5 = 4;
            }
            iVar5 = iVar5 + iVar8;
            *(int *)(*(longlong *)(*(longlong *)(param_2 + 8) + lVar9 * 8) + lVar7 * 4) =
                 (int)(iVar5 + (iVar5 >> 0x1f & 7U)) >> 3;
          }
          if (param_3 != 0) {
            iVar8 = (((*(int *)(lVar6 + lVar7 * 4) - *(int *)(lVar3 + lVar7 * 4)) * 2 -
                     *(int *)(lVar3 + lVar14 * 4)) - *(int *)(lVar3 + lVar12 * 4)) +
                    *(int *)(lVar6 + lVar14 * 4) + *(int *)(lVar6 + lVar12 * 4);
            iVar5 = -4;
            if (0 < iVar8) {
              iVar5 = 4;
            }
            iVar5 = iVar5 + iVar8;
            *(int *)(*(longlong *)(*(longlong *)(param_3 + 8) + lVar9 * 8) + lVar7 * 4) =
                 (int)(iVar5 + (iVar5 >> 0x1f & 7U)) >> 3;
          }
          lVar7 = lVar7 + 1;
          iVar10 = iVar10 + 1;
        } while (lVar7 < (longlong)uVar11);
        uVar13 = (ulonglong)uVar2;
      }
      local_res20 = local_res20 + 1;
      lVar9 = lVar9 + 1;
    } while (lVar9 < (int)uVar1);
  }
  return;
}



void * FUN_18000fa20(int param_1,int param_2)

{
  void *pvVar1;
  longlong lVar2;
  longlong lVar3;
  
  pvVar1 = calloc((longlong)(param_1 * param_2 + param_2 * 8),1);
  if (pvVar1 != (void *)0x0) {
    lVar2 = 0;
    lVar3 = (longlong)pvVar1 + (longlong)(param_2 * 8);
    if (0 < param_2) {
      do {
        *(longlong *)((longlong)pvVar1 + lVar2 * 8) = lVar3;
        lVar2 = lVar2 + 1;
        lVar3 = lVar3 + param_1;
      } while (lVar2 < param_2);
    }
    return pvVar1;
  }
  return (void *)0x0;
}



void FUN_18000fab0(int param_1,int param_2,longlong param_3)

{
  undefined8 *_Memory;
  undefined8 *_Memory_00;
  int *_Memory_01;
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  longlong lVar4;
  longlong lVar5;
  int iVar6;
  size_t _Size;
  int iVar7;
  char *pcVar8;
  int iVar9;
  int *piVar10;
  int iVar11;
  undefined8 *puVar12;
  undefined8 *local_48;
  
  _Size = SEXT48(param_1);
  lVar4 = (longlong)param_2;
  iVar6 = 0;
  _Memory = (undefined8 *)malloc(_Size);
  _Memory_00 = (undefined8 *)malloc(_Size);
  local_48 = (undefined8 *)malloc(_Size);
  _Memory_01 = (int *)calloc(_Size,4);
  iVar11 = -3;
  lVar5 = -1;
  if (-1 < lVar4) {
    do {
      puVar12 = _Memory;
      _Memory = _Memory_00;
      if (-1 < iVar11) {
        lVar1 = 0;
        if (0 < (longlong)_Size) {
          do {
            lVar2 = lVar1 + 1;
            _Memory_01[lVar1] = _Memory_01[lVar1] - (uint)*(byte *)(lVar1 + (longlong)puVar12);
            lVar1 = lVar2;
          } while (lVar2 < (longlong)_Size);
        }
        iVar6 = iVar6 + -1;
      }
      lVar1 = lVar5 + 1;
      if (lVar1 < lVar4) {
        FUN_18001d320(puVar12,*(undefined8 **)(param_3 + 8 + lVar5 * 8),_Size);
        lVar2 = 0;
        if (0 < (longlong)_Size) {
          do {
            lVar3 = lVar2 + 1;
            _Memory_01[lVar2] = _Memory_01[lVar2] + (uint)*(byte *)(lVar2 + (longlong)puVar12);
            lVar2 = lVar3;
          } while (lVar3 < (longlong)_Size);
        }
        iVar6 = iVar6 + 1;
      }
      if (-1 < lVar5) {
        iVar7 = 0;
        iVar9 = 0;
        lVar5 = *(longlong *)(param_3 + lVar5 * 8);
        if (-1 < (longlong)_Size) {
          pcVar8 = (char *)(lVar5 + -1);
          lVar5 = -lVar5;
          piVar10 = _Memory_01;
          do {
            if (-1 < (longlong)(pcVar8 + lVar5 + 1 + -3)) {
              iVar7 = iVar7 - piVar10[-3];
              iVar9 = iVar9 - iVar6;
            }
            if ((longlong)(pcVar8 + lVar5 + 1) < (longlong)_Size) {
              iVar7 = iVar7 + *piVar10;
              iVar9 = iVar9 + iVar6;
            }
            if (-1 < (longlong)(pcVar8 + lVar5)) {
              if (iVar9 == 9) {
                *pcVar8 = ((char)(iVar7 >> 10) - (char)(iVar7 >> 6)) + (char)(iVar7 >> 3);
              }
              else {
                *pcVar8 = (char)(iVar7 / iVar9);
              }
            }
            pcVar8 = pcVar8 + 1;
            piVar10 = piVar10 + 1;
          } while ((longlong)(pcVar8 + lVar5) < (longlong)_Size);
        }
      }
      iVar11 = iVar11 + 1;
      lVar5 = lVar1;
      _Memory_00 = local_48;
      local_48 = puVar12;
    } while (lVar1 < lVar4);
  }
  free(_Memory);
  free(_Memory_00);
  free(local_48);
  free(_Memory_01);
  return;
}



void FUN_18000fca0(int param_1,int param_2,longlong param_3)

{
  longlong lVar1;
  void *_Memory;
  int *_Memory_00;
  void *pvVar2;
  longlong lVar3;
  longlong lVar4;
  size_t _Count;
  int iVar5;
  int iVar6;
  longlong lVar7;
  longlong *plVar8;
  int iVar9;
  int iVar10;
  int *piVar11;
  longlong lVar12;
  
  lVar12 = (longlong)param_2;
  _Count = SEXT48(param_1);
  iVar5 = param_2;
  if (9 < param_2) {
    iVar5 = 9;
  }
  iVar6 = 0;
  _Memory = malloc((longlong)(param_2 * 8));
  _Memory_00 = (int *)calloc(_Count,4);
  lVar7 = 0;
  if (0 < (longlong)iVar5) {
    do {
      pvVar2 = malloc(_Count);
      lVar7 = lVar7 + 1;
      *(void **)((longlong)_Memory + lVar7 * 8 + -8) = pvVar2;
    } while (lVar7 < iVar5);
  }
  if (-4 < lVar12) {
    lVar7 = -4;
    plVar8 = (longlong *)((longlong)_Memory + -0x48);
    do {
      if (-1 < lVar7 + -5) {
        lVar1 = *plVar8;
        lVar3 = 0;
        if (0 < (longlong)_Count) {
          do {
            lVar4 = lVar3 + 1;
            _Memory_00[lVar3] = _Memory_00[lVar3] - (uint)*(byte *)(lVar3 + lVar1);
            lVar3 = lVar4;
          } while (lVar4 < (longlong)_Count);
        }
        iVar6 = iVar6 + -1;
      }
      if (lVar7 + 4 < lVar12) {
        if (-1 < lVar7 + -5) {
          plVar8[9] = *plVar8;
        }
        FUN_18001d320((undefined8 *)plVar8[9],
                      *(undefined8 **)((param_3 - (longlong)_Memory) + 0x48 + (longlong)plVar8),
                      _Count);
        lVar1 = plVar8[9];
        lVar3 = 0;
        if (0 < (longlong)_Count) {
          do {
            lVar4 = lVar3 + 1;
            _Memory_00[lVar3] = _Memory_00[lVar3] + (uint)*(byte *)(lVar3 + lVar1);
            lVar3 = lVar4;
          } while (lVar4 < (longlong)_Count);
        }
        iVar6 = iVar6 + 1;
      }
      if (-1 < lVar7) {
        lVar1 = *(longlong *)((param_3 - (longlong)_Memory) + 0x28 + (longlong)plVar8);
        iVar9 = 0;
        iVar10 = 0;
        if (-4 < (longlong)_Count) {
          lVar3 = 0;
          piVar11 = _Memory_00;
          do {
            if (-1 < lVar3 + -9) {
              iVar9 = iVar9 - piVar11[-9];
              iVar10 = iVar10 - iVar6;
            }
            if (lVar3 < (longlong)_Count) {
              iVar9 = iVar9 + *piVar11;
              iVar10 = iVar10 + iVar6;
            }
            if (-1 < lVar3 + -4) {
              *(char *)(lVar1 + -4 + lVar3) = (char)(iVar9 / iVar10);
            }
            piVar11 = piVar11 + 1;
            lVar4 = lVar3 + -3;
            lVar3 = lVar3 + 1;
          } while (lVar4 < (longlong)_Count);
        }
      }
      lVar7 = lVar7 + 1;
      plVar8 = plVar8 + 1;
    } while (lVar7 < lVar12);
  }
  for (lVar7 = (longlong)(param_2 - iVar5); lVar7 < lVar12; lVar7 = lVar7 + 1) {
    free(*(void **)((longlong)_Memory + lVar7 * 8));
  }
  free(_Memory);
  free(_Memory_00);
  return;
}



void FUN_18000fe70(uint param_1,int param_2,longlong param_3,byte **param_4,undefined8 param_5,
                  undefined8 param_6,longlong param_7)

{
  longlong lVar1;
  byte *pbVar2;
  int *piVar3;
  byte bVar4;
  int *piVar5;
  int *piVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  void *pvVar10;
  int iVar11;
  uint uVar12;
  void *pvVar13;
  longlong lVar14;
  byte *pbVar15;
  uint uVar16;
  uint uVar17;
  ulonglong uVar18;
  undefined (*pauVar19) [16];
  ulonglong uVar20;
  int *_Memory;
  ulonglong uVar21;
  byte bVar22;
  longlong lVar23;
  int iVar24;
  int iVar25;
  int *piVar26;
  byte bVar27;
  size_t _Count;
  size_t sVar28;
  longlong *plVar29;
  ulonglong uVar30;
  undefined auVar31 [16];
  undefined in_XMM2 [16];
  undefined auVar32 [16];
  undefined auStack808 [32];
  int local_308;
  uint local_304;
  int local_300;
  void *local_2f8;
  int local_2f0;
  void *local_2e8;
  undefined (**local_2e0) [16];
  longlong local_2d8;
  longlong local_2c8;
  int local_2c0;
  longlong local_2b8;
  int *local_2b0;
  byte **local_2a8;
  byte **local_2a0;
  longlong local_298;
  longlong local_290;
  longlong local_288;
  longlong local_280;
  ulonglong local_278;
  byte **local_270;
  undefined (**local_268) [16];
  int local_258 [64];
  int local_158 [64];
  ulonglong local_58;
  
  local_58 = DAT_180049180 ^ (ulonglong)auStack808;
  _Count = SEXT48((int)param_1);
  iVar11 = param_2;
  if (0x11 < param_2) {
    iVar11 = 0x11;
  }
  uVar30 = 0;
  local_308 = 0;
  local_2f0 = param_2;
  local_2c8 = param_3;
  local_2c0 = iVar11;
  local_2a0 = param_4;
  local_2e0 = (undefined (**) [16])FUN_18000fa20(param_1,param_2);
  local_304 = 0;
  local_300 = 0;
  local_2e8 = malloc((longlong)(param_2 * 8));
  local_2b0 = (int *)calloc(_Count,4);
  pvVar10 = local_2e8;
  uVar20 = uVar30;
  if (0 < (longlong)iVar11) {
    do {
      pvVar13 = malloc(_Count);
      uVar20 = uVar20 + 1;
      *(void **)((longlong)pvVar10 + uVar20 * 8 + -8) = pvVar13;
    } while ((longlong)uVar20 < (longlong)iVar11);
  }
  _Memory = local_2b0;
  FUN_18001d980((undefined (*) [16])local_258,0,0x100);
  FUN_18001d980((undefined (*) [16])local_158,0,0x100);
  iVar11 = local_2f0;
  local_2d8 = (longlong)local_2f0;
  local_278 = SEXT48((int)(local_2f0 * param_1));
  FUN_18001d980(*local_2e0,0,local_278);
  uVar20 = uVar30;
  if (-8 < local_2d8) {
    local_268 = (undefined (**) [16])((longlong)local_2e0 - param_7);
    local_270 = (byte **)((longlong)local_2a0 - param_7);
    local_2f8 = (void *)((longlong)local_2e8 - param_7);
    local_2c8 = local_2c8 - param_7;
    local_2a8 = local_270 + 8;
    local_288 = local_2c8 + -0x48;
    local_298 = local_2c8 + 0x40;
    local_2b8 = -8;
    plVar29 = (longlong *)(param_7 + -0x40);
    sVar28 = _Count;
    do {
      lVar23 = local_2b8;
      uVar17 = (uint)sVar28;
      if (-1 < local_2b8 + -9) {
        piVar5 = *(int **)(local_288 + (longlong)plVar29);
        piVar6 = *(int **)((longlong)local_2f8 + -0x48 + (longlong)plVar29);
        uVar18 = 0;
        uVar20 = uVar30;
        if (((0 < (int)uVar17) && (7 < uVar17)) && (uVar20 = uVar18, 1 < DAT_180049300)) {
          lVar14 = (longlong)(int)(uVar17 - 1);
          if ((((int *)(lVar14 + (longlong)piVar5) < _Memory) || (_Memory + lVar14 < piVar5)) &&
             (((int *)(lVar14 + (longlong)piVar6) < _Memory || (_Memory + lVar14 < piVar6)))) {
            uVar12 = uVar17 & 0x80000007;
            if ((int)uVar12 < 0) {
              uVar12 = (uVar12 - 1 | 0xfffffff8) + 1;
            }
            uVar20 = uVar30;
            uVar18 = uVar30;
            do {
              iVar24 = (int)uVar18;
              lVar14 = (longlong)iVar24;
              uVar20 = uVar20 + 8;
              piVar26 = _Memory + lVar14;
              iVar11 = piVar26[1];
              iVar8 = piVar26[2];
              iVar9 = piVar26[3];
              auVar32 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)));
              auVar31 = pmovzxbd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)));
              auVar32 = CONCAT412(SUB164(auVar32 >> 0x60,0) - SUB164(auVar31 >> 0x60,0),
                                  CONCAT48(SUB164(auVar32 >> 0x40,0) - SUB164(auVar31 >> 0x40,0),
                                           CONCAT44(SUB164(auVar32 >> 0x20,0) -
                                                    SUB164(auVar31 >> 0x20,0),
                                                    SUB164(auVar32,0) - SUB164(auVar31,0))));
              auVar31 = pabsd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)),auVar32);
              piVar3 = _Memory + lVar14;
              *piVar3 = *piVar26 - SUB164(auVar31,0);
              piVar3[1] = iVar11 - SUB164(auVar31 >> 0x20,0);
              piVar3[2] = iVar8 - SUB164(auVar31 >> 0x40,0);
              piVar3[3] = iVar9 - SUB164(auVar31 >> 0x60,0);
              uVar18 = (ulonglong)(iVar24 + 8U);
              lVar14 = (longlong)(iVar24 + 4);
              piVar26 = _Memory + lVar14;
              iVar11 = piVar26[1];
              iVar8 = piVar26[2];
              iVar9 = piVar26[3];
              auVar32 = pmovzxbd(auVar32,ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)));
              auVar31 = pmovzxbd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)));
              in_XMM2 = CONCAT412(SUB164(auVar32 >> 0x60,0) - SUB164(auVar31 >> 0x60,0),
                                  CONCAT48(SUB164(auVar32 >> 0x40,0) - SUB164(auVar31 >> 0x40,0),
                                           CONCAT44(SUB164(auVar32 >> 0x20,0) -
                                                    SUB164(auVar31 >> 0x20,0),
                                                    SUB164(auVar32,0) - SUB164(auVar31,0))));
              auVar31 = pabsd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)),in_XMM2);
              piVar3 = _Memory + lVar14;
              *piVar3 = *piVar26 - SUB164(auVar31,0);
              piVar3[1] = iVar11 - SUB164(auVar31 >> 0x20,0);
              piVar3[2] = iVar8 - SUB164(auVar31 >> 0x40,0);
              piVar3[3] = iVar9 - SUB164(auVar31 >> 0x60,0);
            } while ((int)(iVar24 + 8U) < (int)(uVar17 - uVar12));
          }
        }
        if ((longlong)uVar20 < (longlong)_Count) {
          pbVar15 = (byte *)(uVar20 + (longlong)piVar5);
          lVar14 = _Count - uVar20;
          piVar26 = _Memory + uVar20;
          do {
            pbVar2 = (byte *)((longlong)((longlong)piVar6 - (longlong)piVar5) + (longlong)pbVar15);
            bVar22 = *pbVar15;
            pbVar15 = pbVar15 + 1;
            uVar12 = (uint)*pbVar2 - (uint)bVar22;
            uVar16 = (int)uVar12 >> 0x1f;
            *piVar26 = *piVar26 - ((uVar12 ^ uVar16) - uVar16);
            lVar14 = lVar14 + -1;
            piVar26 = piVar26 + 1;
          } while (lVar14 != 0);
        }
        local_308 = local_308 + -1;
      }
      iVar11 = local_308;
      if (local_2b8 + 8 < local_2d8) {
        if (-1 < local_2b8 + -9) {
          *(undefined8 *)((longlong)local_2f8 + 0x40 + (longlong)plVar29) =
               *(undefined8 *)((longlong)local_2f8 + -0x48 + (longlong)plVar29);
        }
        FUN_18001d320(*(undefined8 **)((longlong)local_2f8 + 0x40 + (longlong)plVar29),
                      *(undefined8 **)((longlong)local_2a8 + (longlong)plVar29),_Count);
        piVar5 = *(int **)(local_298 + (longlong)plVar29);
        piVar6 = *(int **)((longlong)local_2f8 + 0x40 + (longlong)plVar29);
        uVar18 = 0;
        uVar20 = uVar30;
        if (((0 < (int)uVar17) && (7 < uVar17)) && (uVar20 = uVar18, 1 < DAT_180049300)) {
          lVar14 = (longlong)(int)(uVar17 - 1);
          if ((((int *)(lVar14 + (longlong)piVar5) < _Memory) || (_Memory + lVar14 < piVar5)) &&
             (((int *)(lVar14 + (longlong)piVar6) < _Memory || (_Memory + lVar14 < piVar6)))) {
            uVar12 = uVar17 & 0x80000007;
            if ((int)uVar12 < 0) {
              uVar12 = (uVar12 - 1 | 0xfffffff8) + 1;
            }
            uVar20 = uVar30;
            uVar18 = uVar30;
            do {
              iVar25 = (int)uVar18;
              lVar14 = (longlong)iVar25;
              uVar20 = uVar20 + 8;
              auVar32 = pmovzxbd(in_XMM2,ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)));
              auVar31 = pmovzxbd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)));
              auVar32 = CONCAT412(SUB164(auVar32 >> 0x60,0) - SUB164(auVar31 >> 0x60,0),
                                  CONCAT48(SUB164(auVar32 >> 0x40,0) - SUB164(auVar31 >> 0x40,0),
                                           CONCAT44(SUB164(auVar32 >> 0x20,0) -
                                                    SUB164(auVar31 >> 0x20,0),
                                                    SUB164(auVar32,0) - SUB164(auVar31,0))));
              auVar31 = pabsd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)),auVar32);
              piVar26 = _Memory + lVar14;
              iVar8 = piVar26[1];
              iVar9 = piVar26[2];
              iVar24 = piVar26[3];
              piVar3 = _Memory + lVar14;
              *piVar3 = SUB164(auVar31,0) + *piVar26;
              piVar3[1] = SUB164(auVar31 >> 0x20,0) + iVar8;
              piVar3[2] = SUB164(auVar31 >> 0x40,0) + iVar9;
              piVar3[3] = SUB164(auVar31 >> 0x60,0) + iVar24;
              uVar18 = (ulonglong)(iVar25 + 8U);
              lVar14 = (longlong)(iVar25 + 4);
              auVar32 = pmovzxbd(auVar32,ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)));
              auVar31 = pmovzxbd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar6)),
                                 ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)));
              in_XMM2 = CONCAT412(SUB164(auVar32 >> 0x60,0) - SUB164(auVar31 >> 0x60,0),
                                  CONCAT48(SUB164(auVar32 >> 0x40,0) - SUB164(auVar31 >> 0x40,0),
                                           CONCAT44(SUB164(auVar32 >> 0x20,0) -
                                                    SUB164(auVar31 >> 0x20,0),
                                                    SUB164(auVar32,0) - SUB164(auVar31,0))));
              auVar31 = pabsd(ZEXT416(*(uint *)(lVar14 + (longlong)piVar5)),in_XMM2);
              piVar26 = _Memory + lVar14;
              iVar8 = piVar26[1];
              iVar9 = piVar26[2];
              iVar24 = piVar26[3];
              piVar3 = _Memory + lVar14;
              *piVar3 = SUB164(auVar31,0) + *piVar26;
              piVar3[1] = SUB164(auVar31 >> 0x20,0) + iVar8;
              piVar3[2] = SUB164(auVar31 >> 0x40,0) + iVar9;
              piVar3[3] = SUB164(auVar31 >> 0x60,0) + iVar24;
            } while ((int)(iVar25 + 8U) < (int)(uVar17 - uVar12));
          }
        }
        if ((longlong)uVar20 < (longlong)_Count) {
          pbVar15 = (byte *)(uVar20 + (longlong)piVar5);
          lVar14 = _Count - uVar20;
          piVar26 = _Memory + uVar20;
          do {
            pbVar2 = pbVar15 + (longlong)((longlong)piVar6 - (longlong)piVar5);
            bVar22 = *pbVar15;
            pbVar15 = pbVar15 + 1;
            uVar17 = (int)((uint)*pbVar2 - (uint)bVar22) >> 0x1f;
            *piVar26 = *piVar26 + (((uint)*pbVar2 - (uint)bVar22 ^ uVar17) - uVar17);
            lVar14 = lVar14 + -1;
            piVar26 = piVar26 + 1;
          } while (lVar14 != 0);
        }
        local_308 = iVar11 + 1;
      }
      if (-1 < lVar23) {
        lVar23 = local_2b8;
        if (-8 < (longlong)_Count) {
          local_290 = *(longlong *)((longlong)local_2f8 + (longlong)plVar29) + -8;
          local_280 = *(longlong *)(local_2c8 + (longlong)plVar29) + -8;
          lVar14 = *(longlong *)((longlong)local_270 + (longlong)plVar29) + -8;
          uVar20 = uVar30;
          uVar18 = uVar30;
          uVar21 = uVar30;
          do {
            if (-1 < (longlong)(uVar20 - 0x11)) {
              uVar18 = (ulonglong)(uint)((int)uVar18 - _Memory[-0x11]);
              uVar21 = (ulonglong)(uint)((int)uVar21 - local_308);
            }
            if ((longlong)uVar20 < (longlong)_Count) {
              uVar18 = (ulonglong)(uint)((int)uVar18 + *_Memory);
              uVar21 = (ulonglong)(uint)((int)uVar21 + local_308);
            }
            lVar1 = uVar20 - 8;
            if (-1 < lVar1) {
              bVar22 = *(byte *)(local_290 + uVar20);
              lVar7 = (longlong)(int)uVar18 / (longlong)(int)uVar21;
              bVar4 = (byte)lVar7;
              if (bVar22 < bVar4) {
                uVar17 = 0;
              }
              else {
                uVar17 = (uint)(byte)(bVar22 - bVar4);
              }
              if ((int)(0xff - ((uint)lVar7 & 0xff)) < (int)(uint)bVar22) {
                bVar22 = 0xff;
              }
              else {
                bVar22 = bVar22 + bVar4;
              }
              bVar4 = *(byte *)(local_280 + uVar20);
              bVar27 = bVar22 - (byte)uVar17;
              if (bVar27 < 4) {
                *(byte *)(lVar14 + uVar20) = bVar4;
                *(undefined *)(lVar1 + *(longlong *)((longlong)local_268 + (longlong)plVar29)) =
                     0xff;
                local_304 = local_304 + bVar4;
                local_300 = local_300 + 1;
              }
              else {
                if ((byte)uVar17 < bVar4) {
                  if (bVar4 < bVar22) {
                    bVar22 = (byte)((int)((bVar4 - uVar17) * 0xff) / (int)(uint)bVar27);
                  }
                  else {
                    bVar22 = 0xff;
                  }
                }
                else {
                  bVar22 = 0;
                }
                *(byte *)(lVar14 + uVar20) = bVar22;
                local_258[bVar4 >> 2] = local_258[bVar4 >> 2] + (uint)bVar22;
                local_158[bVar4 >> 2] = local_158[bVar4 >> 2] + 1;
              }
              *(byte *)(lVar1 + *plVar29) = bVar27;
            }
            _Memory = _Memory + 1;
            lVar1 = uVar20 - 7;
            uVar20 = uVar20 + 1;
          } while (lVar1 < (longlong)_Count);
          sVar28 = (size_t)param_1;
          _Memory = local_2b0;
        }
      }
      local_2b8 = lVar23 + 1;
      plVar29 = plVar29 + 1;
    } while (local_2b8 < local_2d8);
    uVar20 = (ulonglong)local_304;
    iVar11 = local_2f0;
  }
  lVar23 = local_2d8;
  pvVar10 = local_2e8;
  lVar14 = (longlong)(iVar11 - local_2c0);
  if (lVar14 < local_2d8) {
    do {
      free(*(void **)((longlong)pvVar10 + lVar14 * 8));
      lVar14 = lVar14 + 1;
    } while (lVar14 < lVar23);
    uVar20 = (ulonglong)local_304;
  }
  free(local_2e8);
  free(_Memory);
  lVar23 = 0x40;
  do {
    if (1 < *(int *)((longlong)local_158 + uVar30)) {
      *(int *)((longlong)local_258 + uVar30) =
           *(int *)((longlong)local_258 + uVar30) / *(int *)((longlong)local_158 + uVar30);
    }
    uVar30 = uVar30 + 4;
    lVar23 = lVar23 + -1;
  } while (lVar23 != 0);
  if (1 < local_300) {
    uVar20 = (longlong)(int)uVar20 / (longlong)local_300 & 0xffffffff;
  }
  pbVar15 = *local_2a0;
  if (0 < (longlong)local_278) {
    pauVar19 = (undefined (*) [16])((longlong)*local_2e0 - (longlong)pbVar15);
    uVar30 = local_278;
    do {
      if (pbVar15[(longlong)*pauVar19] == 0xff) {
        if (local_158[*pbVar15 >> 2] < 1) {
          *pbVar15 = (byte)uVar20;
        }
        else {
          *pbVar15 = *(byte *)(local_258 + (*pbVar15 >> 2));
        }
      }
      pbVar15 = pbVar15 + 1;
      uVar30 = uVar30 - 1;
    } while (uVar30 != 0);
  }
  free(local_2e0);
  FUN_18001d2f0(local_58 ^ (ulonglong)auStack808);
  return;
}



uint FUN_1800105d0(uint param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  if (param_1 == 0) {
    uVar2 = 0x1e;
    if (0 < (int)param_2) {
      uVar2 = 0x5a;
    }
    return uVar2;
  }
  iVar3 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  iVar1 = (param_2 ^ (int)param_2 >> 0x1f) - ((int)param_2 >> 0x1f);
  if (iVar3 < iVar1) {
    uVar2 = 0x1e0 - (byte)(&DAT_18003b1b0)[(iVar1 / 2 + iVar3 * 0x80) / iVar1];
  }
  else {
    uVar2 = (uint)(byte)(&DAT_18003b1b0)[(iVar3 / 2 + iVar1 * 0x80) / iVar3];
  }
  uVar2 = (int)(uVar2 + 8 + ((int)(uVar2 + 8) >> 0x1f & 0xfU)) >> 4;
  if ((int)param_1 < 0) {
    if (-1 < (int)param_2) {
      if ((char)uVar2 == '\0') {
        return uVar2;
      }
      return 0x78 - (uVar2 & 0xff);
    }
  }
  else {
    if ((int)param_2 < 0) {
      return 0x3c - (uVar2 & 0xff);
    }
    uVar2 = (uVar2 & 0xff) + 0x3c;
  }
  return uVar2;
}



// WARNING: Removing unreachable block (ram,0x000180010ed3)
// WARNING: Removing unreachable block (ram,0x000180010ef8)

void FUN_180010690(int param_1,int param_2,longlong param_3,uint param_4,uint param_5,
                  longlong param_6,longlong param_7)

{
  int **ppiVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  uint uVar6;
  int **_Memory;
  int **_Memory_00;
  int **_Memory_01;
  int *_Memory_02;
  int *_Memory_03;
  int *_Memory_04;
  int **ppiVar7;
  void *pvVar8;
  int *piVar9;
  byte *pbVar10;
  int iVar11;
  longlong lVar12;
  int *piVar13;
  int **ppiVar14;
  int *piVar15;
  undefined uVar16;
  int iVar17;
  size_t _Count;
  longlong lVar18;
  int iVar19;
  int iVar20;
  longlong lVar21;
  size_t sVar22;
  int iVar23;
  longlong lVar24;
  longlong lVar25;
  int *piVar26;
  int *piVar27;
  int iVar28;
  int iVar29;
  longlong lVar30;
  int **ppiVar31;
  int iVar32;
  int iVar33;
  longlong *plVar34;
  int iStack0000000000000040;
  int local_f8;
  longlong local_d8;
  int local_c8;
  longlong *local_b8;
  
  _Count = SEXT48((int)param_4);
  local_f8 = 0x10;
  _Memory = (int **)malloc(0x18);
  _Memory_00 = (int **)malloc(0x18);
  _Memory_01 = (int **)malloc(0x18);
  _Memory_02 = (int *)calloc(_Count,4);
  _Memory_03 = (int *)calloc(_Count,4);
  _Memory_04 = (int *)calloc(_Count,4);
  lVar21 = 3;
  sVar22 = SEXT48((int)(param_4 * 4));
  ppiVar31 = (int **)((longlong)_Memory - (longlong)_Memory_00);
  ppiVar7 = (int **)((longlong)_Memory_01 - (longlong)_Memory_00);
  ppiVar14 = _Memory_00;
  do {
    pvVar8 = malloc(sVar22);
    *(void **)((longlong)ppiVar31 + (longlong)ppiVar14) = pvVar8;
    piVar9 = (int *)malloc(sVar22);
    *ppiVar14 = piVar9;
    pvVar8 = malloc(sVar22);
    ppiVar14 = ppiVar14 + 1;
    *(void **)((longlong)((longlong)ppiVar7 + -8) + (longlong)ppiVar14) = pvVar8;
    lVar21 = lVar21 + -1;
  } while (lVar21 != 0);
  iStack0000000000000040 = 0;
  local_d8 = -1;
  if (param_5 < 0x80000000) {
    local_b8 = (longlong *)(param_7 + -8);
    iVar23 = 0;
    do {
      piVar9 = _Memory_00[2];
      piVar15 = _Memory[2];
      if (iVar23 == 0) {
        iVar23 = 1;
      }
      piVar26 = _Memory_01[2];
      iVar32 = local_f8;
      if (local_f8 == param_2) {
        iVar32 = param_2 + -1;
      }
      if (-1 < iStack0000000000000040 + -3) {
        lVar25 = 0;
        lVar24 = 0;
        lVar21 = lVar24;
        if ((0 < (int)param_4) && (3 < param_4)) {
          iVar17 = 0;
          lVar12 = (longlong)(int)(param_4 - 1);
          piVar13 = _Memory_04 + lVar12;
          piVar27 = _Memory_03 + lVar12;
          if (((((piVar27 < _Memory_04) || (piVar13 < _Memory_03)) &&
               ((piVar2 = _Memory_02 + lVar12, lVar21 = lVar25, piVar2 < _Memory_04 ||
                (piVar13 < _Memory_02)))) &&
              (((((piVar3 = piVar26 + lVar12, piVar3 < _Memory_04 || (piVar13 < piVar26)) &&
                 ((((piVar4 = piVar9 + lVar12, piVar4 < _Memory_04 || (piVar13 < piVar9)) &&
                   ((piVar5 = piVar15 + lVar12, piVar5 < _Memory_04 ||
                    (lVar21 = lVar24, piVar13 < piVar15)))) &&
                  ((piVar2 < _Memory_03 || (lVar21 = lVar24, piVar27 < _Memory_02)))))) &&
                ((piVar3 < _Memory_03 || (lVar21 = lVar24, piVar27 < piVar26)))) &&
               ((((piVar4 < _Memory_03 || (lVar21 = lVar24, piVar27 < piVar9)) &&
                 ((piVar5 < _Memory_03 || (lVar21 = lVar24, piVar27 < piVar15)))) &&
                (((piVar3 < _Memory_02 || (lVar21 = lVar24, piVar2 < piVar26)) &&
                 ((piVar4 < _Memory_02 || (lVar21 = lVar24, piVar2 < piVar9)))))))))) &&
             ((piVar5 < _Memory_02 || (lVar21 = lVar24, piVar2 < piVar15)))) {
            uVar6 = param_4 & 0x80000003;
            if ((int)uVar6 < 0) {
              uVar6 = (uVar6 - 1 | 0xfffffffc) + 1;
            }
            do {
              lVar21 = (longlong)iVar17;
              iVar17 = iVar17 + 4;
              lVar25 = lVar25 + 4;
              piVar13 = piVar15 + lVar21;
              iVar19 = piVar13[1];
              iVar20 = piVar13[2];
              iVar33 = piVar13[3];
              piVar27 = _Memory_02 + lVar21;
              iVar28 = piVar27[1];
              iVar11 = piVar27[2];
              iVar29 = piVar27[3];
              piVar2 = _Memory_02 + lVar21;
              *piVar2 = *piVar27 - *piVar13;
              piVar2[1] = iVar28 - iVar19;
              piVar2[2] = iVar11 - iVar20;
              piVar2[3] = iVar29 - iVar33;
              piVar13 = piVar9 + lVar21;
              iVar19 = piVar13[1];
              iVar20 = piVar13[2];
              iVar33 = piVar13[3];
              piVar27 = _Memory_03 + lVar21;
              iVar28 = piVar27[1];
              iVar11 = piVar27[2];
              iVar29 = piVar27[3];
              piVar2 = _Memory_03 + lVar21;
              *piVar2 = *piVar27 - *piVar13;
              piVar2[1] = iVar28 - iVar19;
              piVar2[2] = iVar11 - iVar20;
              piVar2[3] = iVar29 - iVar33;
              piVar13 = _Memory_04 + lVar21;
              iVar19 = piVar13[1];
              iVar20 = piVar13[2];
              iVar33 = piVar13[3];
              piVar27 = piVar26 + lVar21;
              iVar28 = piVar27[1];
              iVar11 = piVar27[2];
              iVar29 = piVar27[3];
              piVar2 = _Memory_04 + lVar21;
              *piVar2 = *piVar13 - *piVar27;
              piVar2[1] = iVar19 - iVar28;
              piVar2[2] = iVar20 - iVar11;
              piVar2[3] = iVar33 - iVar29;
              lVar21 = lVar25;
            } while (iVar17 < (int)(param_4 - uVar6));
          }
        }
        if (lVar21 < (longlong)_Count) {
          lVar24 = _Count - lVar21;
          piVar13 = _Memory_02 + lVar21;
          do {
            piVar27 = piVar13 + 1;
            *piVar13 = *piVar13 -
                       *(int *)((longlong)((longlong)piVar15 - (longlong)_Memory_02) +
                               (longlong)piVar13);
            piVar13 = (int *)((longlong)_Memory_03 + (-4 - (longlong)_Memory_02) + (longlong)piVar27
                             );
            *piVar13 = *piVar13 -
                       *(int *)((longlong)piVar9 + (-4 - (longlong)_Memory_02) + (longlong)piVar27);
            piVar13 = (int *)((longlong)_Memory_04 + (-4 - (longlong)_Memory_02) + (longlong)piVar27
                             );
            *piVar13 = *piVar13 -
                       *(int *)((longlong)piVar26 + (-4 - (longlong)_Memory_02) + (longlong)piVar27)
            ;
            lVar24 = lVar24 + -1;
            piVar13 = piVar27;
          } while (lVar24 != 0);
        }
      }
      lVar21 = 2;
      ppiVar14 = _Memory_00 + 1;
      do {
        lVar21 = lVar21 + -1;
        ppiVar1 = ppiVar14 + -1;
        *(undefined8 *)((longlong)((longlong)ppiVar31 + 0x10) + (longlong)ppiVar1) =
             *(undefined8 *)((longlong)ppiVar14 + (longlong)ppiVar31);
        ppiVar14[1] = *ppiVar14;
        *(undefined8 *)((longlong)((longlong)ppiVar7 + 0x10) + (longlong)ppiVar1) =
             *(undefined8 *)((longlong)ppiVar14 + (longlong)ppiVar7);
        ppiVar14 = ppiVar1;
      } while (0 < lVar21);
      *_Memory = piVar15;
      *_Memory_00 = piVar9;
      *_Memory_01 = piVar26;
      if (iStack0000000000000040 < (int)param_5) {
        local_c8 = 0x10;
        if (0 < (longlong)_Count) {
          lVar21 = (longlong)iVar23;
          piVar9 = _Memory_03;
          sVar22 = _Count;
          iVar23 = 0;
          do {
            if (iVar23 == 0) {
              iVar23 = 1;
            }
            iVar20 = 0;
            iVar19 = 0;
            iVar33 = 0;
            iVar17 = local_c8;
            if (local_c8 == param_1) {
              iVar17 = param_1 + -1;
            }
            if (lVar21 < iVar32) {
              lVar24 = (longlong)iVar23;
              lVar25 = iVar32 - lVar21;
              plVar34 = (longlong *)(param_3 + 8 + lVar21 * 8);
              do {
                lVar12 = plVar34[-2];
                if (lVar24 < iVar17) {
                  lVar18 = *plVar34 - lVar12;
                  lVar30 = iVar17 - lVar24;
                  pbVar10 = (byte *)(lVar12 + 1 + lVar24);
                  do {
                    iVar23 = ((uint)pbVar10[lVar18] - (uint)pbVar10[-2]) +
                             ((uint)pbVar10[plVar34[-1] - lVar12] -
                             (uint)pbVar10[(plVar34[-1] - lVar12) + -2]) * 4 +
                             ((uint)*pbVar10 - (uint)pbVar10[lVar18 + -2]);
                    iVar28 = ((uint)pbVar10[lVar18] - (uint)pbVar10[-2]) +
                             (((uint)(pbVar10 + 1)[lVar18 + -2] - (uint)pbVar10[-1]) * 4 -
                             ((uint)*pbVar10 - (uint)pbVar10[lVar18 + -2]));
                    iVar20 = iVar20 + iVar23 * iVar23;
                    iVar33 = iVar33 + iVar28 * iVar23;
                    iVar19 = iVar19 + iVar28 * iVar28;
                    lVar30 = lVar30 + -1;
                    pbVar10 = pbVar10 + 1;
                  } while (lVar30 != 0);
                }
                plVar34 = plVar34 + 1;
                lVar25 = lVar25 + -1;
              } while (lVar25 != 0);
            }
            piVar15 = (int *)((longlong)piVar9 - (longlong)_Memory_03);
            piVar26 = piVar9 + 1;
            *(int *)((longlong)piVar15 + (longlong)*_Memory) = iVar20;
            *(int *)((longlong)piVar15 + (longlong)*_Memory_00) = iVar19;
            *(int *)((longlong)piVar15 + (longlong)*_Memory_01) = iVar33;
            piVar15 = (int *)((longlong)_Memory_02 + (-4 - (longlong)_Memory_03) + (longlong)piVar26
                             );
            *piVar15 = *piVar15 + iVar20;
            *piVar9 = *piVar9 + iVar19;
            piVar9 = (int *)((longlong)_Memory_04 + (-4 - (longlong)_Memory_03) + (longlong)piVar26)
            ;
            *piVar9 = *piVar9 + iVar33;
            sVar22 = sVar22 - 1;
            piVar9 = piVar26;
            iVar23 = local_c8;
            local_c8 = local_c8 + 0x10;
          } while (sVar22 != 0);
        }
      }
      if (-1 < local_d8) {
        iVar23 = 0;
        iVar17 = 0;
        iVar32 = 0;
        if (-1 < (longlong)_Count) {
          piVar9 = _Memory_03 + -3;
          lVar21 = -1;
          do {
            if (-1 < lVar21 + -2) {
              iVar23 = iVar23 - *(int *)((longlong)
                                         (int *)((longlong)_Memory_02 - (longlong)_Memory_03) +
                                        (longlong)piVar9);
              iVar17 = iVar17 - *piVar9;
              iVar32 = iVar32 - *(int *)((longlong)
                                         (int *)((longlong)_Memory_04 - (longlong)_Memory_03) +
                                        (longlong)piVar9);
            }
            lVar24 = lVar21 + 1;
            if (lVar24 < (longlong)_Count) {
              iVar23 = iVar23 + *(int *)((longlong)
                                         ((longlong)
                                          (int *)((longlong)_Memory_02 - (longlong)_Memory_03) + 0xc
                                         ) + (longlong)piVar9);
              iVar17 = iVar17 + piVar9[3];
              iVar32 = iVar32 + *(int *)((longlong)
                                         ((longlong)
                                          (int *)((longlong)_Memory_04 - (longlong)_Memory_03) + 0xc
                                         ) + (longlong)piVar9);
            }
            if (-1 < lVar21) {
              iVar33 = (iVar23 + 0x480) / 0x900;
              iVar28 = (iVar17 + 0x480) / 0x900;
              iVar19 = (iVar32 + 0x480) / 0x900;
              uVar6 = FUN_1800105d0(iVar33 - iVar28,iVar19 * 2);
              *(char *)(lVar21 + *(longlong *)((param_6 - param_7) + (longlong)local_b8)) =
                   (char)uVar6;
              iVar28 = iVar28 / 0x24;
              iVar20 = iVar33 / 0x24 >> 2;
              iVar11 = iVar28 >> 2;
              iVar29 = iVar20 - iVar11;
              iVar11 = iVar11 + iVar20;
              iVar20 = (iVar19 / 0x24 >> 2) * 2;
              iVar19 = (iVar11 * iVar11) / 0xfe01;
              if ((iVar28 + iVar33 / 0x24 < 0x9c4) || (iVar19 == 0)) {
                iVar19 = 0;
LAB_180010eb7:
                uVar6 = (uint)(byte)(&DAT_18003aa30)[iVar19];
LAB_180010eca:
                if (uVar6 + 1 < 0x100) {
                  iVar20 = *(int *)(&DAT_18003abf4 + (longlong)(int)uVar6 * 4);
                }
                else {
                  iVar20 = 0xfe01;
                }
                if (uVar6 < 0x100) {
                  iVar33 = *(int *)(&DAT_18003abf0 + (longlong)(int)uVar6 * 4);
                }
                else {
                  iVar33 = 0xfe01;
                }
                uVar16 = (undefined)uVar6;
                if (iVar20 - iVar19 < iVar19 - iVar33) {
                  uVar16 = (undefined)(uVar6 + 1);
                }
              }
              else {
                iVar19 = (iVar29 * iVar29 + iVar20 * iVar20) / iVar19;
                lVar25 = (longlong)iVar19;
                if (iVar19 < 0xfe01) {
                  if (iVar19 < 0x100) goto LAB_180010eb7;
                  if (iVar19 < 0x400) {
                    uVar6 = (uint)(byte)(&DAT_18003aff0)[lVar25 >> 4];
                  }
                  else {
                    if (iVar19 < 0x1000) {
                      uVar6 = (uint)(byte)(&DAT_18003a9b0)[lVar25 >> 5];
                    }
                    else {
                      if (iVar19 < 0x4000) {
                        uVar6 = (uint)(byte)(&DAT_18003aaf0)[lVar25 >> 6];
                      }
                      else {
                        uVar6 = (uint)(byte)(&DAT_18003afb0)[lVar25 >> 7];
                      }
                    }
                  }
                  goto LAB_180010eca;
                }
                uVar16 = 0xff;
              }
              *(undefined *)(lVar21 + *local_b8) = uVar16;
            }
            piVar9 = piVar9 + 1;
            lVar21 = lVar24;
          } while (lVar24 < (longlong)_Count);
        }
      }
      local_b8 = local_b8 + 1;
      local_d8 = local_d8 + 1;
      iStack0000000000000040 = iStack0000000000000040 + 1;
      iVar23 = local_f8;
      local_f8 = local_f8 + 0x10;
    } while (local_d8 < (int)param_5);
  }
  lVar21 = 3;
  ppiVar14 = _Memory_00;
  do {
    free(*(void **)((longlong)ppiVar14 + (longlong)ppiVar31));
    free(*ppiVar14);
    free(*(void **)((longlong)ppiVar14 + (longlong)ppiVar7));
    ppiVar14 = ppiVar14 + 1;
    lVar21 = lVar21 + -1;
  } while (lVar21 != 0);
  free(_Memory);
  free(_Memory_00);
  free(_Memory_01);
  free(_Memory_02);
  free(_Memory_03);
  free(_Memory_04);
  return;
}



int FUN_180011040(int param_1,int param_2,longlong param_3,longlong param_4,undefined4 param_5)

{
  int iVar1;
  int iVar2;
  longlong lVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  int local_res8;
  
  iVar10 = 0;
  lVar12 = 0;
  local_res8 = 0;
  if (0 < (longlong)param_2) {
    iVar10 = 0;
    do {
      if (lVar12 < 1) {
        lVar11 = 0;
      }
      else {
        lVar11 = lVar12 + -1;
      }
      iVar1 = param_2 + -1;
      if (local_res8 <= param_2 + -2) {
        iVar1 = local_res8 + 1;
      }
      iVar5 = 0;
      lVar4 = 0;
      if (0 < (longlong)param_1) {
        do {
          if (lVar4 < 1) {
            lVar9 = 0;
          }
          else {
            lVar9 = lVar4 + -1;
          }
          iVar2 = param_1 + -1;
          if (iVar5 <= param_1 + -2) {
            iVar2 = iVar5 + 1;
          }
          iVar7 = 0;
          iVar6 = 0;
          for (lVar8 = lVar11; lVar8 <= iVar1; lVar8 = lVar8 + 1) {
            if (lVar9 <= iVar2) {
              iVar6 = iVar6 + 1 + (iVar2 - (int)lVar9);
              lVar3 = lVar9;
              do {
                if (0x50 < *(byte *)(*(longlong *)(param_4 + lVar8 * 8) + lVar3)) {
                  iVar7 = iVar7 + 1;
                }
                lVar3 = lVar3 + 1;
              } while (lVar3 <= iVar2);
            }
          }
          if (iVar7 <= iVar6 / 2) {
            iVar10 = iVar10 + 1;
            *(undefined *)(lVar4 + *(longlong *)(param_3 + lVar12 * 8)) = 0xff;
          }
          lVar4 = lVar4 + 1;
          iVar5 = iVar5 + 1;
        } while (lVar4 < param_1);
      }
      lVar12 = lVar12 + 1;
      local_res8 = local_res8 + 1;
    } while (lVar12 < param_2);
  }
  return iVar10;
}



ulonglong FUN_1800111d0(longlong *param_1,int param_2,int param_3,longlong param_4)

{
  longlong lVar1;
  byte *pbVar2;
  int iVar3;
  longlong *plVar4;
  longlong lVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  int iVar13;
  longlong local_38;
  
  iVar10 = 0;
  iVar13 = 0;
  local_38 = 0;
  lVar12 = (longlong)((int)(param_2 + (param_2 >> 0x1f & 0xfU)) >> 4);
  lVar1 = (longlong)((int)(param_3 + (param_3 >> 0x1f & 0xfU)) >> 4);
  if (0 < lVar1) {
    do {
      lVar5 = 0;
      if (0 < lVar12) {
        lVar6 = 0;
        do {
          if (*(char *)(*(longlong *)(param_4 + local_38 * 8) + lVar5) != -1) {
            lVar7 = 0x10;
            plVar4 = param_1;
            do {
              iVar3 = 0;
              iVar8 = 0;
              iVar9 = 0;
              lVar11 = 4;
              pbVar2 = (byte *)(*plVar4 + 1 + lVar6);
              do {
                iVar10 = iVar10 + (uint)pbVar2[-1];
                iVar9 = iVar9 + (uint)*pbVar2;
                iVar8 = iVar8 + (uint)pbVar2[1];
                iVar3 = iVar3 + (uint)pbVar2[2];
                lVar11 = lVar11 + -1;
                pbVar2 = pbVar2 + 4;
              } while (lVar11 != 0);
              plVar4 = plVar4 + 1;
              iVar10 = iVar10 + iVar3 + iVar8 + iVar9;
              lVar7 = lVar7 + -1;
            } while (lVar7 != 0);
            iVar13 = iVar13 + 1;
          }
          lVar5 = lVar5 + 1;
          lVar6 = lVar6 + 0x10;
        } while (lVar5 < lVar12);
      }
      local_38 = local_38 + 1;
      param_1 = param_1 + 0x10;
    } while (local_38 < lVar1);
  }
  return (longlong)iVar10 / (longlong)iVar13 & 0xffffffff;
}



void FUN_180011310(byte **param_1,int param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  byte *pbVar3;
  longlong lVar4;
  longlong lVar5;
  uint uVar6;
  uint uVar7;
  
  uVar7 = 0;
  uVar6 = 0xff;
  lVar5 = (longlong)(param_2 * param_3);
  pbVar3 = *param_1;
  lVar4 = lVar5;
  if (0 < param_2 * param_3) {
    do {
      uVar1 = (uint)*pbVar3;
      if (uVar7 < *pbVar3) {
        uVar7 = uVar1;
      }
      if (uVar1 < uVar6) {
        uVar6 = uVar1;
      }
      lVar4 = lVar4 + -1;
      pbVar3 = pbVar3 + 1;
    } while (lVar4 != 0);
    if (uVar7 == uVar6) {
      return;
    }
  }
  pbVar3 = *param_1;
  if (0 < lVar5) {
    do {
      iVar2 = (*pbVar3 - uVar6) * (int)(0x3fc00 / (longlong)(int)(uVar7 - uVar6)) + 0x200;
      *pbVar3 = (byte)((int)(iVar2 + (iVar2 >> 0x1f & 0x3ffU)) >> 10);
      lVar5 = lVar5 + -1;
      pbVar3 = pbVar3 + 1;
    } while (lVar5 != 0);
  }
  return;
}



longlong * FUN_180011390(longlong param_1,int param_2,int param_3,uint param_4,uint param_5)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  undefined uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  longlong *plVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  longlong lVar12;
  ulonglong uVar13;
  ulonglong uVar14;
  int iVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  byte *pbVar18;
  longlong lVar19;
  longlong *plVar20;
  
  uVar17 = (ulonglong)param_5;
  plVar8 = (longlong *)FUN_180007180(param_4,param_5);
  iVar2 = (param_3 << 10) / (int)param_5;
  iVar3 = (param_2 << 10) / (int)param_4;
  if (plVar8 == (longlong *)0x0) {
    return (longlong *)0x0;
  }
  if (0 < (int)param_5) {
    iVar9 = iVar2 * -0x200;
    plVar20 = plVar8;
    do {
      uVar14 = (ulonglong)param_4;
      iVar5 = iVar9 + (iVar9 >> 0x1f & 0x3ffU);
      uVar11 = iVar5 >> 0x1f & 0x3ff;
      uVar6 = (iVar5 >> 10) + uVar11;
      iVar5 = (int)uVar6 >> 10;
      uVar16 = (ulonglong)((uVar6 & 0x3ff) - uVar11);
      if (iVar5 == param_3 + -1) {
        uVar16 = 0;
      }
      if (0 < (int)param_4) {
        lVar19 = (longlong)iVar5;
        iVar5 = iVar3 * -0x200;
        uVar13 = 0;
        do {
          iVar7 = iVar5 + (iVar5 >> 0x1f & 0x3ffU);
          uVar11 = iVar7 >> 0x1f & 0x3ff;
          uVar6 = (iVar7 >> 10) + uVar11;
          iVar10 = (int)uVar6 >> 10;
          iVar7 = (uVar6 & 0x3ff) - uVar11;
          if (iVar10 == param_2 + -1) {
            iVar7 = 0;
          }
          iVar15 = (int)uVar16;
          if (iVar15 < 1) {
            if (iVar7 < 1) {
              uVar4 = *(undefined *)((longlong)iVar10 + *(longlong *)(param_1 + lVar19 * 8));
            }
            else {
LAB_180011525:
              lVar12 = (longlong)iVar10;
              if (iVar15 < 1) {
                lVar1 = *(longlong *)(param_1 + lVar19 * 8);
                iVar7 = ((uint)*(byte *)(lVar12 + lVar1) * (0x400 - iVar7) + 0x200 +
                        (uint)*(byte *)(lVar12 + 1 + lVar1) * iVar7) * 0x400;
                iVar7 = iVar7 + (iVar7 >> 0x1f & 0xfffffU);
              }
              else {
                lVar1 = *(longlong *)(param_1 + 8 + lVar19 * 8);
                pbVar18 = (byte *)(*(longlong *)(param_1 + lVar19 * 8) + lVar12);
                iVar7 = ((uint)*(byte *)(lVar1 + lVar12) * iVar15 +
                        (uint)*pbVar18 * (0x400 - iVar15)) * (0x400 - iVar7) + 0x80000 +
                        ((uint)*(byte *)(lVar1 + 1 + lVar12) * iVar15 +
                        (uint)pbVar18[1] * (0x400 - iVar15)) * iVar7;
                iVar7 = iVar7 + (iVar7 >> 0x1f & 0xfffffU);
              }
              uVar4 = (undefined)(iVar7 >> 0x14);
            }
          }
          else {
            if (0 < iVar7) goto LAB_180011525;
            iVar7 = ((uint)*(byte *)(*(longlong *)(param_1 + 8 + lVar19 * 8) + (longlong)iVar10) *
                     iVar15 + (uint)*(byte *)((longlong)iVar10 + *(longlong *)(param_1 + lVar19 * 8)
                                             ) * (0x400 - iVar15) + 0x200) * 0x400;
            uVar4 = (undefined)((int)(iVar7 + (iVar7 >> 0x1f & 0xfffffU)) >> 0x14);
          }
          iVar5 = iVar5 + iVar3 * 0x400;
          *(undefined *)(uVar13 + *plVar20) = uVar4;
          uVar14 = uVar14 - 1;
          uVar13 = uVar13 + 1;
        } while (uVar14 != 0);
      }
      plVar20 = plVar20 + 1;
      iVar9 = iVar9 + iVar2 * 0x400;
      uVar17 = uVar17 - 1;
    } while (uVar17 != 0);
  }
  return plVar8;
}



undefined8 FUN_180011650(undefined8 *param_1,int param_2,int param_3)

{
  undefined8 *_Memory;
  
  _Memory = (undefined8 *)FUN_180007180(param_2,param_3);
  FUN_18001d320((undefined8 *)*_Memory,(undefined8 *)*param_1,(longlong)(param_2 * param_3));
  FUN_180007210(param_2,param_3,(longlong)_Memory,5);
  FUN_1800074c0(param_2,param_3,(longlong)param_1,(longlong)_Memory);
  FUN_18001d320((undefined8 *)*param_1,(undefined8 *)*_Memory,(longlong)(param_2 * param_3));
  free(_Memory);
  return 0;
}



ulonglong FUN_1800116f0(longlong param_1,uint param_2,int param_3)

{
  byte *pbVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  longlong lVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  undefined in_XMM1 [16];
  undefined auVar13 [16];
  undefined auVar14 [16];
  undefined auVar15 [16];
  undefined in_XMM4 [16];
  
  iVar12 = 0;
  lVar8 = 0;
  lVar9 = (longlong)(int)param_2;
  if (0 < param_3) {
    do {
      lVar2 = *(longlong *)(param_1 + lVar8 * 8);
      iVar11 = 0;
      iVar10 = 0;
      lVar6 = 0;
      if (1 < lVar9) {
        do {
          pbVar1 = (byte *)(lVar2 + lVar6);
          lVar6 = lVar6 + 2;
          iVar11 = iVar11 + (uint)*pbVar1;
          iVar10 = iVar10 + (uint)*(byte *)(lVar2 + -1 + lVar6);
        } while (lVar6 < lVar9 + -1);
      }
      if (lVar6 < lVar9) {
        iVar12 = iVar12 + (uint)*(byte *)(lVar6 + lVar2);
      }
      lVar8 = lVar8 + 1;
      iVar12 = iVar12 + iVar10 + iVar11;
    } while (lVar8 < param_3);
  }
  iVar10 = 0;
  iVar12 = iVar12 / (int)(param_2 * param_3);
  if (0 < param_3) {
    auVar15 = in_XMM4 & (undefined  [16])0x0;
    lVar8 = 0;
    auVar14 = auVar15;
    do {
      lVar2 = *(longlong *)(param_1 + lVar8 * 8);
      lVar6 = 0;
      if (((0 < (int)param_2) && (7 < param_2)) && (1 < DAT_180049300)) {
        iVar11 = 0;
        uVar3 = param_2 & 0x80000007;
        if ((int)uVar3 < 0) {
          uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
        }
        do {
          lVar7 = (longlong)iVar11;
          lVar6 = lVar6 + 8;
          iVar4 = iVar11 + 4;
          iVar11 = iVar11 + 8;
          auVar13 = pmovzxbd(in_XMM1,ZEXT416(*(uint *)(lVar7 + lVar2)));
          auVar13 = CONCAT412(SUB164(auVar13 >> 0x60,0) - iVar12,
                              CONCAT48(SUB164(auVar13 >> 0x40,0) - iVar12,
                                       CONCAT44(SUB164(auVar13 >> 0x20,0) - iVar12,
                                                SUB164(auVar13,0) - iVar12)));
          auVar13 = pmulld(auVar13,auVar13);
          auVar14 = CONCAT412(SUB164(auVar13 >> 0x60,0) + SUB164(auVar14 >> 0x60,0),
                              CONCAT48(SUB164(auVar13 >> 0x40,0) + SUB164(auVar14 >> 0x40,0),
                                       CONCAT44(SUB164(auVar13 >> 0x20,0) +
                                                SUB164(auVar14 >> 0x20,0),
                                                SUB164(auVar13,0) + SUB164(auVar14,0))));
          auVar13 = pmovzxbd(auVar14,ZEXT416(*(uint *)(iVar4 + lVar2)));
          auVar13 = CONCAT412(SUB164(auVar13 >> 0x60,0) - iVar12,
                              CONCAT48(SUB164(auVar13 >> 0x40,0) - iVar12,
                                       CONCAT44(SUB164(auVar13 >> 0x20,0) - iVar12,
                                                SUB164(auVar13,0) - iVar12)));
          auVar13 = pmulld(auVar13,auVar13);
          in_XMM1 = CONCAT412(SUB164(auVar13 >> 0x60,0) + SUB164(auVar15 >> 0x60,0),
                              CONCAT48(SUB164(auVar13 >> 0x40,0) + SUB164(auVar15 >> 0x40,0),
                                       CONCAT44(SUB164(auVar13 >> 0x20,0) +
                                                SUB164(auVar15 >> 0x20,0),
                                                SUB164(auVar13,0) + SUB164(auVar15,0))));
          auVar15 = in_XMM1;
        } while (iVar11 < (int)(param_2 - uVar3));
      }
      iVar11 = 0;
      iVar4 = 0;
      if (lVar6 < lVar9) {
        if (1 < lVar9 - lVar6) {
          do {
            pbVar1 = (byte *)(lVar2 + lVar6);
            lVar6 = lVar6 + 2;
            iVar5 = (uint)*pbVar1 - iVar12;
            iVar11 = iVar11 + iVar5 * iVar5;
            iVar5 = (uint)*(byte *)(lVar2 + -1 + lVar6) - iVar12;
            iVar4 = iVar4 + iVar5 * iVar5;
          } while (lVar6 < lVar9 + -1);
        }
        if (lVar6 < lVar9) {
          iVar5 = (uint)*(byte *)(lVar6 + lVar2) - iVar12;
          iVar10 = iVar10 + iVar5 * iVar5;
        }
        iVar10 = iVar10 + iVar4 + iVar11;
      }
      lVar8 = lVar8 + 1;
    } while (lVar8 < param_3);
    iVar10 = iVar10 + SUB164(auVar15,0) + SUB164(auVar14,0) +
                      SUB164(auVar15 >> 0x40,0) + SUB164(auVar14 >> 0x40,0) +
                      SUB164(auVar15 >> 0x20,0) + SUB164(auVar14 >> 0x20,0) +
                      SUB164(auVar15 >> 0x60,0) + SUB164(auVar14 >> 0x60,0);
  }
  return (longlong)iVar10 / (longlong)(int)(param_2 * param_3) & 0xffffffff;
}



int FUN_1800118e0(longlong param_1,int param_2,int param_3,undefined *param_4,int param_5)

{
  byte *pbVar1;
  byte *pbVar2;
  longlong lVar3;
  longlong lVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  longlong lVar9;
  longlong lVar10;
  longlong *plVar11;
  longlong lVar12;
  int iVar13;
  longlong lVar14;
  int iVar15;
  int iVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  int iVar20;
  uint uVar21;
  longlong lVar22;
  int iVar23;
  int iVar24;
  int local_res18;
  
  iVar16 = 0;
  lVar22 = (longlong)param_3;
  local_res18 = 0;
  iVar24 = 0;
  iVar23 = 0;
  iVar13 = 0;
  if (lVar22 < param_3 + 0xc) {
    lVar14 = (param_3 + 0xc) - lVar22;
    iVar24 = 0;
    plVar11 = (longlong *)(param_1 + lVar22 * 8);
    do {
      if ((longlong)param_2 < (longlong)(param_2 + 0xc)) {
        lVar22 = *plVar11;
        lVar9 = plVar11[-1];
        lVar10 = plVar11[1];
        lVar12 = (longlong)param_2;
        do {
          pbVar5 = (byte *)(lVar10 + -1 + lVar12);
          pbVar6 = (byte *)(lVar9 + -1 + lVar12);
          pbVar7 = (byte *)(lVar10 + 1 + lVar12);
          pbVar8 = (byte *)(lVar9 + 1 + lVar12);
          lVar3 = lVar12 + 1;
          pbVar1 = (byte *)(lVar10 + lVar12);
          iVar23 = iVar23 + (uint)*(byte *)(lVar12 + lVar22);
          lVar4 = lVar12 + -1;
          pbVar2 = (byte *)(lVar9 + lVar12);
          lVar12 = lVar12 + 1;
          uVar19 = (uint)*pbVar5;
          uVar17 = (uint)*pbVar6;
          uVar18 = (uint)*pbVar8;
          uVar21 = (uint)*pbVar7;
          iVar15 = ((((uint)*(byte *)(lVar3 + lVar22) - (uint)*(byte *)(lVar4 + lVar22)) * 4 -
                    uVar19) - uVar17) + uVar21 + uVar18;
          iVar13 = ((((uint)*pbVar1 - (uint)*pbVar2) * 4 - uVar17) - uVar18) + uVar19 + uVar21;
          iVar16 = iVar16 + iVar15 * iVar15;
          iVar24 = iVar24 + iVar13 * iVar13;
          local_res18 = local_res18 + iVar13 * iVar15;
        } while (lVar12 < param_2 + 0xc);
      }
      lVar14 = lVar14 + -1;
      iVar13 = local_res18;
      plVar11 = plVar11 + 1;
    } while (lVar14 != 0);
  }
  iVar15 = (iVar16 - iVar24 >> 0x1f & 0x7fU) + (iVar16 - iVar24);
  iVar13 = (iVar13 * 2 >> 0x1f & 0x7fU) + iVar13 * 2;
  iVar20 = ((int)((iVar24 >> 0x1f & 0x7fU) + iVar24) >> 7) +
           ((int)(iVar16 + (iVar16 >> 0x1f & 0x7fU)) >> 7);
  iVar13 = (int)((iVar13 >> 0x1f & 7U) + (iVar13 >> 7)) >> 3;
  iVar24 = (int)((iVar15 >> 0x1f & 7U) + (iVar15 >> 7)) >> 3;
  iVar15 = iVar24 * iVar24 + iVar13 * iVar13;
  iVar13 = (int)((iVar20 >> 0x1f & 7U) + iVar20) >> 3;
  iVar13 = (iVar13 * iVar13) / 0xfe01;
  iVar16 = param_5 * 0x42 + 0xa39;
  iVar24 = 0x1324;
  if ((0x1323 < iVar16) && (iVar24 = iVar16, 0x1b90 < iVar16)) {
    iVar24 = 0x1b90;
  }
  if ((iVar13 < 1) || (iVar20 <= iVar24)) {
    *param_4 = 0;
  }
  else {
    if (SBORROW4(iVar15,iVar13 * 0x6400) == iVar15 + iVar13 * -0x6400 < 0) {
      *param_4 = 2;
    }
    else {
      *param_4 = SBORROW4(iVar15,iVar13 * 0x1900) == iVar15 + iVar13 * -0x1900 < 0;
    }
  }
  return iVar23 / 0x90;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180011b40(undefined8 *param_1,uint param_2,int param_3,undefined (**param_4) [16])

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined8 *_Memory;
  ulonglong uVar4;
  longlong lVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  int iVar9;
  undefined8 *puVar10;
  longlong lVar11;
  byte local_88 [4];
  int local_84;
  int local_80;
  uint local_7c;
  int local_78;
  int local_74;
  undefined8 local_70;
  int local_68;
  undefined8 local_60;
  int local_58;
  ulonglong local_50;
  
  local_50 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff48;
  local_60._0_4_ = 0;
  local_60 = 0;
  local_58 = 0;
  local_70 = 0;
  iVar2 = param_3 * param_2;
  local_68 = 0;
  local_84 = 0;
  local_80 = iVar2;
  local_7c = param_2;
  local_78 = param_3;
  local_74 = iVar2;
  _Memory = (undefined8 *)FUN_180007180(param_2,param_3);
  uVar4 = FUN_1800116f0((longlong)param_1,param_2,param_3);
  FUN_18001d320((undefined8 *)*_Memory,(undefined8 *)*param_1,(longlong)iVar2);
  FUN_18001d980(*param_4,0,(longlong)iVar2);
  uVar1 = local_7c;
  iVar2 = 1;
  if (1 < param_3 + -0xc) {
    iVar7 = local_7c - 0xc;
    iVar9 = local_84;
    do {
      iVar6 = 1;
      if (1 < iVar7) {
        iVar9 = iVar9 + (uVar1 - 0xe) / 0xc + 1;
        do {
          iVar3 = FUN_1800118e0((longlong)_Memory,iVar6,iVar2,local_88,(int)uVar4);
          iVar6 = iVar6 + 0xc;
          puVar10 = (undefined8 *)((longlong)&local_60 + (ulonglong)local_88[0] * 4);
          *(int *)puVar10 = *(int *)puVar10 + iVar3;
          puVar10 = (undefined8 *)((longlong)&local_70 + (ulonglong)local_88[0] * 4);
          *(int *)puVar10 = *(int *)puVar10 + 1;
        } while (iVar6 < iVar7);
      }
      iVar2 = iVar2 + 0xc;
    } while (iVar2 < param_3 + -0xc);
    local_84 = iVar9;
    if (0 < local_68) {
      local_60._4_4_ = local_58 / local_68;
      goto LAB_180011c89;
    }
    if (0 < local_70._4_4_) {
      local_60._4_4_ = local_60._4_4_ / local_70._4_4_;
      goto LAB_180011c89;
    }
  }
  local_60._4_4_ = (int)local_60 / (int)local_70;
LAB_180011c89:
  iVar2 = local_78;
  uVar1 = local_7c;
  lVar11 = (longlong)local_78;
  lVar8 = (longlong)(int)local_7c;
  FUN_180007210(local_7c,local_78,(longlong)_Memory,0xc);
  if (0 < iVar2) {
    puVar10 = (undefined8 *)((longlong)_Memory - (longlong)param_4);
    do {
      lVar5 = 0;
      if (0 < (int)uVar1) {
        do {
          if (((0xff - local_60._4_4_) / 2 - (0xff - local_60._4_4_)) + 0xff <=
              (int)(uint)*(byte *)(*(longlong *)((longlong)puVar10 + (longlong)param_4) + lVar5)) {
            (**param_4)[lVar5] = 0xff;
          }
          lVar5 = lVar5 + 1;
        } while (lVar5 < lVar8);
      }
      param_4 = param_4 + 1;
      lVar11 = lVar11 + -1;
    } while (lVar11 != 0);
  }
  free(_Memory);
  FUN_18001d2f0(local_50 ^ (ulonglong)&stack0xffffffffffffff48);
  return;
}



ulonglong FUN_180011d50(longlong *param_1,uint param_2,uint param_3,undefined (**param_4) [16],
                       int param_5,undefined4 param_6,undefined4 param_7)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  int *piVar7;
  byte bVar8;
  int iVar9;
  int iVar10;
  void *_Memory;
  int *_Memory_00;
  int iVar11;
  int iVar12;
  int iVar13;
  byte *pbVar14;
  ulonglong uVar15;
  size_t _Count;
  ulonglong uVar16;
  longlong lVar17;
  ulonglong uVar18;
  int iVar19;
  int iVar20;
  longlong lVar21;
  byte *pbVar22;
  ulonglong uVar23;
  longlong lVar24;
  ulonglong uVar25;
  int iVar26;
  uint uVar27;
  int *piVar28;
  longlong lVar29;
  undefined (**ppauVar30) [16];
  longlong *plVar31;
  
  iVar11 = param_2 * param_3;
  uVar16 = (longlong)(int)param_2 / 6 + ((longlong)(int)param_2 >> 0x3f) & 0xffffffff;
  iVar19 = 0;
  uVar23 = (longlong)(int)param_3 / 6 + ((longlong)(int)param_3 >> 0x3f) & 0xffffffff;
  if (param_4 != (undefined (**) [16])0x0) {
    FUN_18001d980(*param_4,0,(longlong)iVar11);
  }
  _Count = SEXT48(((int)(uVar16 >> 0x1f) + (int)uVar16) * ((int)uVar23 + (int)(uVar23 >> 0x1f)));
  _Memory = calloc(_Count,4);
  _Memory_00 = (int *)malloc(_Count * 4);
  iVar1 = param_3 - 6;
  if (0 < iVar1) {
    lVar21 = 0;
    lVar29 = ((longlong)iVar1 - 1U) / 6 + 1;
    plVar31 = param_1;
    do {
      lVar17 = 0;
      if (0 < (int)(param_2 - 6)) {
        piVar28 = (int *)(lVar21 * 4 + (longlong)_Memory);
        uVar16 = (ulonglong)((param_2 - 7) / 6 + 1);
        lVar21 = lVar21 + uVar16;
        do {
          iVar26 = 0;
          lVar24 = 6;
          pbVar22 = (byte *)(*plVar31 + lVar17);
          pbVar14 = pbVar22;
          do {
            pbVar2 = pbVar14 + 4;
            pbVar3 = pbVar14 + 5;
            pbVar4 = pbVar14 + 3;
            pbVar5 = pbVar14 + 2;
            pbVar6 = pbVar14 + 1;
            bVar8 = *pbVar14;
            pbVar14 = pbVar14 + (int)param_2;
            iVar26 = iVar26 + (uint)bVar8 +
                     (uint)*pbVar3 + (uint)*pbVar2 + (uint)*pbVar4 + (uint)*pbVar5 + (uint)*pbVar6;
            lVar24 = lVar24 + -1;
          } while (lVar24 != 0);
          if (piVar28 != (int *)0x0) {
            iVar12 = 0;
            lVar24 = 6;
            iVar9 = iVar26 / 0x24;
            do {
              bVar8 = *pbVar22;
              pbVar14 = pbVar22 + 1;
              pbVar2 = pbVar22 + 2;
              pbVar3 = pbVar22 + 3;
              pbVar4 = pbVar22 + 4;
              pbVar5 = pbVar22 + 5;
              pbVar22 = pbVar22 + (int)param_2;
              iVar12 = iVar12 + ((uint)bVar8 - iVar9) * ((uint)bVar8 - iVar9) +
                       ((uint)*pbVar14 - iVar9) * ((uint)*pbVar14 - iVar9) +
                       ((uint)*pbVar2 - iVar9) * ((uint)*pbVar2 - iVar9) +
                       ((uint)*pbVar3 - iVar9) * ((uint)*pbVar3 - iVar9) +
                       ((uint)*pbVar4 - iVar9) * ((uint)*pbVar4 - iVar9) +
                       ((uint)*pbVar5 - iVar9) * ((uint)*pbVar5 - iVar9);
              lVar24 = lVar24 + -1;
            } while (lVar24 != 0);
            *piVar28 = iVar12 / 0x24;
          }
          *(int *)((longlong)((longlong)_Memory_00 - (longlong)_Memory) + (longlong)piVar28) =
               iVar26;
          if (*piVar28 != iVar19 && iVar19 <= *piVar28) {
            iVar19 = *piVar28;
          }
          piVar28 = piVar28 + 1;
          lVar17 = lVar17 + 6;
          uVar16 = uVar16 - 1;
        } while (uVar16 != 0);
      }
      plVar31 = plVar31 + 6;
      lVar29 = lVar29 + -1;
    } while (lVar29 != 0);
  }
  iVar26 = 0;
  uVar23 = SEXT48((int)param_2);
  uVar16 = uVar23;
  if (0 < (int)param_3) {
    uVar16 = (ulonglong)param_3;
    do {
      lVar21 = 0;
      if (1 < (longlong)uVar23) {
        do {
          lVar21 = lVar21 + 2;
        } while (lVar21 < (longlong)(uVar23 - 1));
      }
      uVar16 = uVar16 - 1;
    } while (uVar16 != 0);
    uVar16 = (ulonglong)param_2;
  }
  iVar9 = (int)(iVar19 * 0xf + (iVar19 * 0xf >> 0x1f & 0x7fU)) >> 7;
  iVar19 = 0x14;
  if (0x14 < iVar9) {
    iVar19 = iVar9;
  }
  iVar9 = iVar26;
  if (0 < (longlong)_Count) {
    piVar28 = _Memory_00;
    do {
      piVar7 = (int *)((longlong)((longlong)_Memory - (longlong)_Memory_00) + (longlong)piVar28);
      if (*piVar7 != iVar19 && iVar19 <= *piVar7) {
        iVar9 = iVar9 + *piVar28;
        iVar26 = iVar26 + 1;
      }
      piVar28 = piVar28 + 1;
      _Count = _Count - 1;
    } while (_Count != 0);
    if (0 < iVar26) {
      iVar26 = (iVar9 / iVar26) * 9;
      iVar9 = (int)((iVar26 >> 0x1f & 7U) + iVar26) >> 3;
    }
  }
  iVar26 = iVar9 * 0x80 + 0x40;
  param_5 = iVar11;
  if (0 < (int)param_3) {
    uVar18 = 0xfffffffffffffffe;
    iVar9 = -2;
    lVar21 = (longlong)(int)param_3;
    uVar15 = 0;
    ppauVar30 = param_4;
    do {
      uVar25 = uVar15;
      if (0 < (longlong)uVar23) {
        iVar12 = (int)uVar16 + -6;
        iVar20 = -2;
        do {
          iVar10 = iVar20;
          if (iVar20 < 0) {
            iVar10 = (int)uVar25;
          }
          uVar16 = uVar18;
          iVar13 = iVar9;
          if ((longlong)uVar18 < 0) {
            uVar16 = uVar25;
            iVar13 = (int)uVar25;
          }
          if (iVar12 < iVar10) {
            iVar10 = iVar12;
          }
          if (iVar1 < iVar13) {
            uVar16 = (longlong)(int)param_3 - 6;
          }
          uVar25 = uVar25 & 0xffffffff;
          pbVar22 = (byte *)((longlong)iVar10 + param_1[uVar16]);
          lVar29 = 6;
          pbVar14 = pbVar22;
          do {
            pbVar2 = pbVar14 + 4;
            pbVar3 = pbVar14 + 5;
            pbVar4 = pbVar14 + 3;
            pbVar5 = pbVar14 + 2;
            pbVar6 = pbVar14 + 1;
            bVar8 = *pbVar14;
            pbVar14 = pbVar14 + uVar23;
            uVar27 = (int)uVar25 + (uint)bVar8 +
                     (uint)*pbVar3 + (uint)*pbVar2 + (uint)*pbVar4 + (uint)*pbVar5 + (uint)*pbVar6;
            uVar25 = (ulonglong)uVar27;
            lVar29 = lVar29 + -1;
          } while (lVar29 != 0);
          iVar13 = 0;
          uVar25 = 6;
          iVar10 = (int)uVar27 / 0x24;
          do {
            bVar8 = *pbVar22;
            pbVar14 = pbVar22 + 1;
            pbVar2 = pbVar22 + 2;
            pbVar3 = pbVar22 + 3;
            pbVar4 = pbVar22 + 4;
            pbVar5 = pbVar22 + 5;
            pbVar22 = pbVar22 + uVar23;
            iVar13 = iVar13 + ((uint)bVar8 - iVar10) * ((uint)bVar8 - iVar10) +
                     ((uint)*pbVar14 - iVar10) * ((uint)*pbVar14 - iVar10) +
                     ((uint)*pbVar2 - iVar10) * ((uint)*pbVar2 - iVar10) +
                     ((uint)*pbVar3 - iVar10) * ((uint)*pbVar3 - iVar10) +
                     ((uint)*pbVar4 - iVar10) * ((uint)*pbVar4 - iVar10) +
                     ((uint)*pbVar5 - iVar10) * ((uint)*pbVar5 - iVar10);
            uVar25 = uVar25 - 1;
          } while (uVar25 != 0);
          if (((iVar13 / 0x24 < 0xf) ||
              ((int)(iVar26 + (iVar26 >> 0x1f & 0x7fU)) >> 7 <= (int)uVar27 &&
               iVar13 / 0x24 <= iVar19)) &&
             (param_5 = param_5 + -1, param_4 != (undefined (**) [16])0x0)) {
            (**ppauVar30)[uVar15] = 0xff;
          }
          uVar15 = uVar15 + 1;
          iVar20 = iVar20 + 1;
        } while ((longlong)uVar15 < (longlong)uVar23);
      }
      uVar16 = (ulonglong)param_2;
      iVar9 = iVar9 + 1;
      uVar18 = uVar18 + 1;
      ppauVar30 = ppauVar30 + 1;
      lVar21 = lVar21 + -1;
      uVar15 = uVar25;
    } while (lVar21 != 0);
  }
  free(_Memory);
  free(_Memory_00);
  return (longlong)(param_5 << 7) / (longlong)iVar11 & 0xffffffff;
}



void FUN_1800122b0(longlong *param_1,int param_2,uint param_3)

{
  int iVar1;
  undefined8 *_Memory;
  longlong lVar2;
  ulonglong uVar3;
  undefined8 *puVar4;
  
  _Memory = (undefined8 *)FUN_180007180(param_2,param_3);
  FUN_18001d320((undefined8 *)*_Memory,(undefined8 *)*param_1,(longlong)(int)(param_2 * param_3));
  FUN_180007210(param_2,param_3,(longlong)_Memory,3);
  if (0 < (int)param_3) {
    uVar3 = (ulonglong)param_3;
    puVar4 = (undefined8 *)((longlong)_Memory - (longlong)param_1);
    do {
      lVar2 = 0;
      if (0 < (longlong)param_2) {
        do {
          iVar1 = ((uint)*(byte *)(*param_1 + lVar2) -
                  (uint)*(byte *)(lVar2 + *(longlong *)((longlong)puVar4 + (longlong)param_1))) +
                  0x80;
          if (iVar1 < 0) {
            iVar1 = 0;
          }
          else {
            if (0xff < iVar1) {
              iVar1 = 0xff;
            }
          }
          *(char *)(*param_1 + lVar2) = (char)iVar1;
          lVar2 = lVar2 + 1;
        } while (lVar2 < param_2);
      }
      param_1 = param_1 + 1;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  free(_Memory);
  return;
}



void FUN_180012380(char **param_1,int param_2,int param_3)

{
  char *pcVar1;
  longlong lVar2;
  char **ppcVar3;
  int iVar4;
  char *pcVar5;
  ulonglong uVar6;
  longlong lVar7;
  longlong lVar8;
  longlong lVar9;
  longlong lVar10;
  
  pcVar5 = *param_1;
  lVar10 = (longlong)param_3;
  lVar8 = 1;
  iVar4 = param_3 + -1;
  lVar9 = (longlong)param_2;
  if (1 < iVar4) {
    lVar7 = 1;
    uVar6 = (ulonglong)(param_3 - 2);
    do {
      lVar2 = 1;
      if (1 < (longlong)(param_2 + -1)) {
        do {
          if (param_1[lVar7][lVar2] == -1) {
            if (param_1[lVar7 + -1][lVar2 + -1] != -1) {
              param_1[lVar7 + -1][lVar2 + -1] = -0x80;
            }
            if (param_1[lVar7 + -1][lVar2] != -1) {
              param_1[lVar7 + -1][lVar2] = -0x80;
            }
            if (param_1[lVar7 + -1][lVar2 + 1] != -1) {
              param_1[lVar7 + -1][lVar2 + 1] = -0x80;
            }
            if (param_1[lVar7][lVar2 + 1] != -1) {
              param_1[lVar7][lVar2 + 1] = -0x80;
            }
            if (param_1[lVar7 + 1][lVar2 + 1] != -1) {
              param_1[lVar7 + 1][lVar2 + 1] = -0x80;
            }
            if (param_1[lVar7 + 1][lVar2] != -1) {
              param_1[lVar7 + 1][lVar2] = -0x80;
            }
            if (param_1[lVar7 + 1][lVar2 + -1] != -1) {
              param_1[lVar7 + 1][lVar2 + -1] = -0x80;
            }
            if (param_1[lVar7][lVar2 + -1] != -1) {
              param_1[lVar7][lVar2 + -1] = -0x80;
            }
          }
          lVar2 = lVar2 + 1;
        } while (lVar2 < param_2 + -1);
      }
      lVar7 = lVar7 + 1;
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
  }
  lVar7 = 1;
  lVar2 = (longlong)(param_2 + -1);
  if (1 < lVar2) {
    do {
      pcVar1 = *param_1;
      if (pcVar1[lVar7] == -1) {
        if (pcVar1[lVar7 + 1] != -1) {
          pcVar1[lVar7 + 1] = -0x80;
        }
        if (param_1[1][lVar7 + 1] != -1) {
          param_1[1][lVar7 + 1] = -0x80;
        }
        if (param_1[1][lVar7] != -1) {
          param_1[1][lVar7] = -0x80;
        }
        if (param_1[1][lVar7 + -1] != -1) {
          param_1[1][lVar7 + -1] = -0x80;
        }
        if ((*param_1)[lVar7 + -1] != -1) {
          (*param_1)[lVar7 + -1] = -0x80;
        }
      }
      lVar7 = lVar7 + 1;
    } while (lVar7 < lVar2);
    if (1 < lVar2) {
      do {
        if (param_1[lVar10 + -1][lVar8] == -1) {
          if (param_1[lVar10 + -2][lVar8 + -1] != -1) {
            param_1[lVar10 + -2][lVar8 + -1] = -0x80;
          }
          if (param_1[lVar10 + -2][lVar8] != -1) {
            param_1[lVar10 + -2][lVar8] = -0x80;
          }
          if (param_1[lVar10 + -2][lVar8 + 1] != -1) {
            param_1[lVar10 + -2][lVar8 + 1] = -0x80;
          }
          if (param_1[lVar10 + -1][lVar8 + 1] != -1) {
            param_1[lVar10 + -1][lVar8 + 1] = -0x80;
          }
          if (param_1[lVar10 + -1][lVar8 + -1] != -1) {
            param_1[lVar10 + -1][lVar8 + -1] = -0x80;
          }
        }
        lVar8 = lVar8 + 1;
      } while (lVar8 < lVar2);
    }
  }
  if (1 < iVar4) {
    ppcVar3 = param_1 + 2;
    uVar6 = (ulonglong)(param_3 - 2);
    do {
      if (*ppcVar3[-1] == -1) {
        if (*ppcVar3[-2] != -1) {
          *ppcVar3[-2] = -0x80;
        }
        if (ppcVar3[-2][1] != -1) {
          ppcVar3[-2][1] = -0x80;
        }
        if (ppcVar3[-1][1] != -1) {
          ppcVar3[-1][1] = -0x80;
        }
        if ((*ppcVar3)[1] != -1) {
          (*ppcVar3)[1] = -0x80;
        }
        if (**ppcVar3 != -1) {
          **ppcVar3 = -0x80;
        }
      }
      ppcVar3 = ppcVar3 + 1;
      uVar6 = uVar6 - 1;
    } while (uVar6 != 0);
    if (1 < iVar4) {
      ppcVar3 = param_1 + 2;
      uVar6 = (ulonglong)(param_3 - 2);
      do {
        if (ppcVar3[-1][lVar9 + -1] == -1) {
          if (ppcVar3[-2][lVar9 + -2] != -1) {
            ppcVar3[-2][lVar9 + -2] = -0x80;
          }
          if (ppcVar3[-2][lVar9 + -1] != -1) {
            ppcVar3[-2][lVar9 + -1] = -0x80;
          }
          if ((*ppcVar3)[lVar9 + -1] != -1) {
            (*ppcVar3)[lVar9 + -1] = -0x80;
          }
          if ((*ppcVar3)[lVar9 + -2] != -1) {
            (*ppcVar3)[lVar9 + -2] = -0x80;
          }
          if (ppcVar3[-1][lVar9 + -2] != -1) {
            ppcVar3[-1][lVar9 + -2] = -0x80;
          }
        }
        ppcVar3 = ppcVar3 + 1;
        uVar6 = uVar6 - 1;
      } while (uVar6 != 0);
    }
  }
  pcVar1 = *param_1;
  if (*pcVar1 == -1) {
    if (pcVar1[1] != -1) {
      pcVar1[1] = -0x80;
    }
    if (param_1[1][1] != -1) {
      param_1[1][1] = -0x80;
    }
    if (*param_1[1] != -1) {
      *param_1[1] = -0x80;
    }
  }
  if ((*param_1)[lVar9 + -1] == -1) {
    if (param_1[1][lVar9 + -1] != -1) {
      param_1[1][lVar9 + -1] = -0x80;
    }
    if (param_1[1][lVar9 + -2] != -1) {
      param_1[1][lVar9 + -2] = -0x80;
    }
    if ((*param_1)[lVar9 + -2] != -1) {
      (*param_1)[lVar9 + -2] = -0x80;
    }
  }
  if (param_1[lVar10 + -1][lVar9 + -1] == -1) {
    if (param_1[lVar10 + -2][lVar9 + -2] != -1) {
      param_1[lVar10 + -2][lVar9 + -2] = -0x80;
    }
    if (param_1[lVar10 + -2][lVar9 + -1] != -1) {
      param_1[lVar10 + -2][lVar9 + -1] = -0x80;
    }
    if (param_1[lVar10 + -1][lVar9 + -2] != -1) {
      param_1[lVar10 + -1][lVar9 + -2] = -0x80;
    }
  }
  if (*param_1[lVar10 + -1] == -1) {
    if (*param_1[lVar10 + -2] != -1) {
      *param_1[lVar10 + -2] = -0x80;
    }
    if (param_1[lVar10 + -2][1] != -1) {
      param_1[lVar10 + -2][1] = -0x80;
    }
    if (param_1[lVar10 + -1][1] != -1) {
      param_1[lVar10 + -1][1] = -0x80;
    }
  }
  lVar8 = (longlong)(param_2 * param_3);
  if (0 < lVar8) {
    do {
      if (*pcVar5 == -0x80) {
        *pcVar5 = -1;
      }
      pcVar5 = pcVar5 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
  }
  return;
}



void FUN_180012770(int param_1,int param_2,longlong param_3,int param_4)

{
  longlong lVar1;
  longlong lVar2;
  longlong lVar3;
  void *_Memory;
  int *_Memory_00;
  void *pvVar4;
  int iVar5;
  int *piVar6;
  longlong lVar7;
  byte *pbVar8;
  size_t _Count;
  longlong lVar9;
  byte **ppbVar10;
  int iVar11;
  size_t sVar12;
  int iVar13;
  int iVar14;
  
  lVar3 = (longlong)param_2;
  _Count = SEXT48(param_1);
  iVar5 = param_2;
  if (5 < param_2) {
    iVar5 = 5;
  }
  iVar14 = 0;
  _Memory = malloc(lVar3 * 8);
  _Memory_00 = (int *)calloc(_Count,4);
  lVar9 = 0;
  if (0 < (longlong)iVar5) {
    do {
      pvVar4 = malloc(_Count);
      lVar9 = lVar9 + 1;
      *(void **)((longlong)_Memory + lVar9 * 8 + -8) = pvVar4;
    } while (lVar9 < iVar5);
  }
  if (-2 < lVar3) {
    ppbVar10 = (byte **)((longlong)_Memory + -0x28);
    lVar9 = -2;
    do {
      if (-1 < lVar9 + -3) {
        pbVar8 = *ppbVar10;
        piVar6 = _Memory_00;
        sVar12 = _Count;
        if (0 < (longlong)_Count) {
          do {
            if ((int)(uint)*pbVar8 < param_4) {
              *piVar6 = *piVar6 + ((uint)*pbVar8 - param_4);
            }
            pbVar8 = pbVar8 + 1;
            sVar12 = sVar12 - 1;
            piVar6 = piVar6 + 1;
          } while (sVar12 != 0);
        }
        iVar14 = iVar14 + -1;
      }
      if (lVar9 + 2 < lVar3) {
        if (-1 < lVar9 + -3) {
          ppbVar10[5] = *ppbVar10;
        }
        FUN_18001d320((undefined8 *)ppbVar10[5],
                      *(undefined8 **)((param_3 - (longlong)_Memory) + 0x28 + (longlong)ppbVar10),
                      _Count);
        pbVar8 = ppbVar10[5];
        piVar6 = _Memory_00;
        sVar12 = _Count;
        if (0 < (longlong)_Count) {
          do {
            if ((int)(uint)*pbVar8 < param_4) {
              *piVar6 = *piVar6 + (param_4 - (uint)*pbVar8);
            }
            pbVar8 = pbVar8 + 1;
            sVar12 = sVar12 - 1;
            piVar6 = piVar6 + 1;
          } while (sVar12 != 0);
        }
        iVar14 = iVar14 + 1;
      }
      if (-1 < lVar9) {
        lVar2 = *(longlong *)((param_3 - (longlong)_Memory) + 0x18 + (longlong)ppbVar10);
        iVar11 = 0;
        iVar13 = 0;
        if (-2 < (longlong)_Count) {
          lVar7 = 0;
          piVar6 = _Memory_00;
          do {
            if (-1 < lVar7 + -5) {
              iVar11 = iVar11 - piVar6[-5];
              iVar13 = iVar13 - iVar14;
            }
            if (lVar7 < (longlong)_Count) {
              iVar11 = iVar11 + *piVar6;
              iVar13 = iVar13 + iVar14;
            }
            if (-1 < lVar7 + -2) {
              *(char *)(lVar2 + -2 + lVar7) = (char)(iVar11 / iVar13);
            }
            piVar6 = piVar6 + 1;
            lVar1 = lVar7 + -1;
            lVar7 = lVar7 + 1;
          } while (lVar1 < (longlong)_Count);
        }
      }
      lVar9 = lVar9 + 1;
      ppbVar10 = ppbVar10 + 1;
    } while (lVar9 < lVar3);
  }
  for (lVar9 = (longlong)(param_2 - iVar5); lVar9 < lVar3; lVar9 = lVar9 + 1) {
    free(*(void **)((longlong)_Memory + lVar9 * 8));
  }
  free(_Memory);
  free(_Memory_00);
  return;
}



void FUN_180012980(longlong *param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte bVar2;
  longlong lVar3;
  undefined8 *_Memory;
  uint uVar4;
  int iVar5;
  longlong lVar6;
  undefined uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  longlong lVar11;
  undefined8 *puVar12;
  longlong lVar13;
  longlong lVar14;
  undefined auStack1160 [48];
  int local_458;
  undefined8 *local_450;
  int local_448 [256];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)auStack1160;
  lVar13 = (longlong)param_2;
  lVar14 = (longlong)param_3;
  uVar4 = 0;
  local_458 = param_3 * param_2;
  iVar10 = (local_458 >> 0x1f & 7U) + local_458;
  local_450 = (undefined8 *)FUN_180007180(param_2,param_3);
  FUN_18001d980((undefined (*) [16])local_448,0,0x400);
  _Memory = local_450;
  lVar11 = 0;
  if (0 < param_3) {
    do {
      lVar6 = 0;
      if (0 < param_2) {
        lVar3 = param_1[lVar11];
        do {
          pbVar1 = (byte *)(lVar3 + lVar6);
          lVar6 = lVar6 + 1;
          local_448[*pbVar1] = local_448[*pbVar1] + 1;
        } while (lVar6 < lVar13);
      }
      lVar11 = lVar11 + 1;
    } while (lVar11 < lVar14);
  }
  iVar5 = 0;
  iVar8 = 0xff;
  lVar11 = 0xff;
  do {
    iVar5 = iVar5 + local_448[lVar11];
    iVar9 = iVar8;
    if (iVar10 >> 3 < iVar5) break;
    iVar8 = iVar8 + -1;
    lVar11 = lVar11 + -1;
    iVar9 = 0xff;
  } while (-1 < lVar11);
  FUN_18001d320((undefined8 *)*local_450,(undefined8 *)*param_1,(longlong)local_458);
  FUN_180012770(param_2,param_3,(longlong)_Memory,iVar9);
  lVar11 = 0;
  if (0 < param_3) {
    do {
      lVar6 = 0;
      if (0 < param_2) {
        do {
          if (uVar4 < *(byte *)(_Memory[lVar11] + lVar6)) {
            uVar4 = (uint)*(byte *)(_Memory[lVar11] + lVar6);
          }
          lVar6 = lVar6 + 1;
        } while (lVar6 < lVar13);
      }
      lVar11 = lVar11 + 1;
    } while (lVar11 < lVar14);
    if (0 < param_3) {
      puVar12 = (undefined8 *)((longlong)_Memory - (longlong)param_1);
      do {
        lVar11 = 0;
        if (0 < param_2) {
          do {
            bVar2 = *(byte *)(lVar11 + *(longlong *)((longlong)puVar12 + (longlong)param_1));
            if (bVar2 == 0) {
              *(char *)(lVar11 + *param_1) = (char)iVar9;
            }
            else {
              lVar6 = *param_1;
              if ((int)(uint)*(byte *)(lVar6 + lVar11) < iVar9) {
                iVar10 = iVar9 - (int)((iVar9 - (uint)*(byte *)(lVar6 + lVar11)) * uVar4) /
                                 (int)(uint)bVar2;
                uVar7 = 0;
                if (0 < iVar10) {
                  uVar7 = (char)iVar10;
                }
                *(undefined *)(lVar6 + lVar11) = uVar7;
              }
              else {
                *(char *)(lVar6 + lVar11) = (char)iVar9;
              }
            }
            lVar11 = lVar11 + 1;
          } while (lVar11 < lVar13);
        }
        param_1 = param_1 + 1;
        lVar14 = lVar14 + -1;
      } while (lVar14 != 0);
    }
  }
  free(_Memory);
  FUN_18001d2f0(local_48 ^ (ulonglong)auStack1160);
  return;
}



int FUN_180012b50(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  
  puVar1 = DAT_18004cfd0;
  iVar2 = 0;
  iVar3 = 0;
  *DAT_18004cfd0 = 0x10;
  *(undefined8 *)(puVar1 + 1) = 1000;
  puVar1[3] = 3;
  puVar1[4] = 9;
  puVar1[5] = 0x700;
  puVar1[6] = 1;
  puVar1[7] = 2;
  *(undefined8 *)(puVar1 + 8) = 2;
  *(undefined8 *)(puVar1 + 10) = 1;
  *(undefined8 *)(puVar1 + 0xc) = 0;
  puVar1[0xe] = 0;
  puVar1[0xf] = 0x288;
  puVar1[0x11] = 0x400;
  puVar1[0x12] = 0x73;
  puVar1[0x13] = 7;
  puVar1[0x14] = 8;
  puVar1[0x16] = 5;
  puVar1[0x17] = 0xffffffff;
  *(undefined8 *)(puVar1 + 0x18) = 0x18;
  *(undefined8 *)(puVar1 + 0x24) = 0;
  puVar1[0x1b] = 10;
  puVar1[0x1c] = 0x14;
  puVar1[0x1d] = 5;
  puVar1[0x1e] = 0xf0;
  puVar1[0x1f] = 1;
  puVar1[0x20] = 0x14;
  *(undefined8 *)(puVar1 + 0x22) = 170000;
  puVar1[0x1a] = 100;
  puVar1[0x26] = 2;
  switch(param_1) {
  case 5:
    puVar1[0x10] = 700;
    puVar1[0x15] = 0x294;
    puVar1[0x1a] = 0x55;
    puVar1[0x21] = 0x2df;
    break;
  default:
    iVar3 = -0x3ea;
    break;
  case 7:
  case 0x87:
    puVar1[1] = 0x4b0;
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x26c;
    puVar1[0x17] = 8;
    puVar1[0x18] = 0x1c;
    puVar1[0x21] = 0x366;
    break;
  case 8:
  case 0x88:
    puVar1[0x10] = 900;
    puVar1[0x15] = 0x294;
    puVar1[0x16] = 7;
    puVar1[0x17] = 6;
    puVar1[0x18] = 0x24;
    puVar1[0x19] = 1;
    puVar1[0x21] = 0x44c;
    puVar1[0xb] = 1;
    puVar1[0x25] = 0x20;
    break;
  case 9:
  case 0x89:
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x294;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x1a;
    puVar1[0x21] = 0x3c5;
    puVar1[0x25] = 0xc;
    puVar1[0xf] = 0x25c;
    iVar3 = iVar2;
    break;
  case 0xb:
    puVar1[5] = 0x400;
    goto LAB_180012da9;
  case 0xe:
    puVar1[1] = 0x4b0;
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x26c;
    puVar1[0x17] = 8;
    puVar1[0x18] = 0x1c;
    puVar1[0x21] = 0x2df;
    break;
  case 0x10:
    puVar1[1] = 0x4b5;
    puVar1[2] = 1;
    puVar1[5] = 0x467;
    puVar1[0x10] = 0x3aa;
    puVar1[0x12] = 0x7f;
    puVar1[0x13] = 8;
    puVar1[0x14] = 7;
    puVar1[0x15] = 0x294;
    puVar1[0x21] = 0x2df;
    puVar1[0xc] = 1;
    break;
  case 0x11:
    puVar1[5] = 0x500;
LAB_180012da9:
    puVar1[0x10] = 700;
    goto LAB_180012db0;
  case 0x12:
    puVar1[1] = 0x4e7;
    puVar1[5] = 0x500;
    puVar1[0x10] = 0x368;
    puVar1[0x12] = 0x7b;
    puVar1[0x13] = 9;
    puVar1[0x14] = 6;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x20;
    goto LAB_180012db0;
  case 0x13:
  case 0x93:
    *puVar1 = 0xf;
    puVar1[5] = 0x780;
    puVar1[0x10] = 0x2d0;
    puVar1[0x15] = 0x26c;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x1a;
    puVar1[0x21] = 0x29e;
    iVar3 = iVar2;
    break;
  case 0x14:
    puVar1[1] = 0x4b5;
    puVar1[5] = 0x467;
    puVar1[0x10] = 0x3aa;
    puVar1[0x12] = 0x7f;
    puVar1[0x13] = 8;
    puVar1[0x14] = 7;
LAB_180012db0:
    puVar1[0x15] = 0x294;
    puVar1[0x21] = 0x2df;
    break;
  case 0x15:
  case 0x95:
    puVar1[1] = 0;
    puVar1[2] = 1;
    puVar1[0x10] = 800;
    puVar1[0x12] = 0x7d;
    puVar1[0x15] = 0x226;
    puVar1[0x16] = 7;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x18;
    puVar1[0x19] = 1;
    puVar1[0x21] = 0x307;
    *(undefined8 *)(puVar1 + 0x25) = 0x14;
    iVar3 = iVar2;
    break;
  case 0x16:
    puVar1[5] = 0x800;
    puVar1[0x10] = 0x2d0;
    puVar1[0x12] = 0x6c;
    puVar1[0x15] = 500;
    puVar1[0x17] = 7;
    puVar1[0x18] = 0x1e;
    puVar1[0x1b] = 0;
    puVar1[0x21] = 0x226;
    puVar1[0xd] = 400;
    puVar1[0xe] = 1000;
    break;
  case 0x17:
    puVar1[5] = 0x938;
    puVar1[0xd] = 400;
    puVar1[0x10] = 700;
    puVar1[0x12] = 0x75;
    puVar1[0x15] = 0x1c2;
    puVar1[0x16] = 6;
    puVar1[0x17] = 8;
    puVar1[0x18] = 0x18;
    puVar1[0x19] = 1;
    puVar1[0x1a] = 0x55;
    puVar1[0x21] = 500;
  }
  if ((((param_1 == 0x87) || (param_1 == 0x88)) || (param_1 == 0x89)) ||
     ((param_1 == 0x93 || (param_1 == 0x95)))) {
    puVar1[0x25] = puVar1[0x25] + 8;
    puVar1[0x21] = puVar1[0x15];
  }
  else {
    if (iVar3 != 0) {
      return -0x3ea;
    }
  }
  return iVar3;
}



void FUN_180013090(void **param_1)

{
  if (*param_1 != (void *)0x0) {
    free(*param_1);
  }
  if (param_1[1] != (void *)0x0) {
    free(param_1[1]);
  }
  if (param_1[5] != (void *)0x0) {
    free(param_1[5]);
  }
  if (param_1[6] != (void *)0x0) {
    free(param_1[6]);
  }
  if (param_1[2] != (void *)0x0) {
    free(param_1[2]);
  }
  if (param_1[3] != (void *)0x0) {
    free(param_1[3]);
  }
  if (param_1[4] != (void *)0x0) {
    free(param_1[4]);
  }
  if (param_1[7] != (void *)0x0) {
    free(param_1[7]);
  }
  free(param_1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180013120(ulonglong param_1,ulonglong param_2,uint param_3)

{
  byte *pbVar1;
  undefined auVar2 [16];
  uint uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined in_XMM1 [16];
  undefined auVar8 [16];
  undefined auVar9 [16];
  
  auVar2 = _DAT_180043f00;
  iVar6 = 0;
  iVar5 = 0;
  iVar7 = iVar6;
  if ((((0 < (int)param_3) && (iVar7 = iVar5, 7 < param_3)) && (1 < DAT_180049300)) &&
     (((longlong)(int)(param_3 - 1) + param_2 < param_1 ||
      (param_1 + (longlong)(int)(param_3 - 1) * 4 < param_2)))) {
    uVar3 = param_3 & 0x80000007;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
    }
    auVar9 = ZEXT416(0x10);
    do {
      auVar8 = pmovzxbd(in_XMM1,ZEXT416(*(uint *)((longlong)iVar6 + param_2)));
      auVar8 = pmulld(auVar8,auVar2);
      auVar8 = CONCAT412(SUB164(auVar8 >> 0x60,0) + 0x8000 >> auVar9,
                         CONCAT48(SUB164(auVar8 >> 0x40,0) + 0x8000 >> auVar9,
                                  CONCAT44(SUB164(auVar8 >> 0x20,0) + 0x8000 >> auVar9,
                                           SUB164(auVar8,0) + 0x8000 >> auVar9)));
      *(undefined (*) [16])(param_1 + (longlong)iVar6 * 4) = auVar8;
      iVar7 = iVar6 + 4;
      iVar6 = iVar6 + 8;
      auVar8 = pmovzxbd(auVar8,ZEXT416(*(uint *)((longlong)iVar7 + param_2)));
      auVar8 = pmulld(auVar8,auVar2);
      in_XMM1 = CONCAT412(SUB164(auVar8 >> 0x60,0) + 0x8000 >> auVar9,
                          CONCAT48(SUB164(auVar8 >> 0x40,0) + 0x8000 >> auVar9,
                                   CONCAT44(SUB164(auVar8 >> 0x20,0) + 0x8000 >> auVar9,
                                            SUB164(auVar8,0) + 0x8000 >> auVar9)));
      *(undefined (*) [16])(param_1 + (longlong)iVar7 * 4) = in_XMM1;
      iVar7 = iVar6;
    } while (iVar6 < (int)(param_3 - uVar3));
  }
  lVar4 = (longlong)iVar7;
  while (lVar4 < (int)param_3) {
    pbVar1 = (byte *)(lVar4 + param_2);
    lVar4 = lVar4 + 1;
    *(int *)((param_1 - 4) + lVar4 * 4) = (int)((uint)*pbVar1 * 0x202020 + 0x8000) >> 0x10;
  }
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180013230(int *param_1,uint param_2,int param_3,int param_4)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  uint *puVar6;
  int *_Memory;
  int *piVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  longlong lVar10;
  int iVar11;
  ulonglong uVar12;
  longlong lVar13;
  ulonglong uVar14;
  uint uVar15;
  ulonglong uVar16;
  uint uVar17;
  uint uVar18;
  longlong lVar19;
  longlong lVar20;
  undefined auStack408 [32];
  uint local_178;
  int *local_170;
  int local_168;
  int *local_160;
  ulonglong local_158;
  longlong local_150;
  int local_148 [8];
  uint local_128 [8];
  int local_108 [8];
  int local_e8 [4];
  undefined8 local_d8;
  int local_d0;
  int local_cc;
  undefined8 local_c8;
  undefined4 local_c0;
  int local_bc;
  undefined4 local_b8;
  int local_b4;
  undefined4 local_b0;
  int local_ac;
  int local_a8 [8];
  int local_88 [4];
  undefined8 local_78;
  undefined8 local_70;
  int local_68 [8];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)auStack408;
  uVar12 = SEXT48((int)param_2);
  lVar19 = (longlong)param_3;
  local_178 = param_2;
  local_168 = param_3;
  local_160 = param_1;
  piVar5 = FUN_18000ee50(*param_1 + param_2 * 2,param_1[1] + param_3 * 2);
  local_170 = piVar5;
  if (piVar5 != (int *)0x0) {
    if (param_4 == 0) {
      FUN_18000f060((longlong)piVar5,param_2,param_3,param_1);
      lVar20 = 0;
      local_150 = lVar19;
      if (0 < param_3) {
        lVar13 = (longlong)(piVar5[1] - param_3) * 8;
        lVar10 = lVar20;
        do {
          FUN_18001d320((undefined8 *)
                        (*(longlong *)(*(longlong *)(piVar5 + 2) + lVar10 * 8) + uVar12 * 4),
                        (undefined8 *)**(undefined8 **)(param_1 + 2),(longlong)*param_1 << 2);
          FUN_18001d320((undefined8 *)
                        (*(longlong *)(*(longlong *)(piVar5 + 2) + lVar13) + uVar12 * 4),
                        *(undefined8 **)(*(longlong *)(param_1 + 2) + -8 + (longlong)param_1[1] * 8)
                        ,(longlong)*param_1 << 2);
          lVar10 = lVar10 + 1;
          lVar13 = lVar13 + 8;
        } while (lVar10 < lVar19);
        uVar12 = (ulonglong)local_178;
      }
      iVar11 = (int)uVar12;
      puVar6 = (uint *)FUN_18000ee50(1,param_1[1]);
      if (puVar6 != (uint *)0x0) {
        FUN_18000eef0((longlong)param_1,0,0,puVar6);
        if (0 < iVar11) {
          uVar15 = puVar6[1];
          local_158 = uVar12 & 0xffffffff;
          do {
            piVar5 = local_170;
            uVar12 = 0;
            uVar18 = *puVar6;
            if (0 < (int)uVar15) {
              lVar13 = lVar19 * 8;
              uVar8 = uVar12;
              do {
                FUN_18001d320((undefined8 *)
                              (*(longlong *)(*(longlong *)(piVar5 + 2) + lVar13 + uVar12) + lVar20),
                              *(undefined8 **)(*(longlong *)(puVar6 + 2) + uVar12),
                              (longlong)(int)(uVar18 << 2));
                uVar15 = puVar6[1];
                uVar17 = (int)uVar8 + 1;
                uVar8 = (ulonglong)uVar17;
                uVar12 = uVar12 + 8;
                lVar19 = local_150;
              } while ((int)uVar17 < (int)uVar15);
            }
            lVar20 = lVar20 + 4;
            local_158 = local_158 - 1;
          } while (local_158 != 0);
          uVar12 = (ulonglong)local_178;
          param_1 = local_160;
        }
        piVar5 = local_160;
        uVar8 = 0;
        uVar15 = *puVar6;
        iVar11 = *param_1;
        if (((uVar15 & 0x3fffffff) != 0) && (0 < (int)puVar6[1])) {
          uVar12 = uVar8;
          uVar14 = uVar8;
          do {
            FUN_18001d320(*(undefined8 **)(*(longlong *)(puVar6 + 2) + uVar12),
                          (undefined8 *)
                          (*(longlong *)(uVar12 + *(longlong *)(piVar5 + 2)) +
                          (longlong)(iVar11 + -1) * 4),(longlong)(int)(uVar15 << 2));
            uVar18 = (int)uVar14 + 1;
            uVar14 = (ulonglong)uVar18;
            uVar12 = uVar12 + 8;
          } while ((int)uVar18 < (int)puVar6[1]);
          uVar12 = (ulonglong)local_178;
        }
        local_158 = local_158 & 0xffffffff00000000;
        iVar11 = (int)uVar12;
        if (0 < iVar11) {
          uVar15 = puVar6[1];
          do {
            lVar19 = local_150;
            piVar5 = local_170;
            uVar14 = 0;
            uVar18 = *puVar6;
            iVar11 = *local_170;
            local_158._0_4_ = (int)uVar8;
            if (0 < (int)uVar15) {
              uVar12 = uVar14;
              do {
                FUN_18001d320((undefined8 *)
                              (*(longlong *)(*(longlong *)(piVar5 + 2) + uVar14 + lVar19 * 8) +
                              (longlong)((iVar11 - (int)local_158) + -1) * 4),
                              *(undefined8 **)(*(longlong *)(puVar6 + 2) + uVar14),
                              (longlong)(int)(uVar18 << 2));
                uVar15 = puVar6[1];
                uVar17 = (int)uVar12 + 1;
                uVar12 = (ulonglong)uVar17;
                uVar14 = uVar14 + 8;
              } while ((int)uVar17 < (int)uVar15);
              uVar12 = (ulonglong)local_178;
            }
            uVar18 = (int)local_158 + 1;
            uVar8 = (ulonglong)uVar18;
            local_158 = local_158 & 0xffffffff00000000 | (ulonglong)uVar18;
            iVar11 = (int)uVar12;
          } while ((int)uVar18 < iVar11);
        }
        free(puVar6);
        param_1 = local_160;
        lVar19 = local_150;
      }
      iVar4 = local_168;
      uVar12 = 0;
      iVar3 = local_168 * 8;
      _Memory = (int *)calloc((longlong)iVar3 + ((longlong)(local_168 * iVar11) + 4) * 4,1);
      piVar5 = local_170;
      if (_Memory != (int *)0x0) {
        *_Memory = iVar11;
        piVar1 = _Memory + 1;
        piVar7 = _Memory + 4;
        *(int **)(_Memory + 2) = piVar7;
        lVar20 = (longlong)piVar7 + (longlong)iVar3;
        *piVar1 = iVar4;
        if (0 < lVar19) {
          uVar8 = uVar12;
          do {
            *(longlong *)(piVar7 + uVar8 * 2) = lVar20;
            uVar8 = uVar8 + 1;
            lVar20 = lVar20 + (longlong)(int)local_178 * 4;
          } while ((longlong)uVar8 < lVar19);
        }
        uVar2 = *(undefined4 *)**(undefined8 **)(param_1 + 2);
        if (0 < *piVar1) {
          iVar11 = *_Memory;
          uVar8 = uVar12;
          uVar14 = uVar12;
          do {
            uVar9 = uVar12;
            uVar16 = uVar12;
            if (0 < iVar11) {
              do {
                uVar15 = (int)uVar16 + 1;
                *(undefined4 *)(uVar9 + *(longlong *)(*(longlong *)(_Memory + 2) + uVar8)) = uVar2;
                iVar11 = *_Memory;
                uVar9 = uVar9 + 4;
                uVar16 = (ulonglong)uVar15;
              } while ((int)uVar15 < iVar11);
            }
            uVar15 = (int)uVar14 + 1;
            uVar14 = (ulonglong)uVar15;
            uVar8 = uVar8 + 8;
          } while ((int)uVar15 < *piVar1);
        }
        iVar11 = *_Memory;
        if (0 < *piVar1) {
          uVar8 = uVar12;
          uVar14 = uVar12;
          do {
            FUN_18001d320(*(undefined8 **)(*(longlong *)(piVar5 + 2) + uVar8),
                          *(undefined8 **)(*(longlong *)(_Memory + 2) + uVar8),
                          (longlong)(iVar11 << 2));
            uVar15 = (int)uVar14 + 1;
            uVar14 = (ulonglong)uVar15;
            uVar8 = uVar8 + 8;
            param_1 = local_160;
          } while ((int)uVar15 < *piVar1);
        }
        piVar7 = local_170;
        uVar2 = *(undefined4 *)(**(longlong **)(param_1 + 2) + -4 + (longlong)*param_1 * 4);
        if (0 < *piVar1) {
          iVar11 = *_Memory;
          uVar8 = uVar12;
          uVar14 = uVar12;
          do {
            uVar9 = uVar12;
            uVar16 = uVar12;
            if (0 < iVar11) {
              do {
                uVar15 = (int)uVar16 + 1;
                *(undefined4 *)(uVar9 + *(longlong *)(*(longlong *)(_Memory + 2) + uVar8)) = uVar2;
                iVar11 = *_Memory;
                uVar9 = uVar9 + 4;
                uVar16 = (ulonglong)uVar15;
              } while ((int)uVar15 < iVar11);
            }
            uVar15 = (int)uVar14 + 1;
            uVar14 = (ulonglong)uVar15;
            uVar8 = uVar8 + 8;
          } while ((int)uVar15 < *piVar1);
        }
        iVar11 = *_Memory;
        iVar3 = *piVar5 - local_178;
        if (0 < *piVar1) {
          uVar8 = uVar12;
          do {
            FUN_18001d320((undefined8 *)
                          (*(longlong *)(uVar12 + *(longlong *)(piVar7 + 2)) + (longlong)iVar3 * 4),
                          *(undefined8 **)(*(longlong *)(_Memory + 2) + uVar12),
                          (longlong)(iVar11 << 2));
            uVar15 = (int)uVar8 + 1;
            uVar8 = (ulonglong)uVar15;
            uVar12 = uVar12 + 8;
            param_1 = local_160;
            piVar5 = local_170;
          } while ((int)uVar15 < *piVar1);
        }
        piVar7 = local_170;
        uVar12 = 0;
        uVar2 = **(undefined4 **)(*(longlong *)(param_1 + 2) + -8 + (longlong)param_1[1] * 8);
        if (0 < *piVar1) {
          iVar11 = *_Memory;
          uVar8 = uVar12;
          uVar14 = uVar12;
          do {
            uVar9 = uVar12;
            uVar16 = uVar12;
            if (0 < iVar11) {
              do {
                uVar15 = (int)uVar16 + 1;
                *(undefined4 *)(uVar9 + *(longlong *)(*(longlong *)(_Memory + 2) + uVar8)) = uVar2;
                iVar11 = *_Memory;
                uVar9 = uVar9 + 4;
                uVar16 = (ulonglong)uVar15;
              } while ((int)uVar15 < iVar11);
            }
            uVar15 = (int)uVar14 + 1;
            uVar14 = (ulonglong)uVar15;
            uVar8 = uVar8 + 8;
          } while ((int)uVar15 < *piVar1);
        }
        iVar11 = *_Memory;
        if (0 < *piVar1) {
          iVar3 = piVar5[1] - local_168;
          uVar8 = uVar12;
          do {
            FUN_18001d320(*(undefined8 **)(uVar12 + (longlong)iVar3 * 8 + *(longlong *)(piVar7 + 2))
                          ,*(undefined8 **)(*(longlong *)(_Memory + 2) + uVar12),
                          (longlong)(iVar11 << 2));
            uVar15 = (int)uVar8 + 1;
            uVar8 = (ulonglong)uVar15;
            uVar12 = uVar12 + 8;
            param_1 = local_160;
          } while ((int)uVar15 < *piVar1);
        }
        uVar12 = 0;
        uVar2 = *(undefined4 *)
                 (*(longlong *)(*(longlong *)(param_1 + 2) + -8 + (longlong)param_1[1] * 8) + -4 +
                 (longlong)*param_1 * 4);
        if (0 < *piVar1) {
          iVar11 = *_Memory;
          uVar8 = uVar12;
          uVar14 = uVar12;
          do {
            uVar9 = uVar12;
            uVar16 = uVar12;
            if (0 < iVar11) {
              do {
                uVar15 = (int)uVar16 + 1;
                *(undefined4 *)(uVar9 + *(longlong *)(*(longlong *)(_Memory + 2) + uVar8)) = uVar2;
                iVar11 = *_Memory;
                uVar9 = uVar9 + 4;
                uVar16 = (ulonglong)uVar15;
              } while ((int)uVar15 < iVar11);
            }
            uVar15 = (int)uVar14 + 1;
            uVar14 = (ulonglong)uVar15;
            uVar8 = uVar8 + 8;
          } while ((int)uVar15 < *piVar1);
        }
        iVar11 = *_Memory;
        iVar3 = *local_170 - local_178;
        if (0 < *piVar1) {
          iVar4 = local_170[1] - local_168;
          uVar8 = uVar12;
          do {
            FUN_18001d320((undefined8 *)
                          (*(longlong *)(uVar8 + (longlong)iVar4 * 8 + *(longlong *)(local_170 + 2))
                          + (longlong)iVar3 * 4),
                          *(undefined8 **)(*(longlong *)(_Memory + 2) + uVar8),
                          (longlong)(iVar11 << 2));
            uVar15 = (int)uVar12 + 1;
            uVar12 = (ulonglong)uVar15;
            uVar8 = uVar8 + 8;
          } while ((int)uVar15 < *piVar1);
        }
        free(_Memory);
      }
    }
    else {
      if (param_4 == 4) {
        local_108[0] = *param_1;
        local_148[2] = param_1[1];
        uVar8 = 0;
        local_a8[2] = 0;
        local_a8[3] = 0;
        local_a8[4] = 1;
        local_a8[5] = 1;
        local_68[4] = 1;
        local_68[5] = 1;
        local_68[6] = 1;
        local_68[7] = 1;
        local_108[1] = local_108[0];
        local_88[0] = 1;
        local_88[1] = 1;
        local_88[2] = 0;
        local_88[3] = 0;
        local_bc = (local_108[0] - param_2) + -1;
        local_148[3] = local_148[2];
        local_68[0] = 0;
        local_68[1] = 0;
        local_68[2] = 1;
        local_68[3] = 1;
        local_b4 = local_bc;
        local_ac = local_bc;
        local_a8[1] = (local_148[2] - param_3) + -1;
        local_108[2] = param_2;
        local_108[3] = param_2;
        local_a8[6] = local_a8[1];
        local_a8[7] = local_a8[1];
        local_108[4] = param_2;
        local_108[5] = param_2;
        local_78 = 0x100000001;
        local_70 = 0x100000001;
        local_128[3] = *piVar5 - param_2;
        local_108[6] = param_2;
        local_108[7] = param_2;
        local_128[5] = local_128[3];
        local_128[7] = local_128[3];
        local_128[0] = param_2;
        local_128[1] = param_2;
        local_e8[1] = piVar5[1] - param_3;
        local_148[0] = param_3;
        local_148[1] = param_3;
        local_148[4] = param_3;
        local_148[5] = param_3;
        local_148[6] = param_3;
        local_d0 = local_e8[1];
        local_cc = local_e8[1];
        local_148[7] = param_3;
        local_c8 = 0;
        local_c0 = 1;
        local_b8 = 1;
        local_b0 = 1;
        local_a8[0] = 1;
        local_128[2] = 0;
        local_128[4] = 0;
        local_128[6] = 0;
        local_e8[0] = 0;
        local_e8[2] = param_3;
        local_e8[3] = param_3;
        local_d8 = 0;
        uVar12 = uVar8;
        do {
          puVar6 = (uint *)FUN_18000ee50(*(int *)((longlong)local_108 + uVar12),
                                         *(int *)((longlong)local_148 + uVar12));
          if (puVar6 != (uint *)0x0) {
            FUN_18000eef0((longlong)param_1,*(int *)((longlong)&local_c8 + uVar12),
                          *(int *)((longlong)local_a8 + uVar12),puVar6);
            if (*(int *)((longlong)local_88 + uVar12) != 0) {
              FUN_18000ef90((int *)puVar6);
            }
            if ((*(int *)((longlong)local_68 + uVar12) != 0) &&
               (uVar14 = uVar8, uVar9 = uVar8, 0 < (int)puVar6[1])) {
              do {
                lVar19 = (longlong)(int)(*puVar6 - 1);
                uVar16 = uVar8;
                if (0 < lVar19) {
                  do {
                    lVar19 = lVar19 + -1;
                    uVar16 = uVar16 + 1;
                    lVar20 = *(longlong *)(uVar14 + *(longlong *)(puVar6 + 2));
                    uVar2 = *(undefined4 *)(lVar20 + -4 + uVar16 * 4);
                    *(undefined4 *)(lVar20 + -4 + uVar16 * 4) =
                         *(undefined4 *)(lVar20 + 4 + lVar19 * 4);
                    *(undefined4 *)
                     (*(longlong *)(*(longlong *)(puVar6 + 2) + uVar14) + 4 + lVar19 * 4) = uVar2;
                  } while ((longlong)uVar16 < lVar19);
                }
                uVar15 = (int)uVar9 + 1;
                uVar14 = uVar14 + 8;
                uVar9 = (ulonglong)uVar15;
              } while ((int)uVar15 < (int)puVar6[1]);
            }
            FUN_18000f060((longlong)piVar5,*(int *)((longlong)local_128 + uVar12),
                          *(int *)((longlong)local_e8 + uVar12),(int *)puVar6);
            free(puVar6);
          }
          uVar12 = uVar12 + 4;
        } while ((longlong)uVar12 < 0x20);
        FUN_18000f060((longlong)piVar5,local_178,param_3,param_1);
      }
    }
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)auStack408);
  return;
}



void FUN_180013a70(int *param_1,int *param_2,longlong param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *_Memory;
  int *piVar5;
  int iVar6;
  longlong lVar7;
  uint uVar8;
  longlong lVar9;
  longlong lVar10;
  int iVar11;
  longlong lVar12;
  
  iVar2 = param_2[1] / 2;
  uVar3 = *param_2 / 2;
  _Memory = (int *)FUN_180013230(param_1,uVar3,iVar2,param_4);
  if (_Memory != (int *)0x0) {
    if (iVar2 < _Memory[1] - iVar2) {
      iVar6 = *_Memory - uVar3;
      lVar12 = 0;
      iVar11 = iVar2;
      do {
        if ((int)uVar3 < iVar6) {
          lVar9 = 0;
          uVar8 = uVar3;
          do {
            iVar6 = 0;
            lVar10 = 0;
            if (0 < (longlong)param_2[1]) {
              do {
                if (0 < (longlong)*param_2) {
                  piVar1 = *(int **)(*(longlong *)(param_2 + 2) + lVar10 * 8);
                  piVar5 = piVar1;
                  lVar7 = (longlong)*param_2;
                  do {
                    iVar6 = iVar6 + *(int *)((*(longlong *)
                                               (*(longlong *)(_Memory + 2) + lVar12 + lVar10 * 8) -
                                             (longlong)piVar1) + lVar9 + (longlong)piVar5) * *piVar5
                    ;
                    lVar7 = lVar7 + -1;
                    piVar5 = piVar5 + 1;
                  } while (lVar7 != 0);
                }
                lVar10 = lVar10 + 1;
              } while (lVar10 < param_2[1]);
            }
            iVar4 = -0x2000;
            if (0 < iVar6) {
              iVar4 = 0x2000;
            }
            uVar8 = uVar8 + 1;
            *(int *)(lVar9 + *(longlong *)(lVar12 + *(longlong *)(param_3 + 8))) =
                 (int)(iVar4 + iVar6 + (iVar4 + iVar6 >> 0x1f & 0x3fffU)) >> 0xe;
            iVar6 = *_Memory - uVar3;
            lVar9 = lVar9 + 4;
          } while ((int)uVar8 < iVar6);
        }
        iVar11 = iVar11 + 1;
        lVar12 = lVar12 + 8;
      } while (iVar11 < _Memory[1] - iVar2);
    }
    free(_Memory);
  }
  return;
}



void FUN_180013bf0(int *param_1,longlong param_2,int param_3)

{
  int *_Memory;
  longlong lVar1;
  undefined auStack104 [32];
  undefined4 local_48 [4];
  undefined4 local_38;
  undefined2 local_34;
  ulonglong local_30;
  
  local_30 = DAT_180049180 ^ (ulonglong)auStack104;
  local_34 = 0x24a;
  lVar1 = (longlong)(param_3 + -10);
  local_48[0] = 0x190000;
  local_48[1] = 0x4b0032;
  local_48[2] = 0xad007c;
  local_48[3] = 0x12f00de;
  local_38 = 0x1d10180;
  _Memory = FUN_18000ee50((uint)(byte)(&DAT_180041b50)[lVar1],(uint)(byte)(&DAT_180041b50)[lVar1]);
  if (_Memory != (int *)0x0) {
    FUN_18001d320((undefined8 *)**(undefined8 **)(_Memory + 2),
                  (undefined8 *)
                  (&DAT_1800426a0 + (ulonglong)*(ushort *)((longlong)local_48 + lVar1 * 2) * 4),
                  (longlong)
                  (int)((uint)(byte)(&DAT_180041b50)[lVar1] * (uint)(byte)(&DAT_180041b50)[lVar1])
                  << 2);
    FUN_180013a70(param_1,_Memory,param_2,0);
    free(_Memory);
  }
  FUN_18001d2f0(local_30 ^ (ulonglong)auStack104);
  return;
}



void * FUN_180013ce0(int param_1,int param_2)

{
  int iVar1;
  void *pvVar2;
  int *piVar3;
  int iVar4;
  
  iVar1 = param_2 / 2;
  pvVar2 = malloc((longlong)(param_1 + iVar1 * 2) << 2);
  if (pvVar2 == (void *)0x0) {
    return (void *)0x0;
  }
  iVar4 = -iVar1;
  if (iVar4 < iVar1 + param_1) {
    piVar3 = (int *)((longlong)pvVar2 + ((longlong)iVar1 + (longlong)iVar4) * 4);
    do {
      if (iVar4 < 0) {
        *piVar3 = 0;
      }
      else {
        if (iVar4 < param_1) {
          *piVar3 = iVar4;
        }
        else {
          *piVar3 = param_1 + -1;
        }
      }
      iVar4 = iVar4 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar4 < iVar1 + param_1);
  }
  return pvVar2;
}



undefined8 FUN_180013d60(int *param_1,int *param_2,uint param_3)

{
  undefined4 uVar1;
  uint uVar2;
  undefined4 uVar3;
  longlong lVar4;
  longlong *plVar5;
  longlong lVar6;
  uint uVar7;
  int iVar8;
  int *_Memory;
  void *pvVar9;
  longlong lVar10;
  int *piVar11;
  longlong lVar12;
  int *piVar13;
  longlong lVar14;
  longlong *plVar15;
  int iVar16;
  int iVar17;
  longlong lVar18;
  longlong lVar19;
  void *pvVar20;
  longlong lVar21;
  longlong lVar22;
  longlong lVar23;
  int iVar24;
  int iVar27;
  int iVar29;
  undefined auVar25 [16];
  int iVar31;
  undefined auVar26 [16];
  undefined in_XMM6 [16];
  int iVar28;
  int iVar30;
  int iVar32;
  
  iVar17 = param_1[1];
  lVar23 = (longlong)iVar17;
  iVar8 = *param_1;
  lVar14 = (longlong)iVar8;
  lVar21 = (longlong)(int)param_3;
  _Memory = FUN_18000ee50(iVar8,iVar17);
  lVar4 = *(longlong *)(param_1 + 2);
  plVar5 = *(longlong **)(_Memory + 2);
  pvVar9 = FUN_180013ce0(iVar8,param_3);
  if (0 < lVar23) {
    lVar18 = lVar4 - (longlong)plVar5;
    lVar12 = lVar23;
    plVar15 = plVar5;
    iVar8 = DAT_180049300;
    do {
      lVar22 = 0;
      if (0 < lVar14) {
        piVar11 = (int *)((longlong)pvVar9 + 8);
        do {
          iVar16 = 0;
          lVar19 = 0;
          if (((0 < (int)param_3) && (7 < param_3)) && (1 < iVar8)) {
            lVar6 = *(longlong *)(lVar18 + (longlong)plVar15);
            uVar7 = param_3 & 0x80000007;
            if ((int)uVar7 < 0) {
              uVar7 = (uVar7 - 1 | 0xfffffff8) + 1;
            }
            auVar26 = in_XMM6 & (undefined  [16])0x0;
            piVar13 = piVar11;
            in_XMM6 = auVar26;
            do {
              uVar1 = *(undefined4 *)(lVar6 + (longlong)*piVar13 * 4);
              uVar2 = *(uint *)(lVar6 + (longlong)piVar13[-2] * 4);
              lVar10 = (longlong)iVar16;
              lVar19 = lVar19 + 8;
              uVar3 = *(undefined4 *)(lVar6 + (longlong)piVar13[1] * 4);
              iVar8 = iVar16 + 4;
              iVar16 = iVar16 + 8;
              auVar25 = pmulld(CONCAT88(SUB168(CONCAT412(uVar3,CONCAT48(uVar1,CONCAT44(uVar1,uVar2))
                                                        ) >> 0x40,0),
                                        (ulonglong)uVar2 |
                                        CONCAT44(uVar3,*(undefined4 *)
                                                        (lVar6 + (longlong)piVar13[-1] * 4)) << 0x20
                                       ),*(undefined (*) [16])(param_2 + lVar10));
              iVar24 = SUB164(auVar25,0) + SUB164(in_XMM6,0);
              iVar27 = SUB164(auVar25 >> 0x20,0) + SUB164(in_XMM6 >> 0x20,0);
              iVar29 = SUB164(auVar25 >> 0x40,0) + SUB164(in_XMM6 >> 0x40,0);
              iVar31 = SUB164(auVar25 >> 0x60,0) + SUB164(in_XMM6 >> 0x60,0);
              in_XMM6 = CONCAT412(iVar31,CONCAT48(iVar29,CONCAT44(iVar27,iVar24)));
              uVar1 = *(undefined4 *)(lVar6 + (longlong)piVar13[5] * 4);
              uVar2 = *(uint *)(lVar6 + (longlong)piVar13[2] * 4);
              uVar3 = *(undefined4 *)(lVar6 + (longlong)piVar13[4] * 4);
              auVar25 = pmulld(CONCAT88(SUB168(CONCAT412(uVar1,CONCAT48(uVar3,CONCAT44(uVar3,uVar2))
                                                        ) >> 0x40,0),
                                        (ulonglong)uVar2 |
                                        CONCAT44(uVar1,*(undefined4 *)
                                                        (lVar6 + (longlong)piVar13[3] * 4)) << 0x20)
                               ,*(undefined (*) [16])(param_2 + iVar8));
              iVar8 = SUB164(auVar25,0) + SUB164(auVar26,0);
              iVar28 = SUB164(auVar25 >> 0x20,0) + SUB164(auVar26 >> 0x20,0);
              iVar30 = SUB164(auVar25 >> 0x40,0) + SUB164(auVar26 >> 0x40,0);
              iVar32 = SUB164(auVar25 >> 0x60,0) + SUB164(auVar26 >> 0x60,0);
              auVar26 = CONCAT412(iVar32,CONCAT48(iVar30,CONCAT44(iVar28,iVar8)));
              piVar13 = piVar13 + 8;
            } while (iVar16 < (int)(param_3 - uVar7));
            iVar16 = iVar8 + iVar24 + iVar30 + iVar29 + iVar28 + iVar27 + iVar32 + iVar31;
          }
          iVar8 = 0;
          iVar24 = 0;
          if (lVar19 < lVar21) {
            if (1 < lVar21 - lVar19) {
              lVar6 = lVar19 + 1;
              lVar10 = ((lVar21 - lVar19) - 2U >> 1) + 1;
              lVar19 = lVar19 + lVar10 * 2;
              piVar13 = param_2 + lVar6;
              do {
                iVar8 = iVar8 + *(int *)(*(longlong *)(lVar18 + (longlong)plVar15) +
                                        (longlong)
                                        *(int *)((longlong)piVar13 +
                                                (-0xc - (longlong)param_2) + (longlong)piVar11) * 4)
                                * piVar13[-1];
                iVar24 = iVar24 + *(int *)(*(longlong *)(lVar18 + (longlong)plVar15) +
                                          (longlong)
                                          *(int *)((longlong)piVar11 + (-0x10 - (longlong)param_2) +
                                                  (longlong)(piVar13 + 2)) * 4) * *piVar13;
                lVar10 = lVar10 + -1;
                piVar13 = piVar13 + 2;
              } while (lVar10 != 0);
            }
            if (lVar19 < lVar21) {
              iVar16 = iVar16 + *(int *)(*(longlong *)(lVar18 + (longlong)plVar15) +
                                        (longlong)piVar11[lVar19 + -2] * 4) * param_2[lVar19];
            }
            iVar16 = iVar16 + iVar24 + iVar8;
          }
          lVar22 = lVar22 + 1;
          piVar11 = piVar11 + 1;
          *(int *)(*plVar15 + -4 + lVar22 * 4) = iVar16 + 0x4000 >> 0xf;
          iVar8 = DAT_180049300;
        } while (lVar22 < lVar14);
      }
      plVar15 = plVar15 + 1;
      lVar12 = lVar12 + -1;
    } while (lVar12 != 0);
  }
  free(pvVar9);
  FUN_18001d320((undefined8 *)**(undefined8 **)(param_1 + 2),
                (undefined8 *)**(undefined8 **)(_Memory + 2),(longlong)(*_Memory * _Memory[1]) << 2)
  ;
  iVar8 = (int)param_3 / 2;
  pvVar9 = malloc((longlong)(iVar17 + iVar8 * 2) << 2);
  if (pvVar9 != (void *)0x0) {
    iVar16 = -iVar8;
    if (iVar16 < iVar8 + iVar17) {
      lVar12 = (longlong)iVar16;
      piVar11 = (int *)((longlong)pvVar9 + (iVar8 + lVar12) * 4);
      do {
        if (iVar16 < 0) {
          *piVar11 = 0;
        }
        else {
          if (lVar12 < lVar23) {
            *piVar11 = iVar16;
          }
          else {
            *piVar11 = iVar17 + -1;
          }
        }
        iVar16 = iVar16 + 1;
        lVar12 = lVar12 + 1;
        piVar11 = piVar11 + 1;
      } while (iVar16 < iVar8 + iVar17);
    }
  }
  lVar12 = 0;
  if (0 < lVar14) {
    do {
      lVar18 = 0;
      if (0 < lVar23) {
        pvVar20 = (void *)((longlong)pvVar9 - (longlong)param_2);
        do {
          iVar17 = 0;
          piVar11 = param_2;
          lVar22 = lVar21;
          if (0 < lVar21) {
            do {
              iVar17 = iVar17 + *(int *)(*(longlong *)
                                          (lVar4 + (longlong)
                                                   *(int *)((longlong)pvVar20 + (longlong)piVar11) *
                                                   8) + lVar12 * 4) * *piVar11;
              lVar22 = lVar22 + -1;
              piVar11 = piVar11 + 1;
            } while (lVar22 != 0);
          }
          plVar15 = plVar5 + lVar18;
          lVar18 = lVar18 + 1;
          pvVar20 = (void *)((longlong)pvVar20 + 4);
          *(int *)(*plVar15 + lVar12 * 4) = iVar17 + 0x4000 >> 0xf;
        } while (lVar18 < lVar23);
      }
      lVar12 = lVar12 + 1;
    } while (lVar12 < lVar14);
  }
  free(pvVar9);
  FUN_18001d320((undefined8 *)**(undefined8 **)(param_1 + 2),
                (undefined8 *)**(undefined8 **)(_Memory + 2),(longlong)(*_Memory * _Memory[1]) << 2)
  ;
  free(_Memory);
  return 0;
}



void FUN_1800141e0(longlong param_1,int *param_2)

{
  int iVar1;
  undefined8 uVar2;
  undefined auStack72 [32];
  undefined4 local_28;
  undefined4 local_24;
  undefined2 local_20;
  undefined local_1e;
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)auStack72;
  iVar1 = param_2[8];
  if (iVar1 == 1) {
    iVar1 = FUN_180013bf0(*(int **)(param_1 + 0x28),(longlong)*(int **)(param_1 + 0x28),*param_2);
  }
  else {
    if (iVar1 != 2) {
      if (iVar1 == 3) {
        FUN_18000f160(*(uint **)(param_1 + 0x28),(longlong)*(uint **)(param_1 + 0x28));
      }
      goto LAB_18001428e;
    }
    iVar1 = *param_2 + -10;
    local_28 = 0xf0a0500;
    local_24 = 0x2d241d16;
    local_20 = 0x3f36;
    local_1e = 0x4a;
    if (10 < iVar1) {
      iVar1 = 10;
    }
    uVar2 = FUN_180013d60(*(int **)(param_1 + 0x28),
                          (int *)(&UNK_180043070 +
                                 (ulonglong)*(byte *)((longlong)&local_28 + (longlong)iVar1) * 4),
                          (uint)(byte)(&DAT_180041b50)[iVar1]);
    iVar1 = (int)uVar2;
  }
  if (iVar1 != 0) {
    FUN_18001d2f0(local_18 ^ (ulonglong)auStack72);
    return;
  }
LAB_18001428e:
  FUN_18001d2f0(local_18 ^ (ulonglong)auStack72);
  return;
}



void FUN_1800142b0(undefined8 *param_1,undefined8 *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int iVar2;
  undefined8 *puVar3;
  int iVar4;
  int iVar5;
  
  iVar1 = param_5 * 2 + 1;
  iVar2 = (param_5 / 2 + 0x600) / param_5;
  if (param_5 == 1) {
    *param_1 = 0x140000000600;
    *(undefined4 *)(param_1 + 1) = 0x600;
    *param_2 = 0xffffc000;
    *(undefined4 *)(param_2 + 1) = 0x4000;
  }
  else {
    iVar5 = 0;
    do {
      iVar4 = param_4;
      puVar3 = param_2;
      if (iVar5 == 0) {
        iVar4 = param_3;
        puVar3 = param_1;
      }
      *puVar3 = 0;
      puVar3[1] = 0;
      puVar3[2] = 0;
      puVar3[3] = 0;
      puVar3[4] = 0;
      puVar3[5] = 0;
      puVar3[6] = 0;
      puVar3[7] = 0;
      if (iVar4 == 0) {
        *(int *)puVar3 = iVar2;
        *(int *)((longlong)puVar3 + (longlong)(iVar1 / 2) * 4) = (param_5 / 2 + 0x1400) / param_5;
        *(int *)((longlong)puVar3 + (longlong)iVar1 * 4 + -4) = iVar2;
      }
      else {
        if (iVar4 == 1) {
          *(undefined4 *)puVar3 = 0xffffc000;
          *(undefined4 *)((longlong)puVar3 + (longlong)(iVar1 / 2) * 4) = 0;
          *(undefined4 *)((longlong)puVar3 + (longlong)iVar1 * 4 + -4) = 0x4000;
        }
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 < 2);
  }
  return;
}



void FUN_1800143f0(int *param_1,int *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int *_Memory;
  int *_Memory_00;
  int *local_d8;
  undefined8 local_c8 [8];
  undefined8 local_88 [8];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffef8;
  iVar1 = param_5 * 2 + 1;
  local_d8 = param_1;
  _Memory = FUN_18000ee50(iVar1,1);
  _Memory_00 = FUN_18000ee50(1,iVar1);
  if (_Memory != (int *)0x0) {
    if (_Memory_00 != (int *)0x0) {
      FUN_1800142b0(local_c8,local_88,param_3,param_4,param_5);
      FUN_18001d320((undefined8 *)**(undefined8 **)(_Memory + 2),local_c8,(longlong)iVar1 << 2);
      FUN_18001d320((undefined8 *)**(undefined8 **)(_Memory_00 + 2),local_88,(longlong)iVar1 << 2);
      FUN_180013a70(local_d8,_Memory,(longlong)param_2,4);
      FUN_180013a70(param_2,_Memory_00,(longlong)param_2,4);
    }
    free(_Memory);
  }
  if (_Memory_00 != (int *)0x0) {
    free(_Memory_00);
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xfffffffffffffef8);
  return;
}



void FUN_180014530(uint **param_1,int *param_2)

{
  int iVar1;
  
  iVar1 = param_2[10];
  if (iVar1 == 0) {
    iVar1 = (*param_2 * 0xf) / 100;
    FUN_1800143f0((int *)param_1[5],(int *)*param_1,1,0,iVar1);
    FUN_1800143f0((int *)param_1[5],(int *)param_1[1],0,1,iVar1);
    FUN_1800143f0((int *)*param_1,(int *)param_1[2],1,0,iVar1);
    FUN_1800143f0((int *)param_1[1],(int *)param_1[4],0,1,iVar1);
    FUN_1800143f0((int *)*param_1,(int *)param_1[3],0,1,iVar1);
    return;
  }
  if (iVar1 == 1) {
    FUN_18000f6b0((int *)param_1[5],(longlong)*param_1,(longlong)param_1[1]);
    FUN_18000f6b0((int *)*param_1,(longlong)param_1[2],(longlong)param_1[3]);
    FUN_18000f6b0((int *)param_1[1],0,(longlong)param_1[4]);
    return;
  }
  if (iVar1 == 2) {
    FUN_18000f870(param_1[5],(longlong)*param_1,(longlong)param_1[1]);
    FUN_18000f870(*param_1,(longlong)param_1[2],(longlong)param_1[3]);
    FUN_18000f870(param_1[1],0,(longlong)param_1[4]);
    return;
  }
  return;
}



undefined8 FUN_180014660(uint **param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  int *piVar4;
  undefined8 uVar5;
  longlong lVar6;
  longlong lVar7;
  char *pcVar8;
  int iVar9;
  int iVar10;
  longlong lVar11;
  longlong lVar12;
  
  uVar1 = *param_1[5];
  uVar2 = param_1[5][1];
  pcVar8 = *(char **)param_1[7];
  puVar3 = (uint *)FUN_18000ee50(uVar1,uVar2);
  *param_1 = puVar3;
  puVar3 = (uint *)FUN_18000ee50(uVar1,uVar2);
  param_1[1] = puVar3;
  puVar3 = (uint *)FUN_18000ee50(uVar1,uVar2);
  param_1[2] = puVar3;
  puVar3 = (uint *)FUN_18000ee50(uVar1,uVar2);
  param_1[3] = puVar3;
  puVar3 = (uint *)FUN_18000ee50(uVar1,uVar2);
  param_1[4] = puVar3;
  if ((((*param_1 == (uint *)0x0) || (param_1[1] == (uint *)0x0)) || (param_1[2] == (uint *)0x0)) ||
     ((param_1[3] == (uint *)0x0 || (puVar3 == (uint *)0x0)))) {
    uVar5 = 0xfffffc18;
  }
  else {
    FUN_180014530(param_1,param_2);
    lVar11 = (longlong)(int)(uVar2 * uVar1);
    piVar4 = **(int ***)(param_1[4] + 2);
    if (0 < (int)(uVar2 * uVar1)) {
      lVar12 = **(longlong **)(param_1[3] + 2) - (longlong)piVar4;
      lVar7 = **(longlong **)(param_1[3] + 2) - (longlong)piVar4;
      lVar6 = **(longlong **)(param_1[2] + 2) - (longlong)piVar4;
      do {
        iVar10 = *(int *)(lVar7 + (longlong)piVar4);
        iVar9 = *piVar4 * *(int *)((longlong)piVar4 + lVar6);
        iVar10 = iVar10 * iVar10;
        *(int *)(lVar12 + (longlong)piVar4) =
             (int)((((0 < iVar9 - iVar10) + 7) - iVar10) + iVar9) >> 4;
        if (*pcVar8 != -1) {
          *pcVar8 = *(int *)((longlong)piVar4 + lVar6) < 0;
        }
        piVar4 = piVar4 + 1;
        pcVar8 = pcVar8 + 1;
        lVar11 = lVar11 + -1;
      } while (lVar11 != 0);
    }
    if (param_1[4] != (uint *)0x0) {
      free(param_1[4]);
    }
    if (param_1[2] != (uint *)0x0) {
      free(param_1[2]);
    }
    param_1[4] = (uint *)0x0;
    param_1[2] = (uint *)0x0;
    param_1[6] = param_1[3];
    uVar5 = 0;
    param_1[3] = (uint *)0x0;
  }
  return uVar5;
}



int * FUN_1800147f0(longlong param_1,longlong param_2)

{
  uint *puVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  int *_Memory;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  uint uVar8;
  longlong lVar9;
  int *piVar10;
  int iVar11;
  uint uVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  uint *puVar17;
  uint uVar18;
  longlong lVar19;
  int *piVar20;
  longlong lVar21;
  uint uVar22;
  int *piVar23;
  longlong local_res20;
  
  iVar14 = *(int *)(param_2 + 0x10);
  lVar9 = *(longlong *)(param_1 + 0x38);
  piVar23 = (int *)0x0;
  iVar13 = 0;
  uVar22 = 0;
  iVar4 = (*(int *)(param_1 + 0x44) * *(int *)(param_1 + 0x40)) / (iVar14 * iVar14);
  _Memory = (int *)calloc(0x10,(longlong)iVar4);
  if (_Memory == (int *)0x0) {
    return (int *)0x0;
  }
  iVar11 = 0xb;
  if (0xb < *(int *)(*(longlong *)(param_1 + 0x30) + 4) + -0xb) {
    lVar9 = lVar9 + -8;
    local_res20 = 0x60;
    piVar10 = piVar23;
    do {
      iVar15 = 0xb;
      lVar19 = *(longlong *)(*(int **)(param_1 + 0x30) + 2);
      lVar21 = 0xb;
      lVar2 = *(longlong *)(lVar19 + -8 + local_res20);
      if (0xb < **(int **)(param_1 + 0x30) + -0xb) {
        lVar16 = *(longlong *)(lVar19 + -0x10 + local_res20) - lVar2;
        lVar19 = *(longlong *)(lVar19 + local_res20) - lVar2;
        piVar5 = (int *)(lVar2 + 0x30);
        do {
          if ((((((*(char *)(lVar21 + *(longlong *)(lVar9 + local_res20)) != -1) &&
                 (uVar18 = piVar5[-1], *(int *)(param_2 + 4) < (int)uVar18)) &&
                (piVar5[-2] < (int)uVar18)) &&
               ((*piVar5 < (int)uVar18 && (*(int *)(lVar16 + -8 + (longlong)piVar5) < (int)uVar18)))
               ) && ((*(int *)((longlong)piVar5 + lVar16 + -4) < (int)uVar18 &&
                     ((*(int *)(lVar16 + (longlong)piVar5) < (int)uVar18 &&
                      (*(int *)(lVar19 + -8 + (longlong)piVar5) < (int)uVar18)))))) &&
             ((*(int *)((longlong)piVar5 + lVar19 + -4) < (int)uVar18 &&
              (*(int *)(lVar19 + (longlong)piVar5) < (int)uVar18)))) {
            uVar12 = (uint)piVar10;
            uVar8 = (uVar18 ^ (int)uVar18 >> 0x1f) - ((int)uVar18 >> 0x1f);
            piVar6 = piVar23;
            piVar7 = _Memory;
            piVar20 = piVar23;
            uVar18 = uVar22;
            if (0 < (int)uVar12) {
              do {
                uVar18 = (uint)piVar20;
                if ((iVar11 - piVar7[1]) * (iVar11 - piVar7[1]) +
                    (iVar15 - *piVar7) * (iVar15 - *piVar7) < iVar14 - (iVar14 >> 2)) {
                  if (uVar8 < (uint)_Memory[(longlong)piVar6 * 4 + 2] ||
                      uVar8 == _Memory[(longlong)piVar6 * 4 + 2]) goto LAB_180014a56;
                  break;
                }
                piVar6 = (int *)((longlong)piVar6 + 1);
                uVar18 = uVar18 + 1;
                piVar7 = piVar7 + 4;
                piVar20 = (int *)(ulonglong)uVar18;
              } while ((longlong)piVar6 < (longlong)(int)uVar12);
              if ((int)uVar18 < 0) goto LAB_180014a56;
            }
            piVar6 = _Memory + (longlong)piVar6 * 4;
            if (uVar18 == uVar12) {
              piVar10 = (int *)(ulonglong)(uVar12 + 1);
            }
            piVar6[2] = uVar8;
            *piVar6 = iVar15;
            piVar6[1] = iVar11;
            *(undefined *)(piVar6 + 3) = *(undefined *)(lVar21 + *(longlong *)(lVar9 + local_res20))
            ;
            iVar13 = (int)piVar10;
            if (iVar4 <= iVar13) goto LAB_1800149f8;
          }
LAB_180014a56:
          iVar15 = iVar15 + 1;
          lVar21 = lVar21 + 1;
          piVar5 = piVar5 + 1;
        } while (iVar15 < **(int **)(param_1 + 0x30) + -0xb);
      }
      iVar13 = (int)piVar10;
      if (iVar4 <= iVar13) break;
      local_res20 = local_res20 + 8;
      iVar11 = iVar11 + 1;
    } while (iVar11 < *(int *)(*(longlong *)(param_1 + 0x30) + 4) + -0xb);
  }
LAB_1800149f8:
  free(*(void **)(param_1 + 0x38));
  *(undefined8 *)(param_1 + 0x38) = 0;
  if (*(int *)(param_2 + 0x38) != 0) {
    uVar22 = iVar13 * 2;
  }
  iVar14 = uVar22 + iVar13;
  piVar5 = (int *)calloc(1,(longlong)(iVar14 * 0x58 + 0x20));
  piVar10 = piVar23;
  if (piVar5 != (int *)0x0) {
    piVar6 = piVar5 + 8 + (longlong)iVar14 * 2;
    *(int **)(piVar5 + 6) = piVar5 + 8;
    piVar7 = piVar23;
    piVar10 = piVar5;
    if (0 < iVar14) {
      do {
        piVar7 = (int *)((longlong)piVar7 + 1);
        *(int **)(*(longlong *)(piVar5 + 6) + -8 + (longlong)piVar7 * 8) = piVar6;
        piVar6 = piVar6 + 0x14;
      } while ((longlong)piVar7 < (longlong)iVar14);
    }
  }
  *piVar10 = iVar13;
  if (0 < iVar13) {
    puVar17 = (uint *)(_Memory + 2);
    do {
      if (0x1fff < *puVar17) {
        *puVar17 = 0x1fff;
      }
      puVar1 = puVar17 + -2;
      uVar22 = puVar17[-1];
      uVar18 = *puVar17;
      uVar8 = puVar17[1];
      piVar23 = (int *)((longlong)piVar23 + 1);
      puVar3 = *(uint **)(*(longlong *)(piVar10 + 6) + -8 + (longlong)piVar23 * 8);
      puVar17 = puVar17 + 4;
      *puVar3 = *puVar1;
      puVar3[1] = uVar22;
      puVar3[2] = uVar18;
      puVar3[3] = uVar8;
    } while ((longlong)piVar23 < (longlong)iVar13);
  }
  free(_Memory);
  return piVar10;
}



undefined8 FUN_180014b40(longlong param_1,int param_2,int param_3,int *param_4,int *param_5)

{
  longlong lVar1;
  longlong lVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  longlong lVar9;
  int iVar10;
  uint uVar11;
  longlong lVar12;
  
  lVar9 = (longlong)param_3;
  lVar12 = (longlong)param_2;
  lVar1 = *(longlong *)(param_1 + lVar12 * 8);
  lVar2 = *(longlong *)(param_1 + -8 + lVar12 * 8);
  lVar12 = *(longlong *)(param_1 + 8 + lVar12 * 8);
  iVar3 = *(int *)(lVar1 + -4 + lVar9 * 4);
  iVar4 = *(int *)(lVar2 + lVar9 * 4);
  iVar5 = *(int *)(lVar1 + lVar9 * 4);
  iVar6 = iVar3 + iVar5 * -2 + *(int *)(lVar1 + 4 + lVar9 * 4);
  iVar3 = ((*(int *)(lVar1 + 4 + lVar9 * 4) - iVar3) + 1) / 2;
  iVar10 = iVar4 + iVar5 * -2 + *(int *)(lVar12 + lVar9 * 4);
  iVar4 = ((*(int *)(lVar12 + lVar9 * 4) - iVar4) + 1) / 2;
  iVar5 = *(int *)(lVar2 + -4 + lVar9 * 4) + 2 +
          ((*(int *)(lVar12 + 4 + lVar9 * 4) - *(int *)(lVar2 + 4 + lVar9 * 4)) -
          *(int *)(lVar12 + -4 + lVar9 * 4));
  iVar5 = (int)(iVar5 + (iVar5 >> 0x1f & 3U)) >> 2;
  uVar8 = iVar5 * iVar5 - iVar10 * iVar6;
  if (uVar8 != 0) {
    uVar11 = iVar10 * iVar3 - iVar5 * iVar4;
    uVar7 = iVar6 * iVar4 - iVar5 * iVar3;
    iVar3 = (uVar8 ^ (int)uVar8 >> 0x1f) - ((int)uVar8 >> 0x1f);
    if (((int)((uVar11 ^ (int)uVar11 >> 0x1f) - ((int)uVar11 >> 0x1f)) <= iVar3) &&
       ((int)((uVar7 ^ (int)uVar7 >> 0x1f) - ((int)uVar7 >> 0x1f)) <= iVar3)) {
      iVar3 = (int)uVar8 >> 0x10;
      if (iVar3 != 0) {
        *param_4 = (int)(iVar3 / 2 + uVar11) / iVar3;
        *param_5 = (int)(iVar3 / 2 + uVar7) / iVar3;
        return 1;
      }
      *param_5 = 0;
      *param_4 = 0;
      return 1;
    }
  }
  return 0;
}



void FUN_180014c80(int *param_1,longlong param_2)

{
  int iVar1;
  void *pvVar2;
  undefined8 uVar3;
  int iVar4;
  ulonglong uVar5;
  uint uVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  int local_res8 [2];
  int local_res10 [2];
  longlong local_res18;
  longlong local_res20;
  
  local_res20 = *(longlong *)(param_2 + 0x30);
  uVar5 = 0;
  iVar4 = 0;
  if (*param_1 != 0) {
    pvVar2 = malloc((longlong)*param_1 << 2);
    *(void **)(param_2 + 0x48) = pvVar2;
    pvVar2 = malloc((longlong)*param_1 << 2);
    *(void **)(param_2 + 0x50) = pvVar2;
    if (0 < *param_1) {
      local_res18 = 0;
      uVar7 = uVar5;
      uVar8 = uVar5;
      uVar10 = uVar5;
      do {
        iVar4 = **(int **)(uVar7 + *(longlong *)(param_1 + 6));
        iVar1 = (*(int **)(uVar7 + *(longlong *)(param_1 + 6)))[1];
        uVar3 = FUN_180014b40(*(longlong *)(local_res20 + 8),iVar1,iVar4,local_res8,local_res10);
        uVar9 = uVar8;
        if ((int)uVar3 != 0) {
          *(int *)(local_res18 + *(longlong *)(param_2 + 0x48)) = iVar4 * 0x10000 + local_res8[0];
          *(int *)(local_res18 + *(longlong *)(param_2 + 0x50)) = iVar1 * 0x10000 + local_res10[0];
          uVar10 = (ulonglong)((int)uVar10 + 1);
          *(undefined2 *)(*(longlong *)(uVar8 + *(longlong *)(param_1 + 6)) + 0xe) = 0;
          uVar9 = uVar8 + 8;
          *(undefined4 *)(*(longlong *)(uVar8 + *(longlong *)(param_1 + 6)) + 8) =
               *(undefined4 *)(*(longlong *)(uVar7 + *(longlong *)(param_1 + 6)) + 8);
          *(undefined *)(*(longlong *)(uVar8 + *(longlong *)(param_1 + 6)) + 0xc) =
               *(undefined *)(*(longlong *)(uVar7 + *(longlong *)(param_1 + 6)) + 0xc);
          local_res18 = local_res18 + 4;
        }
        iVar4 = (int)uVar10;
        uVar6 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar6;
        uVar7 = uVar7 + 8;
        uVar8 = uVar9;
      } while ((int)uVar6 < *param_1);
    }
    *param_1 = iVar4;
  }
  return;
}



int FUN_180014df0(uint param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = (param_2 ^ (int)param_2 >> 0x1f) - ((int)param_2 >> 0x1f);
  uVar2 = (param_1 ^ (int)param_1 >> 0x1f) - ((int)param_1 >> 0x1f);
  if (uVar3 == 0) {
    iVar1 = 0x10e;
    if (0 < (int)param_1) {
      iVar1 = 0x5a;
    }
    return iVar1;
  }
  if (uVar2 == 0) {
    iVar1 = 0xb4;
    if (0 < (int)param_2) {
      iVar1 = 0;
    }
    return iVar1;
  }
  if (uVar3 < uVar2) {
    uVar2 = 0x2d0 - *(ushort *)
                     (&DAT_1800433c0 +
                     ((ulonglong)((uVar2 >> 1) + uVar3 * 0x80) / (ulonglong)uVar2) * 2);
  }
  else {
    uVar2 = (uint)*(ushort *)
                   (&DAT_1800433c0 +
                   ((ulonglong)((uVar3 >> 1) + uVar2 * 0x80) / (ulonglong)uVar3) * 2);
  }
  if ((int)param_2 < 1) {
    iVar1 = 0x5a0;
    if ((int)param_1 < 0) {
      return (int)(uVar2 + 0x5a4) >> 3;
    }
  }
  else {
    if (-1 < (int)param_1) goto LAB_180014ea0;
    if ((int)uVar2 < 5) {
      return 0;
    }
    iVar1 = 0xb40;
  }
  uVar2 = iVar1 - uVar2;
LAB_180014ea0:
  return (int)(uVar2 + 4) >> 3;
}



void FUN_180014ec0(short *param_1,longlong *param_2,int param_3,longlong param_4,uint param_5,
                  longlong param_6)

{
  undefined8 *puVar1;
  undefined8 *puVar2;
  longlong lVar3;
  longlong lVar4;
  short sVar5;
  ushort uVar6;
  uint uVar7;
  undefined8 *_Memory;
  uint uVar8;
  int iVar9;
  longlong lVar10;
  int iVar11;
  uint uVar12;
  short sVar13;
  int iVar14;
  uint uVar15;
  int iVar16;
  short sVar17;
  longlong lVar18;
  uint uVar19;
  short sVar20;
  short sVar21;
  longlong lVar22;
  uint auStack132136 [124];
  uint auStack131640 [32620];
  undefined auStack1160 [36];
  int local_464;
  uint local_460;
  uint local_45c;
  uint local_458;
  longlong local_450;
  short *local_448;
  longlong local_440;
  longlong local_438;
  uint auStack1064 [124];
  uint auStack568 [124];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)auStack1160;
  sVar20 = *param_1;
  lVar18 = 0;
  lVar22 = *(longlong *)(*param_2 + 8);
  lVar10 = *(longlong *)(param_2[1] + 8);
  iVar14 = param_3 * 5 + (int)param_1[2];
  local_45c = 0;
  local_458 = *(int *)(param_6 + 0x34) * *(int *)(param_6 + 0x34);
  local_464 = -1;
  uVar15 = param_5 & 0xff;
  sVar21 = 0;
  sVar13 = (short)param_3;
  sVar17 = param_1[2] + sVar13 * -5;
  local_450 = lVar10;
  local_448 = param_1;
  local_440 = param_4;
  local_438 = lVar22;
  if (sVar17 <= iVar14) {
    local_460 = uVar15;
    do {
      lVar3 = *(longlong *)(lVar10 + (longlong)sVar17 * 8);
      lVar4 = *(longlong *)(lVar22 + (longlong)sVar17 * 8);
      uVar7 = SEXT24((short)(sVar20 + sVar13 * -5));
      uVar15 = local_460;
      uVar8 = uVar7;
      while (local_460 = uVar15, (int)uVar8 <= (int)sVar20 + param_3 * 5) {
        sVar5 = (short)uVar7;
        uVar6 = sVar5 + sVar13;
        uVar7 = (uint)uVar6;
        lVar22 = (longlong)sVar5 * 4;
        lVar10 = (longlong)sVar21;
        sVar21 = sVar21 + 1;
        auStack568[lVar10] =
             *(int *)(lVar22 + lVar4) * *(int *)((longlong)&DAT_1800431d0 + lVar10 * 4);
        auStack1064[lVar10] =
             *(int *)(lVar22 + lVar3) * *(int *)((longlong)&DAT_1800431d0 + lVar10 * 4);
        lVar10 = local_450;
        lVar22 = local_438;
        uVar15 = local_460;
        uVar8 = SEXT24((short)uVar6);
      }
      sVar17 = sVar17 + sVar13;
    } while (sVar17 <= iVar14);
  }
  param_5._0_1_ = (byte)(param_5 >> 0x10);
  local_460 = 0x168 >> ((byte)param_5 & 0x1f);
  iVar16 = (int)uVar15 >> ((byte)param_5 & 0x1f);
  iVar14 = iVar16 + local_460;
  _Memory = (undefined8 *)calloc((longlong)(iVar14 * 2),4);
  lVar22 = 0x79;
  puVar1 = (undefined8 *)((longlong)_Memory + (longlong)iVar14 * 4);
  do {
    uVar15 = *(uint *)((longlong)auStack568 + lVar18);
    if ((uVar15 != 0) || (*(int *)((longlong)auStack1064 + lVar18) != 0)) {
      uVar7 = *(uint *)((longlong)auStack1064 + lVar18);
      iVar14 = FUN_180014df0(uVar7,uVar15);
      lVar10 = (longlong)(short)(iVar14 >> ((byte)param_5 & 0x1f));
      puVar2 = (undefined8 *)((longlong)_Memory + lVar10 * 4);
      *(uint *)puVar2 = *(int *)puVar2 + uVar15;
      puVar2 = (undefined8 *)((longlong)puVar1 + lVar10 * 4);
      *(uint *)puVar2 = *(int *)puVar2 + uVar7;
    }
    iVar14 = local_460;
    lVar18 = lVar18 + 4;
    lVar22 = lVar22 + -1;
  } while (lVar22 != 0);
  lVar22 = (longlong)(int)local_460;
  FUN_18001d320((undefined8 *)(lVar22 * 4 + (longlong)_Memory),_Memory,(longlong)iVar16 << 2);
  FUN_18001d320((undefined8 *)(lVar22 * 4 + (longlong)puVar1),puVar1,(longlong)iVar16 << 2);
  uVar15 = 0;
  uVar8 = 0;
  uVar19 = 0;
  sVar20 = 1 - (short)iVar16;
  uVar7 = 0;
  if (0 < iVar14 + iVar16) {
    sVar21 = (short)iVar16 + -1 + sVar20;
    uVar7 = 0;
    do {
      uVar19 = uVar19 + *(int *)((longlong)_Memory + (longlong)sVar21 * 4);
      uVar8 = uVar8 + *(int *)((longlong)puVar1 + (longlong)sVar21 * 4);
      if (-1 < sVar20) {
        iVar11 = -0x1000;
        if (-1 < (int)uVar19) {
          iVar11 = 0x1000;
        }
        iVar9 = (int)(((int)(iVar11 + uVar19) >> 0x1f & 0x1fffU) + iVar11 + uVar19) >> 0xd;
        iVar11 = -0x1000;
        if (-1 < (int)uVar8) {
          iVar11 = 0x1000;
        }
        iVar11 = (int)(((int)(iVar11 + uVar8) >> 0x1f & 0x1fffU) + iVar11 + uVar8) >> 0xd;
        uVar12 = iVar11 * iVar11 + iVar9 * iVar9;
        if (local_440 != 0) {
          lVar22 = (longlong)sVar20;
          *(uint *)(local_440 + lVar22 * 0xc) = uVar19;
          *(uint *)(local_440 + 4 + lVar22 * 0xc) = uVar8;
          *(uint *)(local_440 + 8 + lVar22 * 0xc) = uVar12;
        }
        if (uVar7 < uVar12) {
          local_464 = (int)sVar20;
          uVar15 = uVar19;
          uVar7 = uVar12;
          local_45c = uVar8;
        }
        uVar19 = uVar19 - *(int *)((longlong)_Memory + (longlong)sVar20 * 4);
        uVar8 = uVar8 - *(int *)((longlong)puVar1 + (longlong)sVar20 * 4);
      }
      sVar21 = sVar21 + 1;
      sVar20 = sVar20 + 1;
    } while ((int)sVar21 < iVar14 + iVar16);
  }
  free(_Memory);
  if ((((int)local_458 < 1) || (local_458 <= uVar7)) && ((uVar15 != 0 || (local_45c != 0)))) {
    iVar14 = FUN_180014df0(local_45c,uVar15);
    sVar20 = (short)iVar14;
  }
  else {
    sVar20 = -1;
  }
  local_448[7] = sVar20;
  FUN_18001d2f0(local_48 ^ (ulonglong)auStack1160);
  return;
}



undefined8
FUN_180015200(longlong param_1,int param_2,int param_3,int param_4,int param_5,int param_6,
             int **param_7,longlong param_8)

{
  longlong lVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  ulonglong uVar7;
  longlong lVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  ulonglong uVar17;
  int iVar18;
  int iVar19;
  longlong lVar20;
  int iVar21;
  int iVar22;
  int iVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  int iVar27;
  int *local_68;
  longlong local_60;
  
  iVar2 = *(int *)(param_8 + 0x10);
  lVar20 = (longlong)*(int *)(param_8 + 0xc);
  piVar3 = *param_7;
  iVar21 = -iVar2;
  if (SBORROW4(iVar21,iVar2) != iVar2 * -2 < 0) {
    piVar4 = param_7[1];
    piVar5 = param_7[2];
    lVar8 = 0;
    iVar14 = iVar21 * param_6;
    iVar12 = iVar21 * param_5;
    local_60 = 0;
    iVar24 = iVar21;
    do {
      if (iVar21 < iVar2) {
        local_68 = (int *)(param_1 + 8 + lVar8 * 4);
        iVar9 = iVar21 * param_5 + iVar14 + param_4;
        iVar18 = (iVar12 - iVar21 * param_6) + param_3;
        iVar16 = iVar21;
        iVar22 = iVar21;
        do {
          iVar22 = iVar22 + param_2;
          iVar26 = 0;
          iVar13 = 0;
          iVar27 = 0;
          iVar15 = 0;
          if (iVar24 + param_2 <= iVar24) {
            return 0xffffffff;
          }
          uVar7 = (ulonglong)(uint)((iVar24 + param_2) - iVar24);
          iVar11 = iVar9;
          iVar19 = iVar18;
          do {
            if (iVar16 < iVar22) {
              uVar17 = (ulonglong)(uint)(iVar22 - iVar16);
              iVar23 = iVar11;
              iVar25 = iVar19;
              do {
                iVar6 = (int)((0 < iVar23) + 0x7fff + iVar23) >> 0x10;
                iVar10 = (int)((0 < iVar25) + 0x7fff + iVar25) >> 0x10;
                if ((((-1 < iVar10) && (-1 < iVar6)) && (iVar10 < *piVar3)) && (iVar6 < piVar3[1]))
                {
                  lVar8 = (longlong)iVar10 * 4;
                  lVar1 = (longlong)iVar6 * 8;
                  iVar26 = iVar26 + *(int *)(*(longlong *)
                                              (*(longlong *)(piVar3 + 2) + (longlong)iVar6 * 8) +
                                            lVar8);
                  if (1 < lVar20) {
                    iVar6 = *(int *)(lVar8 + *(longlong *)(*(longlong *)(piVar4 + 2) + lVar1));
                    iVar10 = *(int *)(lVar8 + *(longlong *)(*(longlong *)(piVar5 + 2) + lVar1));
                    if (lVar20 == 2) {
                      iVar13 = iVar13 + iVar6 * iVar6 + iVar10 * iVar10;
                    }
                    else {
                      iVar13 = iVar13 + iVar6;
                      iVar27 = iVar27 + iVar10;
                    }
                  }
                  iVar15 = iVar15 + 1;
                }
                iVar23 = iVar23 + param_5;
                iVar25 = iVar25 - param_6;
                uVar17 = uVar17 - 1;
              } while (uVar17 != 0);
            }
            iVar11 = iVar11 + param_6;
            iVar19 = iVar19 + param_5;
            uVar7 = uVar7 - 1;
          } while (uVar7 != 0);
          if (iVar15 < 0xc) {
            return 0xffffffff;
          }
          if (lVar20 == 3) {
            iVar19 = (int)((0 < iVar13) + 7 + iVar13) >> 4;
            iVar11 = (int)((0 < iVar27) + 7 + iVar27) >> 4;
            iVar27 = iVar11 * param_6;
            iVar13 = iVar19 * param_5;
            iVar19 = iVar19 * param_6;
            iVar11 = iVar11 * param_5;
            iVar13 = (int)((0 < iVar13 + iVar27) + 0x7ff + iVar13 + iVar27) >> 0xc;
            iVar27 = (int)((((0 < iVar11 - iVar19) + 0x7ff) - iVar19) + iVar11) >> 0xc;
          }
          local_68[-2] = iVar26 / iVar15;
          if (1 < lVar20) {
            local_68[-1] = iVar13 / iVar15;
          }
          if (2 < lVar20) {
            *local_68 = iVar27 / iVar15;
          }
          iVar9 = iVar9 + param_2 * param_5;
          iVar18 = iVar18 - param_2 * param_6;
          iVar16 = iVar16 + param_2;
          local_68 = local_68 + lVar20;
          lVar8 = local_60 + lVar20;
          local_60 = lVar8;
        } while (iVar16 < iVar2);
      }
      iVar24 = iVar24 + param_2;
      iVar14 = iVar14 + param_2 * param_6;
      iVar12 = iVar12 + param_2 * param_5;
    } while (iVar24 < iVar2);
  }
  return 1;
}



void FUN_180015600(longlong param_1,int **param_2,int param_3,int param_4,longlong param_5)

{
  byte *pbVar1;
  byte bVar2;
  undefined8 uVar3;
  longlong lVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  longlong lVar8;
  int iVar9;
  int *piVar10;
  longlong lVar11;
  int *piVar12;
  longlong lVar13;
  longlong lVar14;
  longlong lVar15;
  int *piVar16;
  int local_168;
  int local_164;
  int local_160;
  int local_15c;
  int local_158;
  longlong local_150;
  longlong local_148;
  longlong local_140;
  int **local_138;
  longlong local_130;
  int local_128 [4];
  int local_118 [48];
  ulonglong local_58;
  
  local_58 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffe58;
  iVar7 = 0;
  local_160 = *(int *)((longlong)&DAT_180042100 + (longlong)*(short *)(param_1 + 0xe) * 4);
  local_158 = *(int *)((longlong)&DAT_180041b60 + (longlong)*(short *)(param_1 + 0xe) * 4);
  local_140 = param_5;
  local_128[0] = 0x4000;
  local_128[1] = 0x2aab;
  local_128[2] = 0x2000;
  local_150 = 0;
  local_168 = 2;
  local_164 = param_4;
  local_15c = param_3;
  local_148 = param_1;
  local_138 = param_2;
  do {
    iVar9 = local_168 * local_168;
    iVar5 = local_128[local_150] * *(int *)(param_5 + 0x10);
    iVar6 = iVar5 >> 0xe;
    if (iVar6 * 0x4000 < iVar5) {
      iVar6 = iVar6 + 1;
    }
    uVar3 = FUN_180015200((longlong)local_118,iVar6,local_15c,local_164,local_160,local_158,
                          local_138,param_5);
    if ((int)uVar3 < 1) {
      *(undefined2 *)(local_148 + 0xe) = 0xffff;
      break;
    }
    local_130 = (longlong)*(int *)(param_5 + 0xc);
    lVar8 = (longlong)iVar9;
    if (0 < local_130) {
      piVar16 = local_118;
      lVar14 = local_130;
      do {
        if (0 < lVar8) {
          lVar13 = 1;
          piVar10 = piVar16;
          lVar15 = lVar8;
          do {
            iVar5 = *piVar10;
            if (lVar13 < lVar8) {
              lVar4 = lVar8 - lVar13;
              piVar12 = piVar10;
              do {
                piVar12 = piVar12 + local_130;
                lVar11 = (longlong)iVar7;
                bVar2 = (byte)iVar7;
                iVar7 = iVar7 + 1;
                pbVar1 = (byte *)((lVar11 >> 3) + 0x10 + local_148);
                *pbVar1 = *pbVar1 | (*piVar12 < iVar5) << (bVar2 & 7);
                lVar4 = lVar4 + -1;
              } while (lVar4 != 0);
            }
            piVar10 = piVar10 + local_130;
            lVar13 = lVar13 + 1;
            lVar15 = lVar15 + -1;
          } while (lVar15 != 0);
        }
        piVar16 = piVar16 + 1;
        lVar14 = lVar14 + -1;
        param_5 = local_140;
      } while (lVar14 != 0);
    }
    local_150 = local_150 + 1;
    local_168 = local_168 + 1;
  } while (local_150 < 3);
  FUN_18001d2f0(local_58 ^ (ulonglong)&stack0xfffffffffffffe58);
  return;
}



void FUN_180015800(int *param_1,longlong *param_2,longlong param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  void *pvVar11;
  longlong lVar12;
  uint *puVar13;
  undefined4 *puVar14;
  uint uVar15;
  void *pvVar16;
  undefined4 *puVar17;
  uint uVar18;
  int *piVar20;
  longlong lVar21;
  longlong lVar22;
  int iVar23;
  uint uVar24;
  short sVar25;
  int iVar26;
  void *pvVar28;
  int iVar29;
  int local_res8;
  int local_res10;
  int local_res20;
  int local_94;
  longlong local_88;
  int *local_68;
  longlong local_60;
  longlong local_58;
  void *pvVar19;
  void *pvVar27;
  
  pvVar19 = (void *)0x0;
  iVar29 = 0;
  piVar20 = **(int ***)(param_1 + 6);
  local_68 = (int *)param_2[5];
  local_60 = *param_2;
  local_58 = param_2[1];
  iVar26 = 2;
  if (*(int *)(param_3 + 0x10) < 7) {
    iVar26 = 1;
  }
  uVar18 = *(int *)(param_3 + 0x3c) / 10;
  uVar15 = 0;
  iVar23 = *(int *)(param_3 + 0x3c) % 10;
  if (uVar18 == 0) {
    uVar18 = 0x40;
  }
  pvVar11 = pvVar19;
  for (iVar8 = iVar23; 1 < iVar8; iVar8 = iVar8 >> 1) {
    uVar15 = (int)pvVar11 + 1;
    pvVar11 = (void *)(ulonglong)uVar15;
  }
  if (*(int *)(param_3 + 0x38) == 0) {
    local_res10 = (int)param_2;
    local_res20 = local_res10;
    pvVar11 = pvVar19;
    iVar8 = local_res10;
  }
  else {
    local_res20 = (int)(uVar18 + 0x168) / iVar23;
    pvVar11 = malloc((longlong)local_res20 * 0xc);
    local_res10 = *param_1;
    iVar8 = local_res10 * 3;
  }
  local_94 = 0;
  if (0 < *param_1) {
    local_88 = (longlong)local_res10;
    pvVar28 = pvVar19;
    local_res8 = local_res10;
    do {
      *piVar20 = (int)((uint)(0 < *(int *)((longlong)pvVar28 + param_2[9])) +
                      *(int *)((longlong)pvVar28 + param_2[9]) + 0x7fff) >> 0x10;
      piVar20[1] = (int)((uint)(0 < *(int *)((longlong)pvVar28 + param_2[10])) +
                        *(int *)((longlong)pvVar28 + param_2[10]) + 0x7fff) >> 0x10;
      iVar9 = FUN_180014ec0((short *)piVar20,param_2,iVar26,(longlong)pvVar11,
                            iVar23 * 0x100 | uVar18 | uVar15 << 0x10,param_3);
      lVar21 = (longlong)iVar9;
      if (-1 < *(short *)((longlong)piVar20 + 0xe)) {
        FUN_180015600((longlong)piVar20,&local_68,*(int *)((longlong)pvVar28 + param_2[9]),
                      *(int *)((longlong)pvVar28 + param_2[10]),param_3);
        iVar9 = *(int *)(param_3 + 0x38);
        if ((iVar9 != 0) && (local_88 < iVar8)) {
          lVar22 = (longlong)local_res20;
          iVar1 = *(int *)((longlong)pvVar11 + lVar21 * 0xc + 8);
          do {
            pvVar27 = (void *)0xffffffff;
            sVar25 = -1;
            lVar12 = 0x41;
            lVar21 = (longlong)((int)(short)lVar21 - (int)(0x20 / (longlong)iVar23));
            puVar14 = (undefined4 *)((longlong)pvVar11 + lVar21 * 0xc + 8);
            do {
              if (lVar21 < 0) {
                lVar21 = lVar21 + lVar22;
                puVar14 = puVar14 + lVar22 * 3;
              }
              if (lVar22 <= lVar21) {
                lVar21 = lVar21 - lVar22;
                puVar14 = puVar14 + lVar22 * -3;
              }
              *puVar14 = 0;
              puVar14 = puVar14 + 3;
              lVar21 = lVar21 + 1;
              lVar12 = lVar12 + -1;
            } while (lVar12 != 0);
            if (0 < lVar22) {
              puVar13 = (uint *)((longlong)pvVar11 + 8);
              pvVar16 = pvVar19;
              lVar21 = lVar22;
              uVar24 = (uint)(iVar1 * iVar9) >> 10;
              do {
                if (uVar24 <= *puVar13) {
                  pvVar27 = pvVar16;
                  uVar24 = *puVar13;
                }
                sVar25 = (short)pvVar27;
                pvVar16 = (void *)(ulonglong)((int)pvVar16 + 1);
                puVar13 = puVar13 + 3;
                lVar21 = lVar21 + -1;
              } while (lVar21 != 0);
            }
            lVar21 = (longlong)sVar25;
            if (sVar25 < 0) break;
            local_res8 = local_res8 + 1;
            piVar2 = *(int **)(*(longlong *)(param_1 + 6) + local_88 * 8);
            local_88 = local_88 + 1;
            iVar10 = piVar20[1];
            iVar3 = piVar20[2];
            iVar4 = piVar20[3];
            puVar13 = (uint *)((longlong)pvVar11 + lVar21 * 0xc);
            *piVar2 = *piVar20;
            piVar2[1] = iVar10;
            piVar2[2] = iVar3;
            piVar2[3] = iVar4;
            iVar10 = FUN_180014df0(puVar13[1],*puVar13);
            *(short *)((longlong)piVar2 + 0xe) = (short)iVar10;
            FUN_180015600((longlong)piVar2,&local_68,*(int *)((longlong)pvVar28 + param_2[9]),
                          *(int *)((longlong)pvVar28 + param_2[10]),param_3);
          } while (local_88 != iVar8);
        }
      }
      local_94 = local_94 + 1;
      piVar20 = piVar20 + 0x14;
      pvVar28 = (void *)((longlong)pvVar28 + 4);
      local_res10 = local_res8;
    } while (local_94 < *param_1);
  }
  if (pvVar11 != (void *)0x0) {
    *param_1 = local_res10;
    free(pvVar11);
  }
  puVar14 = (undefined4 *)**(undefined8 **)(param_1 + 6);
  puVar17 = puVar14;
  pvVar11 = pvVar19;
  if (0 < *param_1) {
    do {
      if (*(short *)((longlong)puVar14 + 0xe) < 0) {
        pvVar11 = (void *)(ulonglong)((int)pvVar11 + 1);
      }
      else {
        if (puVar17 != puVar14) {
          uVar5 = puVar14[1];
          uVar6 = puVar14[2];
          uVar7 = puVar14[3];
          *puVar17 = *puVar14;
          puVar17[1] = uVar5;
          puVar17[2] = uVar6;
          puVar17[3] = uVar7;
          uVar5 = puVar14[5];
          uVar6 = puVar14[6];
          uVar7 = puVar14[7];
          puVar17[4] = puVar14[4];
          puVar17[5] = uVar5;
          puVar17[6] = uVar6;
          puVar17[7] = uVar7;
          uVar5 = puVar14[9];
          uVar6 = puVar14[10];
          uVar7 = puVar14[0xb];
          puVar17[8] = puVar14[8];
          puVar17[9] = uVar5;
          puVar17[10] = uVar6;
          puVar17[0xb] = uVar7;
          uVar5 = puVar14[0xd];
          uVar6 = puVar14[0xe];
          uVar7 = puVar14[0xf];
          puVar17[0xc] = puVar14[0xc];
          puVar17[0xd] = uVar5;
          puVar17[0xe] = uVar6;
          puVar17[0xf] = uVar7;
          uVar5 = puVar14[0x11];
          uVar6 = puVar14[0x12];
          uVar7 = puVar14[0x13];
          puVar17[0x10] = puVar14[0x10];
          puVar17[0x11] = uVar5;
          puVar17[0x12] = uVar6;
          puVar17[0x13] = uVar7;
        }
        puVar17 = puVar17 + 0x14;
      }
      iVar29 = (int)pvVar11;
      uVar18 = (int)pvVar19 + 1;
      pvVar19 = (void *)(ulonglong)uVar18;
      puVar14 = puVar14 + 0x14;
    } while ((int)uVar18 < *param_1);
  }
  *param_1 = *param_1 - iVar29;
  return;
}



int * FUN_180015c40(uint **param_1,int *param_2)

{
  undefined8 uVar1;
  int *piVar2;
  
  uVar1 = FUN_180014660(param_1,param_2);
  if ((int)uVar1 != 0) {
    return (int *)0x0;
  }
  piVar2 = FUN_1800147f0((longlong)param_1,(longlong)param_2);
  if (piVar2 == (int *)0x0) {
    return (int *)0x0;
  }
  FUN_180014c80(piVar2,(longlong)param_1);
  if (param_1[6] != (uint *)0x0) {
    free(param_1[6]);
  }
  param_1[6] = (uint *)0x0;
  FUN_180015800(piVar2,(longlong *)param_1,(longlong)param_2);
  if (param_1[9] != (uint *)0x0) {
    free(param_1[9]);
  }
  if (param_1[10] != (uint *)0x0) {
    free(param_1[10]);
  }
  return piVar2;
}



undefined8 FUN_180015cf0(longlong *param_1,int param_2,uint param_3,int **param_4,int *param_5)

{
  undefined uVar1;
  int iVar2;
  undefined uVar3;
  int iVar4;
  byte **_Memory;
  undefined (*pauVar5) [16];
  ulonglong uVar6;
  uint **ppuVar7;
  uint *puVar8;
  int *piVar9;
  undefined *puVar10;
  int *piVar11;
  undefined8 uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  undefined4 in_stack_ffffffffffffffc0;
  undefined4 in_stack_ffffffffffffffc8;
  
  uVar3 = 0x80;
  if (param_5[0xb] == 1) {
    FUN_180012980(param_1,param_2,param_3);
  }
  else {
    if (param_5[0xb] == 2) {
      FUN_1800122b0(param_1,param_2,param_3);
    }
  }
  iVar4 = param_5[5] * param_2;
  uVar14 = (int)((uint)(0 < iVar4) + iVar4 + 0x1ff) >> 10;
  iVar4 = param_5[5] * param_3;
  uVar13 = (int)((uint)(0 < iVar4) + iVar4 + 0x1ff) >> 10;
  uVar15 = uVar13;
  _Memory = (byte **)FUN_180011390((longlong)param_1,param_2,param_3,uVar14,uVar13);
  if (param_5[0x27] != 0) {
    free(param_1);
  }
  pauVar5 = (undefined (*) [16])FUN_180007180(uVar14,uVar13);
  iVar4 = param_5[6];
  if (iVar4 < 1) {
    FUN_18001d980(*(undefined (**) [16])*pauVar5,0,(longlong)(int)(uVar13 * uVar14));
  }
  else {
    if (iVar4 == 1) {
      uVar3 = FUN_180011b40(_Memory,uVar14,uVar13,(undefined (**) [16])pauVar5);
    }
    else {
      if (iVar4 == 2) {
        uVar6 = FUN_180011d50((longlong *)_Memory,uVar14,uVar13,(undefined (**) [16])pauVar5,uVar15,
                              in_stack_ffffffffffffffc0,in_stack_ffffffffffffffc8);
        uVar3 = (undefined)uVar6;
      }
    }
  }
  if (param_5[7] == 1) {
    FUN_180011310(_Memory,uVar14,uVar13);
  }
  else {
    if (param_5[7] == 2) {
      FUN_180011650(_Memory,uVar14,uVar13);
    }
  }
  ppuVar7 = (uint **)calloc(1,0x58);
  *(uint *)(ppuVar7 + 8) = uVar14;
  *(uint *)((longlong)ppuVar7 + 0x44) = uVar13;
  ppuVar7[7] = (uint *)pauVar5;
  puVar8 = (uint *)FUN_18000ee50(uVar14,uVar13);
  FUN_180013120(**(ulonglong **)(puVar8 + 2),(ulonglong)*_Memory,uVar13 * uVar14);
  ppuVar7[5] = puVar8;
  free(_Memory);
  FUN_1800141e0((longlong)ppuVar7,param_5);
  piVar9 = FUN_180015c40(ppuVar7,param_5);
  if (param_4 != (int **)0x0) {
    *param_4 = piVar9;
  }
  if (piVar9 != (int *)0x0) {
    *(short *)(piVar9 + 1) = (short)uVar14;
    *(short *)((longlong)piVar9 + 6) = (short)uVar13;
    uVar1 = *(undefined *)(param_5 + 3);
    *(undefined *)((longlong)piVar9 + 9) = uVar3;
    *(undefined *)((longlong)piVar9 + 10) = 0;
    *(undefined *)(piVar9 + 2) = uVar1;
    if (param_5[2] != 0) {
      puVar10 = (undefined *)malloc((longlong)(int)(uVar13 * uVar14));
      iVar4 = 0;
      *(undefined **)(piVar9 + 4) = puVar10;
      puVar8 = ppuVar7[5];
      piVar11 = **(int ***)(puVar8 + 2);
      if (0 < (int)(puVar8[1] * *puVar8)) {
        do {
          iVar2 = *piVar11;
          iVar4 = iVar4 + 1;
          piVar11 = piVar11 + 1;
          *puVar10 = (char)((uint)(iVar2 * 0x7f8 + 0x8000) >> 0x10);
          puVar10 = puVar10 + 1;
        } while (iVar4 < (int)(puVar8[1] * *puVar8));
      }
    }
    if (*(longlong *)(param_5 + 0x28) != 0) {
      piVar11 = FUN_18000f100((int *)ppuVar7[5]);
      **(int ***)(param_5 + 0x28) = piVar11;
      piVar11 = FUN_18000f100((int *)*ppuVar7);
      *(int **)(*(longlong *)(param_5 + 0x28) + 8) = piVar11;
      piVar11 = FUN_18000f100((int *)ppuVar7[1]);
      *(int **)(*(longlong *)(param_5 + 0x28) + 0x10) = piVar11;
    }
  }
  FUN_180013090(ppuVar7);
  uVar12 = 0xfffffc18;
  if (piVar9 != (int *)0x0) {
    uVar12 = 0;
  }
  return uVar12;
}



int FUN_180015fa0(longlong param_1,longlong param_2,uint param_3)

{
  int iVar1;
  longlong lVar2;
  uint uVar3;
  longlong lVar4;
  int *piVar5;
  longlong lVar6;
  longlong lVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  undefined auVar13 [16];
  int iVar18;
  int iVar19;
  
  iVar9 = 0;
  iVar8 = 0;
  lVar7 = (longlong)(int)param_3;
  iVar15 = 0;
  iVar10 = 0;
  iVar12 = iVar10;
  if (((0 < (int)param_3) && (iVar12 = 0, 7 < param_3)) && (1 < DAT_180049300)) {
    uVar3 = param_3 & 0x80000007;
    if ((int)uVar3 < 0) {
      uVar3 = (uVar3 - 1 | 0xfffffff8) + 1;
    }
    iVar11 = 0;
    iVar14 = 0;
    iVar16 = 0;
    iVar18 = 0;
    iVar12 = iVar11;
    iVar15 = iVar14;
    iVar17 = iVar16;
    iVar19 = iVar18;
    do {
      lVar4 = (longlong)iVar10;
      iVar1 = iVar10 + 4;
      iVar10 = iVar10 + 8;
      auVar13 = pmulld(*(undefined (*) [16])(param_1 + lVar4 * 4),
                       *(undefined (*) [16])(param_2 + lVar4 * 4));
      iVar11 = SUB164(auVar13,0) + iVar11;
      iVar14 = SUB164(auVar13 >> 0x20,0) + iVar14;
      iVar16 = SUB164(auVar13 >> 0x40,0) + iVar16;
      iVar18 = SUB164(auVar13 >> 0x60,0) + iVar18;
      auVar13 = pmulld(*(undefined (*) [16])(param_1 + (longlong)iVar1 * 4),
                       *(undefined (*) [16])(param_2 + (longlong)iVar1 * 4));
      iVar12 = SUB164(auVar13,0) + iVar12;
      iVar15 = SUB164(auVar13 >> 0x20,0) + iVar15;
      iVar17 = SUB164(auVar13 >> 0x40,0) + iVar17;
      iVar19 = SUB164(auVar13 >> 0x60,0) + iVar19;
    } while (iVar10 < (int)(param_3 - uVar3));
    iVar15 = iVar12 + iVar11 + iVar17 + iVar16 + iVar15 + iVar14 + iVar19 + iVar18;
    iVar12 = iVar10;
  }
  lVar4 = (longlong)iVar12;
  if (lVar4 < lVar7) {
    if (1 < lVar7 - lVar4) {
      lVar2 = lVar4 * 4;
      lVar6 = ((lVar7 - lVar4) - 2U >> 1) + 1;
      lVar4 = lVar4 + lVar6 * 2;
      piVar5 = (int *)(param_2 + 4 + lVar2);
      do {
        iVar9 = iVar9 + *(int *)((param_1 - param_2) + -4 + (longlong)piVar5) * piVar5[-1];
        iVar8 = iVar8 + *(int *)((param_1 - param_2) + -8 + (longlong)(piVar5 + 2)) * *piVar5;
        lVar6 = lVar6 + -1;
        piVar5 = piVar5 + 2;
      } while (lVar6 != 0);
    }
    if (lVar4 < lVar7) {
      iVar15 = iVar15 + *(int *)(param_1 + lVar4 * 4) * *(int *)(param_2 + lVar4 * 4);
    }
    iVar15 = iVar8 + iVar9 + iVar15;
  }
  return iVar15;
}



ulonglong FUN_180016110(uint *param_1)

{
  uint uVar1;
  byte bVar2;
  int iVar3;
  int *_Memory;
  int *_Memory_00;
  longlong lVar4;
  longlong lVar5;
  longlong lVar6;
  ulonglong uVar7;
  ulonglong uVar8;
  int *piVar9;
  size_t _Count;
  size_t sVar10;
  int *piVar11;
  ulonglong uVar12;
  int iVar13;
  longlong lVar14;
  size_t sVar15;
  
  uVar1 = *param_1;
  _Memory = (int *)malloc((longlong)(int)(uVar1 * 4));
  _Count = SEXT48((int)param_1[1]);
  _Memory_00 = (int *)calloc(_Count,4);
  uVar7 = SEXT48((int)*param_1);
  lVar6 = *(longlong *)(param_1 + 10);
  iVar13 = 0;
  lVar4 = *(longlong *)(param_1 + 0xc);
  lVar5 = lVar6;
  if (0 < (int)*param_1) {
    lVar4 = *(longlong *)(param_1 + 6);
    lVar5 = *(longlong *)(param_1 + 8);
    piVar11 = _Memory;
    do {
      iVar3 = *(int *)((longlong)piVar11 + (lVar5 - (longlong)_Memory));
      if (iVar3 < 0) {
        bVar2 = (byte)(iVar3 >> 0x1f);
        *piVar11 = *(int *)((lVar4 - (longlong)_Memory) + (longlong)piVar11) >>
                   (((byte)iVar3 ^ bVar2) - bVar2 & 0x1f);
      }
      else {
        *piVar11 = *(int *)((lVar4 - (longlong)_Memory) + (longlong)piVar11) << ((byte)iVar3 & 0x1f)
        ;
      }
      piVar11 = piVar11 + 1;
      uVar7 = uVar7 - 1;
    } while (uVar7 != 0);
    uVar7 = (ulonglong)*param_1;
    lVar4 = *(longlong *)(param_1 + 0xc);
    lVar5 = *(longlong *)(param_1 + 10);
  }
  lVar14 = (longlong)(int)param_1[4];
  if (0 < lVar14) {
    piVar11 = *(int **)(param_1 + 2);
    sVar10 = 1;
    lVar4 = lVar4 - (longlong)piVar11;
    sVar15 = 1;
    piVar9 = _Memory_00;
    do {
      iVar3 = FUN_180015fa0(lVar5 + (longlong)iVar13 * 4,(longlong)_Memory,(uint)uVar7);
      iVar3 = iVar3 - *(int *)(lVar4 + (longlong)piVar11);
      *piVar11 = iVar3;
      if (iVar3 < 1) {
        _Memory_00[sVar10] = _Memory_00[sVar10] + 1;
      }
      else {
        *piVar9 = *piVar9 + 1;
      }
      sVar10 = sVar10 + 1;
      if (sVar10 == _Count) {
        piVar9 = piVar9 + 1;
        sVar10 = sVar15 + 1;
        sVar15 = sVar10;
      }
      uVar7 = (ulonglong)uVar1;
      piVar11 = piVar11 + 1;
      iVar13 = iVar13 + uVar1;
      lVar14 = lVar14 + -1;
      lVar5 = lVar6;
    } while (lVar14 != 0);
  }
  uVar7 = 0;
  uVar8 = 1;
  lVar6 = 1;
  uVar12 = uVar7;
  if (1 < (longlong)_Count) {
    do {
      if (_Memory_00[lVar6] != *(int *)(uVar12 + (longlong)_Memory_00) &&
          *(int *)(uVar12 + (longlong)_Memory_00) <= _Memory_00[lVar6]) {
        uVar7 = uVar8;
        uVar12 = lVar6 * 4;
      }
      lVar6 = lVar6 + 1;
      uVar8 = (ulonglong)((int)uVar8 + 1);
    } while (lVar6 < (longlong)_Count);
  }
  free(_Memory_00);
  free(_Memory);
  return uVar7;
}



undefined4 * FUN_1800162e0(void)

{
  undefined4 *puVar1;
  void *pvVar2;
  void *pvVar3;
  
  puVar1 = (undefined4 *)malloc(0x38);
  *puVar1 = 8;
  puVar1[1] = 6;
  puVar1[4] = 0xf;
  pvVar2 = malloc(0x3c);
  *(void **)(puVar1 + 2) = pvVar2;
  pvVar2 = malloc(0x20);
  *(void **)(puVar1 + 6) = pvVar2;
  pvVar3 = malloc(0x20);
  *(void **)(puVar1 + 8) = pvVar3;
  if ((pvVar2 != (void *)0x0) && (pvVar3 != (void *)0x0)) {
    return puVar1;
  }
  return (undefined4 *)0x0;
}



undefined8 FUN_180016360(void)

{
  return 0;
}



LPCRITICAL_SECTION FUN_180016370(LPCRITICAL_SECTION param_1,LPCWSTR param_2)

{
  int iVar1;
  HANDLE pvVar2;
  
  InitializeCriticalSection(param_1);
  *(undefined4 *)&param_1[1].OwningThread = 0;
  param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
  *(HANDLE *)&param_1[1].LockCount = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[1].LockSemaphore = pvVar2;
  pvVar2 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  param_1[2].OwningThread = (HANDLE)0x0;
  *(undefined8 *)&param_1[2].LockCount = 0;
  param_1[1].SpinCount = (ULONG_PTR)pvVar2;
  param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  param_1[2].LockSemaphore = (HANDLE)0x0;
  lstrcpyW((LPWSTR)&param_1[2].SpinCount,param_2);
  iVar1 = lstrlenW(param_2);
  FUN_1800012f0("u",0xe,(PUCHAR)param_2,iVar1 * 2,(PUCHAR)&param_1[0x1c].SpinCount);
  param_1[0x1d].LockSemaphore = (HANDLE)0x0;
  param_1[0x1d].SpinCount = 0;
  param_1[0x1e].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  *(undefined8 *)&param_1[0x1e].LockCount = 0;
  param_1[0x1e].OwningThread = &param_1[0x1c].SpinCount;
  param_1[0x1e].LockSemaphore = &DAT_18002d580;
  return param_1;
}



void FUN_180016470(LPCRITICAL_SECTION param_1)

{
  PRTL_CRITICAL_SECTION_DEBUG p_Var1;
  longlong lVar2;
  ULONG_PTR *pUVar3;
  HANDLE *ppvVar4;
  
  if (param_1[1].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    *(undefined4 *)&param_1[1].OwningThread = 1;
    SetEvent(*(HANDLE *)&param_1[1].LockCount);
    WaitForSingleObject(param_1[1].DebugInfo,0xffffffff);
    CloseHandle(param_1[1].DebugInfo);
    param_1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
  }
  CloseHandle(*(HANDLE *)&param_1[1].LockCount);
  DeleteCriticalSection(param_1);
  CloseHandle(param_1[1].LockSemaphore);
  CloseHandle((HANDLE)param_1[1].SpinCount);
  if (param_1[2].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    param_1[2].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  else {
    *(PRTL_CRITICAL_SECTION_DEBUG *)*(PRTL_CRITICAL_SECTION_DEBUG *)&param_1[2].LockCount =
         (PRTL_CRITICAL_SECTION_DEBUG)param_1[2].OwningThread;
  }
  p_Var1 = param_1[2].DebugInfo;
  while (p_Var1 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
    *(undefined8 *)&param_1[2].LockCount = *(undefined8 *)param_1[2].DebugInfo;
    LocalFree(param_1[2].DebugInfo);
    p_Var1 = *(PRTL_CRITICAL_SECTION_DEBUG *)&param_1[2].LockCount;
    param_1[2].DebugInfo = p_Var1;
  }
  pUVar3 = &param_1[0x1c].SpinCount;
  for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined *)pUVar3 = 0;
    pUVar3 = (ULONG_PTR *)((longlong)pUVar3 + 1);
  }
  if (*(HLOCAL *)&param_1[0x1e].LockCount != (HLOCAL)0x0) {
    FUN_180001b80(*(HLOCAL *)&param_1[0x1e].LockCount);
  }
  ppvVar4 = &param_1[0x1d].LockSemaphore;
  for (lVar2 = 0x30; lVar2 != 0; lVar2 = lVar2 + -1) {
    *(undefined *)ppvVar4 = 0;
    ppvVar4 = (HANDLE *)((longlong)ppvVar4 + 1);
  }
  return;
}



undefined FUN_180016560(longlong param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4,ULONG param_5,
                       ULONG *param_6)

{
  int *piVar1;
  bool bVar2;
  uint uVar3;
  
  piVar1 = *(int **)(param_1 + 0x18);
  uVar3 = FUN_180001b70((longlong)piVar1);
  if (param_3 + 0x42 <= uVar3 >> 3) {
    if ((param_4 != (PUCHAR)0x0) || (param_5 != 0)) {
      bVar2 = FUN_180001b90(piVar1,*(ULONG *)(param_1 + 0x10),param_2,param_3,param_4,param_5,
                            param_6);
      return bVar2;
    }
    if (param_6 != (ULONG *)0x0) {
      uVar3 = FUN_180001b70((longlong)piVar1);
      *param_6 = uVar3 >> 3;
      return 1;
    }
  }
  return 0;
}



void FUN_180016610(LPCRITICAL_SECTION *param_1)

{
  LPCRITICAL_SECTION p_Var1;
  
  if (*param_1 != (LPCRITICAL_SECTION)0x0) {
    PTR_FUN_180049018 = FUN_180016360;
    PTR_FUN_180049020 = FUN_180016360;
    p_Var1 = *param_1;
    if (p_Var1[1].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      *(undefined4 *)&p_Var1[1].OwningThread = 1;
      SetEvent(*(HANDLE *)&p_Var1[1].LockCount);
      WaitForSingleObject(p_Var1[1].DebugInfo,0xffffffff);
      CloseHandle(p_Var1[1].DebugInfo);
      p_Var1[1].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x0;
    }
    p_Var1 = *param_1;
    if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
      FUN_180016470(p_Var1);
      free(p_Var1);
    }
    *param_1 = (LPCRITICAL_SECTION)0x0;
  }
  return;
}



void FUN_1800166b0(LPCRITICAL_SECTION *param_1,LPCWSTR param_2)

{
  LPCRITICAL_SECTION p_Var1;
  LPCRITICAL_SECTION lpParameter;
  PRTL_CRITICAL_SECTION_DEBUG p_Var2;
  
  if (*param_1 == (LPCRITICAL_SECTION)0x0) {
    p_Var1 = (LPCRITICAL_SECTION)operator_new(0x4d0);
    lpParameter = (LPCRITICAL_SECTION)0x0;
    if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
      lpParameter = FUN_180016370(p_Var1,param_2);
    }
    *param_1 = lpParameter;
    if (lpParameter[1].DebugInfo == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      ResetEvent(*(HANDLE *)&lpParameter[1].LockCount);
      *(undefined4 *)&lpParameter[1].OwningThread = 0;
      p_Var2 = (PRTL_CRITICAL_SECTION_DEBUG)
               CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_180016cb0,lpParameter,0,(LPDWORD)0x0);
      lpParameter[1].DebugInfo = p_Var2;
      if (p_Var2 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
        p_Var1 = *param_1;
        if (p_Var1 != (LPCRITICAL_SECTION)0x0) {
          FUN_180016470(p_Var1);
          free(p_Var1);
        }
        *param_1 = (LPCRITICAL_SECTION)0x0;
      }
    }
  }
  return;
}



bool FUN_180016770(longlong param_1)

{
  wchar_t *lpBuffer;
  bool bVar1;
  int iVar2;
  LSTATUS LVar3;
  BOOL BVar4;
  uint *puVar5;
  uint *hMem;
  undefined8 uVar6;
  wchar_t *pwVar7;
  uint local_res8 [2];
  DWORD local_res10 [2];
  uint local_res18 [2];
  HKEY local_res20;
  
  bVar1 = true;
  local_res20 = (HKEY)0x0;
  iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),0,3,(PHKEY)&local_res20);
  if (iVar2 == 5) {
    iVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)(param_1 + 0x70),0,1,(PHKEY)&local_res20
                         );
  }
  if (iVar2 != 0) goto LAB_180016a5a;
  local_res10[0] = 3;
  local_res8[0] = 0;
  LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_180049000,(LPDWORD)0x0,
                           local_res10,(LPBYTE)0x0,local_res8);
  puVar5 = (uint *)0x0;
  if (((LVar3 == 0) || (LVar3 == 0xea)) && (local_res10[0] == 3)) {
    puVar5 = (uint *)LocalAlloc(0,(ulonglong)local_res8[0]);
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_180049000,(LPDWORD)0x0,
                             local_res10,(LPBYTE)puVar5,local_res8);
    if (LVar3 != 0) goto LAB_180016a05;
    local_res18[0] = FUN_1800028c0((int *)puVar5,(int *)0x0);
    if (local_res18[0] == 0) goto LAB_180016a05;
    hMem = (uint *)LocalAlloc(0,(ulonglong)local_res18[0]);
    if (hMem == (uint *)0x0) goto LAB_180016a05;
    uVar6 = FUN_1800028e0((int *)puVar5,(uint *)0x0,(uint *)0x0,hMem,local_res18,param_1 + 0x480);
    if ((int)uVar6 == 0) {
      LocalFree(hMem);
      goto LAB_180016a05;
    }
    LocalFree(puVar5);
    local_res8[0] = local_res18[0];
    iVar2 = FUN_1800033a0(hMem,local_res18[0]);
    puVar5 = hMem;
    if (iVar2 != 0) goto LAB_180016a05;
    local_res8[0] = 4;
    local_res10[0] = 4;
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogMask_180049008,(LPDWORD)0x0,
                             local_res10,(LPBYTE)(int *)(param_1 + 0x6c),local_res8);
    if ((LVar3 != 0) || (*(int *)(param_1 + 0x6c) == 0)) goto LAB_180016a05;
    lpBuffer = (wchar_t *)(param_1 + 0x278);
    local_res8[0] = 0x208;
    local_res10[0] = 1;
    LVar3 = RegQueryValueExW(local_res20,(LPCWSTR)PTR_u_SecurityLogPath_180049010,(LPDWORD)0x0,
                             local_res10,(LPBYTE)lpBuffer,local_res8);
    if (LVar3 == 0) {
      iVar2 = lstrlenW(lpBuffer);
      pwVar7 = (wchar_t *)(param_1 + 0x278 + (longlong)iVar2 * 2);
      if ((lpBuffer < pwVar7) && ((pwVar7[-1] == L'\\' || (pwVar7[-1] == L'/')))) {
        pwVar7[-1] = L'\0';
      }
    }
    else {
      GetSystemDirectoryW(lpBuffer,0x104);
      pwVar7 = wcschr(lpBuffer,L'\\');
      lstrcpyW(pwVar7,L"\\Temp2\\WBF");
    }
    BVar4 = PathFileExistsW(lpBuffer);
    if (BVar4 == 0) goto LAB_180016a05;
    PTR_FUN_180049018 = &LAB_180016760;
    PTR_FUN_180049020 = &DAT_180016a70;
    bVar1 = false;
  }
  else {
LAB_180016a05:
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogParameter_180049000);
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogMask_180049008);
    RegDeleteValueW(local_res20,(LPCWSTR)PTR_u_SecurityLogPath_180049010);
  }
  if (puVar5 != (uint *)0x0) {
    LocalFree(puVar5);
  }
  RegCloseKey(local_res20);
LAB_180016a5a:
  return !bVar1;
}



undefined8 FUN_180016cb0(LPCRITICAL_SECTION param_1)

{
  FUN_180016d40(param_1);
  return 0;
}



void FUN_180016d40(LPCRITICAL_SECTION param_1)

{
  bool bVar1;
  DWORD DVar2;
  undefined7 extraout_var;
  PRTL_CRITICAL_SECTION_DEBUG p_Var3;
  HANDLE local_38;
  HANDLE local_30;
  code *local_28;
  undefined *local_20;
  HANDLE *local_18;
  HANDLE *local_10;
  
  bVar1 = FUN_180016770((longlong)param_1);
  if (((int)CONCAT71(extraout_var,bVar1) != 0) && (*(longlong *)&param_1[0x1e].LockCount != 0)) {
    local_28 = FUN_180016560;
    local_20 = &LAB_180016cc0;
    local_18 = &param_1[0x1d].LockSemaphore;
    local_38 = *(HANDLE *)&param_1[1].LockCount;
    local_30 = param_1[1].LockSemaphore;
    local_10 = local_18;
    DVar2 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
    while (DVar2 == 1) {
      EnterCriticalSection(param_1);
      p_Var3 = param_1[2].DebugInfo;
      param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var3;
      LeaveCriticalSection(param_1);
      do {
        FUN_180003ab0(&local_28,&p_Var3->CriticalSection,&p_Var3[0xb].CriticalSection,
                      *(int *)(p_Var3 + 0xb),*(int *)&p_Var3[0xb].field_0x4);
        EnterCriticalSection(param_1);
        *(HANDLE *)p_Var3 = param_1[2].OwningThread;
        param_1[2].OwningThread = p_Var3;
        if (*(longlong *)p_Var3 == 0) {
          SetEvent((HANDLE)param_1[1].SpinCount);
        }
        p_Var3 = param_1[2].DebugInfo;
        if (p_Var3 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
          ResetEvent(param_1[1].LockSemaphore);
        }
        else {
          param_1[2].DebugInfo = *(PRTL_CRITICAL_SECTION_DEBUG *)p_Var3;
        }
        LeaveCriticalSection(param_1);
      } while ((p_Var3 != (PRTL_CRITICAL_SECTION_DEBUG)0x0) &&
              (*(int *)&param_1[1].OwningThread == 0));
      DVar2 = WaitForMultipleObjects(2,&local_38,0,0xffffffff);
    }
  }
  return;
}



undefined ** FUN_180016e90(undefined **param_1)

{
  param_1[1] = (undefined *)0x0;
  *param_1 = (undefined *)CSecureDataExchange::vftable;
  return param_1;
}



void FUN_180016eb0(undefined **param_1)

{
  SIZE_T SVar1;
  undefined *puVar2;
  
  *param_1 = (undefined *)CSecureDataExchange::vftable;
  if (param_1[1] != (undefined *)0x0) {
    SVar1 = LocalSize(param_1[1]);
    puVar2 = param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree(param_1[1]);
  }
  return;
}



undefined ** FUN_180016f00(undefined **param_1,uint param_2)

{
  SIZE_T SVar1;
  undefined *puVar2;
  
  *param_1 = (undefined *)CSecureDataExchange::vftable;
  if (param_1[1] != (undefined *)0x0) {
    SVar1 = LocalSize(param_1[1]);
    puVar2 = param_1[1];
    for (; SVar1 != 0; SVar1 = SVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    LocalFree(param_1[1]);
  }
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// WARNING: Type propagation algorithm not settling

void FUN_180016f70(longlong param_1,longlong *param_2,int param_3,undefined4 *param_4,int param_5,
                  undefined4 *param_6)

{
  int *piVar1;
  bool bVar2;
  int iVar3;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  undefined7 extraout_var_11;
  longlong lVar4;
  UCHAR *pUVar5;
  undefined *puVar6;
  undefined4 *puVar7;
  uint *puVar8;
  int *local_238;
  int local_230 [2];
  UCHAR local_228 [8];
  undefined4 local_220;
  undefined4 uStack540;
  undefined4 uStack536;
  undefined4 uStack532;
  undefined4 local_210;
  undefined4 uStack524;
  undefined4 uStack520;
  undefined4 uStack516;
  undefined4 local_200;
  undefined4 uStack508;
  undefined4 uStack504;
  undefined4 uStack500;
  undefined4 local_1f0;
  undefined4 uStack492;
  undefined4 uStack488;
  undefined4 uStack484;
  undefined4 local_1e0 [10];
  undefined local_1b8 [4];
  int local_1b4;
  int iStack432;
  int iStack428;
  int iStack424;
  int local_1a4;
  int iStack416;
  int iStack412;
  int iStack408;
  uint local_194 [8];
  undefined8 local_174;
  undefined4 uStack364;
  undefined4 uStack360;
  undefined4 local_164;
  undefined4 uStack352;
  undefined4 uStack348;
  undefined4 uStack344;
  UCHAR local_134 [64];
  undefined4 local_f4 [11];
  undefined4 local_c8;
  undefined4 uStack196;
  undefined4 uStack192;
  undefined4 uStack188;
  UCHAR local_b8 [16];
  UCHAR local_a8 [16];
  UCHAR local_98 [16];
  uint local_88;
  undefined4 uStack132;
  undefined4 uStack128;
  undefined4 uStack124;
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  UCHAR local_68 [16];
  UCHAR local_58 [16];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd88;
  if (((param_3 == 0xd0) && (param_5 == 0xd0)) &&
     (piVar1 = *(int **)(param_1 + 8), piVar1 != (int *)0x0)) {
    local_238 = piVar1;
    iVar3 = FUN_1800012f0((PUCHAR)&local_238,8,(PUCHAR)(piVar1 + 1),0x20,local_a8);
    if (iVar3 != 0) {
      bVar2 = thunk_FUN_180002170(local_a8,local_98,(uint *)(piVar1 + 9),local_194,0xc0);
      pUVar5 = local_a8;
      for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
        *pUVar5 = '\0';
        pUVar5 = pUVar5 + 1;
      }
      if ((int)CONCAT71(extraout_var,bVar2) != 0) {
        iVar3 = FUN_1800011b0((PUCHAR)&local_174,0x40,(PUCHAR)&local_c8);
        if (((iVar3 != 0) && (*param_2 == CONCAT44(uStack196,local_c8))) &&
           (param_2[1] == CONCAT44(uStack188,uStack192))) {
          local_230[0] = 0;
          bVar2 = FUN_180001820(&local_174,(PUCHAR)param_2,0x90,(PUCHAR)(param_2 + 0x12),local_230);
          if ((((int)CONCAT71(extraout_var_00,bVar2) != 0) && (local_230[0] != 0)) &&
             ((bVar2 = thunk_FUN_180002170(local_b8,(PUCHAR)&local_c8,(uint *)(param_2 + 2),
                                           (uint *)(param_2 + 2),0x80),
              (int)CONCAT71(extraout_var_01,bVar2) != 0 &&
              ((((bVar2 = FUN_1800019c0(local_228,1), (int)CONCAT71(extraout_var_02,bVar2) != 0 &&
                 (bVar2 = FUN_180001020((PUCHAR)&local_88,0x20),
                 (int)CONCAT71(extraout_var_03,bVar2) != 0)) &&
                (bVar2 = FUN_180001d20(local_1e0,0x20,(undefined4 *)(param_2 + 6),0x40,param_2 + 0xe
                                       ,0x20,local_68,0x20),
                (int)CONCAT71(extraout_var_04,bVar2) != 0)) &&
               (bVar2 = FUN_180001020((PUCHAR)(param_4 + 4),0x20),
               (int)CONCAT71(extraout_var_05,bVar2) != 0)))))) {
            param_4[0xc] = local_220;
            param_4[0xd] = uStack540;
            param_4[0xe] = uStack536;
            param_4[0xf] = uStack532;
            param_4[0x10] = local_210;
            param_4[0x11] = uStack524;
            param_4[0x12] = uStack520;
            param_4[0x13] = uStack516;
            param_4[0x14] = local_200;
            param_4[0x15] = uStack508;
            param_4[0x16] = uStack504;
            param_4[0x17] = uStack500;
            param_4[0x18] = local_1f0;
            param_4[0x19] = uStack492;
            param_4[0x1a] = uStack488;
            param_4[0x1b] = uStack484;
            bVar2 = FUN_180002170(local_68,local_58,&local_88,param_4 + 0x1c,0x20);
            if (((int)CONCAT71(extraout_var_06,bVar2) != 0) &&
               (iVar3 = FUN_1800011b0(local_134,0x40,(PUCHAR)&local_c8), iVar3 != 0)) {
              *param_4 = local_c8;
              param_4[1] = uStack196;
              param_4[2] = uStack192;
              param_4[3] = uStack188;
              bVar2 = FUN_180002170(local_b8,(PUCHAR)&local_c8,param_4 + 4,param_4 + 4,0x80);
              if (((int)CONCAT71(extraout_var_07,bVar2) != 0) &&
                 (bVar2 = FUN_180001790(local_f4,(PUCHAR)param_4,0x90,(PUCHAR)(param_4 + 0x24)),
                 (int)CONCAT71(extraout_var_08,bVar2) != 0)) {
                *param_6 = 0xd0;
                bVar2 = FUN_180001020((PUCHAR)local_194,0x20);
                if ((int)CONCAT71(extraout_var_09,bVar2) != 0) {
                  local_174._0_4_ = local_88;
                  local_174._4_4_ = uStack132;
                  uStack364 = uStack128;
                  uStack360 = uStack124;
                  local_164 = local_78;
                  uStack352 = uStack116;
                  uStack348 = uStack112;
                  uStack344 = uStack108;
                  bVar2 = FUN_180001020((PUCHAR)&local_1b4,0x20);
                  piVar1 = local_238;
                  if (((int)CONCAT71(extraout_var_10,bVar2) != 0) &&
                     (iVar3 = FUN_1800012f0((PUCHAR)&local_238,8,(PUCHAR)&local_1b4,0x20,local_a8),
                     iVar3 != 0)) {
                    bVar2 = thunk_FUN_180002170(local_a8,local_98,local_194,(uint *)(piVar1 + 9),
                                                0x40);
                    pUVar5 = local_a8;
                    for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
                      *pUVar5 = '\0';
                      pUVar5 = pUVar5 + 1;
                    }
                    if ((int)CONCAT71(extraout_var_11,bVar2) != 0) {
                      local_238[1] = local_1b4;
                      local_238[2] = iStack432;
                      local_238[3] = iStack428;
                      local_238[4] = iStack424;
                      local_238[5] = local_1a4;
                      local_238[6] = iStack416;
                      local_238[7] = iStack412;
                      local_238[8] = iStack408;
                      *local_238 = 1;
                    }
                  }
                }
              }
            }
          }
        }
        puVar6 = local_1b8;
        for (lVar4 = 0xe4; lVar4 != 0; lVar4 = lVar4 + -1) {
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        }
        pUVar5 = local_228;
        for (lVar4 = 0x68; lVar4 != 0; lVar4 = lVar4 + -1) {
          *pUVar5 = '\0';
          pUVar5 = pUVar5 + 1;
        }
        puVar7 = &local_c8;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *(undefined *)puVar7 = 0;
          puVar7 = (undefined4 *)((longlong)puVar7 + 1);
        }
        pUVar5 = local_68;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *pUVar5 = '\0';
          pUVar5 = pUVar5 + 1;
        }
        puVar8 = &local_88;
        for (lVar4 = 0x20; lVar4 != 0; lVar4 = lVar4 + -1) {
          *(undefined *)puVar8 = 0;
          puVar8 = (uint *)((longlong)puVar8 + 1);
        }
      }
    }
  }
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xfffffffffffffd88);
  return;
}



void FUN_1800173a0(longlong param_1,uint *param_2,uint *param_3,uint param_4)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  longlong lVar3;
  UCHAR *pUVar4;
  uint *puVar5;
  int *local_a8;
  UCHAR local_a0 [4];
  int aiStack156 [3];
  UCHAR local_90 [24];
  uint local_78 [8];
  UCHAR aUStack88 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff28;
  local_a8 = *(int **)(param_1 + 8);
  if ((local_a8 != (int *)0x0) && (*local_a8 != 0)) {
    puVar5 = (uint *)(local_a8 + 9);
    iVar2 = FUN_1800012f0((PUCHAR)&local_a8,8,(PUCHAR)(local_a8 + 1),0x20,local_a0);
    if (iVar2 != 0) {
      bVar1 = thunk_FUN_180002170(local_a0,local_90,puVar5,local_78,0x40);
      pUVar4 = local_a0;
      for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
        *pUVar4 = '\0';
        pUVar4 = pUVar4 + 1;
      }
      if ((int)CONCAT71(extraout_var,bVar1) != 0) {
        local_a8 = aiStack156;
        thunk_FUN_180002170(aUStack88,local_48,param_2,param_3,param_4);
        puVar5 = local_78;
        for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
          *(undefined *)puVar5 = 0;
          puVar5 = (uint *)((longlong)puVar5 + 1);
        }
      }
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff28);
  return;
}



void FUN_1800174b0(longlong param_1,uint *param_2,uint *param_3,uint param_4)

{
  bool bVar1;
  int iVar2;
  undefined7 extraout_var;
  longlong lVar3;
  UCHAR *pUVar4;
  uint *puVar5;
  int *local_a8;
  UCHAR local_a0 [4];
  int aiStack156 [3];
  UCHAR local_90 [24];
  uint local_78 [8];
  UCHAR aUStack88 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff28;
  local_a8 = *(int **)(param_1 + 8);
  if ((local_a8 != (int *)0x0) && (*local_a8 != 0)) {
    puVar5 = (uint *)(local_a8 + 9);
    iVar2 = FUN_1800012f0((PUCHAR)&local_a8,8,(PUCHAR)(local_a8 + 1),0x20,local_a0);
    if (iVar2 != 0) {
      bVar1 = thunk_FUN_180002170(local_a0,local_90,puVar5,local_78,0x40);
      pUVar4 = local_a0;
      for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
        *pUVar4 = '\0';
        pUVar4 = pUVar4 + 1;
      }
      if ((int)CONCAT71(extraout_var,bVar1) != 0) {
        local_a8 = aiStack156;
        FUN_180002170(aUStack88,local_48,param_2,param_3,param_4);
        puVar5 = local_78;
        for (lVar3 = 0x40; lVar3 != 0; lVar3 = lVar3 + -1) {
          *(undefined *)puVar5 = 0;
          puVar5 = (uint *)((longlong)puVar5 + 1);
        }
      }
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff28);
  return;
}



void FUN_1800175c0(longlong param_1,undefined8 param_2,undefined *param_3)

{
  uint *puVar1;
  int *piVar2;
  bool bVar3;
  int iVar4;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  undefined7 extraout_var_03;
  undefined7 extraout_var_04;
  undefined7 extraout_var_05;
  undefined7 extraout_var_06;
  undefined7 extraout_var_07;
  undefined7 extraout_var_08;
  undefined7 extraout_var_09;
  undefined7 extraout_var_10;
  undefined7 extraout_var_11;
  longlong lVar5;
  UCHAR *pUVar6;
  undefined *puVar7;
  longlong *plVar8;
  undefined4 *puVar9;
  int *local_3c8;
  int local_3c0;
  int local_3bc;
  undefined4 local_3b8;
  undefined4 uStack948;
  undefined4 uStack944;
  undefined4 uStack940;
  uint local_3a8 [8];
  undefined4 local_388;
  undefined4 uStack900;
  undefined4 uStack896;
  undefined4 uStack892;
  undefined4 local_378;
  undefined4 uStack884;
  undefined4 uStack880;
  undefined4 uStack876;
  undefined4 local_368;
  undefined4 uStack868;
  undefined4 uStack864;
  undefined4 uStack860;
  undefined4 local_358;
  undefined4 uStack852;
  undefined4 uStack848;
  undefined4 uStack844;
  undefined4 local_348;
  undefined4 uStack836;
  undefined4 uStack832;
  undefined4 uStack828;
  undefined4 local_338;
  undefined4 uStack820;
  undefined4 uStack816;
  undefined4 uStack812;
  UCHAR local_328 [64];
  UCHAR local_2e8 [8];
  undefined4 local_2e0;
  undefined4 uStack732;
  undefined4 uStack728;
  undefined4 uStack724;
  undefined4 local_2d0;
  undefined4 uStack716;
  undefined4 uStack712;
  undefined4 uStack708;
  undefined4 local_2c0;
  undefined4 uStack700;
  undefined4 uStack696;
  undefined4 uStack692;
  undefined4 local_2b0;
  undefined4 uStack684;
  undefined4 uStack680;
  undefined4 uStack676;
  undefined4 local_2a0 [10];
  undefined local_278 [4];
  int local_274;
  int iStack624;
  int iStack620;
  int iStack616;
  int local_264;
  int iStack608;
  int iStack604;
  int iStack600;
  uint local_254 [8];
  undefined8 local_234 [8];
  UCHAR local_1f4 [64];
  undefined4 local_1b4 [11];
  longlong local_188;
  longlong local_180;
  uint local_178 [8];
  undefined4 local_158 [16];
  uint local_118 [8];
  UCHAR local_f8 [64];
  undefined4 local_b8;
  undefined4 uStack180;
  undefined4 uStack176;
  undefined4 uStack172;
  UCHAR local_a8 [16];
  UCHAR local_98 [16];
  UCHAR local_88 [16];
  undefined4 local_78;
  undefined4 uStack116;
  undefined4 uStack112;
  undefined4 uStack108;
  undefined4 local_68;
  undefined4 uStack100;
  undefined4 uStack96;
  undefined4 uStack92;
  UCHAR local_58 [16];
  UCHAR local_48 [16];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffbf8;
  local_3c8 = *(int **)(param_1 + 8);
  if ((param_3 != (undefined *)0x0) && (local_3c8 != (int *)0x0)) {
    puVar1 = (uint *)(local_3c8 + 9);
    iVar4 = FUN_1800012f0((PUCHAR)&local_3c8,8,(PUCHAR)(local_3c8 + 1),0x20,local_98);
    if (iVar4 != 0) {
      bVar3 = thunk_FUN_180002170(local_98,local_88,puVar1,local_254,0xc0);
      pUVar6 = local_98;
      for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
        *pUVar6 = '\0';
        pUVar6 = pUVar6 + 1;
      }
      if ((int)CONCAT71(extraout_var,bVar3) != 0) {
        bVar3 = FUN_1800019c0(local_2e8,1);
        if (((int)CONCAT71(extraout_var_00,bVar3) != 0) &&
           (bVar3 = FUN_180001020((PUCHAR)local_3a8,0x20), (int)CONCAT71(extraout_var_01,bVar3) != 0
           )) {
          local_388 = local_2e0;
          uStack900 = uStack732;
          uStack896 = uStack728;
          uStack892 = uStack724;
          local_378 = local_2d0;
          uStack884 = uStack716;
          uStack880 = uStack712;
          uStack876 = uStack708;
          local_368 = local_2c0;
          uStack868 = uStack700;
          uStack864 = uStack696;
          uStack860 = uStack692;
          local_358 = local_2b0;
          uStack852 = uStack684;
          uStack848 = uStack680;
          uStack844 = uStack676;
          bVar3 = FUN_180001020((PUCHAR)&local_78,0x20);
          if ((int)CONCAT71(extraout_var_02,bVar3) != 0) {
            local_348 = local_78;
            uStack836 = uStack116;
            uStack832 = uStack112;
            uStack828 = uStack108;
            local_338 = local_68;
            uStack820 = uStack100;
            uStack816 = uStack96;
            uStack812 = uStack92;
            iVar4 = FUN_1800011b0(local_1f4,0x40,(PUCHAR)&local_b8);
            if (iVar4 != 0) {
              local_3b8 = local_b8;
              uStack948 = uStack180;
              uStack944 = uStack176;
              uStack940 = uStack172;
              bVar3 = FUN_180002170(local_a8,(PUCHAR)&local_b8,local_3a8,local_3a8,0x80);
              if (((int)CONCAT71(extraout_var_03,bVar3) != 0) &&
                 (bVar3 = FUN_180001790(local_1b4,(PUCHAR)&local_3b8,0x90,local_328),
                 (int)CONCAT71(extraout_var_04,bVar3) != 0)) {
                local_3c0 = 0;
                iVar4 = (*(code *)param_3)(param_2,&local_3b8,0xd0,&local_188);
                if ((iVar4 != 0) &&
                   ((((local_3c0 == 0xd0 &&
                      (iVar4 = FUN_1800011b0((PUCHAR)local_234,0x40,(PUCHAR)&local_b8), iVar4 != 0))
                     && (local_188 == CONCAT44(uStack180,local_b8))) &&
                    (local_180 == CONCAT44(uStack172,uStack176))))) {
                  local_3bc = 0;
                  bVar3 = FUN_180001820(local_234,(PUCHAR)&local_188,0x90,local_f8,&local_3bc);
                  if ((((((int)CONCAT71(extraout_var_05,bVar3) != 0) && (local_3bc != 0)) &&
                       (bVar3 = thunk_FUN_180002170(local_a8,(PUCHAR)&local_b8,local_178,local_178,
                                                    0x80), (int)CONCAT71(extraout_var_06,bVar3) != 0
                       )) && ((bVar3 = FUN_180001d20(local_2a0,0x20,local_158,0x40,&local_78,0x20,
                                                     local_58,0x20),
                              (int)CONCAT71(extraout_var_07,bVar3) != 0 &&
                              (bVar3 = thunk_FUN_180002170(local_58,local_48,local_118,
                                                           (uint *)local_234,0x20),
                              (int)CONCAT71(extraout_var_08,bVar3) != 0)))) &&
                     ((bVar3 = FUN_180001020((PUCHAR)local_254,0x20),
                      (int)CONCAT71(extraout_var_09,bVar3) != 0 &&
                      ((bVar3 = FUN_180001020((PUCHAR)&local_274,0x20), piVar2 = local_3c8,
                       (int)CONCAT71(extraout_var_10,bVar3) != 0 &&
                       (iVar4 = FUN_1800012f0((PUCHAR)&local_3c8,8,(PUCHAR)&local_274,0x20,local_98)
                       , iVar4 != 0)))))) {
                    bVar3 = thunk_FUN_180002170(local_98,local_88,local_254,(uint *)(piVar2 + 9),
                                                0x40);
                    pUVar6 = local_98;
                    for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
                      *pUVar6 = '\0';
                      pUVar6 = pUVar6 + 1;
                    }
                    if ((int)CONCAT71(extraout_var_11,bVar3) != 0) {
                      local_3c8[1] = local_274;
                      local_3c8[2] = iStack624;
                      local_3c8[3] = iStack620;
                      local_3c8[4] = iStack616;
                      local_3c8[5] = local_264;
                      local_3c8[6] = iStack608;
                      local_3c8[7] = iStack604;
                      local_3c8[8] = iStack600;
                      *local_3c8 = 1;
                    }
                  }
                }
              }
            }
          }
        }
        puVar7 = local_278;
        for (lVar5 = 0xe4; lVar5 != 0; lVar5 = lVar5 + -1) {
          *puVar7 = 0;
          puVar7 = puVar7 + 1;
        }
        pUVar6 = local_2e8;
        for (lVar5 = 0x68; lVar5 != 0; lVar5 = lVar5 + -1) {
          *pUVar6 = '\0';
          pUVar6 = pUVar6 + 1;
        }
        puVar9 = &local_3b8;
        for (lVar5 = 0xd0; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined *)puVar9 = 0;
          puVar9 = (undefined4 *)((longlong)puVar9 + 1);
        }
        plVar8 = &local_188;
        for (lVar5 = 0xd0; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined *)plVar8 = 0;
          plVar8 = (longlong *)((longlong)plVar8 + 1);
        }
        puVar9 = &local_b8;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined *)puVar9 = 0;
          puVar9 = (undefined4 *)((longlong)puVar9 + 1);
        }
        pUVar6 = local_58;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          *pUVar6 = '\0';
          pUVar6 = pUVar6 + 1;
        }
        puVar9 = &local_78;
        for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
          *(undefined *)puVar9 = 0;
          puVar9 = (undefined4 *)((longlong)puVar9 + 1);
        }
      }
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffbf8);
  return;
}



void FUN_180017a60(longlong param_1,undefined4 *param_2,int param_3,undefined4 *param_4,int param_5)

{
  uint *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  bool bVar5;
  int iVar6;
  undefined7 extraout_var;
  undefined7 extraout_var_00;
  undefined7 extraout_var_01;
  undefined7 extraout_var_02;
  SIZE_T SVar7;
  longlong lVar8;
  UCHAR *pUVar9;
  undefined *puVar10;
  undefined4 *puVar11;
  undefined *local_c8 [2];
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 uStack172;
  undefined4 uStack168;
  undefined4 uStack164;
  undefined4 local_a0;
  undefined4 uStack156;
  undefined4 uStack152;
  undefined4 uStack148;
  undefined4 local_90;
  undefined4 uStack140;
  undefined4 uStack136;
  undefined4 uStack132;
  undefined4 local_80;
  undefined4 uStack124;
  undefined4 uStack120;
  undefined4 uStack116;
  undefined4 local_70;
  undefined4 uStack108;
  undefined4 uStack104;
  undefined4 uStack100;
  undefined4 local_60;
  undefined4 uStack92;
  undefined4 uStack88;
  undefined4 uStack84;
  UCHAR local_48 [16];
  UCHAR local_38 [16];
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff08;
  if (((param_3 == 0x40) && (param_5 == 0x20)) &&
     (local_c8[0] = (undefined *)LocalAlloc(0,0xe4), local_c8[0] != (undefined *)0x0)) {
    bVar5 = FUN_180001020(local_c8[0] + 4,0x20);
    if (((int)CONCAT71(extraout_var,bVar5) != 0) &&
       (bVar5 = FUN_180001020(local_c8[0] + 0x24,0x20), (int)CONCAT71(extraout_var_00,bVar5) != 0))
    {
      FUN_18001d980((undefined (*) [16])&local_b8,0,0x68);
      local_b8 = 0x32534345;
      local_70 = *param_4;
      uStack108 = param_4[1];
      uStack104 = param_4[2];
      uStack100 = param_4[3];
      local_60 = param_4[4];
      uStack92 = param_4[5];
      uStack88 = param_4[6];
      uStack84 = param_4[7];
      local_b4 = 0x20;
      bVar5 = FUN_1800018e0((PUCHAR)&local_b8);
      if ((int)CONCAT71(extraout_var_01,bVar5) != 0) {
        uVar2 = param_2[1];
        uVar3 = param_2[2];
        uVar4 = param_2[3];
        *(undefined4 *)(local_c8[0] + 0x44) = *param_2;
        *(undefined4 *)(local_c8[0] + 0x48) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x4c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x50) = uVar4;
        uVar2 = param_2[5];
        uVar3 = param_2[6];
        uVar4 = param_2[7];
        *(undefined4 *)(local_c8[0] + 0x54) = param_2[4];
        *(undefined4 *)(local_c8[0] + 0x58) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x5c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x60) = uVar4;
        uVar2 = param_2[9];
        uVar3 = param_2[10];
        uVar4 = param_2[0xb];
        *(undefined4 *)(local_c8[0] + 100) = param_2[8];
        *(undefined4 *)(local_c8[0] + 0x68) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x6c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x70) = uVar4;
        uVar2 = param_2[0xd];
        uVar3 = param_2[0xe];
        uVar4 = param_2[0xf];
        *(undefined4 *)(local_c8[0] + 0x74) = param_2[0xc];
        *(undefined4 *)(local_c8[0] + 0x78) = uVar2;
        *(undefined4 *)(local_c8[0] + 0x7c) = uVar3;
        *(undefined4 *)(local_c8[0] + 0x80) = uVar4;
        *(undefined4 *)(local_c8[0] + 0x84) = local_b0;
        *(undefined4 *)(local_c8[0] + 0x88) = uStack172;
        *(undefined4 *)(local_c8[0] + 0x8c) = uStack168;
        *(undefined4 *)(local_c8[0] + 0x90) = uStack164;
        *(undefined4 *)(local_c8[0] + 0x94) = local_a0;
        *(undefined4 *)(local_c8[0] + 0x98) = uStack156;
        *(undefined4 *)(local_c8[0] + 0x9c) = uStack152;
        *(undefined4 *)(local_c8[0] + 0xa0) = uStack148;
        *(undefined4 *)(local_c8[0] + 0xa4) = local_90;
        *(undefined4 *)(local_c8[0] + 0xa8) = uStack140;
        *(undefined4 *)(local_c8[0] + 0xac) = uStack136;
        *(undefined4 *)(local_c8[0] + 0xb0) = uStack132;
        *(undefined4 *)(local_c8[0] + 0xb4) = local_80;
        *(undefined4 *)(local_c8[0] + 0xb8) = uStack124;
        *(undefined4 *)(local_c8[0] + 0xbc) = uStack120;
        *(undefined4 *)(local_c8[0] + 0xc0) = uStack116;
        *(undefined4 *)(local_c8[0] + 0xc4) = local_70;
        *(undefined4 *)(local_c8[0] + 200) = uStack108;
        *(undefined4 *)(local_c8[0] + 0xcc) = uStack104;
        *(undefined4 *)(local_c8[0] + 0xd0) = uStack100;
        *(undefined4 *)(local_c8[0] + 0xd4) = local_60;
        *(undefined4 *)(local_c8[0] + 0xd8) = uStack92;
        *(undefined4 *)(local_c8[0] + 0xdc) = uStack88;
        *(undefined4 *)(local_c8[0] + 0xe0) = uStack84;
        puVar1 = (uint *)(local_c8[0] + 0x24);
        iVar6 = FUN_1800012f0((PUCHAR)local_c8,8,local_c8[0] + 4,0x20,local_48);
        if (iVar6 != 0) {
          bVar5 = FUN_180002170(local_48,local_38,puVar1,puVar1,0xc0);
          pUVar9 = local_48;
          for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
            *pUVar9 = '\0';
            pUVar9 = pUVar9 + 1;
          }
          if ((int)CONCAT71(extraout_var_02,bVar5) != 0) {
            if (*(HLOCAL *)(param_1 + 8) != (HLOCAL)0x0) {
              SVar7 = LocalSize(*(HLOCAL *)(param_1 + 8));
              puVar10 = *(undefined **)(param_1 + 8);
              for (; SVar7 != 0; SVar7 = SVar7 - 1) {
                *puVar10 = 0;
                puVar10 = puVar10 + 1;
              }
            }
            *(undefined **)(param_1 + 8) = local_c8[0];
            local_c8[0] = (undefined *)0x0;
          }
        }
      }
    }
    puVar11 = &local_b8;
    for (lVar8 = 0x68; lVar8 != 0; lVar8 = lVar8 + -1) {
      *(undefined *)puVar11 = 0;
      puVar11 = (undefined4 *)((longlong)puVar11 + 1);
    }
    pUVar9 = local_48;
    for (lVar8 = 0x20; lVar8 != 0; lVar8 = lVar8 + -1) {
      *pUVar9 = '\0';
      pUVar9 = pUVar9 + 1;
    }
    if (local_c8[0] != (undefined *)0x0) {
      puVar10 = local_c8[0];
      for (lVar8 = 0xe4; lVar8 != 0; lVar8 = lVar8 + -1) {
        *puVar10 = 0;
        puVar10 = puVar10 + 1;
      }
      LocalFree(local_c8[0]);
    }
  }
  FUN_18001d2f0(local_28 ^ (ulonglong)&stack0xffffffffffffff08);
  return;
}



void FUN_180017c80(void)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

DWORD FUN_180017c90(void)

{
  DWORD DVar1;
  LSTATUS LVar2;
  DWORD local_res8 [2];
  DWORD local_res10 [2];
  HKEY local_res18;
  
  DVar1 = RegOpenKeyW((HKEY)0xffffffff80000002,L"SOFTWARE\\EgisSDKDBG",(PHKEY)&local_res18);
  if (DVar1 == 0) {
    local_res8[0] = 4;
    LVar2 = RegQueryValueExW(local_res18,L"EnableBlock",(LPDWORD)0x0,local_res10,&DAT_18004ba20,
                             local_res8);
    DVar1 = local_res8[0];
    if (LVar2 == 0) {
      DVar1 = 1;
    }
    local_res8[0] = 4;
    LVar2 = RegQueryValueExW(local_res18,L"DisplayFlag ",(LPDWORD)0x0,local_res10,
                             (LPBYTE)&DAT_18004ba24,local_res8);
    if (LVar2 == 0) {
      DVar1 = 1;
    }
    RegCloseKey(local_res18);
    _DAT_18004ba28 = 1;
  }
  return DVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180017d70(uint param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  longlong lVar2;
  char *_Src;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStack888 [32];
  uint local_358;
  uint local_350;
  uint local_348;
  uint local_340;
  DWORD local_338;
  DWORD local_330;
  longlong local_328;
  _SYSTEMTIME local_318;
  char local_308 [31];
  char cStack745;
  undefined2 local_2e8;
  char acStack742 [350];
  char local_188 [352];
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)auStack888;
  local_res18 = param_3;
  local_res20 = param_4;
  if (_DAT_18004ba28 == 0) {
    FUN_180017c90();
  }
  if (((_DAT_18004ba20 & param_1) != 0) && (param_2 != 0)) {
    GetLocalTime((LPSYSTEMTIME)&local_318);
    if (param_1 == 1) {
      _Src = "EngineAdapter";
    }
    else {
      _Src = "SensorAdapter";
      if (param_1 != 2) {
        _Src = "WBF";
      }
    }
    strcpy_s(local_308,0x1e,_Src);
    local_330 = GetCurrentThreadId();
    local_338 = GetCurrentProcessId();
    local_340 = (uint)local_318.wMilliseconds;
    local_348 = (uint)local_318.wSecond;
    local_350 = (uint)local_318.wMinute;
    local_358 = (uint)local_318.wHour;
    local_328 = param_2;
    sprintf_s(local_188,0x15e,"[%s] %02d:%02d:%02d:%03d [%04d] [%04d] %s",local_308);
    iVar1 = vsprintf_s(&cStack745 + 1,0x15e,local_188,(va_list)&local_res18);
    lVar2 = (longlong)iVar1;
    if ((&cStack745)[lVar2] != '\n') {
      *(undefined2 *)(&cStack745 + lVar2 + 1) = 0xa0d;
      (&cStack745)[lVar2 + 3] = '\0';
    }
    if (0 < DAT_18004ba24) {
      OutputDebugStringA(&cStack745 + 1);
    }
    if (1 < DAT_18004ba24) {
      FUN_1800180d0(param_1,&cStack745 + 1);
    }
  }
  FUN_18001d2f0(local_28 ^ (ulonglong)auStack888);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180017f20(uint param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  longlong lVar2;
  wchar_t *_Src;
  undefined8 local_res18;
  undefined8 local_res20;
  undefined auStack1624 [32];
  uint local_638;
  uint local_630;
  uint local_628;
  uint local_620;
  DWORD local_618;
  DWORD local_610;
  longlong local_608;
  _SYSTEMTIME local_5f8;
  wchar_t local_5e8 [31];
  undefined4 uStack1450;
  undefined2 auStack1444 [350];
  wchar_t local_2e8 [352];
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)auStack1624;
  local_res18 = param_3;
  local_res20 = param_4;
  if (_DAT_18004ba28 == 0) {
    FUN_180017c90();
  }
  if (((_DAT_18004ba20 & param_1) != 0) && (param_2 != 0)) {
    GetLocalTime((LPSYSTEMTIME)&local_5f8);
    if (param_1 == 1) {
      _Src = L"EngineAdapter";
    }
    else {
      _Src = L"SensorAdapter";
      if (param_1 != 2) {
        _Src = L"WBF";
      }
    }
    wcscpy_s(local_5e8,0x1e,_Src);
    local_610 = GetCurrentThreadId();
    local_618 = GetCurrentProcessId();
    local_620 = (uint)local_5f8.wMilliseconds;
    local_628 = (uint)local_5f8.wSecond;
    local_630 = (uint)local_5f8.wMinute;
    local_638 = (uint)local_5f8.wHour;
    local_608 = param_2;
    FUN_18001dcd8(local_2e8,0x15e,L"[%s] %02d:%02d:%02d:%03d [%04d] [%04d] %s",local_5e8);
    iVar1 = FUN_18001de94((wchar_t *)((longlong)&uStack1450 + 2),0x15e,local_2e8,
                          (va_list)&local_res18);
    lVar2 = (longlong)iVar1;
    if (*(short *)((longlong)&uStack1450 + lVar2 * 2) != 10) {
      *(undefined4 *)((longlong)&uStack1450 + (lVar2 + 1) * 2) = 0xa000d;
      auStack1444[lVar2] = 0;
    }
    if (0 < DAT_18004ba24) {
      OutputDebugStringW((LPCWSTR)((longlong)&uStack1450 + 2));
    }
    if (1 < DAT_18004ba24) {
      FUN_180018280(param_1,(LPCWSTR)((longlong)&uStack1450 + 2));
    }
  }
  FUN_18001d2f0(local_28 ^ (ulonglong)auStack1624);
  return;
}



void FUN_1800180d0(int param_1,LPCSTR param_2)

{
  uint uVar1;
  int iVar2;
  BOOL BVar3;
  HANDLE hFile;
  uint cbMultiByte;
  wchar_t *_Src;
  DWORD local_288 [2];
  wchar_t local_280 [36];
  wchar_t local_238 [264];
  ulonglong local_28;
  
  if (param_2 != (LPCSTR)0x0) {
    local_28 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd38;
    if (param_1 == 1) {
      _Src = L"EngineAdapter";
    }
    else {
      _Src = L"SensorAdapter";
      if (param_1 != 2) {
        _Src = L"WBF";
      }
    }
    wcscpy_s(local_280,0x1e,_Src);
    FUN_18001dcd8(local_238,0x104,L"%s\\%s.txt",L"C:\\Temp2\\WBF");
    hFile = CreateFileW(local_238,0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,4,0x80,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffffffffffff) {
      SetFilePointer(hFile,0,(PLONG)0x0,2);
      for (uVar1 = lstrlenA(param_2); uVar1 != 0; uVar1 = uVar1 - cbMultiByte) {
        cbMultiByte = 0x104;
        if (uVar1 < 0x104) {
          cbMultiByte = uVar1;
        }
        iVar2 = MultiByteToWideChar(0,0,param_2,cbMultiByte,local_238,0x104);
        BVar3 = WriteFile(hFile,local_238,iVar2 * 2,local_288,(LPOVERLAPPED)0x0);
        if (BVar3 == 0) {
          OutputDebugStringW(L"=SDK-DBG= Write File fail\r\n");
          break;
        }
        param_2 = param_2 + cbMultiByte;
      }
      CloseHandle(hFile);
    }
    FUN_18001d2f0(local_28 ^ (ulonglong)&stack0xfffffffffffffd38);
  }
  return;
}



void FUN_180018280(int param_1,LPCWSTR param_2)

{
  DWORD DVar1;
  int iVar2;
  BOOL BVar3;
  HANDLE hFile;
  wchar_t *_Src;
  undefined2 local_278 [2];
  DWORD local_274;
  wchar_t local_270 [36];
  wchar_t local_228 [264];
  ulonglong local_18;
  
  if (param_2 != (LPCWSTR)0x0) {
    local_18 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd48;
    if (param_1 == 1) {
      _Src = L"EngineAdapter";
    }
    else {
      _Src = L"SensorAdapter";
      if (param_1 != 2) {
        _Src = L"WBF";
      }
    }
    wcscpy_s(local_270,0x1e,_Src);
    FUN_18001dcd8(local_228,0x104,L"%s\\%s.txt",L"C:\\Temp2\\WBF");
    hFile = CreateFileW(local_228,0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,4,0x80,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffffffffffff) {
      DVar1 = SetFilePointer(hFile,0,(PLONG)0x0,2);
      if (DVar1 == 0) {
        local_278[0] = 0xfeff;
        WriteFile(hFile,local_278,4,&local_274,(LPOVERLAPPED)0x0);
      }
      iVar2 = lstrlenW(param_2);
      BVar3 = WriteFile(hFile,param_2,iVar2 * 2,&local_274,(LPOVERLAPPED)0x0);
      if (BVar3 == 0) {
        OutputDebugStringW(L"=SDK-DBG= Write File fail\r\n");
      }
      CloseHandle(hFile);
    }
    FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xfffffffffffffd48);
  }
  return;
}



undefined8
FUN_1800183f0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterControlUnitPrivileged",param_3,param_4);
  return 0;
}



undefined8 FUN_180018410(longlong param_1,uint param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterNotifyPowerChange",param_3,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if ((param_2 < 0x13) && ((0x40410U >> (param_2 & 0x1f) & 1) != 0)) {
    return 0;
  }
  return 0x80070057;
}



undefined8
FUN_180018480(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterPipelineInit",param_3,param_4);
  return 0;
}



undefined8 FUN_1800184a0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterPipelineCleanup",param_3,param_4);
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = 0x80004003;
  }
  return uVar1;
}



undefined8 FUN_1800184d0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterActivate",param_3,param_4);
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = 0x80004003;
  }
  return uVar1;
}



undefined8 FUN_180018500(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 uVar1;
  
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterDeactivate",param_3,param_4);
  uVar1 = 0;
  if (param_1 == 0) {
    uVar1 = 0x80004003;
  }
  return uVar1;
}



undefined8 FUN_180018530(longlong param_1,longlong param_2,ulonglong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  
  uVar1 = param_3;
  FUN_180017f20(1,(longlong)L">>> EngineAdapterQueryExtendedInfo",param_3,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if (param_3 < 0x24) {
    return 0x80070057;
  }
  *(undefined8 *)(param_2 + 4) = 8;
  *(undefined4 *)(param_2 + 0xc) = 10;
  *(undefined4 *)(param_2 + 0x10) = 6;
  *(undefined4 *)(param_2 + 0x14) = 1;
  *(undefined4 *)(param_2 + 0x18) = 1;
  *(undefined4 *)(param_2 + 0x1c) = 1;
  *(undefined4 *)(param_2 + 0x20) = 1;
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterQueryExtendedInfo",uVar1,param_4);
  return 0;
}



undefined8
FUN_1800185f0(undefined8 param_1,undefined8 *param_2,undefined8 *param_3,undefined8 param_4)

{
  undefined8 *puVar1;
  
  puVar1 = param_3;
  FUN_180017f20(1,(longlong)L">>> EngineAdapterIdentifyAll",param_3,param_4);
  if ((param_2 != (undefined8 *)0x0) && (param_3 != (undefined8 *)0x0)) {
    *param_2 = 0;
    *param_3 = 0;
    FUN_180017f20(1,(longlong)L"<<< EngineAdapterIdentifyAll",puVar1,param_4);
    return 0;
  }
  return 0x80004003;
}



undefined8 FUN_1800186c0(longlong param_1,longlong *param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>> EngineAdapterSetEnrollmentParameters",param_3,param_4);
  if (param_1 == 0) {
    return 0x80004003;
  }
  if (*param_2 == 0) {
    return 0x80070057;
  }
  *(undefined *)(*(longlong *)(param_1 + 0x38) + 0x42d8) = *(undefined *)(param_2 + 1);
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterSetEnrollmentParameters",param_3,param_4);
  return 0;
}



undefined8 FUN_180018740(longlong param_1,undefined4 *param_2,ulonglong param_3,undefined8 param_4)

{
  undefined uVar1;
  undefined4 uVar2;
  longlong lVar3;
  ulonglong uVar4;
  
  uVar4 = param_3;
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterQueryExtendedEnrollmentStatus",param_3,param_4);
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    return 0x80004003;
  }
  lVar3 = *(longlong *)(param_1 + 0x38);
  if (param_3 < 0x158) {
    return 0x80070057;
  }
  if (*(int *)(lVar3 + 8) == 0) {
    return 0x8009802c;
  }
  *param_2 = *(undefined4 *)(lVar3 + 0x10);
  uVar2 = *(undefined4 *)(lVar3 + 0xc);
  param_2[3] = 8;
  param_2[1] = uVar2;
  uVar1 = *(undefined *)(lVar3 + 0x42d8);
  param_2[5] = 10;
  param_2[6] = 6;
  param_2[7] = 1;
  *(undefined *)(param_2 + 4) = uVar1;
  param_2[8] = 1;
  param_2[9] = 1;
  param_2[10] = 1;
  FUN_180017f20(1,(longlong)L">>> EngineAdapterQueryExtendedEnrollmentStatus",uVar4,param_4);
  return 0;
}



undefined8
FUN_180018840(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterRefreshCache",param_3,param_4);
  return 0;
}



undefined8
FUN_180018860(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>><<< EngineAdapterSelectCalibrationFormat",param_3,param_4);
  return 0x80004001;
}



uint FUN_180018bf0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong **lpMem;
  longlong *plVar1;
  HANDLE hHeap;
  uint uVar2;
  
  FUN_180017f20(1,(longlong)L">>> EngineAdapterDetach",param_3,param_4);
  uVar2 = 0;
  if (param_1 == 0) {
    uVar2 = 0x80004003;
  }
  else {
    lpMem = *(longlong ***)(param_1 + 0x38);
    if (lpMem != (longlong **)0x0) {
      FUN_180017f20(1,(longlong)L"EngineAdapterDetach : EngineAdapterDetach",param_3,param_4);
      FUN_18001bbe0(param_1);
      plVar1 = *lpMem;
      if (plVar1 != (longlong *)0x0) {
        (**(code **)(*plVar1 + 0x38))(plVar1,param_1);
        FUN_18001ac70((undefined **)*lpMem);
      }
      if (lpMem[0x85a] != (longlong *)0x0) {
        CloseHandle(lpMem[0x85a]);
      }
      hHeap = GetProcessHeap();
      HeapFree(hHeap,0,lpMem);
      *(undefined8 *)(param_1 + 0x38) = 0;
    }
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterDetach : ErrorCode [0x%08X]",(ulonglong)uVar2,param_4
               );
  FUN_180017c80();
  return uVar2;
}



undefined8 FUN_180018cc0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong **pplVar1;
  
  FUN_180017f20(1,(longlong)L">>> EngineAdapterClearContext",param_3,param_4);
  if (param_1 == 0) {
    FUN_180017f20(1,(longlong)L"<<< EngineAdapterClearContext : Pipeline is NULL",param_3,param_4);
    return 0x80004003;
  }
  pplVar1 = *(longlong ***)(param_1 + 0x38);
  if (pplVar1 == (longlong **)0x0) {
    FUN_180017f20(1,(longlong)L"<<< EngineAdapterClearContext : EngineContext is NULL",param_3,
                  param_4);
    return 0x80004003;
  }
  *(undefined4 *)(pplVar1 + 2) = 0x8009800f;
  pplVar1[1] = (longlong *)0x0;
  if (*pplVar1 != (longlong *)0x0) {
    (**(code **)(**pplVar1 + 0x70))();
    (**(code **)(**pplVar1 + 0x78))();
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterClearContext",param_3,param_4);
  return 0;
}



undefined8
FUN_180018d60(longlong param_1,undefined4 *param_2,undefined4 *param_3,undefined8 param_4)

{
  if (((param_1 != 0) && (param_2 != (undefined4 *)0x0)) && (param_3 != (undefined4 *)0x0)) {
    *param_2 = 0x401001b;
    *param_3 = 0x895fd2a7;
    param_3[1] = 0x427b0651;
    param_3[2] = 0x3715d0a8;
    param_3[3] = 0xd6e86d0d;
    return 0;
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterQueryPreferredFormat : Parameter is NULL",param_3,
                param_4);
  return 0x80004003;
}



undefined8 FUN_180018dd0(longlong param_1,longlong param_2,longlong param_3,longlong param_4)

{
  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != 0)) && (param_4 != 0)) {
    FUN_180017f20(1,(longlong)L"<<< EngineAdapterQueryHashAlgorithms : Not support, E_NOTIMPL",
                  param_3,param_4);
    return 0x80004001;
  }
  return 0x80004003;
}



undefined8 FUN_180018e10(longlong param_1,undefined8 param_2,longlong param_3,undefined8 param_4)

{
  longlong lVar1;
  
  lVar1 = param_3;
  FUN_180017f20(1,(longlong)L">>> EngineAdapterSetHashAlgorithm",param_3,param_4);
  if ((param_1 != 0) && (param_3 != 0)) {
    FUN_180017f20(1,(longlong)L"<<< EngineAdapterSetHashAlgorithm : Not support, E_NOTIMPL",lVar1,
                  param_4);
    return 0x80004001;
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterSetHashAlgorithm : Parameter is NULL",lVar1,param_4);
  return 0x80004003;
}



undefined8 FUN_180018e80(longlong param_1,ulonglong *param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  
  FUN_180017f20(1,(longlong)L">>> EngineAdapterQuerySampleHint",param_3,param_4);
  if ((param_1 != 0) && (param_2 != (ulonglong *)0x0)) {
    uVar1 = (**(code **)(***(longlong ***)(param_1 + 0x38) + 0x80))();
    *param_2 = (ulonglong)uVar1;
    FUN_180017f20(1,(longlong)L"<<< EngineAdapterQuerySampleHint",param_3,param_4);
    return 0;
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterQuerySampleHint : Parameter is NULL",param_3,param_4)
  ;
  return 0x80004003;
}



uint FUN_180019120(longlong param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  undefined4 uVar1;
  longlong **pplVar2;
  uint uVar3;
  
  FUN_180017f20(1,(longlong)L">>> EngineAdapterUpdateEnrollment",param_3,param_4);
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    uVar3 = 0x80004003;
  }
  else {
    *param_2 = 0;
    pplVar2 = *(longlong ***)(param_1 + 0x38);
    if (*(int *)(pplVar2 + 1) == 0) {
      uVar3 = 0x8009800f;
    }
    else {
      uVar3 = (**(code **)(**pplVar2 + 0x60))(*pplVar2,param_2);
      if (uVar3 == 0) {
        *(undefined4 *)(pplVar2 + 1) = 0xffffffff;
      }
      uVar1 = *param_2;
      *(uint *)(pplVar2 + 2) = uVar3;
      *(undefined4 *)((longlong)pplVar2 + 0xc) = uVar1;
    }
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterUpdateEnrollment : hr = [0x%08X]",(ulonglong)uVar3,
                param_4);
  return uVar3;
}



uint FUN_1800191c0(longlong param_1,byte param_2,longlong param_3,longlong param_4)

{
  longlong lVar1;
  uint uVar2;
  ulonglong uVar3;
  longlong lVar4;
  
  lVar4 = param_4;
  FUN_180017f20(1,(longlong)L">>> EngineAdapterExportEngineData",param_3,param_4);
  if (((param_1 == 0) || (param_3 == 0)) || (param_4 == 0)) {
    uVar2 = 0x80004003;
  }
  else {
    lVar1 = *(longlong *)(param_1 + 0x38);
    uVar3 = (ulonglong)param_2;
    FUN_180017f20(1,(longlong)L"EngineAdapterExportEngineData : Check the flag , Flags = [0x%x]",
                  uVar3,lVar4);
    if ((param_2 & 0xe0) == 0) {
      FUN_180017f20(1,(longlong)
                      L"EngineAdapterExportEngineData : Error !!Check the flag , Flags != WINBIO_DATA_FLAG_RAW/WINBIO_DATA_FLAG_INTERMEDIATE/WINBIO_DATA_FLAG_PROCESSED"
                    ,uVar3,lVar4);
      uVar2 = 0x80070057;
    }
    else {
      if ((((param_2 & 2) == 0) && ((param_2 & 1) == 0)) && (((param_2 & 4) == 0 && (param_2 != 0)))
         ) {
        if ((*(longlong *)(lVar1 + 0x4260) == 0) || (*(int *)(lVar1 + 17000) == 0)) {
          uVar2 = 0x8009800f;
        }
        else {
          uVar2 = 0x80004001;
        }
      }
      else {
        FUN_180017f20(1,(longlong)
                        L"EngineAdapterExportEngineData : Check the flag , Flags =WINBIO_DATA_FLAG_PRIVACY/WINBIO_DATA_FLAG_INTEGRITY/WINBIO_DATA_FLAG_SIGNED/==0"
                      ,uVar3,lVar4);
        uVar2 = 0x80070057;
      }
    }
  }
  FUN_180017f20(1,(longlong)L"<< EngineAdapterExportEngineData, hr=[0x%08x]",(ulonglong)uVar2,lVar4)
  ;
  return uVar2;
}



uint FUN_18001a050(longlong param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  uint uVar2;
  
  if ((param_1 == 0) || (param_2 == (undefined4 *)0x0)) {
    uVar2 = 0x80004003;
  }
  else {
    *param_2 = 0;
    lVar1 = *(longlong *)(param_1 + 0x38);
    if (*(int *)(lVar1 + 8) == 0) {
      uVar2 = 0x8009800f;
    }
    else {
      *param_2 = *(undefined4 *)(lVar1 + 0xc);
      uVar2 = *(uint *)(lVar1 + 0x10);
    }
  }
  FUN_180017f20(1,(longlong)L"<< EngineAdapterGetEnrollmentStatus, hr=[0x%08x]",(ulonglong)uVar2,
                param_4);
  return uVar2;
}



ulonglong FUN_18001a0e0(longlong param_1,undefined8 *param_2,byte *param_3,LPDWORD param_4)

{
  longlong **pplVar1;
  code *pcVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  BOOL BVar8;
  DWORD DVar9;
  undefined8 uVar10;
  ulonglong uVar11;
  LPDWORD cchName;
  uint uVar12;
  DWORD local_res8 [2];
  ulonglong in_stack_ffffffffffffff68;
  DWORD local_78;
  _SID_NAME_USE local_74;
  ulonglong local_70;
  int *local_68;
  byte local_60;
  undefined8 local_48;
  undefined4 local_40;
  
  uVar12 = 0;
  cchName = param_4;
  if ((((param_1 != 0) && (param_2 != (undefined8 *)0x0)) && (param_3 != (byte *)0x0)) &&
     (param_4 != (LPDWORD)0x0)) {
    FUN_180017f20(1,(longlong)L">>> EngineAdapterCheckForDuplicate ",param_3,param_4);
    pplVar1 = *(longlong ***)(param_1 + 0x38);
    if (*(int *)(pplVar1 + 1) == 0) {
      uVar6 = 0x8009800f;
      goto LAB_18001a373;
    }
    *param_2 = 0;
    param_2[1] = 0;
    param_2[2] = 0;
    param_2[3] = 0;
    param_2[4] = 0;
    param_2[5] = 0;
    param_2[6] = 0;
    param_2[7] = 0;
    param_2[8] = 0;
    *(undefined4 *)(param_2 + 9) = 0;
    *(undefined4 *)param_2 = 0;
    *(undefined *)param_4 = 0;
    *param_3 = 0;
    if (*(longlong *)(param_1 + 0x28) != 0) {
      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x80);
      if (pcVar2 != (code *)0x0) {
        cchName = (LPDWORD)0x0;
        uVar6 = (*pcVar2)(param_1,0xff);
        if ((int)uVar6 < 0) goto LAB_18001a373;
        if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_18001a36e;
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x88);
        if (pcVar2 != (code *)0x0) {
          uVar6 = (*pcVar2)(param_1,&local_70);
          if (-1 < (int)uVar6) {
            uVar10 = FUN_18001aa30(param_1);
            uVar6 = 0;
            if ((uint)uVar10 != 0x8009801f) {
              uVar11 = 0;
              uVar5 = (uint)uVar10;
              if (local_70 != 0) {
                do {
                  if (((*(longlong *)(param_1 + 0x28) != 0) &&
                      (pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0xa0),
                      pcVar2 != (code *)0x0)) &&
                     ((iVar7 = (*pcVar2)(param_1,&local_68), -1 < iVar7 && (local_68 != (int *)0x0))
                     )) {
                    if (*local_68 == 3) {
                      cchName = &local_78;
                      local_78 = 0;
                      in_stack_ffffffffffffff68 = 0;
                      local_res8[0] = 0;
                      BVar8 = LookupAccountSidW((LPCWSTR)0x0,local_68 + 2,(LPWSTR)0x0,cchName,
                                                (LPWSTR)0x0,local_res8,&local_74);
                      if ((BVar8 == 0) && (DVar9 = GetLastError(), DVar9 != 0x7a))
                      goto LAB_18001a2c6;
                    }
                    cchName = (LPDWORD)0x0;
                    in_stack_ffffffffffffff68 = in_stack_ffffffffffffff68 & 0xffffffff00000000;
                    iVar7 = (**(code **)(**pplVar1 + 0x50))
                                      (*pplVar1,local_48,local_40,0,in_stack_ffffffffffffff68);
                    if (-1 < iVar7) {
                      FUN_180017f20(1,(longlong)
                                      L"EngineAdapterCheckForDuplicate : RecordContents.SubFactor = [0x%x]"
                                    ,(ulonglong)local_60,cchName);
                      iVar7 = local_68[1];
                      iVar3 = local_68[2];
                      iVar4 = local_68[3];
                      *(int *)param_2 = *local_68;
                      *(int *)((longlong)param_2 + 4) = iVar7;
                      *(int *)(param_2 + 1) = iVar3;
                      *(int *)((longlong)param_2 + 0xc) = iVar4;
                      iVar7 = local_68[5];
                      iVar3 = local_68[6];
                      iVar4 = local_68[7];
                      *(int *)(param_2 + 2) = local_68[4];
                      *(int *)((longlong)param_2 + 0x14) = iVar7;
                      *(int *)(param_2 + 3) = iVar3;
                      *(int *)((longlong)param_2 + 0x1c) = iVar4;
                      iVar7 = local_68[9];
                      iVar3 = local_68[10];
                      iVar4 = local_68[0xb];
                      *(int *)(param_2 + 4) = local_68[8];
                      *(int *)((longlong)param_2 + 0x24) = iVar7;
                      *(int *)(param_2 + 5) = iVar3;
                      *(int *)((longlong)param_2 + 0x2c) = iVar4;
                      iVar7 = local_68[0xd];
                      iVar3 = local_68[0xe];
                      iVar4 = local_68[0xf];
                      *(int *)(param_2 + 6) = local_68[0xc];
                      *(int *)((longlong)param_2 + 0x34) = iVar7;
                      *(int *)(param_2 + 7) = iVar3;
                      *(int *)((longlong)param_2 + 0x3c) = iVar4;
                      param_2[8] = *(undefined8 *)(local_68 + 0x10);
                      *(int *)(param_2 + 9) = local_68[0x12];
                      *param_3 = local_60;
                      *(undefined *)param_4 = 1;
                      goto LAB_18001a2f0;
                    }
                  }
LAB_18001a2c6:
                  uVar10 = FUN_18001aa60(param_1);
                  if ((int)(uint)uVar10 < 0) goto LAB_18001a373;
                  uVar11 = uVar11 + 1;
                  uVar5 = (uint)uVar10;
                } while (uVar11 < local_70);
              }
              uVar12 = uVar5;
              uVar6 = uVar12;
              if (*(char *)param_4 != '\0') {
LAB_18001a2f0:
                (**(code **)(**pplVar1 + 0x70))();
                pplVar1[1] = (longlong *)0x0;
                *(undefined4 *)(pplVar1 + 2) = 0x8009800f;
                uVar6 = uVar12;
              }
            }
          }
          goto LAB_18001a373;
        }
      }
      uVar6 = 0x80004001;
      goto LAB_18001a373;
    }
  }
LAB_18001a36e:
  uVar6 = 0x80004003;
LAB_18001a373:
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterCheckForDuplicate hr=[0x%08x]",(ulonglong)uVar6,
                cchName);
  uVar11 = (ulonglong)uVar6;
  if (uVar6 == 0x8009801f) {
    uVar11 = 0;
  }
  return uVar11;
}



uint FUN_18001a3c0(longlong param_1,longlong param_2,ulonglong param_3,undefined8 param_4,
                  undefined8 param_5)

{
  longlong **pplVar1;
  code *pcVar2;
  uint uVar3;
  uint uVar4;
  ulonglong uVar5;
  undefined8 uVar6;
  ulonglong local_res8;
  longlong local_68;
  ulonglong local_60;
  undefined8 local_58;
  undefined8 local_50;
  undefined8 local_48;
  undefined8 local_40;
  undefined8 local_38;
  undefined8 local_30;
  
  local_68 = 0;
  local_60 = 0;
  local_58 = 0;
  local_50 = 0;
  local_48 = 0;
  local_40 = 0;
  local_38 = 0;
  local_30 = 0;
  if ((param_1 == 0) || (param_2 == 0)) {
    uVar4 = 0x80004003;
    goto LAB_18001a5c9;
  }
  uVar5 = param_3;
  uVar6 = param_4;
  FUN_180017f20(1,(longlong)L">>> EngineAdapterCommitEnrollment",param_3,param_4);
  if ((char)param_3 == '\0') {
    return 0x80070057;
  }
  pplVar1 = *(longlong ***)(param_1 + 0x38);
  if (*(int *)(pplVar1 + 1) != -1) {
    FUN_180017f20(1,(longlong)L"WINBIO_E_INVALID_DEVICE_STATE !!",uVar5,uVar6);
    uVar4 = 0x8009800f;
    param_4 = uVar6;
    goto LAB_18001a5c9;
  }
  uVar3 = (**(code **)(**pplVar1 + 0x90))();
  if (uVar3 == 0) {
LAB_18001a523:
    local_60 = local_60 & 0xffffffffffffff00 | param_3 & 0xff;
    local_58 = 0;
    local_50 = 0;
    local_48 = 0;
    local_30 = param_5;
    local_40 = 0;
    local_68 = param_2;
    local_38 = param_4;
    uVar4 = (**(code **)(**pplVar1 + 0x68))(*pplVar1,&local_48);
    if (-1 < (int)uVar4) {
      if (*(longlong *)(param_1 + 0x28) == 0) {
        uVar5 = 0x80004003;
LAB_18001a59d:
        uVar4 = (uint)uVar5;
        FUN_180017f20(1,(longlong)L"EngineAdapterCommitEnrollment : StorageAddRecord  %d",uVar5,
                      uVar6);
      }
      else {
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x68);
        if (pcVar2 == (code *)0x0) {
          uVar5 = 0x80004001;
          goto LAB_18001a59d;
        }
        uVar4 = (*pcVar2)(param_1,&local_68);
        uVar5 = (ulonglong)uVar4;
        if ((int)uVar4 < 0) goto LAB_18001a59d;
      }
      (**(code **)(**pplVar1 + 0x70))();
      pplVar1[1] = (longlong *)0x0;
      *(undefined4 *)(pplVar1 + 2) = 0;
      param_4 = uVar6;
      goto LAB_18001a5c9;
    }
  }
  else {
    local_res8 = 0;
    if (*(longlong *)(param_1 + 0x28) == 0) {
LAB_18001a509:
      uVar4 = 0x80004003;
    }
    else {
      pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x80);
      if (pcVar2 != (code *)0x0) {
        uVar6 = 0;
        uVar4 = (*pcVar2)(param_1,0xff);
        if ((int)uVar4 < 0) {
          if (uVar4 != 0x8009801f) {
LAB_18001a4e0:
            if ((int)uVar4 < 0) goto LAB_18001a50e;
          }
          if (local_res8 < uVar3) goto LAB_18001a523;
          FUN_180017f20(1,(longlong)
                          L"EngineAdapterCommitEnrollment : WbioStorageGetRecordCount() = %d, FULL",
                        local_res8,uVar6);
          uVar4 = 0x80098018;
          goto LAB_18001a50e;
        }
        if (*(longlong *)(param_1 + 0x28) == 0) goto LAB_18001a509;
        pcVar2 = *(code **)(*(longlong *)(param_1 + 0x28) + 0x88);
        if (pcVar2 != (code *)0x0) {
          uVar4 = (*pcVar2)(param_1,&local_res8);
          goto LAB_18001a4e0;
        }
      }
      uVar4 = 0x80004001;
    }
  }
LAB_18001a50e:
  (**(code **)(**pplVar1 + 0x70))();
  pplVar1[1] = (longlong *)0x0;
  *(uint *)(pplVar1 + 2) = uVar4;
  param_4 = uVar6;
LAB_18001a5c9:
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterCommitEnrollment, hr=[0x%08x]",(ulonglong)uVar4,
                param_4);
  return uVar4;
}



uint FUN_18001a600(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong **pplVar1;
  uint uVar2;
  
  uVar2 = 0;
  if (param_1 == 0) {
    uVar2 = 0x80004003;
  }
  else {
    pplVar1 = *(longlong ***)(param_1 + 0x38);
    if (*(int *)(pplVar1 + 1) == 0) {
      uVar2 = 0x8009800f;
    }
    else {
      (**(code **)(**pplVar1 + 0x70))();
      pplVar1[1] = (longlong *)0x0;
      *(undefined4 *)(pplVar1 + 2) = 0x8009800f;
    }
  }
  FUN_180017f20(1,(longlong)L"<<< EngineAdapterDiscardEnrollment, hr=[0x%08x]",(ulonglong)uVar2,
                param_4);
  return uVar2;
}



void FUN_18001a6d0(undefined8 param_1,undefined8 *param_2,uint param_3)

{
  undefined8 *lpName;
  uint uVar1;
  LSTATUS LVar2;
  int iVar3;
  DWORD dwIndex;
  HKEY local_248 [2];
  undefined8 local_238 [64];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd88;
  uVar1 = wsprintfW((LPWSTR)local_238,L"SYSTEM\\CurrentControlSet\\Enum\\%s\\Device Parameters");
  dwIndex = 0;
  local_248[0] = (HKEY)0x0;
  LVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)local_238,0,8,(PHKEY)local_248);
  if (LVar2 == 0) {
    *(undefined2 *)((longlong)local_238 + (ulonglong)uVar1 * 2) = 0x5c;
    uVar1 = uVar1 + 1;
    lpName = (undefined8 *)((longlong)local_238 + (ulonglong)uVar1 * 2);
    while ((LVar2 = RegEnumKeyW(local_248[0],dwIndex,(LPWSTR)lpName,0x100 - uVar1), LVar2 != 0 ||
           (iVar3 = StrCmpNIW((LPCWSTR)lpName,L"Egis",4), iVar3 != 0))) {
      dwIndex = dwIndex + 1;
    }
    iVar3 = lstrlenW((LPCWSTR)lpName);
    if (uVar1 + iVar3 < param_3) {
      FUN_18001d320(param_2,local_238,(ulonglong)(uVar1 + iVar3 + 1) * 2);
      RegCloseKey(local_248[0]);
    }
    else {
      RegCloseKey(local_248[0]);
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffd88);
  return;
}



BOOL FUN_18001a820(HANDLE param_1,LPVOID param_2,DWORD param_3,LPVOID param_4,DWORD param_5,
                  LPDWORD param_6)

{
  BOOL BVar1;
  DWORD DVar2;
  _OVERLAPPED local_28;
  
  local_28.Internal = 0;
  local_28.InternalHigh = 0;
  local_28.u = 0;
  local_28.hEvent = (HANDLE)0x0;
  local_28.hEvent = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
  BVar1 = DeviceIoControl(param_1,0x4427c0,param_2,param_3,param_4,param_5,param_6,
                          (LPOVERLAPPED)&local_28);
  if (BVar1 == 0) {
    DVar2 = GetLastError();
    if (DVar2 == 0x3e5) {
      BVar1 = GetOverlappedResult(param_1,(LPOVERLAPPED)&local_28,param_6,1);
    }
  }
  CloseHandle(local_28.hEvent);
  return BVar1;
}



void FUN_18001a900(undefined8 param_1,longlong *param_2)

{
  int iVar1;
  longlong lVar2;
  UCHAR *pUVar3;
  UCHAR local_38 [32];
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff98;
  iVar1 = FUN_1800012f0("U2Vj",0x24,&DAT_18002d878,0x20,local_38);
  if (iVar1 != 0) {
    iVar1 = (**(code **)(*param_2 + 8))(param_2,&DAT_18002d8a0,0x40,local_38);
    pUVar3 = local_38;
    for (lVar2 = 0x20; lVar2 != 0; lVar2 = lVar2 + -1) {
      *pUVar3 = '\0';
      pUVar3 = pUVar3 + 1;
    }
    if (iVar1 != 0) {
      (**(code **)(*param_2 + 0x10))(param_2,param_1,FUN_18001a820);
    }
  }
  FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xffffffffffffff98);
  return;
}



undefined8 FUN_18001a9d0(void)

{
  return 1;
}



undefined8
WbioQueryEngineInterface
          (undefined8 *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
                    // 0x1a9e0  1  WbioQueryEngineInterface
  if (param_1 == (undefined8 *)0x0) {
    return 0x80004003;
  }
  FUN_180017f20(1,(longlong)L">>> WbioQueryEngineInterface",param_3,param_4);
  *param_1 = &DAT_180049030;
  FUN_180017f20(1,(longlong)L"<<< WbioQueryEngineInterface",param_3,param_4);
  return 0;
}



undefined8 FUN_18001aa30(longlong param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 uVar1;
  
  if ((param_1 != 0) && (*(longlong *)(param_1 + 0x28) != 0)) {
    UNRECOVERED_JUMPTABLE = *(code **)(*(longlong *)(param_1 + 0x28) + 0x90);
    if (UNRECOVERED_JUMPTABLE == (code *)0x0) {
      return 0x80004001;
    }
                    // WARNING: Could not recover jumptable at 0x00018001aa50. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)();
    return uVar1;
  }
  return 0x80004003;
}



undefined8 FUN_18001aa60(longlong param_1)

{
  code *UNRECOVERED_JUMPTABLE;
  undefined8 uVar1;
  
  if ((param_1 != 0) && (*(longlong *)(param_1 + 0x28) != 0)) {
    UNRECOVERED_JUMPTABLE = *(code **)(*(longlong *)(param_1 + 0x28) + 0x98);
    if (UNRECOVERED_JUMPTABLE == (code *)0x0) {
      return 0x80004001;
    }
                    // WARNING: Could not recover jumptable at 0x00018001aa80. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)();
    return uVar1;
  }
  return 0x80004003;
}



undefined ** FUN_18001aa90(undefined **param_1,LPCWSTR param_2,int param_3,int param_4)

{
  uint uVar1;
  LPWSTR pWVar2;
  
  FUN_18001be60(param_1,param_3,param_4);
  *param_1 = (undefined *)CET510Sensor::vftable;
  pWVar2 = StrStrIW(param_2,L"Rev");
  if (((pWVar2 != (LPWSTR)0x0) &&
      (uVar1 = wcstol(pWVar2 + 3,(wchar_t **)0x0,0x10), (uVar1 & 0xffff0000) == 0)) &&
     (((byte)uVar1 & 0xf) == 1)) {
    *(undefined4 *)(param_1 + 0xe) = 0x14;
    return param_1;
  }
  return param_1;
}



undefined ** FUN_18001ab10(undefined **param_1,uint param_2)

{
  FUN_18001bf40(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



undefined ** FUN_18001ab40(LPCWSTR param_1)

{
  LPWSTR pWVar1;
  undefined **ppuVar2;
  
  pWVar1 = StrStrW(param_1,L"ET310");
  if (pWVar1 == (LPWSTR)0x0) {
    pWVar1 = StrStrW(param_1,L"ET320");
    if (pWVar1 == (LPWSTR)0x0) {
      pWVar1 = StrStrW(param_1,L"ET510");
      if (pWVar1 == (LPWSTR)0x0) {
        ppuVar2 = (undefined **)operator_new(0x298);
        if (ppuVar2 == (undefined **)0x0) {
          ppuVar2 = (undefined **)0x0;
        }
        else {
          ppuVar2 = FUN_18001be60(ppuVar2,0x80,0x80);
        }
      }
      else {
        ppuVar2 = (undefined **)operator_new(0x298);
        if (ppuVar2 == (undefined **)0x0) {
          ppuVar2 = (undefined **)0x0;
        }
        else {
          ppuVar2 = FUN_18001aa90(ppuVar2,param_1,0x67,0x34);
        }
      }
    }
    else {
      ppuVar2 = (undefined **)operator_new(0x298);
      if (ppuVar2 == (undefined **)0x0) {
        ppuVar2 = (undefined **)0x0;
      }
      else {
        FUN_18001be60(ppuVar2,0x72,0x39);
        *ppuVar2 = (undefined *)CET320Sensor::vftable;
      }
    }
  }
  else {
    ppuVar2 = (undefined **)operator_new(0x298);
    if (ppuVar2 == (undefined **)0x0) {
      ppuVar2 = (undefined **)0x0;
    }
    else {
      FUN_18001be60(ppuVar2,0x90,0x40);
      *ppuVar2 = (undefined *)CET310Sensor::vftable;
    }
  }
  return ppuVar2;
}



void FUN_18001ac70(undefined **param_1)

{
  if (param_1 != (undefined **)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018001ac7d. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)*param_1)(param_1,1);
    return;
  }
  return;
}



wchar_t * FUN_18001ac90(void)

{
  return L"SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters";
}



wchar_t * FUN_18001aca0(void)

{
  return L"SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET310";
}



wchar_t * FUN_18001acb0(void)

{
  return L"SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET320";
}



wchar_t * FUN_18001acc0(void)

{
  return L"SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET510";
}



wchar_t * FUN_18001acd0(void)

{
  return L"SYSTEM\\CurrentControlSet\\Services\\EgisFP\\FPParameters\\Area\\ET300";
}



undefined8 FUN_18001ace0(void)

{
  return 2;
}



undefined8 FUN_18001acf0(void)

{
  return 3;
}



undefined8 FUN_18001ad00(void)

{
  return 5;
}



uint FUN_18001ad10(uint *param_1,uint param_2)

{
  uint *puVar1;
  byte bVar2;
  uint uVar3;
  uint *puVar4;
  uint *puVar5;
  
  puVar4 = (uint *)0x0;
  puVar1 = (uint *)((ulonglong)(param_2 & 3) + (longlong)param_1);
  bVar2 = 0;
  puVar5 = (uint *)((longlong)puVar1 - (longlong)param_1);
  if (puVar1 < param_1) {
    puVar5 = puVar4;
  }
  puVar1 = puVar4;
  if (puVar5 != (uint *)0x0) {
    do {
      bVar2 = bVar2 ^ *(byte *)param_1;
      puVar1 = (uint *)((longlong)puVar1 + 1);
      param_1 = (uint *)((longlong)param_1 + 1);
    } while (puVar1 < puVar5);
    puVar1 = (uint *)(ulonglong)bVar2;
  }
  puVar5 = (uint *)((ulonglong)
                    ((longlong)(uint *)((ulonglong)param_2 + (longlong)param_1) +
                    (3 - (longlong)param_1)) >> 2);
  if ((uint *)((ulonglong)param_2 + (longlong)param_1) < param_1) {
    puVar5 = puVar4;
  }
  if (puVar5 != (uint *)0x0) {
    do {
      uVar3 = (uint)puVar1 ^ *param_1;
      puVar1 = (uint *)(ulonglong)uVar3;
      puVar4 = (uint *)((longlong)puVar4 + 1);
      param_1 = param_1 + 1;
    } while (puVar4 < puVar5);
    bVar2 = (byte)uVar3;
  }
  return (uint)((ulonglong)puVar1 >> 0x18) ^ (uint)((ulonglong)puVar1 >> 0x10) ^ (uint)puVar1 >> 8 ^
         (uint)bVar2;
}



undefined8 FUN_18001adc0(undefined4 *param_1,undefined (**param_2) [16])

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined (*pauVar4) [16];
  
  pauVar4 = (undefined (*) [16])LocalAlloc(0,0x58);
  FUN_18001d980(pauVar4,0,0x58);
  if (param_1 != (undefined4 *)0x0) {
    uVar1 = param_1[1];
    uVar2 = param_1[2];
    uVar3 = param_1[3];
    *(undefined4 *)*pauVar4 = *param_1;
    *(undefined4 *)(*pauVar4 + 4) = uVar1;
    *(undefined4 *)(*pauVar4 + 8) = uVar2;
    *(undefined4 *)(*pauVar4 + 0xc) = uVar3;
    *(undefined8 *)pauVar4[1] = *(undefined8 *)(param_1 + 4);
    if (*(longlong *)(param_1 + 2) != 0) {
      *(undefined4 *)(pauVar4[1] + 8) = 1;
    }
  }
  *(undefined4 *)pauVar4[2] = 0xffffffff;
  *param_2 = pauVar4;
  return 1;
}



void FUN_18001ae40(HLOCAL param_1)

{
  undefined8 *hMem;
  undefined8 *hMem_00;
  
  if (*(HLOCAL *)((longlong)param_1 + 0x28) != (HLOCAL)0x0) {
    LocalFree(*(HLOCAL *)((longlong)param_1 + 0x28));
  }
  if (*(HLOCAL *)((longlong)param_1 + 0x30) != (HLOCAL)0x0) {
    LocalFree(*(HLOCAL *)((longlong)param_1 + 0x30));
  }
  hMem = *(undefined8 **)((longlong)param_1 + 0x40);
  while (hMem != (undefined8 *)0x0) {
    *(undefined8 *)((longlong)param_1 + 0x40) = *hMem;
    hMem_00 = (undefined8 *)hMem[1];
    while (hMem_00 != (undefined8 *)0x0) {
      hMem[1] = *hMem_00;
      LocalFree(hMem_00);
      hMem_00 = (undefined8 *)hMem[1];
    }
    LocalFree(hMem);
    hMem = *(undefined8 **)((longlong)param_1 + 0x40);
  }
                    // WARNING: Could not recover jumptable at 0x00018001aec8. Too many branches
                    // WARNING: Treating indirect jump as call
  LocalFree(param_1);
  return;
}



bool FUN_18001aed0(undefined8 param_1,longlong param_2,longlong param_3,uint *param_4)

{
  undefined8 *puVar1;
  longlong lVar2;
  
  if ((param_3 != 0) && (*(uint *)(param_2 + 0x10) <= *param_4)) {
    *param_4 = 0;
    for (puVar1 = *(undefined8 **)(param_2 + 8); puVar1 != (undefined8 *)0x0;
        puVar1 = (undefined8 *)*puVar1) {
      lVar2 = puVar1[1];
      FUN_18001d320((undefined8 *)((ulonglong)*param_4 + param_3),
                    (undefined8 *)(lVar2 + -0xff0 + (ulonglong)*(ushort *)(lVar2 + 10)),
                    (ulonglong)*(ushort *)(lVar2 + 0xc));
      *param_4 = *param_4 + (uint)*(ushort *)(lVar2 + 0xc);
    }
    return true;
  }
  *param_4 = *(uint *)(param_2 + 0x10);
  return param_3 == 0;
}



undefined8 FUN_18001af80(longlong param_1,int param_2,longlong *param_3)

{
  undefined8 *puVar1;
  
  puVar1 = *(undefined8 **)(param_1 + 0x40);
  if (param_2 == 0) {
    if (puVar1 != (undefined8 *)0x0) {
LAB_18001af8d:
      *param_3 = (longlong)puVar1;
      return 1;
    }
  }
  else {
    for (; puVar1 != (undefined8 *)0x0; puVar1 = (undefined8 *)*puVar1) {
      if (*(int *)((longlong)puVar1 + 0x14) == param_2) goto LAB_18001af8d;
    }
  }
  return 0;
}



bool FUN_18001afb0(longlong param_1,undefined8 *param_2,uint *param_3)

{
  ushort uVar1;
  
  uVar1 = *(ushort *)(*(longlong *)(param_1 + 0x28) + 2);
  if (uVar1 == 0) {
    return false;
  }
  if (param_2 != (undefined8 *)0x0) {
    if ((uint)uVar1 <= *param_3) {
      if ((uint)uVar1 < *param_3) {
        *param_3 = (uint)uVar1;
      }
      FUN_18001d320(param_2,(undefined8 *)
                            (*(longlong *)(param_1 + 0x28) + 0x10 +
                            (ulonglong)*(ushort *)(*(longlong *)(param_1 + 0x28) + 0xe) * 2),
                    (ulonglong)*param_3);
      return true;
    }
  }
  *param_3 = (uint)uVar1;
  return param_2 == (undefined8 *)0x0;
}



undefined8 FUN_18001b020(longlong param_1,ushort param_2,longlong param_3)

{
  longlong lVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  undefined (*hMem) [16];
  undefined8 *puVar5;
  undefined8 *puVar6;
  undefined8 *puVar7;
  undefined8 *puVar8;
  longlong *plVar9;
  short sVar10;
  undefined8 *puVar11;
  short sVar12;
  uint *puVar13;
  uint uVar14;
  short sVar15;
  short sVar16;
  short sVar17;
  ulonglong uVar18;
  int iVar19;
  ulonglong uVar20;
  undefined8 *puVar21;
  
  puVar21 = (undefined8 *)0x0;
  uVar14 = 0xffffffff;
  iVar19 = 0;
  if ((((param_3 == 0) || (param_2 == 0)) || (param_1 == 0)) || (*(longlong *)(param_1 + 0x50) != 0)
     ) {
    return 0;
  }
  if (param_2 != 0) {
    puVar13 = (uint *)(param_3 + 0xff4);
    uVar18 = (ulonglong)(((uint)param_2 * 0x1000 - 1 >> 0xc) + 1);
    do {
      uVar3 = puVar13[-1];
      if (((uVar3 == 0x4b4c42) || (uVar3 == 0x424154)) &&
         ((*(char *)((longlong)puVar13 + 0xb) == '\0' &&
          ((uVar4 = FUN_18001ad10(puVar13 + -0x3fd,0x1000), (char)uVar4 == '\0' &&
           (uVar3 == 0x424154)))))) {
        if ((iVar19 == 0) || ((uVar3 = *puVar13, uVar14 < uVar3 && (uVar3 - uVar14 < 0x7fffffff))))
        {
          uVar14 = *puVar13;
LAB_18001b123:
          puVar21 = (undefined8 *)(puVar13 + -0x3fd);
        }
        else {
          if ((uVar3 == uVar14) &&
             ((*(ushort *)
                ((longlong)puVar13 +
                ((ulonglong)((longlong)puVar13 + (-0xff4 - param_3)) >> 0xc) * 2 + -0xfe4) & 0x9000)
              == 0x1000)) goto LAB_18001b123;
        }
        iVar19 = iVar19 + 1;
      }
      puVar13 = puVar13 + 0x400;
      uVar18 = uVar18 - 1;
    } while (uVar18 != 0);
    if (iVar19 != 0) {
      *(uint *)(param_1 + 0x1c) = uVar14;
      *(longlong *)(param_1 + 0x50) = param_3;
      sVar17 = 0;
      sVar16 = 0;
      sVar15 = 0;
      sVar10 = 0;
      *(int *)(param_1 + 0x20) =
           (int)((longlong)
                 ((longlong)(undefined8 *)((longlong)puVar21 - param_3) +
                 (ulonglong)
                 ((uint)((longlong)(undefined8 *)((longlong)puVar21 - param_3) >> 0x3f) & 0xfff)) >>
                0xc);
      sVar12 = sVar17;
      if (*(ushort *)((longlong)puVar21 + 0xe) != 0) {
        puVar6 = puVar21 + 2;
        uVar18 = (ulonglong)*(ushort *)((longlong)puVar21 + 0xe);
        do {
          uVar2 = *(ushort *)puVar6;
          if ((uVar2 & 0x8000) == 0) {
            if ((uVar2 & 0x1000) == 0) {
LAB_18001b1cb:
              if (((uVar2 & 0x2000) != 0) && (sVar12 = sVar12 + 1, (uVar2 & 0x4000) != 0)) {
                sVar10 = sVar10 + 1;
              }
            }
            else {
              sVar17 = sVar17 + 1;
              if ((uVar2 & 0x2000) != 0) {
                sVar16 = sVar16 + 1;
                goto LAB_18001b1cb;
              }
            }
            sVar15 = sVar15 + 1;
          }
          puVar6 = (undefined8 *)((longlong)puVar6 + 2);
          uVar18 = uVar18 - 1;
        } while (uVar18 != 0);
      }
      uVar18 = 0;
      if ((((*(short *)((longlong)puVar21 + 4) != sVar17) ||
           (*(short *)((longlong)puVar21 + 6) != sVar16)) || (*(short *)(puVar21 + 1) != sVar12)) ||
         ((*(short *)((longlong)puVar21 + 10) != sVar10 ||
          (*(short *)((longlong)puVar21 + 0xc) != sVar15)))) {
        *(short *)((longlong)puVar21 + 4) = sVar17;
        *(short *)((longlong)puVar21 + 6) = sVar16;
        *(short *)(puVar21 + 1) = sVar12;
        *(short *)((longlong)puVar21 + 10) = sVar10;
        *(short *)((longlong)puVar21 + 0xc) = sVar15;
      }
      puVar6 = (undefined8 *)LocalAlloc(0,(ulonglong)*(ushort *)puVar21);
      *(undefined8 **)(param_1 + 0x28) = puVar6;
      FUN_18001d320(puVar6,puVar21,(ulonglong)*(ushort *)puVar21);
      puVar6 = (undefined8 *)LocalAlloc(0,(ulonglong)*(ushort *)puVar21);
      *(undefined8 **)(param_1 + 0x30) = puVar6;
      FUN_18001d320(puVar6,puVar21,(ulonglong)*(ushort *)puVar21);
      hMem = (undefined (*) [16])LocalAlloc(0,0x8000);
      FUN_18001d980(hMem,0,0x8000);
      uVar20 = uVar18;
      if (*(short *)((longlong)puVar21 + 0xe) != 0) {
        do {
          uVar2 = *(ushort *)((longlong)puVar21 + uVar20 * 2 + 0x10);
          if ((uVar2 & 0x9000) == 0x1000) {
            lVar1 = uVar18 + *(longlong *)(param_1 + 0x50) + 0xff0;
            uVar14 = uVar2 & 0xffff0fff;
            if (((uVar2 & 0xfff) != 0) && (*(short *)(lVar1 + 0xc) != 0)) {
              puVar6 = *(undefined8 **)(*hMem + (ulonglong)uVar14 * 8);
              if (puVar6 == (undefined8 *)0x0) {
                puVar6 = (undefined8 *)LocalAlloc(0,0x20);
                *(undefined8 **)(*hMem + (ulonglong)uVar14 * 8) = puVar6;
                *puVar6 = 0;
                puVar6[1] = 0;
                puVar6[2] = 0;
                puVar6[3] = 0;
                *(uint *)((longlong)puVar6 + 0x14) = uVar14;
                puVar11 = (undefined8 *)(param_1 + 0x40);
                for (puVar8 = *(undefined8 **)(undefined8 *)(param_1 + 0x40);
                    (puVar8 != (undefined8 *)0x0 &&
                    (*(uint *)((longlong)puVar8 + 0x14) < uVar14 ||
                     *(uint *)((longlong)puVar8 + 0x14) == uVar14)); puVar8 = (undefined8 *)*puVar8)
                {
                  puVar11 = puVar8;
                }
                *puVar6 = puVar8;
                *puVar11 = puVar6;
                *(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x48) + 1;
              }
              puVar5 = (undefined8 *)LocalAlloc(0,0x10);
              puVar11 = puVar6 + 1;
              *puVar5 = 0;
              puVar5[1] = lVar1;
              puVar8 = (undefined8 *)*puVar11;
              if (puVar8 != (undefined8 *)0x0) {
                do {
                  puVar7 = puVar8;
                  puVar8 = puVar7;
                  if (*(ushort *)(lVar1 + 8) <= *(ushort *)(puVar7[1] + 8) &&
                      *(ushort *)(puVar7[1] + 8) != *(ushort *)(lVar1 + 8)) break;
                  puVar8 = (undefined8 *)*puVar7;
                  puVar11 = puVar7;
                } while (puVar8 != (undefined8 *)0x0);
              }
              *puVar5 = puVar8;
              *puVar11 = puVar5;
              *(uint *)(puVar6 + 2) = *(int *)(puVar6 + 2) + (uint)*(ushort *)(lVar1 + 0xc);
              *(int *)(puVar6 + 3) = *(int *)(puVar6 + 3) + 1;
            }
          }
          uVar14 = (int)uVar20 + 1;
          uVar18 = (ulonglong)((int)uVar18 + 0x1000);
          uVar20 = (ulonglong)uVar14;
        } while (uVar14 < *(ushort *)((longlong)puVar21 + 0xe));
      }
      LocalFree(hMem);
      plVar9 = *(longlong **)(param_1 + 0x40);
      *(undefined4 *)(param_1 + 0x4c) = 1;
      if (plVar9 != (longlong *)0x0) {
        iVar19 = 1;
        do {
          if (iVar19 == *(int *)((longlong)plVar9 + 0x14)) {
            iVar19 = iVar19 + 1;
            *(int *)(param_1 + 0x4c) = iVar19;
          }
          plVar9 = (longlong *)*plVar9;
        } while (plVar9 != (longlong *)0x0);
      }
      if (0xfff < *(uint *)(param_1 + 0x4c)) {
        *(undefined4 *)(param_1 + 0x4c) = 0;
      }
      return 1;
    }
  }
  return 0;
}



uint FUN_18001b440(HANDLE *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  BOOL BVar1;
  DWORD DVar2;
  DWORD local_res8 [2];
  
  FUN_180017f20(4,(longlong)L">>> CleanSSO",param_3,param_4);
  DVar2 = 0;
  if (*param_1 == (HANDLE)0x0) {
    DVar2 = 0x80070006;
  }
  else {
    param_4 = 0;
    BVar1 = DeviceIoControl(*param_1,0x44200c,(LPVOID)0x0,0,(LPVOID)0x0,0,local_res8,
                            (LPOVERLAPPED)0x0);
    if ((BVar1 == 0) && (DVar2 = GetLastError(), 0 < (int)DVar2)) {
      DVar2 = DVar2 & 0xffff | 0x80070000;
    }
  }
  FUN_180017f20(4,(longlong)L"<<< CleanSSO : ErrorCode [0x%08X]",(ulonglong)DVar2,param_4);
  return (uint)DVar2;
}



void FUN_18001b4e0(void)

{
  undefined auVar1 [16];
  DWORD dwErrCode;
  BOOL BVar2;
  DWORD DVar3;
  unsigned___int64 uVar4;
  HDEVINFO DeviceInfoSet;
  PSP_DEVICE_INTERFACE_DETAIL_DATA_W DeviceInterfaceDetailData;
  HANDLE pvVar5;
  DWORD local_258 [2];
  _SP_DEVICE_INTERFACE_DATA local_250;
  wchar_t local_228 [264];
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd68;
  dwErrCode = 0;
  DeviceInfoSet = SetupDiGetClassDevsW((GUID *)&DAT_180030900,(PCWSTR)0x0,(HWND)0x0,0x12);
  if (DeviceInfoSet == (HDEVINFO)0xffffffffffffffff) {
    dwErrCode = GetLastError();
    goto LAB_18001b64f;
  }
  local_250.cbSize = 0x20;
  BVar2 = SetupDiEnumDeviceInterfaces
                    (DeviceInfoSet,(PSP_DEVINFO_DATA)0x0,(GUID *)&DAT_180030900,0,
                     (PSP_DEVICE_INTERFACE_DATA)&local_250);
  DeviceInterfaceDetailData = (PSP_DEVICE_INTERFACE_DETAIL_DATA_W)0x0;
  if (BVar2 == 0) {
LAB_18001b631:
    dwErrCode = GetLastError();
  }
  else {
    SetupDiGetDeviceInterfaceDetailW
              (DeviceInfoSet,(PSP_DEVICE_INTERFACE_DATA)&local_250,
               (PSP_DEVICE_INTERFACE_DETAIL_DATA_W)0x0,0,local_258,(PSP_DEVINFO_DATA)0x0);
    DVar3 = GetLastError();
    DeviceInterfaceDetailData = (PSP_DEVICE_INTERFACE_DETAIL_DATA_W)0x0;
    if (DVar3 != 0x7a) goto LAB_18001b631;
    auVar1 = ZEXT816(2) * ZEXT416(local_258[0] + 1);
    uVar4 = SUB164(auVar1,0);
    if (SUB168(auVar1 >> 0x40,0) != 0) {
      uVar4 = 0xffffffff;
    }
    DeviceInterfaceDetailData = (PSP_DEVICE_INTERFACE_DETAIL_DATA_W)operator_new(uVar4);
    if (DeviceInterfaceDetailData == (PSP_DEVICE_INTERFACE_DETAIL_DATA_W)0x0) goto LAB_18001b631;
    DeviceInterfaceDetailData->cbSize = 8;
    BVar2 = SetupDiGetDeviceInterfaceDetailW
                      (DeviceInfoSet,(PSP_DEVICE_INTERFACE_DATA)&local_250,DeviceInterfaceDetailData
                       ,local_258[0],(PDWORD)0x0,(PSP_DEVINFO_DATA)0x0);
    if (BVar2 == 0) goto LAB_18001b631;
    wcscpy_s(local_228,0x104,DeviceInterfaceDetailData->DevicePath);
    pvVar5 = CreateFileW(local_228,0xc0000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
    if (pvVar5 == (HANDLE)0xffffffffffffffff) goto LAB_18001b631;
  }
  SetupDiDestroyDeviceInfoList(DeviceInfoSet);
  if (DeviceInterfaceDetailData != (PSP_DEVICE_INTERFACE_DETAIL_DATA_W)0x0) {
    free(DeviceInterfaceDetailData);
  }
LAB_18001b64f:
  SetLastError(dwErrCode);
  FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xfffffffffffffd68);
  return;
}



// WARNING: Could not reconcile some variable overlaps

uint FUN_18001b690(longlong param_1,uint param_2)

{
  int iVar1;
  bool bVar2;
  undefined8 *hMem;
  undefined7 extraout_var;
  ulonglong uVar3;
  byte *pbVar4;
  uint local_res10;
  uint local_res18 [2];
  
  local_res18[0] = 0;
  FUN_18001afb0(param_1,(undefined8 *)0x0,local_res18);
  if (local_res18[0] != 0) {
    hMem = (undefined8 *)LocalAlloc(0,(ulonglong)local_res18[0]);
    bVar2 = FUN_18001afb0(param_1,hMem,local_res18);
    if (((int)CONCAT71(extraout_var,bVar2) != 0) && (local_res18[0] != 0)) {
      pbVar4 = (byte *)((longlong)hMem + 4);
      uVar3 = (ulonglong)((local_res18[0] - 1) / 5 + 1);
      local_res10 = param_2;
      do {
        iVar1 = *(int *)(pbVar4 + -4);
        if (iVar1 == 0x4d414730) {
          local_res10 = local_res10 & 0xffffff00 | (uint)*pbVar4;
        }
        else {
          if (iVar1 == 0x4d414731) {
            local_res10._0_2_ = CONCAT11(*pbVar4,(undefined)local_res10);
            local_res10 = local_res10 & 0xffff0000 | (uint)(ushort)local_res10;
          }
          else {
            if (iVar1 == 0x4d414732) {
              local_res10._0_3_ = CONCAT12(*pbVar4,(ushort)local_res10);
              local_res10 = local_res10 & 0xff000000 | (uint)(uint3)local_res10;
            }
            else {
              if (iVar1 == 0x4d414733) {
                local_res10 = local_res10 & 0xffffff | (uint)*pbVar4 << 0x18;
              }
            }
          }
        }
        pbVar4 = pbVar4 + 5;
        uVar3 = uVar3 - 1;
        param_2 = local_res10;
      } while (uVar3 != 0);
    }
    LocalFree(hMem);
  }
  return param_2;
}



ulonglong FUN_18001b770(longlong param_1,int param_2,LPVOID *param_3,uint *param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  BOOL BVar4;
  DWORD DVar5;
  uint uVar6;
  undefined8 uVar7;
  undefined4 *puVar8;
  ulonglong dwBytes;
  LPVOID pvVar9;
  HANDLE pvVar10;
  longlong *plVar11;
  longlong lVar12;
  uint uVar13;
  wchar_t *pwVar14;
  ulonglong uVar15;
  longlong *lpBuffer;
  longlong *lpMem;
  HANDLE hFile;
  undefined8 uVar16;
  longlong *plVar17;
  longlong *lpNumberOfBytesRead;
  uint *puVar18;
  uint local_res8 [2];
  longlong local_48;
  undefined (*local_40) [16];
  undefined (*local_38) [16];
  longlong local_30;
  
  lVar12 = *(longlong *)(param_1 + 0x38);
  plVar11 = (longlong *)0x0;
  pwVar14 = (wchar_t *)(lVar12 + 0x20);
  lpMem = (longlong *)0x0;
  local_40 = (undefined (*) [16])0x0;
  local_38 = (undefined (*) [16])0x0;
  lpBuffer = (longlong *)0x0;
  if (*pwVar14 == L'\0') {
    uVar7 = 1;
    BVar4 = SHGetSpecialFolderPathW((HWND)0x0,pwVar14,0x23,1);
    if (BVar4 != 0) {
      wcscat_s(pwVar14,0x104,L"\\EgisTec\\Common\\BackupFile.bin");
      goto LAB_18001b7e6;
    }
    hFile = (HANDLE)0xffffffffffffffff;
  }
  else {
LAB_18001b7e6:
    uVar7 = 0;
    hFile = CreateFileW(pwVar14,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,2,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffffffffffff) {
      pvVar10 = GetProcessHeap();
      uVar16 = 0x400000;
      lpBuffer = (longlong *)HeapAlloc(pvVar10,8,0x400000);
      if (lpBuffer == (longlong *)0x0) {
        FUN_180017f20(4,(longlong)L"PBACheckFPIDValid : Allocate backup memory fail\r\n",uVar16,
                      uVar7);
        uVar15 = 0x8007000e;
        goto LAB_18001bb56;
      }
      lpNumberOfBytesRead = (longlong *)0x0;
      DVar5 = SetFilePointer(hFile,4,(PLONG)0x0,0);
      if (DVar5 != 0xffffffff) {
        lpNumberOfBytesRead = &local_48;
        plVar17 = (longlong *)0x400000;
        BVar4 = ReadFile(hFile,lpBuffer,0x400000,(LPDWORD)lpNumberOfBytesRead,(LPOVERLAPPED)0x0);
        if (BVar4 != 0) {
          uVar7 = FUN_18001adc0((undefined4 *)0x0,&local_38);
          if (((int)uVar7 == 0) ||
             (plVar17 = lpBuffer, uVar7 = FUN_18001b020((longlong)local_38,0x400,(longlong)lpBuffer)
             , (int)uVar7 == 0)) {
            pwVar14 = L"PBACheckFPIDValid : CreateFlashControl( Backup ) Fail";
LAB_18001bb47:
            uVar15 = 0xa0098010;
            lpMem = plVar11;
          }
          else {
            pvVar10 = GetProcessHeap();
            plVar17 = (longlong *)0x400000;
            lpMem = (longlong *)HeapAlloc(pvVar10,8,0x400000);
            if (lpMem == (longlong *)0x0) {
              FUN_180017f20(4,(longlong)L"PBACheckFPIDValid : Allocate cache memory fail\r\n",
                            plVar17,lpNumberOfBytesRead);
              uVar15 = 0x8007000e;
              goto LAB_18001bb56;
            }
            puVar8 = *(undefined4 **)(lVar12 + 0x4248);
            if (puVar8 == (undefined4 *)0x0) {
              plVar17 = (longlong *)0x400;
              lpNumberOfBytesRead = lpMem;
              uVar13 = FUN_18001bc50(param_1,0,0x400,lpMem);
              if (0 < (int)uVar13) {
                uVar13 = uVar13 & 0xffff | 0x80070000;
              }
              uVar15 = (ulonglong)uVar13;
              if ((int)uVar13 < 0) goto LAB_18001bb56;
            }
            else {
              lVar12 = 0x8000;
              plVar11 = lpMem;
              do {
                uVar1 = puVar8[1];
                uVar2 = puVar8[2];
                uVar3 = puVar8[3];
                *(undefined4 *)plVar11 = *puVar8;
                *(undefined4 *)((longlong)plVar11 + 4) = uVar1;
                *(undefined4 *)(plVar11 + 1) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0xc) = uVar3;
                uVar1 = puVar8[5];
                uVar2 = puVar8[6];
                uVar3 = puVar8[7];
                *(undefined4 *)(plVar11 + 2) = puVar8[4];
                *(undefined4 *)((longlong)plVar11 + 0x14) = uVar1;
                *(undefined4 *)(plVar11 + 3) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x1c) = uVar3;
                uVar1 = puVar8[9];
                uVar2 = puVar8[10];
                uVar3 = puVar8[0xb];
                *(undefined4 *)(plVar11 + 4) = puVar8[8];
                *(undefined4 *)((longlong)plVar11 + 0x24) = uVar1;
                *(undefined4 *)(plVar11 + 5) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x2c) = uVar3;
                uVar1 = puVar8[0xd];
                uVar2 = puVar8[0xe];
                uVar3 = puVar8[0xf];
                *(undefined4 *)(plVar11 + 6) = puVar8[0xc];
                *(undefined4 *)((longlong)plVar11 + 0x34) = uVar1;
                *(undefined4 *)(plVar11 + 7) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x3c) = uVar3;
                uVar1 = puVar8[0x11];
                uVar2 = puVar8[0x12];
                uVar3 = puVar8[0x13];
                *(undefined4 *)(plVar11 + 8) = puVar8[0x10];
                *(undefined4 *)((longlong)plVar11 + 0x44) = uVar1;
                *(undefined4 *)(plVar11 + 9) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x4c) = uVar3;
                uVar1 = puVar8[0x15];
                uVar2 = puVar8[0x16];
                uVar3 = puVar8[0x17];
                *(undefined4 *)(plVar11 + 10) = puVar8[0x14];
                *(undefined4 *)((longlong)plVar11 + 0x54) = uVar1;
                *(undefined4 *)(plVar11 + 0xb) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x5c) = uVar3;
                uVar1 = puVar8[0x19];
                uVar2 = puVar8[0x1a];
                uVar3 = puVar8[0x1b];
                *(undefined4 *)(plVar11 + 0xc) = puVar8[0x18];
                *(undefined4 *)((longlong)plVar11 + 100) = uVar1;
                *(undefined4 *)(plVar11 + 0xd) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x6c) = uVar3;
                uVar1 = puVar8[0x1d];
                uVar2 = puVar8[0x1e];
                uVar3 = puVar8[0x1f];
                *(undefined4 *)(plVar11 + 0xe) = puVar8[0x1c];
                *(undefined4 *)((longlong)plVar11 + 0x74) = uVar1;
                *(undefined4 *)(plVar11 + 0xf) = uVar2;
                *(undefined4 *)((longlong)plVar11 + 0x7c) = uVar3;
                lVar12 = lVar12 + -1;
                puVar8 = puVar8 + 0x20;
                plVar11 = plVar11 + 0x10;
              } while (lVar12 != 0);
            }
            uVar7 = FUN_18001adc0((undefined4 *)0x0,&local_40);
            if (((int)uVar7 == 0) ||
               (plVar17 = lpMem, uVar7 = FUN_18001b020((longlong)local_40,0x400,(longlong)lpMem),
               (int)uVar7 == 0)) {
              pwVar14 = L"PBACheckFPIDValid : CreateFlashControl( Flash ) Fail";
              plVar11 = lpMem;
              goto LAB_18001bb47;
            }
            uVar13 = FUN_18001b690((longlong)local_38,0xffffffff);
            uVar6 = FUN_18001b690((longlong)local_40,0);
            if (uVar6 == uVar13) {
              plVar17 = &local_30;
              uVar15 = 0;
              local_30 = 0;
              uVar7 = FUN_18001af80((longlong)local_40,param_2,plVar17);
              if ((int)uVar7 != 0) {
                if ((param_3 != (LPVOID *)0x0) || (param_4 != (uint *)0x0)) {
                  puVar18 = local_res8;
                  local_res8[0] = 0;
                  FUN_18001aed0(local_40,local_30,0,puVar18);
                  dwBytes = (ulonglong)local_res8[0];
                  if (param_4 != (uint *)0x0) {
                    *param_4 = local_res8[0];
                  }
                  if (param_3 != (LPVOID *)0x0) {
                    pvVar10 = GetProcessHeap();
                    pvVar9 = HeapAlloc(pvVar10,8,dwBytes);
                    *param_3 = pvVar9;
                    if (pvVar9 == (LPVOID)0x0) {
                      FUN_180017f20(4,(longlong)
                                      L"PBACheckFPIDValid : Allocate record memory fail\r\n",dwBytes
                                    ,puVar18);
                      uVar15 = 0x8007000e;
                    }
                    else {
                      FUN_18001aed0(local_40,local_30,(longlong)pvVar9,local_res8);
                    }
                  }
                }
                goto LAB_18001bb56;
              }
              uVar15 = 0xa0098012;
              pwVar14 = L"PBACheckFPIDValid : FPID is incorrect, Fail";
            }
            else {
              uVar15 = 0xa0098012;
              pwVar14 = L"PBACheckFPIDValid : DB is incorrect, Fail";
            }
          }
          FUN_180017f20(4,(longlong)pwVar14,plVar17,lpNumberOfBytesRead);
          goto LAB_18001bb56;
        }
      }
      uVar13 = GetLastError();
      if (0 < (int)uVar13) {
        uVar13 = uVar13 & 0xffff | 0x80070000;
      }
      uVar15 = (ulonglong)uVar13;
      FUN_180017f20(4,(longlong)L"PBACheckFPIDValid : ReadFile ErrorCode [0x%08X]",uVar15,
                    lpNumberOfBytesRead);
      goto LAB_18001bb56;
    }
  }
  DVar5 = GetLastError();
  uVar15 = (ulonglong)DVar5;
  if (DVar5 - 2 < 2) {
    uVar15 = 0xa0098010;
  }
  else {
    if (0 < (int)DVar5) {
      uVar13 = DVar5 & 0xffff | 0x80070000;
      uVar15 = (ulonglong)uVar13;
      FUN_180017f20(4,(longlong)L"PBACheckFPIDValid : CreateFile ErrorCode [0x%08X]",
                    (ulonglong)uVar13,uVar7);
      lpBuffer = plVar11;
      lpMem = plVar11;
      goto LAB_18001bb56;
    }
  }
  FUN_180017f20(4,(longlong)L"PBACheckFPIDValid : CreateFile ErrorCode [0x%08X]",uVar15,uVar7);
LAB_18001bb56:
  if (local_40 != (undefined (*) [16])0x0) {
    FUN_18001ae40(local_40);
  }
  if (lpMem != (longlong *)0x0) {
    pvVar10 = GetProcessHeap();
    HeapFree(pvVar10,0,lpMem);
  }
  if (local_38 != (undefined (*) [16])0x0) {
    FUN_18001ae40(local_38);
  }
  if (lpBuffer != (longlong *)0x0) {
    pvVar10 = GetProcessHeap();
    HeapFree(pvVar10,0,lpBuffer);
  }
  if (hFile != (HANDLE)0xffffffffffffffff) {
    CloseHandle(hFile);
  }
  return uVar15;
}



undefined8 FUN_18001bbe0(longlong param_1)

{
  longlong lVar1;
  LPVOID lpMem;
  HANDLE hHeap;
  
  lVar1 = *(longlong *)(param_1 + 0x38);
  lpMem = *(LPVOID *)(lVar1 + 0x4248);
  if (lpMem != (LPVOID)0x0) {
    hHeap = GetProcessHeap();
    HeapFree(hHeap,0,lpMem);
    *(undefined8 *)(lVar1 + 0x4248) = 0;
  }
  if (*(HLOCAL *)(lVar1 + 0x228) != (HLOCAL)0x0) {
    FUN_18001ae40(*(HLOCAL *)(lVar1 + 0x228));
    *(undefined8 *)(lVar1 + 0x228) = 0;
  }
  *(uint *)(lVar1 + 0x4258) = *(uint *)(lVar1 + 0x4258) & 0xfffffffb;
  return 0;
}



DWORD FUN_18001bc50(longlong param_1,short param_2,ushort param_3,undefined8 *param_4)

{
  longlong lVar1;
  DWORD DVar2;
  BOOL BVar3;
  HANDLE hDevice;
  uint uVar4;
  uint uVar5;
  ulonglong uVar6;
  DWORD local_38 [2];
  longlong local_30;
  
  hDevice = (HANDLE)FUN_18001b4e0();
  if (hDevice == (HANDLE)0xffffffffffffffff) {
    DVar2 = GetLastError();
    return DVar2;
  }
  lVar1 = *(longlong *)(param_1 + 0x38);
  uVar6 = (ulonglong)param_3 << 0xc;
  DVar2 = 0;
  local_30 = lVar1;
  if ((int)uVar6 != 0) {
    while( true ) {
      uVar5 = (uint)uVar6;
      uVar4 = uVar5;
      if (0x4000 < uVar5) {
        uVar4 = 0x4000;
      }
      *(undefined2 *)(lVar1 + 0x238) = 0;
      *(short *)(lVar1 + 0x23a) = param_2;
      *(short *)(lVar1 + 0x23c) = (short)uVar4;
      *(undefined4 *)(lVar1 + 0x240) = 0;
      BVar3 = DeviceIoControl(hDevice,0x80102048,(LPVOID)(lVar1 + 0x230),0x4014,
                              (LPVOID)(lVar1 + 0x230),0x4014,local_38,(LPOVERLAPPED)0x0);
      if (BVar3 == 0) break;
      FUN_18001d320(param_4,(undefined8 *)(local_30 + 0x244),(ulonglong)uVar4);
      param_4 = (undefined8 *)((longlong)param_4 + (ulonglong)uVar4);
      param_2 = param_2 + (short)(uVar4 >> 0xc);
      uVar6 = (ulonglong)(uVar5 - uVar4);
      DVar2 = 0;
      if (uVar5 - uVar4 == 0) goto LAB_18001bd62;
      FUN_18001bda0(1000);
    }
    DVar2 = GetLastError();
  }
LAB_18001bd62:
  CloseHandle(hDevice);
  SetLastError(DVar2);
  return DVar2;
}



ulonglong FUN_18001bda0(longlong param_1)

{
  undefined auVar1 [16];
  BOOL BVar2;
  ulonglong uVar3;
  undefined4 extraout_var;
  ulonglong uVar4;
  ulonglong local_res8;
  ulonglong local_res10 [3];
  
  QueryPerformanceFrequency(local_res10);
  QueryPerformanceCounter(&local_res8);
  uVar3 = local_res10[0] * param_1 * 0x431bde82d7b634db;
  uVar4 = (local_res10[0] * param_1) / 1000000 + local_res8;
  do {
    if (uVar4 <= local_res8) {
      return uVar3;
    }
    auVar1 = ZEXT816((uVar4 - local_res8) * 1000) / ZEXT816(local_res10[0]);
    if (10 < SUB168(auVar1,0)) {
      Sleep(SUB164(auVar1,0) - 5);
    }
    BVar2 = QueryPerformanceCounter(&local_res8);
    uVar3 = CONCAT44(extraout_var,BVar2);
  } while (BVar2 != 0);
  return CONCAT44(extraout_var,BVar2);
}



void FUN_18001be30(wchar_t *param_1,wchar_t *param_2,undefined8 param_3,undefined8 param_4)

{
  undefined8 local_res18;
  undefined8 local_res20;
  
  local_res18 = param_3;
  local_res20 = param_4;
  FUN_18001de94(param_1,0x104,param_2,(va_list)&local_res18);
  return;
}



undefined ** FUN_18001be60(undefined **param_1,int param_2,int param_3)

{
  undefined *puVar1;
  
  FUN_180016e90(param_1);
  param_1[2] = (undefined *)0x0;
  *(int *)(param_1 + 4) = param_2;
  *param_1 = (undefined *)CTouchSensor::vftable;
  *(undefined8 *)((longlong)param_1 + 0x74) = 1;
  *(int *)((longlong)param_1 + 0x24) = param_3;
  *(int *)(param_1 + 5) = param_2 * param_3;
  puVar1 = (undefined *)LocalAlloc(0,(longlong)(param_2 * param_3));
  param_1[3] = puVar1;
  puVar1 = (undefined *)LocalAlloc(0,0x3c000);
  param_1[6] = puVar1;
  *(undefined4 *)(param_1 + 7) = 0;
  puVar1 = (undefined *)LocalAlloc(0,(longlong)*(int *)(param_1 + 5));
  param_1[9] = (undefined *)0x0;
  param_1[8] = puVar1;
  puVar1 = (undefined *)LocalAlloc(0,0x3c000);
  param_1[0xd] = puVar1;
  puVar1 = (undefined *)LocalAlloc(0,0x3c000);
  *(undefined4 *)(param_1 + 0xc) = 0;
  *(undefined4 *)(param_1 + 10) = 0;
  *(undefined4 *)(param_1 + 0xe) = 0;
  param_1[0xb] = puVar1;
  *(undefined4 *)(param_1 + 0x52) = 0x40;
  puVar1 = (undefined *)LocalAlloc(0x40,0x40);
  param_1[0x51] = puVar1;
  return param_1;
}



void FUN_18001bf40(undefined **param_1)

{
  *param_1 = (undefined *)CTouchSensor::vftable;
  LocalFree(param_1[3]);
  LocalFree(param_1[6]);
  LocalFree(param_1[8]);
  LocalFree(param_1[0xd]);
  LocalFree(param_1[0xb]);
  LocalFree(param_1[0x51]);
  *param_1 = (undefined *)CEngineBase::vftable;
  FUN_180016eb0(param_1);
  return;
}



undefined ** FUN_18001bfb0(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)CEngineBase::vftable;
  FUN_180016eb0(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



void FUN_18001bff0(longlong *param_1,undefined8 *param_2,ulonglong param_3,undefined8 param_4,
                  byte param_5,undefined4 *param_6)

{
  longlong *plVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  uint uVar5;
  SIZE_T SVar6;
  ulonglong uVar7;
  uint local_258;
  int local_254;
  uint local_250;
  DWORD local_24c;
  wchar_t local_248 [264];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd78;
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::AcceptSampleData",param_3,param_4);
  uVar5 = (uint)(param_3 & 0xffffffff);
  FUN_180017f20(1,(longlong)
                  L"CTouchSensor::AcceptSampleData : HorizontalLineLength = %d, VerticalLineLength = %d"
                ,param_3 & 0xffffffff,(ulonglong)*(uint *)(param_1 + 4));
  FUN_18001d320((undefined8 *)param_1[8],param_2,(longlong)(int)((int)param_4 * uVar5));
  FUN_180003fd0(param_1[8],uVar5,(int)param_4,*(int *)(param_1 + 4),
                *(uint *)((longlong)param_1 + 0x24));
  FUN_18001d320((undefined8 *)param_1[3],(undefined8 *)param_1[8],(longlong)*(int *)(param_1 + 5));
  plVar1 = param_1 + 7;
  SVar6 = LocalSize((HLOCAL)param_1[6]);
  *(uint *)plVar1 = (uint)SVar6;
  uVar7 = thunk_FUN_180006af0((undefined8 *)param_1[3],*(int *)(param_1 + 4),
                              (ulonglong)*(uint *)((longlong)param_1 + 0x24),(uint **)param_1[6],
                              (uint *)plVar1,(longlong)&local_258);
  iVar4 = (int)uVar7;
  FUN_180017f20(1,(longlong)
                  L"CTouchSensor::AcceptSampleData : Extract Finish, iResult = %d, quality = %d",
                uVar7 & 0xffffffff,(ulonglong)local_258);
  if (iVar4 == 0) {
    DVar2 = GetCurrentProcessId();
    BVar3 = ProcessIdToSessionId(DVar2,&local_24c);
    if (BVar3 != 0) {
      DVar2 = WTSGetActiveConsoleSessionId();
      if (local_24c == DVar2) {
        FUN_18001d320((undefined8 *)param_1[3],(undefined8 *)param_1[8],
                      (longlong)*(int *)(param_1 + 5));
        iVar4 = (**(code **)(*param_1 + 0x98))(param_1);
        uVar5 = FUN_180003ea0((undefined8 *)param_1[3],*(uint *)(param_1 + 4),
                              *(int *)((longlong)param_1 + 0x24),(int *)&local_250,&local_254,iVar4)
        ;
        FUN_180017f20(1,(longlong)
                        L"CTouchSensor::AcceptSampleData : count_image_type_identifier() = %d, out_amp = %d, out_score = %d"
                      ,(ulonglong)uVar5,(ulonglong)local_250);
        if (uVar5 != 3) {
          *param_6 = 5;
          goto LAB_18001c19a;
        }
      }
    }
    uVar5 = 0;
  }
  else {
    if ((iVar4 == 1) || ((iVar4 != 2 && (iVar4 == 4)))) {
      *param_6 = 9;
    }
    else {
      *param_6 = 7;
    }
LAB_18001c19a:
    uVar5 = 0x80098008;
  }
  if (param_5 == 4) {
    uVar7 = (ulonglong)*(uint *)plVar1;
    FUN_180017f20(1,(longlong)
                    L"CTouchSensor::AcceptSampleData : EnrollmentCount = [%d], FSize = [%d]",
                  (ulonglong)*(uint *)(param_1 + 10),uVar7);
    iVar4 = (*(code *)PTR_FUN_180049018)(param_1 + 2,1);
    if (iVar4 != 0) {
      FUN_18001be30(local_248,L"Enroll_Skeleton_%02d",(ulonglong)*(uint *)(param_1 + 10),uVar7);
      (*(code *)PTR_FUN_180049020)(param_1 + 2,local_248,param_1[3]);
      uVar7 = (ulonglong)local_258;
      FUN_180017f20(1,(longlong)L"CTouchSensor::AcceptSampleData : Log( %s ) with quality %d",
                    local_248,uVar7);
    }
    iVar4 = (*(code *)PTR_FUN_180049018)(param_1 + 2,2);
    if (iVar4 != 0) {
      FUN_18001be30(local_248,L"Enroll_Orininal_%02d",(ulonglong)*(uint *)(param_1 + 10),uVar7);
      (*(code *)PTR_FUN_180049020)(param_1 + 2,local_248,param_1[8]);
      FUN_180017f20(1,(longlong)L"CTouchSensor::AcceptSampleData : Log( %s ) with quality %d",
                    local_248,(ulonglong)local_258);
    }
  }
  else {
    if ((byte)(param_5 - 1) < 2) {
      iVar4 = (*(code *)PTR_FUN_180049018)(param_1 + 2,0x100);
      if (iVar4 != 0) {
        uVar7 = (ulonglong)*(uint *)(param_1 + 4);
        (*(code *)PTR_FUN_180049020)(param_1 + 2,L"Verify_Skeleton");
        FUN_180017f20(1,(longlong)
                        L"CTouchSensor::AcceptSampleData : Log( Verify_Skeleton ) with quality %d",
                      (ulonglong)local_258,uVar7);
      }
      iVar4 = (*(code *)PTR_FUN_180049018)(param_1 + 2,0x200);
      if (iVar4 != 0) {
        uVar7 = (ulonglong)*(uint *)(param_1 + 4);
        (*(code *)PTR_FUN_180049020)(param_1 + 2,L"Verify_Orininal");
        FUN_180017f20(1,(longlong)
                        L"CTouchSensor::AcceptSampleData : Log( Verify_Orininal ) with quality %d",
                      (ulonglong)local_258,uVar7);
      }
    }
  }
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::AcceptSampleData : hr = [0x%08X], Purpose = %d",
                (ulonglong)uVar5,(ulonglong)param_5);
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffd78);
  return;
}



undefined8 FUN_18001c370(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  longlong lVar1;
  undefined *puVar2;
  
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::EngineAdapterClearContext",param_3,param_4);
  puVar2 = *(undefined **)(param_1 + 0x18);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x28); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = *(undefined **)(param_1 + 0x40);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x28); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = *(undefined **)(param_1 + 0x30);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x38); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = *(undefined **)(param_1 + 0x58);
  for (lVar1 = (longlong)*(int *)(param_1 + 0x60); lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::EngineAdapterClearContext",param_3,param_4);
  return 0;
}



undefined8 FUN_18001c3e0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  wchar_t *pwVar1;
  
  pwVar1 = L">>> CTouchSensor::ClearEnrollment";
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::ClearEnrollment",param_3,param_4);
  if (*(char **)(param_1 + 0x48) != (char *)0x0) {
    thunk_FUN_180005d00(*(char **)(param_1 + 0x48),pwVar1,param_3,param_4);
    *(undefined8 *)(param_1 + 0x48) = 0;
  }
  *(undefined4 *)(param_1 + 0x50) = 0;
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::ClearEnrollment",param_3,param_4);
  return 0;
}



undefined8 FUN_18001c430(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  uint uVar1;
  int iVar2;
  LSTATUS LVar3;
  undefined2 *puVar4;
  LPCWSTR lpSubKey;
  HKEY pHVar5;
  undefined4 uVar6;
  wchar_t *pwVar7;
  ulonglong uVar8;
  undefined8 uVar9;
  DWORD local_res8 [2];
  int local_res10 [2];
  HKEY local_res18;
  HKEY local_res20;
  
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::EngineAdapterCreateEnrollment",param_3,param_4);
  uVar9 = 0x20019;
  local_res8[0] = 4;
  local_res18 = (HKEY)0x0;
  uVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,
                        L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WinBio",0,0x20019,
                        (PHKEY)&local_res18);
  if (uVar1 == 0) {
    pwVar7 = L"Minimum Fingerprint Samples";
    uVar9 = 0;
    uVar8 = 0;
    uVar1 = RegQueryValueExW(local_res18,L"Minimum Fingerprint Samples",(LPDWORD)0x0,(LPDWORD)0x0,
                             (LPBYTE)local_res10,local_res8);
    if (uVar1 == 0) {
      if (local_res10[0] - 8U < 0xd) {
        *(int *)((longlong)param_1 + 0x7c) = local_res10[0];
      }
      else {
        *(undefined4 *)((longlong)param_1 + 0x7c) = 0x10;
      }
      if ((*(byte *)(param_1 + 0xf) & 1) == 0) {
        *(int *)((longlong)param_1 + 0x7c) = *(int *)((longlong)param_1 + 0x7c) + -2;
      }
      else {
        *(int *)((longlong)param_1 + 0x7c) = *(int *)((longlong)param_1 + 0x7c) + -1;
      }
      pHVar5 = local_res18;
      RegCloseKey(local_res18);
    }
    else {
      pwVar7 = 
      L">>> CTouchSensor::EngineAdapterCreateEnrollment : Call RegQueryValueEx fail, return %d";
      uVar8 = (ulonglong)uVar1;
      pHVar5 = (HKEY)0x1;
      FUN_180017f20(1,(longlong)
                      L">>> CTouchSensor::EngineAdapterCreateEnrollment : Call RegQueryValueEx fail, return %d"
                    ,uVar8,uVar9);
    }
  }
  else {
    pwVar7 = L">>> CTouchSensor::EngineAdapterCreateEnrollment : Call RegOpenKeyEx fail, return %d";
    pHVar5 = (HKEY)0x1;
    uVar8 = (ulonglong)uVar1;
    FUN_180017f20(1,(longlong)
                    L">>> CTouchSensor::EngineAdapterCreateEnrollment : Call RegOpenKeyEx fail, return %d"
                  ,uVar8,uVar9);
  }
  puVar4 = thunk_FUN_180004df0(pHVar5,pwVar7,uVar8,uVar9);
  param_1[9] = (longlong)puVar4;
  if (puVar4 == (undefined2 *)0x0) goto LAB_18001c5ee;
  iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
  if (iVar2 == 5) {
    uVar8 = 10;
LAB_18001c580:
    thunk_FUN_180004fa0((char *)param_1[9],0x4bf,uVar8,uVar9);
    uVar8 = 1;
    uVar6 = 0x4cd;
  }
  else {
    iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
    if (iVar2 == 7) {
LAB_18001c57a:
      uVar8 = 0x10;
      goto LAB_18001c580;
    }
    iVar2 = (**(code **)(*param_1 + 0x98))(param_1);
    if (iVar2 == 8) goto LAB_18001c57a;
    thunk_FUN_180004fa0((char *)param_1[9],0x4bd,0x10,uVar9);
    uVar8 = 0;
    uVar6 = 0x4b4;
  }
  thunk_FUN_180004fa0((char *)param_1[9],uVar6,uVar8,uVar9);
  lpSubKey = (LPCWSTR)(**(code **)(*param_1 + 0xa8))(param_1);
  uVar9 = 0x20019;
  LVar3 = RegOpenKeyExW((HKEY)0xffffffff80000002,lpSubKey,0,0x20019,(PHKEY)&local_res20);
  if (LVar3 == 0) {
    FUN_18001c8b0((char *)param_1[9],local_res20);
    RegCloseKey(local_res20);
  }
LAB_18001c5ee:
  FUN_180017f20(1,(longlong)
                  L"<<< CTouchSensor::EngineAdapterCreateEnrollment : m_MinEnrollFingerCount = %d",
                (ulonglong)*(uint *)((longlong)param_1 + 0x7c),uVar9);
  uVar9 = 0x8000ffff;
  if (param_1[9] != 0) {
    uVar9 = 0;
  }
  return uVar9;
}



undefined8 FUN_18001c620(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::Exit",param_3,param_4);
  thunk_FUN_180004d50(*(undefined8 **)(param_1 + 0x288),*(uint *)(param_1 + 0x290),param_3,param_4);
  FUN_180016610((LPCRITICAL_SECTION *)(param_1 + 0x10));
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::Exit",param_3,param_4);
  return 0;
}



undefined8
FUN_18001c670(longlong param_1,undefined8 *param_2,undefined4 *param_3,undefined8 param_4)

{
  undefined4 *puVar1;
  
  puVar1 = param_3;
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::GetEnrollmentFeature",param_3,param_4);
  *param_2 = *(undefined8 *)(param_1 + 0x58);
  *param_3 = *(undefined4 *)(param_1 + 0x60);
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::GetEnrollmentFeature",puVar1,param_4);
  return 0;
}



undefined4 FUN_18001c6d0(longlong param_1)

{
  return *(undefined4 *)(param_1 + 0x70);
}



undefined8 FUN_18001c6e0(void)

{
  return 0x3c000;
}



undefined8 FUN_18001c6f0(void)

{
  return 0x14;
}



undefined8 FUN_18001c700(longlong *param_1,undefined8 param_2,LPCWSTR param_3,undefined8 param_4)

{
  uint uVar1;
  LSTATUS LVar2;
  LPCWSTR lpSubKey;
  undefined8 uVar3;
  undefined8 uVar4;
  int local_res8 [2];
  DWORD local_res18 [2];
  HKEY local_res20;
  
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::EngineAdapterInitialize",param_3,param_4);
  if (param_3 != (LPCWSTR)0x0) {
    FUN_1800166b0((LPCRITICAL_SECTION *)(param_1 + 2),param_3);
  }
  uVar1 = (**(code **)(*param_1 + 0x98))(param_1);
  FUN_180003c90((undefined4 *)param_1[0x51],(ulonglong)*(uint *)(param_1 + 0x52),(ulonglong)uVar1,0)
  ;
  local_res20 = (HKEY)0x0;
  lpSubKey = (LPCWSTR)(**(code **)(*param_1 + 0xa0))(param_1);
  uVar4 = 0x2001b;
  uVar3 = 0;
  LVar2 = RegOpenKeyExW((HKEY)0xffffffff80000002,lpSubKey,0,0x2001b,(PHKEY)&local_res20);
  if (LVar2 == 0) {
    local_res18[0] = 4;
    LVar2 = RegQueryValueExW(local_res20,L"Optimization",(LPDWORD)0x0,(LPDWORD)0x0,
                             (LPBYTE)local_res8,local_res18);
    if (LVar2 == 0) {
      *(int *)(param_1 + 0xf) = local_res8[0];
    }
    uVar4 = 0;
    uVar3 = 0;
    LVar2 = RegQueryValueExW(local_res20,L"SmartLearn",(LPDWORD)0x0,(LPDWORD)0x0,(LPBYTE)local_res8,
                             local_res18);
    if (LVar2 == 0) {
      *(uint *)((longlong)param_1 + 0x74) = (uint)(local_res8[0] != 0);
    }
    RegCloseKey(local_res20);
  }
  else {
    FUN_180017f20(1,(longlong)
                    L"CTouchSensor::EngineAdapterInitialize : openregkey fail(EgisFP\\FPParameters)"
                  ,uVar3,uVar4);
  }
  *(uint *)((longlong)param_1 + 0x7c) = *(uint *)(param_1 + 0xf) & 1 | 0xe;
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::EngineAdapterInitialize",uVar3,uVar4);
  return 0;
}



undefined8
FUN_18001c860(longlong param_1,undefined8 *param_2,ulonglong param_3,undefined8 *param_4,
             uint param_5)

{
  uint uVar1;
  undefined8 uVar2;
  
  if (param_4 == (undefined8 *)0x0) {
    param_4 = *(undefined8 **)(param_1 + 0x58);
    param_5 = *(uint *)(param_1 + 0x60);
  }
  uVar1 = thunk_FUN_180005aa0(param_2,param_4,param_3,(ulonglong)param_5,(int *)0x0);
  uVar2 = 0x80098005;
  if (uVar1 == 0x65) {
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18001c8b0(char *param_1,HKEY param_2)

{
  char cVar1;
  char cVar2;
  longlong lVar3;
  LSTATUS LVar4;
  char *pcVar5;
  undefined8 uVar6;
  ulonglong uVar7;
  undefined **ppuVar8;
  uint uVar9;
  ulonglong uVar11;
  ulonglong uVar12;
  uint local_298;
  DWORD local_294;
  uint local_290;
  DWORD local_28c;
  DWORD local_288;
  DWORD local_284;
  DWORD local_280;
  DWORD local_27c;
  DWORD local_278;
  DWORD local_274;
  DWORD local_270;
  DWORD local_26c;
  _FILETIME local_268 [2];
  CHAR local_258 [272];
  CHAR local_148;
  undefined local_147 [271];
  ulonglong local_38;
  ulonglong uVar10;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd08;
  local_148 = '\0';
  FUN_18001d980((undefined (*) [16])local_147,0,0x103);
  uVar12 = 0;
  local_284 = 0x104;
  local_28c = 0;
  local_294 = 0x104;
  RegQueryInfoKeyA(param_2,&local_148,&local_284,(LPDWORD)0x0,&local_28c,&local_278,&local_270,
                   &local_290,&local_26c,&local_274,&local_27c,(PFILETIME)local_268);
  uVar7 = uVar12;
  if (local_290 != 0) {
    do {
      local_294 = 0x104;
      local_258[0] = '\0';
      local_288 = 4;
      LVar4 = RegEnumValueA(param_2,(DWORD)uVar7,local_258,&local_294,(LPDWORD)0x0,&local_280,
                            (LPBYTE)&local_298,&local_288);
      if ((LVar4 == 0) && (local_280 == 4)) {
        ppuVar8 = &PTR_s_ENROLL_CTX_ENROLL_POLICY_180030ed8;
        uVar10 = uVar12;
        uVar11 = uVar12;
        do {
          pcVar5 = local_258;
          lVar3 = -(longlong)pcVar5;
          do {
            cVar1 = *pcVar5;
            cVar2 = pcVar5[(longlong)(*ppuVar8 + lVar3)];
            if (cVar1 != cVar2) break;
            pcVar5 = pcVar5 + 1;
          } while (cVar2 != '\0');
          if (cVar1 == cVar2) {
            uVar6 = thunk_FUN_180004fa0(param_1,*(undefined4 *)
                                                 ((longlong)&DAT_180030ed0 + uVar11 * 0x10),
                                        (ulonglong)local_298,ppuVar8);
            if ((int)uVar6 != -0x761) {
              FUN_180017d70(1,(longlong)"SetEnrollConfig( %s, %d ) = %d",local_258,
                            (ulonglong)local_298);
            }
            break;
          }
          uVar9 = (int)uVar10 + 1;
          uVar10 = (ulonglong)uVar9;
          uVar11 = uVar11 + 1;
          ppuVar8 = ppuVar8 + 2;
        } while (uVar9 < 0x14);
      }
      uVar9 = (DWORD)uVar7 + 1;
      uVar7 = (ulonglong)uVar9;
    } while (uVar9 < local_290);
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xfffffffffffffd08);
  return;
}



uint FUN_18001cad0(longlong param_1,undefined4 *param_2,undefined8 param_3,undefined8 param_4)

{
  int iVar1;
  undefined8 *puVar2;
  ulonglong uVar3;
  uint uVar4;
  uint **ppuVar5;
  uint local_res8 [2];
  uint local_res18 [2];
  
  FUN_180017f20(1,(longlong)L">>> CTouchSensor::EngineAdapterUpdateEnrollment",param_3,param_4);
  uVar4 = 0x90001;
  FUN_180017f20(1,(longlong)L"CTouchSensor::EngineAdapterUpdateEnrollment, CurrentEnrollNum = %d",
                (ulonglong)*(uint *)(param_1 + 0x50),param_4);
  FUN_18001d320(*(undefined8 **)(param_1 + 0x18),*(undefined8 **)(param_1 + 0x40),
                (longlong)*(int *)(param_1 + 0x28));
  ppuVar5 = *(uint ***)(param_1 + 0x48);
  uVar3 = (ulonglong)*(uint *)(param_1 + 0x24);
  iVar1 = thunk_FUN_1800055a0(*(undefined8 **)(param_1 + 0x18),*(int *)(param_1 + 0x20),uVar3,
                              ppuVar5,local_res18);
  if (iVar1 < 0) {
    switch(iVar1) {
    case -8:
    case -7:
      *param_2 = 10;
      uVar4 = 0x80098008;
      break;
    case -6:
    case -3:
      *param_2 = 0;
      uVar4 = 0x80004005;
      break;
    case -5:
    case -2:
    case -1:
      *param_2 = 7;
      uVar4 = 0x80098008;
      break;
    default:
      *param_2 = 0;
      uVar4 = 0x8000ffff;
    }
  }
  else {
    if (iVar1 == 2) {
      puVar2 = (undefined8 *)
               thunk_FUN_180006960(*(char **)(param_1 + 0x48),local_res8,uVar3,(undefined *)ppuVar5)
      ;
      if (puVar2 == (undefined8 *)0x0) {
        *param_2 = 10;
        *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
        uVar4 = 0x8000ffff;
      }
      else {
        uVar3 = SEXT48((int)local_res8[0]);
        *(uint *)(param_1 + 0x60) = local_res8[0];
        FUN_18001d320(*(undefined8 **)(param_1 + 0x58),puVar2,uVar3);
        thunk_FUN_180005d00(*(char **)(param_1 + 0x48),puVar2,uVar3,ppuVar5);
        uVar4 = 0;
        *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
        *(undefined8 *)(param_1 + 0x48) = 0;
      }
    }
    else {
      if (iVar1 == 1) {
        FUN_180017f20(1,(longlong)L"CTouchSensor::EngineAdapterUpdateEnrollment : IAMGE_OK",uVar3,
                      ppuVar5);
      }
      else {
        if (iVar1 == 3) {
          FUN_180017f20(1,(longlong)
                          L"CTouchSensor::EngineAdapterUpdateEnrollment : HIGHLY_SIMILARITY",uVar3,
                        ppuVar5);
          *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
          goto LAB_18001cc3d;
        }
        if (iVar1 == 4) {
          FUN_180017f20(1,(longlong)
                          L"CTouchSensor::EngineAdapterUpdateEnrollment : REDUNDANT_ACCEPT",uVar3,
                        ppuVar5);
          *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
          goto LAB_18001cc3d;
        }
      }
      *(int *)(param_1 + 0x50) = *(int *)(param_1 + 0x50) + 1;
    }
  }
LAB_18001cc3d:
  FUN_180017f20(1,(longlong)L"<<< CTouchSensor::EngineAdapterUpdateEnrollment : hr = [0x%08X]",
                (ulonglong)uVar4,ppuVar5);
  return uVar4;
}



// WARNING: Could not reconcile some variable overlaps

undefined8
FUN_18001cc90(longlong param_1,void *param_2,ulonglong param_3,byte *param_4,uint param_5,
             undefined4 *param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  ulonglong uVar4;
  byte **ppbVar5;
  longlong lVar6;
  undefined *puVar7;
  void *local_res10;
  int local_res18 [2];
  void **local_68;
  int *local_60;
  undefined8 local_58;
  byte *local_50;
  ulonglong local_48;
  undefined *local_40;
  ulonglong local_38;
  int local_30;
  int iStack44;
  undefined4 local_28;
  undefined4 uStack36;
  
  local_res18[0] = (int)param_3;
  uVar2 = param_5;
  if (param_4 == (byte *)0x0) {
    param_4 = *(byte **)(param_1 + 0x30);
    uVar2 = *(uint *)(param_1 + 0x38);
  }
  local_68 = &local_res10;
  local_58 = 1;
  local_60 = local_res18;
  local_48 = (ulonglong)uVar2;
  local_40 = *(undefined **)(param_1 + 0x68);
  iStack44 = 0;
  local_28 = 0;
  local_38 = 0;
  local_30 = -1;
  uStack36 = 0;
  local_res10 = param_2;
  local_50 = param_4;
  thunk_FUN_180006070((longlong *)&local_68,param_2,param_3,param_4);
  ppbVar5 = &local_50;
  uVar4 = thunk_FUN_1800064e0(ppbVar5,param_2,param_3,(ulonglong)param_4);
  FUN_180003e20(ppbVar5,param_2,param_3,param_4);
  FUN_180017f20(1,(longlong)L"CTouchSensor::Verify : result = %d, %d",uVar4 & 0xffffffff,
                local_38 >> 0x20);
  puVar1 = param_6;
  if ((-1 < (int)(uVar4 & 0xffffffff)) && (-1 < local_30)) {
    if (param_6 != (undefined4 *)0x0) {
      if (*(int *)(param_1 + 0x74) != 0) {
        lVar6 = (longlong)(int)local_38;
        if ((iStack44 != 0) &&
           ((local_res18[0] != (int)local_38 ||
            (iVar3 = memcmp(local_res10,local_40,(longlong)local_res18[0]), iVar3 != 0)))) {
          puVar7 = *(undefined **)(param_1 + 0x58);
          for (lVar6 = (longlong)*(int *)(param_1 + 0x60); lVar6 != 0; lVar6 = lVar6 + -1) {
            *puVar7 = 0;
            puVar7 = puVar7 + 1;
          }
          *(undefined8 *)(param_1 + 0x68) = *(undefined8 *)(param_1 + 0x58);
          *(undefined **)(param_1 + 0x58) = local_40;
          *(int *)(param_1 + 0x60) = (int)local_38;
          *puVar1 = 1;
          return 0;
        }
        for (; lVar6 != 0; lVar6 = lVar6 + -1) {
          *local_40 = 0;
          local_40 = local_40 + 1;
        }
        *puVar1 = 0;
        return 0;
      }
      *param_6 = 0;
    }
    if (iStack44 != 0) {
      for (lVar6 = (longlong)(int)local_38; lVar6 != 0; lVar6 = lVar6 + -1) {
        *local_40 = 0;
        local_40 = local_40 + 1;
      }
    }
    return 0;
  }
  if (param_6 != (undefined4 *)0x0) {
    *param_6 = 0;
  }
  return 0x80098005;
}



undefined4 * FUN_18001ce68(undefined4 *param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  DWORD DVar3;
  
  FUN_18001d980((undefined (*) [16])(param_1 + 10),0,0x28);
  *(undefined8 *)(param_1 + 0x14) = 0;
  param_1[0x16] = 0;
  param_1[0x17] = 0;
  *(undefined8 *)(param_1 + 4) = 0x180000000;
  *(undefined8 *)(param_1 + 2) = 0x180000000;
  *param_1 = 0x60;
  *(undefined **)(param_1 + 8) = &DAT_1800322d8;
  param_1[6] = 0xc00;
  BVar2 = InitializeCriticalSectionEx((LPCRITICAL_SECTION)(param_1 + 10),0,0);
  if (BVar2 == 0) {
    DVar3 = GetLastError();
    DVar1 = DVar3 & 0xffff | 0x80070000;
    if ((int)DVar3 < 1) {
      DVar1 = DVar3;
    }
    if ((int)DVar1 < 0) {
      BVar2 = IsDebuggerPresent();
      if (BVar2 != 0) {
        OutputDebugStringW(L"ERROR : Unable to initialize critical section in CAtlBaseModule\n");
      }
      DAT_18004cfb9 = 1;
    }
  }
  return param_1;
}



// Library Function - Single Match
//  public: __cdecl ATL::CAtlBaseModule::~CAtlBaseModule(void) __ptr64
// 
// Library: Visual Studio

void __thiscall ATL::CAtlBaseModule::_CAtlBaseModule(CAtlBaseModule *this)

{
  DeleteCriticalSection((LPCRITICAL_SECTION)(this + 0x28));
  if (*(void **)(this + 0x50) != (void *)0x0) {
    free(*(void **)(this + 0x50));
    *(undefined8 *)(this + 0x50) = 0;
  }
  *(undefined4 *)(this + 0x58) = 0;
  *(undefined4 *)(this + 0x5c) = 0;
  return;
}



void free(void *_Memory)

{
  free(_Memory);
  return;
}



undefined ** FUN_18001cf4c(undefined **param_1,exception *param_2)

{
  std::exception::exception((exception *)param_1,param_2);
  *param_1 = (undefined *)std::bad_alloc::vftable;
  return param_1;
}



// Library Function - Single Match
//  void * __ptr64 __cdecl operator new(unsigned __int64)
// 
// Library: Visual Studio 2012 Release

void * operator_new(unsigned___int64 param_1)

{
  code *pcVar1;
  int iVar2;
  void *pvVar3;
  undefined4 in_register_0000000c;
  char *local_res10 [3];
  undefined **local_28 [4];
  
  do {
    pvVar3 = malloc(CONCAT44(in_register_0000000c,param_1));
    if (pvVar3 != (void *)0x0) {
      return pvVar3;
    }
    iVar2 = _callnewh(CONCAT44(in_register_0000000c,param_1));
  } while (iVar2 != 0);
  local_res10[0] = "bad allocation";
  std::exception::exception((exception *)local_28,local_res10,1);
  local_28[0] = std::bad_alloc::vftable;
  FUN_18001ef4c((longlong *)local_28,&DAT_180047868);
  pcVar1 = (code *)swi(3);
  pvVar3 = (void *)(*pcVar1)();
  return pvVar3;
}



undefined ** FUN_18001cfec(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)std::bad_alloc::vftable;
  FUN_18001ede8(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  __onexitinit
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

undefined4 __onexitinit(void)

{
  undefined4 uVar1;
  undefined8 *Ptr;
  
  Ptr = (undefined8 *)FUN_18001f568(0x20,8);
  DAT_18004e138 = EncodePointer(Ptr);
  DAT_18004e140 = DAT_18004e138;
  if (Ptr == (undefined8 *)0x0) {
    uVar1 = 0x18;
  }
  else {
    *Ptr = 0;
    uVar1 = 0;
  }
  return uVar1;
}



// Library Function - Single Match
//  _onexit
// 
// Library: Visual Studio 2012 Release

_onexit_t _onexit(_onexit_t _Func)

{
  PVOID *_Memory;
  PVOID *ppvVar1;
  PVOID *ppvVar2;
  PVOID pvVar3;
  PVOID *ppvVar4;
  _onexit_t p_Var5;
  
  FUN_18001f37c();
  _Memory = (PVOID *)DecodePointer(DAT_18004e140);
  ppvVar1 = (PVOID *)DecodePointer(DAT_18004e138);
  if (_Memory <= ppvVar1) {
    ppvVar4 = (PVOID *)((longlong)ppvVar1 - (longlong)_Memory) + 1;
    if ((PVOID *)0x7 < ppvVar4) {
      ppvVar2 = (PVOID *)_msize(_Memory);
      if (ppvVar2 < ppvVar4) {
        ppvVar4 = (PVOID *)0x1000;
        if (ppvVar2 < (PVOID *)0x1000) {
          ppvVar4 = ppvVar2;
        }
        if (((PVOID *)((longlong)ppvVar4 + (longlong)ppvVar2) < ppvVar2) ||
           (pvVar3 = FUN_18001f664(_Memory,(size_t)(PVOID *)((longlong)ppvVar4 + (longlong)ppvVar2))
           , pvVar3 == (void *)0x0)) {
          p_Var5 = (_onexit_t)0x0;
          if ((ppvVar2 + 4 < ppvVar2) ||
             (pvVar3 = FUN_18001f664(_Memory,(size_t)(ppvVar2 + 4)), pvVar3 == (void *)0x0))
          goto LAB_18001d154;
        }
        ppvVar1 = (PVOID *)((longlong)pvVar3 +
                           ((longlong)(PVOID *)((longlong)ppvVar1 - (longlong)_Memory) >> 3) * 8);
        DAT_18004e140 = EncodePointer(pvVar3);
      }
      pvVar3 = EncodePointer(_Func);
      *ppvVar1 = pvVar3;
      DAT_18004e138 = EncodePointer(ppvVar1 + 1);
      p_Var5 = _Func;
      goto LAB_18001d154;
    }
  }
  p_Var5 = (_onexit_t)0x0;
LAB_18001d154:
  FUN_18001f388();
  return p_Var5;
}



// Library Function - Single Match
//  atexit
// 
// Library: Visual Studio 2012 Release

int atexit(void *param_1)

{
  _onexit_t p_Var1;
  
  p_Var1 = _onexit((_onexit_t)param_1);
  return (int)((p_Var1 != (_onexit_t)0x0) - 1);
}



// Library Function - Single Match
//  wcschr
// 
// Library: Visual Studio 2012 Release

wchar_t * wcschr(wchar_t *_Str,wchar_t _Ch)

{
  uint uVar1;
  uint uVar2;
  wchar_t *pwVar3;
  undefined in_XMM1 [16];
  undefined auVar4 [16];
  wchar_t wVar5;
  wchar_t wVar6;
  
  auVar4 = pshuflw(in_XMM1,ZEXT216((ushort)_Ch),0);
  while( true ) {
    for (; uVar2 = (uint)_Str & 0xfff, uVar2 < 0xff1; _Str = _Str + 8) {
      wVar5 = SUB162(auVar4,0);
      wVar6 = SUB162(auVar4 >> 0x10,0);
      uVar2 = pmovmskb(uVar2,CONCAT214(-(ushort)(_Str[7] == L'\0'),
                                       CONCAT212(-(ushort)(_Str[6] == L'\0'),
                                                 CONCAT210(-(ushort)(_Str[5] == L'\0'),
                                                           CONCAT28(-(ushort)(_Str[4] == L'\0'),
                                                                    CONCAT26(-(ushort)(_Str[3] ==
                                                                                      L'\0'),
                                                                             CONCAT24(-(ushort)(_Str
                                                  [2] == L'\0'),
                                                  CONCAT22(-(ushort)(_Str[1] == L'\0'),
                                                           -(ushort)(*_Str == L'\0')))))))) |
                             CONCAT214(-(ushort)(_Str[7] == wVar6),
                                       CONCAT212(-(ushort)(_Str[6] == wVar5),
                                                 CONCAT210(-(ushort)(_Str[5] == wVar6),
                                                           CONCAT28(-(ushort)(_Str[4] == wVar5),
                                                                    CONCAT26(-(ushort)(_Str[3] ==
                                                                                      wVar6),
                                                                             CONCAT24(-(ushort)(_Str
                                                  [2] == wVar5),
                                                  CONCAT22(-(ushort)(_Str[1] == wVar6),
                                                           -(ushort)(*_Str == wVar5)))))))));
      if (uVar2 != 0) {
        uVar1 = 0;
        if (uVar2 != 0) {
          for (; (uVar2 >> uVar1 & 1) == 0; uVar1 = uVar1 + 1) {
          }
        }
        pwVar3 = (wchar_t *)0x0;
        if (*(wchar_t *)((longlong)_Str + (ulonglong)uVar1) == _Ch) {
          pwVar3 = (wchar_t *)((longlong)_Str + (ulonglong)uVar1);
        }
        return pwVar3;
      }
    }
    if (*_Str == _Ch) break;
    if (*_Str == L'\0') {
      return (wchar_t *)0x0;
    }
    _Str = _Str + 1;
  }
  return _Str;
}



// Library Function - Single Match
//  free
// 
// Library: Visual Studio 2012 Release

void free(void *_Memory)

{
  BOOL BVar1;
  DWORD DVar2;
  int iVar3;
  int *piVar4;
  
  if ((_Memory != (void *)0x0) && (BVar1 = HeapFree(DAT_18004bd28,0,_Memory), BVar1 == 0)) {
    piVar4 = _errno();
    DVar2 = GetLastError();
    iVar3 = _get_errno_from_oserr(DVar2);
    *piVar4 = iVar3;
  }
  return;
}



// Library Function - Single Match
//  __GSHandlerCheck
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release,
// Visual Studio 2019 Release

undefined8
__GSHandlerCheck(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
  __GSHandlerCheckCommon(param_2,param_4,*(uint **)(param_4 + 0x38));
  return 1;
}



// Library Function - Single Match
//  __GSHandlerCheckCommon
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release,
// Visual Studio 2019 Release

void __GSHandlerCheckCommon(ulonglong param_1,longlong param_2,uint *param_3)

{
  longlong lVar1;
  ulonglong uVar2;
  
  uVar2 = param_1;
  if ((*(byte *)param_3 & 4) != 0) {
    uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
  }
  lVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8) + *(longlong *)(param_2 + 8);
  if ((*(byte *)(lVar1 + 3) & 0xf) != 0) {
    param_1 = param_1 + (longlong)(int)(*(byte *)(lVar1 + 3) & 0xfffffff0);
  }
  FUN_18001d2f0(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001d2f0(longlong param_1)

{
  code *pcVar1;
  BOOL BVar2;
  undefined *puVar3;
  undefined auStack56 [8];
  undefined auStack48 [48];
  
  if ((param_1 == DAT_180049180) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
    return;
  }
  puVar3 = auStack56;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)(2);
    puVar3 = auStack48;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18001fa4e;
  __crtCapturePreviousContext((CONTEXT *)&DAT_18004bdd0);
  _DAT_18004bd40 = *(undefined8 *)(puVar3 + 0x38);
  _DAT_18004be68 = puVar3 + 0x40;
  _DAT_18004be50 = *(undefined8 *)(puVar3 + 0x40);
  _DAT_18004bd30 = 0xc0000409;
  _DAT_18004bd34 = 1;
  _DAT_18004bd48 = 1;
  DAT_18004bd50 = 2;
  *(longlong *)(puVar3 + 0x20) = DAT_180049180;
  *(undefined8 *)(puVar3 + 0x28) = DAT_180049188;
  *(undefined8 *)(puVar3 + -8) = 0x18001faf0;
  DAT_18004bec8 = _DAT_18004bd40;
  FUN_18001f9d8((EXCEPTION_POINTERS *)&PTR_DAT_1800324e8);
  return;
}



undefined8 * FUN_18001d320(undefined8 *param_1,undefined8 *param_2,ulonglong param_3)

{
  undefined4 *puVar1;
  longlong lVar2;
  undefined4 *puVar3;
  undefined8 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined8 *puVar8;
  undefined8 *puVar9;
  undefined (*pauVar10) [16];
  undefined4 *puVar11;
  undefined (*pauVar12) [16];
  undefined8 *puVar13;
  undefined (*pauVar14) [16];
  ulonglong uVar15;
  ulonglong uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined4 uVar19;
  undefined4 uVar20;
  
  if (0x10 < param_3) {
    puVar13 = (undefined8 *)((longlong)param_2 - (longlong)param_1);
    if ((param_2 < param_1) && ((longlong)param_1 < (longlong)((longlong)param_2 + param_3))) {
      if ((DAT_18004c2a4 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          uVar15 = (longlong)param_1 + param_3;
          if ((uVar15 & 0xf) == 0) {
            pauVar10 = (undefined (*) [16])(uVar15 - 0x10);
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
            pauVar14 = (undefined (*) [16])(param_3 - 0x10);
          }
          else {
            puVar11 = (undefined4 *)(uVar15 - 0x10);
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar11);
            uVar5 = puVar1[1];
            uVar6 = puVar1[2];
            uVar7 = puVar1[3];
            pauVar10 = (undefined (*) [16])((ulonglong)puVar11 & 0xfffffffffffffff0);
            puVar3 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
            uVar17 = *puVar3;
            uVar18 = puVar3[1];
            uVar19 = puVar3[2];
            uVar20 = puVar3[3];
            *puVar11 = *puVar1;
            *(undefined4 *)(uVar15 - 0xc) = uVar5;
            *(undefined4 *)(uVar15 - 8) = uVar6;
            *(undefined4 *)(uVar15 - 4) = uVar7;
            pauVar14 = (undefined (*) [16])((longlong)pauVar10 - (longlong)param_1);
          }
          uVar15 = (ulonglong)pauVar14 >> 7;
          if (uVar15 != 0) {
            *pauVar10 = CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            pauVar12 = pauVar10;
            while( true ) {
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)pauVar12);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x20) + (longlong)pauVar12);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              pauVar10 = pauVar12[-8];
              *(undefined4 *)pauVar12[-1] = *puVar1;
              *(undefined4 *)(pauVar12[-1] + 4) = uVar17;
              *(undefined4 *)(pauVar12[-1] + 8) = uVar18;
              *(undefined4 *)(pauVar12[-1] + 0xc) = uVar19;
              *(undefined4 *)pauVar12[-2] = uVar20;
              *(undefined4 *)(pauVar12[-2] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-2] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-2] + 0xc) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + 0x50) + (longlong)pauVar10);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x40) + (longlong)pauVar10);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              uVar15 = uVar15 - 1;
              *(undefined4 *)pauVar12[-3] = *puVar1;
              *(undefined4 *)(pauVar12[-3] + 4) = uVar17;
              *(undefined4 *)(pauVar12[-3] + 8) = uVar18;
              *(undefined4 *)(pauVar12[-3] + 0xc) = uVar19;
              *(undefined4 *)pauVar12[-4] = uVar20;
              *(undefined4 *)(pauVar12[-4] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-4] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-4] + 0xc) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + 0x30) + (longlong)pauVar10);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x20) + (longlong)pauVar10);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              *(undefined4 *)pauVar12[-5] = *puVar1;
              *(undefined4 *)(pauVar12[-5] + 4) = uVar17;
              *(undefined4 *)(pauVar12[-5] + 8) = uVar18;
              *(undefined4 *)(pauVar12[-5] + 0xc) = uVar19;
              *(undefined4 *)pauVar12[-6] = uVar20;
              *(undefined4 *)(pauVar12[-6] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-6] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-6] + 0xc) = uVar7;
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x10) + (longlong)pauVar10);
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
              uVar17 = *puVar1;
              uVar18 = puVar1[1];
              uVar19 = puVar1[2];
              uVar20 = puVar1[3];
              if (uVar15 == 0) break;
              *(undefined4 *)pauVar12[-7] = *puVar3;
              *(undefined4 *)(pauVar12[-7] + 4) = uVar5;
              *(undefined4 *)(pauVar12[-7] + 8) = uVar6;
              *(undefined4 *)(pauVar12[-7] + 0xc) = uVar7;
              *(undefined4 *)*pauVar10 = uVar17;
              *(undefined4 *)(pauVar12[-8] + 4) = uVar18;
              *(undefined4 *)(pauVar12[-8] + 8) = uVar19;
              *(undefined4 *)(pauVar12[-8] + 0xc) = uVar20;
              pauVar12 = pauVar10;
            }
            *(undefined4 *)pauVar12[-7] = *puVar3;
            *(undefined4 *)(pauVar12[-7] + 4) = uVar5;
            *(undefined4 *)(pauVar12[-7] + 8) = uVar6;
            *(undefined4 *)(pauVar12[-7] + 0xc) = uVar7;
            pauVar14 = (undefined (*) [16])((ulonglong)pauVar14 & 0x7f);
          }
          for (uVar15 = (ulonglong)pauVar14 >> 4; uVar15 != 0; uVar15 = uVar15 - 1) {
            *pauVar10 = CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            pauVar10 = pauVar10[-1];
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)pauVar10);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
          }
          if (((ulonglong)pauVar14 & 0xf) != 0) {
            uVar5 = *(undefined4 *)((longlong)param_2 + 4);
            uVar6 = *(undefined4 *)(param_2 + 1);
            uVar7 = *(undefined4 *)((longlong)param_2 + 0xc);
            *(undefined4 *)param_1 = *(undefined4 *)param_2;
            *(undefined4 *)((longlong)param_1 + 4) = uVar5;
            *(undefined4 *)(param_1 + 1) = uVar6;
            *(undefined4 *)((longlong)param_1 + 0xc) = uVar7;
          }
          *pauVar10 = CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
          return param_1;
        }
LAB_18001d6b0:
        uVar17 = *(undefined4 *)((longlong)param_2 + 4);
        uVar18 = *(undefined4 *)(param_2 + 1);
        uVar19 = *(undefined4 *)((longlong)param_2 + 0xc);
        puVar3 = (undefined4 *)((param_3 - 0x10) + (longlong)param_1);
        puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar3);
        uVar20 = *puVar1;
        uVar5 = puVar1[1];
        uVar6 = puVar1[2];
        uVar7 = puVar1[3];
        *(undefined4 *)param_1 = *(undefined4 *)param_2;
        *(undefined4 *)((longlong)param_1 + 4) = uVar17;
        *(undefined4 *)(param_1 + 1) = uVar18;
        *(undefined4 *)((longlong)param_1 + 0xc) = uVar19;
        *puVar3 = uVar20;
        puVar3[1] = uVar5;
        puVar3[2] = uVar6;
        puVar3[3] = uVar7;
        return param_1;
      }
      puVar8 = (undefined8 *)((longlong)param_1 + param_3);
      if (((ulonglong)puVar8 & 7) != 0) {
        if (((ulonglong)puVar8 & 1) != 0) {
          puVar8 = (undefined8 *)((longlong)puVar8 + -1);
          param_3 = param_3 - 1;
          *(undefined *)puVar8 = *(undefined *)((longlong)puVar13 + (longlong)puVar8);
        }
        if (((ulonglong)puVar8 & 2) != 0) {
          puVar8 = (undefined8 *)((longlong)puVar8 + -2);
          param_3 = param_3 - 2;
          *(undefined2 *)puVar8 = *(undefined2 *)((longlong)puVar13 + (longlong)puVar8);
        }
        if (((ulonglong)puVar8 & 4) != 0) {
          puVar8 = (undefined8 *)((longlong)puVar8 + -4);
          param_3 = param_3 - 4;
          *(undefined4 *)puVar8 = *(undefined4 *)((longlong)puVar13 + (longlong)puVar8);
        }
      }
      uVar15 = param_3 >> 5;
      puVar9 = puVar8;
      if (uVar15 != 0) {
        do {
          uVar4 = *(undefined8 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar9);
          puVar8 = puVar9 + -4;
          puVar9[-1] = *(undefined8 *)((longlong)((longlong)puVar13 + -8) + (longlong)puVar9);
          puVar9[-2] = uVar4;
          uVar4 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar8);
          uVar15 = uVar15 - 1;
          puVar9[-3] = *(undefined8 *)((longlong)((longlong)puVar13 + 8) + (longlong)puVar8);
          *puVar8 = uVar4;
          puVar9 = puVar8;
        } while (uVar15 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar15 = param_3 >> 3;
      if (uVar15 != 0) {
        do {
          puVar8 = puVar8 + -1;
          uVar15 = uVar15 - 1;
          *puVar8 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar8);
        } while (uVar15 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_1 = (undefined8 *)((longlong)puVar8 - param_3);
      param_2 = (undefined8 *)((longlong)puVar13 + (longlong)param_1);
    }
    else {
      puVar8 = param_1;
      if ((DAT_18004c2a4 >> 1 & 1) != 0) {
        for (; param_3 != 0; param_3 = param_3 - 1) {
          *(undefined *)puVar8 = *(undefined *)param_2;
          param_2 = (undefined8 *)((longlong)param_2 + 1);
          puVar8 = (undefined8 *)((longlong)puVar8 + 1);
        }
        return param_1;
      }
      if ((DAT_18004c2a4 >> 2 & 1) != 0) {
        if (0x20 < param_3) {
          if (((ulonglong)param_1 & 0xf) == 0) {
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)param_1);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
            puVar8 = param_1 + 2;
            uVar15 = param_3 - 0x10;
          }
          else {
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)param_1);
            uVar5 = puVar1[1];
            uVar6 = puVar1[2];
            uVar7 = puVar1[3];
            puVar8 = (undefined8 *)((ulonglong)(param_1 + 4) & 0xfffffffffffffff0);
            puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar8);
            uVar17 = *puVar3;
            uVar18 = puVar3[1];
            uVar19 = puVar3[2];
            uVar20 = puVar3[3];
            *(undefined4 *)param_1 = *puVar1;
            *(undefined4 *)((longlong)param_1 + 4) = uVar5;
            *(undefined4 *)(param_1 + 1) = uVar6;
            *(undefined4 *)((longlong)param_1 + 0xc) = uVar7;
            uVar15 = param_3 - (longlong)((longlong)puVar8 - (longlong)param_1);
          }
          uVar16 = uVar15 >> 7;
          if (uVar16 != 0) {
            *(undefined (*) [16])(puVar8 + -2) =
                 CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            puVar9 = puVar8;
            while( true ) {
              puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar9);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + 0x10) + (longlong)puVar9);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              puVar8 = puVar9 + 0x10;
              *(undefined4 *)puVar9 = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 4) = uVar17;
              *(undefined4 *)(puVar9 + 1) = uVar18;
              *(undefined4 *)((longlong)puVar9 + 0xc) = uVar19;
              *(undefined4 *)(puVar9 + 2) = uVar20;
              *(undefined4 *)((longlong)puVar9 + 0x14) = uVar5;
              *(undefined4 *)(puVar9 + 3) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x1c) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x60) + (longlong)puVar8);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x50) + (longlong)puVar8);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              uVar16 = uVar16 - 1;
              *(undefined4 *)(puVar9 + 4) = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 0x24) = uVar17;
              *(undefined4 *)(puVar9 + 5) = uVar18;
              *(undefined4 *)((longlong)puVar9 + 0x2c) = uVar19;
              *(undefined4 *)(puVar9 + 6) = uVar20;
              *(undefined4 *)((longlong)puVar9 + 0x34) = uVar5;
              *(undefined4 *)(puVar9 + 7) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x3c) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x40) + (longlong)puVar8);
              uVar17 = puVar1[1];
              uVar18 = puVar1[2];
              uVar19 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x30) + (longlong)puVar8);
              uVar20 = *puVar3;
              uVar5 = puVar3[1];
              uVar6 = puVar3[2];
              uVar7 = puVar3[3];
              *(undefined4 *)(puVar9 + 8) = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 0x44) = uVar17;
              *(undefined4 *)(puVar9 + 9) = uVar18;
              *(undefined4 *)((longlong)puVar9 + 0x4c) = uVar19;
              *(undefined4 *)(puVar9 + 10) = uVar20;
              *(undefined4 *)((longlong)puVar9 + 0x54) = uVar5;
              *(undefined4 *)(puVar9 + 0xb) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x5c) = uVar7;
              puVar1 = (undefined4 *)((longlong)((longlong)puVar13 + -0x20) + (longlong)puVar8);
              uVar5 = puVar1[1];
              uVar6 = puVar1[2];
              uVar7 = puVar1[3];
              puVar3 = (undefined4 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar8);
              uVar17 = *puVar3;
              uVar18 = puVar3[1];
              uVar19 = puVar3[2];
              uVar20 = puVar3[3];
              if (uVar16 == 0) break;
              *(undefined4 *)(puVar9 + 0xc) = *puVar1;
              *(undefined4 *)((longlong)puVar9 + 100) = uVar5;
              *(undefined4 *)(puVar9 + 0xd) = uVar6;
              *(undefined4 *)((longlong)puVar9 + 0x6c) = uVar7;
              *(undefined4 *)(puVar9 + 0xe) = uVar17;
              *(undefined4 *)((longlong)puVar9 + 0x74) = uVar18;
              *(undefined4 *)(puVar9 + 0xf) = uVar19;
              *(undefined4 *)((longlong)puVar9 + 0x7c) = uVar20;
              puVar9 = puVar8;
            }
            *(undefined4 *)(puVar9 + 0xc) = *puVar1;
            *(undefined4 *)((longlong)puVar9 + 100) = uVar5;
            *(undefined4 *)(puVar9 + 0xd) = uVar6;
            *(undefined4 *)((longlong)puVar9 + 0x6c) = uVar7;
            uVar15 = uVar15 & 0x7f;
          }
          for (uVar16 = uVar15 >> 4; uVar16 != 0; uVar16 = uVar16 - 1) {
            *(undefined (*) [16])(puVar8 + -2) =
                 CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
            puVar1 = (undefined4 *)((longlong)puVar13 + (longlong)puVar8);
            uVar17 = *puVar1;
            uVar18 = puVar1[1];
            uVar19 = puVar1[2];
            uVar20 = puVar1[3];
            puVar8 = puVar8 + 2;
          }
          if ((uVar15 & 0xf) != 0) {
            lVar2 = (uVar15 & 0xf) + (longlong)puVar8;
            puVar1 = (undefined4 *)((longlong)puVar13 + lVar2 + -0x10);
            uVar5 = puVar1[1];
            uVar6 = puVar1[2];
            uVar7 = puVar1[3];
            *(undefined4 *)(lVar2 + -0x10) = *puVar1;
            *(undefined4 *)(lVar2 + -0xc) = uVar5;
            *(undefined4 *)(lVar2 + -8) = uVar6;
            *(undefined4 *)(lVar2 + -4) = uVar7;
          }
          *(undefined (*) [16])(puVar8 + -2) =
               CONCAT412(uVar20,CONCAT48(uVar19,CONCAT44(uVar18,uVar17)));
          return param_1;
        }
        goto LAB_18001d6b0;
      }
      if (((ulonglong)param_1 & 7) != 0) {
        if (((ulonglong)param_1 & 1) != 0) {
          param_3 = param_3 - 1;
          *(undefined *)param_1 = *(undefined *)((longlong)puVar13 + (longlong)param_1);
          puVar8 = (undefined8 *)((longlong)param_1 + 1);
        }
        if (((ulonglong)puVar8 & 2) != 0) {
          param_3 = param_3 - 2;
          *(undefined2 *)puVar8 = *(undefined2 *)((longlong)puVar13 + (longlong)puVar8);
          puVar8 = (undefined8 *)((longlong)puVar8 + 2);
        }
        if (((ulonglong)puVar8 & 4) != 0) {
          param_3 = param_3 - 4;
          *(undefined4 *)puVar8 = *(undefined4 *)((longlong)puVar13 + (longlong)puVar8);
          puVar8 = (undefined8 *)((longlong)puVar8 + 4);
        }
      }
      uVar15 = param_3 >> 5;
      puVar9 = puVar8;
      if (uVar15 != 0) {
        do {
          uVar4 = *(undefined8 *)((longlong)((longlong)puVar13 + 8) + (longlong)puVar9);
          puVar8 = puVar9 + 4;
          *puVar9 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar9);
          puVar9[1] = uVar4;
          uVar4 = *(undefined8 *)((longlong)((longlong)puVar13 + -8) + (longlong)puVar8);
          uVar15 = uVar15 - 1;
          puVar9[2] = *(undefined8 *)((longlong)((longlong)puVar13 + -0x10) + (longlong)puVar8);
          puVar9[3] = uVar4;
          puVar9 = puVar8;
        } while (uVar15 != 0);
        param_3 = param_3 & 0x1f;
      }
      uVar15 = param_3 >> 3;
      if (uVar15 != 0) {
        do {
          *puVar8 = *(undefined8 *)((longlong)puVar13 + (longlong)puVar8);
          puVar8 = puVar8 + 1;
          uVar15 = uVar15 - 1;
        } while (uVar15 != 0);
        param_3 = param_3 & 7;
      }
      if (param_3 == 0) {
        return param_1;
      }
      param_2 = (undefined8 *)((longlong)puVar13 + (longlong)puVar8);
      param_1 = puVar8;
    }
  }
                    // WARNING: Could not recover jumptable at 0x00018001d3fe. Too many branches
                    // WARNING: Treating indirect jump as call
  puVar13 = (undefined8 *)
            (*(code *)((ulonglong)*(uint *)(&DAT_18001d400 + param_3 * 4) + 0x180000000))
                      (param_1,param_2);
  return puVar13;
}



// Library Function - Single Match
//  memcmp
// 
// Library: Visual Studio

int memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
  uint uVar1;
  ulonglong uVar2;
  void *pvVar3;
  ulonglong uVar4;
  bool bVar5;
  
  pvVar3 = (void *)((longlong)_Buf2 - (longlong)_Buf1);
  if (7 < _Size) {
    uVar4 = (ulonglong)_Buf1 & 7;
    while (uVar4 != 0) {
                    // WARNING: Load size is inaccurate
      bVar5 = *_Buf1 < *(byte *)((longlong)pvVar3 + (longlong)_Buf1);
      if (*_Buf1 != *(byte *)((longlong)pvVar3 + (longlong)_Buf1)) goto LAB_18001d8e3;
      _Buf1 = (void *)((longlong)_Buf1 + 1);
      _Size = _Size - 1;
      uVar4 = (ulonglong)_Buf1 & 7;
    }
    if (_Size >> 3 != 0) {
      uVar4 = _Size >> 5;
      if (uVar4 != 0) {
        do {
                    // WARNING: Load size is inaccurate
          uVar2 = *_Buf1;
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + (longlong)_Buf1)) goto LAB_18001d954;
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 8);
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + 8 + (longlong)_Buf1)) {
LAB_18001d950:
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_18001d954;
          }
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 0x10);
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + 0x10 + (longlong)_Buf1)) {
LAB_18001d94c:
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_18001d950;
          }
          uVar2 = *(ulonglong *)((longlong)_Buf1 + 0x18);
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + 0x18 + (longlong)_Buf1)) {
            _Buf1 = (void *)((longlong)_Buf1 + 8);
            goto LAB_18001d94c;
          }
          _Buf1 = (void *)((longlong)_Buf1 + 0x20);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        _Size = _Size & 0x1f;
      }
      uVar4 = _Size >> 3;
      if (uVar4 != 0) {
        do {
                    // WARNING: Load size is inaccurate
          uVar2 = *_Buf1;
          if (uVar2 != *(ulonglong *)((longlong)pvVar3 + (longlong)_Buf1)) {
LAB_18001d954:
            uVar4 = *(ulonglong *)((longlong)_Buf1 + (longlong)pvVar3);
            uVar1 = (uint)((uVar2 >> 0x38 | (uVar2 & 0xff000000000000) >> 0x28 |
                            (uVar2 & 0xff0000000000) >> 0x18 | (uVar2 & 0xff00000000) >> 8 |
                            (uVar2 & 0xff000000) << 8 | (uVar2 & 0xff0000) << 0x18 |
                            (uVar2 & 0xff00) << 0x28 | uVar2 << 0x38) <
                          (uVar4 >> 0x38 | (uVar4 & 0xff000000000000) >> 0x28 |
                           (uVar4 & 0xff0000000000) >> 0x18 | (uVar4 & 0xff00000000) >> 8 |
                           (uVar4 & 0xff000000) << 8 | (uVar4 & 0xff0000) << 0x18 |
                           (uVar4 & 0xff00) << 0x28 | uVar4 << 0x38));
            return (int)((1 - uVar1) - (uint)(uVar1 != 0));
          }
          _Buf1 = (void *)((longlong)_Buf1 + 8);
          uVar4 = uVar4 - 1;
        } while (uVar4 != 0);
        _Size = _Size & 7;
      }
    }
  }
  while( true ) {
    if (_Size == 0) {
      return 0;
    }
                    // WARNING: Load size is inaccurate
    bVar5 = *_Buf1 < *(byte *)((longlong)pvVar3 + (longlong)_Buf1);
    if (*_Buf1 != *(byte *)((longlong)pvVar3 + (longlong)_Buf1)) break;
    _Buf1 = (void *)((longlong)_Buf1 + 1);
    _Size = _Size - 1;
  }
LAB_18001d8e3:
  return (int)((1 - (uint)bVar5) - (uint)(bVar5 != 0));
}



undefined (*) [16] FUN_18001d980(undefined (*param_1) [16],byte param_2,ulonglong param_3)

{
  uint uVar1;
  undefined (*pauVar2) [16];
  undefined (*pauVar3) [16];
  undefined *puVar4;
  undefined2 uVar5;
  ulonglong uVar7;
  longlong lVar8;
  ulonglong uVar9;
  ulonglong uVar10;
  undefined auVar11 [12];
  undefined4 uVar6;
  undefined auVar12 [13];
  undefined auVar13 [16];
  undefined uVar14;
  
  if (0xf < param_3) {
    pauVar2 = param_1;
    if ((DAT_18004c2a4 >> 1 & 1) == 0) {
      uVar7 = (ulonglong)param_2 * 0x101010101010101;
      if ((DAT_18004c2a4 >> 2 & 1) != 0) {
        uVar14 = SUB141(ZEXT814(uVar7) >> 0x30,0);
        auVar12 = ZEXT813(uVar7);
        auVar11 = ZEXT812(uVar7);
        auVar13 = CONCAT142(SUB1614(CONCAT133(SUB1613(CONCAT124(SUB1612(CONCAT115(SUB1611(CONCAT106(
                                                  SUB1610(CONCAT97(SUB169(CONCAT88(SUB168(CONCAT79(
                                                  SUB167(CONCAT610(SUB166(CONCAT511(SUB165(CONCAT412
                                                  (SUB164(CONCAT313(SUB163(CONCAT214(SUB162(
                                                  CONCAT115(SUB161(ZEXT816(uVar7) >> 0x38,0),
                                                            CONCAT114(SUB151(ZEXT815(uVar7) >> 0x38,
                                                                             0),ZEXT814(uVar7))) >>
                                                  0x70,0),CONCAT113(uVar14,auVar12)) >> 0x68,0),
                                                  CONCAT112(uVar14,auVar11)) >> 0x60,0),
                                                  CONCAT111(SUB131(auVar12 >> 0x28,0),ZEXT811(uVar7)
                                                           )) >> 0x58,0),
                                                  CONCAT110(SUB121(auVar11 >> 0x28,0),
                                                            (unkuint10)uVar7)) >> 0x50,0),
                                                  CONCAT19(SUB131(auVar12 >> 0x20,0),(unkuint9)uVar7
                                                          )) >> 0x48,0),
                                                  CONCAT18(SUB121(auVar11 >> 0x20,0),uVar7)) >> 0x40
                                                  ,0),(uVar7 >> 0x18) << 0x38) >> 0x38,0),
                                                  ((uint7)uVar7 >> 0x18) << 0x30) >> 0x30,0),
                                                  ((uint6)uVar7 >> 0x10) << 0x28) >> 0x28,0),
                                                  ((uint5)uVar7 >> 0x10) << 0x20) >> 0x20,0),
                                                  ((uint)uVar7 >> 8) << 0x18) >> 0x18,0),
                                              ((uint3)uVar7 >> 8) << 0x10) >> 0x10,0),
                            (ushort)uVar7 & 0xff | (ushort)uVar7 << 8);
        if (((ulonglong)param_1 & 0xf) != 0) {
          *param_1 = auVar13;
          pauVar2 = (undefined (*) [16])((longlong)param_1 + (0x10 - ((ulonglong)param_1 & 0xf)));
          param_3 = (((ulonglong)param_1 & 0xf) - 0x10) + param_3;
        }
        uVar7 = param_3 >> 7;
        pauVar3 = pauVar2;
        if (uVar7 != 0) {
          do {
            *pauVar2 = auVar13;
            pauVar2[1] = auVar13;
            pauVar3 = pauVar2[8];
            pauVar2[2] = auVar13;
            pauVar2[3] = auVar13;
            uVar7 = uVar7 - 1;
            pauVar2[4] = auVar13;
            pauVar2[5] = auVar13;
            pauVar2[6] = auVar13;
            pauVar2[7] = auVar13;
            pauVar2 = pauVar3;
          } while (uVar7 != 0);
          param_3 = param_3 & 0x7f;
        }
        for (uVar7 = param_3 >> 4; uVar7 != 0; uVar7 = uVar7 - 1) {
          *pauVar3 = auVar13;
          pauVar3 = pauVar3[1];
        }
        if ((param_3 & 0xf) != 0) {
          *(undefined (*) [16])(pauVar3[-1] + (param_3 & 0xf)) = auVar13;
        }
        return param_1;
      }
      if (0x3f < param_3) {
        uVar1 = -(int)param_1 & 7;
        uVar9 = param_3;
        if (uVar1 != 0) {
          uVar9 = param_3 - uVar1;
          *(ulonglong *)*param_1 = uVar7;
        }
        param_3 = uVar9 & 0x3f;
        pauVar2 = (undefined (*) [16])(*param_1 + uVar1);
        for (uVar9 = uVar9 >> 6; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(ulonglong *)*pauVar2 = uVar7;
          *(ulonglong *)(*pauVar2 + 8) = uVar7;
          *(ulonglong *)pauVar2[1] = uVar7;
          *(ulonglong *)(pauVar2[1] + 8) = uVar7;
          *(ulonglong *)pauVar2[2] = uVar7;
          *(ulonglong *)(pauVar2[2] + 8) = uVar7;
          *(ulonglong *)pauVar2[3] = uVar7;
          *(ulonglong *)(pauVar2[3] + 8) = uVar7;
          pauVar2 = pauVar2[4];
        }
      }
      uVar10 = param_3 & 7;
      for (uVar9 = param_3 >> 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(ulonglong *)*pauVar2 = uVar7;
        pauVar2 = (undefined (*) [16])(*pauVar2 + 8);
      }
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        (*pauVar2)[0] = (char)uVar7;
        pauVar2 = (undefined (*) [16])(*pauVar2 + 1);
      }
    }
    else {
      for (; param_3 != 0; param_3 = param_3 - 1) {
        (*pauVar2)[0] = param_2;
        pauVar2 = (undefined (*) [16])(*pauVar2 + 1);
      }
    }
    return param_1;
  }
  lVar8 = (ulonglong)param_2 * 0x101010101010101;
  puVar4 = *param_1 + param_3;
  uVar14 = (undefined)lVar8;
  uVar5 = (undefined2)lVar8;
  uVar6 = (undefined4)lVar8;
  switch(param_3) {
  case 0:
    return param_1;
  case 1:
    goto switchD_18001db12_caseD_1;
  case 8:
    *(longlong *)(puVar4 + -8) = lVar8;
    return param_1;
  case 9:
    *(longlong *)(puVar4 + -9) = lVar8;
    puVar4[-1] = uVar14;
    return param_1;
  case 10:
    *(longlong *)(puVar4 + -10) = lVar8;
    *(undefined2 *)(puVar4 + -2) = uVar5;
    return param_1;
  case 0xb:
    *(longlong *)(puVar4 + -0xb) = lVar8;
    break;
  case 0xc:
    *(longlong *)(puVar4 + -0xc) = lVar8;
  case 4:
    *(undefined4 *)(puVar4 + -4) = uVar6;
    return param_1;
  case 0xd:
    *(longlong *)(puVar4 + -0xd) = lVar8;
  case 5:
    *(undefined4 *)(puVar4 + -5) = uVar6;
    puVar4[-1] = uVar14;
    return param_1;
  case 0xe:
    *(longlong *)(puVar4 + -0xe) = lVar8;
  case 6:
    *(undefined4 *)(puVar4 + -6) = uVar6;
  case 2:
    *(undefined2 *)(puVar4 + -2) = uVar5;
    return param_1;
  case 0xf:
    *(longlong *)(puVar4 + -0xf) = lVar8;
  case 7:
    *(undefined4 *)(puVar4 + -7) = uVar6;
  }
  *(undefined2 *)(puVar4 + -3) = uVar5;
switchD_18001db12_caseD_1:
  puVar4[-1] = uVar14;
  return param_1;
}



// Library Function - Single Match
//  public: bool __cdecl type_info::operator==(class type_info const & __ptr64)const __ptr64
// 
// Library: Visual Studio 2012 Release

bool __thiscall type_info::operator__(type_info *this,type_info *param_1)

{
  int iVar1;
  
  iVar1 = strcmp((char *)(param_1 + 0x11),(char *)(this + 0x11));
  return iVar1 == 0;
}



undefined ** FUN_18001dbcc(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)type_info::vftable;
  type_info::_Type_info_dtor((type_info *)param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  strcpy_s
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

errno_t strcpy_s(char *_Dst,rsize_t _SizeInBytes,char *_Src)

{
  char cVar1;
  longlong lVar2;
  errno_t *peVar3;
  errno_t eVar4;
  
  if ((_Dst != (char *)0x0) && (_SizeInBytes != 0)) {
    if (_Src != (char *)0x0) {
      lVar2 = -(longlong)_Src;
      do {
        cVar1 = *_Src;
        (_Dst + lVar2)[(longlong)_Src] = cVar1;
        _Src = _Src + 1;
        if (cVar1 == '\0') break;
        _SizeInBytes = _SizeInBytes - 1;
      } while (_SizeInBytes != 0);
      if (_SizeInBytes != 0) {
        return 0;
      }
      *_Dst = '\0';
      peVar3 = _errno();
      eVar4 = 0x22;
      goto LAB_18001dc2a;
    }
    *_Dst = '\0';
  }
  peVar3 = _errno();
  eVar4 = 0x16;
LAB_18001dc2a:
  *peVar3 = eVar4;
  FUN_18001fee8();
  return eVar4;
}



// Library Function - Single Match
//  wcscpy_s
// 
// Library: Visual Studio 2012 Release

errno_t wcscpy_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src)

{
  wchar_t wVar1;
  errno_t *peVar2;
  errno_t eVar3;
  wchar_t *pwVar4;
  
  if ((_Dst != (wchar_t *)0x0) && (_SizeInWords != 0)) {
    if (_Src != (wchar_t *)0x0) {
      pwVar4 = (wchar_t *)((longlong)_Dst - (longlong)_Src);
      do {
        wVar1 = *_Src;
        *(wchar_t *)((longlong)pwVar4 + (longlong)_Src) = wVar1;
        _Src = _Src + 1;
        if (wVar1 == L'\0') break;
        _SizeInWords = _SizeInWords - 1;
      } while (_SizeInWords != 0);
      if (_SizeInWords != 0) {
        return 0;
      }
      *_Dst = L'\0';
      peVar2 = _errno();
      eVar3 = 0x22;
      goto LAB_18001dc92;
    }
    *_Dst = L'\0';
  }
  peVar2 = _errno();
  eVar3 = 0x16;
LAB_18001dc92:
  *peVar2 = eVar3;
  FUN_18001fee8();
  return eVar3;
}



void FUN_18001dcd8(wchar_t *param_1,size_t param_2,wchar_t *param_3,undefined8 param_4)

{
  undefined8 local_res20;
  
  local_res20 = param_4;
  _vswprintf_s_l(param_1,param_2,param_3,(_locale_t)0x0,(va_list)&local_res20);
  return;
}



// Library Function - Single Match
//  _vswprintf_helper
// 
// Library: Visual Studio 2012 Release

ulonglong _vswprintf_helper(undefined *param_1,char *param_2,ulonglong param_3,longlong param_4,
                           undefined8 param_5,undefined8 param_6)

{
  int *piVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined local_48 [8];
  int local_40;
  char *local_38;
  int local_30;
  
  local_48 = (char *)0x0;
  FUN_18001d980((undefined (*) [16])&local_40,0,0x28);
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (char *)0x0)))) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    FUN_18001fee8();
    return 0xffffffff;
  }
  local_30 = 0x42;
  if (param_3 < 0x40000000) {
    local_40 = (int)param_3 * 2;
  }
  else {
    local_40 = 0x7fffffff;
  }
  local_48 = param_2;
  local_38 = param_2;
  uVar2 = (*(code *)param_1)(local_48,param_4,param_5,param_6);
  if (param_2 == (char *)0x0) {
    return uVar2;
  }
  if (-1 < (int)uVar2) {
    local_40 = local_40 + -1;
    if (local_40 < 0) {
      uVar3 = FUN_18001ff44(0,(FILE *)local_48);
      if ((int)uVar3 == -1) goto LAB_18001dded;
    }
    else {
      *local_48 = '\0';
      local_48 = local_48 + 1;
    }
    local_40 = local_40 + -1;
    if (-1 < local_40) {
      *local_48 = '\0';
      return uVar2 & 0xffffffff;
    }
    uVar3 = FUN_18001ff44(0,(FILE *)local_48);
    if ((int)uVar3 != -1) {
      return uVar2 & 0xffffffff;
    }
  }
LAB_18001dded:
  *(undefined2 *)(param_2 + param_3 * 2 + -2) = 0;
  return (ulonglong)((-1 < local_40) - 2);
}



// Library Function - Single Match
//  _vswprintf_s_l
// 
// Library: Visual Studio 2012 Release

int _vswprintf_s_l(wchar_t *_DstBuf,size_t _DstSize,wchar_t *_Format,_locale_t _Locale,
                  va_list _ArgList)

{
  int iVar1;
  ulonglong uVar2;
  int *piVar3;
  
  if (((_Format == (wchar_t *)0x0) || (_DstBuf == (wchar_t *)0x0)) || (_DstSize == 0)) {
    piVar3 = _errno();
    *piVar3 = 0x16;
  }
  else {
    uVar2 = _vswprintf_helper(FUN_180020178,(char *)_DstBuf,_DstSize,(longlong)_Format,_Locale,
                              _ArgList);
    iVar1 = (int)uVar2;
    if (iVar1 < 0) {
      *_DstBuf = L'\0';
    }
    if (iVar1 != -2) {
      return iVar1;
    }
    piVar3 = _errno();
    *piVar3 = 0x22;
  }
  FUN_18001fee8();
  return -1;
}



void FUN_18001de94(wchar_t *param_1,size_t param_2,wchar_t *param_3,va_list param_4)

{
  _vswprintf_s_l(param_1,param_2,param_3,(_locale_t)0x0,param_4);
  return;
}



// Library Function - Single Match
//  sprintf_s
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int sprintf_s(char *_DstBuf,size_t _SizeInBytes,char *_Format,...)

{
  int iVar1;
  undefined8 in_R9;
  undefined8 local_res20;
  
  local_res20 = in_R9;
  iVar1 = _vsprintf_s_l(_DstBuf,_SizeInBytes,_Format,(_locale_t)0x0,(va_list)&local_res20);
  return iVar1;
}



// Library Function - Single Match
//  _vsnprintf_helper
// 
// Library: Visual Studio 2012 Release

ulonglong _vsnprintf_helper(undefined *param_1,char *param_2,ulonglong param_3,longlong param_4,
                           undefined8 param_5,undefined8 param_6)

{
  int *piVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  undefined local_48 [8];
  int local_40;
  char *local_38;
  int local_30;
  
  local_48 = (char *)0x0;
  FUN_18001d980((undefined (*) [16])&local_40,0,0x28);
  if ((param_4 == 0) || ((param_3 != 0 && (param_2 == (char *)0x0)))) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    FUN_18001fee8();
    uVar2 = 0xffffffff;
  }
  else {
    local_40 = (int)param_3;
    if (0x7fffffff < param_3) {
      local_40 = 0x7fffffff;
    }
    local_30 = 0x42;
    local_48 = param_2;
    local_38 = param_2;
    uVar2 = (*(code *)param_1)(local_48,param_4,param_5,param_6);
    if (param_2 != (char *)0x0) {
      if (-1 < (int)uVar2) {
        local_40 = local_40 + -1;
        if (-1 < local_40) {
          *local_48 = '\0';
          return uVar2 & 0xffffffff;
        }
        uVar3 = FUN_18001ff44(0,(FILE *)local_48);
        if ((int)uVar3 != -1) {
          return uVar2 & 0xffffffff;
        }
      }
      param_2[param_3 - 1] = '\0';
      uVar2 = (ulonglong)((-1 < local_40) - 2);
    }
  }
  return uVar2;
}



// Library Function - Single Match
//  _vsprintf_s_l
// 
// Library: Visual Studio 2012 Release

int _vsprintf_s_l(char *_DstBuf,size_t _DstSize,char *_Format,_locale_t _Locale,va_list _ArgList)

{
  int iVar1;
  ulonglong uVar2;
  int *piVar3;
  
  if (((_Format == (char *)0x0) || (_DstBuf == (char *)0x0)) || (_DstSize == 0)) {
    piVar3 = _errno();
    *piVar3 = 0x16;
  }
  else {
    uVar2 = _vsnprintf_helper(FUN_180020d8c,_DstBuf,_DstSize,(longlong)_Format,_Locale,_ArgList);
    iVar1 = (int)uVar2;
    if (iVar1 < 0) {
      *_DstBuf = '\0';
    }
    if (iVar1 != -2) {
      return iVar1;
    }
    piVar3 = _errno();
    *piVar3 = 0x22;
  }
  FUN_18001fee8();
  return -1;
}



// Library Function - Single Match
//  vsprintf_s
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int vsprintf_s(char *_DstBuf,size_t _SizeInBytes,char *_Format,va_list _ArgList)

{
  int iVar1;
  
  iVar1 = _vsprintf_s_l(_DstBuf,_SizeInBytes,_Format,(_locale_t)0x0,_ArgList);
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x00018001e1ef)
// Library Function - Single Match
//  wcstol
// 
// Library: Visual Studio 2012 Release

long wcstol(wchar_t *_Str,wchar_t **_EndPtr,int _Radix)

{
  uint uVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  uint uVar6;
  int *piVar7;
  wint_t *pwVar8;
  wint_t _C;
  uint uVar9;
  
  bVar4 = false;
  if (_EndPtr != (wchar_t **)0x0) {
    *_EndPtr = _Str;
  }
  if ((_Str == (wchar_t *)0x0) || ((_Radix != 0 && (0x22 < _Radix - 2U)))) {
    piVar7 = _errno();
    *piVar7 = 0x16;
    FUN_18001fee8();
    return 0;
  }
  _C = *_Str;
  uVar9 = 0;
  pwVar8 = (wint_t *)(_Str + 1);
  while (iVar5 = iswctype(_C,8), iVar5 != 0) {
    _C = *pwVar8;
    pwVar8 = pwVar8 + 1;
  }
  if (_C == 0x2d) {
    bVar2 = true;
LAB_18001e0ca:
    bVar4 = bVar2;
    _C = *pwVar8;
    pwVar8 = pwVar8 + 1;
  }
  else {
    bVar2 = false;
    if (_C == 0x2b) goto LAB_18001e0ca;
  }
  bVar3 = false;
  bVar2 = false;
  if (_Radix == 0) {
    iVar5 = _wchartodigit(_C);
    if (iVar5 != 0) {
      _Radix = 10;
      goto LAB_18001e132;
    }
    if ((*pwVar8 - 0x58 & 0xffdf) != 0) {
      _Radix = 8;
      goto LAB_18001e132;
    }
    _Radix = 0x10;
  }
  if (((_Radix == 0x10) && (iVar5 = _wchartodigit(_C), iVar5 == 0)) &&
     ((*pwVar8 - 0x58 & 0xffdf) == 0)) {
    _C = pwVar8[1];
    pwVar8 = pwVar8 + 2;
  }
LAB_18001e132:
  uVar1 = (uint)(0xffffffff / (ulonglong)(uint)_Radix);
  do {
    uVar6 = _wchartodigit(_C);
    if (uVar6 == 0xffffffff) {
      if ((0x19 < (ushort)(_C - 0x41)) && (0x19 < (ushort)(_C - 0x61))) {
LAB_18001e18d:
        pwVar8 = pwVar8 + -1;
        if (bVar2) {
          if (((bVar3) || ((bVar4 && (0x80000000 < uVar9)))) || ((!bVar4 && (0x7fffffff < uVar9))))
          {
            piVar7 = _errno();
            *piVar7 = 0x22;
            uVar9 = bVar4 + 0x7fffffff;
          }
        }
        else {
          if (_EndPtr != (wchar_t **)0x0) {
            pwVar8 = (wint_t *)_Str;
          }
          uVar9 = 0;
        }
        if (_EndPtr != (wchar_t **)0x0) {
          *_EndPtr = (wchar_t *)pwVar8;
        }
        if (bVar4) {
          uVar9 = -uVar9;
        }
        return (long)uVar9;
      }
      uVar6 = (uint)_C;
      if ((ushort)(_C - 0x61) < 0x1a) {
        uVar6 = _C - 0x20;
      }
      uVar6 = uVar6 - 0x37;
    }
    if ((uint)_Radix <= uVar6) goto LAB_18001e18d;
    if ((uVar9 < uVar1) ||
       ((uVar9 == uVar1 && (uVar6 <= (uint)(0xffffffff % (ulonglong)(uint)_Radix))))) {
      uVar9 = uVar9 * _Radix + uVar6;
    }
    else {
      bVar3 = true;
      bVar2 = true;
      if (_EndPtr == (wchar_t **)0x0) goto LAB_18001e18d;
    }
    bVar2 = true;
    _C = *pwVar8;
    pwVar8 = pwVar8 + 1;
  } while( true );
}



// Library Function - Single Match
//  unsigned __int64 * __ptr64 __cdecl _GetEstablisherFrame(unsigned __int64 * __ptr64,struct
// _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const * __ptr64,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2012 Release

unsigned___int64 *
_GetEstablisherFrame
          (unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
          unsigned___int64 *param_4)

{
  uint uVar1;
  int iVar2;
  PRUNTIME_FUNCTION p_Var3;
  uint uVar4;
  ulonglong uVar5;
  int *piVar6;
  longlong lVar7;
  ulonglong uVar8;
  ulonglong local_res8;
  
  uVar8 = (ulonglong)param_3->nTryBlocks;
  iVar2 = FUN_180023304((longlong)param_3,(longlong *)param_2);
  *(undefined8 *)param_4 = *(undefined8 *)param_1;
  do {
    do {
      if ((int)uVar8 == 0) {
        return param_4;
      }
      uVar8 = (ulonglong)((int)uVar8 - 1);
      lVar7 = (longlong)(int)param_3->dispTryBlockMap + uVar8 * 0x14 + *(longlong *)(param_2 + 8);
    } while ((iVar2 <= *(int *)(lVar7 + 4)) || (*(int *)(lVar7 + 8) < iVar2));
    p_Var3 = RtlLookupFunctionEntry(*(DWORD64 *)param_2,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    uVar1 = *(uint *)(lVar7 + 0xc);
    lVar7 = (longlong)*(int *)(lVar7 + 0x10) + local_res8;
    uVar5 = 0;
    if (uVar1 != 0) {
      piVar6 = (int *)(lVar7 + 0xc);
      do {
        if ((longlong)*piVar6 == (ulonglong)p_Var3->BeginAddress) break;
        uVar4 = (int)uVar5 + 1;
        uVar5 = (ulonglong)uVar4;
        piVar6 = piVar6 + 5;
      } while (uVar4 < uVar1);
    }
    if ((uint)uVar5 < uVar1) {
      *(undefined8 *)param_4 =
           *(undefined8 *)((longlong)*(int *)(lVar7 + 0x10 + uVar5 * 0x14) + *(longlong *)param_1);
      return param_4;
    }
  } while( true );
}



longlong FUN_18001e2fc(undefined8 param_1,longlong param_2,undefined8 param_3,int param_4,
                      uint *param_5,int *param_6,longlong *param_7)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  ulonglong uVar5;
  longlong lVar6;
  uint uVar7;
  longlong lVar8;
  
  uVar1 = *(uint *)(param_2 + 0xc);
  lVar6 = 0;
  iVar2 = FUN_180023304(param_2,param_7);
  if (uVar1 == 0) {
    _inconsistency();
  }
  uVar5 = (ulonglong)uVar1;
  *param_6 = -1;
  *param_5 = 0xffffffff;
  uVar4 = uVar1;
  if (uVar1 != 0) {
    do {
      uVar4 = (uint)uVar5;
      uVar7 = uVar4 - 1;
      uVar5 = (ulonglong)uVar7;
      lVar8 = param_7[1] + uVar5 * 0x14;
      if ((*(int *)(lVar8 + 4 + (longlong)*(int *)(param_2 + 0x10)) < iVar2) &&
         (iVar2 <= *(int *)(lVar8 + 8 + (longlong)*(int *)(param_2 + 0x10)))) break;
      uVar4 = uVar7;
    } while (uVar7 != 0);
  }
  if (uVar4 != 0) {
    lVar6 = (longlong)*(int *)(param_2 + 0x10) + (ulonglong)(uVar4 - 1) * 0x14 + param_7[1];
  }
  uVar4 = 0;
  if (uVar1 != 0) {
    lVar8 = 0;
    do {
      piVar3 = (int *)(*(int *)(param_2 + 0x10) + lVar8 + param_7[1]);
      if ((((lVar6 == 0) ||
           ((*piVar3 != *(int *)(lVar6 + 4) && *(int *)(lVar6 + 4) <= *piVar3 &&
            (piVar3[1] == *(int *)(lVar6 + 8) || piVar3[1] < *(int *)(lVar6 + 8))))) &&
          (*piVar3 <= param_4)) && (param_4 <= piVar3[1])) {
        if (*param_5 == 0xffffffff) {
          *param_5 = uVar4;
        }
        *param_6 = uVar4 + 1;
      }
      uVar4 = uVar4 + 1;
      lVar8 = lVar8 + 0x14;
    } while (uVar4 < uVar1);
    if (*param_5 != 0xffffffff) {
      return (longlong)*(int *)(param_2 + 0x10) + (ulonglong)*param_5 * 0x14 + param_7[1];
    }
  }
  *param_5 = 0;
  *param_6 = 0;
  return 0;
}



// Library Function - Single Match
//  void __cdecl __FrameUnwindToEmptyState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2012 Release

void __FrameUnwindToEmptyState
               (unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  unsigned___int64 *puVar2;
  _ptiddata p_Var3;
  longlong lVar4;
  ulonglong uVar5;
  unsigned___int64 local_res18 [4];
  
  puVar2 = _GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  iVar1 = FUN_180023304((longlong)param_3,(longlong *)param_2);
  uVar5 = (ulonglong)param_3->nTryBlocks;
  do {
    if ((int)uVar5 == 0) {
      lVar4 = 0;
      break;
    }
    uVar5 = (ulonglong)((int)uVar5 - 1);
    p_Var3 = _getptd();
    lVar4 = p_Var3->_ImageBase + uVar5 * 0x14 + (longlong)(int)param_3->dispTryBlockMap;
  } while ((iVar1 <= *(int *)(lVar4 + 4)) || (*(int *)(lVar4 + 8) < iVar1));
  if (lVar4 == 0) {
    iVar1 = -1;
  }
  else {
    iVar1 = *(int *)(lVar4 + 4);
  }
  __FrameUnwindToState(puVar2,param_2,param_3,iVar1);
  return;
}



// Library Function - Single Match
//  int __cdecl __SehTransFilter(struct _EXCEPTION_POINTERS * __ptr64,struct EHExceptionRecord *
// __ptr64,unsigned __int64 * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64,int * __ptr64)
// 
// Library: Visual Studio 2012 Release

int __SehTransFilter(_EXCEPTION_POINTERS *param_1,EHExceptionRecord *param_2,
                    unsigned___int64 *param_3,_CONTEXT *param_4,_xDISPATCHER_CONTEXT *param_5,
                    _s_FuncInfo *param_6,int *param_7)

{
  PEXCEPTION_RECORD pEVar1;
  _ptiddata p_Var2;
  
  p_Var2 = _getptd();
  p_Var2->_pForeignException = param_2;
  pEVar1 = param_1->ExceptionRecord;
  p_Var2 = _getptd();
  p_Var2->_ThrowImageBase = pEVar1->ExceptionInformation[3];
  __InternalCxxFrameHandler
            ((int *)param_1->ExceptionRecord,param_3,param_4,param_5,param_6,0,
             (unsigned___int64 *)0x0,1);
  p_Var2 = _getptd();
  p_Var2->_pForeignException = (void *)0x0;
  *param_7 = 1;
  return 1;
}



// Library Function - Single Match
//  _CallSETranslator
// 
// Library: Visual Studio 2012 Release

undefined4 _CallSETranslator(undefined4 *param_1,undefined8 param_2,undefined8 param_3)

{
  _ptiddata p_Var1;
  undefined4 *local_20;
  undefined8 local_18;
  
  local_20 = param_1;
  local_18 = param_3;
  p_Var1 = _getptd();
  (*(code *)p_Var1->_translator)(*param_1,&local_20,p_Var1->_translator);
  return 0;
}



// Library Function - Single Match
//  _CreateFrameInfo
// 
// Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release,
// Visual Studio 2012 Release

undefined8 * _CreateFrameInfo(undefined8 *param_1,undefined8 param_2)

{
  _ptiddata p_Var1;
  void *pvVar2;
  
  *param_1 = param_2;
  p_Var1 = _getptd();
  if (param_1 < p_Var1->_pFrameInfoChain) {
    p_Var1 = _getptd();
    pvVar2 = p_Var1->_pFrameInfoChain;
  }
  else {
    pvVar2 = (void *)0x0;
  }
  param_1[1] = pvVar2;
  p_Var1 = _getptd();
  p_Var1->_pFrameInfoChain = param_1;
  return param_1;
}



// Library Function - Single Match
//  _FindAndUnlinkFrame
// 
// Library: Visual Studio 2012 Release

void _FindAndUnlinkFrame(void *param_1)

{
  _ptiddata p_Var1;
  void *pvVar2;
  
  p_Var1 = _getptd();
  if (param_1 != p_Var1->_pFrameInfoChain) {
    _inconsistency();
  }
  p_Var1 = _getptd();
  pvVar2 = p_Var1->_pFrameInfoChain;
  while( true ) {
    if (pvVar2 == (void *)0x0) {
      _inconsistency();
      return;
    }
    if (param_1 == pvVar2) break;
    pvVar2 = *(void **)((longlong)pvVar2 + 8);
  }
  p_Var1 = _getptd();
  p_Var1->_pFrameInfoChain = *(void **)((longlong)pvVar2 + 8);
  return;
}



// Library Function - Single Match
//  _GetImageBase
// 
// Library: Visual Studio 2012 Release

ulonglong _GetImageBase(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  return p_Var1->_ImageBase;
}



// Library Function - Single Match
//  _GetThrowImageBase
// 
// Library: Visual Studio 2012 Release

ulonglong _GetThrowImageBase(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  return p_Var1->_ThrowImageBase;
}



// Library Function - Single Match
//  _IsExceptionObjectToBeDestroyed
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

undefined4 _IsExceptionObjectToBeDestroyed(longlong param_1)

{
  _ptiddata p_Var1;
  longlong *plVar2;
  
  p_Var1 = _getptd();
  plVar2 = (longlong *)p_Var1->_pFrameInfoChain;
  while( true ) {
    if (plVar2 == (longlong *)0x0) {
      return 1;
    }
    if (*plVar2 == param_1) break;
    plVar2 = (longlong *)plVar2[1];
  }
  return 0;
}



// Library Function - Single Match
//  _SetImageBase
// 
// Library: Visual Studio 2012 Release

void _SetImageBase(ulonglong param_1)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  p_Var1->_ImageBase = param_1;
  return;
}



// Library Function - Single Match
//  _SetThrowImageBase
// 
// Library: Visual Studio 2012 Release

void _SetThrowImageBase(ulonglong param_1)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  p_Var1->_ThrowImageBase = param_1;
  return;
}



void FUN_18001e6f4(PVOID *param_1,ULONG_PTR param_2,ULONG_PTR param_3,ULONG_PTR param_4,
                  ULONG_PTR param_5,int param_6,ULONG_PTR param_7,PVOID *param_8,byte param_9)

{
  undefined local_588 [12];
  undefined4 uStack1404;
  undefined4 local_578;
  undefined4 uStack1396;
  DWORD DStack1392;
  undefined4 uStack1388;
  undefined *local_568;
  ULONG_PTR UStack1376;
  ULONG_PTR local_558;
  ULONG_PTR UStack1360;
  ULONG_PTR local_548;
  ULONG_PTR UStack1344;
  ULONG_PTR local_538;
  ulonglong uStack1328;
  ULONG_PTR local_528;
  undefined4 uStack1312;
  undefined4 uStack1308;
  undefined4 local_518;
  undefined4 uStack1300;
  undefined4 uStack1296;
  undefined4 uStack1292;
  undefined4 local_508;
  undefined4 uStack1284;
  undefined4 uStack1280;
  undefined4 uStack1276;
  ULONG_PTR local_4f8;
  _CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffa48;
  local_588._0_4_ = 0x80000029;
  local_588._4_4_ = 1;
  local_588._8_4_ = 0;
  uStack1404 = 0;
  local_578 = 0;
  uStack1396 = 0;
  DStack1392 = 0xf;
  uStack1388 = 0;
  uStack1312 = 0;
  uStack1308 = 0;
  local_518 = 0;
  uStack1300 = 0;
  uStack1296 = 0;
  uStack1292 = 0;
  local_508 = 0;
  uStack1284 = 0;
  uStack1280 = 0;
  uStack1276 = 0;
  local_4f8 = 0;
  local_568 = &LAB_180022b28;
  local_558 = param_5;
  UStack1360 = SEXT48(param_6);
  UStack1344 = param_7;
  uStack1328 = (ulonglong)param_9;
  local_528 = 0x19930520;
  UStack1376 = param_4;
  local_548 = param_3;
  local_538 = param_2;
  RtlUnwindEx(*param_1,*param_8,(PEXCEPTION_RECORD)local_588,(PVOID)0x0,(PCONTEXT)&local_4e8,
              (PUNWIND_HISTORY_TABLE)param_8[8]);
  FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xfffffffffffffa48);
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  __CxxFrameHandler
//  __CxxFrameHandler3
// 
// Library: Visual Studio 2012 Release

void FID_conflict___CxxFrameHandler
               (int *param_1,undefined8 param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4)

{
  _ptiddata p_Var1;
  undefined8 local_res8;
  
  local_res8 = param_2;
  p_Var1 = _getptd();
  p_Var1->_ImageBase = *(ulonglong *)(param_4 + 8);
  p_Var1 = _getptd();
  p_Var1->_ThrowImageBase = *(ulonglong *)(param_1 + 0xe);
  p_Var1 = _getptd();
  __InternalCxxFrameHandler
            (param_1,(unsigned___int64 *)&local_res8,param_3,param_4,
             (_s_FuncInfo *)((ulonglong)**(uint **)(param_4 + 0x38) + p_Var1->_ImageBase),0,
             (unsigned___int64 *)0x0,0);
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  __chkstk
// 
// Libraries: Visual Studio 2005, Visual Studio 2008, Visual Studio 2010, Visual Studio 2012

void __chkstk(void)

{
  undefined *in_RAX;
  undefined *puVar1;
  undefined *puVar2;
  longlong in_GS_OFFSET;
  undefined local_res8 [32];
  
  puVar1 = local_res8 + -(longlong)in_RAX;
  if (local_res8 < in_RAX) {
    puVar1 = (undefined *)0x0;
  }
  puVar2 = *(undefined **)(in_GS_OFFSET + 0x10);
  if (puVar1 < puVar2) {
    do {
      puVar2 = puVar2 + -0x1000;
      *puVar2 = 0;
    } while ((undefined *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
  }
  return;
}



// Library Function - Single Match
//  wcscat_s
// 
// Library: Visual Studio 2012 Release

errno_t wcscat_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src)

{
  wchar_t wVar1;
  errno_t *peVar2;
  wchar_t *pwVar3;
  errno_t eVar4;
  
  if ((_Dst != (wchar_t *)0x0) && (_SizeInWords != 0)) {
    pwVar3 = _Dst;
    if (_Src == (wchar_t *)0x0) {
      *_Dst = L'\0';
    }
    else {
      do {
        if (*pwVar3 == L'\0') break;
        pwVar3 = pwVar3 + 1;
        _SizeInWords = _SizeInWords - 1;
      } while (_SizeInWords != 0);
      if (_SizeInWords != 0) {
        pwVar3 = (wchar_t *)((longlong)pwVar3 - (longlong)_Src);
        do {
          wVar1 = *_Src;
          *(wchar_t *)((longlong)pwVar3 + (longlong)_Src) = wVar1;
          _Src = _Src + 1;
          if (wVar1 == L'\0') break;
          _SizeInWords = _SizeInWords - 1;
        } while (_SizeInWords != 0);
        if (_SizeInWords != 0) {
          return 0;
        }
        *_Dst = L'\0';
        peVar2 = _errno();
        eVar4 = 0x22;
        goto LAB_18001e929;
      }
      *_Dst = L'\0';
    }
  }
  peVar2 = _errno();
  eVar4 = 0x16;
LAB_18001e929:
  *peVar2 = eVar4;
  FUN_18001fee8();
  return eVar4;
}



void FUN_18001e988(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)DecodePointer(DAT_18004c2d0);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  FUN_1800233f8(0,1);
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001e9b4(undefined8 param_1,int param_2,longlong param_3)

{
  bool bVar1;
  int iVar2;
  DWORD DVar3;
  undefined7 extraout_var;
  undefined8 uVar4;
  longlong lVar5;
  DWORD *_Memory;
  
  if (param_2 == 1) {
    bVar1 = FUN_18001f9ac();
    if ((int)CONCAT71(extraout_var,bVar1) != 0) {
      iVar2 = _mtinit();
      if (iVar2 != 0) {
        FUN_180024598();
        DAT_18004e150 = GetCommandLineA();
        DAT_18004bcb0 = __crtGetEnvironmentStringsA();
        uVar4 = FUN_180023654();
        if (-1 < (int)uVar4) {
          iVar2 = _setargv();
          if (((-1 < iVar2) && (iVar2 = _setenvp(), -1 < iVar2)) &&
             (uVar4 = FUN_18001f1f0(), (int)uVar4 == 0)) {
            DAT_18004bca8 = DAT_18004bca8 + 1;
            goto LAB_18001eb08;
          }
          _ioterm();
        }
        FUN_180021e40();
      }
      FUN_18001f9cc();
    }
LAB_18001e9cf:
    uVar4 = 0;
  }
  else {
    if (param_2 == 0) {
      if (DAT_18004bca8 < 1) goto LAB_18001e9cf;
      DAT_18004bca8 = DAT_18004bca8 + -1;
      if (_DAT_18004bd08 == 0) {
        FUN_18001f1e0();
      }
      FUN_18001f070();
      if (param_3 == 0) {
        _ioterm();
        FUN_180021e40();
        FUN_18001f9cc();
        if (DAT_180049320 != -1) {
          FUN_180021e40();
        }
      }
    }
    else {
      if (param_2 == 2) {
        lVar5 = FUN_1800240a4();
        if (lVar5 == 0) {
          _Memory = (DWORD *)FUN_18001f568(1,0x478);
          if (_Memory != (DWORD *)0x0) {
            iVar2 = FUN_1800240c0();
            if (iVar2 != 0) {
              FUN_180021cfc((longlong)_Memory,0);
              DVar3 = GetCurrentThreadId();
              *_Memory = DVar3;
              *(undefined8 *)(_Memory + 2) = 0xffffffffffffffff;
              goto LAB_18001eb08;
            }
            free(_Memory);
          }
          goto LAB_18001e9cf;
        }
      }
      else {
        if (param_2 == 3) {
          _freeptd((_ptiddata)0x0);
        }
      }
    }
LAB_18001eb08:
    uVar4 = 1;
  }
  return uVar4;
}



// WARNING: Removing unreachable block (ram,0x00018001ec13)
// WARNING: Removing unreachable block (ram,0x00018001eba5)
// WARNING: Removing unreachable block (ram,0x00018001ec4d)

ulonglong entry(undefined8 param_1,int param_2,longlong param_3,undefined8 param_4)

{
  ulonglong uVar1;
  undefined8 uVar2;
  ulonglong uVar3;
  
  if (param_2 == 1) {
    FUN_180023de8();
  }
  if ((param_2 == 0) && (DAT_18004bca8 == 0)) {
    uVar1 = 0;
  }
  else {
    if ((param_2 - 1U < 2) && (uVar2 = FUN_18001e9b4(param_1,param_2,param_3), (int)uVar2 == 0)) {
      uVar1 = 0;
    }
    else {
      uVar3 = FUN_18001a9d0();
      uVar1 = uVar3 & 0xffffffff;
      if ((param_2 == 1) && ((int)uVar3 == 0)) {
        FUN_18001a9d0();
        FUN_18001e9b4(param_1,0,param_3);
      }
      if ((param_2 == 0) || (param_2 == 3)) {
        uVar2 = FUN_18001e9b4(param_1,param_2,param_3);
        uVar1 = (ulonglong)(-(uint)((int)uVar2 != 0) & (uint)uVar1);
      }
    }
  }
  return uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  malloc
// 
// Library: Visual Studio 2012 Release

void * malloc(size_t _Size)

{
  int iVar1;
  void *pvVar2;
  int *piVar3;
  SIZE_T dwBytes;
  
  if (_Size < 0xffffffffffffffe1) {
    dwBytes = 1;
    if (_Size != 0) {
      dwBytes = _Size;
    }
    do {
      if (DAT_18004bd28 == (HANDLE)0x0) {
        _FF_MSGBANNER();
        _NMSG_WRITE(0x1e);
        FUN_18001f058(0xff);
      }
      pvVar2 = HeapAlloc(DAT_18004bd28,0,dwBytes);
      if (pvVar2 != (LPVOID)0x0) {
        return pvVar2;
      }
      if (_DAT_18004cc28 == 0) {
        piVar3 = _errno();
        *piVar3 = 0xc;
        break;
      }
      iVar1 = _callnewh(_Size);
    } while (iVar1 != 0);
    piVar3 = _errno();
    *piVar3 = 0xc;
  }
  else {
    _callnewh(_Size);
    piVar3 = _errno();
    *piVar3 = 0xc;
    pvVar2 = (void *)0x0;
  }
  return pvVar2;
}



// Library Function - Single Match
//  calloc
// 
// Library: Visual Studio 2012 Release

void * calloc(size_t _Count,size_t _Size)

{
  LPVOID pvVar1;
  int *piVar2;
  int local_res18 [4];
  
  local_res18[0] = 0;
  pvVar1 = _calloc_impl(_Count,_Size,local_res18);
  if ((pvVar1 == (LPVOID)0x0) && (local_res18[0] != 0)) {
    piVar2 = _errno();
    if (piVar2 != (int *)0x0) {
      piVar2 = _errno();
      *piVar2 = local_res18[0];
    }
  }
  return pvVar1;
}



// Library Function - Single Match
//  public: __cdecl std::exception::exception(char const * __ptr64 const & __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

exception * __thiscall std::exception::exception(exception *this,char **param_1)

{
  *(undefined8 *)(this + 8) = 0;
  this[0x10] = (exception)0x0;
  *(undefined ***)this = vftable;
  _Copy_str(this,*param_1);
  return this;
}



// Library Function - Single Match
//  public: __cdecl std::exception::exception(char const * __ptr64 const & __ptr64,int) __ptr64
// 
// Library: Visual Studio 2012 Release

exception * __thiscall std::exception::exception(exception *this,char **param_1,int param_2)

{
  char *pcVar1;
  
  *(undefined ***)this = vftable;
  pcVar1 = *param_1;
  this[0x10] = (exception)0x0;
  *(char **)(this + 8) = pcVar1;
  return this;
}



// Library Function - Single Match
//  public: __cdecl std::exception::exception(class std::exception const & __ptr64) __ptr64
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

exception * __thiscall std::exception::exception(exception *this,exception *param_1)

{
  *(undefined8 *)(this + 8) = 0;
  *(undefined ***)this = vftable;
  this[0x10] = (exception)0x0;
  operator_(this,param_1);
  return this;
}



void FUN_18001ede8(undefined **param_1)

{
  *param_1 = (undefined *)std::exception::vftable;
  std::exception::_Tidy((exception *)param_1);
  return;
}



// Library Function - Single Match
//  public: class std::exception & __ptr64 __cdecl std::exception::operator=(class std::exception
// const & __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

exception * __thiscall std::exception::operator_(exception *this,exception *param_1)

{
  if (this != param_1) {
    _Tidy(this);
    if (param_1[0x10] == (exception)0x0) {
      *(undefined8 *)(this + 8) = *(undefined8 *)(param_1 + 8);
    }
    else {
      _Copy_str(this,*(char **)(param_1 + 8));
    }
  }
  return this;
}



undefined ** FUN_18001ee3c(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)std::exception::vftable;
  std::exception::_Tidy((exception *)param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  private: void __cdecl std::exception::_Copy_str(char const * __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

void __thiscall std::exception::_Copy_str(exception *this,char *param_1)

{
  size_t sVar1;
  char *_Dst;
  
  if (param_1 != (char *)0x0) {
    sVar1 = strlen(param_1);
    _Dst = (char *)malloc(sVar1 + 1);
    *(char **)(this + 8) = _Dst;
    if (_Dst != (char *)0x0) {
      strcpy_s(_Dst,sVar1 + 1,param_1);
      this[0x10] = (exception)0x1;
    }
  }
  return;
}



// Library Function - Single Match
//  private: void __cdecl std::exception::_Tidy(void) __ptr64
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void __thiscall std::exception::_Tidy(exception *this)

{
  if (this[0x10] != (exception)0x0) {
    free(*(void **)(this + 8));
  }
  *(undefined8 *)(this + 8) = 0;
  this[0x10] = (exception)0x0;
  return;
}



char * FUN_18001eefc(longlong param_1)

{
  char *pcVar1;
  
  pcVar1 = "Unknown exception";
  if (*(longlong *)(param_1 + 8) != 0) {
    pcVar1 = *(char **)(param_1 + 8);
  }
  return pcVar1;
}



// Library Function - Single Match
//  _callnewh
// 
// Library: Visual Studio 2012 Release

int _callnewh(size_t _Size)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = (code *)DecodePointer(DAT_18004bcc0);
  if ((pcVar2 != (code *)0x0) && (iVar1 = (*pcVar2)(_Size), iVar1 != 0)) {
    return 1;
  }
  return 0;
}



void FUN_18001ef44(undefined8 param_1)

{
  DAT_18004bcc0 = param_1;
  return;
}



void FUN_18001ef4c(longlong *param_1,byte *param_2)

{
  PVOID local_res8;
  undefined4 local_28;
  undefined4 uStack36;
  longlong *plStack32;
  byte *local_18;
  PVOID pvStack16;
  
  local_28 = 0x19930520;
  uStack36 = 0;
  plStack32 = (longlong *)0x0;
  local_18 = (byte *)0x0;
  pvStack16 = (PVOID)0x0;
  if ((param_2 != (byte *)0x0) && ((*param_2 & 0x10) != 0)) {
    param_2 = *(byte **)(*(longlong *)(*param_1 + -8) + 0x30);
    (**(code **)(*(longlong *)(*param_1 + -8) + 0x40))();
  }
  plStack32 = param_1;
  local_18 = param_2;
  local_res8 = RtlPcToFileHeader(param_2,&local_res8);
  if (param_2 != (byte *)0x0) {
    if ((*param_2 & 8) == 0) {
      if (local_res8 == (PVOID)0x0) {
        local_28 = 0x1994000;
      }
    }
    else {
      local_28 = 0x1994000;
    }
  }
  pvStack16 = local_res8;
  RaiseException(0xe06d7363,1,4,(ULONG_PTR *)&local_28);
  return;
}



// Library Function - Single Match
//  __crtCorExitProcess
// 
// Library: Visual Studio 2012 Release

void __crtCorExitProcess(int param_1)

{
  BOOL BVar1;
  FARPROC pFVar2;
  HMODULE local_res10 [3];
  uint extraout_var;
  
  BVar1 = GetModuleHandleExW(0,L"mscoree.dll",local_res10);
  if (BVar1 != 0) {
    pFVar2 = GetProcAddress(local_res10[0],"CorExitProcess");
    extraout_var = (uint)((ulonglong)pFVar2 >> 0x20);
    if (((ulonglong)pFVar2 & 0xffffffff | (ulonglong)extraout_var << 0x20) != 0) {
      (*(code *)((ulonglong)pFVar2 & 0xffffffff | (ulonglong)extraout_var << 0x20))(param_1);
    }
  }
  return;
}



void FUN_18001f058(UINT param_1)

{
  __crtCorExitProcess(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_18001f070(void)

{
  int iVar1;
  PVOID _Memory;
  void **ppvVar2;
  
  _Memory = DecodePointer(DAT_18004e140);
  for (ppvVar2 = DAT_18004bce8; (ppvVar2 != (void **)0x0 && (*ppvVar2 != (void *)0x0));
      ppvVar2 = ppvVar2 + 1) {
    free(*ppvVar2);
  }
  free(DAT_18004bce8);
  DAT_18004bce8 = (void **)0x0;
  for (ppvVar2 = DAT_18004bce0; (ppvVar2 != (void **)0x0 && (*ppvVar2 != (void *)0x0));
      ppvVar2 = ppvVar2 + 1) {
    free(*ppvVar2);
  }
  free(DAT_18004bce0);
  DAT_18004bce0 = (void **)0x0;
  free(DAT_18004bcd8);
  free(DAT_18004bcd0);
  DAT_18004bcd8 = (void *)0x0;
  DAT_18004bcd0 = (void *)0x0;
  if ((_Memory != (PVOID)0xffffffffffffffff) && (DAT_18004e140 != (PVOID)0x0)) {
    free(_Memory);
  }
  DAT_18004e140 = EncodePointer((PVOID)0xffffffffffffffff);
  if (DAT_18004ceb8 != (void *)0x0) {
    free(DAT_18004ceb8);
    DAT_18004ceb8 = (void *)0x0;
  }
  if (DAT_18004cec0 != (void *)0x0) {
    free(DAT_18004cec0);
    DAT_18004cec0 = (void *)0x0;
  }
  LOCK();
  iVar1 = *(int *)PTR_DAT_180049b50;
  *(int *)PTR_DAT_180049b50 = *(int *)PTR_DAT_180049b50 + -1;
  if ((iVar1 == 1) && ((undefined4 *)PTR_DAT_180049b50 != &DAT_180049830)) {
    free(PTR_DAT_180049b50);
    PTR_DAT_180049b50 = (undefined *)&DAT_180049830;
  }
  return;
}



// Library Function - Single Match
//  _amsg_exit
// 
// Library: Visual Studio 2012 Release

void _amsg_exit(int param_1)

{
  code *pcVar1;
  
  _FF_MSGBANNER();
  _NMSG_WRITE(param_1);
  FUN_18001f394(0xff,1,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18001f1e0(void)

{
  FUN_18001f394(0,0,1);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001f1f0(void)

{
  BOOL BVar1;
  undefined8 uVar2;
  
  BVar1 = _IsNonwritableInCurrentImage((PBYTE)&PTR_thunk_FUN_180028c7c_180037f18);
  if (BVar1 != 0) {
    thunk_FUN_180028c7c();
  }
  _initp_misc_cfltcvt_tab();
  uVar2 = _initterm_e((undefined **)&DAT_18002d468,(undefined **)&DAT_18002d490);
  if ((int)uVar2 == 0) {
    atexit(&LAB_1800245d0);
    FUN_18001f2e0((undefined **)&DAT_18002d450,(undefined **)&DAT_18002d460);
    if ((_DAT_18004e130 != (code *)0x0) &&
       (BVar1 = _IsNonwritableInCurrentImage(&DAT_18004e130), BVar1 != 0)) {
      (*_DAT_18004e130)(0,2);
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_18001f288(UINT param_1)

{
  FUN_18001f394(param_1,1,0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001f294(void)

{
  PVOID pvVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  
  pvVar1 = EncodePointer((PVOID)0x0);
  FUN_18001ef44(pvVar1);
  FUN_18001fe78(pvVar1);
  FUN_18002346c(pvVar1);
  FUN_180024e3c(pvVar1);
  FUN_1800233d8();
  FUN_180025090(pvVar1);
  hModule = GetModuleHandleW(L"kernel32.dll");
  pFVar2 = GetProcAddress(hModule,"FlsAlloc");
  DAT_18004e020 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"FlsFree");
  DAT_18004e028 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"FlsGetValue");
  DAT_18004e030 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"FlsSetValue");
  DAT_18004e038 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"InitializeCriticalSectionEx");
  DAT_18004e040 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CreateEventExW");
  _DAT_18004e048 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CreateSemaphoreExW");
  _DAT_18004e050 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"SetThreadStackGuarantee");
  _DAT_18004e058 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CreateThreadpoolTimer");
  _DAT_18004e060 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"SetThreadpoolTimer");
  _DAT_18004e068 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"WaitForThreadpoolTimerCallbacks");
  _DAT_18004e070 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CloseThreadpoolTimer");
  _DAT_18004e078 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CreateThreadpoolWait");
  _DAT_18004e080 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"SetThreadpoolWait");
  _DAT_18004e088 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CloseThreadpoolWait");
  _DAT_18004e090 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"FlushProcessWriteBuffers");
  _DAT_18004e098 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"FreeLibraryWhenCallbackReturns");
  _DAT_18004e0a0 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetCurrentProcessorNumber");
  _DAT_18004e0a8 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetLogicalProcessorInformation");
  _DAT_18004e0b0 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CreateSymbolicLinkW");
  _DAT_18004e0b8 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"SetDefaultDllDirectories");
  _DAT_18004e0c0 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"EnumSystemLocalesEx");
  _DAT_18004e0d0 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"CompareStringEx");
  _DAT_18004e0c8 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetDateFormatEx");
  _DAT_18004e0d8 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetLocaleInfoEx");
  _DAT_18004e0e0 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetTimeFormatEx");
  _DAT_18004e0e8 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetUserDefaultLocaleName");
  _DAT_18004e0f0 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"IsValidLocaleName");
  _DAT_18004e0f8 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"LCMapStringEx");
  DAT_18004e100 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetCurrentPackageId");
  DAT_18004e108 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetTickCount64");
  _DAT_18004e110 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"GetFileInformationByHandleExW");
  _DAT_18004e118 = (ulonglong)pFVar2 ^ DAT_180049180;
  pFVar2 = GetProcAddress(hModule,"SetFileInformationByHandleW");
  _DAT_18004e120 = (ulonglong)pFVar2 ^ DAT_180049180;
  return;
}



void FUN_18001f2e0(undefined **param_1,undefined **param_2)

{
  ulonglong uVar1;
  ulonglong uVar2;
  
  uVar2 = 0;
  uVar1 = (ulonglong)((longlong)param_2 + (7 - (longlong)param_1)) >> 3;
  if (param_2 < param_1) {
    uVar1 = uVar2;
  }
  if (uVar1 != 0) {
    do {
      if ((code *)*param_1 != (code *)0x0) {
        (*(code *)*param_1)();
      }
      uVar2 = uVar2 + 1;
      param_1 = (code **)param_1 + 1;
    } while (uVar2 < uVar1);
  }
  return;
}



// Library Function - Single Match
//  _initterm_e
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

void _initterm_e(undefined **param_1,undefined **param_2)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 < param_2) {
    do {
      if (iVar1 != 0) {
        return;
      }
      if ((code *)*param_1 != (code *)0x0) {
        iVar1 = (*(code *)*param_1)();
      }
      param_1 = (code **)param_1 + 1;
    } while (param_1 < param_2);
  }
  return;
}



void FUN_18001f37c(void)

{
  _lock(8);
  return;
}



void FUN_18001f388(void)

{
  FUN_180024d08(8);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001f394(UINT param_1,int param_2,int param_3)

{
  PVOID *ppvVar1;
  PVOID *ppvVar2;
  PVOID pvVar3;
  code *pcVar4;
  PVOID *ppvVar5;
  PVOID *ppvVar6;
  PVOID *ppvVar7;
  PVOID *ppvVar8;
  
  _lock(8);
  if (_DAT_18004bcc8 != 1) {
    _DAT_18004bd08 = 1;
    DAT_18004bd04 = (undefined)param_3;
    if (param_2 == 0) {
      ppvVar1 = (PVOID *)DecodePointer(DAT_18004e140);
      if (ppvVar1 != (PVOID *)0x0) {
        ppvVar2 = (PVOID *)DecodePointer(DAT_18004e138);
        ppvVar7 = ppvVar1;
        ppvVar8 = ppvVar2;
        while (ppvVar2 = ppvVar2 + -1, ppvVar1 <= ppvVar2) {
          pvVar3 = EncodePointer((PVOID)0x0);
          if (*ppvVar2 != pvVar3) {
            if (ppvVar2 < ppvVar1) break;
            pcVar4 = (code *)DecodePointer(*ppvVar2);
            pvVar3 = EncodePointer((PVOID)0x0);
            *ppvVar2 = pvVar3;
            (*pcVar4)();
            ppvVar5 = (PVOID *)DecodePointer(DAT_18004e140);
            ppvVar6 = (PVOID *)DecodePointer(DAT_18004e138);
            if ((ppvVar7 != ppvVar5) || (ppvVar8 != ppvVar6)) {
              ppvVar1 = ppvVar5;
              ppvVar2 = ppvVar6;
              ppvVar7 = ppvVar5;
              ppvVar8 = ppvVar6;
            }
          }
        }
      }
      FUN_18001f2e0((undefined **)&DAT_18002d498,(undefined **)&DAT_18002d4b8);
    }
    FUN_18001f2e0((undefined **)&DAT_18002d4c0,(undefined **)&DAT_18002d4c8);
  }
  if ((param_3 != 0) && (FUN_180024d08(8), param_3 != 0)) {
    return;
  }
  _DAT_18004bcc8 = 1;
  FUN_180024d08(8);
  __crtCorExitProcess(param_1);
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



// Library Function - Single Match
//  _msize
// 
// Library: Visual Studio 2012 Release

size_t _msize(void *_Memory)

{
  int *piVar1;
  size_t sVar2;
  
  if (_Memory == (void *)0x0) {
    piVar1 = _errno();
    *piVar1 = 0x16;
    FUN_18001fee8();
    return 0xffffffffffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x00018001f55e. Too many branches
                    // WARNING: Treating indirect jump as call
  sVar2 = HeapSize(DAT_18004bd28,0,_Memory);
  return sVar2;
}



LPVOID FUN_18001f568(ulonglong param_1,ulonglong param_2)

{
  LPVOID pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    pvVar1 = _calloc_impl(param_1,param_2,(undefined4 *)0x0);
    if (pvVar1 != (LPVOID)0x0) {
      return pvVar1;
    }
    if (DAT_18004bd20 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_18004bd20 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (LPVOID)0x0;
    }
  }
  return (LPVOID)0x0;
}



void * FUN_18001f5e8(size_t param_1)

{
  uint uVar1;
  void *pvVar2;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  while( true ) {
    uVar1 = DAT_18004bd20;
    pvVar2 = malloc(param_1);
    if (pvVar2 != (void *)0x0) {
      return pvVar2;
    }
    if (uVar1 == 0) break;
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_18004bd20 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
    if (dwMilliseconds == 0xffffffff) {
      return (void *)0x0;
    }
  }
  return (void *)0x0;
}



void * FUN_18001f664(void *param_1,size_t param_2)

{
  void *pvVar1;
  uint dwMilliseconds;
  
  dwMilliseconds = 0;
  do {
    pvVar1 = realloc(param_1,param_2);
    if (pvVar1 != (void *)0x0) {
      return pvVar1;
    }
    if (param_2 == 0) {
      return (void *)0x0;
    }
    if (DAT_18004bd20 == 0) {
      return (void *)0x0;
    }
    Sleep(dwMilliseconds);
    dwMilliseconds = dwMilliseconds + 1000;
    if (DAT_18004bd20 < dwMilliseconds) {
      dwMilliseconds = 0xffffffff;
    }
  } while (dwMilliseconds != 0xffffffff);
  return (void *)0x0;
}



undefined8
FUN_18001f6e8(PEXCEPTION_RECORD param_1,PVOID param_2,undefined8 param_3,longlong *param_4)

{
  uint uVar1;
  longlong lVar2;
  uint *puVar3;
  int iVar4;
  BOOL BVar5;
  ulonglong uVar6;
  uint uVar7;
  ulonglong uVar8;
  uint uVar9;
  ulonglong uVar10;
  ulonglong uVar11;
  PEXCEPTION_RECORD local_38;
  undefined8 local_30;
  
  lVar2 = param_4[1];
  puVar3 = (uint *)param_4[7];
  uVar11 = *param_4 - lVar2;
  if ((*(byte *)&param_1->ExceptionFlags & 0x66) == 0) {
    local_38 = param_1;
    local_30 = param_3;
    for (uVar7 = *(uint *)(param_4 + 9); uVar7 < *puVar3; uVar7 = uVar7 + 1) {
      uVar8 = (ulonglong)uVar7;
      if (((puVar3[uVar8 * 4 + 1] <= uVar11) && (uVar11 < puVar3[uVar8 * 4 + 2])) &&
         (puVar3[uVar8 * 4 + 4] != 0)) {
        if (puVar3[uVar8 * 4 + 3] != 1) {
          iVar4 = (*(code *)((ulonglong)puVar3[uVar8 * 4 + 3] + lVar2))(&local_38,param_2);
          if (iVar4 < 0) {
            return 0;
          }
          if (iVar4 < 1) goto LAB_18001f7f5;
        }
        if ((param_1->ExceptionCode == 0xe06d7363) &&
           (BVar5 = _IsNonwritableInCurrentImage((PBYTE)&PTR___DestructExceptionObject_1800325d0),
           BVar5 != 0)) {
          __DestructExceptionObject((int *)param_1);
        }
        FUN_1800259b0();
        RtlUnwindEx(param_2,(PVOID)((ulonglong)puVar3[uVar8 * 4 + 4] + lVar2),param_1,
                    (PVOID)(ulonglong)param_1->ExceptionCode,(PCONTEXT)param_4[5],
                    (PUNWIND_HISTORY_TABLE)param_4[8]);
        FUN_1800259e0();
      }
LAB_18001f7f5:
    }
  }
  else {
    uVar8 = param_4[4] - lVar2;
    for (uVar7 = *(uint *)(param_4 + 9); uVar1 = *puVar3, uVar7 < uVar1; uVar7 = uVar7 + 1) {
      uVar6 = (ulonglong)uVar7;
      if ((puVar3[uVar6 * 4 + 1] <= uVar11) && (uVar11 < puVar3[uVar6 * 4 + 2])) {
        if ((*(byte *)&param_1->ExceptionFlags & 0x20) != 0) {
          uVar10 = 0;
          if (uVar1 != 0) {
            do {
              if ((((puVar3[uVar10 * 4 + 1] <= uVar8) && (uVar8 < puVar3[uVar10 * 4 + 2])) &&
                  (puVar3[uVar10 * 4 + 4] == puVar3[uVar6 * 4 + 4])) &&
                 (puVar3[uVar10 * 4 + 3] == puVar3[uVar6 * 4 + 3])) break;
              uVar9 = (int)uVar10 + 1;
              uVar10 = (ulonglong)uVar9;
            } while (uVar9 < uVar1);
          }
          if ((uint)uVar10 != uVar1) {
            return 1;
          }
        }
        if (puVar3[uVar6 * 4 + 4] == 0) {
          *(uint *)(param_4 + 9) = uVar7 + 1;
          (*(code *)((ulonglong)puVar3[uVar6 * 4 + 3] + lVar2))();
        }
        else {
          if (uVar8 == puVar3[uVar6 * 4 + 4]) {
            return 1;
          }
        }
      }
    }
  }
  return 1;
}



// Library Function - Single Match
//  __doserrno
// 
// Library: Visual Studio 2012 Release

ulong * __doserrno(void)

{
  _ptiddata p_Var1;
  ulong *puVar2;
  
  p_Var1 = _getptd_noexit();
  if (p_Var1 == (_ptiddata)0x0) {
    puVar2 = &DAT_1800492fc;
  }
  else {
    puVar2 = &p_Var1->_tdoserrno;
  }
  return puVar2;
}



// Library Function - Single Match
//  _dosmaperr
// 
// Library: Visual Studio 2012 Release

void _dosmaperr(ulong param_1)

{
  int iVar1;
  _ptiddata p_Var2;
  ulong *puVar3;
  int *piVar4;
  
  p_Var2 = _getptd_noexit();
  if (p_Var2 == (_ptiddata)0x0) {
    puVar3 = &DAT_1800492fc;
  }
  else {
    puVar3 = &p_Var2->_tdoserrno;
  }
  *puVar3 = param_1;
  p_Var2 = _getptd_noexit();
  piVar4 = (int *)&DAT_1800492f8;
  if (p_Var2 != (_ptiddata)0x0) {
    piVar4 = &p_Var2->_terrno;
  }
  iVar1 = _get_errno_from_oserr(param_1);
  *piVar4 = iVar1;
  return;
}



// Library Function - Single Match
//  _errno
// 
// Library: Visual Studio 2012 Release

int * _errno(void)

{
  _ptiddata p_Var1;
  int *piVar2;
  
  p_Var1 = _getptd_noexit();
  if (p_Var1 == (_ptiddata)0x0) {
    piVar2 = (int *)&DAT_1800492f8;
  }
  else {
    piVar2 = &p_Var1->_terrno;
  }
  return piVar2;
}



// Library Function - Single Match
//  _get_errno_from_oserr
// 
// Library: Visual Studio 2012 Release

int _get_errno_from_oserr(ulong param_1)

{
  int iVar1;
  uint uVar2;
  ulong *puVar3;
  
  uVar2 = 0;
  puVar3 = &DAT_180049190;
  do {
    if (param_1 == *puVar3) {
      return *(int *)((longlong)&DAT_180049194 + (longlong)(int)uVar2 * 8);
    }
    uVar2 = uVar2 + 1;
    puVar3 = puVar3 + 2;
  } while (uVar2 < 0x2d);
  if (param_1 - 0x13 < 0x12) {
    return 0xd;
  }
  iVar1 = 0x16;
  if (param_1 - 0xbc < 0xf) {
    iVar1 = 8;
  }
  return iVar1;
}



bool FUN_18001f9ac(void)

{
  DAT_18004bd28 = GetProcessHeap();
  return DAT_18004bd28 != (HANDLE)0x0;
}



void FUN_18001f9cc(void)

{
  DAT_18004bd28 = 0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_18001f9d8(EXCEPTION_POINTERS *param_1)

{
  HANDLE hProcess;
  
  _DAT_18004c2a0 = IsDebuggerPresent();
  FUN_1800259e4();
  __crtUnhandledException(param_1);
  if (_DAT_18004c2a0 == 0) {
    FUN_1800259e4();
  }
  hProcess = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180024570. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(hProcess,0xc0000409);
  return;
}



// WARNING: Removing unreachable block (ram,0x00018001fc0e)
// WARNING: Removing unreachable block (ram,0x00018001fb78)
// WARNING: Removing unreachable block (ram,0x00018001fb12)
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_18001faf8(void)

{
  int *piVar1;
  uint *puVar2;
  longlong lVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar6 = 0;
  piVar1 = (int *)cpuid_basic_info(0);
  _DAT_180049304 = 2;
  DAT_180049300 = 1;
  puVar2 = (uint *)cpuid_Version_info(1);
  uVar4 = puVar2[3];
  if (((piVar1[2] ^ 0x49656e69U | piVar1[3] ^ 0x6c65746eU | piVar1[1] ^ 0x756e6547U) == 0) &&
     ((((uVar5 = *puVar2 & 0xfff3ff0, uVar5 == 0x106c0 || (uVar5 == 0x20660)) || (uVar5 == 0x20670))
      || ((uVar5 - 0x30650 < 0x21 &&
          ((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))))) {
    DAT_18004c2a4 = DAT_18004c2a4 | 1;
  }
  if (((piVar1[1] ^ 0x68747541U | piVar1[2] ^ 0x69746e65U | piVar1[3] ^ 0x444d4163U) == 0) &&
     (0x600eff < (*puVar2 & 0xff00f00))) {
    DAT_18004c2a4 = DAT_18004c2a4 | 4;
  }
  if (6 < *piVar1) {
    lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
    uVar6 = *(uint *)(lVar3 + 4);
    if ((uVar6 >> 9 & 1) != 0) {
      DAT_18004c2a4 = DAT_18004c2a4 | 2;
    }
  }
  if ((uVar4 >> 0x14 & 1) != 0) {
    DAT_180049300 = 2;
    _DAT_180049304 = 6;
    if (((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) {
      DAT_180049300 = 3;
      _DAT_180049304 = 0xe;
      if ((uVar6 & 0x20) != 0) {
        DAT_180049300 = 5;
        _DAT_180049304 = 0x2e;
      }
    }
  }
  return 0;
}



// Library Function - Single Match
//  strcmp
// 
// Library: Visual Studio 2012 Release

int strcmp(char *_Str1,char *_Str2)

{
  byte bVar1;
  ulonglong uVar2;
  char *pcVar3;
  
  pcVar3 = _Str2 + -(longlong)_Str1;
  uVar2 = (ulonglong)_Str1 & 7;
  while( true ) {
    if (uVar2 == 0) {
      while ((((int)_Str1 + (int)pcVar3 & 0xfffU) < 0xff9 &&
             (uVar2 = *(ulonglong *)_Str1,
             uVar2 == *(ulonglong *)((longlong)_Str1 + (longlong)pcVar3)))) {
        _Str1 = (char *)((longlong)_Str1 + 8);
        if ((~uVar2 & uVar2 + 0xfefefefefefefeff & 0x8080808080808080) != 0) {
          return 0;
        }
      }
    }
    bVar1 = *_Str1;
    if (bVar1 != *(byte *)((longlong)_Str1 + (longlong)pcVar3)) break;
    _Str1 = (char *)((longlong)_Str1 + 1);
    if (bVar1 == 0) {
      return 0;
    }
    uVar2 = (ulonglong)_Str1 & 7;
  }
  return (int)(-(uint)(bVar1 < *(byte *)((longlong)_Str1 + (longlong)pcVar3)) | 1);
}



// Library Function - Single Match
//  private: static void __cdecl type_info::_Type_info_dtor(class type_info * __ptr64)
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void type_info::_Type_info_dtor(type_info *param_1)

{
  longlong *_Memory;
  longlong *plVar1;
  longlong *plVar2;
  
  _lock(0xe);
  _Memory = DAT_18004c2b0;
  if (*(longlong *)(param_1 + 8) != 0) {
    plVar1 = (longlong *)&DAT_18004c2a8;
    do {
      plVar2 = plVar1;
      if (DAT_18004c2b0 == (longlong *)0x0) goto LAB_18001fd66;
      plVar1 = DAT_18004c2b0;
    } while (*DAT_18004c2b0 != *(longlong *)(param_1 + 8));
    plVar2[1] = DAT_18004c2b0[1];
    free(_Memory);
LAB_18001fd66:
    free(*(void **)(param_1 + 8));
    *(undefined8 *)(param_1 + 8) = 0;
  }
  FUN_180024d08(0xe);
  return;
}



// Library Function - Single Match
//  _call_reportfault
// 
// Library: Visual Studio 2012 Release

void _call_reportfault(int nDbgHookCode,DWORD dwExceptionCode,DWORD dwExceptionFlags)

{
  BOOL BVar1;
  LONG LVar2;
  undefined auStackX8 [8];
  undefined auStack1464 [32];
  EXCEPTION_POINTERS local_598;
  undefined local_588 [4];
  DWORD local_584;
  CONTEXT local_4e8;
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)auStack1464;
  if (nDbgHookCode != -1) {
    FUN_1800259e4();
  }
  local_588 = 0;
  FUN_18001d980((undefined (*) [16])&local_584,0,0x94);
  local_598.ExceptionRecord = (PEXCEPTION_RECORD)local_588;
  local_598.ContextRecord = (PCONTEXT)&local_4e8;
  __crtCaptureCurrentContext(&local_4e8);
  local_4e8.Rsp = (DWORD64)auStackX8;
  local_588 = dwExceptionCode;
  local_584 = dwExceptionFlags;
  BVar1 = IsDebuggerPresent();
  LVar2 = __crtUnhandledException(&local_598);
  if (((LVar2 == 0) && (BVar1 == 0)) && (nDbgHookCode != -1)) {
    FUN_1800259e4();
  }
  FUN_18001d2f0(local_18 ^ (ulonglong)auStack1464);
  return;
}



void FUN_18001fe78(undefined8 param_1)

{
  DAT_18004c2b8 = param_1;
  return;
}



// Library Function - Single Match
//  _invalid_parameter
// 
// Library: Visual Studio 2012 Release

void _invalid_parameter(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,
                       uintptr_t param_5)

{
  code *UNRECOVERED_JUMPTABLE;
  
  UNRECOVERED_JUMPTABLE = (code *)DecodePointer(DAT_18004c2b8);
  if (UNRECOVERED_JUMPTABLE != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018001fed2. Too many branches
                    // WARNING: Treating indirect jump as call
    (*UNRECOVERED_JUMPTABLE)();
    return;
  }
  _invoke_watson(param_1,param_2,param_3,param_4,param_5);
  UNRECOVERED_JUMPTABLE = (code *)swi(3);
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



void FUN_18001fee8(void)

{
  _invalid_parameter((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
  return;
}



// Library Function - Single Match
//  _invoke_watson
// 
// Library: Visual Studio 2012 Release

void _invoke_watson(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,
                   uintptr_t param_5)

{
  code *pcVar1;
  BOOL BVar2;
  HANDLE hProcess;
  undefined8 unaff_RBX;
  undefined *puVar3;
  undefined auStack40 [8];
  undefined auStack32 [32];
  
  puVar3 = auStack40;
  BVar2 = IsProcessorFeaturePresent(0x17);
  if (BVar2 != 0) {
    pcVar1 = (code *)swi(0x29);
    (*pcVar1)();
    puVar3 = auStack32;
  }
  *(undefined8 *)(puVar3 + -8) = 0x18001ff35;
  _call_reportfault(2,0xc0000417,1);
  *(undefined8 *)(puVar3 + 0x20) = unaff_RBX;
  *(undefined8 *)(puVar3 + -8) = 0x180024566;
  hProcess = GetCurrentProcess();
                    // WARNING: Could not recover jumptable at 0x000180024570. Too many branches
                    // WARNING: Treating indirect jump as call
  TerminateProcess(hProcess,0xc0000417);
  return;
}



// WARNING: Could not reconcile some variable overlaps

ulonglong FUN_18001ff44(undefined4 param_1,FILE *param_2)

{
  uint _FileHandle;
  int iVar1;
  uint uVar2;
  int *piVar3;
  undefined **ppuVar4;
  longlong lVar5;
  undefined *puVar6;
  uint uVar7;
  undefined4 local_res8 [2];
  
  local_res8[0] = param_1;
  _FileHandle = _fileno(param_2);
  uVar7 = param_2->_flag;
  if ((uVar7 & 0x82) == 0) {
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((uVar7 & 0x40) == 0) {
      uVar2 = 0;
      if ((uVar7 & 1) != 0) {
        param_2->_cnt = 0;
        if ((uVar7 & 0x10) == 0) {
          param_2->_flag = uVar7 | 0x20;
          return 0xffffffff;
        }
        param_2->_ptr = param_2->_base;
        param_2->_flag = uVar7 & 0xfffffffe;
      }
      uVar7 = param_2->_flag;
      param_2->_cnt = 0;
      param_2->_flag = uVar7 & 0xffffffef | 2;
      if (((uVar7 & 0x10c) == 0) &&
         (((ppuVar4 = FUN_180025ab4(), param_2 != (FILE *)(ppuVar4 + 6) &&
           (ppuVar4 = FUN_180025ab4(), param_2 != (FILE *)(ppuVar4 + 0xc))) ||
          (iVar1 = _isatty(_FileHandle), iVar1 == 0)))) {
        _getbuf(param_2);
      }
      if ((param_2->_flag & 0x108U) == 0) {
        uVar7 = 1;
        uVar2 = FUN_180025c50(_FileHandle,(wint_t *)local_res8,1);
      }
      else {
        uVar7 = *(int *)&param_2->_ptr - *(int *)&param_2->_base;
        param_2->_ptr = (char *)((longlong)param_2->_base + 1);
        param_2->_cnt = param_2->_bufsiz + -1;
        if ((int)uVar7 < 1) {
          if (_FileHandle + 2 < 2) {
            puVar6 = &DAT_180049330;
          }
          else {
            puVar6 = (undefined *)
                     ((ulonglong)(_FileHandle & 0x1f) * 0x58 +
                     *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)_FileHandle >> 5) * 8)
                     );
          }
          if (((puVar6[8] & 0x20) != 0) && (lVar5 = FUN_180026528(_FileHandle,0,2), lVar5 == -1))
          goto LAB_18001ff7c;
        }
        else {
          uVar2 = FUN_180025c50(_FileHandle,(wint_t *)param_2->_base,uVar7);
        }
        *param_2->_base = (byte)local_res8[0];
      }
      if (uVar2 == uVar7) {
        return (ulonglong)(byte)local_res8[0];
      }
    }
    else {
      piVar3 = _errno();
      *piVar3 = 0x22;
    }
  }
LAB_18001ff7c:
  param_2->_flag = param_2->_flag | 0x20;
  return 0xffffffff;
}



// Library Function - Single Match
//  public: __cdecl _LocaleUpdate::_LocaleUpdate(struct localeinfo_struct * __ptr64) __ptr64
// 
// Library: Visual Studio 2012 Release

_LocaleUpdate * __thiscall
_LocaleUpdate::_LocaleUpdate(_LocaleUpdate *this,localeinfo_struct *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  _ptiddata p_Var5;
  pthreadlocinfo ptVar6;
  pthreadmbcinfo ptVar7;
  
  this[0x18] = (_LocaleUpdate)0x0;
  if (param_1 == (localeinfo_struct *)0x0) {
    p_Var5 = _getptd();
    *(_ptiddata *)(this + 0x10) = p_Var5;
    ptVar6 = p_Var5->ptlocinfo;
    *(pthreadlocinfo *)this = ptVar6;
    *(pthreadmbcinfo *)(this + 8) = p_Var5->ptmbcinfo;
    if ((ptVar6 != (pthreadlocinfo)PTR_DAT_18004a1f0) && ((DAT_18004a358 & p_Var5->_ownlocale) == 0)
       ) {
      ptVar6 = __updatetlocinfo();
      *(pthreadlocinfo *)this = ptVar6;
    }
    if ((*(undefined **)(this + 8) != PTR_DAT_180049b50) &&
       ((DAT_18004a358 & *(uint *)(*(longlong *)(this + 0x10) + 200)) == 0)) {
      ptVar7 = __updatetmbcinfo();
      *(pthreadmbcinfo *)(this + 8) = ptVar7;
    }
    uVar1 = *(uint *)(*(longlong *)(this + 0x10) + 200);
    if ((uVar1 & 2) == 0) {
      *(uint *)(*(longlong *)(this + 0x10) + 200) = uVar1 | 2;
      this[0x18] = (_LocaleUpdate)0x1;
    }
  }
  else {
    uVar2 = *(undefined4 *)((longlong)&param_1->locinfo + 4);
    uVar3 = *(undefined4 *)&param_1->mbcinfo;
    uVar4 = *(undefined4 *)((longlong)&param_1->mbcinfo + 4);
    *(undefined4 *)this = *(undefined4 *)&param_1->locinfo;
    *(undefined4 *)(this + 4) = uVar2;
    *(undefined4 *)(this + 8) = uVar3;
    *(undefined4 *)(this + 0xc) = uVar4;
  }
  return this;
}



// WARNING: Removing unreachable block (ram,0x0001800205e7)
// WARNING: Removing unreachable block (ram,0x0001800205c7)
// WARNING: Removing unreachable block (ram,0x000180020740)
// WARNING: Removing unreachable block (ram,0x000180020744)
// WARNING: Removing unreachable block (ram,0x00018002074d)

void FUN_180020178(FILE *param_1,ushort *param_2,localeinfo_struct *param_3,uint **param_4)

{
  ushort uVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  undefined *puVar9;
  bool bVar10;
  char cVar11;
  int iVar12;
  int *piVar13;
  undefined7 extraout_var;
  code *pcVar14;
  size_t sVar15;
  ulonglong uVar16;
  uint *puVar17;
  uint uVar18;
  FILE *pFVar19;
  uint *puVar20;
  ushort *puVar21;
  ulonglong uVar22;
  uint uVar23;
  ulonglong uVar24;
  uint uVar25;
  ushort uVar26;
  int iVar27;
  undefined4 local_4f0;
  localeinfo_struct *local_4e8;
  uint local_4d8;
  uint local_4d4;
  uint local_4d0;
  uint **local_4c8;
  int local_4c0;
  int local_4bc;
  wint_t local_4b8 [2];
  wint_t local_4b4 [2];
  char local_4b0;
  undefined local_4af;
  uint local_4ac;
  int local_4a8;
  undefined4 local_4a4;
  undefined4 local_4a0;
  FILE *local_498;
  ushort *local_490;
  localeinfo_struct local_488;
  longlong local_478;
  char local_470;
  uint *local_468;
  int *local_460;
  uint *local_458 [2];
  wint_t local_448;
  uint local_249 [128];
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffae8;
  local_4a0 = 0;
  uVar25 = 0;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar5 = false;
  bVar4 = false;
  bVar3 = false;
  bVar2 = false;
  local_4bc = 0;
  uVar18 = 0;
  local_4d4 = 0;
  local_4d0 = 0;
  local_4a4 = 0;
  local_4a8 = 0;
  puVar17 = (uint *)0x0;
  local_4c0 = 0;
  local_4c8 = param_4;
  local_498 = param_1;
  local_490 = param_2;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_488,param_3);
  local_460 = _errno();
  uVar16 = 0;
  if ((param_1 == (FILE *)0x0) || (local_490 == (ushort *)0x0)) {
    piVar13 = _errno();
    *piVar13 = 0x16;
    FUN_18001fee8();
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
  else {
    uVar26 = *local_490;
    local_468 = (uint *)0x0;
    local_4d8 = 0;
    puVar21 = local_490;
    uVar22 = uVar16;
    uVar24 = uVar16;
    if (uVar26 != 0) {
      do {
        puVar9 = PTR_s__null__180049310;
        iVar12 = (int)uVar22;
        local_490 = puVar21 + 1;
        if ((int)uVar16 < 0) break;
        uVar23 = 0;
        if ((ushort)(uVar26 - 0x20) < 0x59) {
          uVar23 = (byte)(&DAT_180032550)[uVar26] & 0xf;
        }
        local_4ac = (uint)((byte)(&DAT_180032570)[(longlong)(int)uVar23 * 9 + (longlong)iVar12] >> 4
                          );
        uVar22 = (ulonglong)local_4ac;
        if (local_4ac == 8) goto LAB_180020c38;
        if (local_4ac == 0) {
LAB_180020afc:
          local_4c0 = 1;
          write_char(uVar26,local_498,(int *)&local_4d8);
          uVar16 = (ulonglong)local_4d8;
LAB_1800209ed:
          uVar22 = (ulonglong)local_4ac;
          puVar21 = local_490;
        }
        else {
          if (local_4ac == 1) {
            local_4a4 = 0;
            local_4a8 = 0;
            local_4bc = 0;
            local_4d0 = 0;
            uVar25 = 0;
            bVar8 = false;
            bVar7 = false;
            bVar6 = false;
            bVar5 = false;
            bVar4 = false;
            bVar3 = false;
            bVar2 = false;
            uVar18 = 0xffffffff;
            local_4d4 = 0xffffffff;
            local_4c0 = 0;
            puVar21 = local_490;
          }
          else {
            if (local_4ac == 2) {
              if (uVar26 == 0x20) {
                bVar8 = true;
                puVar21 = local_490;
              }
              else {
                if (uVar26 == 0x23) {
                  bVar7 = true;
                  puVar21 = local_490;
                }
                else {
                  if (uVar26 == 0x2b) {
                    bVar4 = true;
                    puVar21 = local_490;
                  }
                  else {
                    if (uVar26 == 0x2d) {
                      uVar25 = uVar25 | 4;
                      puVar21 = local_490;
                    }
                    else {
                      puVar21 = local_490;
                      if (uVar26 == 0x30) {
                        uVar25 = uVar25 | 8;
                      }
                    }
                  }
                }
              }
            }
            else {
              if (local_4ac == 3) {
                if (uVar26 == 0x2a) {
                  local_4bc = *(int *)param_4;
                  param_4 = param_4 + 1;
                  puVar21 = local_490;
                  local_4c8 = param_4;
                  if (local_4bc < 0) {
                    uVar25 = uVar25 | 4;
                    local_4bc = -local_4bc;
                  }
                }
                else {
                  local_4bc = (uint)uVar26 + local_4bc * 10 + -0x30;
                  puVar21 = local_490;
                }
              }
              else {
                if (local_4ac == 4) {
                  local_4d4 = 0;
                  puVar21 = local_490;
                  uVar18 = 0;
                }
                else {
                  if (local_4ac == 5) {
                    if (uVar26 == 0x2a) {
                      local_4d4 = *(uint *)param_4;
                      param_4 = param_4 + 1;
                      puVar21 = local_490;
                      uVar18 = local_4d4;
                      local_4c8 = param_4;
                      if ((int)local_4d4 < 0) {
                        local_4d4 = 0xffffffff;
                        uVar18 = 0xffffffff;
                      }
                    }
                    else {
                      local_4d4 = (uint)uVar26 + (uVar18 * 5 + -0x18) * 2;
                      puVar21 = local_490;
                      uVar18 = local_4d4;
                    }
                  }
                  else {
                    if (local_4ac == 6) {
                      if (uVar26 == 0x49) {
                        uVar1 = *local_490;
                        bVar6 = true;
                        if ((uVar1 == 0x36) && (puVar21[2] == 0x34)) {
                          bVar6 = true;
                          puVar21 = puVar21 + 3;
                        }
                        else {
                          if ((uVar1 == 0x33) && (puVar21[2] == 0x32)) {
                            bVar6 = false;
                            puVar21 = puVar21 + 3;
                          }
                          else {
                            if ((0x20 < (ushort)(uVar1 - 0x58)) ||
                               (puVar21 = local_490,
                               (0x120821001U >> ((ulonglong)(ushort)(uVar1 - 0x58) & 0x3f) & 1) == 0
                               )) {
                              local_4ac = 0;
                              goto LAB_180020afc;
                            }
                          }
                        }
                      }
                      else {
                        if (uVar26 == 0x68) {
                          uVar25 = uVar25 | 0x20;
                          puVar21 = local_490;
                        }
                        else {
                          if (uVar26 == 0x6c) {
                            if (*local_490 == 0x6c) {
                              bVar3 = true;
                              puVar21 = puVar21 + 2;
                            }
                            else {
                              uVar25 = uVar25 | 0x10;
                              puVar21 = local_490;
                            }
                          }
                          else {
                            puVar21 = local_490;
                            if (uVar26 == 0x77) {
                              uVar25 = uVar25 | 0x800;
                            }
                          }
                        }
                      }
                    }
                    else {
                      puVar21 = local_490;
                      if (local_4ac == 7) {
                        if (uVar26 < 0x65) {
                          if (uVar26 == 100) {
LAB_180020633:
                            bVar5 = true;
LAB_180020637:
                            iVar12 = 10;
LAB_18002064c:
                            if ((bVar6) || (bVar3)) {
                              puVar17 = *param_4;
                            }
                            else {
                              if ((uVar25 & 0x20) == 0) {
                                if (bVar5) {
                                  puVar17 = (uint *)(longlong)*(int *)param_4;
                                }
                                else {
                                  puVar17 = (uint *)(ulonglong)*(uint *)param_4;
                                }
                              }
                              else {
                                if (bVar5) {
                                  puVar17 = (uint *)(longlong)*(short *)param_4;
                                }
                                else {
                                  puVar17 = (uint *)(ulonglong)*(ushort *)param_4;
                                }
                              }
                            }
                            local_4c8 = param_4 + 1;
                            if ((bVar5) && ((longlong)puVar17 < 0)) {
                              puVar17 = (uint *)-(longlong)puVar17;
                              bVar2 = true;
                            }
                            if ((!bVar6) && (!bVar3)) {
                              puVar17 = (uint *)((ulonglong)puVar17 & 0xffffffff);
                            }
                            if ((int)uVar18 < 0) {
                              uVar18 = 1;
                            }
                            else {
                              uVar25 = uVar25 & 0xfffffff7;
                              if (0x200 < (int)uVar18) {
                                uVar18 = 0x200;
                              }
                            }
                            puVar20 = local_249;
                            local_4d0 = -(uint)(puVar17 != (uint *)0x0) & local_4d0;
                            while ((local_4d4 = uVar18 - 1, 0 < (int)uVar18 ||
                                   (puVar17 != (uint *)0x0))) {
                              uVar18 = (int)((ulonglong)puVar17 % (ulonglong)(longlong)iVar12) +
                                       0x30;
                              cVar11 = (char)uVar18;
                              if (0x39 < uVar18) {
                                cVar11 = cVar11 + (char)local_4a0;
                              }
                              *(char *)puVar20 = cVar11;
                              puVar20 = (uint *)((longlong)puVar20 + -1);
                              puVar17 = (uint *)((ulonglong)puVar17 / (ulonglong)(longlong)iVar12);
                              uVar18 = local_4d4;
                            }
                            puVar17 = (uint *)((longlong)puVar20 + 1);
                            uVar24 = (ulonglong)
                                     (uint)(((int)register0x00000020 + -0x249) - (int)puVar20);
                            param_4 = local_4c8;
                          }
                          else {
                            if (uVar26 == 0x41) {
LAB_1800204e5:
                              local_4a4 = 1;
                              uVar26 = uVar26 + 0x20;
                              goto LAB_1800204f6;
                            }
                            if (uVar26 == 0x43) {
                              if ((uVar25 & 0x830) == 0) {
                                uVar25 = uVar25 | 0x20;
                              }
LAB_18002047b:
                              local_4b4[0] = *(wint_t *)param_4;
                              param_4 = param_4 + 1;
                              local_4c0 = 1;
                              local_4c8 = param_4;
                              if ((uVar25 & 0x20) == 0) {
                                local_448 = local_4b4[0];
                              }
                              else {
                                local_4b0 = (char)local_4b4[0];
                                local_4af = 0;
                                iVar12 = _mbtowc_l((wchar_t *)&local_448,&local_4b0,
                                                   (longlong)(local_488.locinfo)->mb_cur_max,
                                                   (_locale_t)&local_488);
                                if (iVar12 < 0) {
                                  local_4a8 = 1;
                                }
                              }
                              uVar24 = 1;
                              puVar17 = (uint *)&local_448;
                            }
                            else {
                              if ((uVar26 - 0x45 & 0xfffffffd) == 0) goto LAB_1800204e5;
                              if (uVar26 == 0x53) {
                                if ((uVar25 & 0x830) == 0) {
                                  uVar25 = uVar25 | 0x20;
                                }
LAB_180020405:
                                puVar20 = *param_4;
                                if (local_4d4 == 0xffffffff) {
                                  uVar18 = 0x7fffffff;
                                }
                                param_4 = param_4 + 1;
                                puVar17 = puVar20;
                                local_4c8 = param_4;
                                if ((uVar25 & 0x20) == 0) {
                                  local_4c0 = 1;
                                  if (puVar20 == (uint *)0x0) {
                                    puVar20 = (uint *)PTR_u__null__180049318;
                                    puVar17 = (uint *)PTR_u__null__180049318;
                                  }
                                  for (; (uVar18 != 0 &&
                                         (uVar18 = uVar18 - 1, *(wint_t *)puVar20 != 0));
                                      puVar20 = (uint *)((longlong)puVar20 + 2)) {
                                  }
                                  uVar24 = (longlong)((longlong)puVar20 - (longlong)puVar17) >> 1 &
                                           0xffffffff;
                                }
                                else {
                                  uVar24 = 0;
                                  if (puVar20 == (uint *)0x0) {
                                    puVar17 = (uint *)PTR_s__null__180049310;
                                  }
                                  puVar20 = puVar17;
                                  uVar16 = 0;
                                  if (0 < (int)uVar18) {
                                    do {
                                      uVar24 = uVar16;
                                      if (*(byte *)puVar20 == 0) break;
                                      iVar12 = _isleadbyte_l((uint)*(byte *)puVar20,
                                                             (_locale_t)&local_488);
                                      if (iVar12 != 0) {
                                        puVar20 = (uint *)((longlong)puVar20 + 1);
                                      }
                                      uVar23 = (int)uVar24 + 1;
                                      uVar24 = (ulonglong)uVar23;
                                      puVar20 = (uint *)((longlong)puVar20 + 1);
                                      uVar16 = uVar24;
                                    } while ((int)uVar23 < (int)uVar18);
                                  }
                                }
                              }
                              else {
                                if (uVar26 == 0x58) goto LAB_1800205a6;
                                if (uVar26 == 0x5a) {
                                  puVar20 = *param_4;
                                  param_4 = param_4 + 1;
                                  local_4c8 = param_4;
                                  if ((puVar20 == (uint *)0x0) ||
                                     (puVar17 = *(uint **)(puVar20 + 2), puVar17 == (uint *)0x0)) {
                                    uVar24 = strlen(PTR_s__null__180049310);
                                    puVar17 = (uint *)puVar9;
                                  }
                                  else {
                                    if (uVar25 >> 0xb == 0) {
                                      uVar24 = (ulonglong)(uint)(int)(short)*(wint_t *)puVar20;
                                      local_4c0 = 0;
                                    }
                                    else {
                                      local_4c0 = 1;
                                      uVar24 = (ulonglong)(uint)((int)(short)*(wint_t *)puVar20 / 2)
                                      ;
                                    }
                                  }
                                }
                                else {
                                  if (uVar26 == 0x61) goto LAB_1800204f6;
                                  if (uVar26 == 99) goto LAB_18002047b;
                                }
                              }
                            }
                          }
LAB_180020365:
                          pFVar19 = local_498;
                          if (local_4a8 == 0) {
                            if (bVar5) {
                              if (bVar2) {
                                local_4b8[0] = 0x2d;
                              }
                              else {
                                if (!bVar4) {
                                  if (bVar8) {
                                    local_4b8[0] = 0x20;
                                    local_4d0 = 1;
                                  }
                                  goto LAB_18002089d;
                                }
                                local_4b8[0] = 0x2b;
                              }
                              local_4d0 = 1;
                            }
LAB_18002089d:
                            uVar18 = local_4d0;
                            iVar12 = (int)uVar24;
                            iVar27 = (local_4bc - iVar12) - local_4d0;
                            if ((uVar25 & 0xc) == 0) {
                              write_multi_char(0x20,iVar27,local_498,(int *)&local_4d8);
                            }
                            write_string(local_4b8,uVar18,pFVar19,(int *)&local_4d8,local_460);
                            if (((uVar25 & 8) != 0) && ((uVar25 & 4) == 0)) {
                              write_multi_char(0x30,iVar27,pFVar19,(int *)&local_4d8);
                            }
                            if ((local_4c0 == 0) && (0 < iVar12)) {
                              uVar16 = uVar24 & 0xffffffff;
                              puVar20 = puVar17;
                              do {
                                uVar18 = (int)uVar16 - 1;
                                uVar16 = (ulonglong)uVar18;
                                iVar12 = _mbtowc_l((wchar_t *)local_4b4,(char *)puVar20,
                                                   (longlong)(local_488.locinfo)->mb_cur_max,
                                                   (_locale_t)&local_488);
                                if (iVar12 < 1) {
                                  uVar16 = 0xffffffff;
                                  local_4d8 = 0xffffffff;
                                  pFVar19 = local_498;
                                  param_4 = local_4c8;
                                  goto LAB_18002099a;
                                }
                                write_char(local_4b4[0],local_498,(int *)&local_4d8);
                                puVar20 = (uint *)((longlong)puVar20 + (longlong)iVar12);
                                pFVar19 = local_498;
                                param_4 = local_4c8;
                              } while (0 < (int)uVar18);
                            }
                            else {
                              write_string((wint_t *)puVar17,iVar12,pFVar19,(int *)&local_4d8,
                                           local_460);
                            }
                            uVar16 = (ulonglong)local_4d8;
LAB_18002099a:
                            if (((int)uVar16 < 0) || ((uVar25 & 4) == 0)) goto LAB_1800209c6;
                            write_multi_char(0x20,iVar27,pFVar19,(int *)&local_4d8);
                          }
                          uVar16 = (ulonglong)local_4d8;
                        }
                        else {
                          if (uVar26 < 0x68) {
LAB_1800204f6:
                            puVar17 = (uint *)&local_448;
                            if ((int)uVar18 < 0) {
                              uVar23 = 6;
LAB_180020513:
                              puVar17 = (uint *)&local_448;
                              iVar12 = 0x200;
                              local_4d4 = uVar23;
                            }
                            else {
                              if (uVar18 == 0) {
                                iVar12 = 0x200;
                                if (uVar26 == 0x67) {
                                  uVar23 = 1;
                                  goto LAB_180020513;
                                }
                              }
                              else {
                                uVar23 = 0xa3;
                                if (0x200 < (int)uVar18) {
                                  uVar18 = 0x200;
                                }
                                iVar12 = 0x200;
                                local_4d4 = uVar18;
                                if (0xa3 < (int)uVar18) {
                                  iVar12 = uVar18 + 0x15d;
                                  puVar17 = (uint *)FUN_18001f5e8((longlong)iVar12);
                                  local_468 = puVar17;
                                  if (puVar17 == (uint *)0x0) goto LAB_180020513;
                                }
                              }
                            }
                            uVar18 = local_4d4;
                            local_458[0] = *param_4;
                            local_4c8 = param_4 + 1;
                            pcVar14 = (code *)DecodePointer(PTR_LAB_180049600);
                            local_4e8 = &local_488;
                            local_4f0 = local_4a4;
                            (*pcVar14)(local_458,puVar17,(longlong)iVar12);
                            if ((bVar7) && (uVar18 == 0)) {
                              pcVar14 = (code *)DecodePointer(PTR_LAB_180049618);
                              (*pcVar14)(puVar17);
                            }
                            if ((uVar26 == 0x67) && (!bVar7)) {
                              pcVar14 = (code *)DecodePointer(PTR_LAB_180049610);
                              (*pcVar14)(puVar17);
                            }
                            if (*(char *)puVar17 == '-') {
                              bVar2 = true;
                              puVar17 = (uint *)((longlong)puVar17 + 1);
                            }
                            bVar5 = true;
                            sVar15 = strlen((char *)puVar17);
                            uVar24 = sVar15 & 0xffffffff;
                            param_4 = param_4 + 1;
                            goto LAB_180020365;
                          }
                          if (uVar26 == 0x69) goto LAB_180020633;
                          if (uVar26 != 0x6e) {
                            if (uVar26 == 0x6f) {
                              iVar12 = 8;
                            }
                            else {
                              if (uVar26 == 0x70) {
                                uVar18 = 0x10;
                                bVar6 = true;
LAB_1800205a6:
                                local_4a0 = 7;
                              }
                              else {
                                if (uVar26 == 0x73) goto LAB_180020405;
                                if (uVar26 == 0x75) goto LAB_180020637;
                                if (uVar26 != 0x78) goto LAB_180020365;
                                local_4a0 = 0x27;
                              }
                              iVar12 = 0x10;
                            }
                            goto LAB_18002064c;
                          }
                          puVar20 = *param_4;
                          param_4 = param_4 + 1;
                          local_4c8 = param_4;
                          bVar10 = FUN_180026b28();
                          if ((int)CONCAT71(extraout_var,bVar10) == 0) goto LAB_180020c38;
                          if ((uVar25 & 0x20) == 0) {
                            *puVar20 = local_4d8;
                          }
                          else {
                            *(wint_t *)puVar20 = (wint_t)local_4d8;
                          }
                          uVar16 = (ulonglong)local_4d8;
                          local_4a8 = 1;
                        }
LAB_1800209c6:
                        uVar18 = local_4d4;
                        if (local_468 != (uint *)0x0) {
                          free(local_468);
                          uVar16 = (ulonglong)local_4d8;
                          local_468 = (uint *)0x0;
                          uVar18 = local_4d4;
                        }
                        goto LAB_1800209ed;
                      }
                    }
                  }
                }
              }
            }
          }
        }
        iVar12 = (int)uVar22;
        uVar26 = *puVar21;
      } while (uVar26 != 0);
      if ((iVar12 != 0) && (iVar12 != 7)) {
LAB_180020c38:
        piVar13 = _errno();
        *piVar13 = 0x16;
        FUN_18001fee8();
        if (local_470 != '\0') {
          *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
        }
        goto LAB_180020a26;
      }
    }
    if (local_470 != '\0') {
      *(uint *)(local_478 + 200) = *(uint *)(local_478 + 200) & 0xfffffffd;
    }
  }
LAB_180020a26:
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xfffffffffffffae8);
  return;
}



// Library Function - Single Match
//  write_char
// 
// Library: Visual Studio 2012 Release

void write_char(wint_t param_1,FILE *param_2,int *param_3)

{
  short sVar1;
  
  if (((*(byte *)&param_2->_flag & 0x40) == 0) || (param_2->_base != (char *)0x0)) {
    sVar1 = FUN_180026b40(param_1,param_2);
    if (sVar1 == -1) {
      *param_3 = -1;
    }
    else {
      *param_3 = *param_3 + 1;
    }
  }
  else {
    *param_3 = *param_3 + 1;
  }
  return;
}



// Library Function - Single Match
//  write_multi_char
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

void write_multi_char(wint_t param_1,int param_2,FILE *param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      write_char(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



// Library Function - Single Match
//  write_string
// 
// Library: Visual Studio 2012 Release

void write_string(wint_t *param_1,int param_2,FILE *param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  iVar1 = *param_5;
  if (((*(byte *)&param_3->_flag & 0x40) == 0) || (param_3->_base != (char *)0x0)) {
    *param_5 = 0;
    if (0 < param_2) {
      do {
        param_2 = param_2 + -1;
        write_char(*param_1,param_3,param_4);
        param_1 = param_1 + 1;
        if (*param_4 == -1) {
          if (*param_5 != 0x2a) break;
          write_char(0x3f,param_3,param_4);
        }
      } while (0 < param_2);
      if (*param_5 != 0) {
        return;
      }
    }
    *param_5 = iVar1;
  }
  else {
    *param_4 = *param_4 + param_2;
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x0001800211a2)
// WARNING: Removing unreachable block (ram,0x000180021186)
// WARNING: Removing unreachable block (ram,0x0001800212db)
// WARNING: Removing unreachable block (ram,0x0001800212df)
// WARNING: Removing unreachable block (ram,0x0001800212e8)

void FUN_180020d8c(FILE *param_1,byte *param_2,localeinfo_struct *param_3,uint **param_4)

{
  byte bVar1;
  uint *puVar2;
  bool bVar3;
  bool bVar4;
  bool bVar5;
  bool bVar6;
  bool bVar7;
  bool bVar8;
  bool bVar9;
  bool bVar10;
  char cVar11;
  uint uVar12;
  errno_t eVar13;
  undefined7 extraout_var;
  code *pcVar14;
  size_t sVar15;
  int *piVar16;
  uint uVar17;
  int iVar18;
  uint *puVar19;
  uint uVar20;
  undefined4 *puVar21;
  int iVar22;
  byte *pbVar23;
  undefined *puVar24;
  uint *puVar25;
  undefined *puVar26;
  uint uVar27;
  uint uVar28;
  byte bVar29;
  FILE *pFVar30;
  undefined4 local_2f0;
  localeinfo_struct *local_2e8;
  uint local_2d8;
  int local_2d4;
  uint local_2d0;
  byte local_2cc [4];
  int local_2c8;
  int local_2c4;
  int local_2c0;
  uint local_2bc;
  undefined4 local_2b8;
  FILE *local_2b0;
  undefined4 local_2a8;
  uint **local_2a0;
  int *local_298;
  uint *local_290;
  int local_288 [2];
  byte *local_280;
  uint *local_278;
  localeinfo_struct local_270;
  longlong local_260;
  char local_258;
  undefined local_248;
  undefined4 local_49;
  ulonglong local_40;
  
  local_40 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffce8;
  local_2a8 = 0;
  uVar28 = 0;
  bVar9 = false;
  bVar8 = false;
  bVar7 = false;
  bVar6 = false;
  bVar5 = false;
  bVar3 = false;
  bVar4 = false;
  local_2c4 = 0;
  uVar27 = 0;
  local_2d0 = 0;
  local_2b8 = 0;
  local_2c0 = 0;
  puVar25 = (uint *)0x0;
  local_2c8 = 0;
  local_2b0 = param_1;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_270,param_3);
  local_298 = _errno();
  if (param_1 != (FILE *)0x0) {
    if ((*(byte *)&param_1->_flag & 0x40) == 0) {
      uVar12 = _fileno(param_1);
      puVar24 = &DAT_180049330;
      if (uVar12 + 2 < 2) {
        puVar26 = &DAT_180049330;
      }
      else {
        puVar26 = (undefined *)
                  ((ulonglong)(uVar12 & 0x1f) * 0x58 +
                  *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)uVar12 >> 5) * 8));
      }
      if ((puVar26[0x38] & 0x7f) == 0) {
        if (1 < uVar12 + 2) {
          puVar24 = (undefined *)
                    ((ulonglong)(uVar12 & 0x1f) * 0x58 +
                    *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)uVar12 >> 5) * 8));
        }
        if ((puVar24[0x38] & 0x80) == 0) goto LAB_180020ea8;
      }
    }
    else {
LAB_180020ea8:
      uVar12 = 0;
      if (param_2 != (byte *)0x0) {
        bVar29 = *param_2;
        local_2d8 = 0;
        local_2d4 = 0;
        local_290 = (uint *)0x0;
        uVar20 = uVar12;
        if (bVar29 == 0) goto LAB_180021776;
        do {
          pbVar23 = param_2 + 1;
          local_280 = pbVar23;
          if ((int)uVar12 < 0) break;
          uVar17 = 0;
          if ((byte)(bVar29 - 0x20) < 0x59) {
            uVar17 = (byte)(&DAT_180032550)[(char)bVar29] & 0xf;
          }
          local_2bc = (uint)((byte)(&DAT_180032570)
                                   [(longlong)(int)uVar17 * 9 + (longlong)(int)uVar20] >> 4);
          if (local_2bc == 8) goto LAB_18002175c;
          uVar20 = uVar27;
          if (local_2bc == 0) {
LAB_180021615:
            local_2c8 = 0;
            iVar18 = _isleadbyte_l((uint)bVar29,(_locale_t)&local_270);
            if (iVar18 != 0) {
              write_char(bVar29,local_2b0,(int *)&local_2d8);
              bVar29 = *pbVar23;
              pbVar23 = param_2 + 2;
              if (bVar29 == 0) goto LAB_18002175c;
            }
            write_char(bVar29,local_2b0,(int *)&local_2d8);
            uVar20 = uVar27;
            uVar12 = local_2d8;
          }
          else {
            if (local_2bc == 1) {
              local_2b8 = 0;
              local_2c0 = 0;
              local_2c4 = 0;
              local_2d0 = 0;
              uVar28 = 0;
              bVar9 = false;
              bVar8 = false;
              bVar7 = false;
              bVar6 = false;
              bVar5 = false;
              bVar3 = false;
              bVar4 = false;
              local_2c8 = 0;
              uVar20 = 0xffffffff;
            }
            else {
              if (local_2bc == 2) {
                if (bVar29 == 0x20) {
                  bVar9 = true;
                }
                else {
                  if (bVar29 == 0x23) {
                    bVar8 = true;
                  }
                  else {
                    if (bVar29 == 0x2b) {
                      bVar5 = true;
                    }
                    else {
                      if (bVar29 == 0x2d) {
                        uVar28 = uVar28 | 4;
                      }
                      else {
                        if (bVar29 == 0x30) {
                          uVar28 = uVar28 | 8;
                        }
                      }
                    }
                  }
                }
              }
              else {
                if (local_2bc == 3) {
                  if (bVar29 == 0x2a) {
                    local_2c4 = *(int *)param_4;
                    param_4 = param_4 + 1;
                    if (local_2c4 < 0) {
                      uVar28 = uVar28 | 4;
                      local_2c4 = -local_2c4;
                    }
                  }
                  else {
                    local_2c4 = (int)(char)bVar29 + local_2c4 * 10 + -0x30;
                  }
                }
                else {
                  uVar20 = 0;
                  if (local_2bc != 4) {
                    if (local_2bc == 5) {
                      if (bVar29 == 0x2a) {
                        uVar20 = *(uint *)param_4;
                        param_4 = param_4 + 1;
                        if ((int)uVar20 < 0) {
                          uVar20 = 0xffffffff;
                        }
                      }
                      else {
                        uVar20 = (int)(char)bVar29 + (uVar27 * 5 + -0x18) * 2;
                      }
                    }
                    else {
                      if (local_2bc == 6) {
                        if (bVar29 == 0x49) {
                          bVar1 = *pbVar23;
                          bVar6 = true;
                          if ((bVar1 == 0x36) && (param_2[2] == 0x34)) {
                            bVar6 = true;
                            pbVar23 = param_2 + 3;
                            uVar20 = uVar27;
                          }
                          else {
                            if ((bVar1 == 0x33) && (param_2[2] == 0x32)) {
                              bVar6 = false;
                              pbVar23 = param_2 + 3;
                              uVar20 = uVar27;
                            }
                            else {
                              if ((0x20 < (byte)(bVar1 + 0xa8)) ||
                                 (uVar20 = uVar27,
                                 (0x120821001U >> ((ulonglong)(byte)(bVar1 + 0xa8) & 0x3f) & 1) == 0
                                 )) {
                                local_2bc = 0;
                                goto LAB_180021615;
                              }
                            }
                          }
                        }
                        else {
                          if (bVar29 == 0x68) {
                            uVar28 = uVar28 | 0x20;
                            uVar20 = uVar27;
                          }
                          else {
                            if (bVar29 == 0x6c) {
                              if (*pbVar23 == 0x6c) {
                                bVar4 = true;
                                pbVar23 = param_2 + 2;
                                uVar20 = uVar27;
                              }
                              else {
                                uVar28 = uVar28 | 0x10;
                                uVar20 = uVar27;
                              }
                            }
                            else {
                              uVar20 = uVar27;
                              if (bVar29 == 0x77) {
                                uVar28 = uVar28 | 0x800;
                              }
                            }
                          }
                        }
                      }
                      else {
                        uVar20 = uVar27;
                        if (local_2bc == 7) {
                          iVar18 = (int)(char)bVar29;
                          if (iVar18 < 0x65) {
                            if (iVar18 == 100) {
LAB_1800211d9:
                              bVar7 = true;
LAB_1800211dd:
                              iVar18 = 10;
LAB_1800211e7:
                              if ((bVar6) || (bVar4)) {
                                puVar25 = *param_4;
                              }
                              else {
                                if ((uVar28 & 0x20) == 0) {
                                  if (bVar7) {
                                    puVar25 = (uint *)(longlong)*(int *)param_4;
                                  }
                                  else {
                                    puVar25 = (uint *)(ulonglong)*(uint *)param_4;
                                  }
                                }
                                else {
                                  if (bVar7) {
                                    puVar25 = (uint *)(longlong)*(short *)param_4;
                                  }
                                  else {
                                    puVar25 = (uint *)(ulonglong)*(ushort *)param_4;
                                  }
                                }
                              }
                              local_2a0 = param_4 + 1;
                              if ((bVar7) && ((longlong)puVar25 < 0)) {
                                puVar25 = (uint *)-(longlong)puVar25;
                                bVar3 = true;
                              }
                              if ((!bVar6) && (!bVar4)) {
                                puVar25 = (uint *)((ulonglong)puVar25 & 0xffffffff);
                              }
                              if ((int)uVar27 < 0) {
                                uVar27 = 1;
                              }
                              else {
                                uVar28 = uVar28 & 0xfffffff7;
                                if (0x200 < (int)uVar27) {
                                  uVar27 = 0x200;
                                }
                              }
                              puVar21 = &local_49;
                              local_2d0 = -(uint)(puVar25 != (uint *)0x0) & local_2d0;
                              uVar12 = uVar27;
                              while ((uVar27 = uVar12 - 1, 0 < (int)uVar12 ||
                                     (puVar25 != (uint *)0x0))) {
                                uVar12 = (int)((ulonglong)puVar25 % (ulonglong)(longlong)iVar18) +
                                         0x30;
                                cVar11 = (char)uVar12;
                                if (0x39 < uVar12) {
                                  cVar11 = cVar11 + (char)local_2a8;
                                }
                                *(char *)puVar21 = cVar11;
                                puVar21 = (undefined4 *)((longlong)puVar21 + -1);
                                puVar25 = (uint *)((ulonglong)puVar25 / (ulonglong)(longlong)iVar18)
                                ;
                                uVar12 = uVar27;
                              }
                              local_2d4 = ((int)register0x00000020 + -0x49) - (int)puVar21;
                              puVar25 = (uint *)((longlong)puVar21 + 1);
                              param_4 = local_2a0;
                            }
                            else {
                              if (iVar18 == 0x41) {
LAB_1800210b6:
                                local_2b8 = 1;
                                bVar29 = bVar29 + 0x20;
                                goto LAB_1800210c2;
                              }
                              if (iVar18 != 0x43) {
                                if ((iVar18 - 0x45U & 0xfffffffd) == 0) goto LAB_1800210b6;
                                if (iVar18 == 0x53) {
                                  if ((uVar28 & 0x830) == 0) {
                                    uVar28 = uVar28 | 0x800;
                                  }
LAB_18002101e:
                                  puVar19 = *param_4;
                                  uVar12 = uVar27;
                                  if (uVar27 == 0xffffffff) {
                                    uVar12 = 0x7fffffff;
                                  }
                                  param_4 = param_4 + 1;
                                  puVar25 = puVar19;
                                  if ((uVar28 & 0x810) == 0) {
                                    if (puVar19 == (uint *)0x0) {
                                      puVar19 = (uint *)PTR_s__null__180049310;
                                      puVar25 = (uint *)PTR_s__null__180049310;
                                    }
                                    for (; (uVar12 != 0 &&
                                           (uVar12 = uVar12 - 1, *(char *)puVar19 != '\0'));
                                        puVar19 = (uint *)((longlong)puVar19 + 1)) {
                                    }
                                    local_2d4 = (int)puVar19 - (int)puVar25;
                                  }
                                  else {
                                    local_2c8 = 1;
                                    if (puVar19 == (uint *)0x0) {
                                      puVar19 = (uint *)PTR_u__null__180049318;
                                      puVar25 = (uint *)PTR_u__null__180049318;
                                    }
                                    for (; (uVar12 != 0 &&
                                           (uVar12 = uVar12 - 1, *(wchar_t *)puVar19 != L'\0'));
                                        puVar19 = (uint *)((longlong)puVar19 + 2)) {
                                    }
                                    local_2d4 = (int)((longlong)
                                                      ((longlong)puVar19 - (longlong)puVar25) >> 1);
                                  }
                                  goto LAB_1800213e4;
                                }
                                if (iVar18 == 0x58) goto LAB_180021172;
                                if (iVar18 != 0x5a) {
                                  if (iVar18 == 0x61) goto LAB_1800210c2;
                                  if (iVar18 != 99) goto LAB_1800213e4;
                                  goto LAB_18002106a;
                                }
                                puVar2 = *param_4;
                                puVar19 = (uint *)PTR_s__null__180049310;
                                if ((puVar2 == (uint *)0x0) ||
                                   (puVar25 = *(uint **)(puVar2 + 2), puVar25 == (uint *)0x0))
                                goto LAB_1800213d5;
                                local_2d4 = (int)*(wchar_t *)puVar2;
                                if (uVar28 >> 0xb == 0) {
                                  local_2c8 = 0;
                                }
                                else {
                                  local_2c8 = 1;
                                  local_2d4 = local_2d4 / 2;
                                }
                                goto LAB_1800213e0;
                              }
                              if ((uVar28 & 0x830) == 0) {
                                uVar28 = uVar28 | 0x800;
                              }
LAB_18002106a:
                              if ((uVar28 & 0x810) == 0) {
                                local_2d4 = 1;
                                local_248 = *(undefined *)param_4;
                              }
                              else {
                                eVar13 = wctomb_s(&local_2d4,&local_248,0x200,*(wchar_t *)param_4);
                                if (eVar13 != 0) {
                                  local_2c0 = 1;
                                }
                              }
                              puVar25 = (uint *)&local_248;
                              param_4 = param_4 + 1;
                            }
LAB_1800213e4:
                            pFVar30 = local_2b0;
                            if (local_2c0 == 0) {
                              if (bVar7) {
                                if (bVar3) {
                                  local_2cc[0] = 0x2d;
                                }
                                else {
                                  if (bVar5) {
                                    local_2cc[0] = 0x2b;
                                  }
                                  else {
                                    if (!bVar9) goto LAB_18002142a;
                                    local_2cc[0] = 0x20;
                                  }
                                }
                                local_2d0 = 1;
                              }
LAB_18002142a:
                              uVar12 = local_2d0;
                              iVar18 = (local_2c4 - local_2d4) - local_2d0;
                              if ((uVar28 & 0xc) == 0) {
                                write_multi_char(0x20,iVar18,local_2b0,(int *)&local_2d8);
                              }
                              write_string(local_2cc,uVar12,pFVar30,(int *)&local_2d8,local_298);
                              if (((uVar28 & 8) != 0) && ((uVar28 & 4) == 0)) {
                                write_multi_char(0x30,iVar18,pFVar30,(int *)&local_2d8);
                              }
                              if ((local_2c8 == 0) ||
                                 (puVar19 = puVar25, iVar22 = local_2d4, local_2d4 < 1)) {
                                write_string((byte *)puVar25,local_2d4,pFVar30,(int *)&local_2d8,
                                             local_298);
                              }
                              else {
                                do {
                                  iVar22 = iVar22 + -1;
                                  eVar13 = wctomb_s(local_288,(char *)((longlong)&local_49 + 1),6,
                                                    *(wchar_t *)puVar19);
                                  if ((eVar13 != 0) || (local_288[0] == 0)) {
                                    local_2d8 = 0xffffffff;
                                    pFVar30 = local_2b0;
                                    break;
                                  }
                                  write_string((byte *)((longlong)&local_49 + 1),local_288[0],
                                               local_2b0,(int *)&local_2d8,local_298);
                                  pFVar30 = local_2b0;
                                  puVar19 = (uint *)((longlong)puVar19 + 2);
                                } while (iVar22 != 0);
                              }
                              if ((-1 < (int)local_2d8) && ((uVar28 & 4) != 0)) {
                                write_multi_char(0x20,iVar18,pFVar30,(int *)&local_2d8);
                              }
                            }
                          }
                          else {
                            if (iVar18 < 0x68) {
LAB_1800210c2:
                              bVar7 = true;
                              iVar18 = 0x200;
                              puVar19 = (uint *)&local_248;
                              if ((int)uVar27 < 0) {
                                uVar27 = 6;
                                iVar22 = 0x200;
                              }
                              else {
                                iVar22 = iVar18;
                                if (uVar27 == 0) {
                                  if (bVar29 == 0x67) {
                                    uVar27 = 1;
                                  }
                                }
                                else {
                                  if (0x200 < (int)uVar27) {
                                    uVar27 = 0x200;
                                  }
                                  if (0xa3 < (int)uVar27) {
                                    iVar22 = uVar27 + 0x15d;
                                    local_290 = (uint *)FUN_18001f5e8((longlong)iVar22);
                                    puVar19 = local_290;
                                    if (local_290 == (uint *)0x0) {
                                      uVar27 = 0xa3;
                                      puVar19 = (uint *)&local_248;
                                      iVar22 = iVar18;
                                    }
                                  }
                                }
                              }
                              local_278 = *param_4;
                              pcVar14 = (code *)DecodePointer(PTR_LAB_180049600);
                              local_2e8 = &local_270;
                              local_2f0 = local_2b8;
                              (*pcVar14)(&local_278,puVar19,(longlong)iVar22,(int)(char)bVar29);
                              if ((bVar8) && (uVar27 == 0)) {
                                pcVar14 = (code *)DecodePointer(PTR_LAB_180049618);
                                (*pcVar14)(puVar19);
                              }
                              if ((bVar29 == 0x67) && (!bVar8)) {
                                pcVar14 = (code *)DecodePointer(PTR_LAB_180049610);
                                (*pcVar14)(puVar19);
                              }
                              if (*(char *)puVar19 == '-') {
                                bVar7 = true;
                                bVar3 = true;
                                puVar19 = (uint *)((longlong)puVar19 + 1);
                              }
LAB_1800213d5:
                              sVar15 = strlen((char *)puVar19);
                              local_2d4 = (int)sVar15;
                              puVar25 = puVar19;
LAB_1800213e0:
                              param_4 = param_4 + 1;
                              goto LAB_1800213e4;
                            }
                            if (iVar18 == 0x69) goto LAB_1800211d9;
                            if (iVar18 != 0x6e) {
                              if (iVar18 == 0x6f) {
                                iVar18 = 8;
                              }
                              else {
                                if (iVar18 == 0x70) {
                                  uVar27 = 0x10;
                                  bVar6 = true;
LAB_180021172:
                                  local_2a8 = 7;
                                }
                                else {
                                  if (iVar18 == 0x73) goto LAB_18002101e;
                                  if (iVar18 == 0x75) goto LAB_1800211dd;
                                  if (iVar18 != 0x78) goto LAB_1800213e4;
                                  local_2a8 = 0x27;
                                }
                                iVar18 = 0x10;
                              }
                              goto LAB_1800211e7;
                            }
                            puVar19 = *param_4;
                            param_4 = param_4 + 1;
                            bVar10 = FUN_180026b28();
                            if ((int)CONCAT71(extraout_var,bVar10) == 0) goto LAB_18002175c;
                            if ((uVar28 & 0x20) == 0) {
                              *puVar19 = uVar12;
                            }
                            else {
                              *(wchar_t *)puVar19 = (wchar_t)uVar12;
                            }
                            local_2c0 = 1;
                          }
                          pbVar23 = local_280;
                          uVar20 = uVar27;
                          uVar12 = local_2d8;
                          if (local_290 != (uint *)0x0) {
                            free(local_290);
                            local_290 = (uint *)0x0;
                            pbVar23 = local_280;
                            uVar12 = local_2d8;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          uVar27 = uVar20;
          bVar29 = *pbVar23;
          param_2 = pbVar23;
          uVar20 = local_2bc;
        } while (bVar29 != 0);
        if ((uVar20 == 0) || (uVar20 == 7)) goto LAB_180021776;
      }
    }
  }
LAB_18002175c:
  piVar16 = _errno();
  *piVar16 = 0x16;
  FUN_18001fee8();
LAB_180021776:
  if (local_258 != '\0') {
    *(uint *)(local_260 + 200) = *(uint *)(local_260 + 200) & 0xfffffffd;
  }
  FUN_18001d2f0(local_40 ^ (ulonglong)&stack0xfffffffffffffce8);
  return;
}



// Library Function - Single Match
//  write_char
// 
// Library: Visual Studio 2012 Release

void write_char(byte param_1,FILE *param_2,int *param_3)

{
  int *piVar1;
  uint uVar2;
  ulonglong uVar3;
  
  if (((*(byte *)&param_2->_flag & 0x40) == 0) || (param_2->_base != (char *)0x0)) {
    piVar1 = &param_2->_cnt;
    *piVar1 = *piVar1 + -1;
    if (*piVar1 < 0) {
      uVar3 = FUN_18001ff44((int)(char)param_1,param_2);
      uVar2 = (uint)uVar3;
    }
    else {
      *param_2->_ptr = param_1;
      param_2->_ptr = param_2->_ptr + 1;
      uVar2 = (uint)param_1;
    }
    if (uVar2 == 0xffffffff) {
      *param_3 = -1;
    }
    else {
      *param_3 = *param_3 + 1;
    }
  }
  else {
    *param_3 = *param_3 + 1;
  }
  return;
}



// Library Function - Single Match
//  write_multi_char
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void write_multi_char(byte param_1,int param_2,FILE *param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      write_char(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



// Library Function - Single Match
//  write_string
// 
// Library: Visual Studio 2012 Release

void write_string(byte *param_1,int param_2,FILE *param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  iVar1 = *param_5;
  if (((*(byte *)&param_3->_flag & 0x40) == 0) || (param_3->_base != (char *)0x0)) {
    *param_5 = 0;
    if (0 < param_2) {
      do {
        param_2 = param_2 + -1;
        write_char(*param_1,param_3,param_4);
        param_1 = param_1 + 1;
        if (*param_4 == -1) {
          if (*param_5 != 0x2a) break;
          write_char(0x3f,param_3,param_4);
        }
      } while (0 < param_2);
      if (*param_5 != 0) {
        return;
      }
    }
    *param_5 = iVar1;
  }
  else {
    *param_4 = *param_4 + param_2;
  }
  return;
}



// Library Function - Single Match
//  iswctype
// 
// Library: Visual Studio 2012 Release

int iswctype(wint_t _C,wctype_t _Type)

{
  ushort uVar1;
  BOOL BVar2;
  uint uVar3;
  wint_t local_res8 [8];
  ushort local_res18 [8];
  
  if (_C == 0xffff) {
    uVar3 = 0;
  }
  else {
    if (_C < 0x100) {
      uVar1 = *(ushort *)(PTR_DAT_18004a368 + (ulonglong)_C * 2);
    }
    else {
      local_res8[0] = _C;
      BVar2 = GetStringTypeW(1,(LPCWSTR)local_res8,1,local_res18);
      uVar1 = 0;
      if (BVar2 != 0) {
        uVar1 = local_res18[0];
      }
    }
    uVar3 = (uint)(uVar1 & _Type);
  }
  return (int)uVar3;
}



// Library Function - Single Match
//  _wchartodigit
// 
// Library: Visual Studio 2012 Release

int _wchartodigit(ushort param_1)

{
  ushort uVar1;
  int iVar2;
  
  iVar2 = 0x30;
  if (param_1 < 0x30) {
    return -1;
  }
  if (param_1 < 0x3a) goto LAB_180021960;
  iVar2 = 0xff10;
  if (param_1 < 0xff10) {
    iVar2 = 0x660;
    if (param_1 < 0x660) {
      return -1;
    }
    if (param_1 < 0x66a) goto LAB_180021960;
    iVar2 = 0x6f0;
    if (param_1 < 0x6f0) {
      return -1;
    }
    if (param_1 < 0x6fa) goto LAB_180021960;
    iVar2 = 0x966;
    if (param_1 < 0x966) {
      return -1;
    }
    if (param_1 < 0x970) goto LAB_180021960;
    iVar2 = 0x9e6;
    if (param_1 < 0x9e6) {
      return -1;
    }
    if (param_1 < 0x9f0) goto LAB_180021960;
    iVar2 = 0xa66;
    if (param_1 < 0xa66) {
      return -1;
    }
    if (param_1 < 0xa70) goto LAB_180021960;
    iVar2 = 0xae6;
    if (param_1 < 0xae6) {
      return -1;
    }
    if (param_1 < 0xaf0) goto LAB_180021960;
    iVar2 = 0xb66;
    if (param_1 < 0xb66) {
      return -1;
    }
    if (param_1 < 0xb70) goto LAB_180021960;
    iVar2 = 0xc66;
    if (param_1 < 0xc66) {
      return -1;
    }
    if (param_1 < 0xc70) goto LAB_180021960;
    iVar2 = 0xce6;
    if (param_1 < 0xce6) {
      return -1;
    }
    if (param_1 < 0xcf0) goto LAB_180021960;
    iVar2 = 0xd66;
    if (param_1 < 0xd66) {
      return -1;
    }
    if (param_1 < 0xd70) goto LAB_180021960;
    iVar2 = 0xe50;
    if (param_1 < 0xe50) {
      return -1;
    }
    if (param_1 < 0xe5a) goto LAB_180021960;
    iVar2 = 0xed0;
    if (param_1 < 0xed0) {
      return -1;
    }
    if (param_1 < 0xeda) goto LAB_180021960;
    iVar2 = 0xf20;
    if (param_1 < 0xf20) {
      return -1;
    }
    if (param_1 < 0xf2a) goto LAB_180021960;
    iVar2 = 0x1040;
    if (param_1 < 0x1040) {
      return -1;
    }
    if (param_1 < 0x104a) goto LAB_180021960;
    iVar2 = 0x17e0;
    if (param_1 < 0x17e0) {
      return -1;
    }
    if (param_1 < 0x17ea) goto LAB_180021960;
    iVar2 = 0x1810;
    if (param_1 < 0x1810) {
      return -1;
    }
    uVar1 = 0x181a;
  }
  else {
    uVar1 = 0xff1a;
  }
  if (uVar1 <= param_1) {
    return -1;
  }
LAB_180021960:
  return (int)((uint)param_1 - iVar2);
}



// Library Function - Single Match
//  _freefls
// 
// Library: Visual Studio 2012 Release

void _freefls(void *_PerFiberData)

{
  int *piVar1;
  
  if (_PerFiberData != (void *)0x0) {
    if (*(void **)((longlong)_PerFiberData + 0x38) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x38));
    }
    if (*(void **)((longlong)_PerFiberData + 0x48) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x48));
    }
    if (*(void **)((longlong)_PerFiberData + 0x58) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x58));
    }
    if (*(void **)((longlong)_PerFiberData + 0x68) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x68));
    }
    if (*(void **)((longlong)_PerFiberData + 0x70) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x70));
    }
    if (*(void **)((longlong)_PerFiberData + 0x78) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x78));
    }
    if (*(void **)((longlong)_PerFiberData + 0x80) != (void *)0x0) {
      free(*(void **)((longlong)_PerFiberData + 0x80));
    }
    if (*(undefined **)((longlong)_PerFiberData + 0xa0) != &DAT_180032600) {
      free(*(undefined **)((longlong)_PerFiberData + 0xa0));
    }
    _lock(0xd);
    piVar1 = *(int **)((longlong)_PerFiberData + 0xb8);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
      if ((*piVar1 == 0) && (piVar1 != &DAT_180049830)) {
        free(piVar1);
      }
    }
    FUN_180024d08(0xd);
    _lock(0xc);
    piVar1 = *(int **)((longlong)_PerFiberData + 0xc0);
    if (piVar1 != (int *)0x0) {
      __removelocaleref(piVar1);
      if (((piVar1 != (int *)PTR_DAT_18004a1f0) && (piVar1 != (int *)&DAT_18004a200)) &&
         (*piVar1 == 0)) {
        __freetlocinfo(piVar1);
      }
    }
    FUN_180024d08(0xc);
    free(_PerFiberData);
  }
  return;
}



// Library Function - Single Match
//  _freeptd
// 
// Library: Visual Studio 2012 Release

void _freeptd(_ptiddata _Ptd)

{
  if (DAT_180049320 != -1) {
    if (_Ptd == (_ptiddata)0x0) {
      _Ptd = (_ptiddata)FUN_1800240a4();
    }
    FUN_1800240c0();
    _freefls(_Ptd);
  }
  return;
}



// Library Function - Single Match
//  _getptd
// 
// Library: Visual Studio 2012 Release

_ptiddata _getptd(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd_noexit();
  if (p_Var1 == (_ptiddata)0x0) {
    _amsg_exit(0x10);
  }
  return p_Var1;
}



// Library Function - Single Match
//  _getptd_noexit
// 
// Library: Visual Studio 2012 Release

_ptiddata _getptd_noexit(void)

{
  DWORD dwErrCode;
  int iVar1;
  DWORD DVar2;
  _ptiddata _Memory;
  
  dwErrCode = GetLastError();
  _Memory = (_ptiddata)FUN_1800240a4();
  if (_Memory == (_ptiddata)0x0) {
    _Memory = (_ptiddata)FUN_18001f568(1,0x478);
    if (_Memory != (_ptiddata)0x0) {
      iVar1 = FUN_1800240c0();
      if (iVar1 == 0) {
        free(_Memory);
        _Memory = (_ptiddata)0x0;
      }
      else {
        FUN_180021cfc((longlong)_Memory,0);
        DVar2 = GetCurrentThreadId();
        _Memory->_thandle = 0xffffffffffffffff;
        _Memory->_tid = DVar2;
      }
    }
  }
  SetLastError(dwErrCode);
  return _Memory;
}



void FUN_180021cfc(longlong param_1,longlong param_2)

{
  *(undefined **)(param_1 + 0xa0) = &DAT_180032600;
  *(undefined4 *)(param_1 + 0x10) = 0;
  *(undefined4 *)(param_1 + 0x1c) = 1;
  *(undefined4 *)(param_1 + 200) = 1;
  *(undefined2 *)(param_1 + 0x164) = 0x43;
  *(undefined2 *)(param_1 + 0x26a) = 0x43;
  *(undefined4 **)(param_1 + 0xb8) = &DAT_180049830;
  *(undefined8 *)(param_1 + 0x470) = 0;
  _lock(0xd);
  LOCK();
  **(int **)(param_1 + 0xb8) = **(int **)(param_1 + 0xb8) + 1;
  FUN_180024d08(0xd);
  _lock(0xc);
  *(longlong *)(param_1 + 0xc0) = param_2;
  if (param_2 == 0) {
    *(undefined **)(param_1 + 0xc0) = PTR_DAT_18004a1f0;
  }
  __addlocaleref(*(int **)(param_1 + 0xc0));
  FUN_180024d08(0xc);
  return;
}



// Library Function - Single Match
//  _mtinit
// 
// Library: Visual Studio 2012 Release

int _mtinit(void)

{
  int iVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  
  FUN_18001f294();
  iVar1 = FUN_180024ca4();
  if ((((iVar1 != 0) && (DAT_180049320 = FUN_18002406c(), DAT_180049320 != -1)) &&
      (pDVar3 = (DWORD *)FUN_18001f568(1,0x478), pDVar3 != (DWORD *)0x0)) &&
     (iVar1 = FUN_1800240c0(), iVar1 != 0)) {
    FUN_180021cfc((longlong)pDVar3,0);
    DVar2 = GetCurrentThreadId();
    *(undefined8 *)(pDVar3 + 2) = 0xffffffffffffffff;
    *pDVar3 = DVar2;
    return 1;
  }
  FUN_180021e40();
  return 0;
}



void FUN_180021e40(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  LPCRITICAL_SECTION *pp_Var1;
  int *piVar2;
  longlong lVar3;
  longlong lVar4;
  
  if (DAT_180049320 != -1) {
    FUN_180024088();
    DAT_180049320 = -1;
  }
  lVar4 = 0x24;
  pp_Var1 = (LPCRITICAL_SECTION *)&DAT_180049390;
  lVar3 = 0x24;
  do {
    lpCriticalSection = *pp_Var1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (*(int *)(pp_Var1 + 1) != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      free(lpCriticalSection);
      *pp_Var1 = (LPCRITICAL_SECTION)0x0;
    }
    pp_Var1 = pp_Var1 + 2;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  piVar2 = &DAT_180049398;
  do {
    if ((*(LPCRITICAL_SECTION *)(piVar2 + -2) != (LPCRITICAL_SECTION)0x0) && (*piVar2 == 1)) {
      DeleteCriticalSection(*(LPCRITICAL_SECTION *)(piVar2 + -2));
    }
    piVar2 = piVar2 + 4;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return;
}



// Library Function - Single Match
//  __DestructExceptionObject
// 
// Library: Visual Studio 2012 Release

void __DestructExceptionObject(int *param_1)

{
  byte *pbVar1;
  code *pcVar2;
  
  if ((((param_1 != (int *)0x0) && (*param_1 == -0x1f928c9d)) && (param_1[6] == 4)) &&
     ((param_1[8] + 0xe66cfae0U < 3 && (pbVar1 = *(byte **)(param_1 + 0xc), pbVar1 != (byte *)0x0)))
     ) {
    if (*(int *)(pbVar1 + 4) == 0) {
      if (((*pbVar1 & 0x10) != 0) && (**(longlong ***)(param_1 + 10) != (longlong *)0x0)) {
        (**(code **)(***(longlong ***)(param_1 + 10) + 0x10))();
      }
    }
    else {
      pcVar2 = (code *)(*(longlong *)(param_1 + 0xe) + (longlong)*(int *)(pbVar1 + 4));
      (*pcVar2)(*(undefined8 *)(param_1 + 10),pcVar2);
    }
  }
  return;
}



undefined ** FUN_180021ed4(undefined **param_1,exception *param_2)

{
  std::exception::exception((exception *)param_1,param_2);
  *param_1 = (undefined *)std::bad_exception::vftable;
  return param_1;
}



undefined ** FUN_180021f08(undefined **param_1,uint param_2)

{
  *param_1 = (undefined *)std::bad_exception::vftable;
  FUN_18001ede8(param_1);
  if ((param_2 & 1) != 0) {
    free(param_1);
  }
  return param_1;
}



// Library Function - Single Match
//  void __cdecl CatchIt(struct EHExceptionRecord * __ptr64,unsigned __int64 * __ptr64,struct
// _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,struct _s_HandlerType const * __ptr64,struct _s_CatchableType const * __ptr64,struct
// _s_TryBlockMapEntry const * __ptr64,int,unsigned __int64 * __ptr64,unsigned char,unsigned char)
// 
// Library: Visual Studio 2012 Release

void CatchIt(EHExceptionRecord *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,
            _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,_s_HandlerType *param_6,
            _s_CatchableType *param_7,_s_TryBlockMapEntry *param_8,int param_9,
            unsigned___int64 *param_10,unsigned_char param_11,unsigned_char param_12)

{
  _s_FuncInfo *p_Var1;
  _s_HandlerType *p_Var2;
  void **ppvVar3;
  ulonglong uVar4;
  unsigned___int64 local_res10 [2];
  
  p_Var1 = param_5;
  ppvVar3 = (void **)_GetEstablisherFrame(param_2,param_4,param_5,local_res10);
  p_Var2 = param_6;
  if (param_7 != (_s_CatchableType *)0x0) {
    __BuildCatchObject((longlong)param_1,ppvVar3,(uint *)param_6,(byte *)param_7);
  }
  uVar4 = _GetImageBase();
  FUN_18001e6f4((PVOID *)param_2,(ULONG_PTR)param_1,(ULONG_PTR)param_3,(ULONG_PTR)ppvVar3,
                uVar4 + (longlong)*(int *)(p_Var2 + 0xc),*(int *)param_8,(ULONG_PTR)p_Var1,
                (PVOID *)param_4,(byte)param_12);
  return;
}



// WARNING: Could not reconcile some variable overlaps
// Library Function - Single Match
//  void __cdecl FindHandler(struct EHExceptionRecord * __ptr64,unsigned __int64 * __ptr64,struct
// _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo const *
// __ptr64,unsigned char,int,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2012 Release

void FindHandler(EHExceptionRecord *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,
                _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,unsigned_char param_6,int param_7
                ,unsigned___int64 *param_8)

{
  code *pcVar1;
  _s_FuncInfo *p_Var2;
  bool bVar3;
  int iVar4;
  int iVar5;
  unsigned_char uVar6;
  _ptiddata p_Var7;
  ulonglong uVar8;
  type_info *this;
  longlong lVar9;
  undefined8 uVar10;
  _s_ESTypeList *p_Var11;
  unsigned___int64 *puVar12;
  _s_ESTypeList *p_Var13;
  type_info *ptVar14;
  type_info *ptVar15;
  _s_HandlerType *p_Var16;
  int *piVar17;
  uint uVar18;
  type_info *ptVar19;
  undefined8 local_res8;
  _CONTEXT *local_res18;
  uint in_stack_ffffffffffffff68;
  uint in_stack_ffffffffffffff70;
  uint local_84;
  uint local_80;
  int local_7c;
  int local_78;
  int *local_70;
  _s_CatchableType *local_68;
  unsigned___int64 local_60 [2];
  undefined **local_58 [4];
  
  p_Var2 = param_5;
  ptVar15 = (type_info *)0x0;
  local_res8 = (char *)((ulonglong)local_res8 & 0xffffffffffffff00);
  bVar3 = false;
  local_res18 = param_3;
  iVar4 = FUN_180023304((longlong)param_5,(longlong *)param_4);
  _GetEstablisherFrame(param_2,param_4,p_Var2,local_60);
  iVar5 = __GetUnwindTryBlock(param_2,param_4,p_Var2);
  if (iVar5 < iVar4) {
    __SetState(local_60,param_4,p_Var2,iVar4);
    __SetUnwindTryBlock(param_2,param_4,p_Var2,iVar4);
  }
  else {
    iVar4 = __GetUnwindTryBlock(param_2,param_4,p_Var2);
  }
  if ((iVar4 < -1) || (p_Var2->maxState <= iVar4)) {
    _inconsistency();
  }
  if (*(int *)param_1 == -0x1f928c9d) {
    if (((*(int *)(param_1 + 0x18) == 4) && (*(int *)(param_1 + 0x20) + 0xe66cfae0U < 3)) &&
       (*(longlong *)(param_1 + 0x30) == 0)) {
      p_Var7 = _getptd();
      if (p_Var7->_curexception == (void *)0x0) {
        return;
      }
      p_Var7 = _getptd();
      param_1 = (EHExceptionRecord *)p_Var7->_curexception;
      p_Var7 = _getptd();
      param_3 = (_CONTEXT *)p_Var7->_curcontext;
      local_res8 = (char *)CONCAT71(local_res8._1_7_,1);
      local_res18 = param_3;
      _SetThrowImageBase(*(ulonglong *)((longlong)param_1 + 0x38));
      iVar5 = _ValidateRead(param_1,1);
      if (iVar5 == 0) {
        _inconsistency();
      }
      if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)((longlong)param_1 + 0x18) == 4)) &&
         ((*(int *)((longlong)param_1 + 0x20) + 0xe66cfae0U < 3 &&
          (*(longlong *)((longlong)param_1 + 0x30) == 0)))) {
        _inconsistency();
      }
      p_Var7 = _getptd();
      if (p_Var7->_curexcspec != (void *)0x0) {
        p_Var7 = _getptd();
        piVar17 = (int *)p_Var7->_curexcspec;
        p_Var7 = _getptd();
        p_Var7->_curexcspec = (void *)0x0;
        uVar6 = IsInExceptionSpec(param_1,(_s_ESTypeList *)piVar17);
        param_3 = local_res18;
        if ((char)uVar6 == '\0') {
          ptVar14 = ptVar15;
          ptVar19 = ptVar15;
          if (0 < *piVar17) {
            do {
              uVar8 = _GetImageBase();
              this = ptVar15;
              if (*(int *)(ptVar14 + (longlong)piVar17[1] + 4 + uVar8) != 0) {
                uVar8 = _GetImageBase();
                iVar4 = *(int *)(ptVar14 + (longlong)piVar17[1] + 4 + uVar8);
                uVar8 = _GetImageBase();
                this = (type_info *)(uVar8 + (longlong)iVar4);
              }
              bVar3 = type_info::operator__
                                (this,(type_info *)&class_std__bad_exception_RTTI_Type_Descriptor);
              if (bVar3 != false) {
                __DestructExceptionObject((int *)param_1);
                local_res8 = "bad exception";
                std::exception::exception((exception *)local_58,(char **)&local_res8);
                local_58[0] = std::bad_exception::vftable;
                FUN_18001ef4c((longlong *)local_58,&DAT_1800478f0);
                pcVar1 = (code *)swi(3);
                (*pcVar1)();
                return;
              }
              uVar18 = (int)ptVar19 + 1;
              ptVar14 = ptVar14 + 0x14;
              ptVar19 = (type_info *)(ulonglong)uVar18;
            } while ((int)uVar18 < *piVar17);
          }
          FUN_1800233b8();
          pcVar1 = (code *)swi(3);
          (*pcVar1)();
          return;
        }
      }
    }
    if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)((longlong)param_1 + 0x18) == 4)) &&
       (*(int *)((longlong)param_1 + 0x20) + 0xe66cfae0U < 3)) {
      if ((p_Var2->nTryBlocks != 0) &&
         (lVar9 = FUN_18001e2fc(param_2,(longlong)p_Var2,(ulonglong)(uint)param_7,iVar4,&local_84,
                                (int *)&local_80,(longlong *)param_4), local_84 < local_80)) {
        piVar17 = (int *)(lVar9 + 0x10);
        uVar18 = local_80;
        do {
          if ((piVar17[-4] == iVar4 || piVar17[-4] < iVar4) && (iVar4 <= piVar17[-3])) {
            uVar8 = _GetImageBase();
            p_Var16 = (_s_HandlerType *)((longlong)*piVar17 + uVar8);
            for (local_7c = piVar17[-1]; uVar18 = local_80, 0 < local_7c; local_7c = local_7c + -1)
            {
              uVar8 = _GetThrowImageBase();
              local_70 = (int *)(uVar8 + 4 +
                                (longlong)*(int *)(*(longlong *)((longlong)param_1 + 0x30) + 0xc));
              uVar8 = _GetThrowImageBase();
              for (local_78 = *(int *)(uVar8 + (longlong)
                                               *(int *)(*(longlong *)((longlong)param_1 + 0x30) +
                                                       0xc)); 0 < local_78; local_78 = local_78 + -1
                  ) {
                uVar8 = _GetThrowImageBase();
                local_68 = (_s_CatchableType *)(uVar8 + (longlong)*local_70);
                uVar10 = FUN_180023138((byte *)p_Var16,(byte *)local_68,
                                       *(byte **)((longlong)param_1 + 0x30));
                if ((int)uVar10 != 0) {
                  in_stack_ffffffffffffff70 =
                       in_stack_ffffffffffffff70 & 0xffffff00 | param_6 & 0xff;
                  in_stack_ffffffffffffff68 =
                       in_stack_ffffffffffffff68 & 0xffffff00 | (uint)(byte)local_res8;
                  bVar3 = true;
                  CatchIt(param_1,param_2,local_res18,param_4,p_Var2,p_Var16,local_68,
                          (_s_TryBlockMapEntry *)(piVar17 + -4),param_7,param_8,
                          in_stack_ffffffffffffff68,in_stack_ffffffffffffff70);
                  uVar18 = local_80;
                  goto LAB_180022361;
                }
                local_70 = local_70 + 1;
              }
              p_Var16 = p_Var16 + 0x14;
            }
          }
LAB_180022361:
          local_84 = local_84 + 1;
          piVar17 = piVar17 + 5;
        } while (local_84 < uVar18);
        if (bVar3) goto LAB_18002240c;
      }
      p_Var13 = (_s_ESTypeList *)0x0;
      if (0x19930520 < (p_Var2->magicNumber_and_bbtFlags & 0x1fffffff)) {
        iVar4 = p_Var2->dispESTypeList;
        p_Var11 = p_Var13;
        if (iVar4 != 0) {
          uVar8 = _GetImageBase();
          p_Var11 = (_s_ESTypeList *)(uVar8 + (longlong)iVar4);
        }
        if (p_Var11 != (_s_ESTypeList *)0x0) {
          if (iVar4 != 0) {
            uVar8 = _GetImageBase();
            p_Var13 = (_s_ESTypeList *)(uVar8 + (longlong)(int)p_Var2->dispESTypeList);
          }
          uVar6 = IsInExceptionSpec(param_1,p_Var13);
          if ((char)uVar6 == '\0') {
            puVar12 = _GetEstablisherFrame(param_2,param_4,p_Var2,(unsigned___int64 *)&local_res8);
            FUN_18001e6f4((PVOID *)param_2,(ULONG_PTR)param_1,(ULONG_PTR)local_res18,
                          (ULONG_PTR)puVar12,0,-1,(ULONG_PTR)p_Var2,(PVOID *)param_4,(byte)param_6);
          }
        }
      }
      goto LAB_18002240c;
    }
  }
  if (p_Var2->nTryBlocks != 0) {
    if ((char)param_6 != '\0') {
      FUN_1800233b8();
      pcVar1 = (code *)swi(3);
      (*pcVar1)();
      return;
    }
    FindHandlerForForeignException(param_1,param_2,param_3,param_4,p_Var2,iVar4,param_7,param_8);
  }
LAB_18002240c:
  p_Var7 = _getptd();
  if (p_Var7->_curexcspec != (void *)0x0) {
    _inconsistency();
  }
  return;
}



// Library Function - Single Match
//  void __cdecl FindHandlerForForeignException(struct EHExceptionRecord * __ptr64,unsigned __int64
// * __ptr64,struct _CONTEXT * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct _s_FuncInfo
// const * __ptr64,int,int,unsigned __int64 * __ptr64)
// 
// Library: Visual Studio 2012 Release

void FindHandlerForForeignException
               (EHExceptionRecord *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,
               _xDISPATCHER_CONTEXT *param_4,_s_FuncInfo *param_5,int param_6,int param_7,
               unsigned___int64 *param_8)

{
  int iVar1;
  _s_FuncInfo *p_Var2;
  int iVar3;
  _ptiddata p_Var4;
  PVOID pvVar5;
  longlong lVar6;
  ulonglong uVar7;
  uint uVar8;
  int *piVar9;
  uint local_res8 [2];
  _CONTEXT *local_res18;
  unsigned_char in_stack_ffffffffffffffa8;
  uint in_stack_ffffffffffffffb0;
  uint local_48 [4];
  
  if (*(int *)param_1 != -0x7ffffffd) {
    local_res18 = param_3;
    p_Var4 = _getptd();
    p_Var2 = param_5;
    uVar8 = param_7;
    if (p_Var4->_translator != (void *)0x0) {
      pvVar5 = EncodePointer((PVOID)0x0);
      p_Var4 = _getptd();
      uVar8 = param_7;
      if ((((p_Var4->_translator != pvVar5) && (*(int *)param_1 != -0x1fbcb0b3)) &&
          (*(int *)param_1 != -0x1fbcbcae)) &&
         (iVar3 = _CallSETranslator((undefined4 *)param_1,param_2,param_3), iVar3 != 0)) {
        return;
      }
    }
    if (p_Var2->nTryBlocks == 0) {
      _inconsistency();
    }
    iVar3 = param_6;
    lVar6 = FUN_18001e2fc(param_2,(longlong)p_Var2,(ulonglong)uVar8,param_6,local_res8,
                          (int *)local_48,(longlong *)param_4);
    if (local_res8[0] < local_48[0]) {
      piVar9 = (int *)(lVar6 + 0xc);
      do {
        if ((piVar9[-3] <= iVar3) && (iVar3 <= piVar9[-2])) {
          uVar7 = _GetImageBase();
          if (*(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14) == 0) {
            lVar6 = 0;
          }
          else {
            uVar7 = _GetImageBase();
            iVar1 = *(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14);
            uVar7 = _GetImageBase();
            lVar6 = uVar7 + (longlong)iVar1;
          }
          if (lVar6 != 0) {
            uVar7 = _GetImageBase();
            if (*(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14) == 0) {
              lVar6 = 0;
            }
            else {
              uVar7 = _GetImageBase();
              iVar1 = *(int *)((uVar7 - 0x10) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14);
              uVar7 = _GetImageBase();
              lVar6 = uVar7 + (longlong)iVar1;
            }
            if (*(char *)(lVar6 + 0x10) != '\0') goto LAB_1800226f2;
          }
          uVar7 = _GetImageBase();
          if ((*(byte *)((uVar7 - 0x14) + (longlong)piVar9[1] + (longlong)*piVar9 * 0x14) & 0x40) ==
              0) {
            uVar7 = _GetImageBase();
            in_stack_ffffffffffffffb0 = in_stack_ffffffffffffffb0 & 0xffffff00;
            in_stack_ffffffffffffffa8 = CONCAT31((int3)(in_stack_ffffffffffffffa8 >> 8),1);
            CatchIt(param_1,param_2,local_res18,param_4,p_Var2,
                    (_s_HandlerType *)
                    (uVar7 + (longlong)(*piVar9 + -1) * 0x14 + (longlong)piVar9[1]),
                    (_s_CatchableType *)0x0,(_s_TryBlockMapEntry *)(piVar9 + -3),param_7,param_8,
                    in_stack_ffffffffffffffa8,in_stack_ffffffffffffffb0);
          }
        }
LAB_1800226f2:
        local_res8[0] = local_res8[0] + 1;
        piVar9 = piVar9 + 5;
      } while (local_res8[0] < local_48[0]);
    }
  }
  return;
}



// Library Function - Single Match
//  unsigned char __cdecl IsInExceptionSpec(struct EHExceptionRecord * __ptr64,struct _s_ESTypeList
// const * __ptr64)
// 
// Library: Visual Studio 2012 Release

unsigned_char IsInExceptionSpec(EHExceptionRecord *param_1,_s_ESTypeList *param_2)

{
  int iVar1;
  code *pcVar2;
  uint in_EAX;
  unsigned_char uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  longlong lVar6;
  int iVar7;
  int iVar8;
  byte bVar9;
  byte bVar10;
  int *piVar11;
  
  if (param_2 == (_s_ESTypeList *)0x0) {
    _inconsistency();
    FUN_1800233b8();
    pcVar2 = (code *)swi(3);
    uVar3 = (*pcVar2)();
    return uVar3;
  }
  iVar8 = 0;
  bVar9 = 0;
  bVar10 = 0;
  if (0 < *(int *)param_2) {
    do {
      uVar4 = _GetThrowImageBase();
      piVar11 = (int *)((longlong)*(int *)(*(longlong *)(param_1 + 0x30) + 0xc) + 4 + uVar4);
      uVar4 = _GetThrowImageBase();
      lVar6 = *(longlong *)(param_1 + 0x30);
      iVar7 = *(int *)(uVar4 + (longlong)*(int *)(lVar6 + 0xc));
      bVar9 = bVar10;
      if (0 < iVar7) {
        do {
          uVar4 = _GetThrowImageBase();
          iVar1 = *piVar11;
          uVar5 = _GetImageBase();
          lVar6 = FUN_180023138((byte *)((longlong)*(int *)(param_2 + 4) +
                                        uVar5 + (longlong)iVar8 * 0x14),
                                (byte *)(uVar4 + (longlong)iVar1),*(byte **)(param_1 + 0x30));
          if ((int)lVar6 != 0) {
            bVar9 = 1;
            break;
          }
          iVar7 = iVar7 + -1;
          piVar11 = piVar11 + 1;
        } while (0 < iVar7);
      }
      in_EAX = (uint)lVar6;
      iVar8 = iVar8 + 1;
      bVar10 = bVar9;
    } while (iVar8 < *(int *)param_2);
  }
  return (unsigned_char)(in_EAX & 0xffffff00 | (uint)bVar9);
}



// Library Function - Single Match
//  __AdjustPointer
// 
// Library: Visual Studio 2012 Release

longlong __AdjustPointer(longlong param_1,int *param_2)

{
  longlong lVar1;
  
  lVar1 = *param_2 + param_1;
  if (-1 < param_2[1]) {
    lVar1 = lVar1 + (longlong)*(int *)((longlong)param_2[2] + *(longlong *)(param_2[1] + param_1)) +
                    (longlong)param_2[1];
  }
  return lVar1;
}



// Library Function - Single Match
//  __BuildCatchObject
// 
// Library: Visual Studio 2012 Release

void __BuildCatchObject(longlong param_1,void **param_2,uint *param_3,byte *param_4)

{
  char cVar1;
  int iVar2;
  undefined7 extraout_var;
  ulonglong uVar3;
  longlong lVar4;
  code *pcVar5;
  void **ppvVar6;
  
  ppvVar6 = param_2;
  if ((*param_3 & 0x80000000) == 0) {
    ppvVar6 = (void **)((longlong)(int)param_3[2] + (longlong)*param_2);
  }
  cVar1 = FUN_1800228d8(param_1,param_2,param_3,param_4);
  iVar2 = (int)CONCAT71(extraout_var,cVar1);
  if (iVar2 == 1) {
    pcVar5 = (code *)0x0;
    if (*(int *)(param_4 + 0x18) != 0) {
      uVar3 = _GetThrowImageBase();
      pcVar5 = (code *)((longlong)*(int *)(param_4 + 0x18) + uVar3);
    }
    lVar4 = __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
    (*pcVar5)(ppvVar6,lVar4);
  }
  else {
    if (iVar2 == 2) {
      pcVar5 = (code *)0x0;
      if (*(int *)(param_4 + 0x18) != 0) {
        uVar3 = _GetThrowImageBase();
        pcVar5 = (code *)(uVar3 + (longlong)*(int *)(param_4 + 0x18));
      }
      lVar4 = __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
      (*pcVar5)(ppvVar6,lVar4,1);
    }
  }
  return;
}



char FUN_1800228d8(longlong param_1,void **param_2,uint *param_3,byte *param_4)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  void *pvVar4;
  void *pvVar5;
  undefined8 *puVar6;
  void *pvVar7;
  unsigned_int uVar8;
  
  pvVar7 = (void *)0x0;
  uVar1 = param_3[1];
  pvVar5 = pvVar7;
  if (uVar1 != 0) {
    uVar3 = _GetImageBase();
    pvVar5 = (void *)((longlong)(int)uVar1 + uVar3);
  }
  if (pvVar5 == (void *)0x0) {
    return '\0';
  }
  pvVar5 = pvVar7;
  if (uVar1 != 0) {
    uVar3 = _GetImageBase();
    pvVar5 = (void *)(uVar3 + (longlong)(int)param_3[1]);
  }
  if (*(char *)((longlong)pvVar5 + 0x10) == '\0') {
    return '\0';
  }
  if ((param_3[2] == 0) && ((*param_3 & 0x80000000) == 0)) {
    return '\0';
  }
  uVar1 = *param_3;
  if (-1 < (int)uVar1) {
    param_2 = (void **)((longlong)(int)param_3[2] + (longlong)*param_2);
  }
  pvVar5 = pvVar7;
  if ((((char)uVar1 < '\0') && ((*param_4 & 0x10) != 0)) && (DAT_18004c2c0 != (code *)0x0)) {
    pvVar4 = (void *)(*DAT_18004c2c0)();
    iVar2 = _ValidateRead(pvVar4,1);
    if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
      *param_2 = pvVar4;
LAB_1800229b0:
      pvVar5 = (void *)__AdjustPointer((longlong)pvVar4,(int *)(param_4 + 8));
      *param_2 = pvVar5;
      pvVar5 = pvVar7;
      goto LAB_180022b01;
    }
  }
  else {
    if ((uVar1 & 8) == 0) {
      if ((*param_4 & 1) == 0) {
        pvVar4 = pvVar7;
        if (*(int *)(param_4 + 0x18) != 0) {
          uVar3 = _GetThrowImageBase();
          pvVar4 = (void *)(uVar3 + (longlong)*(int *)(param_4 + 0x18));
        }
        if (pvVar4 == (void *)0x0) {
          iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
          if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
            iVar2 = *(int *)(param_4 + 0x14);
            puVar6 = (undefined8 *)
                     __AdjustPointer(*(longlong *)(param_1 + 0x28),(int *)(param_4 + 8));
            FUN_18001d320(param_2,puVar6,(longlong)iVar2);
            pvVar5 = (void *)0x0;
            goto LAB_180022b01;
          }
        }
        else {
          iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
          if (iVar2 != 0) {
            uVar8 = 1;
            iVar2 = _ValidateRead(param_2,1);
            if (iVar2 != 0) {
              if (*(int *)(param_4 + 0x18) != 0) {
                uVar3 = _GetThrowImageBase();
                pvVar7 = (void *)(uVar3 + (longlong)*(int *)(param_4 + 0x18));
              }
              iVar2 = _ValidateRead(pvVar7,uVar8);
              if (iVar2 != 0) {
                pvVar5 = (void *)(ulonglong)(((*param_4 & 4) != 0) + 1);
                goto LAB_180022b01;
              }
            }
          }
        }
      }
      else {
        iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
        if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
          FUN_18001d320(param_2,*(undefined8 **)(param_1 + 0x28),(longlong)*(int *)(param_4 + 0x14))
          ;
          if ((*(int *)(param_4 + 0x14) != 8) || (pvVar5 = (void *)0x0, *param_2 == (void *)0x0))
          goto LAB_180022b01;
          pvVar4 = *param_2;
          goto LAB_1800229b0;
        }
      }
    }
    else {
      iVar2 = _ValidateRead(*(void **)(param_1 + 0x28),1);
      if ((iVar2 != 0) && (iVar2 = _ValidateRead(param_2,1), iVar2 != 0)) {
        pvVar4 = *(void **)(param_1 + 0x28);
        *param_2 = pvVar4;
        goto LAB_1800229b0;
      }
    }
  }
  _inconsistency();
LAB_180022b01:
  return (char)pvVar5;
}



// Library Function - Single Match
//  __FrameUnwindFilter
// 
// Library: Visual Studio 2012 Release

undefined8 __FrameUnwindFilter(int **param_1)

{
  int *piVar1;
  code *pcVar2;
  _ptiddata p_Var3;
  undefined8 uVar4;
  
  piVar1 = *param_1;
  if ((*piVar1 == -0x1fbcbcae) || (*piVar1 == -0x1fbcb0b3)) {
    p_Var3 = _getptd();
    if (0 < p_Var3->_ProcessingThrow) {
      p_Var3 = _getptd();
      p_Var3->_ProcessingThrow = p_Var3->_ProcessingThrow + -1;
    }
  }
  else {
    if (*piVar1 == -0x1f928c9d) {
      p_Var3 = _getptd();
      p_Var3->_ProcessingThrow = 0;
      FUN_1800233b8();
      pcVar2 = (code *)swi(3);
      uVar4 = (*pcVar2)();
      return uVar4;
    }
  }
  return 0;
}



// Library Function - Single Match
//  __FrameUnwindToState
// 
// Library: Visual Studio 2012 Release

void __FrameUnwindToState
               (unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
               int param_4)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  _ptiddata p_Var4;
  ulonglong uVar5;
  longlong lVar6;
  longlong lVar7;
  
  uVar3 = _GetImageBase();
  iVar2 = __GetCurrentState(param_1,param_2,param_3);
  p_Var4 = _getptd();
  p_Var4->_ProcessingThrow = p_Var4->_ProcessingThrow + 1;
  while ((iVar2 != -1 && (param_4 < iVar2))) {
    if ((iVar2 < 0) || (param_3->maxState <= iVar2)) {
      _inconsistency();
    }
    lVar7 = (longlong)iVar2;
    uVar5 = _GetImageBase();
    iVar2 = *(int *)((longlong)(int)param_3->dispUnwindMap + uVar5 + lVar7 * 8);
    uVar5 = _GetImageBase();
    if (*(int *)((longlong)(int)param_3->dispUnwindMap + 4 + uVar5 + lVar7 * 8) == 0) {
      lVar6 = 0;
    }
    else {
      uVar5 = _GetImageBase();
      iVar1 = *(int *)((longlong)(int)param_3->dispUnwindMap + 4 + uVar5 + lVar7 * 8);
      uVar5 = _GetImageBase();
      lVar6 = uVar5 + (longlong)iVar1;
    }
    if (lVar6 != 0) {
      __SetState(param_1,param_2,param_3,iVar2);
      uVar5 = _GetImageBase();
      if (*(int *)((longlong)(int)param_3->dispUnwindMap + 4 + uVar5 + lVar7 * 8) != 0) {
        _GetImageBase();
        _GetImageBase();
      }
      _CallSettingFrame();
      _SetImageBase(uVar3);
    }
  }
  p_Var4 = _getptd();
  if (0 < p_Var4->_ProcessingThrow) {
    p_Var4 = _getptd();
    p_Var4->_ProcessingThrow = p_Var4->_ProcessingThrow + -1;
  }
  if ((iVar2 != -1) && (param_4 < iVar2)) {
    _inconsistency();
  }
  __SetState(param_1,param_2,param_3,iVar2);
  return;
}



// Library Function - Single Match
//  __InternalCxxFrameHandler
// 
// Library: Visual Studio 2012 Release

undefined8
__InternalCxxFrameHandler
          (int *param_1,unsigned___int64 *param_2,_CONTEXT *param_3,_xDISPATCHER_CONTEXT *param_4,
          _s_FuncInfo *param_5,int param_6,unsigned___int64 *param_7,byte param_8)

{
  uint uVar1;
  int iVar2;
  _ptiddata p_Var3;
  ulonglong uVar4;
  longlong lVar5;
  undefined8 uVar6;
  code *pcVar7;
  uint in_stack_ffffffffffffffd0;
  undefined8 in_stack_ffffffffffffffe0;
  undefined4 uVar8;
  
  uVar8 = (undefined4)((ulonglong)in_stack_ffffffffffffffe0 >> 0x20);
  p_Var3 = _getptd();
  if (((((*(int *)&p_Var3->_reserved4 != 0) || (*param_1 == -0x1f928c9d)) ||
       ((*param_1 == -0x7fffffd7 &&
        ((param_1[6] == 0xf && (*(longlong *)(param_1 + 0x18) == 0x19930520)))))) ||
      (*param_1 == -0x7fffffda)) ||
     (((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930522 ||
      ((*(byte *)&param_5->EHFlags & 1) == 0)))) {
    if ((param_1[1] & 0x66U) == 0) {
      if (param_5->nTryBlocks == 0) {
        if ((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930521) {
          return 1;
        }
        if (param_5->dispESTypeList == 0) {
          lVar5 = 0;
        }
        else {
          uVar4 = _GetImageBase();
          lVar5 = uVar4 + (longlong)(int)param_5->dispESTypeList;
        }
        if (lVar5 == 0) {
          return 1;
        }
      }
      if (((*param_1 == -0x1f928c9d) && (2 < (uint)param_1[6])) && (0x19930522 < (uint)param_1[8]))
      {
        if (*(int *)(*(longlong *)(param_1 + 0xc) + 8) == 0) {
          pcVar7 = (code *)0x0;
        }
        else {
          uVar4 = _GetThrowImageBase();
          pcVar7 = (code *)((longlong)*(int *)(*(longlong *)(param_1 + 0xc) + 8) + uVar4);
        }
        if (pcVar7 != (code *)0x0) {
          uVar6 = (*pcVar7)(param_1,param_2,param_3,param_4,param_5,param_6,param_7,
                            CONCAT44(uVar8,(uint)param_8));
          return uVar6;
        }
      }
      FindHandler((EHExceptionRecord *)param_1,param_2,param_3,param_4,param_5,
                  in_stack_ffffffffffffffd0 & 0xffffff00 | (uint)param_8,param_6,param_7);
    }
    else {
      if ((param_5->maxState != 0) && (param_6 == 0)) {
        uVar1 = param_1[1] & 0x20;
        if ((uVar1 == 0) || (*param_1 != -0x7fffffda)) {
          if ((uVar1 == 0) || (*param_1 != -0x7fffffd7)) {
            __FrameUnwindToEmptyState(param_2,param_4,param_5);
            return 1;
          }
          iVar2 = param_1[0xe];
          if ((iVar2 < -1) || (param_5->maxState <= iVar2)) {
            _inconsistency();
          }
          param_2 = *(unsigned___int64 **)(param_1 + 10);
        }
        else {
          iVar2 = FUN_18002330c((longlong)param_5,(longlong)param_4,param_3->Rip);
          if ((iVar2 < -1) || (param_5->maxState <= iVar2)) {
            _inconsistency();
          }
        }
        __FrameUnwindToState(param_2,param_4,param_5,iVar2);
      }
    }
  }
  return 1;
}



undefined8 FUN_180023138(byte *param_1,byte *param_2,byte *param_3)

{
  int iVar1;
  ulonglong uVar2;
  longlong lVar3;
  longlong lVar4;
  
  iVar1 = *(int *)(param_1 + 4);
  lVar4 = 0;
  lVar3 = lVar4;
  if (iVar1 != 0) {
    uVar2 = _GetImageBase();
    lVar3 = (longlong)iVar1 + uVar2;
  }
  if (lVar3 != 0) {
    lVar3 = lVar4;
    if (iVar1 != 0) {
      iVar1 = *(int *)(param_1 + 4);
      uVar2 = _GetImageBase();
      lVar3 = (longlong)iVar1 + uVar2;
    }
    if ((*(char *)(lVar3 + 0x10) != '\0') && (((*param_1 & 0x80) == 0 || ((*param_2 & 0x10) == 0))))
    {
      lVar3 = lVar4;
      if (iVar1 != 0) {
        uVar2 = _GetImageBase();
        lVar3 = uVar2 + (longlong)*(int *)(param_1 + 4);
      }
      uVar2 = _GetThrowImageBase();
      if (lVar3 != uVar2 + (longlong)*(int *)(param_2 + 4)) {
        if (*(int *)(param_1 + 4) != 0) {
          uVar2 = _GetImageBase();
          lVar4 = uVar2 + (longlong)*(int *)(param_1 + 4);
        }
        uVar2 = _GetThrowImageBase();
        iVar1 = strcmp((char *)(lVar4 + 0x10),
                       (char *)((longlong)*(int *)(param_2 + 4) + 0x10 + uVar2));
        if (iVar1 != 0) {
          return 0;
        }
      }
      if (((*param_2 & 2) != 0) && ((*param_1 & 8) == 0)) {
        return 0;
      }
      if (((*param_3 & 1) != 0) && ((*param_1 & 1) == 0)) {
        return 0;
      }
      if (((*param_3 & 4) != 0) && ((*param_1 & 4) == 0)) {
        return 0;
      }
      if (((*param_3 & 2) != 0) && ((*param_1 & 2) == 0)) {
        return 0;
      }
      return 1;
    }
  }
  return 1;
}



// Library Function - Single Match
//  int __cdecl __GetCurrentState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2012 Release

int __GetCurrentState(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3)

{
  int iVar1;
  
  iVar1 = *(int *)((longlong)param_3->dispUnwindHelp + *(longlong *)param_1);
  if (iVar1 == -2) {
    iVar1 = FUN_18002330c((longlong)param_3,(longlong)param_2,*(longlong *)param_2);
  }
  return iVar1;
}



// Library Function - Single Match
//  int __cdecl __GetUnwindTryBlock(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64)
// 
// Library: Visual Studio 2012 Release

int __GetUnwindTryBlock(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3
                       )

{
  longlong *plVar1;
  unsigned___int64 local_res18 [4];
  
  plVar1 = (longlong *)_GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  return *(int *)((longlong)param_3->dispUnwindHelp + 4 + *plVar1);
}



// Library Function - Single Match
//  void __cdecl __SetState(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT * __ptr64,struct
// _s_FuncInfo const * __ptr64,int)
// 
// Library: Visual Studio 2012 Release

void __SetState(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,_s_FuncInfo *param_3,
               int param_4)

{
  *(int *)((longlong)param_3->dispUnwindHelp + *(longlong *)param_1) = param_4;
  return;
}



// Library Function - Single Match
//  void __cdecl __SetUnwindTryBlock(unsigned __int64 * __ptr64,struct _xDISPATCHER_CONTEXT *
// __ptr64,struct _s_FuncInfo const * __ptr64,int)
// 
// Library: Visual Studio 2012 Release

void __SetUnwindTryBlock(unsigned___int64 *param_1,_xDISPATCHER_CONTEXT *param_2,
                        _s_FuncInfo *param_3,int param_4)

{
  longlong *plVar1;
  unsigned___int64 local_res18 [4];
  
  plVar1 = (longlong *)_GetEstablisherFrame(param_1,param_2,param_3,local_res18);
  if (*(int *)((longlong)param_3->dispUnwindHelp + 4 + *plVar1) < param_4) {
    *(int *)((longlong)param_3->dispUnwindHelp + 4 + *plVar1) = param_4;
  }
  return;
}



void FUN_180023304(longlong param_1,longlong *param_2)

{
  FUN_18002330c(param_1,(longlong)param_2,*param_2);
  return;
}



undefined4 FUN_18002330c(longlong param_1,longlong param_2,longlong param_3)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  ulonglong uVar4;
  
  if (param_1 == 0) {
    _inconsistency();
  }
  uVar1 = *(uint *)(param_1 + 0x14);
  if ((longlong)*(int *)(param_1 + 0x18) + *(longlong *)(param_2 + 8) == 0) {
    _inconsistency();
  }
  uVar4 = 0;
  if (uVar1 != 0) {
    lVar2 = *(longlong *)(param_2 + 8);
    do {
      if (param_3 < *(int *)(lVar2 + uVar4 * 8 + (longlong)*(int *)(param_1 + 0x18)) + lVar2) break;
      uVar3 = (int)uVar4 + 1;
      uVar4 = (ulonglong)uVar3;
    } while (uVar3 < uVar1);
    if ((int)uVar4 != 0) {
      return *(undefined4 *)
              (lVar2 + (ulonglong)((int)uVar4 - 1) * 8 + 4 + (longlong)*(int *)(param_1 + 0x18));
    }
  }
  return 0xffffffff;
}



// WARNING: Unknown calling convention yet parameter storage is locked
// Library Function - Single Match
//  void __cdecl _inconsistency(void)
// 
// Library: Visual Studio 2012 Release

void _inconsistency(void)

{
  code *pcVar1;
  _ptiddata p_Var2;
  
  pcVar1 = (code *)DecodePointer(DAT_18004c2c8);
  if (pcVar1 != (code *)0x0) {
    (*pcVar1)();
  }
  FUN_1800233b8();
  p_Var2 = _getptd();
  if ((code *)p_Var2->_terminate != (code *)0x0) {
    (*(code *)p_Var2->_terminate)();
  }
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800233b8(void)

{
  code *pcVar1;
  _ptiddata p_Var2;
  
  p_Var2 = _getptd();
  if ((code *)p_Var2->_terminate != (code *)0x0) {
    (*(code *)p_Var2->_terminate)();
  }
  abort();
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_1800233d8(void)

{
  DAT_18004c2c8 = EncodePointer(FUN_1800233b8);
  return;
}



void FUN_1800233f8(uint param_1,uint param_2)

{
  DAT_180049324 = ~param_2 & DAT_180049324 | param_1 & param_2;
  return;
}



// Library Function - Single Match
//  abort
// 
// Library: Visual Studio 2012 Release

void abort(void)

{
  code *pcVar1;
  BOOL BVar2;
  longlong lVar3;
  undefined *puVar4;
  undefined auStack40 [8];
  undefined auStack32 [32];
  
  puVar4 = auStack40;
  lVar3 = FUN_180024e2c();
  if (lVar3 != 0) {
    FUN_180024e5c(0x16);
  }
  if (((byte)DAT_180049324 & 2) != 0) {
    BVar2 = IsProcessorFeaturePresent(0x17);
    puVar4 = auStack40;
    if (BVar2 != 0) {
      pcVar1 = (code *)swi(0x29);
      (*pcVar1)();
      puVar4 = auStack32;
    }
    *(undefined8 *)(puVar4 + -8) = 0x18002345e;
    _call_reportfault(3,0x40000015,1);
  }
  *(undefined8 *)(puVar4 + -8) = 0x180023468;
  FUN_18001f288(3);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



void FUN_18002346c(undefined8 param_1)

{
  DAT_18004c2d0 = param_1;
  return;
}



undefined4 FUN_180023640(int param_1,void *param_2)

{
  int iVar1;
  int *piVar2;
  code *pcVar3;
  void *pvVar4;
  _ptiddata p_Var5;
  int *piVar6;
  longlong lVar7;
  longlong lVar8;
  
  if (param_1 != -0x1f928c9d) {
    return 0;
  }
  p_Var5 = _getptd_noexit();
  if (p_Var5 != (_ptiddata)0x0) {
    piVar2 = (int *)p_Var5->_pxcptacttab;
    piVar6 = piVar2;
    do {
      if (*piVar6 == -0x1f928c9d) break;
      piVar6 = piVar6 + 4;
    } while (piVar6 < piVar2 + 0x30);
    if ((piVar2 + 0x30 <= piVar6) || (*piVar6 != -0x1f928c9d)) {
      piVar6 = (int *)0x0;
    }
    if ((piVar6 != (int *)0x0) && (pcVar3 = *(code **)(piVar6 + 2), pcVar3 != (code *)0x0)) {
      if (pcVar3 == (code *)0x5) {
        *(undefined8 *)(piVar6 + 2) = 0;
        return 1;
      }
      if (pcVar3 != (code *)0x1) {
        pvVar4 = p_Var5->_tpxcptinfoptrs;
        p_Var5->_tpxcptinfoptrs = param_2;
        if (piVar6[1] == 8) {
          lVar7 = 0x30;
          do {
            lVar8 = lVar7 + 0x10;
            *(undefined8 *)(lVar7 + 8 + (longlong)p_Var5->_pxcptacttab) = 0;
            lVar7 = lVar8;
          } while (lVar8 < 0xc0);
          iVar1 = p_Var5->_tfpecode;
          if (*piVar6 == -0x3fffff72) {
            p_Var5->_tfpecode = 0x83;
          }
          else {
            if (*piVar6 == -0x3fffff70) {
              p_Var5->_tfpecode = 0x81;
            }
            else {
              if (*piVar6 == -0x3fffff6f) {
                p_Var5->_tfpecode = 0x84;
              }
              else {
                if (*piVar6 == -0x3fffff6d) {
                  p_Var5->_tfpecode = 0x85;
                }
                else {
                  if (*piVar6 == -0x3fffff73) {
                    p_Var5->_tfpecode = 0x82;
                  }
                  else {
                    if (*piVar6 == -0x3fffff71) {
                      p_Var5->_tfpecode = 0x86;
                    }
                    else {
                      if (*piVar6 == -0x3fffff6e) {
                        p_Var5->_tfpecode = 0x8a;
                      }
                      else {
                        if (*piVar6 == -0x3ffffd4b) {
                          p_Var5->_tfpecode = 0x8d;
                        }
                        else {
                          if (*piVar6 == -0x3ffffd4c) {
                            p_Var5->_tfpecode = 0x8e;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          (*pcVar3)(8,p_Var5->_tfpecode);
          p_Var5->_tfpecode = iVar1;
        }
        else {
          *(undefined8 *)(piVar6 + 2) = 0;
          (*pcVar3)(piVar6[1]);
        }
        p_Var5->_tpxcptinfoptrs = pvVar4;
      }
      return 0xffffffff;
    }
  }
  return 0;
}



undefined8 FUN_180023654(void)

{
  uint uVar1;
  byte bVar2;
  DWORD DVar3;
  undefined8 uVar4;
  HANDLE hFile;
  int iVar5;
  HANDLE *ppvVar6;
  HANDLE *ppvVar7;
  longlong lVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  undefined auStack216 [32];
  uint local_b8;
  HANDLE *local_b0;
  int local_a8;
  int *local_a0;
  HANDLE *local_98;
  undefined *local_90;
  _STARTUPINFOW local_88;
  
  local_90 = auStack216;
  _lock(0xb);
  local_b0 = (HANDLE *)FUN_18001f568(0x20,0x58);
  if (local_b0 == (HANDLE *)0x0) {
    FUN_180025980(auStack216,(PVOID)0x1800236b8);
    uVar4 = 0xffffffff;
  }
  else {
    DAT_18004e128 = 0x20;
    DAT_18004c2e0 = local_b0;
    for (; local_b0 < DAT_18004c2e0 + 0x160; local_b0 = local_b0 + 0xb) {
      *(undefined2 *)(local_b0 + 1) = 0xa00;
      *local_b0 = (HANDLE)0xffffffffffffffff;
      *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
      *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x7f;
      *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
      *(undefined4 *)(local_b0 + 10) = 0;
      *(undefined *)((longlong)local_b0 + 0x4c) = 0;
    }
    GetStartupInfoW((LPSTARTUPINFOW)&local_88);
    if ((local_88.cbReserved2 != 0) && ((int *)local_88.lpReserved2 != (int *)0x0)) {
      piVar9 = (int *)((longlong)local_88.lpReserved2 + 4);
      ppvVar7 = (HANDLE *)((longlong)*(int *)local_88.lpReserved2 + (longlong)piVar9);
      iVar10 = 0x800;
      if (*(int *)local_88.lpReserved2 < 0x800) {
        iVar10 = *(int *)local_88.lpReserved2;
      }
      iVar5 = 1;
      local_a0 = piVar9;
      local_98 = ppvVar7;
      while ((iVar11 = iVar10, local_a8 = iVar5, DAT_18004e128 < iVar10 &&
             (local_b0 = (HANDLE *)FUN_18001f568(0x20,0x58), iVar11 = DAT_18004e128,
             local_b0 != (HANDLE *)0x0))) {
        *(HANDLE **)((longlong)&DAT_18004c2e0 + (longlong)iVar5 * 8) = local_b0;
        DAT_18004e128 = DAT_18004e128 + 0x20;
        for (; local_b0 <
               (HANDLE *)(*(longlong *)((longlong)&DAT_18004c2e0 + (longlong)iVar5 * 8) + 0xb00);
            local_b0 = local_b0 + 0xb) {
          *(undefined2 *)(local_b0 + 1) = 0xa00;
          *local_b0 = (HANDLE)0xffffffffffffffff;
          *(undefined4 *)((longlong)local_b0 + 0xc) = 0;
          *(byte *)(local_b0 + 7) = *(byte *)(local_b0 + 7) & 0x80;
          *(undefined2 *)((longlong)local_b0 + 0x39) = 0xa0a;
          *(undefined4 *)(local_b0 + 10) = 0;
          *(undefined *)((longlong)local_b0 + 0x4c) = 0;
        }
        iVar5 = iVar5 + 1;
      }
      local_b8 = 0;
      while (uVar1 = local_b8, (int)local_b8 < iVar11) {
        if (((1 < (longlong)*ppvVar7 + 2U) && ((*(byte *)piVar9 & 1) != 0)) &&
           (((*(byte *)piVar9 & 8) != 0 || (DVar3 = GetFileType(*ppvVar7), DVar3 != 0)))) {
          ppvVar6 = (HANDLE *)
                    ((ulonglong)(uVar1 & 0x1f) * 0x58 +
                    *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)uVar1 >> 5) * 8));
          *ppvVar6 = *ppvVar7;
          *(byte *)(ppvVar6 + 1) = *(byte *)piVar9;
          local_b0 = ppvVar6;
          FUN_1800240dc((LPCRITICAL_SECTION)(ppvVar6 + 2),4000);
          *(int *)((longlong)ppvVar6 + 0xc) = *(int *)((longlong)ppvVar6 + 0xc) + 1;
        }
        piVar9 = (int *)((longlong)piVar9 + 1);
        ppvVar7 = ppvVar7 + 1;
        local_a0 = piVar9;
        local_98 = ppvVar7;
        local_b8 = uVar1 + 1;
      }
    }
    local_b8 = 0;
    while (iVar10 = local_b8, (int)local_b8 < 3) {
      lVar8 = (longlong)(int)local_b8;
      ppvVar7 = DAT_18004c2e0 + lVar8 * 0xb;
      local_b0 = ppvVar7;
      if ((longlong)*ppvVar7 + 2U < 2) {
        *(undefined *)(ppvVar7 + 1) = 0x81;
        DVar3 = 0xfffffff5 - (local_b8 != 1);
        if (local_b8 == 0) {
          DVar3 = 0xfffffff6;
        }
        hFile = GetStdHandle(DVar3);
        if (((longlong)hFile + 1U < 2) || (DVar3 = GetFileType(hFile), DVar3 == 0)) {
          *(byte *)(ppvVar7 + 1) = *(byte *)(ppvVar7 + 1) | 0x40;
          *ppvVar7 = (HANDLE)0xfffffffffffffffe;
          if (DAT_18004cfe8 != 0) {
            *(undefined4 *)(*(longlong *)(DAT_18004cfe8 + lVar8 * 8) + 0x1c) = 0xfffffffe;
          }
        }
        else {
          *ppvVar7 = hFile;
          if ((DVar3 & 0xff) == 2) {
            bVar2 = *(byte *)(ppvVar7 + 1) | 0x40;
LAB_18002390e:
            *(byte *)(ppvVar7 + 1) = bVar2;
          }
          else {
            if ((DVar3 & 0xff) == 3) {
              bVar2 = *(byte *)(ppvVar7 + 1) | 8;
              goto LAB_18002390e;
            }
          }
          FUN_1800240dc((LPCRITICAL_SECTION)(ppvVar7 + 2),4000);
          *(int *)((longlong)ppvVar7 + 0xc) = *(int *)((longlong)ppvVar7 + 0xc) + 1;
        }
      }
      else {
        *(byte *)(ppvVar7 + 1) = *(byte *)(ppvVar7 + 1) | 0x80;
      }
      local_b8 = iVar10 + 1;
    }
    FUN_180024d08(0xb);
    uVar4 = 0;
  }
  return uVar4;
}



// Library Function - Single Match
//  _ioterm
// 
// Library: Visual Studio 2012 Release

void _ioterm(void)

{
  void *pvVar1;
  void *pvVar2;
  longlong lVar3;
  void **ppvVar4;
  
  ppvVar4 = (void **)&DAT_18004c2e0;
  lVar3 = 0x40;
  do {
    pvVar2 = *ppvVar4;
    pvVar1 = pvVar2;
    if (pvVar2 != (void *)0x0) {
      for (; pvVar2 < (void *)((longlong)pvVar1 + 0xb00); pvVar2 = (void *)((longlong)pvVar2 + 0x58)
          ) {
        if (*(int *)((longlong)pvVar2 + 0xc) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)((longlong)pvVar2 + 0x10));
        }
        pvVar1 = *ppvVar4;
      }
      free(*ppvVar4);
      *ppvVar4 = (void *)0x0;
    }
    ppvVar4 = ppvVar4 + 1;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _setargv
// 
// Library: Visual Studio 2012 Release

int _setargv(void)

{
  ulonglong uVar1;
  byte **ppbVar2;
  ulonglong uVar3;
  byte *pbVar4;
  ulonglong uVar5;
  int local_res8 [2];
  int local_res10 [2];
  
  if (_DAT_18004e148 == 0) {
    __initmbctable();
  }
  DAT_18004c5e4 = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_18004c4e0,0x104);
  _DAT_18004bcf0 = &DAT_18004c4e0;
  if ((DAT_18004e150 == (byte *)0x0) || (pbVar4 = DAT_18004e150, *DAT_18004e150 == 0)) {
    pbVar4 = &DAT_18004c4e0;
  }
  parse_cmdline(pbVar4,(byte **)0x0,(byte *)0x0,local_res8,local_res10);
  uVar5 = SEXT48(local_res8[0]);
  if ((((uVar5 < 0x1fffffffffffffff) &&
       (uVar3 = SEXT48(local_res10[0]), uVar3 != 0xffffffffffffffff)) &&
      (uVar1 = uVar3 + uVar5 * 8, uVar3 <= uVar1)) &&
     (ppbVar2 = (byte **)FUN_18001f5e8(uVar1), ppbVar2 != (byte **)0x0)) {
    parse_cmdline(pbVar4,ppbVar2,(byte *)(ppbVar2 + uVar5),local_res8,local_res10);
    _DAT_18004bccc = local_res8[0] + -1;
    DAT_18004bcd0 = ppbVar2;
    return 0;
  }
  return -1;
}



// Library Function - Single Match
//  parse_cmdline
// 
// Library: Visual Studio 2012 Release

void parse_cmdline(byte *param_1,byte **param_2,byte *param_3,int *param_4,int *param_5)

{
  bool bVar1;
  bool bVar2;
  undefined8 uVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (byte **)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  bVar2 = false;
  do {
    if (*param_1 == 0x22) {
      bVar2 = !bVar2;
      bVar7 = 0x22;
      pbVar5 = param_1 + 1;
    }
    else {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar7 = *param_1;
      pbVar5 = param_1 + 1;
      uVar3 = FUN_1800272bc((uint)bVar7);
      if ((int)uVar3 != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        pbVar5 = param_1 + 2;
      }
      if (bVar7 == 0) {
        pbVar5 = pbVar5 + -1;
        goto LAB_180023b9e;
      }
    }
    param_1 = pbVar5;
  } while ((bVar2) || ((bVar7 != 0x20 && (bVar7 != 9))));
  if (param_3 != (byte *)0x0) {
    param_3[-1] = 0;
  }
LAB_180023b9e:
  bVar2 = false;
  while (pbVar6 = pbVar5, *pbVar5 != 0) {
    for (; (*pbVar6 == 0x20 || (*pbVar6 == 9)); pbVar6 = pbVar6 + 1) {
    }
    if (*pbVar6 == 0) break;
    if (param_2 != (byte **)0x0) {
      *param_2 = param_3;
      param_2 = param_2 + 1;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar1 = true;
      uVar4 = 0;
      for (; *pbVar6 == 0x5c; pbVar6 = pbVar6 + 1) {
        uVar4 = uVar4 + 1;
      }
      pbVar5 = pbVar6;
      if (*pbVar6 == 0x22) {
        if (((uVar4 & 1) == 0) && ((!bVar2 || (pbVar5 = pbVar6 + 1, *pbVar5 != 0x22)))) {
          bVar1 = false;
          bVar2 = !bVar2;
          pbVar5 = pbVar6;
        }
        uVar4 = uVar4 >> 1;
      }
      while (uVar4 != 0) {
        uVar4 = uVar4 - 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar7 = *pbVar5;
      if ((bVar7 == 0) || ((!bVar2 && ((bVar7 == 0x20 || (bVar7 == 9)))))) break;
      if (bVar1) {
        uVar3 = FUN_1800272bc((int)(char)bVar7);
        if (param_3 == (byte *)0x0) {
          if ((int)uVar3 != 0) {
            pbVar5 = pbVar5 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if ((int)uVar3 != 0) {
            bVar7 = *pbVar5;
            pbVar5 = pbVar5 + 1;
            *param_3 = bVar7;
            param_3 = param_3 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar5;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar6 = pbVar5 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (param_2 != (byte **)0x0) {
    *param_2 = (byte *)0x0;
  }
  *param_4 = *param_4 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _setenvp
// 
// Library: Visual Studio 2012 Release

int _setenvp(void)

{
  char cVar1;
  code *pcVar2;
  errno_t eVar3;
  size_t sVar4;
  char *_Dst;
  char *pcVar5;
  int iVar6;
  char **ppcVar7;
  
  if (_DAT_18004e148 == 0) {
    __initmbctable();
  }
  iVar6 = 0;
  pcVar5 = DAT_18004bcb0;
  if (DAT_18004bcb0 != (char *)0x0) {
    for (; *pcVar5 != '\0'; pcVar5 = pcVar5 + sVar4 + 1) {
      if (*pcVar5 != '=') {
        iVar6 = iVar6 + 1;
      }
      sVar4 = strlen(pcVar5);
    }
    DAT_18004bce0 = (char **)FUN_18001f568((longlong)(iVar6 + 1),8);
    if (DAT_18004bce0 != (char **)0x0) {
      cVar1 = *DAT_18004bcb0;
      ppcVar7 = DAT_18004bce0;
      pcVar5 = DAT_18004bcb0;
      do {
        if (cVar1 == '\0') {
          free(DAT_18004bcb0);
          DAT_18004bcb0 = (char *)0x0;
          *ppcVar7 = (char *)0x0;
          _DAT_18004e14c = 1;
          return 0;
        }
        sVar4 = strlen(pcVar5);
        iVar6 = (int)sVar4 + 1;
        if (*pcVar5 != '=') {
          _Dst = (char *)FUN_18001f568((longlong)iVar6,1);
          *ppcVar7 = _Dst;
          if (_Dst == (char *)0x0) {
            free(DAT_18004bce0);
            DAT_18004bce0 = (char **)0x0;
            return -1;
          }
          eVar3 = strcpy_s(_Dst,(longlong)iVar6,pcVar5);
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar2 = (code *)swi(3);
            iVar6 = (*pcVar2)();
            return iVar6;
          }
          ppcVar7 = ppcVar7 + 1;
        }
        pcVar5 = pcVar5 + iVar6;
        cVar1 = *pcVar5;
      } while( true );
    }
  }
  return -1;
}



void FUN_180023de8(void)

{
  DWORD DVar1;
  _FILETIME local_res8;
  _FILETIME local_res10;
  uint local_res18;
  undefined4 uStackX28;
  
  local_res10 = (_FILETIME)0x0;
  if (DAT_180049180 == 0x2b992ddfa232) {
    GetSystemTimeAsFileTime((LPFILETIME)&local_res10);
    local_res8 = local_res10;
    DVar1 = GetCurrentThreadId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    DVar1 = GetCurrentProcessId();
    local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
    QueryPerformanceCounter((LARGE_INTEGER *)&local_res18);
    DAT_180049180 =
         ((ulonglong)local_res18 << 0x20 ^ CONCAT44(uStackX28,local_res18) ^ (ulonglong)local_res8 ^
         (ulonglong)&local_res8) & 0xffffffffffff;
    if (DAT_180049180 == 0x2b992ddfa232) {
      DAT_180049180 = 0x2b992ddfa233;
    }
  }
  DAT_180049188 = ~DAT_180049180;
  return;
}



// Library Function - Single Match
//  __crtGetEnvironmentStringsA
// 
// Library: Visual Studio 2012 Release

LPVOID __crtGetEnvironmentStringsA(void)

{
  WCHAR WVar1;
  int cbMultiByte;
  int iVar2;
  LPWCH lpWideCharStr;
  LPSTR lpMultiByteStr;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  
  lpWideCharStr = GetEnvironmentStringsW();
  if (lpWideCharStr != (LPWCH)0x0) {
    WVar1 = *lpWideCharStr;
    pWVar3 = lpWideCharStr;
    while (WVar1 != L'\0') {
      do {
        pWVar4 = pWVar3;
        pWVar3 = pWVar4 + 1;
      } while (*pWVar3 != L'\0');
      pWVar3 = pWVar4 + 2;
      WVar1 = *pWVar3;
    }
    iVar2 = (int)((longlong)((longlong)pWVar3 - (longlong)lpWideCharStr) >> 1);
    cbMultiByte = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,(LPSTR)0x0,0,(LPCSTR)0x0,
                                      (LPBOOL)0x0);
    if ((cbMultiByte != 0) &&
       (lpMultiByteStr = (LPSTR)FUN_18001f5e8((longlong)cbMultiByte), lpMultiByteStr != (LPSTR)0x0))
    {
      iVar2 = WideCharToMultiByte(0,0,lpWideCharStr,iVar2 + 1,lpMultiByteStr,cbMultiByte,(LPCSTR)0x0
                                  ,(LPBOOL)0x0);
      if (iVar2 == 0) {
        free(lpMultiByteStr);
        lpMultiByteStr = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return lpMultiByteStr;
    }
    FreeEnvironmentStringsW(lpWideCharStr);
  }
  return (LPSTR)0x0;
}



// Library Function - Single Match
//  __crtCaptureCurrentContext
// 
// Library: Visual Studio 2012 Release

void __crtCaptureCurrentContext(CONTEXT *pContextRecord)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18;
  
  RtlCaptureContext();
  ControlPc = pContextRecord->Rip;
  FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
  if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,(PCONTEXT)pContextRecord,&local_res18,
                     &local_res10,(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
  }
  return;
}



// Library Function - Single Match
//  __crtCapturePreviousContext
// 
// Library: Visual Studio 2012 Release

void __crtCapturePreviousContext(CONTEXT *pContextRecord)

{
  DWORD64 ControlPc;
  PRUNTIME_FUNCTION FunctionEntry;
  int iVar1;
  DWORD64 local_res8;
  ulonglong local_res10;
  PVOID local_res18 [2];
  
  RtlCaptureContext();
  ControlPc = pContextRecord->Rip;
  iVar1 = 0;
  do {
    FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
    if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
      return;
    }
    RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,(PCONTEXT)pContextRecord,local_res18,
                     &local_res10,(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 2);
  return;
}



void FUN_18002406c(void)

{
  if ((code *)(DAT_18004e020 ^ DAT_180049180) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x00018002407c. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004e020 ^ DAT_180049180))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002407f. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsAlloc();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_180024088(void)

{
  if ((code *)(DAT_18004e028 ^ DAT_180049180) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x000180024098. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004e028 ^ DAT_180049180))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x00018002409b. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsFree();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_1800240a4(void)

{
  if ((code *)(DAT_18004e030 ^ DAT_180049180) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800240b4. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004e030 ^ DAT_180049180))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800240b7. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsGetValue();
  return;
}



// WARNING: Exceeded maximum restarts with more pending

void FUN_1800240c0(void)

{
  if ((code *)(DAT_18004e038 ^ DAT_180049180) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800240d0. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(DAT_18004e038 ^ DAT_180049180))();
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001800240d3. Too many branches
                    // WARNING: Treating indirect jump as call
  TlsSetValue();
  return;
}



undefined8 FUN_1800240dc(LPCRITICAL_SECTION param_1,DWORD param_2)

{
  undefined8 uVar1;
  
  if ((code *)(DAT_18004e040 ^ DAT_180049180) != (code *)0x0) {
                    // WARNING: Could not recover jumptable at 0x0001800240f4. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*(code *)(DAT_18004e040 ^ DAT_180049180))();
    return uVar1;
  }
  InitializeCriticalSectionAndSpinCount(param_1,param_2);
  return 1;
}



bool FUN_180024108(void)

{
  int iVar1;
  bool bVar2;
  undefined4 local_res8 [8];
  
  bVar2 = DAT_180049388 < 0;
  if (!bVar2) goto LAB_180024149;
  local_res8[0] = 0;
  if ((code *)(DAT_18004e108 ^ DAT_180049180) == (code *)0x0) {
LAB_18002413f:
    DAT_180049388 = 0;
  }
  else {
    iVar1 = (*(code *)(DAT_18004e108 ^ DAT_180049180))(local_res8,0);
    DAT_180049388 = 1;
    if (iVar1 != 0x7a) goto LAB_18002413f;
  }
  bVar2 = false;
LAB_180024149:
  return DAT_180049388 != 0 && !bVar2;
}



void Sleep(DWORD dwMilliseconds)

{
                    // WARNING: Could not recover jumptable at 0x000180024550. Too many branches
                    // WARNING: Treating indirect jump as call
  Sleep(dwMilliseconds);
  return;
}



// Library Function - Single Match
//  __crtUnhandledException
// 
// Library: Visual Studio 2012 Release

LONG __crtUnhandledException(EXCEPTION_POINTERS *exceptionInfo)

{
  LONG LVar1;
  
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
                    // WARNING: Could not recover jumptable at 0x000180024591. Too many branches
                    // WARNING: Treating indirect jump as call
  LVar1 = UnhandledExceptionFilter((_EXCEPTION_POINTERS *)exceptionInfo);
  return LVar1;
}



void FUN_180024598(void)

{
  code **ppcVar1;
  
  for (ppcVar1 = (code **)&DAT_1800445f8; ppcVar1 < &DAT_1800445f8; ppcVar1 = ppcVar1 + 1) {
    if (*ppcVar1 != (code *)0x0) {
      (**ppcVar1)();
    }
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  realloc
// 
// Library: Visual Studio 2012 Release

void * realloc(void *_Memory,size_t _NewSize)

{
  int iVar1;
  DWORD DVar2;
  void *pvVar3;
  LPVOID pvVar4;
  int *piVar5;
  
  if (_Memory == (void *)0x0) {
    pvVar3 = malloc(_NewSize);
  }
  else {
    if (_NewSize == 0) {
      free(_Memory);
    }
    else {
      if (_NewSize < 0xffffffffffffffe1) {
        do {
          if (_NewSize == 0) {
            _NewSize = 1;
          }
          pvVar4 = HeapReAlloc(DAT_18004bd28,0,_Memory,_NewSize);
          if (pvVar4 != (LPVOID)0x0) {
            return pvVar4;
          }
          if (_DAT_18004cc28 == 0) {
            piVar5 = _errno();
            DVar2 = GetLastError();
            iVar1 = _get_errno_from_oserr(DVar2);
            *piVar5 = iVar1;
            return (void *)0x0;
          }
          iVar1 = _callnewh(_NewSize);
          if (iVar1 == 0) {
            piVar5 = _errno();
            DVar2 = GetLastError();
            iVar1 = _get_errno_from_oserr(DVar2);
            *piVar5 = iVar1;
            goto LAB_180024694;
          }
        } while (_NewSize < 0xffffffffffffffe1);
      }
      _callnewh(_NewSize);
      piVar5 = _errno();
      *piVar5 = 0xc;
    }
LAB_180024694:
    pvVar3 = (void *)0x0;
  }
  return pvVar3;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _FF_MSGBANNER
// 
// Library: Visual Studio 2012 Release

void _FF_MSGBANNER(void)

{
  int iVar1;
  
  iVar1 = _set_error_mode(3);
  if (iVar1 != 1) {
    iVar1 = _set_error_mode(3);
    if (iVar1 != 0) {
      return;
    }
    if (_DAT_18004c5f0 != 1) {
      return;
    }
  }
  _NMSG_WRITE(0xfc);
  _NMSG_WRITE(0xff);
  return;
}



// Library Function - Single Match
//  _GET_RTERRMSG
// 
// Library: Visual Studio 2012 Release

wchar_t * _GET_RTERRMSG(int param_1)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = &DAT_180032a00;
  do {
    if (param_1 == *piVar2) {
      return (wchar_t *)
             (&PTR_u_R6002___floating_point_support_n_180032a08)[(longlong)(int)uVar1 * 2];
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 4;
  } while (uVar1 < 0x17);
  return (wchar_t *)0x0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _NMSG_WRITE
// 
// Library: Visual Studio 2012 Release

void _NMSG_WRITE(int param_1)

{
  code *pcVar1;
  int iVar2;
  errno_t eVar3;
  DWORD DVar4;
  wchar_t *_Src;
  longlong lVar5;
  HANDLE hFile;
  size_t sVar6;
  char *pcVar7;
  uint uVar8;
  DWORD local_238 [4];
  char local_228 [499];
  undefined local_35;
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffd98;
  _Src = _GET_RTERRMSG(param_1);
  uVar8 = 0;
  if (_Src != (wchar_t *)0x0) {
    iVar2 = _set_error_mode(3);
    if (iVar2 != 1) {
      iVar2 = _set_error_mode(3);
      if ((iVar2 != 0) || (_DAT_18004c5f0 != 1)) {
        if (param_1 != 0xfc) {
          eVar3 = wcscpy_s((wchar_t *)&DAT_18004c600,0x314,L"Runtime Error!\n\nProgram: ");
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          _DAT_18004c83a = 0;
          DVar4 = GetModuleFileNameW((HMODULE)0x0,(LPWSTR)&DAT_18004c632,0x104);
          if (DVar4 == 0) {
            eVar3 = wcscpy_s((wchar_t *)&DAT_18004c632,0x2fb,L"<program name unknown>");
            if (eVar3 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          lVar5 = FUN_1800272d0((short *)&DAT_18004c632);
          if (0x3c < lVar5 + 1U) {
            lVar5 = FUN_1800272d0((short *)&DAT_18004c632);
            eVar3 = wcsncpy_s((wchar_t *)(&DAT_18004c5bc + lVar5 * 2),
                              0x2fb - (lVar5 * 2 + -0x76 >> 1),L"...",3);
            if (eVar3 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar1 = (code *)swi(3);
              (*pcVar1)();
              return;
            }
          }
          eVar3 = wcscat_s((wchar_t *)&DAT_18004c600,0x314,L"\n\n");
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          eVar3 = wcscat_s((wchar_t *)&DAT_18004c600,0x314,_Src);
          if (eVar3 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar1 = (code *)swi(3);
            (*pcVar1)();
            return;
          }
          FUN_1800273f8((LPCWSTR)&DAT_18004c600,L"Microsoft Visual C++ Runtime Library",0x12010);
        }
        goto LAB_18002492b;
      }
    }
    hFile = GetStdHandle(0xfffffff4);
    if ((longlong)hFile - 1U < 0xfffffffffffffffe) {
      pcVar7 = local_228;
      do {
        *pcVar7 = *(char *)_Src;
        if (*_Src == L'\0') break;
        uVar8 = uVar8 + 1;
        pcVar7 = pcVar7 + 1;
        _Src = _Src + 1;
      } while (uVar8 < 500);
      local_35 = 0;
      sVar6 = strlen(local_228);
      WriteFile(hFile,local_228,(DWORD)sVar6,local_238,(LPOVERLAPPED)0x0);
    }
  }
LAB_18002492b:
  FUN_18001d2f0(local_28 ^ (ulonglong)&stack0xfffffffffffffd98);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _calloc_impl
// 
// Library: Visual Studio 2012 Release

LPVOID _calloc_impl(ulonglong param_1,ulonglong param_2,undefined4 *param_3)

{
  int iVar1;
  int *piVar2;
  LPVOID pvVar3;
  ulonglong dwBytes;
  
  if ((param_1 == 0) || (param_2 <= 0xffffffffffffffe0 / param_1)) {
    dwBytes = param_2 * param_1;
    if (dwBytes == 0) {
      dwBytes = 1;
    }
    do {
      pvVar3 = (LPVOID)0x0;
      if ((dwBytes < 0xffffffffffffffe1) &&
         (pvVar3 = HeapAlloc(DAT_18004bd28,8,dwBytes), pvVar3 != (LPVOID)0x0)) {
        return pvVar3;
      }
      if (_DAT_18004cc28 == 0) {
        if (param_3 == (undefined4 *)0x0) {
          return pvVar3;
        }
        *param_3 = 0xc;
        return pvVar3;
      }
      iVar1 = _callnewh(dwBytes);
    } while (iVar1 != 0);
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = 0xc;
    }
  }
  else {
    piVar2 = _errno();
    *piVar2 = 0xc;
  }
  return (LPVOID)0x0;
}



// Library Function - Single Match
//  strlen
// 
// Library: Visual Studio

size_t strlen(char *_Str)

{
  char cVar1;
  ulonglong uVar2;
  ulonglong *puVar3;
  longlong lVar4;
  
  lVar4 = -(longlong)_Str;
  uVar2 = (ulonglong)_Str & 7;
  while (uVar2 != 0) {
    cVar1 = *_Str;
    _Str = (char *)((longlong)_Str + 1);
    if (cVar1 == '\0') goto LAB_180024ae8;
    uVar2 = (ulonglong)_Str & 7;
  }
  do {
    do {
      puVar3 = (ulonglong *)_Str;
      _Str = (char *)(puVar3 + 1);
    } while (((~*puVar3 ^ *puVar3 + 0x7efefefefefefeff) & 0x8101010101010100) == 0);
    uVar2 = *puVar3;
    if ((char)uVar2 == '\0') {
      return lVar4 + -8 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 8) == '\0') {
      return lVar4 + -7 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x10) == '\0') {
      return lVar4 + -6 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x18) == '\0') {
      return lVar4 + -5 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x20) == '\0') {
      return lVar4 + -4 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x28) == '\0') {
      return lVar4 + -3 + (longlong)_Str;
    }
    if ((char)(uVar2 >> 0x30) == '\0') {
      return lVar4 + -2 + (longlong)_Str;
    }
  } while ((char)(uVar2 >> 0x38) != '\0');
LAB_180024ae8:
  return lVar4 + -1 + (longlong)_Str;
}



// Library Function - Single Match
//  _lock
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void _lock(int _File)

{
  undefined8 uVar1;
  
  if (*(longlong *)((longlong)&DAT_180049390 + (longlong)_File * 0x10) == 0) {
    uVar1 = FUN_180024be4(_File);
    if ((int)uVar1 == 0) {
      _amsg_exit(0x11);
    }
  }
                    // WARNING: Could not recover jumptable at 0x000180024b55. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection(*(LPCRITICAL_SECTION *)((longlong)&DAT_180049390 + (longlong)_File * 0x10));
  return;
}



undefined8 FUN_180024be4(int param_1)

{
  LPCRITICAL_SECTION _Memory;
  int *piVar1;
  longlong lVar2;
  
  lVar2 = (longlong)param_1;
  if (DAT_18004bd28 == 0) {
    _FF_MSGBANNER();
    _NMSG_WRITE(0x1e);
    FUN_18001f058(0xff);
  }
  if (*(longlong *)((longlong)&DAT_180049390 + lVar2 * 0x10) == 0) {
    _Memory = (LPCRITICAL_SECTION)FUN_18001f5e8(0x28);
    if (_Memory == (LPCRITICAL_SECTION)0x0) {
      piVar1 = _errno();
      *piVar1 = 0xc;
      return 0;
    }
    _lock(10);
    if (*(longlong *)((longlong)&DAT_180049390 + lVar2 * 0x10) == 0) {
      FUN_1800240dc(_Memory,4000);
      *(LPCRITICAL_SECTION *)((longlong)&DAT_180049390 + lVar2 * 0x10) = _Memory;
    }
    else {
      free(_Memory);
    }
    LeaveCriticalSection(DAT_180049430);
  }
  return 1;
}



undefined4 FUN_180024ca4(void)

{
  longlong lVar1;
  LPCRITICAL_SECTION *pp_Var2;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  pp_Var2 = (LPCRITICAL_SECTION *)&DAT_180049390;
  lVar4 = 0x24;
  do {
    if (*(int *)(pp_Var2 + 1) == 1) {
      lVar1 = (longlong)iVar3;
      iVar3 = iVar3 + 1;
      *pp_Var2 = (LPCRITICAL_SECTION)(&DAT_18004cc30 + lVar1 * 0x28);
      FUN_1800240dc((LPCRITICAL_SECTION)(&DAT_18004cc30 + lVar1 * 0x28),4000);
    }
    pp_Var2 = pp_Var2 + 2;
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  return 1;
}



void FUN_180024d08(int param_1)

{
                    // WARNING: Could not recover jumptable at 0x000180024d19. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(*(LPCRITICAL_SECTION *)((longlong)&DAT_180049390 + (longlong)param_1 * 0x10))
  ;
  return;
}



// Library Function - Single Match
//  _FindPESection
// 
// Library: Visual Studio 2019 Release

PIMAGE_SECTION_HEADER _FindPESection(PBYTE pImageBase,DWORD_PTR rva)

{
  PIMAGE_SECTION_HEADER p_Var1;
  PBYTE pBVar2;
  uint uVar3;
  
  uVar3 = 0;
  pBVar2 = pImageBase + *(int *)(pImageBase + 0x3c);
  p_Var1 = (PIMAGE_SECTION_HEADER)(pBVar2 + (ulonglong)*(ushort *)(pBVar2 + 0x14) + 0x18);
  if (*(ushort *)(pBVar2 + 6) != 0) {
    do {
      if ((p_Var1->VirtualAddress <= rva) && (rva < p_Var1->Misc + p_Var1->VirtualAddress)) {
        return p_Var1;
      }
      uVar3 = uVar3 + 1;
      p_Var1 = p_Var1 + 1;
    } while (uVar3 < *(ushort *)(pBVar2 + 6));
  }
  return (PIMAGE_SECTION_HEADER)0x0;
}



// Library Function - Single Match
//  _IsNonwritableInCurrentImage
// 
// Library: Visual Studio 2019 Release

BOOL _IsNonwritableInCurrentImage(PBYTE pTarget)

{
  uint uVar1;
  PIMAGE_SECTION_HEADER p_Var2;
  
  uVar1 = _ValidateImageBase((PBYTE)&IMAGE_DOS_HEADER_180000000);
  p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)uVar1;
  if (uVar1 != 0) {
    p_Var2 = _FindPESection((PBYTE)&IMAGE_DOS_HEADER_180000000,(DWORD_PTR)(pTarget + -0x180000000));
    if (p_Var2 != (PIMAGE_SECTION_HEADER)0x0) {
      p_Var2 = (PIMAGE_SECTION_HEADER)(ulonglong)(~(p_Var2->Characteristics >> 0x1f) & 1);
    }
  }
  return (BOOL)p_Var2;
}



// Library Function - Single Match
//  _ValidateImageBase
// 
// Library: Visual Studio 2015 Release

BOOL _ValidateImageBase(PBYTE pImageBase)

{
  uint uVar1;
  
  if (*(short *)pImageBase != 0x5a4d) {
    return 0;
  }
  uVar1 = 0;
  if (*(int *)(pImageBase + *(int *)(pImageBase + 0x3c)) == 0x4550) {
    uVar1 = (uint)(*(short *)((longlong)(pImageBase + *(int *)(pImageBase + 0x3c)) + 0x18) == 0x20b)
    ;
  }
  return (BOOL)uVar1;
}



// Library Function - Single Match
//  _initp_misc_cfltcvt_tab
// 
// Library: Visual Studio 2012 Release

void _initp_misc_cfltcvt_tab(void)

{
  undefined *puVar1;
  undefined **ppuVar2;
  uint uVar3;
  
  uVar3 = 0;
  ppuVar2 = &PTR_LAB_1800495d0;
  do {
    puVar1 = (undefined *)EncodePointer(*ppuVar2);
    uVar3 = uVar3 + 1;
    *ppuVar2 = puVar1;
    ppuVar2 = ppuVar2 + 1;
  } while (uVar3 < 10);
  return;
}



void FUN_180024e2c(void)

{
                    // WARNING: Could not recover jumptable at 0x000180024e33. Too many branches
                    // WARNING: Treating indirect jump as call
  DecodePointer(DAT_18004ce70);
  return;
}



void FUN_180024e3c(undefined8 param_1)

{
  DAT_18004ce60 = param_1;
  DAT_18004ce68 = param_1;
  DAT_18004ce70 = param_1;
  DAT_18004ce78 = param_1;
  return;
}



undefined8 FUN_180024e5c(uint param_1)

{
  void *pvVar1;
  bool bVar2;
  int *piVar3;
  _ptiddata p_Var4;
  code *pcVar5;
  undefined8 uVar6;
  code *pcVar7;
  void *pvVar8;
  PVOID Ptr;
  int iVar9;
  void *pvVar10;
  code **ppcVar11;
  int local_res10;
  
  pvVar10 = (void *)0x0;
  local_res10 = 0;
  bVar2 = false;
  p_Var4 = (_ptiddata)0x0;
  if (param_1 == 2) {
    ppcVar11 = (code **)&DAT_18004ce60;
    Ptr = DAT_18004ce60;
    goto LAB_180024f62;
  }
  if (param_1 == 4) {
LAB_180024ef7:
    p_Var4 = _getptd_noexit();
    if (p_Var4 == (_ptiddata)0x0) {
      return 0xffffffff;
    }
    pvVar1 = p_Var4->_pxcptacttab;
    pvVar8 = pvVar1;
    do {
      if (*(uint *)((longlong)pvVar8 + 4) == param_1) break;
      pvVar8 = (void *)((longlong)pvVar8 + 0x10);
    } while (pvVar8 < (void *)((longlong)pvVar1 + 0xc0));
    if (((void *)((longlong)pvVar1 + 0xc0) <= pvVar8) ||
       (*(uint *)((longlong)pvVar8 + 4) != param_1)) {
      pvVar8 = (void *)0x0;
    }
    ppcVar11 = (code **)((longlong)pvVar8 + 8);
    pcVar5 = *ppcVar11;
  }
  else {
    if (param_1 == 6) {
LAB_180024ee7:
      ppcVar11 = (code **)&DAT_18004ce70;
      Ptr = DAT_18004ce70;
    }
    else {
      if ((param_1 == 8) || (param_1 == 0xb)) goto LAB_180024ef7;
      if (param_1 == 0xf) {
        ppcVar11 = (code **)&DAT_18004ce78;
        Ptr = DAT_18004ce78;
      }
      else {
        if (param_1 != 0x15) {
          if (param_1 != 0x16) {
            piVar3 = _errno();
            *piVar3 = 0x16;
            FUN_18001fee8();
            return 0xffffffff;
          }
          goto LAB_180024ee7;
        }
        ppcVar11 = (code **)&DAT_18004ce68;
        Ptr = DAT_18004ce68;
      }
    }
LAB_180024f62:
    bVar2 = true;
    pcVar5 = (code *)DecodePointer(Ptr);
  }
  if (pcVar5 == (code *)0x1) {
    return 0;
  }
  if (pcVar5 == (code *)0x0) {
    FUN_18001f288(3);
    pcVar5 = (code *)swi(3);
    uVar6 = (*pcVar5)();
    return uVar6;
  }
  if (bVar2) {
    _lock(0);
  }
  if ((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) {
    pvVar10 = p_Var4->_tpxcptinfoptrs;
    p_Var4->_tpxcptinfoptrs = (void *)0x0;
    if (param_1 == 8) {
      local_res10 = p_Var4->_tfpecode;
      p_Var4->_tfpecode = 0x8c;
      goto LAB_180024fda;
    }
  }
  else {
LAB_180024fda:
    if (param_1 == 8) {
      for (iVar9 = 3; iVar9 < 0xc; iVar9 = iVar9 + 1) {
        *(undefined8 *)((longlong)p_Var4->_pxcptacttab + (longlong)iVar9 * 0x10 + 8) = 0;
      }
      goto LAB_180025023;
    }
  }
  pcVar7 = (code *)EncodePointer((PVOID)0x0);
  *ppcVar11 = pcVar7;
LAB_180025023:
  if (bVar2) {
    FUN_180024d08(0);
  }
  if (param_1 == 8) {
    (*pcVar5)(8,p_Var4->_tfpecode);
  }
  else {
    (*pcVar5)(param_1);
  }
  if (((param_1 < 0xc) && ((0x910U >> (param_1 & 0x1f) & 1) != 0)) &&
     (p_Var4->_tpxcptinfoptrs = pvVar10, param_1 == 8)) {
    p_Var4->_tfpecode = local_res10;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_180025090(undefined8 param_1)

{
  _DAT_18004ce88 = param_1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __initmbctable
// 
// Library: Visual Studio 2012 Release

undefined8 __initmbctable(void)

{
  if (_DAT_18004e148 == 0) {
    FUN_180025470(-3);
    _DAT_18004e148 = 1;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  int __cdecl getSystemCP(int)
// 
// Library: Visual Studio 2012 Release

int getSystemCP(int param_1)

{
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)0x0);
  _DAT_18004ceb0 = 0;
  if (param_1 == -2) {
    _DAT_18004ceb0 = 1;
    param_1 = GetOEMCP();
  }
  else {
    if (param_1 == -3) {
      _DAT_18004ceb0 = 1;
      param_1 = GetACP();
    }
    else {
      if (param_1 == -4) {
        _DAT_18004ceb0 = 1;
        param_1 = *(UINT *)(local_28[0] + 4);
      }
    }
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return param_1;
}



// Library Function - Single Match
//  void __cdecl setSBCS(struct threadmbcinfostruct * __ptr64)
// 
// Library: Visual Studio 2012 Release

void setSBCS(threadmbcinfostruct *param_1)

{
  longlong lVar1;
  uchar *puVar2;
  undefined (*pauVar3) [16];
  longlong lVar4;
  ushort *puVar5;
  
  pauVar3 = (undefined (*) [16])param_1->mbctype;
  lVar4 = 0x101;
  FUN_18001d980(pauVar3,0,0x101);
  *(undefined8 *)&param_1->mbcodepage = 0;
  param_1->mblocalename = (wchar_t *)0x0;
  puVar5 = param_1->mbulinfo;
  for (lVar1 = 6; lVar1 != 0; lVar1 = lVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  do {
    (*pauVar3)[0] =
         ((undefined *)((longlong)&DAT_180049830 + -(longlong)param_1))[(longlong)pauVar3];
    pauVar3 = (undefined (*) [16])(*pauVar3 + 1);
    lVar4 = lVar4 + -1;
  } while (lVar4 != 0);
  puVar2 = param_1->mbcasemap;
  lVar1 = 0x100;
  do {
    *puVar2 = puVar2[(longlong)(undefined *)((longlong)&DAT_180049830 + -(longlong)param_1)];
    puVar2 = puVar2 + 1;
    lVar1 = lVar1 + -1;
  } while (lVar1 != 0);
  return;
}



// Library Function - Single Match
//  void __cdecl setSBUpLow(struct threadmbcinfostruct * __ptr64)
// 
// Library: Visual Studio 2012 Release

void setSBUpLow(threadmbcinfostruct *param_1)

{
  byte bVar1;
  BOOL BVar2;
  uint uVar3;
  CHAR *pCVar4;
  ulonglong uVar5;
  byte *pbVar6;
  WORD *pWVar7;
  longlong lVar8;
  _cpinfo local_538;
  CHAR local_518 [232];
  byte abStack1072 [24];
  CHAR local_418 [232];
  byte abStack816 [24];
  CHAR local_318 [256];
  WORD local_218 [256];
  ulonglong local_18;
  
  local_18 = DAT_180049180 ^ (ulonglong)&stack0xfffffffffffffa78;
  BVar2 = GetCPInfo(param_1->mbcodepage,(LPCPINFO)&local_538);
  lVar8 = 0x100;
  if (BVar2 == 0) {
    uVar3 = 0;
    pbVar6 = param_1->mbctype;
    do {
      pbVar6 = pbVar6 + 1;
      if (uVar3 - 0x41 < 0x1a) {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = (char)uVar3 + 0x20;
LAB_180025375:
        pbVar6[0x100] = bVar1;
      }
      else {
        if (uVar3 - 0x61 < 0x1a) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = (char)uVar3 - 0x20;
          goto LAB_180025375;
        }
        pbVar6[0x100] = 0;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < 0x100);
  }
  else {
    uVar3 = 0;
    pCVar4 = local_518;
    do {
      *pCVar4 = (CHAR)uVar3;
      uVar3 = uVar3 + 1;
      pCVar4 = pCVar4 + 1;
    } while (uVar3 < 0x100);
    local_518[0] = ' ';
    pbVar6 = local_538.LeadByte;
    while (local_538.LeadByte[0] != 0) {
      bVar1 = pbVar6[1];
      uVar5 = (ulonglong)local_538.LeadByte[0];
      while ((uVar3 = (uint)uVar5, uVar3 <= bVar1 && (uVar3 < 0x100))) {
        local_518[uVar5] = ' ';
        uVar5 = (ulonglong)(uVar3 + 1);
      }
      pbVar6 = pbVar6 + 2;
      local_538.LeadByte[0] = *pbVar6;
    }
    __crtGetStringTypeA((_locale_t)0x0,1,local_518,0x100,local_218,param_1->mbcodepage,0);
    __crtLCMapStringA((_locale_t)0x0,param_1->mblocalename,0x100,local_518,0x100,local_418,0x100,
                      param_1->mbcodepage,0);
    __crtLCMapStringA((_locale_t)0x0,param_1->mblocalename,0x200,local_518,0x100,local_318,0x100,
                      param_1->mbcodepage,0);
    pWVar7 = local_218;
    pbVar6 = param_1->mbctype;
    do {
      pbVar6 = pbVar6 + 1;
      if ((*(byte *)pWVar7 & 1) == 0) {
        if ((*(byte *)pWVar7 & 2) != 0) {
          *pbVar6 = *pbVar6 | 0x20;
          bVar1 = pbVar6[(longlong)(local_418 + (0xe7 - (longlong)param_1))];
          goto LAB_180025331;
        }
        pbVar6[0x100] = 0;
      }
      else {
        *pbVar6 = *pbVar6 | 0x10;
        bVar1 = pbVar6[(longlong)(local_518 + (0xe7 - (longlong)param_1))];
LAB_180025331:
        pbVar6[0x100] = bVar1;
      }
      pWVar7 = pWVar7 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
  }
  FUN_18001d2f0(local_18 ^ (ulonglong)&stack0xfffffffffffffa78);
  return;
}



// Library Function - Single Match
//  __updatetmbcinfo
// 
// Library: Visual Studio 2012 Release

pthreadmbcinfo __updatetmbcinfo(void)

{
  _ptiddata p_Var1;
  pthreadmbcinfo _Memory;
  
  p_Var1 = _getptd();
  if (((p_Var1->_ownlocale & DAT_18004a358) == 0) || (p_Var1->ptlocinfo == (pthreadlocinfo)0x0)) {
    _lock(0xd);
    _Memory = p_Var1->ptmbcinfo;
    if (_Memory != (pthreadmbcinfo)PTR_DAT_180049b50) {
      if (_Memory != (pthreadmbcinfo)0x0) {
        LOCK();
        _Memory->refcount = _Memory->refcount + -1;
        if ((_Memory->refcount == 0) && (_Memory != (pthreadmbcinfo)&DAT_180049830)) {
          free(_Memory);
        }
      }
      p_Var1->ptmbcinfo = (pthreadmbcinfo)PTR_DAT_180049b50;
      _Memory = (pthreadmbcinfo)PTR_DAT_180049b50;
      LOCK();
      *(int *)PTR_DAT_180049b50 = *(int *)PTR_DAT_180049b50 + 1;
    }
    FUN_180024d08(0xd);
  }
  else {
    _Memory = p_Var1->ptmbcinfo;
  }
  if (_Memory == (pthreadmbcinfo)0x0) {
    _amsg_exit(0x20);
  }
  return _Memory;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

int FUN_180025470(int param_1)

{
  pthreadmbcinfo ptVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  threadmbcinfostruct *ptVar5;
  int iVar6;
  int iVar7;
  _ptiddata p_Var8;
  threadmbcinfostruct *_Memory;
  pthreadmbcinfo ptVar9;
  int *piVar10;
  threadmbcinfostruct *ptVar11;
  int iVar12;
  longlong lVar13;
  int iVar14;
  
  iVar7 = -1;
  p_Var8 = _getptd();
  __updatetmbcinfo();
  ptVar1 = p_Var8->ptmbcinfo;
  iVar6 = getSystemCP(param_1);
  if (iVar6 == ptVar1->mbcodepage) {
    iVar7 = 0;
  }
  else {
    _Memory = (threadmbcinfostruct *)FUN_18001f5e8(0x228);
    iVar14 = 0;
    if (_Memory != (threadmbcinfostruct *)0x0) {
      lVar13 = 4;
      ptVar1 = p_Var8->ptmbcinfo;
      ptVar5 = _Memory;
      do {
        ptVar11 = ptVar5;
        ptVar9 = ptVar1;
        iVar7 = ptVar9->mbcodepage;
        iVar12 = ptVar9->ismbcodepage;
        uVar2 = *(undefined4 *)ptVar9->mbulinfo;
        ptVar11->refcount = ptVar9->refcount;
        ptVar11->mbcodepage = iVar7;
        ptVar11->ismbcodepage = iVar12;
        *(undefined4 *)ptVar11->mbulinfo = uVar2;
        uVar2 = *(undefined4 *)(ptVar9->mbulinfo + 4);
        uVar3 = *(undefined4 *)ptVar9->mbctype;
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 4);
        *(undefined4 *)(ptVar11->mbulinfo + 2) = *(undefined4 *)(ptVar9->mbulinfo + 2);
        *(undefined4 *)(ptVar11->mbulinfo + 4) = uVar2;
        *(undefined4 *)ptVar11->mbctype = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 4) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0xc);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x10);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x14);
        *(undefined4 *)(ptVar11->mbctype + 8) = *(undefined4 *)(ptVar9->mbctype + 8);
        *(undefined4 *)(ptVar11->mbctype + 0xc) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x10) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x14) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x1c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x20);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x24);
        *(undefined4 *)(ptVar11->mbctype + 0x18) = *(undefined4 *)(ptVar9->mbctype + 0x18);
        *(undefined4 *)(ptVar11->mbctype + 0x1c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x20) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x24) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x2c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x30);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x34);
        *(undefined4 *)(ptVar11->mbctype + 0x28) = *(undefined4 *)(ptVar9->mbctype + 0x28);
        *(undefined4 *)(ptVar11->mbctype + 0x2c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x30) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x34) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x3c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x40);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x44);
        *(undefined4 *)(ptVar11->mbctype + 0x38) = *(undefined4 *)(ptVar9->mbctype + 0x38);
        *(undefined4 *)(ptVar11->mbctype + 0x3c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x40) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x44) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x4c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x50);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x54);
        *(undefined4 *)(ptVar11->mbctype + 0x48) = *(undefined4 *)(ptVar9->mbctype + 0x48);
        *(undefined4 *)(ptVar11->mbctype + 0x4c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x50) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 0x54) = uVar4;
        uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x5c);
        uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x60);
        uVar4 = *(undefined4 *)(ptVar9->mbctype + 100);
        *(undefined4 *)(ptVar11->mbctype + 0x58) = *(undefined4 *)(ptVar9->mbctype + 0x58);
        *(undefined4 *)(ptVar11->mbctype + 0x5c) = uVar2;
        *(undefined4 *)(ptVar11->mbctype + 0x60) = uVar3;
        *(undefined4 *)(ptVar11->mbctype + 100) = uVar4;
        lVar13 = lVar13 + -1;
        ptVar1 = (pthreadmbcinfo)(ptVar9->mbctype + 0x68);
        ptVar5 = (threadmbcinfostruct *)(ptVar11->mbctype + 0x68);
      } while (lVar13 != 0);
      uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x6c);
      uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x70);
      uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x74);
      ((threadmbcinfostruct *)(ptVar11->mbctype + 0x68))->refcount =
           ((pthreadmbcinfo)(ptVar9->mbctype + 0x68))->refcount;
      *(undefined4 *)(ptVar11->mbctype + 0x6c) = uVar2;
      *(undefined4 *)(ptVar11->mbctype + 0x70) = uVar3;
      *(undefined4 *)(ptVar11->mbctype + 0x74) = uVar4;
      uVar2 = *(undefined4 *)(ptVar9->mbctype + 0x7c);
      uVar3 = *(undefined4 *)(ptVar9->mbctype + 0x80);
      uVar4 = *(undefined4 *)(ptVar9->mbctype + 0x84);
      *(undefined4 *)(ptVar11->mbctype + 0x78) = *(undefined4 *)(ptVar9->mbctype + 0x78);
      *(undefined4 *)(ptVar11->mbctype + 0x7c) = uVar2;
      *(undefined4 *)(ptVar11->mbctype + 0x80) = uVar3;
      *(undefined4 *)(ptVar11->mbctype + 0x84) = uVar4;
      *(undefined8 *)(ptVar11->mbctype + 0x88) = *(undefined8 *)(ptVar9->mbctype + 0x88);
      _Memory->refcount = 0;
      iVar7 = FUN_1800256b4(iVar6,_Memory);
      if (iVar7 == 0) {
        ptVar1 = p_Var8->ptmbcinfo;
        LOCK();
        ptVar1->refcount = ptVar1->refcount + -1;
        if ((ptVar1->refcount == 0) && (p_Var8->ptmbcinfo != (pthreadmbcinfo)&DAT_180049830)) {
          free(p_Var8->ptmbcinfo);
        }
        p_Var8->ptmbcinfo = (pthreadmbcinfo)_Memory;
        LOCK();
        _Memory->refcount = _Memory->refcount + 1;
        if (((*(byte *)&p_Var8->_ownlocale & 2) == 0) && (((byte)DAT_18004a358 & 1) == 0)) {
          _lock(0xd);
          _DAT_18004ce90 = _Memory->mbcodepage;
          _DAT_18004ce94 = _Memory->ismbcodepage;
          _DAT_18004cea8 = _Memory->mblocalename;
          for (iVar6 = iVar14; iVar12 = iVar14, iVar6 < 5; iVar6 = iVar6 + 1) {
            *(ushort *)((longlong)&DAT_18004ce98 + (longlong)iVar6 * 2) = _Memory->mbulinfo[iVar6];
          }
          for (; iVar12 < 0x101; iVar12 = iVar12 + 1) {
            (&DAT_180049620)[iVar12] = _Memory->mbctype[iVar12];
          }
          for (; iVar14 < 0x100; iVar14 = iVar14 + 1) {
            (&DAT_180049730)[iVar14] = _Memory->mbcasemap[iVar14];
          }
          LOCK();
          iVar6 = *(int *)PTR_DAT_180049b50;
          *(int *)PTR_DAT_180049b50 = *(int *)PTR_DAT_180049b50 + -1;
          if ((iVar6 == 1) && ((undefined4 *)PTR_DAT_180049b50 != &DAT_180049830)) {
            free(PTR_DAT_180049b50);
          }
          LOCK();
          PTR_DAT_180049b50 = (undefined *)_Memory;
          _Memory->refcount = _Memory->refcount + 1;
          FUN_180024d08(0xd);
        }
      }
      else {
        if (iVar7 == -1) {
          if (_Memory != (threadmbcinfostruct *)&DAT_180049830) {
            free(_Memory);
          }
          piVar10 = _errno();
          *piVar10 = 0x16;
        }
      }
    }
  }
  return iVar7;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800256b4(int param_1,threadmbcinfostruct *param_2)

{
  byte bVar1;
  int iVar2;
  uint CodePage;
  BOOL BVar3;
  uint *puVar4;
  byte *pbVar5;
  wchar_t *pwVar6;
  ulonglong uVar7;
  longlong lVar8;
  ushort *puVar9;
  byte *pbVar10;
  byte *pbVar11;
  uint uVar12;
  uint uVar14;
  undefined auStack104 [32];
  _cpinfo local_48;
  ulonglong local_30;
  wchar_t *pwVar13;
  
  local_30 = DAT_180049180 ^ (ulonglong)auStack104;
  CodePage = getSystemCP(param_1);
  pwVar6 = (wchar_t *)0x0;
  if (CodePage != 0) {
    puVar4 = &DAT_180049a60;
    pwVar13 = pwVar6;
LAB_180025708:
    if (*puVar4 != CodePage) goto code_r0x000180025710;
    FUN_18001d980((undefined (*) [16])param_2->mbctype,0,0x101);
    pbVar5 = &DAT_180049a58;
    lVar8 = 4;
    pbVar10 = &DAT_180049a70 + (longlong)pwVar13 * 0x30;
    do {
      bVar1 = *pbVar10;
      pbVar11 = pbVar10;
      while ((bVar1 != 0 && (pbVar11[1] != 0))) {
        bVar1 = *pbVar11;
        uVar12 = (uint)bVar1;
        if (bVar1 <= pbVar11[1]) {
          uVar14 = (uint)bVar1;
          do {
            uVar14 = uVar14 + 1;
            if (0x100 < uVar14) break;
            uVar12 = uVar12 + 1;
            param_2->mbctype[uVar14] = param_2->mbctype[uVar14] | *pbVar5;
          } while (uVar12 <= pbVar11[1]);
        }
        pbVar11 = pbVar11 + 2;
        bVar1 = *pbVar11;
      }
      pbVar10 = pbVar10 + 8;
      pbVar5 = pbVar5 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    param_2->mbcodepage = CodePage;
    param_2->ismbcodepage = 1;
    if (CodePage == 0x3a4) {
      pwVar6 = L"ja-JP";
    }
    else {
      if (CodePage == 0x3a8) {
        pwVar6 = L"zh-CN";
      }
      else {
        if (CodePage == 0x3b5) {
          pwVar6 = L"ko-KR";
        }
        else {
          if (CodePage == 0x3b6) {
            pwVar6 = L"zh-TW";
          }
        }
      }
    }
    param_2->mblocalename = pwVar6;
    puVar9 = param_2->mbulinfo;
    lVar8 = 6;
    do {
      *puVar9 = *(ushort *)
                 ((longlong)&DAT_180049a58 + ((longlong)pwVar13 * 0x30 - (longlong)param_2) +
                 (longlong)puVar9);
      puVar9 = puVar9 + 1;
      lVar8 = lVar8 + -1;
    } while (lVar8 != 0);
    goto LAB_180025932;
  }
LAB_1800256e9:
  setSBCS(param_2);
LAB_18002593c:
  FUN_18001d2f0(local_30 ^ (ulonglong)auStack104);
  return;
code_r0x000180025710:
  uVar12 = (int)pwVar13 + 1;
  pwVar13 = (wchar_t *)(ulonglong)uVar12;
  puVar4 = puVar4 + 0xc;
  if (4 < uVar12) goto code_r0x00018002571c;
  goto LAB_180025708;
code_r0x00018002571c:
  if ((CodePage - 65000 < 2) || (BVar3 = IsValidCodePage(CodePage & 0xffff), BVar3 == 0))
  goto LAB_18002593c;
  BVar3 = GetCPInfo(CodePage,(LPCPINFO)&local_48);
  if (BVar3 != 0) {
    FUN_18001d980((undefined (*) [16])param_2->mbctype,0,0x101);
    param_2->mbcodepage = CodePage;
    param_2->mblocalename = (wchar_t *)0x0;
    if (local_48.MaxCharSize < 2) {
      param_2->ismbcodepage = 0;
    }
    else {
      pbVar10 = local_48.LeadByte;
      while ((local_48.LeadByte[0] != 0 && (pbVar10[1] != 0))) {
        bVar1 = *pbVar10;
        if (bVar1 <= pbVar10[1]) {
          pbVar5 = param_2->mbctype + (bVar1 + 1);
          uVar7 = (ulonglong)(((uint)pbVar10[1] - (uint)bVar1) + 1);
          do {
            *pbVar5 = *pbVar5 | 4;
            pbVar5 = pbVar5 + 1;
            uVar7 = uVar7 - 1;
          } while (uVar7 != 0);
        }
        pbVar10 = pbVar10 + 2;
        local_48.LeadByte[0] = *pbVar10;
      }
      pbVar10 = param_2->mbctype + 2;
      lVar8 = 0xfe;
      do {
        *pbVar10 = *pbVar10 | 8;
        pbVar10 = pbVar10 + 1;
        lVar8 = lVar8 + -1;
      } while (lVar8 != 0);
      iVar2 = param_2->mbcodepage;
      if (iVar2 == 0x3a4) {
        pwVar6 = L"ja-JP";
      }
      else {
        if (iVar2 == 0x3a8) {
          pwVar6 = L"zh-CN";
        }
        else {
          if (iVar2 == 0x3b5) {
            pwVar6 = L"ko-KR";
          }
          else {
            if (iVar2 == 0x3b6) {
              pwVar6 = L"zh-TW";
            }
          }
        }
      }
      param_2->mblocalename = pwVar6;
      param_2->ismbcodepage = 1;
    }
    puVar9 = param_2->mbulinfo;
    for (lVar8 = 6; lVar8 != 0; lVar8 = lVar8 + -1) {
      *puVar9 = 0;
      puVar9 = puVar9 + 1;
    }
LAB_180025932:
    setSBUpLow(param_2);
    goto LAB_18002593c;
  }
  if (_DAT_18004ceb0 == 0) goto LAB_18002593c;
  goto LAB_1800256e9;
}



void FUN_180025980(PVOID param_1,PVOID param_2)

{
  RtlUnwindEx(param_1,param_2,(PEXCEPTION_RECORD)0x0,(PVOID)0x0,(PCONTEXT)&stack0xfffffffffffffb28,
              (PUNWIND_HISTORY_TABLE)0x0);
  return;
}



void FUN_1800259b0(void)

{
  return;
}



void FUN_1800259e0(void)

{
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_1800259e4(void)

{
  _DAT_18004e000 = 0;
  return;
}



undefined ** FUN_180025ab4(void)

{
  return &PTR_DAT_180049b60;
}



// Library Function - Single Match
//  _lock_file
// 
// Library: Visual Studio 2012 Release

void _lock_file(FILE *_File)

{
  if (((FILE *)0x180049b5f < _File) && (_File < (FILE *)0x180049ef1)) {
    _lock((int)((longlong)(_File + -0x8001892) / 0x30) + 0x10);
    _File->_flag = _File->_flag | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180025b1a. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



// Library Function - Single Match
//  _lock_file2
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void _lock_file2(int _Index,void *_File)

{
  if (_Index < 0x14) {
    _lock(_Index + 0x10);
    *(uint *)((longlong)_File + 0x18) = *(uint *)((longlong)_File + 0x18) | 0x8000;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180025b4e. Too many branches
                    // WARNING: Treating indirect jump as call
  EnterCriticalSection((LPCRITICAL_SECTION)((longlong)_File + 0x30));
  return;
}



// Library Function - Single Match
//  _unlock_file
// 
// Library: Visual Studio 2012 Release

void _unlock_file(FILE *_File)

{
  if (((FILE *)0x180049b5f < _File) && (_File < (FILE *)0x180049ef1)) {
    _File->_flag = _File->_flag & 0xffff7fff;
    FUN_180024d08((int)((longlong)(_File + -0x8001892) / 0x30) + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180025b9f. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



void FUN_180025ba8(int param_1,longlong param_2)

{
  if (param_1 < 0x14) {
    *(uint *)(param_2 + 0x18) = *(uint *)(param_2 + 0x18) & 0xffff7fff;
    FUN_180024d08(param_1 + 0x10);
    return;
  }
                    // WARNING: Could not recover jumptable at 0x000180025bbe. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x30));
  return;
}



// Library Function - Single Match
//  _fileno
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _fileno(FILE *_File)

{
  int iVar1;
  int *piVar2;
  
  if (_File == (FILE *)0x0) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18001fee8();
    iVar1 = -1;
  }
  else {
    iVar1 = _File->_file;
  }
  return iVar1;
}



// Library Function - Single Match
//  _isatty
// 
// Library: Visual Studio 2010 Release

int _isatty(int _FileHandle)

{
  int *piVar1;
  
  if (_FileHandle == -2) {
    piVar1 = _errno();
    *piVar1 = 9;
  }
  else {
    if ((-1 < _FileHandle) && ((uint)_FileHandle < DAT_18004e128)) {
      return (int)*(char *)(*(longlong *)
                             ((longlong)&DAT_18004c2e0 + ((longlong)_FileHandle >> 5) * 8) + 8 +
                           (ulonglong)(_FileHandle & 0x1f) * 0x58) & 0x40;
    }
    piVar1 = _errno();
    *piVar1 = 9;
    FUN_18001fee8();
  }
  return (int)0;
}



undefined4 FUN_180025c50(uint param_1,wint_t *param_2,uint param_3)

{
  undefined4 uVar1;
  ulong *puVar2;
  int *piVar3;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    puVar2 = __doserrno();
    *puVar2 = 0;
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004e128)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar4) & 1) != 0) {
        FUN_180027e54(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar4) & 1) == 0) {
          piVar3 = _errno();
          *piVar3 = 9;
          puVar2 = __doserrno();
          *puVar2 = 0;
          uVar1 = 0xffffffff;
        }
        else {
          uVar1 = FUN_180025d34(param_1,param_2,param_3);
        }
        FUN_18002800c(param_1);
        return uVar1;
      }
    }
    puVar2 = __doserrno();
    *puVar2 = 0;
    piVar3 = _errno();
    *piVar3 = 9;
    FUN_18001fee8();
  }
  return 0xffffffff;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_180025d34(uint param_1,wint_t *param_2,uint param_3)

{
  char cVar1;
  wchar_t *pwVar2;
  uint uVar3;
  wint_t wVar4;
  int iVar5;
  BOOL BVar6;
  int iVar7;
  DWORD nNumberOfBytesToWrite;
  DWORD DVar8;
  ulong *puVar9;
  int *piVar10;
  _ptiddata p_Var11;
  ulonglong uVar12;
  uint uVar13;
  ulong uVar14;
  int iVar15;
  wint_t *pwVar16;
  longlong lVar17;
  wint_t *pwVar18;
  size_t sVar19;
  char cVar20;
  longlong lVar21;
  int iVar22;
  bool bVar23;
  int local_1b40;
  wint_t local_1b3c [2];
  longlong local_1b38;
  uint local_1b30 [2];
  longlong local_1b28;
  DWORD local_1b20;
  uint local_1b1c;
  UINT local_1b18;
  undefined local_1b14;
  char local_1b13;
  wint_t local_1af8 [856];
  wint_t local_1448 [2560];
  ulonglong local_48;
  undefined8 uStack64;
  
  iVar7 = (int)register0x00000020;
  uStack64 = 0x180025d56;
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffe480;
  uVar13 = 0;
  local_1b40 = 0;
  uVar14 = 0;
  if (param_3 == 0) goto LAB_1800264fb;
  if (param_2 == (wint_t *)0x0) {
    puVar9 = __doserrno();
    *puVar9 = 0;
LAB_180025d9a:
    piVar10 = _errno();
    *piVar10 = 0x16;
    FUN_18001fee8();
    goto LAB_1800264fb;
  }
  local_1b38 = (longlong)(int)param_1 >> 5;
  lVar21 = (ulonglong)(param_1 & 0x1f) * 0x58;
  cVar20 = (char)(*(char *)(lVar21 + 0x38 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)
                           ) * '\x02') >> 1;
  local_1b28 = lVar21;
  if (((byte)(cVar20 - 1U) < 2) && ((~param_3 & 1) == 0)) {
    puVar9 = __doserrno();
    *puVar9 = 0;
    goto LAB_180025d9a;
  }
  if ((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)) & 0x20) != 0
     ) {
    _lseeki64_nolock(param_1,0,2);
  }
  iVar5 = _isatty(param_1);
  iVar22 = (int)param_2;
  if ((iVar5 != 0) &&
     ((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)) & 0x80) != 0
     )) {
    p_Var11 = _getptd();
    pwVar2 = p_Var11->ptlocinfo->locale_name[2];
    BVar6 = GetConsoleMode(*(HANDLE *)
                            (lVar21 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)),
                           &local_1b1c);
    if ((BVar6 == 0) || ((pwVar2 == (wchar_t *)0x0 && (cVar20 == '\0')))) goto LAB_18002616b;
    local_1b18 = GetConsoleCP();
    wVar4 = 0;
    local_1b3c[0] = 0;
    local_1b20 = 0;
    pwVar16 = param_2;
    lVar17 = local_1b38;
    if (param_3 != 0) {
      do {
        lVar21 = local_1b28;
        bVar23 = false;
        uVar3 = uVar13;
        if (cVar20 == '\0') {
          cVar1 = *(char *)pwVar16;
          local_1b1c = (uint)(cVar1 == '\n');
          lVar17 = *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8);
          if (*(int *)(local_1b28 + 0x50 + lVar17) == 0) {
            iVar7 = isleadbyte((int)cVar1);
            if (iVar7 == 0) {
              sVar19 = 1;
              pwVar18 = pwVar16;
              goto LAB_180025f57;
            }
            if ((longlong)(((ulonglong)param_3 - (longlong)pwVar16) + (longlong)param_2) < 2) {
              uVar13 = uVar13 + 1;
              *(undefined *)
               (lVar21 + 0x4c + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)) =
                   *(undefined *)pwVar16;
              *(undefined4 *)
               (lVar21 + 0x50 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)) = 1;
              lVar17 = local_1b38;
              DVar8 = 0;
              break;
            }
            iVar7 = FUN_180026e88((wchar_t *)local_1b3c,(char *)pwVar16,2);
            lVar17 = local_1b38;
            DVar8 = uVar14;
            if (iVar7 == -1) break;
            pwVar16 = (wint_t *)((longlong)pwVar16 + 1);
          }
          else {
            local_1b14 = *(undefined *)(local_1b28 + 0x4c + lVar17);
            *(undefined4 *)(local_1b28 + 0x50 + lVar17) = 0;
            sVar19 = 2;
            pwVar18 = (wint_t *)&local_1b14;
            local_1b13 = cVar1;
LAB_180025f57:
            iVar7 = FUN_180026e88((wchar_t *)local_1b3c,(char *)pwVar18,sVar19);
            lVar17 = local_1b38;
            DVar8 = 0;
            if (iVar7 == -1) break;
          }
          pwVar16 = (wint_t *)((longlong)pwVar16 + 1);
          nNumberOfBytesToWrite =
               WideCharToMultiByte(local_1b18,0,(LPCWSTR)local_1b3c,1,&local_1b14,5,(LPCSTR)0x0,
                                   (LPBOOL)0x0);
          lVar17 = local_1b38;
          lVar21 = local_1b28;
          DVar8 = 0;
          if (nNumberOfBytesToWrite == 0) break;
          BVar6 = WriteFile(*(HANDLE *)
                             (local_1b28 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8))
                            ,&local_1b14,nNumberOfBytesToWrite,&local_1b20,(LPOVERLAPPED)0x0);
          lVar21 = local_1b28;
          if (BVar6 == 0) goto LAB_180026115;
          uVar13 = ((int)pwVar16 - iVar22) + local_1b40;
          lVar17 = local_1b38;
          DVar8 = 0;
          if ((int)local_1b20 < (int)nNumberOfBytesToWrite) break;
          wVar4 = local_1b3c[0];
          uVar3 = uVar13;
          if (local_1b1c != 0) {
            local_1b14 = 0xd;
            BVar6 = WriteFile(*(HANDLE *)
                               (local_1b28 +
                               *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)),&local_1b14
                              ,1,&local_1b20,(LPOVERLAPPED)0x0);
            if (BVar6 == 0) goto LAB_18002610b;
            lVar17 = local_1b38;
            DVar8 = uVar14;
            if ((int)local_1b20 < 1) break;
            local_1b40 = local_1b40 + 1;
            wVar4 = local_1b3c[0];
            uVar3 = uVar13 + 1;
          }
        }
        else {
          if ((byte)(cVar20 - 1U) < 2) {
            wVar4 = *pwVar16;
            bVar23 = wVar4 == 10;
            pwVar16 = pwVar16 + 1;
            local_1b3c[0] = wVar4;
          }
          if ((byte)(cVar20 - 1U) < 2) {
            wVar4 = _putwch_nolock(wVar4);
            if (wVar4 != local_1b3c[0]) goto LAB_180026115;
            lVar21 = local_1b28;
            wVar4 = local_1b3c[0];
            uVar3 = uVar13 + 2;
            if (bVar23) {
              local_1b3c[0] = 0xd;
              wVar4 = _putwch_nolock(L'\r');
              if (wVar4 != local_1b3c[0]) goto LAB_180026115;
              local_1b40 = local_1b40 + 1;
              lVar21 = local_1b28;
              wVar4 = local_1b3c[0];
              uVar3 = uVar13 + 3;
            }
          }
        }
        uVar13 = uVar3;
        lVar17 = local_1b38;
        DVar8 = uVar14;
      } while ((uint)((int)pwVar16 - iVar22) < param_3);
      goto LAB_18002612b;
    }
    goto LAB_1800264c3;
  }
LAB_18002616b:
  lVar17 = local_1b38;
  DVar8 = 0;
  if ((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)) & 0x80) == 0
     ) {
    BVar6 = WriteFile(*(HANDLE *)(lVar21 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8))
                      ,param_2,param_3,local_1b30,(LPOVERLAPPED)0x0);
    uVar13 = local_1b30[0];
    DVar8 = 0;
    if (BVar6 == 0) {
      DVar8 = GetLastError();
      uVar13 = 0;
    }
    goto LAB_18002612b;
  }
  uVar14 = 0;
  if (cVar20 == '\0') {
    pwVar16 = param_2;
    if (param_3 == 0) goto LAB_1800264c3;
    do {
      lVar21 = local_1b28;
      uVar12 = 0;
      pwVar18 = local_1448;
      do {
        if (param_3 <= (uint)((int)pwVar16 - iVar22)) break;
        cVar20 = *(char *)pwVar16;
        pwVar16 = (wint_t *)((longlong)pwVar16 + 1);
        if (cVar20 == '\n') {
          *(char *)pwVar18 = '\r';
          local_1b40 = local_1b40 + 1;
          pwVar18 = (wint_t *)((longlong)pwVar18 + 1);
          uVar12 = uVar12 + 1;
        }
        uVar12 = uVar12 + 1;
        *(char *)pwVar18 = cVar20;
        pwVar18 = (wint_t *)((longlong)pwVar18 + 1);
      } while (uVar12 < 0x13ff);
      BVar6 = WriteFile(*(HANDLE *)
                         (local_1b28 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)),
                        local_1448,(int)pwVar18 - (iVar7 + -0x1448),local_1b30,(LPOVERLAPPED)0x0);
      if (BVar6 == 0) goto LAB_18002610b;
      uVar13 = uVar13 + local_1b30[0];
      lVar17 = local_1b38;
      DVar8 = uVar14;
    } while (((longlong)((longlong)pwVar18 - (longlong)local_1448) <= (longlong)(int)local_1b30[0])
            && ((uint)((int)pwVar16 - iVar22) < param_3));
    goto LAB_18002612b;
  }
  if (cVar20 == '\x02') {
    pwVar16 = param_2;
    if (param_3 != 0) {
      do {
        lVar21 = local_1b28;
        uVar12 = 0;
        pwVar18 = local_1448;
        do {
          if (param_3 <= (uint)((int)pwVar16 - iVar22)) break;
          wVar4 = *pwVar16;
          pwVar16 = pwVar16 + 1;
          if (wVar4 == 10) {
            *pwVar18 = 0xd;
            local_1b40 = local_1b40 + 2;
            pwVar18 = pwVar18 + 1;
            uVar12 = uVar12 + 2;
          }
          uVar12 = uVar12 + 2;
          *pwVar18 = wVar4;
          pwVar18 = pwVar18 + 1;
        } while (uVar12 < 0x13fe);
        BVar6 = WriteFile(*(HANDLE *)
                           (local_1b28 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8)),
                          local_1448,(int)pwVar18 - (iVar7 + -0x1448),local_1b30,(LPOVERLAPPED)0x0);
        if (BVar6 == 0) goto LAB_18002610b;
        uVar13 = uVar13 + local_1b30[0];
        lVar17 = local_1b38;
        DVar8 = uVar14;
      } while (((longlong)((longlong)pwVar18 - (longlong)local_1448) <= (longlong)(int)local_1b30[0]
               ) && ((uint)((int)pwVar16 - iVar22) < param_3));
      goto LAB_18002612b;
    }
  }
  else {
    pwVar16 = param_2;
    if (param_3 != 0) {
      do {
        uVar12 = 0;
        pwVar18 = local_1af8;
        do {
          if (param_3 <= (uint)((int)pwVar16 - iVar22)) break;
          wVar4 = *pwVar16;
          pwVar16 = pwVar16 + 1;
          if (wVar4 == 10) {
            *pwVar18 = 0xd;
            pwVar18 = pwVar18 + 1;
            uVar12 = uVar12 + 2;
          }
          uVar12 = uVar12 + 2;
          *pwVar18 = wVar4;
          pwVar18 = pwVar18 + 1;
        } while (uVar12 < 0x6a8);
        iVar15 = 0;
        iVar5 = WideCharToMultiByte(0xfde9,0,(LPCWSTR)local_1af8,
                                    ((int)pwVar18 - (iVar7 + -0x1af8)) / 2,(LPSTR)local_1448,0xd55,
                                    (LPCSTR)0x0,(LPBOOL)0x0);
        uVar3 = uVar13;
        if (iVar5 == 0) goto LAB_180026115;
        do {
          BVar6 = WriteFile(*(HANDLE *)
                             (local_1b28 + *(longlong *)((longlong)&DAT_18004c2e0 + local_1b38 * 8))
                            ,(LPCVOID)((longlong)local_1448 + (longlong)iVar15),iVar5 - iVar15,
                            local_1b30,(LPOVERLAPPED)0x0);
          if (BVar6 == 0) {
            DVar8 = GetLastError();
            break;
          }
          iVar15 = iVar15 + local_1b30[0];
        } while (iVar15 < iVar5);
        lVar17 = local_1b38;
        lVar21 = local_1b28;
      } while ((iVar5 <= iVar15) && (uVar13 = (int)pwVar16 - iVar22, uVar13 < param_3));
      goto LAB_18002612b;
    }
  }
  goto LAB_1800264c3;
LAB_180026115:
  uVar13 = uVar3;
  DVar8 = GetLastError();
  lVar17 = local_1b38;
  lVar21 = local_1b28;
  goto LAB_18002612b;
LAB_18002610b:
  DVar8 = GetLastError();
  lVar17 = local_1b38;
LAB_18002612b:
  if (uVar13 == 0) {
    if (DVar8 == 0) {
LAB_1800264c3:
      if (((*(byte *)(lVar21 + 8 + *(longlong *)((longlong)&DAT_18004c2e0 + lVar17 * 8)) & 0x40) ==
           0) || (*(char *)param_2 != '\x1a')) {
        piVar10 = _errno();
        *piVar10 = 0x1c;
        puVar9 = __doserrno();
        *puVar9 = 0;
      }
    }
    else {
      if (DVar8 == 5) {
        piVar10 = _errno();
        *piVar10 = 9;
        puVar9 = __doserrno();
        *puVar9 = 5;
      }
      else {
        _dosmaperr(DVar8);
      }
    }
  }
LAB_1800264fb:
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xffffffffffffe480);
  return;
}



longlong FUN_180026528(uint param_1,longlong param_2,int param_3)

{
  ulong *puVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004e128)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar3) & 1) != 0) {
        FUN_180027e54(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar3) & 1) == 0) {
          piVar2 = _errno();
          *piVar2 = 9;
          puVar1 = __doserrno();
          *puVar1 = 0;
          lVar3 = -1;
        }
        else {
          lVar3 = _lseeki64_nolock(param_1,param_2,param_3);
        }
        FUN_18002800c(param_1);
        return lVar3;
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
    FUN_18001fee8();
  }
  return -1;
}



// Library Function - Single Match
//  _lseeki64_nolock
// 
// Library: Visual Studio 2012 Release

longlong _lseeki64_nolock(int _FileHandle,longlong _Offset,int _Origin)

{
  byte *pbVar1;
  BOOL BVar2;
  DWORD DVar3;
  HANDLE hFile;
  int *piVar4;
  longlong local_res20;
  
  hFile = (HANDLE)FUN_180027f98(_FileHandle);
  if (hFile == (HANDLE)0xffffffffffffffff) {
    piVar4 = _errno();
    *piVar4 = 9;
  }
  else {
    BVar2 = SetFilePointerEx(hFile,_Offset,&local_res20,_Origin);
    if (BVar2 != 0) {
      pbVar1 = (byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)_FileHandle >> 5) * 8) +
                        8 + (ulonglong)(_FileHandle & 0x1f) * 0x58);
      *pbVar1 = *pbVar1 & 0xfd;
      return local_res20;
    }
    DVar3 = GetLastError();
    _dosmaperr(DVar3);
  }
  return -1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _getbuf
// 
// Libraries: Visual Studio 2008 Release, Visual Studio 2010 Release, Visual Studio 2012 Release

void _getbuf(FILE *_File)

{
  char *pcVar1;
  
  _DAT_18004cf38 = _DAT_18004cf38 + 1;
  pcVar1 = (char *)FUN_18001f5e8(0x1000);
  _File->_base = pcVar1;
  if (pcVar1 == (char *)0x0) {
    _File->_flag = _File->_flag | 4;
    _File->_bufsiz = 2;
    _File->_base = (char *)&_File->_charbuf;
  }
  else {
    _File->_flag = _File->_flag | 8;
    _File->_bufsiz = 0x1000;
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return;
}



// Library Function - Single Match
//  __addlocaleref
// 
// Library: Visual Studio 2012 Release

void __addlocaleref(int *param_1)

{
  int *piVar1;
  int **ppiVar2;
  longlong lVar3;
  
  LOCK();
  *param_1 = *param_1 + 1;
  piVar1 = *(int **)(param_1 + 0x36);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x3a);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x38);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  piVar1 = *(int **)(param_1 + 0x3e);
  if (piVar1 != (int *)0x0) {
    LOCK();
    *piVar1 = *piVar1 + 1;
  }
  ppiVar2 = (int **)(param_1 + 10);
  lVar3 = 6;
  do {
    if ((ppiVar2[-2] != (int *)&DAT_180049f24) && (piVar1 = *ppiVar2, piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
    }
    if ((ppiVar2[-3] != (int *)0x0) && (piVar1 = ppiVar2[-1], piVar1 != (int *)0x0)) {
      LOCK();
      *piVar1 = *piVar1 + 1;
    }
    ppiVar2 = ppiVar2 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  LOCK();
  *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
       *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + 1;
  return;
}



// Library Function - Single Match
//  __freetlocinfo
// 
// Library: Visual Studio 2012 Release

void __freetlocinfo(void *param_1)

{
  int *piVar1;
  undefined **ppuVar2;
  longlong lVar3;
  void **ppvVar4;
  int **ppiVar5;
  
  if ((((*(undefined ***)((longlong)param_1 + 0xf0) != (undefined **)0x0) &&
       (*(undefined ***)((longlong)param_1 + 0xf0) != &PTR_DAT_18004a370)) &&
      (*(int **)((longlong)param_1 + 0xd8) != (int *)0x0)) &&
     (**(int **)((longlong)param_1 + 0xd8) == 0)) {
    piVar1 = *(int **)((longlong)param_1 + 0xe8);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      free(piVar1);
      __free_lconv_mon(*(longlong *)((longlong)param_1 + 0xf0));
    }
    piVar1 = *(int **)((longlong)param_1 + 0xe0);
    if ((piVar1 != (int *)0x0) && (*piVar1 == 0)) {
      free(piVar1);
      __free_lconv_num(*(void ***)((longlong)param_1 + 0xf0));
    }
    free(*(void **)((longlong)param_1 + 0xd8));
    free(*(void **)((longlong)param_1 + 0xf0));
  }
  if ((*(int **)((longlong)param_1 + 0xf8) != (int *)0x0) &&
     (**(int **)((longlong)param_1 + 0xf8) == 0)) {
    free((void *)(*(longlong *)((longlong)param_1 + 0x100) + -0xfe));
    free((void *)(*(longlong *)((longlong)param_1 + 0x110) + -0x80));
    free((void *)(*(longlong *)((longlong)param_1 + 0x118) + -0x80));
    free(*(void **)((longlong)param_1 + 0xf8));
  }
  ppuVar2 = *(undefined ***)((longlong)param_1 + 0x120);
  if ((ppuVar2 != &PTR_DAT_180049f30) && (*(int *)((longlong)ppuVar2 + 0x15c) == 0)) {
    __free_lc_time(ppuVar2);
    free(*(void **)((longlong)param_1 + 0x120));
  }
  ppvVar4 = (void **)((longlong)param_1 + 0x128);
  ppiVar5 = (int **)((longlong)param_1 + 0x28);
  lVar3 = 6;
  do {
    if (((ppiVar5[-2] != (int *)&DAT_180049f24) && (piVar1 = *ppiVar5, piVar1 != (int *)0x0)) &&
       (*piVar1 == 0)) {
      free(piVar1);
      free(*ppvVar4);
    }
    if (((ppiVar5[-3] != (int *)0x0) && (piVar1 = ppiVar5[-1], piVar1 != (int *)0x0)) &&
       (*piVar1 == 0)) {
      free(piVar1);
    }
    ppvVar4 = ppvVar4 + 1;
    ppiVar5 = ppiVar5 + 4;
    lVar3 = lVar3 + -1;
  } while (lVar3 != 0);
  free(param_1);
  return;
}



// Library Function - Single Match
//  __removelocaleref
// 
// Library: Visual Studio 2012 Release

int * __removelocaleref(int *param_1)

{
  int *piVar1;
  int **ppiVar2;
  longlong lVar3;
  
  if (param_1 != (int *)0x0) {
    LOCK();
    *param_1 = *param_1 + -1;
    piVar1 = *(int **)(param_1 + 0x36);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x3a);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x38);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    piVar1 = *(int **)(param_1 + 0x3e);
    if (piVar1 != (int *)0x0) {
      LOCK();
      *piVar1 = *piVar1 + -1;
    }
    ppiVar2 = (int **)(param_1 + 10);
    lVar3 = 6;
    do {
      if ((ppiVar2[-2] != (int *)&DAT_180049f24) && (piVar1 = *ppiVar2, piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
      }
      if ((ppiVar2[-3] != (int *)0x0) && (piVar1 = ppiVar2[-1], piVar1 != (int *)0x0)) {
        LOCK();
        *piVar1 = *piVar1 + -1;
      }
      ppiVar2 = ppiVar2 + 4;
      lVar3 = lVar3 + -1;
    } while (lVar3 != 0);
    LOCK();
    *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) =
         *(int *)(*(longlong *)(param_1 + 0x48) + 0x15c) + -1;
  }
  return param_1;
}



// Library Function - Single Match
//  __updatetlocinfo
// 
// Library: Visual Studio 2012 Release

pthreadlocinfo __updatetlocinfo(void)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  
  p_Var1 = _getptd();
  if (((p_Var1->_ownlocale & DAT_18004a358) == 0) || (p_Var1->ptlocinfo == (pthreadlocinfo)0x0)) {
    _lock(0xc);
    ptVar2 = (pthreadlocinfo)
             _updatetlocinfoEx_nolock((int **)&p_Var1->ptlocinfo,(int *)PTR_DAT_18004a1f0);
    FUN_180024d08(0xc);
  }
  else {
    p_Var1 = _getptd();
    ptVar2 = p_Var1->ptlocinfo;
  }
  if (ptVar2 == (pthreadlocinfo)0x0) {
    _amsg_exit(0x20);
  }
  return ptVar2;
}



// Library Function - Single Match
//  _updatetlocinfoEx_nolock
// 
// Library: Visual Studio 2012 Release

int * _updatetlocinfoEx_nolock(int **param_1,int *param_2)

{
  int *piVar1;
  
  if ((param_2 == (int *)0x0) || (param_1 == (int **)0x0)) {
    param_2 = (int *)0x0;
  }
  else {
    piVar1 = *param_1;
    if (piVar1 != param_2) {
      *param_1 = param_2;
      __addlocaleref(param_2);
      if (((piVar1 != (int *)0x0) && (__removelocaleref(piVar1), *piVar1 == 0)) &&
         (piVar1 != (int *)&DAT_18004a200)) {
        __freetlocinfo(piVar1);
      }
    }
  }
  return param_2;
}



// Library Function - Single Match
//  _isleadbyte_l
// 
// Library: Visual Studio 2012 Release

int _isleadbyte_l(int _C,_locale_t _Locale)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(_C & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return (int)(uVar1 & 0x8000);
}



// Library Function - Single Match
//  isleadbyte
// 
// Library: Visual Studio 2012 Release

int isleadbyte(int _C)

{
  ushort uVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)0x0);
  uVar1 = *(ushort *)(*(longlong *)(local_28[0] + 0x108) + (ulonglong)(_C & 0xff) * 2);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return (int)(uVar1 & 0x8000);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

bool FUN_180026b28(void)

{
  return _DAT_18004cf40 == (DAT_180049180 | 1);
}



void FUN_180026b40(wint_t param_1,FILE *param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  errno_t eVar4;
  ulonglong uVar5;
  undefined *puVar6;
  undefined *puVar7;
  char *pcVar8;
  undefined auStack88 [32];
  int local_38;
  char local_34 [12];
  ulonglong local_28;
  
  local_28 = DAT_180049180 ^ (ulonglong)auStack88;
  if ((*(byte *)&param_2->_flag & 0x40) == 0) {
    iVar2 = _fileno(param_2);
    puVar7 = &DAT_180049330;
    if ((iVar2 == -1) || (iVar2 = _fileno(param_2), iVar2 == -2)) {
      puVar6 = &DAT_180049330;
    }
    else {
      iVar2 = _fileno(param_2);
      uVar3 = _fileno(param_2);
      puVar6 = (undefined *)
               ((ulonglong)(uVar3 & 0x1f) * 0x58 +
               *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)iVar2 >> 5) * 8));
    }
    if ((puVar6[0x38] & 0x7f) != 2) {
      iVar2 = _fileno(param_2);
      if ((iVar2 == -1) || (iVar2 = _fileno(param_2), iVar2 == -2)) {
        puVar6 = &DAT_180049330;
      }
      else {
        iVar2 = _fileno(param_2);
        uVar3 = _fileno(param_2);
        puVar6 = (undefined *)
                 ((ulonglong)(uVar3 & 0x1f) * 0x58 +
                 *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)iVar2 >> 5) * 8));
      }
      if ((puVar6[0x38] & 0x7f) != 1) {
        iVar2 = _fileno(param_2);
        if ((iVar2 != -1) && (iVar2 = _fileno(param_2), iVar2 != -2)) {
          iVar2 = _fileno(param_2);
          uVar3 = _fileno(param_2);
          puVar7 = (undefined *)
                   ((ulonglong)(uVar3 & 0x1f) * 0x58 +
                   *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)iVar2 >> 5) * 8));
        }
        if ((puVar7[8] & 0x80) != 0) {
          eVar4 = wctomb_s(&local_38,local_34,5,param_1);
          iVar2 = 0;
          if ((eVar4 == 0) && (0 < local_38)) {
            pcVar8 = local_34;
            do {
              piVar1 = &param_2->_cnt;
              *piVar1 = *piVar1 + -1;
              if (*piVar1 < 0) {
                uVar5 = FUN_18001ff44((int)*pcVar8,param_2);
                uVar3 = (uint)uVar5;
              }
              else {
                *param_2->_ptr = *pcVar8;
                uVar3 = (uint)(byte)*param_2->_ptr;
                param_2->_ptr = param_2->_ptr + 1;
              }
              if (uVar3 == 0xffffffff) break;
              iVar2 = iVar2 + 1;
              pcVar8 = pcVar8 + 1;
            } while (iVar2 < local_38);
          }
          goto LAB_180026d13;
        }
        goto LAB_180026cea;
      }
    }
    iVar2 = param_2->_cnt + -2;
    param_2->_cnt = iVar2;
    if (iVar2 < 0) {
LAB_180026d08:
      FUN_180028608(param_1,param_2);
      goto LAB_180026d13;
    }
    *(wint_t *)param_2->_ptr = param_1;
  }
  else {
LAB_180026cea:
    iVar2 = param_2->_cnt + -2;
    param_2->_cnt = iVar2;
    if (iVar2 < 0) goto LAB_180026d08;
    *(wint_t *)param_2->_ptr = param_1;
  }
  param_2->_ptr = param_2->_ptr + 2;
LAB_180026d13:
  FUN_18001d2f0(local_28 ^ (ulonglong)auStack88);
  return;
}



// Library Function - Single Match
//  _mbtowc_l
// 
// Library: Visual Studio 2012 Release

int _mbtowc_l(wchar_t *_DstCh,char *_SrcCh,size_t _SrcSizeInBytes,_locale_t _Locale)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  localeinfo_struct local_28;
  longlong local_18;
  char local_10;
  
  if ((_SrcCh != (char *)0x0) && (_SrcSizeInBytes != 0)) {
    if (*_SrcCh != '\0') {
      _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(localeinfo_struct *)_Locale);
      if ((local_28.locinfo)->locale_name[2] == (wchar_t *)0x0) {
        if (_DstCh != (wchar_t *)0x0) {
          *_DstCh = (ushort)(byte)*_SrcCh;
        }
        iVar2 = 1;
      }
      else {
        iVar1 = _isleadbyte_l((uint)(byte)*_SrcCh,(_locale_t)&local_28);
        iVar2 = 1;
        if (iVar1 == 0) {
          iVar1 = MultiByteToWideChar((local_28.locinfo)->lc_codepage,9,_SrcCh,1,_DstCh,
                                      (uint)(_DstCh != (wchar_t *)0x0));
          if (iVar1 != 0) goto LAB_180026e6b;
        }
        else {
          iVar2 = (local_28.locinfo)->mb_cur_max;
          if ((((1 < iVar2) && (iVar2 <= (int)_SrcSizeInBytes)) &&
              (iVar2 = MultiByteToWideChar((local_28.locinfo)->lc_codepage,9,_SrcCh,iVar2,_DstCh,
                                           (uint)(_DstCh != (wchar_t *)0x0)), iVar2 != 0)) ||
             (((ulonglong)(longlong)(local_28.locinfo)->mb_cur_max <= _SrcSizeInBytes &&
              (_SrcCh[1] != '\0')))) {
            iVar2 = (local_28.locinfo)->mb_cur_max;
            goto LAB_180026e6b;
          }
        }
        piVar3 = _errno();
        iVar2 = -1;
        *piVar3 = 0x2a;
      }
LAB_180026e6b:
      if (local_10 == '\0') {
        return iVar2;
      }
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
      return iVar2;
    }
    if (_DstCh != (wchar_t *)0x0) {
      *_DstCh = L'\0';
    }
  }
  return 0;
}



void FUN_180026e88(wchar_t *param_1,char *param_2,size_t param_3)

{
  _mbtowc_l(param_1,param_2,param_3,(_locale_t)0x0);
  return;
}



// Library Function - Single Match
//  _wctomb_s_l
// 
// Library: Visual Studio 2012 Release

errno_t _wctomb_s_l(int *_SizeConverted,char *_MbCh,size_t _SizeInBytes,wchar_t _WCh,
                   _locale_t _Locale)

{
  int iVar1;
  DWORD DVar2;
  int *piVar3;
  errno_t eVar4;
  int local_res10 [2];
  ushort local_res20 [4];
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  if ((_MbCh == (char *)0x0) && (_SizeInBytes != 0)) {
    if (_SizeConverted != (int *)0x0) {
      *_SizeConverted = 0;
    }
    return 0;
  }
  if (_SizeConverted != (int *)0x0) {
    *_SizeConverted = -1;
  }
  local_res20[0] = _WCh;
  if (0x7fffffff < _SizeInBytes) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18001fee8();
    return 0x16;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  if (*(longlong *)(local_28[0] + 0x138) == 0) {
    if (local_res20[0] < 0x100) {
      if (_MbCh != (char *)0x0) {
        if (_SizeInBytes == 0) goto LAB_180027004;
        *_MbCh = (char)local_res20[0];
      }
      if (_SizeConverted != (int *)0x0) {
        *_SizeConverted = 1;
      }
LAB_180026fd7:
      eVar4 = 0;
      goto LAB_180026f46;
    }
    if ((_MbCh != (char *)0x0) && (_SizeInBytes != 0)) {
      FUN_18001d980((undefined (*) [16])_MbCh,0,_SizeInBytes);
    }
  }
  else {
    local_res10[0] = 0;
    iVar1 = WideCharToMultiByte(*(UINT *)(local_28[0] + 4),0,(LPCWSTR)local_res20,1,_MbCh,
                                (int)_SizeInBytes,(LPCSTR)0x0,local_res10);
    if (iVar1 == 0) {
      DVar2 = GetLastError();
      if (DVar2 == 0x7a) {
        if ((_MbCh != (char *)0x0) && (_SizeInBytes != 0)) {
          FUN_18001d980((undefined (*) [16])_MbCh,0,_SizeInBytes);
        }
LAB_180027004:
        piVar3 = _errno();
        eVar4 = 0x22;
        *piVar3 = 0x22;
        FUN_18001fee8();
        goto LAB_180026f46;
      }
    }
    else {
      if (local_res10[0] == 0) {
        if (_SizeConverted != (int *)0x0) {
          *_SizeConverted = iVar1;
        }
        goto LAB_180026fd7;
      }
    }
  }
  piVar3 = _errno();
  *piVar3 = 0x2a;
  piVar3 = _errno();
  eVar4 = *piVar3;
LAB_180026f46:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return eVar4;
}



// Library Function - Single Match
//  wctomb_s
// 
// Library: Visual Studio 2012 Release

errno_t wctomb_s(int *_SizeConverted,char *_MbCh,rsize_t _SizeInBytes,wchar_t _WCh)

{
  errno_t eVar1;
  
  eVar1 = _wctomb_s_l(_SizeConverted,_MbCh,_SizeInBytes,_WCh,(_locale_t)0x0);
  return eVar1;
}



// Library Function - Single Match
//  int __cdecl _ValidateRead(void const * __ptr64,unsigned int)
// 
// Library: Visual Studio 2012 Release

int _ValidateRead(void *param_1,unsigned_int param_2)

{
  return (int)(-(uint)(param_1 != (void *)0x0) & 1);
}



// Library Function - Single Match
//  _CallSettingFrame
// 
// Library: Visual Studio 2012 Release

void _CallSettingFrame(void)

{
  code *pcVar1;
  
  pcVar1 = (code *)FUN_1800259b0();
  (*pcVar1)();
  FUN_1800259e0();
  FUN_1800259b0();
  return;
}



undefined4 FUN_180027098(wchar_t *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0xe3;
  do {
    iVar1 = (iVar3 + iVar4) / 2;
    iVar2 = _wcsnicmp(param_1,(wchar_t *)(&PTR_DAT_180035940)[(longlong)iVar1 * 2],0x55);
    if (iVar2 == 0) {
      return *(undefined4 *)(&UNK_180035948 + (longlong)iVar1 * 0x10);
    }
    if (iVar2 < 0) {
      iVar3 = iVar1 + -1;
    }
    else {
      iVar4 = iVar1 + 1;
    }
  } while (iVar4 <= iVar3);
  return 0xffffffff;
}



undefined4 FUN_180027124(wchar_t *param_1)

{
  int iVar1;
  
  if (((param_1 != (wchar_t *)0x0) && (iVar1 = FUN_180027098(param_1), -1 < iVar1)) &&
     ((ulonglong)(longlong)iVar1 < 0xe4)) {
    return *(undefined4 *)(&DAT_180034b00 + (longlong)iVar1 * 0x10);
  }
  return 0;
}



void FUN_180027158(wchar_t *param_1,DWORD param_2,LPCWSTR param_3,int param_4,LPWSTR param_5,
                  int param_6)

{
  LCID Locale;
  
  if ((code *)(DAT_18004e100 ^ DAT_180049180) == (code *)0x0) {
    Locale = FUN_180027124(param_1);
    LCMapStringW(Locale,param_2,param_3,param_4,param_5,param_6);
  }
  else {
    (*(code *)(DAT_18004e100 ^ DAT_180049180))();
  }
  return;
}



// Library Function - Single Match
//  _wcsnicmp
// 
// Library: Visual Studio 2019 Release

int _wcsnicmp(wchar_t *_Str1,wchar_t *_Str2,size_t _MaxCount)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  wchar_t *pwVar4;
  
  iVar3 = 0;
  if (_MaxCount != 0) {
    pwVar4 = (wchar_t *)((longlong)_Str1 - (longlong)_Str2);
    do {
      uVar1 = *(ushort *)((longlong)pwVar4 + (longlong)_Str2);
      if ((ushort)(uVar1 - 0x41) < 0x1a) {
        uVar1 = uVar1 + 0x20;
      }
      uVar2 = *_Str2;
      if ((ushort)(uVar2 - 0x41) < 0x1a) {
        uVar2 = uVar2 + 0x20;
      }
      _Str2 = (wchar_t *)((ushort *)_Str2 + 1);
      _MaxCount = _MaxCount - 1;
    } while (((_MaxCount != 0) && (uVar1 != 0)) && (uVar1 == uVar2));
    iVar3 = (uint)uVar1 - (uint)uVar2;
  }
  return iVar3;
}



// WARNING: Removing unreachable block (ram,0x000180027277)

ulonglong FUN_1800272bc(uint param_1)

{
  byte bVar1;
  _LocaleUpdate local_28 [8];
  longlong local_20;
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate(local_28,(localeinfo_struct *)0x0);
  bVar1 = *(byte *)(((ulonglong)param_1 & 0xff) + 0x19 + local_20);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return (ulonglong)((bVar1 & 4) != 0);
}



longlong FUN_1800272d0(short *param_1)

{
  short sVar1;
  short *psVar2;
  
  psVar2 = param_1;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  return ((longlong)((longlong)psVar2 - (longlong)param_1) >> 1) + -1;
}



// Library Function - Single Match
//  wcsncpy_s
// 
// Library: Visual Studio 2012 Release

errno_t wcsncpy_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src,rsize_t _MaxCount)

{
  wchar_t wVar1;
  errno_t *peVar2;
  errno_t eVar3;
  rsize_t rVar4;
  wchar_t *pwVar5;
  
  if (_MaxCount == 0) {
    if (_Dst == (wchar_t *)0x0) {
      if (_SizeInWords == 0) {
        return 0;
      }
    }
    else {
LAB_18002730c:
      if (_SizeInWords != 0) {
        if (_MaxCount == 0) {
          *_Dst = L'\0';
          return 0;
        }
        if (_Src != (wchar_t *)0x0) {
          rVar4 = _SizeInWords;
          if (_MaxCount == 0xffffffffffffffff) {
            pwVar5 = (wchar_t *)((longlong)_Dst - (longlong)_Src);
            do {
              wVar1 = *_Src;
              *(wchar_t *)((longlong)pwVar5 + (longlong)_Src) = wVar1;
              _Src = _Src + 1;
              if (wVar1 == L'\0') break;
              rVar4 = rVar4 - 1;
            } while (rVar4 != 0);
          }
          else {
            pwVar5 = _Dst;
            do {
              wVar1 = *(wchar_t *)((longlong)((longlong)_Src - (longlong)_Dst) + (longlong)pwVar5);
              *pwVar5 = wVar1;
              pwVar5 = pwVar5 + 1;
              if ((wVar1 == L'\0') || (rVar4 = rVar4 - 1, rVar4 == 0)) break;
              _MaxCount = _MaxCount - 1;
            } while (_MaxCount != 0);
            if (_MaxCount == 0) {
              *pwVar5 = L'\0';
            }
          }
          if (rVar4 != 0) {
            return 0;
          }
          if (_MaxCount == 0xffffffffffffffff) {
            _Dst[_SizeInWords - 1] = L'\0';
            return 0x50;
          }
          *_Dst = L'\0';
          peVar2 = _errno();
          eVar3 = 0x22;
          goto LAB_18002732d;
        }
        *_Dst = L'\0';
      }
    }
  }
  else {
    if (_Dst != (wchar_t *)0x0) goto LAB_18002730c;
  }
  peVar2 = _errno();
  eVar3 = 0x16;
LAB_18002732d:
  *peVar2 = eVar3;
  FUN_18001fee8();
  return eVar3;
}



// Library Function - Single Match
//  _set_error_mode
// 
// Library: Visual Studio 2012 Release

int _set_error_mode(int _Mode)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  
  if ((_Mode < 0) ||
     ((iVar2 = DAT_18004cf50, iVar1 = _Mode, 2 < _Mode && (iVar1 = DAT_18004cf50, _Mode != 3)))) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18001fee8();
    iVar2 = -1;
    iVar1 = DAT_18004cf50;
  }
  DAT_18004cf50 = iVar1;
  return iVar2;
}



void FUN_1800273f8(LPCWSTR param_1,undefined8 param_2,uint param_3)

{
  bool bVar1;
  DWORD DVar2;
  BOOL BVar3;
  int iVar4;
  PVOID pvVar5;
  undefined7 extraout_var;
  HMODULE hModule;
  FARPROC pFVar6;
  code *pcVar7;
  code *pcVar8;
  longlong lVar9;
  longlong lVar10;
  undefined auStack136 [32];
  undefined *local_68;
  undefined local_58 [8];
  undefined local_50 [8];
  byte local_48;
  ulonglong local_40;
  
  local_40 = DAT_180049180 ^ (ulonglong)auStack136;
  pvVar5 = EncodePointer((PVOID)0x0);
  lVar10 = 0;
  bVar1 = FUN_180024108();
  iVar4 = (int)CONCAT71(extraout_var,bVar1);
  if (DAT_18004cf58 == (PVOID)0x0) {
    hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0x800);
    if (((hModule == (HMODULE)0x0) &&
        ((DVar2 = GetLastError(), DVar2 != 0x57 ||
         (hModule = LoadLibraryExW(L"USER32.DLL",(HANDLE)0x0,0), hModule == (HMODULE)0x0)))) ||
       (pFVar6 = GetProcAddress(hModule,"MessageBoxW"), pFVar6 == (FARPROC)0x0)) goto LAB_18002764f;
    DAT_18004cf58 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetActiveWindow");
    DAT_18004cf60 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetLastActivePopup");
    DAT_18004cf68 = EncodePointer(pFVar6);
    pFVar6 = GetProcAddress(hModule,"GetUserObjectInformationW");
    DAT_18004cf78 = EncodePointer(pFVar6);
    if (DAT_18004cf78 != (PVOID)0x0) {
      pFVar6 = GetProcAddress(hModule,"GetProcessWindowStation");
      DAT_18004cf70 = EncodePointer(pFVar6);
    }
  }
  BVar3 = IsDebuggerPresent();
  if (BVar3 == 0) {
    if (iVar4 != 0) {
      DecodePointer(DAT_18004cf58);
      goto LAB_18002764f;
    }
  }
  else {
    if (param_1 != (LPCWSTR)0x0) {
      OutputDebugStringW(param_1);
    }
    if (iVar4 != 0) goto LAB_18002764f;
  }
  if ((DAT_18004cf70 == pvVar5) || (DAT_18004cf78 == pvVar5)) {
LAB_1800275eb:
    if (((DAT_18004cf60 != pvVar5) &&
        (((pcVar7 = (code *)DecodePointer(DAT_18004cf60), pcVar7 != (code *)0x0 &&
          (lVar10 = (*pcVar7)(), lVar10 != 0)) && (DAT_18004cf68 != pvVar5)))) &&
       (pcVar7 = (code *)DecodePointer(DAT_18004cf68), pcVar7 != (code *)0x0)) {
      lVar10 = (*pcVar7)(lVar10);
    }
  }
  else {
    pcVar7 = (code *)DecodePointer(DAT_18004cf70);
    pcVar8 = (code *)DecodePointer(DAT_18004cf78);
    if ((pcVar7 == (code *)0x0) || (pcVar8 == (code *)0x0)) goto LAB_1800275eb;
    lVar9 = (*pcVar7)();
    if (lVar9 != 0) {
      local_68 = local_58;
      iVar4 = (*pcVar8)(lVar9,1,local_50);
      if ((iVar4 != 0) && ((local_48 & 1) != 0)) goto LAB_1800275eb;
    }
    param_3 = param_3 | 0x200000;
  }
  pcVar7 = (code *)DecodePointer(DAT_18004cf58);
  if (pcVar7 != (code *)0x0) {
    (*pcVar7)(lVar10,param_1,param_2,param_3);
  }
LAB_18002764f:
  FUN_18001d2f0(local_40 ^ (ulonglong)auStack136);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_180027678(longlong *param_1,wchar_t *param_2,uint param_3,LPCSTR param_4,int param_5,
                  undefined8 param_6,int param_7,UINT param_8,int param_9)

{
  ulonglong _Size;
  size_t _Size_00;
  longlong lVar1;
  wchar_t *pwVar2;
  int iVar3;
  char *pcVar4;
  undefined4 *puVar5;
  undefined4 *lpWideCharStr;
  undefined *puVar6;
  undefined *puVar7;
  undefined *puVar8;
  int iVar9;
  ulonglong uVar10;
  undefined4 auStack64 [2];
  wchar_t *local_38;
  ulonglong local_30;
  
  puVar7 = &stack0xffffffffffffff88;
  puVar6 = &stack0xffffffffffffff88;
  local_30 = DAT_180049180 ^ (ulonglong)&local_38;
  puVar5 = (undefined4 *)0x0;
  pcVar4 = param_4;
  iVar9 = param_5;
  if (0 < param_5) {
    do {
      iVar9 = iVar9 + -1;
      if (*pcVar4 == '\0') goto LAB_1800276d2;
      pcVar4 = pcVar4 + 1;
    } while (iVar9 != 0);
    iVar9 = -1;
LAB_1800276d2:
    iVar3 = (param_5 - iVar9) + -1;
    iVar9 = param_5 - iVar9;
    if (param_5 <= iVar3) {
      iVar9 = iVar3;
    }
  }
  if (param_8 == 0) {
    param_8 = *(UINT *)(*param_1 + 4);
  }
  local_38 = param_2;
  iVar3 = MultiByteToWideChar(param_8,(-(uint)(param_9 != 0) & 8) + 1,param_4,iVar9,(LPWSTR)0x0,0);
  uVar10 = SEXT48(iVar3);
  if (iVar3 == 0) goto LAB_18002793e;
  puVar7 = &stack0xffffffffffffff88;
  if (((0 < iVar3) && (puVar7 = &stack0xffffffffffffff88, 1 < 0xffffffffffffffe0 / uVar10)) &&
     (puVar7 = &stack0xffffffffffffff88, uVar10 * 2 < uVar10 * 2 + 0x10)) {
    _Size = uVar10 * 2 + 0x10;
    if (_Size < 0x401) {
      uVar10 = uVar10 * 2 + 0x1f;
      if (uVar10 <= _Size) {
        uVar10 = 0xffffffffffffff0;
      }
      lVar1 = -(uVar10 & 0xfffffffffffffff0);
      puVar7 = &stack0xffffffffffffff80 + lVar1;
      puVar6 = &stack0xffffffffffffff80 + lVar1;
      puVar5 = (undefined4 *)((longlong)auStack64 + lVar1);
      if (puVar5 == (undefined4 *)0x0) goto LAB_18002793e;
      *puVar5 = 0xcccc;
    }
    else {
      puVar5 = (undefined4 *)malloc(_Size);
      puVar7 = &stack0xffffffffffffff88;
      if (puVar5 == (undefined4 *)0x0) goto LAB_1800277a3;
      *puVar5 = 0xdddd;
    }
    puVar5 = puVar5 + 4;
    puVar7 = puVar6;
  }
LAB_1800277a3:
  if (puVar5 == (undefined4 *)0x0) goto LAB_18002793e;
  *(int *)(puVar7 + 0x28) = iVar3;
  *(undefined4 **)(puVar7 + 0x20) = puVar5;
  *(undefined8 *)(puVar7 + -8) = 0x1800277ca;
  iVar9 = MultiByteToWideChar(param_8,1,param_4,iVar9,*(LPWSTR *)(puVar7 + 0x20),
                              *(int *)(puVar7 + 0x28));
  pwVar2 = local_38;
  puVar8 = puVar7;
  if (iVar9 != 0) {
    *(undefined4 *)(puVar7 + 0x28) = 0;
    *(undefined8 *)(puVar7 + 0x20) = 0;
    *(undefined8 *)(puVar7 + -8) = 0x1800277f0;
    iVar9 = FUN_180027158(pwVar2,param_3,(LPCWSTR)puVar5,iVar3,*(LPWSTR *)(puVar7 + 0x20),
                          *(int *)(puVar7 + 0x28));
    uVar10 = SEXT48(iVar9);
    if (iVar9 != 0) {
      if ((param_3 & 0x400) == 0) {
        if (((iVar9 < 1) || (0xffffffffffffffe0 / uVar10 < 2)) || (uVar10 * 2 + 0x10 <= uVar10 * 2))
        {
          lpWideCharStr = (undefined4 *)0x0;
        }
        else {
          _Size_00 = uVar10 * 2 + 0x10;
          if (_Size_00 < 0x401) {
            uVar10 = uVar10 * 2 + 0x1f;
            if (uVar10 <= _Size_00) {
              uVar10 = 0xffffffffffffff0;
            }
            *(undefined8 *)(puVar7 + -8) = 0x180027885;
            lVar1 = -(uVar10 & 0xfffffffffffffff0);
            puVar8 = puVar7 + lVar1 + -8;
            lpWideCharStr = (undefined4 *)(puVar7 + lVar1 + 0x38);
            if (lpWideCharStr == (undefined4 *)0x0) goto LAB_18002792b;
            *lpWideCharStr = 0xcccc;
            puVar7 = puVar7 + lVar1 + -8;
          }
          else {
            *(undefined8 *)(puVar7 + -8) = 0x1800278a3;
            lpWideCharStr = (undefined4 *)malloc(_Size_00);
            if (lpWideCharStr == (undefined4 *)0x0) goto LAB_1800278b9;
            *lpWideCharStr = 0xdddd;
          }
          lpWideCharStr = lpWideCharStr + 4;
          puVar8 = puVar7;
        }
LAB_1800278b9:
        if (lpWideCharStr != (undefined4 *)0x0) {
          *(int *)(puVar8 + 0x28) = iVar9;
          *(undefined4 **)(puVar8 + 0x20) = lpWideCharStr;
          *(undefined8 *)(puVar8 + -8) = 0x1800278d8;
          iVar3 = FUN_180027158(pwVar2,param_3,(LPCWSTR)puVar5,iVar3,*(LPWSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28));
          if (iVar3 != 0) {
            *(undefined8 *)(puVar8 + 0x38) = 0;
            *(undefined8 *)(puVar8 + 0x30) = 0;
            if (param_7 == 0) {
              *(undefined4 *)(puVar8 + 0x28) = 0;
              *(undefined8 *)(puVar8 + 0x20) = 0;
            }
            else {
              *(int *)(puVar8 + 0x28) = param_7;
              *(undefined8 *)(puVar8 + 0x20) = param_6;
            }
            *(undefined8 *)(puVar8 + -8) = 0x180027918;
            WideCharToMultiByte(param_8,0,(LPCWSTR)lpWideCharStr,iVar9,*(LPSTR *)(puVar8 + 0x20),
                                *(int *)(puVar8 + 0x28),*(LPCSTR *)(puVar8 + 0x30),
                                *(LPBOOL *)(puVar8 + 0x38));
          }
          if (lpWideCharStr[-4] == 0xdddd) {
            *(undefined8 *)(puVar8 + -8) = 0x18002792b;
            free(lpWideCharStr + -4);
          }
        }
      }
      else {
        if ((param_7 != 0) && (iVar9 <= param_7)) {
          *(int *)(puVar7 + 0x28) = param_7;
          *(undefined8 *)(puVar7 + 0x20) = param_6;
          *(undefined8 *)(puVar7 + -8) = 0x180027837;
          FUN_180027158(pwVar2,param_3,(LPCWSTR)puVar5,iVar3,*(LPWSTR *)(puVar7 + 0x20),
                        *(int *)(puVar7 + 0x28));
        }
      }
    }
  }
LAB_18002792b:
  puVar7 = puVar8;
  if (puVar5[-4] == 0xdddd) {
    *(undefined8 *)(puVar8 + -8) = 0x18002793c;
    free(puVar5 + -4);
  }
LAB_18002793e:
  uVar10 = local_30 ^ (ulonglong)&local_38;
  *(undefined8 *)(puVar7 + -8) = 0x18002794a;
  FUN_18001d2f0(uVar10);
  return;
}



// Library Function - Single Match
//  __crtLCMapStringA
// 
// Library: Visual Studio 2012 Release

int __crtLCMapStringA(_locale_t _Plocinfo,LPCWSTR _LocaleName,DWORD _DwMapFlag,LPCSTR _LpSrcStr,
                     int _CchSrc,LPSTR _LpDestStr,int _CchDest,int _Code_page,BOOL _BError)

{
  int iVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Plocinfo);
  iVar1 = FUN_180027678(local_28,_LocaleName,_DwMapFlag,_LpSrcStr,_CchSrc,_LpDestStr,_CchDest,
                        _Code_page,_BError);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return iVar1;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void FUN_1800279fc(longlong *param_1,DWORD param_2,LPCSTR param_3,int param_4,LPWORD param_5,
                  UINT param_6,int param_7)

{
  ulonglong _Size;
  longlong lVar1;
  int iVar2;
  ulonglong uVar3;
  undefined (*lpSrcStr) [16];
  undefined *puVar4;
  undefined *puVar5;
  ulonglong uVar6;
  ulonglong local_38 [2];
  
  puVar5 = &stack0xffffffffffffff98;
  puVar4 = &stack0xffffffffffffff98;
  local_38[0] = DAT_180049180 ^ (ulonglong)local_38;
  lpSrcStr = (undefined (*) [16])0x0;
  if (param_6 == 0) {
    param_6 = *(UINT *)(*param_1 + 4);
  }
  iVar2 = MultiByteToWideChar(param_6,(-(uint)(param_7 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,0)
  ;
  uVar6 = SEXT48(iVar2);
  if (iVar2 == 0) goto LAB_180027b4c;
  puVar5 = &stack0xffffffffffffff98;
  if (((0 < iVar2) && (puVar5 = &stack0xffffffffffffff98, uVar6 < 0x7ffffffffffffff1)) &&
     (puVar5 = &stack0xffffffffffffff98, uVar6 * 2 < uVar6 * 2 + 0x10)) {
    _Size = uVar6 * 2 + 0x10;
    if (_Size < 0x401) {
      uVar3 = uVar6 * 2 + 0x1f;
      if (uVar3 <= _Size) {
        uVar3 = 0xffffffffffffff0;
      }
      lVar1 = -(uVar3 & 0xfffffffffffffff0);
      puVar5 = &stack0xffffffffffffff90 + lVar1;
      puVar4 = &stack0xffffffffffffff90 + lVar1;
      lpSrcStr = (undefined (*) [16])(&stack0xffffffffffffffc0 + lVar1);
      if (lpSrcStr == (undefined (*) [16])0x0) goto LAB_180027b4c;
      *(undefined4 *)*lpSrcStr = 0xcccc;
    }
    else {
      lpSrcStr = (undefined (*) [16])malloc(_Size);
      puVar5 = &stack0xffffffffffffff98;
      if (lpSrcStr == (undefined (*) [16])0x0) goto LAB_180027aea;
      *(undefined4 *)*lpSrcStr = 0xdddd;
    }
    lpSrcStr = lpSrcStr[1];
    puVar5 = puVar4;
  }
LAB_180027aea:
  if (lpSrcStr != (undefined (*) [16])0x0) {
    *(undefined8 *)(puVar5 + -8) = 0x180027b03;
    FUN_18001d980(lpSrcStr,0,uVar6 * 2);
    *(int *)(puVar5 + 0x28) = iVar2;
    *(undefined (**) [16])(puVar5 + 0x20) = lpSrcStr;
    *(undefined8 *)(puVar5 + -8) = 0x180027b20;
    iVar2 = MultiByteToWideChar(param_6,1,param_3,param_4,*(LPWSTR *)(puVar5 + 0x20),
                                *(int *)(puVar5 + 0x28));
    if (iVar2 != 0) {
      *(undefined8 *)(puVar5 + -8) = 0x180027b37;
      GetStringTypeW(param_2,(LPCWSTR)lpSrcStr,iVar2,param_5);
    }
    if (*(int *)lpSrcStr[-1] == 0xdddd) {
      *(undefined8 *)(puVar5 + -8) = 0x180027b4a;
      free(lpSrcStr[-1]);
    }
  }
LAB_180027b4c:
  uVar6 = local_38[0] ^ (ulonglong)local_38;
  *(undefined8 *)(puVar5 + -8) = 0x180027b58;
  FUN_18001d2f0(uVar6);
  return;
}



// Library Function - Single Match
//  __crtGetStringTypeA
// 
// Library: Visual Studio 2012 Release

BOOL __crtGetStringTypeA(_locale_t _Plocinfo,DWORD _DWInfoType,LPCSTR _LpSrcStr,int _CchSrc,
                        LPWORD _LpCharType,int _Code_page,BOOL _BError)

{
  BOOL BVar1;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Plocinfo);
  BVar1 = FUN_1800279fc(local_28,_DWInfoType,_LpSrcStr,_CchSrc,_LpCharType,_Code_page,_BError);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return BVar1;
}



// WARNING: Removing unreachable block (ram,0x000180027d8b)
// WARNING: Removing unreachable block (ram,0x000180027d37)
// WARNING: Removing unreachable block (ram,0x000180027d41)

int FUN_180027bf0(FILE *param_1)

{
  void *_File;
  FILE *pFVar1;
  uint uVar2;
  DWORD DVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  longlong lVar7;
  
  if (param_1 != (FILE *)0x0) {
    iVar5 = _flush(param_1);
    if (iVar5 == 0) {
      if ((param_1->_flag & 0x4000U) == 0) {
        iVar5 = 0;
      }
      else {
        uVar2 = _fileno(param_1);
        DVar3 = FUN_1800288bc(uVar2);
        iVar5 = -(uint)(DVar3 != 0);
      }
    }
    else {
      iVar5 = -1;
    }
    return iVar5;
  }
  iVar6 = 0;
  _lock(1);
  for (iVar5 = 0; iVar5 < DAT_18004cff0; iVar5 = iVar5 + 1) {
    lVar7 = (longlong)iVar5;
    _File = *(void **)(DAT_18004cfe8 + lVar7 * 8);
    if ((_File != (void *)0x0) && ((*(byte *)((longlong)_File + 0x18) & 0x83) != 0)) {
      _lock_file2(iVar5,_File);
      pFVar1 = *(FILE **)(DAT_18004cfe8 + lVar7 * 8);
      if (((*(byte *)&pFVar1->_flag & 0x83) != 0) &&
         (((*(byte *)&pFVar1->_flag & 2) != 0 && (iVar4 = FUN_180027bf0(pFVar1), iVar4 == -1)))) {
        iVar6 = -1;
      }
      FUN_180025ba8(iVar5,*(longlong *)(DAT_18004cfe8 + lVar7 * 8));
    }
  }
  FUN_180024d08(1);
  return iVar6;
}



// Library Function - Single Match
//  _flush
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _flush(FILE *_File)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  
  iVar2 = 0;
  iVar3 = 0;
  if (((((byte)_File->_flag & 3) == 2) && (iVar3 = iVar2, (_File->_flag & 0x108U) != 0)) &&
     (uVar4 = *(int *)&_File->_ptr - *(int *)&_File->_base, 0 < (int)uVar4)) {
    uVar1 = _fileno(_File);
    uVar1 = FUN_180025c50(uVar1,(wint_t *)_File->_base,uVar4);
    if (uVar1 == uVar4) {
      if ((char)_File->_flag < '\0') {
        _File->_flag = _File->_flag & 0xfffffffd;
      }
    }
    else {
      _File->_flag = _File->_flag | 0x20;
      iVar3 = -1;
    }
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return iVar3;
}



// WARNING: Removing unreachable block (ram,0x000180027d49)
// WARNING: Removing unreachable block (ram,0x000180027d4e)
// WARNING: Removing unreachable block (ram,0x000180027d54)
// WARNING: Removing unreachable block (ram,0x000180027d5c)
// WARNING: Removing unreachable block (ram,0x000180027d60)

int FUN_180027cb8(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
  void *_File;
  FILE *pFVar1;
  int iVar2;
  int _Index;
  int iVar3;
  longlong lVar4;
  
  iVar3 = 0;
  _lock(1);
  for (_Index = 0; _Index < DAT_18004cff0; _Index = _Index + 1) {
    lVar4 = (longlong)_Index;
    _File = *(void **)(DAT_18004cfe8 + lVar4 * 8);
    if ((_File != (void *)0x0) && ((*(byte *)((longlong)_File + 0x18) & 0x83) != 0)) {
      _lock_file2(_Index,_File);
      pFVar1 = *(FILE **)(DAT_18004cfe8 + lVar4 * 8);
      if (((*(byte *)&pFVar1->_flag & 0x83) != 0) && (iVar2 = FUN_180027bf0(pFVar1), iVar2 != -1)) {
        iVar3 = iVar3 + 1;
      }
      FUN_180025ba8(_Index,*(longlong *)(DAT_18004cfe8 + lVar4 * 8));
    }
  }
  FUN_180024d08(1);
  return iVar3;
}



// Library Function - Single Match
//  _fcloseall
// 
// Library: Visual Studio 2012 Release

int _fcloseall(void)

{
  FILE *_File;
  int iVar1;
  int iVar2;
  longlong lVar3;
  int iVar4;
  
  iVar4 = 0;
  _lock(1);
  for (iVar2 = 3; iVar2 < DAT_18004cff0; iVar2 = iVar2 + 1) {
    lVar3 = (longlong)iVar2;
    _File = *(FILE **)(DAT_18004cfe8 + lVar3 * 8);
    if (_File != (FILE *)0x0) {
      if ((*(byte *)&_File->_flag & 0x83) != 0) {
        iVar1 = fclose(_File);
        if (iVar1 != -1) {
          iVar4 = iVar4 + 1;
        }
      }
      if (0x13 < iVar2) {
        DeleteCriticalSection((LPCRITICAL_SECTION)(*(longlong *)(DAT_18004cfe8 + lVar3 * 8) + 0x30))
        ;
        free(*(void **)(DAT_18004cfe8 + lVar3 * 8));
        *(undefined8 *)(DAT_18004cfe8 + lVar3 * 8) = 0;
      }
    }
  }
  FUN_180024d08(1);
  return iVar4;
}



undefined8 FUN_180027e54(uint param_1)

{
  int *piVar1;
  longlong lVar2;
  longlong lVar3;
  
  lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
  lVar2 = *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8);
  if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
    _lock(10);
    if (*(int *)(lVar3 + 0xc + lVar2) == 0) {
      FUN_1800240dc((LPCRITICAL_SECTION)(lVar3 + 0x10 + lVar2),4000);
      piVar1 = (int *)(lVar3 + 0xc + lVar2);
      *piVar1 = *piVar1 + 1;
    }
    FUN_180024d08(10);
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)
             (*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 0x10 +
             lVar3));
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined8 FUN_180027eec(uint param_1)

{
  int *piVar1;
  ulong *puVar2;
  DWORD nStdHandle;
  longlong lVar3;
  
  if ((-1 < (int)param_1) && (param_1 < DAT_18004e128)) {
    lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
    if (((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8
                   + lVar3) & 1) != 0) &&
       (*(longlong *)
         (*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + lVar3) != -1
       )) {
      if (_DAT_18004c5f0 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else {
          if (param_1 == 1) {
            nStdHandle = 0xfffffff5;
          }
          else {
            if (param_1 != 2) goto LAB_180027f62;
            nStdHandle = 0xfffffff4;
          }
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_180027f62:
      *(undefined8 *)
       (lVar3 + *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8)) =
           0xffffffffffffffff;
      return 0;
    }
  }
  piVar1 = _errno();
  *piVar1 = 9;
  puVar2 = __doserrno();
  *puVar2 = 0;
  return 0xffffffff;
}



undefined8 FUN_180027f98(uint param_1)

{
  ulong *puVar1;
  int *piVar2;
  longlong lVar3;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004e128)) {
      lVar3 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar3) & 1) != 0) {
        return *(undefined8 *)
                (*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + lVar3
                );
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
    FUN_18001fee8();
  }
  return 0xffffffffffffffff;
}



void FUN_18002800c(uint param_1)

{
                    // WARNING: Could not recover jumptable at 0x00018002802f. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((ulonglong)(param_1 & 0x1f) * 0x58 + 0x10 +
             *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8)));
  return;
}



// Library Function - Single Match
//  _putwch_nolock
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

wint_t _putwch_nolock(wchar_t _WCh)

{
  BOOL BVar1;
  wint_t local_res8 [4];
  DWORD local_res10 [6];
  
  local_res8[0] = _WCh;
  if (DAT_18004a420 == (HANDLE)0xfffffffffffffffe) {
    __initconout();
  }
  if ((DAT_18004a420 == (HANDLE)0xffffffffffffffff) ||
     (BVar1 = WriteConsoleW(DAT_18004a420,local_res8,1,local_res10,(LPVOID)0x0), BVar1 == 0)) {
    local_res8[0] = 0xffff;
  }
  return local_res8[0];
}



// Library Function - Single Match
//  __free_lconv_mon
// 
// Library: Visual Studio 2012 Release

void __free_lconv_mon(longlong param_1)

{
  if (param_1 != 0) {
    if (*(undefined **)(param_1 + 0x18) != PTR_DAT_18004a388) {
      free(*(undefined **)(param_1 + 0x18));
    }
    if (*(undefined **)(param_1 + 0x20) != PTR_DAT_18004a390) {
      free(*(undefined **)(param_1 + 0x20));
    }
    if (*(undefined **)(param_1 + 0x28) != PTR_DAT_18004a398) {
      free(*(undefined **)(param_1 + 0x28));
    }
    if (*(undefined **)(param_1 + 0x30) != PTR_DAT_18004a3a0) {
      free(*(undefined **)(param_1 + 0x30));
    }
    if (*(undefined **)(param_1 + 0x38) != PTR_DAT_18004a3a8) {
      free(*(undefined **)(param_1 + 0x38));
    }
    if (*(undefined **)(param_1 + 0x40) != PTR_DAT_18004a3b0) {
      free(*(undefined **)(param_1 + 0x40));
    }
    if (*(undefined **)(param_1 + 0x48) != PTR_DAT_18004a3b8) {
      free(*(undefined **)(param_1 + 0x48));
    }
    if (*(undefined **)(param_1 + 0x68) != PTR_DAT_18004a3d8) {
      free(*(undefined **)(param_1 + 0x68));
    }
    if (*(undefined **)(param_1 + 0x70) != PTR_DAT_18004a3e0) {
      free(*(undefined **)(param_1 + 0x70));
    }
    if (*(undefined **)(param_1 + 0x78) != PTR_DAT_18004a3e8) {
      free(*(undefined **)(param_1 + 0x78));
    }
    if (*(undefined **)(param_1 + 0x80) != PTR_DAT_18004a3f0) {
      free(*(undefined **)(param_1 + 0x80));
    }
    if (*(undefined **)(param_1 + 0x88) != PTR_DAT_18004a3f8) {
      free(*(undefined **)(param_1 + 0x88));
    }
    if (*(undefined **)(param_1 + 0x90) != PTR_DAT_18004a400) {
      free(*(undefined **)(param_1 + 0x90));
    }
  }
  return;
}



// Library Function - Single Match
//  __free_lconv_num
// 
// Library: Visual Studio 2012 Release

void __free_lconv_num(void **param_1)

{
  if (param_1 != (void **)0x0) {
    if ((undefined *)*param_1 != PTR_DAT_18004a370) {
      free(*param_1);
    }
    if ((undefined *)param_1[1] != PTR_DAT_18004a378) {
      free(param_1[1]);
    }
    if ((undefined *)param_1[2] != PTR_DAT_18004a380) {
      free(param_1[2]);
    }
    if ((undefined *)param_1[0xb] != PTR_DAT_18004a3c8) {
      free(param_1[0xb]);
    }
    if ((undefined *)param_1[0xc] != PTR_DAT_18004a3d0) {
      free(param_1[0xc]);
    }
  }
  return;
}



// Library Function - Single Match
//  __free_lc_time
// 
// Library: Visual Studio 2012 Release

void __free_lc_time(void **param_1)

{
  if (param_1 != (void **)0x0) {
    free(param_1[1]);
    free(param_1[2]);
    free(param_1[3]);
    free(param_1[4]);
    free(param_1[5]);
    free(param_1[6]);
    free(*param_1);
    free(param_1[8]);
    free(param_1[9]);
    free(param_1[10]);
    free(param_1[0xb]);
    free(param_1[0xc]);
    free(param_1[0xd]);
    free(param_1[7]);
    free(param_1[0xe]);
    free(param_1[0xf]);
    free(param_1[0x10]);
    free(param_1[0x11]);
    free(param_1[0x12]);
    free(param_1[0x13]);
    free(param_1[0x14]);
    free(param_1[0x15]);
    free(param_1[0x16]);
    free(param_1[0x17]);
    free(param_1[0x18]);
    free(param_1[0x19]);
    free(param_1[0x1a]);
    free(param_1[0x1b]);
    free(param_1[0x1c]);
    free(param_1[0x1d]);
    free(param_1[0x1e]);
    free(param_1[0x1f]);
    free(param_1[0x20]);
    free(param_1[0x21]);
    free(param_1[0x22]);
    free(param_1[0x23]);
    free(param_1[0x24]);
    free(param_1[0x25]);
    free(param_1[0x26]);
    free(param_1[0x27]);
    free(param_1[0x28]);
    free(param_1[0x29]);
    free(param_1[0x2a]);
    free(param_1[0x2d]);
    free(param_1[0x2e]);
    free(param_1[0x2f]);
    free(param_1[0x30]);
    free(param_1[0x31]);
    free(param_1[0x32]);
    free(param_1[0x2c]);
    free(param_1[0x34]);
    free(param_1[0x35]);
    free(param_1[0x36]);
    free(param_1[0x37]);
    free(param_1[0x38]);
    free(param_1[0x39]);
    free(param_1[0x33]);
    free(param_1[0x3a]);
    free(param_1[0x3b]);
    free(param_1[0x3c]);
    free(param_1[0x3d]);
    free(param_1[0x3e]);
    free(param_1[0x3f]);
    free(param_1[0x40]);
    free(param_1[0x41]);
    free(param_1[0x42]);
    free(param_1[0x43]);
    free(param_1[0x44]);
    free(param_1[0x45]);
    free(param_1[0x46]);
    free(param_1[0x47]);
    free(param_1[0x48]);
    free(param_1[0x49]);
    free(param_1[0x4a]);
    free(param_1[0x4b]);
    free(param_1[0x4c]);
    free(param_1[0x4d]);
    free(param_1[0x4e]);
    free(param_1[0x4f]);
    free(param_1[0x50]);
    free(param_1[0x51]);
    free(param_1[0x52]);
    free(param_1[0x53]);
    free(param_1[0x54]);
    free(param_1[0x55]);
    free(param_1[0x56]);
    free(param_1[0x57]);
  }
  return;
}



wint_t FUN_180028608(wint_t param_1,FILE *param_2)

{
  uint _FileHandle;
  int iVar1;
  uint uVar2;
  int *piVar3;
  undefined **ppuVar4;
  longlong lVar5;
  undefined *puVar6;
  uint uVar7;
  wint_t local_res10 [4];
  
  _FileHandle = _fileno(param_2);
  uVar7 = param_2->_flag;
  if ((uVar7 & 0x82) == 0) {
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((uVar7 & 0x40) == 0) {
      uVar2 = 0;
      if ((uVar7 & 1) != 0) {
        param_2->_cnt = 0;
        if ((uVar7 & 0x10) == 0) {
          param_2->_flag = uVar7 | 0x20;
          return 0xffff;
        }
        param_2->_ptr = param_2->_base;
        param_2->_flag = uVar7 & 0xfffffffe;
      }
      uVar7 = param_2->_flag;
      param_2->_cnt = 0;
      param_2->_flag = uVar7 & 0xffffffef | 2;
      if (((uVar7 & 0x10c) == 0) &&
         (((ppuVar4 = FUN_180025ab4(), param_2 != (FILE *)(ppuVar4 + 6) &&
           (ppuVar4 = FUN_180025ab4(), param_2 != (FILE *)(ppuVar4 + 0xc))) ||
          (iVar1 = _isatty(_FileHandle), iVar1 == 0)))) {
        _getbuf(param_2);
      }
      if ((param_2->_flag & 0x108U) == 0) {
        uVar7 = 2;
        local_res10[0] = param_1;
        uVar2 = FUN_180025c50(_FileHandle,local_res10,2);
      }
      else {
        uVar7 = *(int *)&param_2->_ptr - *(int *)&param_2->_base;
        param_2->_ptr = (char *)((longlong)param_2->_base + 2);
        param_2->_cnt = param_2->_bufsiz + -2;
        if ((int)uVar7 < 1) {
          if (_FileHandle + 2 < 2) {
            puVar6 = &DAT_180049330;
          }
          else {
            puVar6 = (undefined *)
                     ((ulonglong)(_FileHandle & 0x1f) * 0x58 +
                     *(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)_FileHandle >> 5) * 8)
                     );
          }
          if (((puVar6[8] & 0x20) != 0) && (lVar5 = FUN_180026528(_FileHandle,0,2), lVar5 == -1))
          goto LAB_18002863e;
        }
        else {
          uVar2 = FUN_180025c50(_FileHandle,(wint_t *)param_2->_base,uVar7);
        }
        *(wint_t *)param_2->_base = param_1;
      }
      if (uVar2 == uVar7) {
        return param_1;
      }
    }
    else {
      piVar3 = _errno();
      *piVar3 = 0x22;
    }
  }
LAB_18002863e:
  param_2->_flag = param_2->_flag | 0x20;
  return 0xffff;
}



// Library Function - Single Match
//  _isctype_l
// 
// Library: Visual Studio 2012 Release

int _isctype_l(int _C,int _Type,_locale_t _Locale)

{
  int iVar1;
  BOOL BVar2;
  int _CchSrc;
  ushort local_res8 [4];
  CHAR local_res20;
  CHAR local_res21;
  undefined local_res22;
  localeinfo_struct local_38;
  longlong local_28;
  char local_20;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_38,(localeinfo_struct *)_Locale);
  if (_C + 1U < 0x101) {
    local_res8[0] = (local_38.locinfo)->pctype[_C];
  }
  else {
    iVar1 = _isleadbyte_l(_C >> 8 & 0xff,(_locale_t)&local_38);
    _CchSrc = 1;
    if (iVar1 == 0) {
      local_res21 = '\0';
      local_res20 = (CHAR)_C;
    }
    else {
      local_res22 = 0;
      _CchSrc = 2;
      local_res20 = (CHAR)((uint)_C >> 8);
      local_res21 = (CHAR)_C;
    }
    BVar2 = __crtGetStringTypeA((_locale_t)&local_38,1,&local_res20,_CchSrc,local_res8,
                                (local_38.locinfo)->lc_codepage,1);
    if (BVar2 == 0) {
      if (local_20 != '\0') {
        *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
      }
      return 0;
    }
  }
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (int)((uint)local_res8[0] & _Type);
}



// Library Function - Single Match
//  _locterm
// 
// Library: Visual Studio 2012 Release

void _locterm(void)

{
  if (PTR_DAT_18004a1f0 != &DAT_18004a200) {
    _lock(0xc);
    PTR_DAT_18004a1f0 =
         (undefined *)_updatetlocinfoEx_nolock((int **)&PTR_DAT_18004a1f0,(int *)&DAT_18004a200);
    FUN_180024d08(0xc);
  }
  return;
}



DWORD FUN_1800288bc(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  int *piVar3;
  HANDLE hFile;
  ulong *puVar4;
  longlong lVar5;
  
  if (param_1 == 0xfffffffe) {
    piVar3 = _errno();
    *piVar3 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004e128)) {
      lVar5 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar5) & 1) != 0) {
        FUN_180027e54(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar5) & 1) != 0) {
          hFile = (HANDLE)FUN_180027f98(param_1);
          BVar1 = FlushFileBuffers(hFile);
          if (BVar1 == 0) {
            DVar2 = GetLastError();
          }
          else {
            DVar2 = 0;
          }
          if (DVar2 == 0) goto LAB_180028967;
          puVar4 = __doserrno();
          *puVar4 = DVar2;
        }
        piVar3 = _errno();
        *piVar3 = 9;
        DVar2 = 0xffffffff;
LAB_180028967:
        FUN_18002800c(param_1);
        return DVar2;
      }
    }
    piVar3 = _errno();
    *piVar3 = 9;
    FUN_18001fee8();
  }
  return 0xffffffff;
}



// Library Function - Single Match
//  _fclose_nolock
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

int _fclose_nolock(FILE *_File)

{
  int iVar1;
  uint uVar2;
  int *piVar3;
  ulonglong uVar4;
  
  iVar1 = -1;
  if (_File == (FILE *)0x0) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18001fee8();
    iVar1 = -1;
  }
  else {
    if ((*(byte *)&_File->_flag & 0x83) != 0) {
      iVar1 = _flush(_File);
      _freebuf(_File);
      uVar2 = _fileno(_File);
      uVar4 = FUN_180028d04(uVar2);
      if ((int)uVar4 < 0) {
        iVar1 = -1;
      }
      else {
        if (_File->_tmpfname != (char *)0x0) {
          free(_File->_tmpfname);
          _File->_tmpfname = (char *)0x0;
        }
      }
    }
    _File->_flag = 0;
  }
  return iVar1;
}



// Library Function - Single Match
//  fclose
// 
// Library: Visual Studio 2012 Release

int fclose(FILE *_File)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = -1;
  if (_File == (FILE *)0x0) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18001fee8();
    iVar1 = -1;
  }
  else {
    if ((*(byte *)&_File->_flag & 0x40) == 0) {
      _lock_file(_File);
      iVar1 = _fclose_nolock(_File);
      _unlock_file(_File);
    }
    else {
      _File->_flag = 0;
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  __initconout
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void __initconout(void)

{
  DAT_18004a420 = CreateFileW(L"CONOUT$",0x40000000,3,(LPSECURITY_ATTRIBUTES)0x0,3,0,(HANDLE)0x0);
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  _atodbl_l
//  _atoflt_l
// 
// Library: Visual Studio 2012 Release

int FID_conflict__atoflt_l(_CRT_FLOAT *_Result,char *_Str,_locale_t _Locale)

{
  int iVar1;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  byte *local_28;
  ushort local_20 [8];
  ulonglong local_10;
  
  local_10 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff78;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_48,(localeinfo_struct *)_Locale);
  FUN_180029a30(local_20,&local_28,(byte *)_Str,0,0,0,0,local_48);
  FUN_180028ec0(local_20,(uint *)_Result);
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  iVar1 = FUN_18001d2f0(local_10 ^ (ulonglong)&stack0xffffffffffffff78);
  return iVar1;
}



// WARNING: Removing unreachable block (ram,0x000180028b39)

void FUN_180028c6c(uint *param_1,byte *param_2,localeinfo_struct *param_3)

{
  byte *local_58;
  longlong local_50 [2];
  longlong local_40;
  char local_38;
  ushort local_30 [8];
  ulonglong local_20;
  
  local_20 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff68;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_50,param_3);
  FUN_180029a30(local_30,&local_58,param_2,0,0,0,0,local_50);
  FUN_180029478(local_30,param_1);
  if (local_38 != '\0') {
    *(uint *)(local_40 + 200) = *(uint *)(local_40 + 200) & 0xfffffffd;
  }
  FUN_18001d2f0(local_20 ^ (ulonglong)&stack0xffffffffffffff68);
  return;
}



void thunk_FUN_180028c7c(void)

{
  PTR_LAB_1800495d0 = _cfltcvt;
  PTR_LAB_1800495d8 = &LAB_18002ad48;
  PTR_LAB_1800495e0 = &DAT_18002ade8;
  PTR_LAB_1800495e8 = &LAB_18002ae30;
  PTR_LAB_1800495f0 = &LAB_18002aeb8;
  PTR_LAB_1800495f8 = _cfltcvt;
  PTR_LAB_180049600 = _cfltcvt_l;
  PTR_LAB_180049608 = &LAB_18002adf0;
  PTR_LAB_180049610 = _cropzeros_l;
  PTR_LAB_180049618 = _forcdecpt_l;
  return;
}



void FUN_180028c7c(void)

{
  PTR_LAB_1800495d0 = _cfltcvt;
  PTR_LAB_1800495d8 = &LAB_18002ad48;
  PTR_LAB_1800495e0 = &DAT_18002ade8;
  PTR_LAB_1800495e8 = &LAB_18002ae30;
  PTR_LAB_1800495f0 = &LAB_18002aeb8;
  PTR_LAB_1800495f8 = _cfltcvt;
  PTR_LAB_180049600 = _cfltcvt_l;
  PTR_LAB_180049608 = &LAB_18002adf0;
  PTR_LAB_180049610 = _cropzeros_l;
  PTR_LAB_180049618 = _forcdecpt_l;
  return;
}



ulonglong FUN_180028d04(uint param_1)

{
  ulong *puVar1;
  int *piVar2;
  ulonglong uVar3;
  longlong lVar4;
  
  if (param_1 == 0xfffffffe) {
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
  }
  else {
    if ((-1 < (int)param_1) && (param_1 < DAT_18004e128)) {
      lVar4 = (ulonglong)(param_1 & 0x1f) * 0x58;
      if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8
                    + lVar4) & 1) != 0) {
        FUN_180027e54(param_1);
        if ((*(byte *)(*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) +
                       8 + lVar4) & 1) == 0) {
          piVar2 = _errno();
          *piVar2 = 9;
          uVar3 = 0xffffffff;
        }
        else {
          uVar3 = FUN_180028dc8(param_1);
          uVar3 = uVar3 & 0xffffffff;
        }
        FUN_18002800c(param_1);
        return uVar3;
      }
    }
    puVar1 = __doserrno();
    *puVar1 = 0;
    piVar2 = _errno();
    *piVar2 = 9;
    FUN_18001fee8();
  }
  return 0xffffffff;
}



undefined8 FUN_180028dc8(uint param_1)

{
  BOOL BVar1;
  DWORD DVar2;
  longlong lVar3;
  longlong lVar4;
  HANDLE hObject;
  undefined8 uVar5;
  
  lVar3 = FUN_180027f98(param_1);
  if (lVar3 != -1) {
    if (((param_1 == 1) && ((*(byte *)(DAT_18004c2e0 + 0xb8) & 1) != 0)) ||
       ((param_1 == 2 && ((*(byte *)(DAT_18004c2e0 + 0x60) & 1) != 0)))) {
      lVar3 = FUN_180027f98(2);
      lVar4 = FUN_180027f98(1);
      if (lVar4 == lVar3) goto LAB_180028e3b;
    }
    hObject = (HANDLE)FUN_180027f98(param_1);
    BVar1 = CloseHandle(hObject);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
      goto LAB_180028e3d;
    }
  }
LAB_180028e3b:
  DVar2 = 0;
LAB_180028e3d:
  FUN_180027eec(param_1);
  *(undefined *)
   (*(longlong *)((longlong)&DAT_18004c2e0 + ((longlong)(int)param_1 >> 5) * 8) + 8 +
   (ulonglong)(param_1 & 0x1f) * 0x58) = 0;
  if (DVar2 == 0) {
    uVar5 = 0;
  }
  else {
    _dosmaperr(DVar2);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



// Library Function - Single Match
//  _freebuf
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

void _freebuf(FILE *_File)

{
  if (((*(byte *)&_File->_flag & 0x83) != 0) && ((*(byte *)&_File->_flag & 8) != 0)) {
    free(_File->_base);
    _File->_flag = _File->_flag & 0xfffffbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



void FUN_180028ec0(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  undefined8 *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined auStack136 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_180049180 ^ (ulonglong)auStack136;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_18004a440 + -1;
    uVar7 = DAT_18004a440 >> 0x1f & 0x1f;
    uVar1 = DAT_18004a440 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180028fe1;
        }
      }
      else {
LAB_180028fe1:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *(uint *)puVar13 = *(uint *)puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_18001d980((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_18004a43c - DAT_18004a440) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else {
      if (DAT_18004a43c < iVar11) {
        uVar10 = DAT_18004a444 >> 0x1f & 0x1f;
        iVar15 = DAT_18004a444 + uVar10;
        bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
        iVar15 = iVar15 >> 5;
        uVar10 = ~(-1 << (bVar4 & 0x1f));
        if (iVar11 < DAT_18004a438) {
          local_40 = local_40 & 0xffffffff7fffffff;
          iVar2 = DAT_18004a44c + iVar11;
          puVar13 = &local_40;
          do {
            uVar1 = *(uint *)puVar13;
            *(uint *)puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
        }
        else {
          local_40 = 0x80000000;
          local_38 = 0;
          puVar13 = &local_40;
          do {
            uVar1 = (uint)uVar3;
            uVar3 = (ulonglong)((uVar10 & *(uint *)puVar13) << (0x20 - bVar4 & 0x1f));
            *(uint *)puVar13 = *(uint *)puVar13 >> (bVar4 & 0x1f) | uVar1;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
          iVar2 = DAT_18004a44c + DAT_18004a438;
        }
      }
      else {
        local_40 = local_48;
        local_38 = local_50;
        uVar10 = DAT_18004a43c - local_68 >> 0x1f & 0x1f;
        puVar13 = &local_40;
        iVar2 = (DAT_18004a43c - local_68) + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        uVar6 = uVar3;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar16 = (longlong)(iVar2 >> 5);
        lVar17 = 2;
        lVar18 = 3;
        lVar5 = 2;
        do {
          if (lVar5 < lVar16) {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
          }
          lVar5 = lVar5 + -1;
        } while (-1 < lVar5);
        uVar1 = local_60 + 1 >> 0x1f & 0x1f;
        uVar10 = local_60 + 1 + uVar1;
        iVar2 = (int)uVar10 >> 5;
        uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
        bVar4 = (byte)uVar10;
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
          if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0)
          {
            for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
              if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_1800291bb;
            }
          }
          else {
LAB_1800291bb:
            uVar10 = local_60 >> 0x1f & 0x1f;
            iVar11 = local_60 + uVar10;
            iVar15 = iVar11 >> 5;
            uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
            uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
            uVar10 = uVar1 + uVar7;
            if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
            lVar5 = (longlong)(iVar15 + -1);
            if (-1 < iVar15 + -1) {
              do {
                if ((int)uVar6 == 0) break;
                uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
                uVar10 = uVar1 + 1;
                if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                  uVar6 = uVar9;
                }
                *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
                lVar5 = lVar5 + -1;
              } while (-1 < lVar5);
            }
          }
        }
        puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar2 * 4);
        *(uint *)puVar13 = *(uint *)puVar13 & -1 << (bVar4 & 0x1f);
        lVar5 = (longlong)(iVar2 + 1);
        if (lVar5 < 3) {
          FUN_18001d980((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
        }
        puVar13 = &local_40;
        uVar10 = DAT_18004a444 + 1 >> 0x1f & 0x1f;
        iVar2 = DAT_18004a444 + 1 + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar18 = lVar18 + -1;
        } while (lVar18 != 0);
        lVar5 = (longlong)(iVar2 >> 5);
        do {
          if (lVar17 < lVar5) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = 0;
      }
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  local_40._0_4_ =
       iVar2 << (0x1fU - (char)DAT_18004a444 & 0x1f) | -(uint)bVar19 & 0x80000000 | (uint)local_40;
  if (DAT_18004a448 == 0x40) {
    local_58[1] = (uint)local_40;
    *local_58 = local_40._4_4_;
  }
  else {
    if (DAT_18004a448 == 0x20) {
      *local_58 = (uint)local_40;
    }
  }
  FUN_18001d2f0(local_30 ^ (ulonglong)auStack136);
  return;
}



void FUN_180029478(ushort *param_1,uint *param_2)

{
  uint uVar1;
  int iVar2;
  ulonglong uVar3;
  byte bVar4;
  longlong lVar5;
  ulonglong uVar6;
  uint uVar7;
  uint uVar8;
  ulonglong uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  undefined8 *puVar13;
  int iVar14;
  int iVar15;
  longlong lVar16;
  longlong lVar17;
  longlong lVar18;
  bool bVar19;
  undefined auStack136 [32];
  int local_68;
  uint local_64;
  int local_60;
  uint *local_58;
  int local_50;
  uint local_4c;
  ulonglong local_48;
  undefined8 local_40;
  int local_38;
  ulonglong local_30;
  
  local_30 = DAT_180049180 ^ (ulonglong)auStack136;
  uVar3 = 0;
  local_64 = param_1[5] & 0x8000;
  local_50 = (uint)*param_1 << 0x10;
  uVar10 = param_1[5] & 0x7fff;
  iVar11 = uVar10 - 0x3fff;
  local_40 = CONCAT44(*(undefined4 *)(param_1 + 1),*(undefined4 *)(param_1 + 3));
  local_38 = local_50;
  uVar9 = 1;
  lVar17 = 3;
  iVar2 = 0;
  local_58 = param_2;
  if (iVar11 == -0x3fff) {
    do {
      if (*(int *)((longlong)&local_40 + uVar3 * 4) != 0) {
        local_40 = 0;
        local_38 = 0;
        iVar2 = 0;
        break;
      }
      uVar3 = uVar3 + 1;
    } while ((longlong)uVar3 < 3);
  }
  else {
    local_48 = local_40;
    local_60 = DAT_18004a458 + -1;
    uVar7 = DAT_18004a458 >> 0x1f & 0x1f;
    uVar1 = DAT_18004a458 + uVar7;
    iVar14 = (int)uVar1 >> 5;
    local_4c = 0x1f - ((uVar1 & 0x1f) - uVar7);
    iVar15 = 0;
    if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) >> (local_4c & 0x1f) & 1) != 0) {
      if ((*(uint *)((longlong)&local_40 + (longlong)iVar14 * 4) & ~(-1 << ((byte)local_4c & 0x1f)))
          == 0) {
        for (lVar5 = (longlong)(iVar14 + 1); iVar15 = iVar2, lVar5 < 3; lVar5 = lVar5 + 1) {
          if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180029599;
        }
      }
      else {
LAB_180029599:
        uVar1 = local_60 >> 0x1f & 0x1f;
        iVar2 = local_60 + uVar1;
        iVar12 = iVar2 >> 5;
        uVar7 = *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4);
        uVar8 = 1 << (0x1f - (((byte)iVar2 & 0x1f) - (char)uVar1) & 0x1f);
        uVar1 = uVar7 + uVar8;
        if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 < uVar8)) {
          uVar6 = 1;
        }
        *(uint *)((longlong)&local_40 + (longlong)iVar12 * 4) = uVar1;
        lVar5 = (longlong)(iVar12 + -1);
        iVar15 = (int)uVar6;
        if (-1 < iVar12 + -1) {
          do {
            iVar15 = (int)uVar6;
            if ((int)uVar6 == 0) break;
            uVar7 = *(uint *)((longlong)&local_40 + lVar5 * 4);
            uVar1 = uVar7 + 1;
            if ((uVar1 < uVar7) || (uVar6 = uVar3, uVar1 == 0)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar1;
            lVar5 = lVar5 + -1;
            iVar15 = (int)uVar6;
          } while (-1 < lVar5);
        }
      }
    }
    puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar14 * 4);
    *(uint *)puVar13 = *(uint *)puVar13 & -1 << ((byte)local_4c & 0x1f);
    lVar5 = (longlong)(iVar14 + 1);
    local_68 = iVar11;
    if (lVar5 < 3) {
      FUN_18001d980((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
    }
    if (iVar15 != 0) {
      iVar11 = uVar10 - 0x3ffe;
    }
    if (iVar11 < DAT_18004a454 - DAT_18004a458) {
      local_40 = 0;
      local_38 = 0;
      iVar2 = 0;
    }
    else {
      if (DAT_18004a454 < iVar11) {
        uVar10 = DAT_18004a45c >> 0x1f & 0x1f;
        iVar15 = DAT_18004a45c + uVar10;
        bVar4 = ((byte)iVar15 & 0x1f) - (char)uVar10;
        iVar15 = iVar15 >> 5;
        uVar10 = ~(-1 << (bVar4 & 0x1f));
        if (iVar11 < DAT_18004a450) {
          local_40 = local_40 & 0xffffffff7fffffff;
          iVar2 = DAT_18004a464 + iVar11;
          puVar13 = &local_40;
          do {
            uVar1 = *(uint *)puVar13;
            *(uint *)puVar13 = uVar1 >> (bVar4 & 0x1f) | (uint)uVar3;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            uVar3 = (ulonglong)((uVar1 & uVar10) << (0x20 - bVar4 & 0x1f));
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
        }
        else {
          local_40 = 0x80000000;
          local_38 = 0;
          puVar13 = &local_40;
          do {
            uVar1 = (uint)uVar3;
            uVar3 = (ulonglong)((uVar10 & *(uint *)puVar13) << (0x20 - bVar4 & 0x1f));
            *(uint *)puVar13 = *(uint *)puVar13 >> (bVar4 & 0x1f) | uVar1;
            puVar13 = (undefined8 *)((longlong)puVar13 + 4);
            lVar17 = lVar17 + -1;
          } while (lVar17 != 0);
          lVar17 = 2;
          do {
            if (lVar17 < iVar15) {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
            }
            else {
              *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                   *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + (longlong)iVar15 * -4);
            }
            lVar17 = lVar17 + -1;
          } while (-1 < lVar17);
          iVar2 = DAT_18004a464 + DAT_18004a450;
        }
      }
      else {
        local_40 = local_48;
        local_38 = local_50;
        uVar10 = DAT_18004a454 - local_68 >> 0x1f & 0x1f;
        puVar13 = &local_40;
        iVar2 = (DAT_18004a454 - local_68) + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        uVar6 = uVar3;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar6;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar6 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar17 = lVar17 + -1;
        } while (lVar17 != 0);
        lVar16 = (longlong)(iVar2 >> 5);
        lVar17 = 2;
        lVar18 = 3;
        lVar5 = 2;
        do {
          if (lVar5 < lVar16) {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar5 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar5 * 4 + lVar16 * -4);
          }
          lVar5 = lVar5 + -1;
        } while (-1 < lVar5);
        uVar1 = local_60 + 1 >> 0x1f & 0x1f;
        uVar10 = local_60 + 1 + uVar1;
        iVar2 = (int)uVar10 >> 5;
        uVar10 = 0x1f - ((uVar10 & 0x1f) - uVar1);
        bVar4 = (byte)uVar10;
        if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) >> (uVar10 & 0x1f) & 1) != 0) {
          if ((*(uint *)((longlong)&local_40 + (longlong)iVar2 * 4) & ~(-1 << (bVar4 & 0x1f))) == 0)
          {
            for (lVar5 = (longlong)(iVar2 + 1); lVar5 < 3; lVar5 = lVar5 + 1) {
              if (*(int *)((longlong)&local_40 + lVar5 * 4) != 0) goto LAB_180029773;
            }
          }
          else {
LAB_180029773:
            uVar10 = local_60 >> 0x1f & 0x1f;
            iVar11 = local_60 + uVar10;
            iVar15 = iVar11 >> 5;
            uVar1 = *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4);
            uVar7 = 1 << (0x1f - (((byte)iVar11 & 0x1f) - (char)uVar10) & 0x1f);
            uVar10 = uVar1 + uVar7;
            if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 < uVar7)) {
              uVar6 = uVar9;
            }
            *(uint *)((longlong)&local_40 + (longlong)iVar15 * 4) = uVar10;
            lVar5 = (longlong)(iVar15 + -1);
            if (-1 < iVar15 + -1) {
              do {
                if ((int)uVar6 == 0) break;
                uVar1 = *(uint *)((longlong)&local_40 + lVar5 * 4);
                uVar10 = uVar1 + 1;
                if ((uVar10 < uVar1) || (uVar6 = uVar3, uVar10 == 0)) {
                  uVar6 = uVar9;
                }
                *(uint *)((longlong)&local_40 + lVar5 * 4) = uVar10;
                lVar5 = lVar5 + -1;
              } while (-1 < lVar5);
            }
          }
        }
        puVar13 = (undefined8 *)((longlong)&local_40 + (longlong)iVar2 * 4);
        *(uint *)puVar13 = *(uint *)puVar13 & -1 << (bVar4 & 0x1f);
        lVar5 = (longlong)(iVar2 + 1);
        if (lVar5 < 3) {
          FUN_18001d980((undefined (*) [16])((longlong)&local_40 + lVar5 * 4),0,(3 - lVar5) * 4);
        }
        puVar13 = &local_40;
        uVar10 = DAT_18004a45c + 1 >> 0x1f & 0x1f;
        iVar2 = DAT_18004a45c + 1 + uVar10;
        bVar4 = ((byte)iVar2 & 0x1f) - (char)uVar10;
        do {
          uVar10 = *(uint *)puVar13;
          *(uint *)puVar13 = uVar10 >> (bVar4 & 0x1f) | (uint)uVar3;
          puVar13 = (undefined8 *)((longlong)puVar13 + 4);
          uVar3 = (ulonglong)((uVar10 & ~(-1 << (bVar4 & 0x1f))) << (0x20 - bVar4 & 0x1f));
          lVar18 = lVar18 + -1;
        } while (lVar18 != 0);
        lVar5 = (longlong)(iVar2 >> 5);
        do {
          if (lVar17 < lVar5) {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) = 0;
          }
          else {
            *(undefined4 *)((longlong)&local_40 + lVar17 * 4) =
                 *(undefined4 *)((longlong)&local_40 + lVar17 * 4 + lVar5 * -4);
          }
          lVar17 = lVar17 + -1;
        } while (-1 < lVar17);
        iVar2 = 0;
      }
    }
  }
  bVar19 = local_64 != 0;
  local_64 = -local_64;
  local_40._0_4_ =
       iVar2 << (0x1fU - (char)DAT_18004a45c & 0x1f) | -(uint)bVar19 & 0x80000000 | (uint)local_40;
  if (DAT_18004a460 == 0x40) {
    local_58[1] = (uint)local_40;
    *local_58 = local_40._4_4_;
  }
  else {
    if (DAT_18004a460 == 0x20) {
      *local_58 = (uint)local_40;
    }
  }
  FUN_18001d2f0(local_30 ^ (ulonglong)auStack136);
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_180029a30(undefined2 *param_1,byte **param_2,byte *param_3,int param_4,int param_5,
                  int param_6,int param_7,longlong *param_8)

{
  ushort uVar1;
  uint uVar2;
  int *piVar3;
  ushort uVar4;
  uint uVar5;
  byte bVar6;
  ulonglong uVar7;
  undefined2 uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  undefined **ppuVar12;
  byte **ppbVar13;
  uint uVar14;
  byte *pbVar15;
  ushort *puVar16;
  ushort uVar17;
  byte *pbVar18;
  uint uVar19;
  uint *puVar20;
  int iVar21;
  char *pcVar22;
  int iVar23;
  ushort uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  undefined auStack216 [32];
  int local_b8;
  int local_b4;
  uint local_b0;
  int local_ac;
  byte **local_a8;
  undefined **local_a0;
  undefined2 *local_98;
  byte local_90;
  undefined uStack143;
  undefined2 uStack142;
  ushort auStack140 [6];
  undefined8 local_80;
  undefined2 uStack120;
  ushort uStack118;
  byte *local_70;
  undefined4 local_68;
  char local_60 [23];
  char local_49;
  ulonglong local_40;
  
  local_40 = DAT_180049180 ^ (ulonglong)auStack216;
  uVar9 = 0;
  uVar2 = 0;
  pcVar22 = local_60;
  uVar8 = 0;
  local_b0 = local_b0 & 0xffff0000;
  iVar10 = 0;
  local_b4 = 1;
  local_b8 = 0;
  uVar27 = 0;
  pbVar15 = param_3;
  local_ac = param_4;
  local_a8 = param_2;
  local_98 = param_1;
  if (param_8 == (longlong *)0x0) {
    piVar3 = _errno();
    *piVar3 = 0x16;
    FUN_18001fee8();
    goto LAB_18002a26a;
  }
  while ((uVar14 = uVar9, uVar5 = uVar9, uVar11 = uVar9, uVar19 = uVar9, uVar25 = uVar9,
         *pbVar15 < 0x21 &&
         (uVar14 = 0, uVar5 = 0, uVar11 = 0, uVar19 = 0, uVar25 = 0,
         (0x100002600U >> ((longlong)(char)*pbVar15 & 0x3fU) & 1) != 0))) {
    pbVar15 = pbVar15 + 1;
  }
LAB_180029acd:
  do {
    bVar6 = *pbVar15;
    pbVar18 = pbVar15 + 1;
    uVar26 = uVar2;
    if (uVar5 < 6) {
      if (uVar5 == 5) {
        local_b8 = 1;
        pbVar15 = param_3;
        uVar26 = 0;
        if (9 < (byte)(bVar6 - 0x30)) break;
        uVar5 = 4;
      }
      else {
        if (uVar5 != 0) {
          if (uVar5 == 1) {
            uVar14 = 1;
            if ((byte)(bVar6 - 0x31) < 9) {
              uVar5 = 3;
              pbVar15 = param_3;
              goto LAB_180029bf0;
            }
            if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) {
LAB_180029bd4:
              uVar14 = 1;
              uVar5 = 4;
              pbVar15 = pbVar18;
              goto LAB_180029acd;
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) goto LAB_180029b84;
            if (bVar6 == 0x30) goto LAB_180029c28;
          }
          else {
            if (uVar5 == 2) {
              if ((byte)(bVar6 - 0x31) < 9) goto LAB_180029be5;
              if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) goto LAB_180029c09;
              pbVar15 = param_3;
              if (bVar6 == 0x30) goto LAB_180029c28;
              break;
            }
            if (uVar5 == 3) {
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar19 < 0x19) {
                  uVar19 = uVar19 + 1;
                  *pcVar22 = bVar6 - 0x30;
                  pcVar22 = pcVar22 + 1;
                }
                else {
                  uVar11 = uVar11 + 1;
                }
                bVar6 = *pbVar18;
                pbVar18 = pbVar18 + 1;
              }
              if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) goto LAB_180029bd4;
            }
            else {
              if (uVar5 != 4) goto LAB_180029dab;
              local_b8 = 1;
              if (uVar19 == 0) {
                while (bVar6 == 0x30) {
                  uVar11 = uVar11 - 1;
                  bVar6 = *pbVar18;
                  pbVar18 = pbVar18 + 1;
                }
              }
              while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
                if (uVar19 < 0x19) {
                  uVar19 = uVar19 + 1;
                  *pcVar22 = bVar6 - 0x30;
                  pcVar22 = pcVar22 + 1;
                  uVar11 = uVar11 - 1;
                }
                bVar6 = *pbVar18;
                pbVar18 = pbVar18 + 1;
              }
            }
            if ((bVar6 - 0x2b & 0xfd) == 0) {
LAB_180029b84:
              uVar14 = 1;
              uVar5 = 0xb;
              pbVar15 = pbVar18 + -1;
              goto LAB_180029acd;
            }
          }
          uVar14 = 1;
          uVar26 = 0;
          if (((char)bVar6 < 'D') ||
             (('E' < (char)bVar6 && (uVar26 = uVar27, bVar6 != 100 && bVar6 != 0x65))))
          goto LAB_180029ca5;
          uVar5 = 6;
          pbVar15 = pbVar18;
          uVar14 = 1;
          goto LAB_180029acd;
        }
        if (8 < (byte)(bVar6 - 0x31)) {
          if (bVar6 == ***(byte ***)(*param_8 + 0xf0)) {
LAB_180029c09:
            uVar5 = 5;
            pbVar15 = pbVar18;
          }
          else {
            if (bVar6 == 0x2b) {
              uVar5 = 2;
              local_b0 = local_b0 & 0xffff0000;
              pbVar15 = pbVar18;
            }
            else {
              if (bVar6 == 0x2d) {
                uVar5 = 2;
                local_b0 = 0x8000;
                pbVar15 = pbVar18;
              }
              else {
                uVar26 = uVar27;
                if (bVar6 != 0x30) goto LAB_180029ca5;
LAB_180029c28:
                uVar5 = 1;
                pbVar15 = pbVar18;
              }
            }
          }
          goto LAB_180029acd;
        }
LAB_180029be5:
        uVar5 = 3;
        pbVar15 = param_3;
      }
LAB_180029bf0:
      param_3 = pbVar15;
      pbVar15 = pbVar18 + -1;
      goto LAB_180029acd;
    }
    if (uVar5 == 6) {
      pbVar15 = pbVar15 + -1;
      if ((byte)(bVar6 - 0x31) < 9) goto LAB_180029d72;
      if (bVar6 != 0x2b) {
        if (bVar6 != 0x2d) goto LAB_180029d7c;
LAB_180029d27:
        local_b4 = -1;
        uVar5 = 7;
        param_3 = pbVar15;
        pbVar15 = pbVar18;
        goto LAB_180029acd;
      }
      uVar5 = 7;
      param_3 = pbVar15;
    }
    else {
      if (uVar5 == 7) {
        pbVar15 = param_3;
        if ((byte)(bVar6 - 0x31) < 9) {
LAB_180029d72:
          uVar5 = 9;
          goto LAB_180029bf0;
        }
LAB_180029d7c:
        if (bVar6 != 0x30) break;
        uVar5 = 8;
        param_3 = pbVar15;
        pbVar15 = pbVar18;
        goto LAB_180029acd;
      }
      if (uVar5 == 8) {
        uVar25 = 1;
        while (bVar6 == 0x30) {
          bVar6 = *pbVar18;
          pbVar18 = pbVar18 + 1;
        }
        uVar26 = uVar27;
        if ((byte)(bVar6 - 0x31) < 9) {
          uVar5 = 9;
          pbVar15 = param_3;
          uVar25 = 1;
          goto LAB_180029bf0;
        }
        goto LAB_180029ca5;
      }
      if (uVar5 == 9) {
        uVar25 = 1;
        uVar26 = uVar9;
        goto LAB_180029dec;
      }
      if (uVar5 == 0xb) {
        uVar26 = uVar27;
        if (param_7 == 0) goto LAB_180029ca5;
        if (bVar6 != 0x2b) {
          uVar26 = uVar2;
          if (bVar6 == 0x2d) goto LAB_180029d27;
          break;
        }
        uVar5 = 7;
        param_3 = pbVar15;
        pbVar15 = pbVar18;
        goto LAB_180029acd;
      }
    }
LAB_180029dab:
    pbVar15 = pbVar18;
  } while (uVar5 != 10);
  goto LAB_180029e1d;
LAB_180029dec:
  if (((char)bVar6 < '0') || ('9' < (char)bVar6)) goto LAB_180029e0a;
  uVar26 = (int)(char)bVar6 + (uVar26 * 5 + -0x18) * 2;
  if ((int)uVar26 < 0x1451) {
    bVar6 = *pbVar18;
    pbVar18 = pbVar18 + 1;
    goto LAB_180029dec;
  }
  uVar26 = 0x1451;
LAB_180029e0a:
  while (('/' < (char)bVar6 && ((char)bVar6 < ':'))) {
    bVar6 = *pbVar18;
    pbVar18 = pbVar18 + 1;
  }
LAB_180029ca5:
  pbVar15 = pbVar18 + -1;
LAB_180029e1d:
  *param_2 = pbVar15;
  iVar21 = iVar10;
  if (uVar14 == 0) {
    uVar8 = 0;
    uVar1 = 0;
  }
  else {
    if (0x18 < uVar19) {
      if ('\x04' < local_49) {
        local_49 = local_49 + '\x01';
      }
      pcVar22 = pcVar22 + -1;
      uVar19 = 0x18;
      uVar11 = uVar11 + 1;
    }
    if (uVar19 == 0) {
      uVar1 = 0;
      uVar8 = 0;
    }
    else {
      while (pcVar22 = pcVar22 + -1, *pcVar22 == '\0') {
        uVar19 = uVar19 - 1;
        uVar11 = uVar11 + 1;
      }
      FUN_18002aecc(local_60,uVar19,&local_80);
      if (local_b4 < 0) {
        uVar26 = -uVar26;
      }
      uVar26 = uVar26 + uVar11;
      if (uVar25 == 0) {
        uVar26 = uVar26 + param_5;
      }
      if (local_b8 == 0) {
        uVar26 = uVar26 - param_6;
      }
      if ((int)uVar26 < 0x1451) {
        if ((int)uVar26 < -0x1450) {
          uVar1 = 0;
        }
        else {
          ppuVar12 = &PTR_PTR_DAT_18004a410;
          if (uVar26 != 0) {
            if ((int)uVar26 < 0) {
              uVar26 = -uVar26;
              ppuVar12 = (undefined **)0x18004a570;
            }
            if (local_ac == 0) {
              local_80._0_2_ = 0;
            }
joined_r0x000180029ee5:
            do {
              if (uVar26 == 0) break;
              ppuVar12 = (undefined **)((longlong)ppuVar12 + 0x54);
              uVar27 = (int)uVar26 >> 3;
              uVar2 = uVar26 & 7;
              uVar26 = uVar27;
              local_a0 = ppuVar12;
              if (uVar2 != 0) {
                local_a8 = (byte **)((longlong)ppuVar12 + (longlong)(int)uVar2 * 0xc);
                if (0x7fff < *(ushort *)local_a8) {
                  ppbVar13 = local_a8 + 1;
                  pbVar15 = *local_a8;
                  local_a8 = &local_70;
                  local_68 = *(undefined4 *)ppbVar13;
                  local_70._0_6_ = CONCAT42((int)((ulonglong)pbVar15 >> 0x10) + -1,(short)pbVar15);
                  local_70 = (byte *)((ulonglong)pbVar15 & 0xffff000000000000 |
                                     (ulonglong)(uint6)local_70);
                }
                local_90 = 0;
                uStack143 = 0;
                uStack142 = 0;
                auStack140[0] = 0;
                auStack140[1] = 0;
                uVar1 = *(ushort *)((longlong)local_a8 + 10) & 0x7fff;
                auStack140[2] = 0;
                auStack140[3] = 0;
                uVar4 = uStack118 & 0x7fff;
                uVar24 = (*(ushort *)((longlong)local_a8 + 10) ^ uStack118) & 0x8000;
                uVar17 = uVar4 + uVar1;
                if (((0x7ffe < uVar4) || (0x7ffe < uVar1)) || (0xbffd < uVar17)) {
LAB_18002a1eb:
                  local_80._0_2_ = 0;
                  local_80._2_2_ = 0;
                  local_80._4_2_ = 0;
                  local_80._6_2_ = 0;
                  iVar21 = (-(uint)(uVar24 != 0) & 0x80000000) + 0x7fff8000;
                  uStack120 = (undefined2)iVar21;
                  uStack118 = (ushort)((uint)iVar21 >> 0x10);
                  goto joined_r0x000180029ee5;
                }
                if (0x3fbf < uVar17) {
                  if (((uVar4 == 0) &&
                      (uVar17 = uVar17 + 1, (CONCAT22(uStack118,uStack120) & 0x7fffffff) == 0)) &&
                     ((CONCAT22(local_80._6_2_,local_80._4_2_) == 0 &&
                      (CONCAT22(local_80._2_2_,(undefined2)local_80) == 0)))) {
                    uStack118 = 0;
                    goto joined_r0x000180029ee5;
                  }
                  if (((uVar1 != 0) ||
                      (uVar17 = uVar17 + 1, (*(uint *)(local_a8 + 1) & 0x7fffffff) != 0)) ||
                     ((*(int *)((longlong)local_a8 + 4) != 0 || (*(int *)local_a8 != 0)))) {
                    puVar20 = (uint *)&local_90;
                    iVar21 = 5;
                    uVar2 = uVar9;
                    do {
                      local_b8 = iVar21;
                      if (0 < iVar21) {
                        ppbVar13 = local_a8 + 1;
                        puVar16 = (ushort *)((longlong)&local_80 + (longlong)(int)(uVar2 * 2));
                        do {
                          uVar27 = *puVar20 + (uint)*(ushort *)ppbVar13 * (uint)*puVar16;
                          if ((uVar27 < *puVar20) ||
                             (iVar23 = iVar10, uVar27 < (uint)*(ushort *)ppbVar13 * (uint)*puVar16))
                          {
                            iVar23 = 1;
                          }
                          *puVar20 = uVar27;
                          if (iVar23 != 0) {
                            *(short *)(puVar20 + 1) = *(short *)(puVar20 + 1) + 1;
                          }
                          puVar16 = puVar16 + 1;
                          ppbVar13 = (byte **)((longlong)ppbVar13 + -2);
                          local_b8 = local_b8 + -1;
                        } while (0 < local_b8);
                      }
                      iVar21 = iVar21 + -1;
                      puVar20 = (uint *)((longlong)puVar20 + 2);
                      uVar2 = uVar2 + 1;
                    } while (0 < iVar21);
                    uVar27 = CONCAT22(auStack140[3],auStack140[2]);
                    uVar2 = CONCAT22(uStack142,CONCAT11(uStack143,local_90));
                    uVar17 = uVar17 + 0xc002;
                    uVar14 = uVar2;
                    if ((short)uVar17 < 1) {
LAB_18002a0ec:
                      uVar17 = uVar17 - 1;
                      if (-1 < (short)uVar17) goto LAB_18002a156;
                      uVar7 = (ulonglong)(ushort)-uVar17;
                      uVar17 = 0;
                      uVar14 = uVar9;
                      do {
                        uVar5 = uVar27;
                        if ((local_90 & 1) != 0) {
                          uVar14 = uVar14 + 1;
                        }
                        uVar11 = CONCAT22(auStack140[1],auStack140[0]);
                        uVar19 = uVar2 >> 1;
                        auStack140[1] = auStack140[1] >> 1 | (ushort)((uVar5 << 0x1f) >> 0x10);
                        uVar27 = uVar5 >> 1;
                        uVar2 = uVar19 | uVar11 << 0x1f;
                        auStack140[0] = (ushort)(uVar11 >> 1);
                        local_90 = (byte)uVar19;
                        uStack143 = (undefined)(uVar19 >> 8);
                        uStack142 = (undefined2)(uVar2 >> 0x10);
                        uVar7 = uVar7 - 1;
                      } while (uVar7 != 0);
                      auStack140[2] = (ushort)uVar27;
                      auStack140[3] = (ushort)(uVar5 >> 0x11);
                      if (uVar14 == 0) goto LAB_18002a156;
                      uVar1 = (ushort)uVar19 | 1;
                      local_90 = (byte)uVar1;
                      uVar2 = uVar19 | 1;
                    }
                    else {
                      do {
                        uVar2 = uVar14;
                        if ((uVar27 & 0x80000000) != 0) break;
                        uVar5 = uVar27 * 2;
                        uVar2 = uVar14 * 2;
                        iVar21 = CONCAT22(auStack140[1],auStack140[0]) * 2;
                        uVar17 = uVar17 - 1;
                        auStack140[0] = (ushort)iVar21 | (ushort)(uVar14 >> 0x1f);
                        uVar27 = uVar5 | auStack140[1] >> 0xf;
                        local_90 = (byte)uVar2;
                        uStack143 = (undefined)(uVar2 >> 8);
                        uStack142 = (undefined2)(uVar2 >> 0x10);
                        auStack140[1] = (ushort)((uint)iVar21 >> 0x10);
                        auStack140[2] = (ushort)uVar27;
                        auStack140[3] = (ushort)(uVar5 >> 0x10);
                        uVar14 = uVar2;
                      } while (0 < (short)uVar17);
                      if ((short)uVar17 < 1) goto LAB_18002a0ec;
LAB_18002a156:
                      uVar1 = CONCAT11(uStack143,local_90);
                    }
                    if ((0x8000 < uVar1) || ((uVar2 & 0x1ffff) == 0x18000)) {
                      if (CONCAT22(auStack140[0],uStack142) == -1) {
                        uStack142 = 0;
                        auStack140[0] = 0;
                        if (CONCAT22(auStack140[2],auStack140[1]) == -1) {
                          auStack140[1] = 0;
                          auStack140[2] = 0;
                          if (auStack140[3] == 0xffff) {
                            auStack140[3] = 0x8000;
                            uVar17 = uVar17 + 1;
                          }
                          else {
                            auStack140[3] = auStack140[3] + 1;
                          }
                        }
                        else {
                          iVar21 = CONCAT22(auStack140[2],auStack140[1]) + 1;
                          auStack140[1] = (ushort)iVar21;
                          auStack140[2] = (ushort)((uint)iVar21 >> 0x10);
                        }
                        uVar27 = CONCAT22(auStack140[3],auStack140[2]);
                      }
                      else {
                        iVar21 = CONCAT22(auStack140[0],uStack142) + 1;
                        uStack142 = (undefined2)iVar21;
                        auStack140[0] = (ushort)((uint)iVar21 >> 0x10);
                      }
                    }
                    if (0x7ffe < uVar17) goto LAB_18002a1eb;
                    local_80._6_2_ = (undefined2)uVar27;
                    uStack120 = (undefined2)(uVar27 >> 0x10);
                    local_80._0_2_ = uStack142;
                    uStack118 = uVar17 | uVar24;
                    local_80._2_2_ = auStack140[0];
                    local_80._4_2_ = auStack140[1];
                    goto joined_r0x000180029ee5;
                  }
                }
                local_80._4_2_ = 0;
                local_80._6_2_ = 0;
                uStack120 = 0;
                uStack118 = 0;
                local_80._0_2_ = 0;
                local_80._2_2_ = 0;
              }
            } while( true );
          }
          iVar10 = CONCAT22(local_80._4_2_,local_80._2_2_);
          uVar1 = uStack118;
          uVar8 = (undefined2)local_80;
          iVar21 = CONCAT22(uStack120,local_80._6_2_);
        }
      }
      else {
        uVar8 = 0;
        uVar1 = 0x7fff;
        iVar21 = -0x80000000;
      }
    }
  }
  local_98[5] = uVar1 | (ushort)local_b0;
  *local_98 = uVar8;
  *(int *)(local_98 + 1) = iVar10;
  *(int *)(local_98 + 3) = iVar21;
LAB_18002a26a:
  FUN_18001d2f0(local_40 ^ (ulonglong)auStack216);
  return;
}



// Library Function - Single Match
//  _cfltcvt
// 
// Library: Visual Studio 2012 Release

errno_t _cfltcvt(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps)

{
  errno_t eVar1;
  
  eVar1 = _cfltcvt_l(arg,buffer,sizeInBytes,format,precision,caps,(_locale_t)0x0);
  return eVar1;
}



// Library Function - Single Match
//  _cfltcvt_l
// 
// Library: Visual Studio 2012 Release

errno_t _cfltcvt_l(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps,
                  _locale_t plocinfo)

{
  int iVar1;
  
  if ((format - 0x45U & 0xffffffdf) == 0) {
    iVar1 = _cftoe_l(arg,buffer,(undefined *)sizeInBytes,precision,caps,
                     (localeinfo_struct *)plocinfo);
  }
  else {
    if (format == 0x66) {
      iVar1 = _cftof_l(arg,(undefined8 *)buffer,sizeInBytes,precision,(localeinfo_struct *)plocinfo)
      ;
    }
    else {
      if ((format - 0x41U & 0xffffffdf) == 0) {
        iVar1 = FUN_18002a338((ulonglong *)arg,buffer,(undefined *)sizeInBytes,
                              (ulonglong)(uint)precision,caps,(localeinfo_struct *)plocinfo);
      }
      else {
        iVar1 = _cftog_l(arg,(undefined8 *)buffer,(undefined *)sizeInBytes,precision,caps,
                         (localeinfo_struct *)plocinfo);
      }
    }
  }
  return (errno_t)iVar1;
}



int FUN_18002a338(ulonglong *param_1,undefined *param_2,undefined *param_3,ulonglong param_4,
                 int param_5,localeinfo_struct *param_6)

{
  undefined (*pauVar1) [16];
  ushort uVar2;
  int iVar3;
  int *piVar4;
  char *pcVar5;
  undefined (*pauVar6) [16];
  longlong lVar7;
  short sVar8;
  longlong lVar9;
  ulonglong uVar10;
  short sVar11;
  undefined (*pauVar12) [16];
  undefined (*pauVar13) [16];
  char *pcVar14;
  undefined *puVar15;
  ulonglong uVar16;
  ulonglong uVar17;
  longlong local_48 [2];
  longlong local_38;
  char local_30;
  
  uVar17 = 0x3ff;
  sVar11 = 0x30;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_48,param_6);
  uVar10 = param_4 & 0xffffffff;
  if ((int)(param_4 & 0xffffffff) < 0) {
    uVar10 = 0;
  }
  if ((param_2 == (undefined *)0x0) || (param_3 == (undefined *)0x0)) {
    piVar4 = _errno();
    iVar3 = 0x16;
  }
  else {
    iVar3 = (int)uVar10;
    *param_2 = 0;
    if ((undefined *)(longlong)(iVar3 + 0xb) < param_3) {
      if ((*param_1 >> 0x34 & 0x7ff) == 0x7ff) {
        puVar15 = param_3 + -2;
        if (param_3 == (undefined *)0xffffffffffffffff) {
          puVar15 = param_3;
        }
        iVar3 = _cftoe_l(param_1,param_2 + 2,puVar15,iVar3,0,(localeinfo_struct *)0x0);
        if (iVar3 != 0) {
          *param_2 = 0;
          goto LAB_18002a6b5;
        }
        if (param_2[2] == '-') {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        pcVar5 = strrchr(param_2 + 2,0x65);
        if (pcVar5 != (char *)0x0) {
          *pcVar5 = (-(param_5 != 0) & 0xe0U) + 0x70;
          pcVar5[3] = '\0';
        }
      }
      else {
        if ((*param_1 & 0x8000000000000000) != 0) {
          *param_2 = 0x2d;
          param_2 = param_2 + 1;
        }
        *param_2 = 0x30;
        param_2[1] = (-(param_5 != 0) & 0xe0U) + 0x78;
        sVar8 = (-(ushort)(param_5 != 0) & 0xffe0) + 0x27;
        if ((*param_1 & 0x7ff0000000000000) == 0) {
          param_2[2] = 0x30;
          uVar17 = (ulonglong)(-(uint)((*param_1 & 0xfffffffffffff) != 0) & 0x3fe);
        }
        else {
          param_2[2] = 0x31;
        }
        pauVar12 = (undefined (*) [16])(param_2 + 3);
        pauVar13 = (undefined (*) [16])(param_2 + 4);
        if (iVar3 == 0) {
          (*pauVar12)[0] = 0;
        }
        else {
          (*pauVar12)[0] = *(undefined *)**(undefined8 **)(local_48[0] + 0xf0);
        }
        if ((*param_1 & 0xfffffffffffff) != 0) {
          uVar16 = 0xf000000000000;
          do {
            if ((int)uVar10 < 1) break;
            uVar2 = (short)((*param_1 & uVar16) >> ((byte)sVar11 & 0x3f)) + 0x30;
            if (0x39 < uVar2) {
              uVar2 = uVar2 + sVar8;
            }
            (*pauVar13)[0] = (char)uVar2;
            uVar16 = uVar16 >> 4;
            uVar10 = (ulonglong)((int)uVar10 - 1);
            pauVar13 = (undefined (*) [16])(*pauVar13 + 1);
            sVar11 = sVar11 + -4;
          } while (-1 < sVar11);
          if ((-1 < sVar11) &&
             (pauVar1 = pauVar13, 8 < (ushort)((*param_1 & uVar16) >> ((byte)sVar11 & 0x3f)))) {
            while (pauVar6 = (undefined (*) [16])(pauVar1[-1] + 0xf),
                  ((*pauVar6)[0] + 0xba & 0xdf) == 0) {
              (*pauVar6)[0] = 0x30;
              pauVar1 = pauVar6;
            }
            if (pauVar6 == pauVar12) {
              pauVar1[-1][0xe] = pauVar1[-1][0xe] + '\x01';
            }
            else {
              if ((*pauVar6)[0] == '9') {
                (*pauVar6)[0] = (char)sVar8 + ':';
              }
              else {
                (*pauVar6)[0] = (*pauVar6)[0] + '\x01';
              }
            }
          }
        }
        if (0 < (int)uVar10) {
          FUN_18001d980(pauVar13,0x30,uVar10);
          pauVar13 = (undefined (*) [16])(*pauVar13 + uVar10);
        }
        if ((*pauVar12)[0] == '\0') {
          pauVar13 = pauVar12;
        }
        (*pauVar13)[0] = (-(param_5 != 0) & 0xe0U) + 0x70;
        lVar7 = ((uint)(*param_1 >> 0x34) & 0x7ff) - uVar17;
        if (lVar7 < 0) {
          (*pauVar13)[1] = 0x2d;
          lVar7 = -lVar7;
        }
        else {
          (*pauVar13)[1] = 0x2b;
        }
        pcVar14 = *pauVar13 + 2;
        *pcVar14 = '0';
        pcVar5 = pcVar14;
        if (lVar7 < 1000) {
LAB_18002a63f:
          if (99 < lVar7) goto LAB_18002a645;
        }
        else {
          *pcVar14 = (char)(lVar7 / 1000) + '0';
          pcVar5 = *pauVar13 + 3;
          lVar7 = lVar7 % 1000;
          if (pcVar5 == pcVar14) goto LAB_18002a63f;
LAB_18002a645:
          lVar9 = SUB168(SEXT816(-0x5c28f5c28f5c28f5) * SEXT816(lVar7) >> 0x40,0) + lVar7;
          lVar9 = (lVar9 >> 6) - (lVar9 >> 0x3f);
          *pcVar5 = (char)lVar9 + '0';
          pcVar5 = pcVar5 + 1;
          lVar7 = lVar7 + lVar9 * -100;
        }
        if ((pcVar5 != pcVar14) || (9 < lVar7)) {
          *pcVar5 = (char)(lVar7 / 10) + '0';
          pcVar5 = pcVar5 + 1;
          lVar7 = lVar7 % 10;
        }
        *pcVar5 = (char)lVar7 + '0';
        pcVar5[1] = '\0';
      }
      iVar3 = 0;
      goto LAB_18002a6b5;
    }
    piVar4 = _errno();
    iVar3 = 0x22;
  }
  *piVar4 = iVar3;
  FUN_18001fee8();
LAB_18002a6b5:
  if (local_30 != '\0') {
    *(uint *)(local_38 + 200) = *(uint *)(local_38 + 200) & 0xfffffffd;
  }
  return iVar3;
}



ulonglong FUN_18002a6e8(undefined *param_1,undefined *param_2,int param_3,int param_4,int *param_5,
                       char param_6,localeinfo_struct *param_7)

{
  code *pcVar1;
  errno_t eVar2;
  uint *puVar3;
  size_t sVar4;
  ulonglong uVar5;
  undefined *puVar6;
  uint uVar7;
  undefined8 *_Str;
  char *_Dst;
  int iVar8;
  longlong local_38 [2];
  longlong local_28;
  char local_20;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_38,param_7);
  if ((param_1 == (undefined *)0x0) || (param_2 == (undefined *)0x0)) {
    puVar3 = (uint *)_errno();
    uVar7 = 0x16;
  }
  else {
    iVar8 = 0;
    if (0 < param_3) {
      iVar8 = param_3;
    }
    if ((undefined *)(longlong)(iVar8 + 9) < param_2) {
      if (param_6 != '\0') {
        _Str = (undefined8 *)(param_1 + (*param_5 == 0x2d));
        if (0 < param_3 != 0) {
          sVar4 = strlen((char *)_Str);
          FUN_18001d320((undefined8 *)((longlong)(int)(uint)(0 < param_3) + (longlong)_Str),_Str,
                        sVar4 + 1);
        }
      }
      puVar6 = param_1;
      if (*param_5 == 0x2d) {
        *param_1 = 0x2d;
        puVar6 = param_1 + 1;
      }
      if (0 < param_3) {
        *puVar6 = puVar6[1];
        puVar6 = puVar6 + 1;
        *puVar6 = *(undefined *)**(undefined8 **)(local_38[0] + 0xf0);
      }
      _Dst = puVar6 + (ulonglong)(param_6 == '\0') + (longlong)param_3;
      puVar6 = param_2 + (longlong)(param_1 + -(longlong)_Dst);
      if (param_2 == (undefined *)0xffffffffffffffff) {
        puVar6 = param_2;
      }
      eVar2 = strcpy_s(_Dst,(rsize_t)puVar6,"e+000");
      if (eVar2 != 0) {
        _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
        pcVar1 = (code *)swi(3);
        uVar5 = (*pcVar1)();
        return uVar5;
      }
      if (param_4 != 0) {
        *_Dst = 'E';
      }
      if (**(char **)(param_5 + 4) != '0') {
        iVar8 = param_5[1] + -1;
        if (iVar8 < 0) {
          iVar8 = -iVar8;
          _Dst[1] = '-';
        }
        if (99 < iVar8) {
          _Dst[2] = _Dst[2] + (char)(iVar8 / 100);
          iVar8 = iVar8 % 100;
        }
        if (9 < iVar8) {
          _Dst[3] = _Dst[3] + (char)(iVar8 / 10);
          iVar8 = iVar8 % 10;
        }
        _Dst[4] = _Dst[4] + (char)iVar8;
      }
      if (((DAT_18004cf90 & 1) != 0) && (_Dst[2] == '0')) {
        FUN_18001d320((undefined8 *)(_Dst + 2),(undefined8 *)(_Dst + 3),3);
      }
      uVar7 = 0;
      goto LAB_18002a897;
    }
    puVar3 = (uint *)_errno();
    uVar7 = 0x22;
  }
  *puVar3 = uVar7;
  FUN_18001fee8();
LAB_18002a897:
  if (local_20 != '\0') {
    *(uint *)(local_28 + 200) = *(uint *)(local_28 + 200) & 0xfffffffd;
  }
  return (ulonglong)uVar7;
}



// Library Function - Single Match
//  _cftoe_l
// 
// Library: Visual Studio 2012 Release

void _cftoe_l(undefined8 *param_1,undefined *param_2,undefined *param_3,int param_4,int param_5,
             localeinfo_struct *param_6)

{
  errno_t eVar1;
  int *piVar2;
  undefined *_SizeInBytes;
  _strflt local_68;
  char local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff58;
  FUN_18002b5c0(*param_1,(int *)&local_68,local_50,0x16);
  if ((param_2 == (undefined *)0x0) || (param_3 == (undefined *)0x0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18001fee8();
  }
  else {
    _SizeInBytes = (undefined *)0xffffffffffffffff;
    if (param_3 != (undefined *)0xffffffffffffffff) {
      _SizeInBytes = param_3 + (-(ulonglong)(0 < param_4) - (ulonglong)(local_68.sign == 0x2d));
    }
    eVar1 = _fptostr(param_2 + (ulonglong)(0 < param_4) + (ulonglong)(local_68.sign == 0x2d),
                     (size_t)_SizeInBytes,param_4 + 1,(STRFLT)&local_68);
    if (eVar1 == 0) {
      FUN_18002a6e8(param_2,param_3,param_4,param_5,(int *)&local_68,'\0',param_6);
    }
    else {
      *param_2 = 0;
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff58);
  return;
}



// Library Function - Single Match
//  _cftof2_l
// 
// Library: Visual Studio 2012 Release

undefined4
_cftof2_l(undefined8 *param_1,longlong param_2,int param_3,int *param_4,char param_5,
         localeinfo_struct *param_6)

{
  undefined (*_Str) [16];
  int iVar1;
  int *piVar2;
  size_t sVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  undefined8 *_Str_00;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  iVar1 = param_4[1];
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,param_6);
  if ((param_1 == (undefined8 *)0x0) || (param_2 == 0)) {
    piVar2 = _errno();
    uVar6 = 0x16;
    *piVar2 = 0x16;
    FUN_18001fee8();
  }
  else {
    if ((param_5 != '\0') && (iVar1 + -1 == param_3)) {
      *(undefined2 *)((longlong)param_1 + (longlong)(iVar1 + -1) + (ulonglong)(*param_4 == 0x2d)) =
           0x30;
    }
    if (*param_4 == 0x2d) {
      *(undefined *)param_1 = 0x2d;
      param_1 = (undefined8 *)((longlong)param_1 + 1);
    }
    if (param_4[1] < 1) {
      sVar3 = strlen((char *)param_1);
      FUN_18001d320((undefined8 *)((longlong)param_1 + 1),param_1,sVar3 + 1);
      *(undefined *)param_1 = 0x30;
      _Str_00 = (undefined8 *)((longlong)param_1 + 1);
    }
    else {
      _Str_00 = (undefined8 *)((longlong)param_1 + (longlong)param_4[1]);
    }
    if (0 < param_3) {
      _Str = (undefined (*) [16])((longlong)_Str_00 + 1);
      sVar3 = strlen((char *)_Str_00);
      FUN_18001d320((undefined8 *)_Str,_Str_00,sVar3 + 1);
      *(undefined *)_Str_00 = *(undefined *)**(undefined8 **)(local_28[0] + 0xf0);
      iVar1 = param_4[1];
      if (iVar1 < 0) {
        iVar4 = -iVar1;
        iVar5 = iVar4;
        if ((param_5 == '\0') && (iVar5 = param_3, SBORROW4(param_3,iVar4) == param_3 + iVar1 < 0))
        {
          iVar5 = iVar4;
        }
        if (iVar5 != 0) {
          sVar3 = strlen((char *)_Str);
          FUN_18001d320((undefined8 *)(*_Str + iVar5),(undefined8 *)_Str,sVar3 + 1);
        }
        FUN_18001d980(_Str,0x30,(longlong)iVar5);
      }
    }
    uVar6 = 0;
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar6;
}



// Library Function - Single Match
//  _cftof_l
// 
// Library: Visual Studio 2012 Release

void _cftof_l(undefined8 *param_1,undefined8 *param_2,longlong param_3,int param_4,
             localeinfo_struct *param_5)

{
  errno_t eVar1;
  int *piVar2;
  size_t _SizeInBytes;
  _strflt local_68;
  char local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff68;
  FUN_18002b5c0(*param_1,(int *)&local_68,local_50,0x16);
  if ((param_2 == (undefined8 *)0x0) || (param_3 == 0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18001fee8();
  }
  else {
    _SizeInBytes = 0xffffffffffffffff;
    if (param_3 != -1) {
      _SizeInBytes = param_3 - (ulonglong)(local_68.sign == 0x2d);
    }
    eVar1 = _fptostr((char *)((ulonglong)(local_68.sign == 0x2d) + (longlong)param_2),_SizeInBytes,
                     local_68.decpt + param_4,(STRFLT)&local_68);
    if (eVar1 == 0) {
      _cftof2_l(param_2,param_3,param_4,(int *)&local_68,'\0',param_5);
    }
    else {
      *(undefined *)param_2 = 0;
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff68);
  return;
}



// Library Function - Single Match
//  _cftog_l
// 
// Library: Visual Studio 2012 Release

void _cftog_l(undefined8 *param_1,undefined8 *param_2,undefined *param_3,int param_4,int param_5,
             localeinfo_struct *param_6)

{
  char *_Buf;
  errno_t eVar1;
  int *piVar2;
  undefined *_SizeInBytes;
  char *pcVar3;
  int iVar4;
  _strflt local_68;
  char local_50 [24];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff58;
  FUN_18002b5c0(*param_1,(int *)&local_68,local_50,0x16);
  if ((param_2 == (undefined8 *)0x0) || (param_3 == (undefined *)0x0)) {
    piVar2 = _errno();
    *piVar2 = 0x16;
    FUN_18001fee8();
  }
  else {
    iVar4 = local_68.decpt + -1;
    _SizeInBytes = (undefined *)0xffffffffffffffff;
    _Buf = (char *)((ulonglong)(local_68.sign == 0x2d) + (longlong)param_2);
    if (param_3 != (undefined *)0xffffffffffffffff) {
      _SizeInBytes = param_3 + -(ulonglong)(local_68.sign == 0x2d);
    }
    eVar1 = _fptostr(_Buf,(size_t)_SizeInBytes,param_4,(STRFLT)&local_68);
    if (eVar1 == 0) {
      local_68.decpt = local_68.decpt + -1;
      if ((local_68.decpt < -4) || (param_4 <= local_68.decpt)) {
        FUN_18002a6e8((undefined *)param_2,param_3,param_4,param_5,(int *)&local_68,'\x01',param_6);
      }
      else {
        if (iVar4 < local_68.decpt) {
          do {
            pcVar3 = _Buf;
            _Buf = pcVar3 + 1;
          } while (*pcVar3 != '\0');
          pcVar3[-1] = '\0';
        }
        _cftof2_l(param_2,(longlong)param_3,param_4,(int *)&local_68,'\x01',param_6);
      }
    }
    else {
      *(undefined *)param_2 = 0;
    }
  }
  FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff58);
  return;
}



// Library Function - Single Match
//  _cropzeros_l
// 
// Library: Visual Studio 2012 Release

void _cropzeros_l(char *_Buf,_locale_t _Locale)

{
  char cVar1;
  char *pcVar2;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  char *pcVar3;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  cVar1 = *_Buf;
  if (cVar1 != '\0') {
    do {
      if (cVar1 == ***(char ***)(local_28[0] + 0xf0)) break;
      _Buf = _Buf + 1;
      cVar1 = *_Buf;
    } while (cVar1 != '\0');
  }
  if (*_Buf != '\0') {
    do {
      _Buf = _Buf + 1;
      pcVar2 = _Buf;
      if (*_Buf == '\0') break;
    } while ((*_Buf + 0xbbU & 0xdf) != 0);
    do {
      pcVar3 = pcVar2;
      pcVar2 = pcVar3 + -1;
    } while (*pcVar2 == '0');
    if (*pcVar2 == ***(char ***)(local_28[0] + 0xf0)) {
      pcVar2 = pcVar3 + -2;
    }
    do {
      cVar1 = *_Buf;
      pcVar2 = pcVar2 + 1;
      _Buf = _Buf + 1;
      *pcVar2 = cVar1;
    } while (cVar1 != '\0');
  }
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



// Library Function - Single Match
//  _forcdecpt_l
// 
// Library: Visual Studio 2012 Release

void _forcdecpt_l(char *_Buf,_locale_t _Locale)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  byte bVar4;
  longlong local_28 [2];
  longlong local_18;
  char local_10;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,(localeinfo_struct *)_Locale);
  uVar2 = FUN_18002b2c0((int)*_Buf);
  if (uVar2 != 0x65) {
    do {
      _Buf = (char *)((byte *)_Buf + 1);
      iVar3 = isdigit((uint)(byte)*_Buf);
    } while (iVar3 != 0);
  }
  uVar2 = FUN_18002b2c0((int)*_Buf);
  if (uVar2 == 0x78) {
    _Buf = (char *)((byte *)_Buf + 2);
  }
  bVar4 = *_Buf;
  *_Buf = ***(byte ***)(local_28[0] + 0xf0);
  do {
    _Buf = (char *)((byte *)_Buf + 1);
    bVar1 = *_Buf;
    *_Buf = bVar4;
    bVar4 = bVar1;
  } while (*_Buf != 0);
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return;
}



void FUN_18002aecc(char *param_1,int param_2,undefined8 *param_3)

{
  undefined8 uVar1;
  int iVar2;
  bool bVar3;
  bool bVar4;
  uint uVar5;
  short sVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_28;
  
  *(undefined4 *)param_3 = 0;
  *(undefined4 *)((longlong)param_3 + 4) = 0;
  *(undefined4 *)(param_3 + 1) = 0;
  sVar6 = 0x404e;
  if (param_2 != 0) {
    uVar5 = 0;
    uVar9 = 0;
    uVar8 = 0;
    bVar4 = true;
    do {
      uVar1 = *param_3;
      iVar2 = *(int *)(param_3 + 1);
      uVar10 = uVar5 * 4;
      uVar7 = (uVar9 * 2 | uVar5 >> 0x1f) * 2 | uVar5 * 2 >> 0x1f;
      uVar9 = (uVar8 * 2 | uVar9 >> 0x1f) * 2 | uVar9 * 2 >> 0x1f;
      local_28 = (uint)uVar1;
      *(uint *)param_3 = uVar10;
      uVar5 = uVar10 + local_28;
      *(uint *)((longlong)param_3 + 4) = uVar7;
      *(uint *)(param_3 + 1) = uVar9;
      if ((uVar5 < uVar10) || (bVar3 = false, uVar5 < local_28)) {
        bVar3 = bVar4;
      }
      *(uint *)param_3 = uVar5;
      uVar8 = uVar7;
      if (bVar3) {
        uVar8 = uVar7 + 1;
        if ((uVar8 < uVar7) || (bVar3 = false, uVar8 == 0)) {
          bVar3 = bVar4;
        }
        *(uint *)((longlong)param_3 + 4) = uVar8;
        if (bVar3) {
          uVar9 = uVar9 + 1;
          *(uint *)(param_3 + 1) = uVar9;
        }
      }
      uVar10 = (uint)((ulonglong)uVar1 >> 0x20);
      uVar7 = uVar8 + uVar10;
      if ((uVar7 < uVar8) || (bVar3 = false, uVar7 < uVar10)) {
        bVar3 = bVar4;
      }
      *(uint *)((longlong)param_3 + 4) = uVar7;
      if (bVar3) {
        uVar9 = uVar9 + 1;
        *(uint *)(param_3 + 1) = uVar9;
      }
      uVar10 = uVar5 * 2;
      uVar8 = (uVar9 + iVar2) * 2 | uVar7 >> 0x1f;
      *(uint *)param_3 = uVar10;
      *(uint *)(param_3 + 1) = uVar8;
      uVar7 = uVar7 * 2 | uVar5 >> 0x1f;
      *(uint *)((longlong)param_3 + 4) = uVar7;
      uVar5 = uVar10 + (int)*param_1;
      if ((uVar5 < uVar10) || (bVar3 = false, uVar5 < (uint)(int)*param_1)) {
        bVar3 = bVar4;
      }
      *(uint *)param_3 = uVar5;
      uVar9 = uVar7;
      if (bVar3) {
        uVar9 = uVar7 + 1;
        if ((uVar9 < uVar7) || (bVar3 = false, uVar9 == 0)) {
          bVar3 = bVar4;
        }
        *(uint *)((longlong)param_3 + 4) = uVar9;
        if (bVar3) {
          uVar8 = uVar8 + 1;
          *(uint *)(param_3 + 1) = uVar8;
        }
      }
      param_1 = param_1 + 1;
      *(uint *)((longlong)param_3 + 4) = uVar9;
      *(uint *)(param_3 + 1) = uVar8;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  if (*(int *)(param_3 + 1) == 0) {
    uVar5 = *(uint *)((longlong)param_3 + 4);
    do {
      uVar9 = *(uint *)param_3;
      uVar10 = uVar5 >> 0x10;
      *(uint *)param_3 = uVar9 << 0x10;
      uVar8 = uVar9 >> 0x10 | uVar5 << 0x10;
      sVar6 = sVar6 + -0x10;
      uVar9 = uVar5 >> 0x10;
      uVar5 = uVar8;
    } while (uVar9 == 0);
    *(uint *)((longlong)param_3 + 4) = uVar8;
    *(uint *)(param_3 + 1) = uVar10;
  }
  uVar5 = *(uint *)(param_3 + 1);
  if ((uVar5 & 0x8000) == 0) {
    uVar9 = *(uint *)param_3;
    uVar8 = *(uint *)((longlong)param_3 + 4);
    do {
      uVar10 = uVar5 * 2;
      uVar5 = uVar8 >> 0x1f;
      uVar8 = uVar8 * 2 | uVar9 >> 0x1f;
      uVar5 = uVar10 | uVar5;
      sVar6 = sVar6 + -1;
      uVar9 = uVar9 * 2;
    } while ((uVar10 & 0x8000) == 0);
    *(uint *)param_3 = uVar9;
    *(uint *)((longlong)param_3 + 4) = uVar8;
    *(uint *)(param_3 + 1) = uVar5;
  }
  *(short *)((longlong)param_3 + 10) = sVar6;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  isdigit
// 
// Library: Visual Studio 2012 Release

int isdigit(int _C)

{
  uint uVar1;
  localeinfo_struct local_28;
  longlong local_18;
  char local_10;
  
  if (_DAT_18004cf88 == 0) {
    uVar1 = *(ushort *)(PTR_DAT_18004a308 + (longlong)_C * 2) & 4;
  }
  else {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(localeinfo_struct *)0x0);
    if ((local_28.locinfo)->mb_cur_max < 2) {
      uVar1 = (local_28.locinfo)->pctype[_C] & 4;
    }
    else {
      uVar1 = _isctype_l(_C,4,(_locale_t)&local_28);
    }
    if (local_10 != '\0') {
      *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    }
  }
  return (int)uVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

uint FUN_18002b2c0(uint param_1)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  CHAR local_res8;
  CHAR local_res9;
  undefined local_resa;
  byte local_res18;
  undefined local_res19;
  localeinfo_struct local_28;
  longlong local_18;
  char local_10;
  
  if (_DAT_18004cf88 == 0) {
    if (param_1 - 0x41 < 0x1a) {
      param_1 = param_1 + 0x20;
    }
    return param_1;
  }
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_28,(localeinfo_struct *)0x0);
  if (param_1 < 0x100) {
    if ((local_28.locinfo)->mb_cur_max < 2) {
      uVar1 = (local_28.locinfo)->pctype[(int)param_1] & 1;
    }
    else {
      uVar1 = _isctype_l(param_1,1,(_locale_t)&local_28);
    }
    if (uVar1 == 0) goto LAB_18002b1d7;
    uVar1 = (uint)(local_28.locinfo)->pclmap[(int)param_1];
    goto LAB_18002b29b;
  }
  if ((local_28.locinfo)->mb_cur_max < 2) {
LAB_18002b227:
    piVar3 = _errno();
    iVar2 = 1;
    *piVar3 = 0x2a;
    local_res9 = '\0';
    local_res8 = (CHAR)param_1;
  }
  else {
    iVar2 = _isleadbyte_l((int)param_1 >> 8 & 0xff,(_locale_t)&local_28);
    if (iVar2 == 0) goto LAB_18002b227;
    local_resa = 0;
    iVar2 = 2;
    local_res8 = (CHAR)(param_1 >> 8);
    local_res9 = (CHAR)param_1;
  }
  iVar2 = __crtLCMapStringA((_locale_t)&local_28,(local_28.locinfo)->locale_name[2],0x100,
                            &local_res8,iVar2,(LPSTR)&local_res18,3,(local_28.locinfo)->lc_codepage,
                            1);
  if (iVar2 == 0) {
LAB_18002b1d7:
    if (local_10 == '\0') {
      return param_1;
    }
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
    return param_1;
  }
  uVar1 = (uint)local_res18;
  if (iVar2 != 1) {
    uVar1 = (uint)CONCAT11(local_res18,local_res19);
  }
LAB_18002b29b:
  if (local_10 != '\0') {
    *(uint *)(local_18 + 200) = *(uint *)(local_18 + 200) & 0xfffffffd;
  }
  return uVar1;
}



// Library Function - Single Match
//  strrchr
// 
// Library: Visual Studio 2012 Release

char * strrchr(char *_Str,int _Ch)

{
  ulonglong uVar1;
  undefined4 in_EAX;
  uint uVar2;
  undefined (*pauVar3) [16];
  uint uVar4;
  int iVar5;
  char *pcVar6;
  uint uVar7;
  char *pcVar8;
  bool bVar9;
  bool bVar10;
  char cVar11;
  char cVar12;
  char cVar13;
  char cVar14;
  undefined in_XMM1 [16];
  undefined auVar15 [16];
  
  pauVar3 = (undefined (*) [16])0x0;
  if (_Ch == 0) {
    auVar15 = in_XMM1 & (undefined  [16])0x0;
    pcVar6 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
    cVar11 = SUB161(auVar15 >> 0x40,0);
    cVar12 = SUB161(auVar15 >> 0x48,0);
    cVar13 = SUB161(auVar15 >> 0x50,0);
    cVar14 = SUB161(auVar15 >> 0x58,0);
    uVar2 = pmovmskb(in_EAX,CONCAT115(-(pcVar6[0xf] == '\0'),
                                      CONCAT114(-(pcVar6[0xe] == '\0'),
                                                CONCAT113(-(pcVar6[0xd] == '\0'),
                                                          CONCAT112(-(pcVar6[0xc] == '\0'),
                                                                    CONCAT111(-(pcVar6[0xb] ==
                                                                               cVar14),CONCAT110(-(
                                                  pcVar6[10] == cVar13),
                                                  CONCAT19(-(pcVar6[9] == cVar12),
                                                           CONCAT18(-(pcVar6[8] == cVar11),
                                                                    CONCAT17(-(pcVar6[7] == '\0'),
                                                                             CONCAT16(-(pcVar6[6] ==
                                                                                       '\0'),
                                                  CONCAT15(-(pcVar6[5] == '\0'),
                                                           CONCAT14(-(pcVar6[4] == '\0'),
                                                                    CONCAT13(-(pcVar6[3] == '\0'),
                                                                             CONCAT12(-(pcVar6[2] ==
                                                                                       '\0'),
                                                  CONCAT11(-(pcVar6[1] == '\0'),-(*pcVar6 == '\0')))
                                                  ))))))))))))));
    uVar2 = uVar2 & -1 << ((byte)_Str & 0xf);
    while (uVar2 == 0) {
      uVar2 = pmovmskb(0,CONCAT115(-(pcVar6[0x1f] == '\0'),
                                   CONCAT114(-(pcVar6[0x1e] == '\0'),
                                             CONCAT113(-(pcVar6[0x1d] == '\0'),
                                                       CONCAT112(-(pcVar6[0x1c] == '\0'),
                                                                 CONCAT111(-(pcVar6[0x1b] == cVar14)
                                                                           ,CONCAT110(-(pcVar6[0x1a]
                                                                                       == cVar13),
                                                                                      CONCAT19(-(
                                                  pcVar6[0x19] == cVar12),
                                                  CONCAT18(-(pcVar6[0x18] == cVar11),
                                                           CONCAT17(-(pcVar6[0x17] == '\0'),
                                                                    CONCAT16(-(pcVar6[0x16] == '\0')
                                                                             ,CONCAT15(-(pcVar6[0x15
                                                  ] == '\0'),
                                                  CONCAT14(-(pcVar6[0x14] == '\0'),
                                                           CONCAT13(-(pcVar6[0x13] == '\0'),
                                                                    CONCAT12(-(pcVar6[0x12] == '\0')
                                                                             ,CONCAT11(-(pcVar6[0x11
                                                  ] == '\0'),-(pcVar6[0x10] == '\0')))))))))))))))))
      ;
      pcVar6 = pcVar6 + 0x10;
    }
    uVar4 = 0;
    if (uVar2 != 0) {
      for (; (uVar2 >> uVar4 & 1) == 0; uVar4 = uVar4 + 1) {
      }
    }
    pauVar3 = (undefined (*) [16])(pcVar6 + uVar4);
  }
  else {
    if (DAT_180049300 < 2) {
      uVar2 = (uint)_Str & 0xf;
      pcVar6 = (char *)((ulonglong)_Str & 0xfffffffffffffff0);
      uVar7 = -1 << (sbyte)uVar2;
      auVar15 = pshuflw(in_XMM1,ZEXT416((_Ch & 0xffU) << 8 | _Ch & 0xffU),0);
      uVar4 = pmovmskb(uVar2,CONCAT115(-(pcVar6[0xf] == '\0'),
                                       CONCAT114(-(pcVar6[0xe] == '\0'),
                                                 CONCAT113(-(pcVar6[0xd] == '\0'),
                                                           CONCAT112(-(pcVar6[0xc] == '\0'),
                                                                     CONCAT111(-(pcVar6[0xb] == '\0'
                                                                                ),CONCAT110(-(pcVar6
                                                  [10] == '\0'),
                                                  CONCAT19(-(pcVar6[9] == '\0'),
                                                           CONCAT18(-(pcVar6[8] == '\0'),
                                                                    CONCAT17(-(pcVar6[7] == '\0'),
                                                                             CONCAT16(-(pcVar6[6] ==
                                                                                       '\0'),
                                                  CONCAT15(-(pcVar6[5] == '\0'),
                                                           CONCAT14(-(pcVar6[4] == '\0'),
                                                                    CONCAT13(-(pcVar6[3] == '\0'),
                                                                             CONCAT12(-(pcVar6[2] ==
                                                                                       '\0'),
                                                  CONCAT11(-(pcVar6[1] == '\0'),-(*pcVar6 == '\0')))
                                                  ))))))))))))));
      cVar11 = SUB161(auVar15,0);
      cVar12 = SUB161(auVar15 >> 8,0);
      cVar13 = SUB161(auVar15 >> 0x10,0);
      cVar14 = SUB161(auVar15 >> 0x18,0);
      uVar2 = pmovmskb(_Ch,CONCAT115(-(cVar14 == pcVar6[0xf]),
                                     CONCAT114(-(cVar13 == pcVar6[0xe]),
                                               CONCAT113(-(cVar12 == pcVar6[0xd]),
                                                         CONCAT112(-(cVar11 == pcVar6[0xc]),
                                                                   CONCAT111(-(cVar14 == pcVar6[0xb]
                                                                              ),CONCAT110(-(cVar13 
                                                  == pcVar6[10]),
                                                  CONCAT19(-(cVar12 == pcVar6[9]),
                                                           CONCAT18(-(cVar11 == pcVar6[8]),
                                                                    CONCAT17(-(cVar14 == pcVar6[7]),
                                                                             CONCAT16(-(cVar13 ==
                                                                                       pcVar6[6]),
                                                                                      CONCAT15(-(
                                                  cVar12 == pcVar6[5]),
                                                  CONCAT14(-(cVar11 == pcVar6[4]),
                                                           CONCAT13(-(cVar14 == pcVar6[3]),
                                                                    CONCAT12(-(cVar13 == pcVar6[2]),
                                                                             CONCAT11(-(cVar12 ==
                                                                                       pcVar6[1]),
                                                                                      -(cVar11 ==
                                                                                       *pcVar6))))))
                                                  )))))))))));
      uVar2 = uVar2 & uVar7;
      uVar4 = uVar4 & uVar7;
      while (uVar4 == 0) {
        uVar4 = 0x1f;
        if (uVar2 != 0) {
          for (; uVar2 >> uVar4 == 0; uVar4 = uVar4 - 1) {
          }
        }
        if (uVar2 != 0) {
          pauVar3 = (undefined (*) [16])(pcVar6 + uVar4);
        }
        pcVar8 = pcVar6 + 0x10;
        uVar4 = pmovmskb((int)(undefined (*) [16])(pcVar6 + uVar4),
                         CONCAT115(-(pcVar6[0x1f] == '\0'),
                                   CONCAT114(-(pcVar6[0x1e] == '\0'),
                                             CONCAT113(-(pcVar6[0x1d] == '\0'),
                                                       CONCAT112(-(pcVar6[0x1c] == '\0'),
                                                                 CONCAT111(-(pcVar6[0x1b] == '\0'),
                                                                           CONCAT110(-(pcVar6[0x1a]
                                                                                      == '\0'),
                                                                                     CONCAT19(-(
                                                  pcVar6[0x19] == '\0'),
                                                  CONCAT18(-(pcVar6[0x18] == '\0'),
                                                           CONCAT17(-(pcVar6[0x17] == '\0'),
                                                                    CONCAT16(-(pcVar6[0x16] == '\0')
                                                                             ,CONCAT15(-(pcVar6[0x15
                                                  ] == '\0'),
                                                  CONCAT14(-(pcVar6[0x14] == '\0'),
                                                           CONCAT13(-(pcVar6[0x13] == '\0'),
                                                                    CONCAT12(-(pcVar6[0x12] == '\0')
                                                                             ,CONCAT11(-(pcVar6[0x11
                                                  ] == '\0'),-(*pcVar8 == '\0')))))))))))))))));
        uVar2 = pmovmskb(uVar2,CONCAT115(-(cVar14 == pcVar6[0x1f]),
                                         CONCAT114(-(cVar13 == pcVar6[0x1e]),
                                                   CONCAT113(-(cVar12 == pcVar6[0x1d]),
                                                             CONCAT112(-(cVar11 == pcVar6[0x1c]),
                                                                       CONCAT111(-(cVar14 ==
                                                                                  pcVar6[0x1b]),
                                                                                 CONCAT110(-(cVar13 
                                                  == pcVar6[0x1a]),
                                                  CONCAT19(-(cVar12 == pcVar6[0x19]),
                                                           CONCAT18(-(cVar11 == pcVar6[0x18]),
                                                                    CONCAT17(-(cVar14 ==
                                                                              pcVar6[0x17]),
                                                                             CONCAT16(-(cVar13 ==
                                                                                       pcVar6[0x16])
                                                                                      ,CONCAT15(-(
                                                  cVar12 == pcVar6[0x15]),
                                                  CONCAT14(-(cVar11 == pcVar6[0x14]),
                                                           CONCAT13(-(cVar14 == pcVar6[0x13]),
                                                                    CONCAT12(-(cVar13 ==
                                                                              pcVar6[0x12]),
                                                                             CONCAT11(-(cVar12 ==
                                                                                       pcVar6[0x11])
                                                                                      ,-(cVar11 ==
                                                                                        *pcVar8)))))
                                                  ))))))))))));
        pcVar6 = pcVar8;
      }
      uVar2 = uVar2 & (-uVar4 & uVar4) - 1;
      uVar4 = 0x1f;
      if (uVar2 != 0) {
        for (; uVar2 >> uVar4 == 0; uVar4 = uVar4 - 1) {
        }
      }
      if (uVar2 != 0) {
        pauVar3 = (undefined (*) [16])(pcVar6 + uVar4);
      }
    }
    else {
      uVar1 = (ulonglong)_Str & 0xf;
      while (bVar10 = uVar1 == 0, !bVar10) {
        if (*_Str == _Ch) {
          pauVar3 = (undefined (*) [16])_Str;
        }
        if (*_Str == '\0') {
          return (char *)pauVar3;
        }
        _Str = _Str + 1;
        uVar1 = (ulonglong)_Str & 0xf;
      }
      bVar9 = false;
      while( true ) {
        iVar5 = pcmpistri(ZEXT416(_Ch & 0xff),*(undefined (*) [16])_Str,0x40);
        if (bVar9) {
          pauVar3 = (undefined (*) [16])(_Str + iVar5);
          bVar10 = pauVar3 == (undefined (*) [16])0x0;
          pcmpistri(ZEXT416(_Ch & 0xff),*(undefined (*) [16])_Str,0x40);
        }
        if (bVar10) break;
        bVar9 = (undefined (*) [16])0xffffffffffffffef < _Str;
        _Str = (char *)((longlong)_Str + 0x10);
        bVar10 = (undefined (*) [16])_Str == (undefined (*) [16])0x0;
      }
    }
  }
  return (char *)pauVar3;
}



// Library Function - Single Match
//  _fptostr
// 
// Library: Visual Studio 2012 Release

errno_t _fptostr(char *_Buf,size_t _SizeInBytes,int _Digits,STRFLT _PtFlt)

{
  undefined8 *_Str;
  int iVar1;
  errno_t *peVar2;
  undefined8 *puVar3;
  size_t sVar4;
  char *pcVar5;
  char cVar6;
  errno_t eVar7;
  
  pcVar5 = _PtFlt->mantissa;
  if ((_Buf == (char *)0x0) || (_SizeInBytes == 0)) {
    peVar2 = _errno();
    eVar7 = 0x16;
  }
  else {
    *_Buf = '\0';
    iVar1 = 0;
    if (0 < _Digits) {
      iVar1 = _Digits;
    }
    if ((ulonglong)(longlong)(iVar1 + 1) < _SizeInBytes) {
      _Str = (undefined8 *)(_Buf + 1);
      *_Buf = '0';
      puVar3 = _Str;
      for (; 0 < _Digits; _Digits = _Digits + -1) {
        if (*pcVar5 == '\0') {
          cVar6 = '0';
        }
        else {
          cVar6 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        }
        *(char *)puVar3 = cVar6;
        puVar3 = (undefined8 *)((longlong)puVar3 + 1);
      }
      *(undefined *)puVar3 = 0;
      if ((-1 < _Digits) && ('4' < *pcVar5)) {
        while (puVar3 = (undefined8 *)((longlong)puVar3 + -1), *(char *)puVar3 == '9') {
          *(undefined *)puVar3 = 0x30;
        }
        *(char *)puVar3 = *(char *)puVar3 + '\x01';
      }
      if (*_Buf == '1') {
        _PtFlt->decpt = _PtFlt->decpt + 1;
      }
      else {
        sVar4 = strlen((char *)_Str);
        FUN_18001d320((undefined8 *)_Buf,_Str,sVar4 + 1);
      }
      return 0;
    }
    peVar2 = _errno();
    eVar7 = 0x22;
  }
  *peVar2 = eVar7;
  FUN_18001fee8();
  return eVar7;
}



// Library Function - Single Match
//  __dtold
// 
// Library: Visual Studio 2012 Release

void __dtold(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  ushort uVar3;
  uint uVar4;
  ushort uVar5;
  
  uVar4 = param_2[1];
  uVar5 = *(ushort *)((longlong)param_2 + 6) & 0x8000;
  uVar1 = *param_2;
  uVar3 = *(ushort *)((longlong)param_2 + 6) >> 4 & 0x7ff;
  uVar2 = 0x80000000;
  if (uVar3 == 0) {
    if (((uVar4 & 0xfffff) == 0) && (uVar1 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      goto LAB_18002b5b2;
    }
    uVar3 = 0x3c01;
    uVar2 = 0;
  }
  else {
    if (uVar3 == 0x7ff) {
      uVar3 = 0x7fff;
    }
    else {
      uVar3 = uVar3 + 0x3c00;
    }
  }
  *param_1 = uVar1 << 0xb;
  uVar4 = uVar1 >> 0x15 | (uVar4 & 0xfffff) << 0xb | uVar2;
  param_1[1] = uVar4;
  if (uVar2 == 0) {
    do {
      uVar4 = *param_1 >> 0x1f | uVar4 * 2;
      *param_1 = *param_1 * 2;
      uVar3 = uVar3 - 1;
    } while (-1 < (int)uVar4);
    param_1[1] = uVar4;
  }
  uVar5 = uVar5 | uVar3;
LAB_18002b5b2:
  *(ushort *)(param_1 + 2) = uVar5;
  return;
}



void FUN_18002b5c0(undefined8 param_1,int *param_2,char *param_3,rsize_t param_4)

{
  code *pcVar1;
  int iVar2;
  errno_t eVar3;
  undefined8 local_78;
  undefined2 local_70;
  undefined8 local_68;
  undefined2 local_60;
  short local_58;
  char local_56;
  char local_54 [28];
  ulonglong local_38;
  
  local_38 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff58;
  local_78 = param_1;
  __dtold((uint *)&local_68,(uint *)&local_78);
  local_78 = local_68;
  local_70 = local_60;
  iVar2 = FUN_18002b678((int *)&local_78,0x11,0,&local_58);
  *param_2 = (int)local_56;
  param_2[1] = (int)local_58;
  param_2[2] = iVar2;
  eVar3 = strcpy_s(param_3,param_4,local_54);
  if (eVar3 == 0) {
    *(char **)(param_2 + 4) = param_3;
    FUN_18001d2f0(local_38 ^ (ulonglong)&stack0xffffffffffffff58);
    return;
  }
  _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
  pcVar1 = (code *)swi(3);
  (*pcVar1)();
  return;
}



// WARNING: Could not reconcile some variable overlaps

void FUN_18002b678(int *param_1,int param_2,uint param_3,short *param_4)

{
  short *psVar1;
  undefined *puVar2;
  code *pcVar3;
  undefined3 uVar4;
  bool bVar5;
  undefined uVar6;
  ushort uVar7;
  errno_t eVar8;
  short sVar9;
  ushort uVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint *puVar14;
  ulonglong uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  undefined **ppuVar19;
  char cVar20;
  ushort uVar21;
  uint uVar22;
  uint uVar23;
  longlong lVar24;
  short *psVar25;
  short *psVar26;
  int iVar27;
  int iVar28;
  ushort *puVar29;
  undefined4 *puVar30;
  undefined **ppuVar31;
  ushort local_c8;
  ushort local_c6;
  int local_c4;
  uint local_c0;
  undefined2 local_bc;
  undefined **local_b8;
  uint local_b0;
  int local_ac;
  int local_a8;
  short *local_a0;
  uint local_98;
  undefined **local_90;
  byte local_88;
  undefined uStack135;
  ushort uStack134;
  ushort auStack132 [6];
  ushort local_78 [4];
  ushort uStack112;
  undefined uStack110;
  byte bStack109;
  int local_68;
  int local_64;
  undefined4 local_60;
  undefined *local_58;
  undefined4 local_50;
  ulonglong local_48;
  
  local_48 = DAT_180049180 ^ (ulonglong)&stack0xffffffffffffff08;
  iVar28 = *param_1;
  uVar22 = param_1[1];
  local_c6 = *(ushort *)(param_1 + 2) & 0x8000;
  uVar21 = *(ushort *)(param_1 + 2) & 0x7fff;
  local_68 = -0x33333334;
  local_64 = -0x33333334;
  local_60 = 0x3ffbcccc;
  if (local_c6 == 0) {
    *(undefined *)(param_4 + 1) = 0x20;
  }
  else {
    *(undefined *)(param_4 + 1) = 0x2d;
  }
  local_ac = param_2;
  local_a0 = param_4;
  local_98 = param_3;
  if (uVar21 == 0) {
    if ((uVar22 != 0) || (iVar28 != 0)) goto LAB_18002b80a;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
LAB_18002b725:
    *param_4 = 0;
    *(undefined *)(param_4 + 1) = uVar6;
    *(undefined2 *)((longlong)param_4 + 3) = 0x3001;
  }
  else {
    if (uVar21 == 0x7fff) {
      *param_4 = 1;
      if (((uVar22 == 0x80000000) && (iVar28 == 0)) || ((uVar22 >> 0x1e & 1) != 0)) {
        if ((local_c6 == 0) || (uVar22 != 0xc0000000)) {
          if ((uVar22 != 0x80000000) || (iVar28 != 0)) goto LAB_18002b7e1;
          eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#INF");
          if (eVar8 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        else {
          if (iVar28 != 0) {
LAB_18002b7e1:
            eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#QNAN");
            if (eVar8 != 0) {
              _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
              pcVar3 = (code *)swi(3);
              (*pcVar3)();
              return;
            }
            goto LAB_18002b7fe;
          }
          eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#IND");
          if (eVar8 != 0) {
            _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
            pcVar3 = (code *)swi(3);
            (*pcVar3)();
            return;
          }
        }
        *(undefined *)((longlong)param_4 + 3) = 5;
      }
      else {
        eVar8 = strcpy_s((char *)(param_4 + 2),0x16,"1#SNAN");
        if (eVar8 != 0) {
          _invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
          pcVar3 = (code *)swi(3);
          (*pcVar3)();
          return;
        }
LAB_18002b7fe:
        *(undefined *)((longlong)param_4 + 3) = 6;
      }
      goto LAB_18002c096;
    }
LAB_18002b80a:
    local_78[1] = (ushort)iVar28;
    local_78[2] = (ushort)((uint)iVar28 >> 0x10);
    uStack110 = (undefined)uVar21;
    bStack109 = (byte)(uVar21 >> 8);
    ppuVar19 = &PTR_PTR_DAT_18004a410;
    local_78[3] = (ushort)uVar22;
    uStack112 = (ushort)(uVar22 >> 0x10);
    local_78[0] = 0;
    local_a8 = 5;
    iVar11 = ((uint)(uVar21 >> 8) + (uVar22 >> 0x18) * 2) * 0x4d +
             (uint)uVar21 * 0x4d10 + -0x134312f4;
    local_c0 = iVar11 >> 0x10;
    sVar9 = (short)((uint)iVar11 >> 0x10);
    uVar22 = SEXT24(sVar9);
    if (-uVar22 == 0) {
LAB_18002bbe4:
      uVar23 = CONCAT22(local_78[3],local_78[2]);
      uVar22 = iVar28 << 0x10;
    }
    else {
      uVar16 = -uVar22;
      if (0 < (int)uVar22) {
        ppuVar19 = (undefined **)0x18004a570;
        uVar16 = uVar22;
      }
      if (uVar16 == 0) goto LAB_18002bbe4;
      uVar23 = CONCAT22(local_78[3],local_78[2]);
      uVar22 = iVar28 << 0x10;
      do {
        iVar28 = 0;
        ppuVar19 = (undefined **)((longlong)ppuVar19 + 0x54);
        local_b0 = (int)uVar16 >> 3;
        if ((uVar16 & 7) != 0) {
          local_90 = (undefined **)((longlong)ppuVar19 + (longlong)(int)(uVar16 & 7) * 0xc);
          if (0x7fff < *(ushort *)local_90) {
            ppuVar31 = local_90 + 1;
            puVar2 = *local_90;
            local_90 = &local_58;
            local_50 = *(undefined4 *)ppuVar31;
            local_58._0_6_ = CONCAT42((int)((ulonglong)puVar2 >> 0x10) + -1,(short)puVar2);
            local_58 = (undefined *)
                       ((ulonglong)puVar2 & 0xffff000000000000 | (ulonglong)(uint6)local_58);
          }
          local_c4 = 0;
          uVar10 = *(ushort *)((longlong)local_90 + 10) & 0x7fff;
          local_88 = 0;
          uStack135 = 0;
          uStack134 = 0;
          auStack132[0] = 0;
          auStack132[1] = 0;
          uVar7 = CONCAT11(bStack109,uStack110) & 0x7fff;
          auStack132[2] = 0;
          auStack132[3] = 0;
          local_c8 = (*(ushort *)((longlong)local_90 + 10) ^ CONCAT11(bStack109,uStack110)) & 0x8000
          ;
          uVar21 = uVar7 + uVar10;
          if (((uVar7 < 0x7fff) && (uVar10 < 0x7fff)) && (uVar21 < 0xbffe)) {
            if (0x3fbf < uVar21) {
              if (((uVar7 == 0) &&
                  (uVar21 = uVar21 + 1,
                  (CONCAT13(bStack109,CONCAT12(uStack110,uStack112)) & 0x7fffffff) == 0)) &&
                 ((uVar23 == 0 && (uVar22 == 0)))) {
                uStack110 = 0;
                bStack109 = 0;
                goto LAB_18002bbcd;
              }
              if (((uVar10 == 0) &&
                  (uVar21 = uVar21 + 1, (*(uint *)(local_90 + 1) & 0x7fffffff) == 0)) &&
                 ((*(int *)((longlong)local_90 + 4) == 0 && (*(int *)local_90 == 0))))
              goto LAB_18002b954;
              iVar11 = 5;
              puVar14 = (uint *)&local_88;
              do {
                if (0 < iVar11) {
                  ppuVar31 = local_90 + 1;
                  puVar29 = (ushort *)((longlong)local_78 + (longlong)(iVar28 * 2));
                  iVar27 = iVar11;
                  do {
                    uVar22 = *puVar14 + (uint)*puVar29 * (uint)*(ushort *)ppuVar31;
                    if ((uVar22 < *puVar14) ||
                       (bVar5 = false, uVar22 < (uint)*puVar29 * (uint)*(ushort *)ppuVar31)) {
                      bVar5 = true;
                    }
                    *puVar14 = uVar22;
                    if (bVar5) {
                      *(short *)(puVar14 + 1) = *(short *)(puVar14 + 1) + 1;
                    }
                    iVar27 = iVar27 + -1;
                    puVar29 = puVar29 + 1;
                    ppuVar31 = (undefined **)((longlong)ppuVar31 + -2);
                  } while (0 < iVar27);
                }
                iVar11 = iVar11 + -1;
                puVar14 = (uint *)((longlong)puVar14 + 2);
                iVar28 = iVar28 + 1;
              } while (0 < iVar11);
              uVar16 = CONCAT22(auStack132[3],auStack132[2]);
              uVar22 = CONCAT22(uStack134,CONCAT11(uStack135,local_88));
              uVar21 = uVar21 + 0xc002;
              uVar23 = uVar22;
              if ((short)uVar21 < 1) {
LAB_18002ba86:
                uVar21 = uVar21 - 1;
                if (-1 < (short)uVar21) goto LAB_18002baf3;
                uVar15 = (ulonglong)(ushort)-uVar21;
                local_bc = 0;
                iVar28 = local_c4;
                do {
                  uVar23 = uVar16;
                  if ((local_88 & 1) != 0) {
                    iVar28 = iVar28 + 1;
                  }
                  uVar17 = CONCAT22(auStack132[1],auStack132[0]);
                  uVar12 = uVar22 >> 1;
                  auStack132[1] = auStack132[1] >> 1 | (ushort)((uVar23 << 0x1f) >> 0x10);
                  uVar16 = uVar23 >> 1;
                  uVar22 = uVar12 | uVar17 << 0x1f;
                  auStack132[0] = (ushort)(uVar17 >> 1);
                  local_88 = (byte)uVar12;
                  uStack135 = (undefined)(uVar12 >> 8);
                  uStack134 = (ushort)(uVar22 >> 0x10);
                  uVar15 = uVar15 - 1;
                } while (uVar15 != 0);
                uVar21 = 0;
                auStack132[2] = (ushort)uVar16;
                auStack132[3] = (ushort)(uVar23 >> 0x11);
                if (iVar28 == 0) goto LAB_18002baf3;
                uVar7 = (ushort)uVar12 | 1;
                local_88 = (byte)uVar7;
                uVar22 = uVar12 | 1;
              }
              else {
                do {
                  uVar22 = uVar23;
                  if ((uVar16 & 0x80000000) != 0) break;
                  uVar17 = uVar16 * 2;
                  uVar22 = uVar23 * 2;
                  iVar28 = CONCAT22(auStack132[1],auStack132[0]) * 2;
                  uVar21 = uVar21 - 1;
                  auStack132[0] = (ushort)iVar28 | (ushort)(uVar23 >> 0x1f);
                  uVar16 = uVar17 | auStack132[1] >> 0xf;
                  local_88 = (byte)uVar22;
                  uStack135 = (undefined)(uVar22 >> 8);
                  uStack134 = (ushort)(uVar22 >> 0x10);
                  auStack132[1] = (ushort)((uint)iVar28 >> 0x10);
                  auStack132[2] = (ushort)uVar16;
                  auStack132[3] = (ushort)(uVar17 >> 0x10);
                  uVar23 = uVar22;
                } while (0 < (short)uVar21);
                if ((short)uVar21 < 1) goto LAB_18002ba86;
LAB_18002baf3:
                uVar7 = CONCAT11(uStack135,local_88);
              }
              if ((0x8000 < uVar7) || ((uVar22 & 0x1ffff) == 0x18000)) {
                if (CONCAT22(auStack132[0],uStack134) == -1) {
                  uStack134 = 0;
                  auStack132[0] = 0;
                  if (CONCAT22(auStack132[2],auStack132[1]) == -1) {
                    auStack132[1] = 0;
                    auStack132[2] = 0;
                    if (auStack132[3] == 0xffff) {
                      auStack132[3] = 0x8000;
                      uVar21 = uVar21 + 1;
                    }
                    else {
                      auStack132[3] = auStack132[3] + 1;
                    }
                  }
                  else {
                    iVar28 = CONCAT22(auStack132[2],auStack132[1]) + 1;
                    auStack132[1] = (ushort)iVar28;
                    auStack132[2] = (ushort)((uint)iVar28 >> 0x10);
                  }
                  uVar16 = CONCAT22(auStack132[3],auStack132[2]);
                }
                else {
                  iVar28 = CONCAT22(auStack132[0],uStack134) + 1;
                  uStack134 = (ushort)iVar28;
                  auStack132[0] = (ushort)((uint)iVar28 >> 0x10);
                }
              }
              if (uVar21 < 0x7fff) {
                bStack109 = (byte)(uVar21 >> 8) | (byte)(local_c8 >> 8);
                local_78[3] = (ushort)uVar16;
                uStack112 = (ushort)(uVar16 >> 0x10);
                local_78[0] = uStack134;
                local_78[1] = auStack132[0];
                local_78[2] = auStack132[1];
                uVar23 = CONCAT22(local_78[3],auStack132[1]);
                uVar22 = CONCAT22(auStack132[0],uStack134);
                uStack110 = (undefined)uVar21;
                goto LAB_18002bbcd;
              }
              goto LAB_18002bbaf;
            }
LAB_18002b954:
            local_78[2] = 0;
            local_78[3] = 0;
            uStack112 = 0;
            uStack110 = 0;
            bStack109 = 0;
          }
          else {
LAB_18002bbaf:
            local_78[2] = 0;
            local_78[3] = 0;
            iVar28 = (-(uint)(local_c8 != 0) & 0x80000000) + 0x7fff8000;
            uStack112 = (ushort)iVar28;
            uStack110 = (undefined)((uint)iVar28 >> 0x10);
            bStack109 = (byte)((uint)iVar28 >> 0x18);
          }
          local_78[3] = 0;
          local_78[2] = 0;
          uVar23 = 0;
          local_78[0] = 0;
          local_78[1] = 0;
          uVar22 = uVar23;
        }
LAB_18002bbcd:
        uVar16 = local_b0;
        local_b8 = ppuVar19;
      } while (local_b0 != 0);
    }
    iVar28 = 0;
    uVar16 = CONCAT13(bStack109,CONCAT12(uStack110,uStack112));
    uVar21 = (ushort)(uVar16 >> 0x10);
    uVar17 = uVar23;
    if (0x3ffe < uVar21) {
      local_c0 = local_c0 & 0xffff0000 | (uint)(ushort)(sVar9 + 1);
      uVar17 = 0;
      local_c4 = 0;
      local_88 = 0;
      uStack135 = 0;
      uStack134 = 0;
      auStack132[0] = 0;
      auStack132[1] = 0;
      auStack132[2] = 0;
      auStack132[3] = 0;
      uVar10 = (local_60._2_2_ ^ uVar21) & 0x8000;
      uVar7 = (uVar21 & 0x7fff) + (local_60._2_2_ & 0x7fff);
      if ((((uVar21 & 0x7fff) < 0x7fff) && ((local_60._2_2_ & 0x7fff) < 0x7fff)) && (uVar7 < 0xbffe)
         ) {
        if (uVar7 < 0x3fc0) {
LAB_18002bc68:
          uStack112 = 0;
          uStack110 = 0;
          bStack109 = 0;
          uVar22 = uVar17;
        }
        else {
          if ((((uVar16 & 0x7fff0000) == 0) &&
              (uVar7 = uVar7 + 1,
              (CONCAT13(bStack109,CONCAT12(uStack110,uStack112)) & 0x7fffffff) == 0)) &&
             ((uVar23 == 0 && (uVar22 == 0)))) {
            uStack110 = 0;
            bStack109 = 0;
            uVar17 = uVar23;
          }
          else {
            if ((((local_60 & 0x7fff0000) == 0) && (uVar7 = uVar7 + 1, (local_60 & 0x7fffffff) == 0)
                ) && ((local_64 == 0 && (local_68 == 0)))) goto LAB_18002bc68;
            puVar14 = (uint *)&local_88;
            do {
              if (0 < local_a8) {
                puVar30 = &local_60;
                puVar29 = (ushort *)((longlong)local_78 + (longlong)(iVar28 * 2));
                iVar11 = local_a8;
                do {
                  bVar5 = false;
                  uVar22 = *puVar14 + (uint)*(ushort *)puVar30 * (uint)*puVar29;
                  if ((uVar22 < *puVar14) || (uVar22 < (uint)*(ushort *)puVar30 * (uint)*puVar29)) {
                    bVar5 = true;
                  }
                  *puVar14 = uVar22;
                  if (bVar5) {
                    *(short *)(puVar14 + 1) = *(short *)(puVar14 + 1) + 1;
                  }
                  iVar11 = iVar11 + -1;
                  puVar29 = puVar29 + 1;
                  puVar30 = (undefined4 *)((longlong)puVar30 + -2);
                } while (0 < iVar11);
              }
              local_a8 = local_a8 + -1;
              puVar14 = (uint *)((longlong)puVar14 + 2);
              iVar28 = iVar28 + 1;
            } while (0 < local_a8);
            uVar16 = CONCAT22(auStack132[3],auStack132[2]);
            uVar22 = CONCAT22(uStack134,CONCAT11(uStack135,local_88));
            uVar7 = uVar7 + 0xc002;
            uVar23 = uVar22;
            if ((short)uVar7 < 1) {
LAB_18002bd8d:
              uVar7 = uVar7 - 1;
              if (-1 < (short)uVar7) goto LAB_18002bdf2;
              uVar15 = (ulonglong)(ushort)-uVar7;
              uVar7 = 0;
              iVar28 = local_c4;
              do {
                uVar23 = uVar16;
                if ((local_88 & 1) != 0) {
                  iVar28 = iVar28 + 1;
                }
                uVar17 = CONCAT22(auStack132[1],auStack132[0]);
                uVar12 = uVar22 >> 1;
                auStack132[1] = auStack132[1] >> 1 | (ushort)((uVar23 << 0x1f) >> 0x10);
                uVar16 = uVar23 >> 1;
                uVar22 = uVar12 | uVar17 << 0x1f;
                auStack132[0] = (ushort)(uVar17 >> 1);
                local_88 = (byte)uVar12;
                uStack135 = (undefined)(uVar12 >> 8);
                uStack134 = (ushort)(uVar22 >> 0x10);
                uVar15 = uVar15 - 1;
              } while (uVar15 != 0);
              auStack132[2] = (ushort)uVar16;
              auStack132[3] = (ushort)(uVar23 >> 0x11);
              if (iVar28 == 0) goto LAB_18002bdf2;
              uVar21 = (ushort)uVar12 | 1;
              local_88 = (byte)uVar21;
              uVar22 = uVar12 | 1;
            }
            else {
              do {
                uVar22 = uVar23;
                if ((uVar16 & 0x80000000) != 0) break;
                uVar17 = uVar16 * 2;
                uVar22 = uVar23 * 2;
                iVar28 = CONCAT22(auStack132[1],auStack132[0]) * 2;
                uVar7 = uVar7 - 1;
                auStack132[0] = (ushort)iVar28 | (ushort)(uVar23 >> 0x1f);
                uVar16 = uVar17 | auStack132[1] >> 0xf;
                local_88 = (byte)uVar22;
                uStack135 = (undefined)(uVar22 >> 8);
                uStack134 = (ushort)(uVar22 >> 0x10);
                auStack132[1] = (ushort)((uint)iVar28 >> 0x10);
                auStack132[2] = (ushort)uVar16;
                auStack132[3] = (ushort)(uVar17 >> 0x10);
                uVar23 = uVar22;
              } while (0 < (short)uVar7);
              if ((short)uVar7 < 1) goto LAB_18002bd8d;
LAB_18002bdf2:
              uVar21 = CONCAT11(uStack135,local_88);
            }
            if ((0x8000 < uVar21) || ((uVar22 & 0x1ffff) == 0x18000)) {
              if (CONCAT22(auStack132[0],uStack134) == -1) {
                uStack134 = 0;
                auStack132[0] = 0;
                if (CONCAT22(auStack132[2],auStack132[1]) == -1) {
                  auStack132[1] = 0;
                  auStack132[2] = 0;
                  if (auStack132[3] == 0xffff) {
                    auStack132[3] = 0x8000;
                    uVar7 = uVar7 + 1;
                  }
                  else {
                    auStack132[3] = auStack132[3] + 1;
                  }
                }
                else {
                  iVar28 = CONCAT22(auStack132[2],auStack132[1]) + 1;
                  auStack132[1] = (ushort)iVar28;
                  auStack132[2] = (ushort)((uint)iVar28 >> 0x10);
                }
                uVar16 = CONCAT22(auStack132[3],auStack132[2]);
              }
              else {
                iVar28 = CONCAT22(auStack132[0],uStack134) + 1;
                uStack134 = (ushort)iVar28;
                auStack132[0] = (ushort)((uint)iVar28 >> 0x10);
              }
            }
            if (uVar7 < 0x7fff) {
              bStack109 = (byte)(uVar7 >> 8) | (byte)(uVar10 >> 8);
              local_78[3] = (ushort)uVar16;
              uStack112 = (ushort)(uVar16 >> 0x10);
              local_78[0] = uStack134;
              uStack110 = (undefined)uVar7;
              local_78[1] = auStack132[0];
              local_78[2] = auStack132[1];
              uVar17 = CONCAT22(local_78[3],auStack132[1]);
              uVar22 = CONCAT22(auStack132[0],uStack134);
            }
            else {
              iVar28 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
              uStack112 = (ushort)iVar28;
              uStack110 = (undefined)((uint)iVar28 >> 0x10);
              bStack109 = (byte)((uint)iVar28 >> 0x18);
              uVar17 = 0;
              uVar22 = 0;
            }
          }
        }
      }
      else {
        iVar28 = (-(uint)(uVar10 != 0) & 0x80000000) + 0x7fff8000;
        uStack112 = (ushort)iVar28;
        uStack110 = (undefined)((uint)iVar28 >> 0x10);
        bStack109 = (byte)((uint)iVar28 >> 0x18);
        uVar22 = uVar17;
      }
    }
    *param_4 = (short)local_c0;
    iVar28 = param_2;
    if (((param_3 & 1) != 0) && (iVar28 = param_2 + (short)local_c0, iVar28 < 1)) {
      uVar6 = 0x20;
      if (local_c6 == 0x8000) {
        uVar6 = 0x2d;
      }
      goto LAB_18002b725;
    }
    uVar4 = CONCAT12(uStack110,uStack112);
    uStack110 = 0;
    uVar16 = (uint)uStack112;
    lVar24 = 8;
    if (0x15 < iVar28) {
      iVar28 = 0x15;
    }
    iVar11 = (CONCAT13(bStack109,uVar4) >> 0x10) - 0x3ffe;
    do {
      uVar23 = uVar17 * 2;
      uVar12 = uVar17 >> 0x1f;
      uVar17 = uVar23 | uVar22 >> 0x1f;
      uVar16 = uVar16 * 2 | uVar12;
      uVar22 = uVar22 * 2;
      lVar24 = lVar24 + -1;
    } while (lVar24 != 0);
    local_78[2] = (ushort)uVar17;
    local_78[3] = (ushort)(uVar23 >> 0x10);
    local_78[0] = (ushort)uVar22;
    local_78[1] = (ushort)(uVar22 >> 0x10);
    if ((iVar11 < 0) && (uVar23 = -iVar11 & 0xff, uVar23 != 0)) {
      do {
        uVar13 = uVar22 >> 1;
        uVar18 = uVar17 >> 1;
        uVar12 = uVar16 << 0x1f;
        uVar22 = uVar17 << 0x1f;
        uVar23 = uVar23 - 1;
        uVar16 = uVar16 >> 1;
        uVar17 = uVar18 | uVar12;
        uVar22 = uVar13 | uVar22;
      } while (0 < (int)uVar23);
      local_78[2] = (ushort)uVar18;
      local_78[3] = (ushort)(uVar17 >> 0x10);
      local_78[0] = (ushort)uVar13;
      local_78[1] = (ushort)(uVar22 >> 0x10);
    }
    iVar28 = iVar28 + 1;
    psVar1 = param_4 + 2;
    psVar25 = psVar1;
    if (0 < iVar28) {
      while( true ) {
        uVar12 = CONCAT22(local_78[1],local_78[0]);
        local_58 = (undefined *)CONCAT26(local_78[3],CONCAT24(local_78[2],uVar12));
        uVar13 = (uVar17 * 2 | uVar22 >> 0x1f) * 2 | uVar22 * 2 >> 0x1f;
        uVar23 = uVar12 + uVar22 * 4;
        uVar18 = (uVar16 * 2 | uVar17 >> 0x1f) * 2 | uVar17 * 2 >> 0x1f;
        if ((uVar23 < uVar22 * 4) || (uVar22 = uVar13, uVar23 < uVar12)) {
          uVar22 = uVar13 + 1;
          if ((uVar22 < uVar13) || (bVar5 = false, uVar22 == 0)) {
            bVar5 = true;
          }
          if (bVar5) {
            uVar18 = uVar18 + 1;
          }
        }
        uVar17 = (uint)((ulonglong)local_58 >> 0x20);
        uVar12 = uVar22 + uVar17;
        if ((uVar12 < uVar22) || (uVar12 < uVar17)) {
          uVar18 = uVar18 + 1;
        }
        uVar22 = uVar23 * 2;
        uVar17 = uVar12 * 2 | uVar23 >> 0x1f;
        uVar16 = (uVar18 + uVar16) * 2;
        iVar28 = iVar28 + -1;
        local_78[0] = (ushort)uVar22;
        local_78[1] = (ushort)(uVar22 >> 0x10);
        uStack112 = (ushort)uVar16 | (ushort)(uVar12 >> 0x1f);
        local_78[2] = (ushort)uVar17;
        local_78[3] = (ushort)(uVar12 * 2 >> 0x10);
        uStack110 = (undefined)(uVar16 >> 0x10);
        *(char *)psVar25 = (char)(uVar16 >> 0x18) + '0';
        psVar25 = (short *)((longlong)psVar25 + 1);
        if (iVar28 < 1) break;
        uVar16 = uVar16 & 0xffffff | uVar12 >> 0x1f;
      }
    }
    bStack109 = 0;
    psVar26 = psVar25 + -1;
    if ('4' < *(char *)((longlong)psVar25 + -1)) {
      for (; (psVar1 <= psVar26 && (*(char *)psVar26 == '9'));
          psVar26 = (short *)((longlong)psVar26 + -1)) {
        *(char *)psVar26 = '0';
      }
      if (psVar26 < psVar1) {
        psVar26 = (short *)((longlong)psVar26 + 1);
        *param_4 = *param_4 + 1;
      }
      *(char *)psVar26 = *(char *)psVar26 + '\x01';
LAB_18002c082:
      cVar20 = ((char)psVar26 - (char)param_4) + -3;
      *(char *)((longlong)param_4 + 3) = cVar20;
      *(undefined *)((longlong)cVar20 + 4 + (longlong)param_4) = 0;
      goto LAB_18002c096;
    }
    for (; (psVar1 <= psVar26 && (*(char *)psVar26 == '0'));
        psVar26 = (short *)((longlong)psVar26 + -1)) {
    }
    if (psVar1 <= psVar26) goto LAB_18002c082;
    *param_4 = 0;
    *(undefined *)((longlong)param_4 + 3) = 1;
    uVar6 = 0x20;
    if (local_c6 == 0x8000) {
      uVar6 = 0x2d;
    }
    *(undefined *)(param_4 + 1) = uVar6;
    *(char *)psVar1 = '0';
  }
  *(undefined *)((longlong)param_4 + 5) = 0;
LAB_18002c096:
  FUN_18001d2f0(local_48 ^ (ulonglong)&stack0xffffffffffffff08);
  return;
}



void RtlUnwindEx(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,
                PVOID ReturnValue,PCONTEXT ContextRecord,PUNWIND_HISTORY_TABLE HistoryTable)

{
                    // WARNING: Could not recover jumptable at 0x00018002c150. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwindEx(TargetFrame,TargetIp,ExceptionRecord,ReturnValue,ContextRecord,HistoryTable);
  return;
}



BOOL IsProcessorFeaturePresent(DWORD ProcessorFeature)

{
  BOOL BVar1;
  
                    // WARNING: Could not recover jumptable at 0x00018002c156. Too many branches
                    // WARNING: Treating indirect jump as call
  BVar1 = IsProcessorFeaturePresent(ProcessorFeature);
  return BVar1;
}



// Library Function - Single Match
//  strcat_s
// 
// Libraries: Visual Studio 2010 Release, Visual Studio 2012 Release

errno_t strcat_s(char *_Dst,rsize_t _SizeInBytes,char *_Src)

{
  char cVar1;
  longlong lVar2;
  errno_t *peVar3;
  char *pcVar4;
  errno_t eVar5;
  
  if ((_Dst != (char *)0x0) && (_SizeInBytes != 0)) {
    pcVar4 = _Dst;
    if (_Src == (char *)0x0) {
      *_Dst = '\0';
    }
    else {
      do {
        if (*pcVar4 == '\0') break;
        pcVar4 = pcVar4 + 1;
        _SizeInBytes = _SizeInBytes - 1;
      } while (_SizeInBytes != 0);
      if (_SizeInBytes != 0) {
        lVar2 = -(longlong)_Src;
        do {
          cVar1 = *_Src;
          (pcVar4 + lVar2)[(longlong)_Src] = cVar1;
          _Src = _Src + 1;
          if (cVar1 == '\0') break;
          _SizeInBytes = _SizeInBytes - 1;
        } while (_SizeInBytes != 0);
        if (_SizeInBytes != 0) {
          return 0;
        }
        *_Dst = '\0';
        peVar3 = _errno();
        eVar5 = 0x22;
        goto LAB_18002c184;
      }
      *_Dst = '\0';
    }
  }
  peVar3 = _errno();
  eVar5 = 0x16;
LAB_18002c184:
  *peVar3 = eVar5;
  FUN_18001fee8();
  return eVar5;
}



void Unwind_18002c1e0(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x48));
  return;
}



void Unwind_18002c1ec(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x48));
  return;
}



void Unwind_18002c1f8(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x48));
  return;
}



void Unwind_18002c204(undefined8 param_1,longlong param_2)

{
  free(*(void **)(param_2 + 0x48));
  return;
}



// Library Function - Single Match
//  _CallSETranslator$filt$0
// 
// Library: Visual Studio 2005 Release

void _CallSETranslator_filt_0(_EXCEPTION_POINTERS *param_1,longlong param_2)

{
  __SehTransFilter(param_1,*(EHExceptionRecord **)(param_2 + 0x70),
                   *(unsigned___int64 **)(param_2 + 0x78),*(_CONTEXT **)(param_2 + 0x80),
                   *(_xDISPATCHER_CONTEXT **)(param_2 + 0x88),*(_s_FuncInfo **)(param_2 + 0x90),
                   (int *)(param_2 + 0x40));
  return;
}



void FUN_18002c26a(undefined8 param_1,longlong param_2)

{
  if ((*(longlong *)(param_2 + 0x40) == 0) && (DAT_180049320 != -1)) {
    FUN_180021e40();
  }
  return;
}



void FUN_18002c290(undefined8 *param_1,longlong param_2)

{
  undefined4 uVar1;
  
  *(undefined8 **)(param_2 + 0x40) = param_1;
  uVar1 = *(undefined4 *)*param_1;
  *(undefined4 *)(param_2 + 0x30) = uVar1;
  *(undefined8 **)(param_2 + 0x38) = param_1;
  *(undefined4 *)(param_2 + 0x28) = uVar1;
  if (*(int *)(param_2 + 0x78) == 1) {
    FUN_18001e9b4(*(undefined8 *)(param_2 + 0x70),0,*(longlong *)(param_2 + 0x80));
  }
  FUN_180023640(*(int *)(param_2 + 0x28),*(void **)(param_2 + 0x38));
  return;
}



void FUN_18002c2d9(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x80) != 0) {
    FUN_180024d08(8);
  }
  return;
}



void FUN_18002c2fd(void)

{
  FUN_180024d08(0xe);
  return;
}



void FUN_18002c316(void)

{
  FUN_180024d08(0xd);
  return;
}



void FUN_18002c32f(void)

{
  FUN_180024d08(0xc);
  return;
}



undefined4 FUN_18002c348(undefined8 param_1,longlong param_2)

{
  _ptiddata p_Var1;
  
  *(undefined8 *)(param_2 + 0x70) = param_1;
  *(undefined8 *)(param_2 + 0x68) = param_1;
  *(undefined8 *)(param_2 + 0x28) = **(undefined8 **)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if ((((**(int **)(param_2 + 0x28) == -0x1f928c9d) &&
       (*(int *)(*(longlong *)(param_2 + 0x28) + 0x18) == 4)) &&
      ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930520 ||
       ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930521 ||
        (*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930522)))))) &&
     (*(longlong *)(*(longlong *)(param_2 + 0x28) + 0x28) ==
      *(longlong *)(*(longlong *)(param_2 + 0xd8) + 0x28))) {
    *(undefined4 *)(param_2 + 0x20) = 1;
  }
  if (((**(int **)(param_2 + 0x28) == -0x1f928c9d) &&
      (*(int *)(*(longlong *)(param_2 + 0x28) + 0x18) == 4)) &&
     (((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930520 ||
       ((*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930521 ||
        (*(int *)(*(longlong *)(param_2 + 0x28) + 0x20) == 0x19930522)))) &&
      (*(longlong *)(*(longlong *)(param_2 + 0x28) + 0x30) == 0)))) {
    p_Var1 = _getptd();
    *(undefined4 *)&p_Var1->_reserved4 = 1;
    *(undefined4 *)(param_2 + 0x20) = 1;
    *(undefined4 *)(param_2 + 0x30) = 1;
  }
  else {
    *(undefined4 *)(param_2 + 0x30) = 0;
  }
  return *(undefined4 *)(param_2 + 0x30);
}



bool FUN_18002c4ba(undefined8 param_1,longlong param_2)

{
  return *(char *)(param_2 + 0x38) != '\0';
}



void FUN_18002c4d2(int **param_1)

{
  __FrameUnwindFilter(param_1);
  return;
}



void FUN_18002c4e8(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = _getptd();
  if (0 < p_Var1->_ProcessingThrow) {
    p_Var1 = _getptd();
    p_Var1->_ProcessingThrow = p_Var1->_ProcessingThrow + -1;
  }
  return;
}



void FUN_18002c511(void)

{
  FUN_180024d08(0xb);
  return;
}



void FUN_18002c52c(void)

{
                    // WARNING: Could not recover jumptable at 0x00018002c541. Too many branches
                    // WARNING: Treating indirect jump as call
  LeaveCriticalSection(DAT_180049430);
  return;
}



bool FUN_18002c550(int **param_1)

{
  return **param_1 == -0x3ffffffb;
}



void FUN_18002c570(undefined8 param_1,longlong param_2)

{
  if (*(int *)(param_2 + 0x60) != 0) {
    FUN_180024d08(0);
  }
  return;
}



void FUN_18002c58e(void)

{
  FUN_180024d08(0xd);
  return;
}



void FUN_18002c5a7(undefined8 param_1,longlong param_2)

{
  FUN_18002800c(*(uint *)(param_2 + 0x50));
  return;
}



void FUN_18002c5be(void)

{
  FUN_180024d08(0xc);
  return;
}



void FUN_18002c5d7(undefined8 param_1,longlong param_2)

{
  FUN_180025ba8(*(int *)(param_2 + 0x20),
                *(longlong *)(DAT_18004cfe8 + (longlong)*(int *)(param_2 + 0x20) * 8));
  return;
}



void FUN_18002c5ff(void)

{
  FUN_180024d08(1);
  return;
}



void FUN_18002c618(void)

{
  FUN_180024d08(1);
  return;
}



void FUN_18002c631(void)

{
  FUN_180024d08(10);
  return;
}



void FUN_18002c64a(undefined8 param_1,longlong param_2)

{
  _unlock_file(*(FILE **)(param_2 + 0x30));
  return;
}



void FUN_18002c662(undefined8 param_1,longlong param_2)

{
  FUN_18002800c(*(uint *)(param_2 + 0x40));
  return;
}


